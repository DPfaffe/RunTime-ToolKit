var pas={$libimports:{}},rtl={version:20301,quiet:!1,debug_load_units:!1,debug_rtti:!1,$res:{},debug:function(){!rtl.quiet&&console&&console.log&&console.log(arguments)},error:function(t){throw rtl.debug("Error: ",t),t},warn:function(t){rtl.debug("Warn: ",t)},checkVersion:function(t){if(rtl.version!=t)throw"expected rtl version "+t+", but found "+rtl.version},hiInt:Math.pow(2,53),hasString:function(t){return rtl.isString(t)&&t.length>0},isArray:function(t){return Array.isArray(t)},isFunction:function(t){return"function"==typeof t},isModule:function(t){return rtl.isObject(t)&&rtl.hasString(t.$name)&&pas[t.$name]===t},isImplementation:function(t){return rtl.isObject(t)&&rtl.isModule(t.$module)&&t.$module.$impl===t},isNumber:function(t){return"number"==typeof t},isObject:function(t){return"object"==typeof t&&null!=t},isString:function(t){return"string"==typeof t},getNumber:function(t){return"number"==typeof t?t:NaN},getChar:function(t){return"string"==typeof t&&1===t.length?t:""},getObject:function(t){return"object"==typeof t||"function"==typeof t?t:null},isTRecord:function(t){return rtl.isObject(t)&&t.hasOwnProperty("$new")&&"function"==typeof t.$new},isPasClass:function(t){return rtl.isObject(t)&&t.hasOwnProperty("$classname")&&rtl.isObject(t.$module)},isPasClassInstance:function(t){return rtl.isObject(t)&&rtl.isPasClass(t.$class)},hexStr:function(t,e){return("000000000000000"+t.toString(16).toUpperCase()).slice(-e)},m_loading:0,m_loading_intf:1,m_intf_loaded:2,m_loading_impl:3,m_initializing:4,m_initialized:5,module:function(t,e,i,s){rtl.debug_load_units&&rtl.debug('rtl.module name="'+t+'" intfuses='+e+" impluses="+s),rtl.hasString(t)||rtl.error('invalid module name "'+t+'"'),rtl.isArray(e)||rtl.error('invalid interface useslist of "'+t+'"'),rtl.isFunction(i)||rtl.error('invalid interface code of "'+t+'"'),null==s||rtl.isArray(s)||rtl.error('invalid implementation useslist of "'+t+'"'),pas[t]&&rtl.error('module "'+t+'" is already registered');var n=Object.create(rtl.tSectionRTTI),o=n.$module=pas[t]={$name:t,$intfuseslist:e,$impluseslist:s,$state:rtl.m_loading,$intfcode:i,$implcode:null,$impl:null,$rtti:n};s&&(o.$impl={$module:o,$rtti:n})},exitcode:0,run:function(t){try{rtl.hasString(t)||(t="program"),rtl.debug_load_units&&rtl.debug('rtl.run module="'+t+'"'),rtl.initRTTI();var e=pas[t];if(e||rtl.error('rtl.run module "'+t+'" missing'),rtl.loadintf(e),rtl.loadimpl(e),"program"==t||"library"==t){rtl.debug_load_units&&rtl.debug("running $main");var i=pas[t].$main();rtl.isNumber(i)&&(rtl.exitcode=i)}}catch(t){if(!rtl.showUncaughtExceptions)throw t;rtl.handleUncaughtException(t)||(rtl.showException(t),rtl.exitcode=216)}return rtl.exitcode},showException:function(t){var e=rtl.hasString(t.$classname)?t.$classname:"";e+=(e?": ":"")+(t.hasOwnProperty("fMessage")?t.fMessage:t),alert("Uncaught Exception : "+e)},handleUncaughtException:function(t){if(!rtl.onUncaughtException)return!1;try{return rtl.onUncaughtException(t),!0}catch(t){return!1}},loadintf:function(t){t.$state>rtl.m_loading_intf||(rtl.debug_load_units&&rtl.debug('loadintf: "'+t.$name+'"'),t.$state===rtl.m_loading_intf&&rtl.error('unit cycle detected "'+t.$name+'"'),t.$state=rtl.m_loading_intf,rtl.loaduseslist(t,t.$intfuseslist,rtl.loadintf),rtl.debug_load_units&&rtl.debug('loadintf: run intf of "'+t.$name+'"'),t.$intfcode(t.$intfuseslist),t.$state=rtl.m_intf_loaded)},loaduseslist:function(t,e,i){if(null!=e)for(var s=e.length,n=0;n<s;n++){var o=e[n];rtl.debug_load_units&&rtl.debug('loaduseslist of "'+t.$name+'" uses="'+o+'"'),null==pas[o]&&rtl.error('module "'+t.$name+'" misses "'+o+'"'),i(pas[o])}},loadimpl:function(t){t.$state>=rtl.m_loading_impl||(t.$state<rtl.m_intf_loaded&&rtl.error('loadimpl: interface not loaded of "'+t.$name+'"'),rtl.debug_load_units&&rtl.debug('loadimpl: load uses of "'+t.$name+'"'),t.$state=rtl.m_loading_impl,rtl.loaduseslist(t,t.$impluseslist,rtl.loadintf),rtl.loaduseslist(t,t.$intfuseslist,rtl.loadimpl),rtl.loaduseslist(t,t.$impluseslist,rtl.loadimpl),rtl.debug_load_units&&rtl.debug('loadimpl: run impl of "'+t.$name+'"'),rtl.isFunction(t.$implcode)&&t.$implcode(t.$impluseslist),rtl.debug_load_units&&rtl.debug('loadimpl: run init of "'+t.$name+'"'),t.$state=rtl.m_initializing,rtl.isFunction(t.$init)&&t.$init(),t.$state=rtl.m_initialized)},createCallback:function(t,e){var i;if("string"==typeof e){if(t.hasOwnProperty("$events")||(t.$events={}),i=t.$events[e])return i;t.$events[e]=i=function(){return t[e].apply(t,arguments)}}else i=function(){return e.apply(t,arguments)};return i.scope=t,i.fn=e,i},createSafeCallback:function(t,e){var i;if("string"==typeof e){if(t.hasOwnProperty("$events")||(t.$events={}),i=t.$events[e])return i;t.$events[e]=i=function(){try{return t[e].apply(t,arguments)}catch(t){if(!rtl.handleUncaughtException(t))throw t}}}else i=function(){try{return e.apply(t,arguments)}catch(t){if(!rtl.handleUncaughtException(t))throw t}};return i.scope=t,i.fn=e,i},eqCallback:function(t,e){return t===e||null!=t&&null!=e&&t.fn&&t.scope===e.scope&&t.fn===e.fn},initStruct:function(t,e,i){return e.$module&&e.$module.$impl===e&&(e=e.$module),t.$parent=e,rtl.isModule(e)?(t.$module=e,t.$name=i):(t.$module=e.$module,t.$name=e.$name+"."+i),e},initClass:function(t,e,i,s,n){e[i]=t,t.$class=t,t.$classname=n||i,e=rtl.initStruct(t,e,i),t.$fullname=e.$name+"."+i,rtl.debug_rtti&&rtl.debug("initClass "+t.$fullname);var o=t.$module.$rtti.$Class(t.$classname,{class:t});t.$rtti=o,rtl.isObject(t.$ancestor)&&(o.ancestor=t.$ancestor.$rtti),o.ancestor||(o.ancestor=null),s.call(t)},createClass:function(t,e,i,s,n){var o=null;null!=i?(o=Object.create(i)).$ancestor=i:((o={$ancestor:null}).$create=function(t,e){null==e&&(e=[]);var i=Object.create(this);i.$init();try{"string"==typeof t?i[t].apply(i,e):t.apply(i,e),i.AfterConstruction()}catch(t){throw i.Destroy&&i.Destroy(),i.$final(),t}return i},o.$destroy=function(t){this.BeforeDestruction(),this[t]&&this[t](),this.$final()}),rtl.initClass(o,t,e,s,n)},createClassExt:function(t,e,i,s,n,o){var r=rtl.isFunction(i),a=null;if(r?((a=Object.create(i.prototype)).$ancestorfunc=i,a.$ancestor=null):i.$func?(r=!0,(a=Object.create(i)).$ancestor=i):(a=Object.create(i)).$ancestor=null,a.$create=function(t,e){null==e&&(e=[]);var i=null;(i=s.length>0?this[s](t,e):r?new this.$func(e):Object.create(a)).$init&&i.$init();try{"string"==typeof t?this[t].apply(i,e):t.apply(i,e),i.AfterConstruction&&i.AfterConstruction()}catch(t){throw i.Destroy&&i.Destroy(),i.$final&&i.$final(),t}return i},a.$destroy=function(t){this.BeforeDestruction&&this.BeforeDestruction(),this[t]&&this[t](),this.$final&&this.$final()},rtl.initClass(a,t,e,n,o),r){function l(){}l.prototype=a,a.$func=l}},createHelper:function(t,e,i,s,n){var o=null;null!=i?(o=Object.create(i)).$ancestor=i:o={$ancestor:null},t[e]=o,o.$class=o,o.$classname=n||e,t=rtl.initStruct(o,t,e),o.$fullname=t.$name+"."+e;var r=o.$module.$rtti.$Helper(o.$classname,{helper:o});o.$rtti=r,rtl.isObject(i)&&(r.ancestor=i.$rtti),r.ancestor||(r.ancestor=null),s.call(o)},tObjectDestroy:"Destroy",free:function(t,e){if(null==t[e])return null;t[e].$destroy(rtl.tObjectDestroy),t[e]=null},freeLoc:function(t){return null==t||t.$destroy(rtl.tObjectDestroy),null},hideProp:function(t,e,i){Object.defineProperty(t,e,{enumerable:!1,configurable:!0,writable:!0}),arguments.length>2&&(t[e]=i)},recNewT:function(t,e,i,s){var n={};t&&(t[e]=n);var o=rtl.hideProp;return s&&(rtl.initStruct(n,t,e),n.$record=n,o(n,"$record"),o(n,"$name"),o(n,"$parent"),o(n,"$module"),o(n,"$initSpec")),i.call(n),n.$new||(n.$new=function(){return Object.create(n)}),n.$clone=function(t){return n.$new().$assign(t)},o(n,"$new"),o(n,"$clone"),o(n,"$eq"),o(n,"$assign"),n},is:function(t,e){return e.isPrototypeOf(t)||t===e},isExt:function(t,e,i){return null!=t&&(("object"==typeof e||"function"==typeof e)&&(t===e?1!==i&&(2!==i||rtl.isPasClass(t)):e.isPrototypeOf&&e.isPrototypeOf(t)?1===i?rtl.isPasClassInstance(t):2!==i||rtl.isPasClass(t):"function"==typeof e&&t instanceof e))},Exception:null,EInvalidCast:null,EAbstractError:null,ERangeError:null,EIntOverflow:null,EPropWriteOnly:null,raiseE:function(t){var e=rtl[t];if(null==e){var i=pas.SysUtils;i||(i=pas.sysutils),i&&((e=i[t])||(e=i[t.toLowerCase()]),e||(e=i.Exception),e||(e=i.exception))}if(e){if(e.Create)throw e.$create("Create");if(e.create)throw e.$create("create")}if("EInvalidCast"===t)throw"invalid type cast";if("EAbstractError"===t)throw"Abstract method called";if("ERangeError"===t)throw"range error";throw t},as:function(t,e){if(null===t||rtl.is(t,e))return t;rtl.raiseE("EInvalidCast")},asExt:function(t,e,i){if(null===t||rtl.isExt(t,e,i))return t;rtl.raiseE("EInvalidCast")},createInterface:function(t,e,i,s,n,o){var r=n?Object.create(n):{};if(t[e]=r,r.$module=t,r.$name=e,r.$fullname=t.$name+"."+e,r.$guid=i,r.$guidr=null,r.$names=s||[],rtl.isFunction(o)){rtl.debug_rtti&&rtl.debug("createInterface "+r.$fullname);var a=r.$module.$rtti.$Interface(e,{interface:r,module:t});r.$rtti=a,n&&(a.ancestor=n.$rtti),a.ancestor||(a.ancestor=null),o.call(r)}return r},strToGUIDR:function(t,e){var i=0;function s(e){var s=t.substr(i,e);return i+=e,parseInt(s,16)}i+=1,e.D1=s(8),i+=1,e.D2=s(4),i+=1,e.D3=s(4),i+=1,e.D4||(e.D4=[]),e.D4[0]=s(2),e.D4[1]=s(2),i+=1;for(var n=2;n<8;n++)e.D4[n]=s(2);return e},guidrToStr:function(t){if(t.$intf)return t.$intf.$guid;for(var e=rtl.hexStr,i="{"+e(t.D1,8)+"-"+e(t.D2,4)+"-"+e(t.D3,4)+"-"+e(t.D4[0],2)+e(t.D4[1],2)+"-",s=2;s<8;s++)i+=e(t.D4[s],2);return i+="}"},createTGUID:function(t){var e=pas.System?pas.System.TGuid:pas.system.tguid;return rtl.strToGUIDR(t,e.$new())},getIntfGUIDR:function(t){if(!t)return null;if(!t.$guidr){var e=rtl.createTGUID(t.$guid);t.hasOwnProperty("$guid")||(t=Object.getPrototypeOf(t)),e.$intf=t,t.$guidr=e}return t.$guidr},addIntf:function(t,e,i){function s(t){return"function"==typeof t?function(){return t.apply(this.$o,arguments)}:function(){rtl.raiseE("EAbstractError")}}i||(i={});var n=e,o=Object.create(n);t.hasOwnProperty("$intfmaps")||(t.$intfmaps={}),t.$intfmaps[e.$guid]=o;do{var r=n.$names;if(!r)break;for(var a=0;a<r.length;a++){var l=r[a],h=i[l];h||(h=l),o[l]=s(t[h])}n=Object.getPrototypeOf(n)}while(null!=n)},getIntfG:function(t,e,i){if(!t)return null;var s=t.$intfmaps;if(!s)return null;var n=s[e];if(!n)return null;if("function"==typeof n)return n.call(t);var o=null;if(t.$interfaces&&(o=t.$interfaces[e]),o||((o=Object.create(n)).$o=t,t.$interfaces||(t.$interfaces={}),t.$interfaces[e]=o),"object"==typeof i){var r=null;return 0===o.QueryInterface(rtl.getIntfGUIDR(i),{get:function(){return r},set:function(t){r=t}})?r:null}return 2===i&&"com"===o.$kind&&o._AddRef(),o},getIntfT:function(t,e){return rtl.getIntfG(t,e.$guid)},queryIntfT:function(t,e){return rtl.getIntfG(t,e.$guid,e)},queryIntfIsT:function(t,e){var i=rtl.getIntfG(t,e.$guid);return!!i&&("com"===i.$kind&&i._Release(),!0)},asIntfT:function(t,e){var i=rtl.getIntfG(t,e.$guid);if(null!==i)return i;rtl.raiseEInvalidCast()},intfIsIntfT:function(t,e){return null!==t&&rtl.queryIntfIsT(t.$o,e)},intfAsIntfT:function(t,e){if(!t)return null;var i=rtl.getIntfG(t.$o,e.$guid);if(i)return i;rtl.raiseEInvalidCast()},intfIsClass:function(t,e){return null!=t&&rtl.is(t.$o,e)},intfAsClass:function(t,e){return null==t?null:rtl.as(t.$o,e)},intfToClass:function(t,e){return null!==t&&rtl.is(t.$o,e)?t.$o:null},intfRefs:{ref:function(t,e){var i=this[t];return i&&(delete this[t],i._Release()),e&&(this[t]=e),e},free:function(){for(var t in this)if(this.hasOwnProperty(t)){var e=this[t];e&&e._Release()}}},createIntfRefs:function(){return Object.create(rtl.intfRefs)},setIntfP:function(t,e,i,s){var n=t[e];n!==i&&(null!==n&&(t[e]=null,n._Release()),null!==i&&(s||i._AddRef(),t[e]=i))},setIntfL:function(t,e,i){return t!==e?(null!==e&&(i||e._AddRef()),null!==t&&t._Release()):i&&null!==t&&t._Release(),e},_AddRef:function(t){return t&&t._AddRef(),t},_Release:function(t){return t&&t._Release(),t},_ReleaseArray:function(t,e){if(!t)return null;for(var i=0;i<t.length;i++)e<=1?t[i]&&t[i]._Release():rtl._ReleaseArray(t[i],e-1);return null},trunc:function(t){return t<0?Math.ceil(t):Math.floor(t)},checkMethodCall:function(t,e){rtl.isObject(t)&&rtl.is(t,e)||rtl.raiseE("EInvalidCast")},oc:function(t){if(Math.floor(t)===t&&t>=-9007199254740991&&t<=9007199254740991)return t;rtl.raiseE("EIntOverflow")},rc:function(t,e,i){if(Math.floor(t)===t&&t>=e&&t<=i)return t;rtl.raiseE("ERangeError")},rcc:function(t,e,i){if("string"==typeof t&&1===t.length){var s=t.charCodeAt(0);if(s>=e&&s<=i)return t}rtl.raiseE("ERangeError")},rcSetCharAt:function(t,e,i){return("string"!=typeof t||e<0||e>=t.length)&&rtl.raiseE("ERangeError"),rtl.setCharAt(t,e,i)},rcCharAt:function(t,e){return("string"!=typeof t||e<0||e>=t.length)&&rtl.raiseE("ERangeError"),t.charAt(e)},rcArrR:function(t,e){if(Array.isArray(t)&&"number"==typeof e&&e>=0&&e<t.length){if(arguments.length>2){t=t[e];for(var i=2;i<arguments.length;i++)t=rtl.rcArrR(t,arguments[i]);return t}return t[e]}rtl.raiseE("ERangeError")},rcArrW:function(t,e,i){for(var s=3;s<arguments.length;s++)t=rtl.rcArrR(t,e),e=arguments[s-1],i=arguments[s];if(Array.isArray(t)&&"number"==typeof e&&e>=0&&e<t.length)return t[e]=i;rtl.raiseE("ERangeError")},length:function(t){return null==t?0:t.length},arrayRef:function(t){return null!=t&&rtl.hideProp(t,"$pas2jsrefcnt",1),t},arraySetLength:function(t,e,i){for(var s=[],n=9999,o=2;o<arguments.length;o++){var r=arguments[o];"s"===r?n=o-2:s.push({dim:r+0,a:null,i:0,src:null})}for(var a=s.length-1,l=0,h=0,F=null,p=null,c=t,u=0,T=0;;)if(l>0&&(c=(F=s[l-1]).src&&F.src.length>F.i?F.src[F.i]:null),c?c.$pas2jsrefcnt>0||l>=n?(p=[],T=u=c.length):(u=0,T=(p=c).length):(p=[],u=0,T=0),h=s[l].dim,p.length=h,!(l>0&&(F.a[F.i]=p,F.i++,0===h&&F.i<F.a.length))){if(h>0){if(l<a){(F=s[l]).a=p,F.i=0,F.src=c,l++;continue}if(u>h&&(u=h),rtl.isArray(e)){for(o=0;o<u;o++)p[o]=c[o];for(o=T;o<h;o++)p[o]=[]}else if(rtl.isObject(e))if(rtl.isTRecord(e)){for(o=0;o<u;o++)p[o]=e.$clone(c[o]);for(o=T;o<h;o++)p[o]=e.$new()}else{for(o=0;o<u;o++)p[o]=rtl.refSet(c[o]);for(o=T;o<h;o++)p[o]={}}else{for(o=0;o<u;o++)p[o]=c[o];for(o=T;o<h;o++)p[o]=e}}for(;l>0&&s[l-1].i>=s[l-1].dim;)l--;if(0===l)return 0===a?p:s[0].a}},arrayEq:function(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0},arrayClone:function(t,e,i,s,n,o){if("refSet"===t)for(;i<s;i++)n[o++]=rtl.refSet(e[i]);else if("slice"===t)for(;i<s;i++)n[o++]=e[i].slice(0);else if("function"==typeof t)for(;i<s;i++)n[o++]=t(e[i]);else if(rtl.isTRecord(t))for(;i<s;i++)n[o++]=t.$clone(e[i]);else for(;i<s;i++)n[o++]=e[i]},arrayConcat:function(t){for(var e=[],i=0,s=1;s<arguments.length;s++){null!==(n=arguments[s])&&(i+=n.length)}e.length=i,i=0;for(s=1;s<arguments.length;s++){var n;null!==(n=arguments[s])&&(rtl.arrayClone(t,n,0,n.length,e,i),i+=n.length)}return e},arrayConcatN:function(){for(var t=null,e=0;e<arguments.length;e++){var i=arguments[e];if(null!==i)if(null===t)t=rtl.arrayRef(i);else if(t.$pas2jsrefcnt)t=t.concat(i);else for(e=0;e<i.length;e++)t.push(i[e])}return t},arrayPush:function(t,e){return null===e?e=[]:e.$pas2jsrefcnt&&(e=rtl.arrayCopy(t,e,0,e.length)),rtl.arrayClone(t,arguments,2,arguments.length,e,e.length),e},arrayPushN:function(t){null===t?t=[]:t.$pas2jsrefcnt&&(t=t.concat());for(var e=1;e<arguments.length;e++)t.push(arguments[e]);return t},arrayCopy:function(t,e,i,s){if(null===e)return[];i<0&&(i=0),void 0===s&&(s=e.length);var n=i+s;if(n>e.length&&(n=e.length),i>=n)return[];if(0===t)return e.slice(i,n);var o=[];return o.length=n-i,rtl.arrayClone(t,e,i,n,o,0),o},arrayInsert:function(t,e,i){return e?(e.splice(i,0,t),e):[t]},setCharAt:function(t,e,i){return t.substr(0,e)+i+t.substr(e+1)},getResStr:function(t,e){var i=t.$resourcestrings[e];return i.current?i.current:i.org},createSet:function(){for(var t={},e=0;e<arguments.length;e++)if(null!=arguments[e])t[arguments[e]]=!0;else for(var i=arguments[e+=1],s=arguments[e+=1],n=i;n<=s;n++)t[n]=!0;return t},cloneSet:function(t){var e={};for(var i in t)e[i]=!0;return e},refSet:function(t){return rtl.hideProp(t,"$shared",!0),t},includeSet:function(t,e){return t.$shared&&(t=rtl.cloneSet(t)),t[e]=!0,t},excludeSet:function(t,e){return t.$shared&&(t=rtl.cloneSet(t)),delete t[e],t},diffSet:function(t,e){var i={};for(var s in t)e[s]||(i[s]=!0);return i},unionSet:function(t,e){var i={};for(var s in t)i[s]=!0;for(var s in e)i[s]=!0;return i},intersectSet:function(t,e){var i={};for(var s in t)e[s]&&(i[s]=!0);return i},symDiffSet:function(t,e){var i={};for(var s in t)e[s]||(i[s]=!0);for(var s in e)t[s]||(i[s]=!0);return i},eqSet:function(t,e){for(var i in t)if(!e[i])return!1;for(var i in e)if(!t[i])return!1;return!0},neSet:function(t,e){return!rtl.eqSet(t,e)},leSet:function(t,e){for(var i in t)if(!e[i])return!1;return!0},geSet:function(t,e){for(var i in e)if(!t[i])return!1;return!0},strSetLength:function(t,e){var i=t.length;if(i>e)return t.substring(0,e);if(t.repeat)return t+" ".repeat(e-i);for(;i<e;)t+=" ",i++;return t},spaceLeft:function(t,e){var i=t.length;if(i>=e)return t;if(t.repeat)return" ".repeat(e-i)+t;for(;i<e;)t=" "+t,i++;return t},floatToStr:function(t,e,i){if(arguments.length>2)return rtl.spaceLeft(t.toFixed(i),e);var s="",n=Math.abs(t);n>1&&n<1e10||n>1e-10&&n<1?s="00":(n>1&&n<1e100||n<1e-10)&&(s="0"),arguments.length<2?e=24:e<9&&(e=9);i=e-8;var o=(t>0?" ":"")+t.toExponential(i);return o=o.replace(/e(.)/,"E$1"+s),rtl.spaceLeft(o,e)},valEnum:function(t,e,i){for(var s in t=t.toLowerCase(),e)if("string"==typeof s&&s.toLowerCase()===t)return i(0),e[s];return i(1),0},lw:function(t){return t<0?t+4294967296:t},and:function(t,e){var i=2147483648;return(t/i&e/i)*i+(2147483647&t&e)},or:function(t,e){var i=2147483648;return(t/i|e/i)*i+(2147483647&t|2147483647&e)},xor:function(t,e){var i=2147483648;return(t/i^e/i)*i+(2147483647&t^2147483647&e)},shr:function(t,e){return t<0&&(t+=rtl.hiInt),t<2147483648?t>>e:e<=0?t:e>54?0:Math.floor(t/Math.pow(2,e))},shl:function(t,e){if(t<0&&(t+=rtl.hiInt),e<=0)return t;if(e>54)return 0;var i=t*Math.pow(2,e);return i<=rtl.hiInt?i:i%rtl.hiInt},initRTTI:function(){function t(t,e,i){i||(i=rtl.tTypeInfo),rtl.debug_rtti&&rtl.debug('initRTTI.newBaseTI "'+t+'" '+e+' ("'+i.name+'")');var s=Object.create(i);return s.name=t,s.kind=e,rtl[t]=s,s}function e(e,i,s,n){var o=t(e,1,rtl.tTypeInfoInteger);return o.minvalue=i,o.maxvalue=s,o.ordtype=n,o}function i(t,e){var i=Object.create(rtl.tTypeMember);i.name=t,i.kind=e,rtl[t]=i}rtl.debug_rtti&&rtl.debug("initRTTI"),rtl.tTypeInfo={name:"tTypeInfo",kind:0,$module:null,attr:null},t("tTypeInfoInteger",1),e("shortint",-128,127,0),e("byte",0,255,1),e("smallint",-32768,32767,2),e("word",0,65535,3),e("longint",-2147483648,2147483647,4),e("longword",0,4294967295,5),e("nativeint",-4503599627370496,0xfffffffffffff,6),e("nativeuint",0,0xfffffffffffff,7),t("char",2),t("string",3),t("tTypeInfoEnum",4,rtl.tTypeInfoInteger),t("tTypeInfoSet",5),t("double",6),t("boolean",7),t("tTypeInfoProcVar",8),t("tTypeInfoMethodVar",9,rtl.tTypeInfoProcVar),t("tTypeInfoArray",10),t("tTypeInfoDynArray",11),t("tTypeInfoPointer",15),t("pointer",15,rtl.tTypeInfoPointer).reftype=null,t("jsvalue",16),t("tTypeInfoRefToProcVar",17,rtl.tTypeInfoProcVar),rtl.tTypeMember={attr:null},i("tTypeMemberField",1),i("tTypeMemberMethod",2),i("tTypeMemberProperty",3),rtl.tTypeMembers={};var s=t("tTypeInfoStruct",0);s.$addMember=function(t,e,i){if(rtl.debug_rtti){if(!rtl.hasString(t)||"$"===t.charAt())throw'invalid member "'+t+'", this="'+this.name+'"';if(!rtl.is(e,rtl.tTypeMember))throw'invalid ancestor "'+e+":"+e.name+'", "'+this.name+"."+t+'"';if(null!=i&&"object"!=typeof i)throw'invalid options "'+i+'", "'+this.name+"."+t+'"'}var s=Object.create(e);if(s.name=t,this.members[t]=s,this.names.push(t),rtl.isObject(i))for(var n in i)i.hasOwnProperty(n)&&(s[n]=i[n]);return s},s.addField=function(t,e,i){var s=this.$addMember(t,rtl.tTypeMemberField,i);if(rtl.debug_rtti&&!rtl.is(e,rtl.tTypeInfo))throw'invalid type "'+e+'", "'+this.name+"."+t+'"';return s.typeinfo=e,this.fields.push(t),s},s.addFields=function(){for(var t=0;t<arguments.length;){var e=arguments[t++],i=arguments[t++];t<arguments.length&&"object"==typeof arguments[t]?this.addField(e,i,arguments[t++]):this.addField(e,i)}},s.addMethod=function(t,e,i,s,n,o){var r=this.$addMember(t,rtl.tTypeMemberMethod,o);return r.methodkind=e,r.procsig=rtl.newTIProcSig(i,s,n),this.methods.push(t),r},s.addProperty=function(t,e,i,s,n,o){var r=this.$addMember(t,rtl.tTypeMemberProperty,o);return r.flags=e,r.typeinfo=i,r.getter=s,r.setter=n,r.params=rtl.isArray(r.params)?rtl.newTIParams(r.params):null,this.properties.push(t),rtl.isString(r.stored)||(r.stored=""),r},s.getField=function(t){return this.members[this.fields[t]]},s.getMethod=function(t){return this.members[this.methods[t]]},s.getProperty=function(t){return this.members[this.properties[t]]},t("tTypeInfoRecord",12,rtl.tTypeInfoStruct),t("tTypeInfoClass",13,rtl.tTypeInfoStruct),t("tTypeInfoClassRef",14),t("tTypeInfoInterface",18,rtl.tTypeInfoStruct),t("tTypeInfoHelper",19,rtl.tTypeInfoStruct),t("tTypeInfoExtClass",20,rtl.tTypeInfoClass)},tSectionRTTI:{$module:null,$inherited:function(t,e,i){rtl.debug_rtti&&rtl.debug('tSectionRTTI.newTI "'+(this.$module?this.$module.$name:"(no module)")+'"."'+t+'" ('+e.name+") "+(i?"init":"forward"));var s=this[t];if(s){if(!s.$forward)throw'duplicate type "'+t+'"';if(!e.isPrototypeOf(s))throw'typeinfo ancestor mismatch "'+t+'" ancestor="'+e.name+'" t.name="'+s.name+'"'}else(s=Object.create(e)).name=t,s.$module=this.$module,this[t]=s;if(i)for(var n in delete s.$forward,i)i.hasOwnProperty(n)&&(s[n]=i[n]);else s.$forward=!0;return s},$Scope:function(t,e,i){var s=this.$inherited(t,e,i);return s.members={},s.names=[],s.fields=[],s.methods=[],s.properties=[],s},$TI:function(t,e,i){var s=this.$inherited(t,rtl.tTypeInfo,i);return s.kind=e,s},$Int:function(t,e){return this.$inherited(t,rtl.tTypeInfoInteger,e)},$Enum:function(t,e){return this.$inherited(t,rtl.tTypeInfoEnum,e)},$Set:function(t,e){return this.$inherited(t,rtl.tTypeInfoSet,e)},$StaticArray:function(t,e){return this.$inherited(t,rtl.tTypeInfoArray,e)},$DynArray:function(t,e){return this.$inherited(t,rtl.tTypeInfoDynArray,e)},$ProcVar:function(t,e){return this.$inherited(t,rtl.tTypeInfoProcVar,e)},$RefToProcVar:function(t,e){return this.$inherited(t,rtl.tTypeInfoRefToProcVar,e)},$MethodVar:function(t,e){return this.$inherited(t,rtl.tTypeInfoMethodVar,e)},$Record:function(t,e){return this.$Scope(t,rtl.tTypeInfoRecord,e)},$Class:function(t,e){return this.$Scope(t,rtl.tTypeInfoClass,e)},$ClassRef:function(t,e){return this.$inherited(t,rtl.tTypeInfoClassRef,e)},$Pointer:function(t,e){return this.$inherited(t,rtl.tTypeInfoPointer,e)},$Interface:function(t,e){return this.$Scope(t,rtl.tTypeInfoInterface,e)},$Helper:function(t,e){return this.$Scope(t,rtl.tTypeInfoHelper,e)},$ExtClass:function(t,e){return this.$Scope(t,rtl.tTypeInfoExtClass,e)}},newTIParam:function(t){return{name:t[0],typeinfo:t[1],flags:rtl.isNumber(t[2])?t[2]:0}},newTIParams:function(t){var e=[];if(rtl.isArray(t))for(var i=0;i<t.length;i++)e.push(rtl.newTIParam(t[i]));return e},newTIProcSig:function(t,e,i){return{params:rtl.newTIParams(t),resulttype:e||null,flags:i||0}},addResource:function(t){rtl.$res[t.name]=t},getResource:function(t){var e=rtl.$res[t];return void 0!==e?e:null},getResourceList:function(){return Object.keys(rtl.$res)}};rtl.module("System",[],(function(){"use strict";var t=this,e=t.$impl;this.LineEnding="\n",this.sLineBreak=this.LineEnding,this.MaxLongint=2147483647,this.Maxint=2147483647,this.$rtti.$inherited("TDateTime",rtl.double,{}),this.$rtti.$inherited("TTime",this.$rtti.TDateTime,{}),this.$rtti.$inherited("TDate",this.$rtti.TDateTime,{}),this.TTextLineBreakStyle={0:"tlbsLF",tlbsLF:0,1:"tlbsCRLF",tlbsCRLF:1,2:"tlbsCR",tlbsCR:2},rtl.recNewT(this,"TGuid",(function(){this.D1=0,this.D2=0,this.D3=0,this.$new=function(){var t=Object.create(this);return t.D4=rtl.arraySetLength(null,0,8),t},this.$eq=function(t){return this.D1===t.D1&&this.D2===t.D2&&this.D3===t.D3&&rtl.arrayEq(this.D4,t.D4)},this.$assign=function(t){return this.D1=t.D1,this.D2=t.D2,this.D3=t.D3,this.D4=t.D4.slice(0),this}})),rtl.recNewT(this,"TMethod",(function(){this.Code=null,this.Data=null,this.$eq=function(t){return this.Code===t.Code&&this.Data===t.Data},this.$assign=function(t){return this.Code=t.Code,this.Data=t.Data,this}})),rtl.createClass(this,"TObject",null,(function(){this.$init=function(){},this.$final=function(){},this.Create=function(){return this},this.Destroy=function(){},this.Free=function(){this.$destroy("Destroy")},this.ClassType=function(){return this},this.InheritsFrom=function(t){return null!=t&&(this==t||t.isPrototypeOf(this))},this.MethodName=function(t){var e="";if(e="",null===t)return e;if("function"!=typeof t)return"";var i=0,s=this.$rtti;if(rtl.isObject(t.scope)){if("string"==typeof t.fn)return t.fn;t=t.fn}for(;""===e&&null!=s;){for(i=0;""===e&&i<s.methods.length;)this[s.getMethod(i).name]===t&&(e=s.getMethod(i).name),i+=1;""===e&&(s=s.ancestor)}return e},this.MethodAddress=function(t){var e=null;if(e=null,""===t)return e;var i,s=0,n=this.$rtti,o="";for(i=t.toLowerCase();""===o&&null!=n;){for(s=0;""===o&&s<n.methods.length;)n.getMethod(s).name.toLowerCase()===i&&(o=n.getMethod(s).name),s+=1;""===o&&(n=n.ancestor)}return""!==o&&(e=this[o]),e},this.FieldAddress=function(t){if(null,""===t)return null;for(var e=this.$class,i=null,s=t.toLowerCase(),n=null;null!==e;){for(var o=0,r=(i=e.$rtti).fields.length-1;o<=r;o++)if((n=i.getField(o)).name.toLowerCase()===s)return n;e=e.$ancestor?e.$ancestor:null}return null},this.ClassInfo=function(){return this.$rtti},this.AfterConstruction=function(){},this.BeforeDestruction=function(){},this.GetInterface=function(t,e){var i=t.$intf;return i&&(i=rtl.getIntfG(this,i.$guid,2))?(e.set(i),!0):this.GetInterfaceByStr(rtl.guidrToStr(t),e)},this.GetInterfaceByStr=function(e,i){if(!1,t.IObjectInstance.$str||(t.IObjectInstance.$str=rtl.guidrToStr(t.IObjectInstance)),e==t.IObjectInstance.$str)return i.set(this),!0;var s=rtl.getIntfG(this,e,2);return i.set(s),null!==s},this.Equals=function(t){return t===this}})),rtl.createClass(this,"TCustomAttribute",this.TObject,(function(){})),this.S_OK=0,this.E_NOINTERFACE=-2147467262,rtl.createInterface(this,"IUnknown","{00000000-0000-0000-C000-000000000046}",["QueryInterface","_AddRef","_Release"],null,(function(){this.$kind="com"})),rtl.createClass(this,"TInterfacedObject",this.TObject,(function(){this.$init=function(){t.TObject.$init.call(this),this.fRefCount=0},this.QueryInterface=function(t,e){return this.GetInterface(t,e)?0:-2147467262},this._AddRef=function(){return this.fRefCount+=1,this.fRefCount},this._Release=function(){var t;return this.fRefCount-=1,t=this.fRefCount,0===this.fRefCount&&this.$destroy("Destroy"),t},this.BeforeDestruction=function(){0!==this.fRefCount&&rtl.raiseE("EHeapMemoryError")},rtl.addIntf(this,t.IUnknown)})),this.IObjectInstance=this.TGuid.$clone({D1:3642530548,D2:15507,D3:16911,D4:[163,3,191,91,168,43,253,35]}),this.TTypeKind={0:"tkUnknown",tkUnknown:0,1:"tkInteger",tkInteger:1,2:"tkChar",tkChar:2,3:"tkString",tkString:3,4:"tkEnumeration",tkEnumeration:4,5:"tkSet",tkSet:5,6:"tkDouble",tkDouble:6,7:"tkBool",tkBool:7,8:"tkProcVar",tkProcVar:8,9:"tkMethod",tkMethod:9,10:"tkArray",tkArray:10,11:"tkDynArray",tkDynArray:11,12:"tkRecord",tkRecord:12,13:"tkClass",tkClass:13,14:"tkClassRef",tkClassRef:14,15:"tkPointer",tkPointer:15,16:"tkJSValue",tkJSValue:16,17:"tkRefToProcVar",tkRefToProcVar:17,18:"tkInterface",tkInterface:18,19:"tkHelper",tkHelper:19,20:"tkExtClass",tkExtClass:20},this.$rtti.$Enum("TTypeKind",{minvalue:0,maxvalue:20,ordtype:1,enumtype:this.TTypeKind}),this.tkFloat=6,this.tkAny=rtl.createSet(null,this.TTypeKind.tkUnknown,this.TTypeKind.tkExtClass),this.vtInteger=0,this.vtExtended=3,this.vtWideChar=9,this.vtCurrency=12,this.vtUnicodeString=18,this.vtNativeInt=19,rtl.recNewT(this,"TVarRec",(function(){this.VType=0,this.VJSValue=void 0,this.$eq=function(t){return this.VType===t.VType&&this.VJSValue===t.VJSValue&&this.VJSValue===t.VJSValue&&this.VJSValue===t.VJSValue&&this.VJSValue===t.VJSValue&&this.VJSValue===t.VJSValue&&this.VJSValue===t.VJSValue&&this.VJSValue===t.VJSValue},this.$assign=function(t){return this.VType=t.VType,this.VJSValue=t.VJSValue,this.VJSValue=t.VJSValue,this.VJSValue=t.VJSValue,this.VJSValue=t.VJSValue,this.VJSValue=t.VJSValue,this.VJSValue=t.VJSValue,this.VJSValue=t.VJSValue,this}})),this.VarRecs=function(){var e=[],i=0,s=null;for(e=[];i<arguments.length;)(s=t.TVarRec.$new()).VType=rtl.trunc(arguments[i]),i+=1,s.VJSValue=arguments[i],i+=1,e.push(t.TVarRec.$clone(s));return e},this.Frac=function(t){return t%1},this.Odd=function(t){return!0&t},this.Random=function(t){return Math.floor(Math.random()*t)},this.Sqr$1=function(t){return t*t},this.Trunc=function(e){return Math.trunc||(Math.trunc=function(t){return t=+t,isFinite(t)?t-t%1||(t<0?-0:0===t?t:0):t}),t.Trunc=Math.trunc,Math.trunc(e)},this.DefaultTextLineBreakStyle=0,this.Int=function(e){return t.Trunc(e)},this.Copy=function(t,e,i){return e<1&&(e=1),i>0?t.substring(e-1,e+i-1):""},this.Copy$1=function(t,e){return e<1&&(e=1),t.substr(e-1)},this.Delete=function(e,i,s){var n;i<1||i>e.get().length||s<=0||(n=e.get(),e.set(t.Copy(n,1,i-1)+t.Copy$1(n,i+s)))},this.Pos=function(t,e){return e.indexOf(t)+1},this.Pos$1=function(t,e,i){return e.indexOf(t,i-1)+1},this.Insert=function(e,i,s){var n;""!==e&&(n=i.get(),s<1?i.set(e+n):s>n.length?i.set(n+e):i.set(t.Copy(n,1,s-1)+e+t.Copy(n,s,n.length)))},this.upcase=function(t){return t.toUpperCase()},this.val=function(t,i,s){i.set(e.valint(t,-9007199254740991,9007199254740991,s))},this.val$5=function(t,i,s){i.set(e.valint(t,0,65535,s))},this.val$6=function(t,i,s){i.set(e.valint(t,-2147483648,2147483647,s))},this.val$8=function(t,e,i){var s;""!==t?(s=Number(t),isNaN(s)?i.set(1):(i.set(0),e.set(s))):i.set(1)},this.StringOfChar=function(t,e){var i="";if(e>0&&t.repeat)return t.repeat(e);i="";for(var s=1,n=e;s<=n;s++)s,i+=t;return i},this.Writeln=function(){var t=0,i=0,s="";if(i=arguments.length-1,null!=e.WriteCallBack)for(var n=0,o=i;n<=o;n++)t=n,e.WriteCallBack(arguments[t],t===i);else{s=e.WriteBuf;for(var r=0,a=i;r<=a;r++)s=s+""+arguments[t=r];console.log(s),e.WriteBuf=""}},this.Assigned=function(t){return null!=t&&null!=t&&(!rtl.isArray(t)||t.length>0)},t.$implcode=function(){e.WriteBuf="",e.WriteCallBack=null,e.valint=function(e,i,s,n){var o=0,r=0;if(""===e)return n.set(1),o;if(r=Number(e),isNaN(r)){var a=t.Copy(e,1,1);if("$"===a)r=Number("0x"+t.Copy$1(e,2));else if("&"===a)r=Number("0o"+t.Copy$1(e,2));else{if("%"!==a)return n.set(1),o;r=Number("0b"+t.Copy$1(e,2))}}return isNaN(r)||r!==t.Int(r)?n.set(1):r<i||r>s?n.set(2):(o=t.Trunc(r),n.set(0)),o}},t.$init=function(){rtl.exitcode=0}}),[]),rtl.module("RTLConsts",["System"],(function(){"use strict";this.$resourcestrings={SArgumentMissing:{org:'Missing argument in format "%s"'},SInvalidFormat:{org:'Invalid format specifier : "%s"'},SInvalidArgIndex:{org:'Invalid argument index in format: "%s"'},SListCapacityError:{org:"List capacity (%s) exceeded."},SListCountError:{org:"List count (%s) out of bounds."},SListIndexError:{org:"List index (%s) out of bounds"},SSortedListError:{org:"Operation not allowed on sorted list"},SDuplicateString:{org:"String list does not allow duplicates"},SErrFindNeedsSortedList:{org:"Cannot use find on unsorted list"},SInvalidName:{org:'Invalid component name: "%s"'},SInvalidBoolean:{org:'"%s" is not a valid boolean.'},SDuplicateName:{org:'Duplicate component name: "%s"'},SErrInvalidDate:{org:'Invalid date: "%s"'},SErrInvalidTimeFormat:{org:'Invalid time format: "%s"'},SInvalidDateFormat:{org:'Invalid date format: "%s"'},SCantReadPropertyS:{org:'Cannot read property "%s"'},SCantWritePropertyS:{org:'Cannot write property "%s"'},SErrPropertyNotFound:{org:'Unknown property: "%s"'},SIndexedPropertyNeedsParams:{org:'Indexed property "%s" needs parameters'},SErrInvalidInteger:{org:'Invalid integer value: "%s"'},SErrInvalidFloat:{org:'Invalid floating-point value: "%s"'},SInvalidCurrency:{org:"Invalid currency value: %s"},SInvalidGUID:{org:'"%s" is not a valid GUID value'}}})),rtl.module("Types",["System"],(function(){"use strict";var t=this;this.TDirection={0:"FromBeginning",FromBeginning:0,1:"FromEnd",FromEnd:1},this.TDuplicates={0:"dupIgnore",dupIgnore:0,1:"dupAccept",dupAccept:1,2:"dupError",dupError:2},rtl.recNewT(this,"TPoint",(function(){this.x=0,this.y=0,this.$eq=function(t){return this.x===t.x&&this.y===t.y},this.$assign=function(t){return this.x=t.x,this.y=t.y,this};var e=t.$rtti.$Record("TPoint",{});e.addField("x",rtl.longint),e.addField("y",rtl.longint)})),rtl.recNewT(this,"TRect",(function(){this.Left=0,this.Top=0,this.Right=0,this.Bottom=0,this.$eq=function(t){return this.Left===t.Left&&this.Top===t.Top&&this.Right===t.Right&&this.Bottom===t.Bottom},this.$assign=function(t){return this.Left=t.Left,this.Top=t.Top,this.Right=t.Right,this.Bottom=t.Bottom,this};var e=t.$rtti.$Record("TRect",{});e.addField("Left",rtl.longint),e.addField("Top",rtl.longint),e.addField("Right",rtl.longint),e.addField("Bottom",rtl.longint)})),this.Rect=function(e,i,s,n){var o=t.TRect.$new();return o.Left=e,o.Top=i,o.Right=s,o.Bottom=n,o},this.Point=function(e,i){var s=t.TPoint.$new();return s.x=e,s.y=i,s}})),rtl.module("JS",["System","Types"],(function(){"use strict";var t=this;this.$rtti.$ExtClass("TJSObject",{jsclass:"Object"}),this.JSDelete=function(t,e){return delete t[e]},this.isBoolean=function(t){return"boolean"==typeof t},this.isDate=function(t){return t instanceof Date},this.isInteger=function(t){return Math.floor(t)===t},this.isNull=function(t){return null===t},this.isUndefined=function(t){return null==t},this.toNumber=function(t){return t-0},this.toBoolean=function(e){return!!t.isBoolean(e)&&!(0==e)},this.TJSValueType={0:"jvtNull",jvtNull:0,1:"jvtBoolean",jvtBoolean:1,2:"jvtInteger",jvtInteger:2,3:"jvtFloat",jvtFloat:3,4:"jvtString",jvtString:4,5:"jvtObject",jvtObject:5,6:"jvtArray",jvtArray:6},this.GetValueType=function(e){var i=0,s="";return t.isNull(e)?i=0:"string"===(s=typeof e)?i=4:"boolean"===s?i=1:"object"===s?i=rtl.isArray(e)?6:5:"number"===s&&(i=t.isInteger(e)?2:3),i}})),rtl.module("SysUtils",["System","RTLConsts","JS"],(function(){"use strict";var t=this,e=t.$impl;this.FreeAndNil=function(t){var e=null;null!==(e=t.get())&&(t.set(null),e.$destroy("Destroy"))},this.FloatRecDigits=19,rtl.recNewT(this,"TFloatRec",(function(){this.Exponent=0,this.Negative=!1,this.$new=function(){var t=Object.create(this);return t.Digits=rtl.arraySetLength(null,"",19),t},this.$eq=function(t){return this.Exponent===t.Exponent&&this.Negative===t.Negative&&rtl.arrayEq(this.Digits,t.Digits)},this.$assign=function(t){return this.Exponent=t.Exponent,this.Negative=t.Negative,this.Digits=t.Digits.slice(0),this}})),rtl.recNewT(this,"TFormatSettings",(function(){this.CurrencyDecimals=0,this.CurrencyFormat=0,this.CurrencyString="",this.DateSeparator="",this.DecimalSeparator="",this.LongDateFormat="",this.LongTimeFormat="",this.NegCurrFormat=0,this.ShortDateFormat="",this.ShortTimeFormat="",this.ThousandSeparator="",this.TimeAMString="",this.TimePMString="",this.TimeSeparator="",this.TwoDigitYearCenturyWindow=0,this.InitLocaleHandler=null,this.$new=function(){var t=Object.create(this);return t.DateTimeToStrFormat=rtl.arraySetLength(null,"",2),t.LongDayNames=rtl.arraySetLength(null,"",7),t.LongMonthNames=rtl.arraySetLength(null,"",12),t.ShortDayNames=rtl.arraySetLength(null,"",7),t.ShortMonthNames=rtl.arraySetLength(null,"",12),t},this.$eq=function(t){return this.CurrencyDecimals===t.CurrencyDecimals&&this.CurrencyFormat===t.CurrencyFormat&&this.CurrencyString===t.CurrencyString&&this.DateSeparator===t.DateSeparator&&rtl.arrayEq(this.DateTimeToStrFormat,t.DateTimeToStrFormat)&&this.DecimalSeparator===t.DecimalSeparator&&this.LongDateFormat===t.LongDateFormat&&rtl.arrayEq(this.LongDayNames,t.LongDayNames)&&rtl.arrayEq(this.LongMonthNames,t.LongMonthNames)&&this.LongTimeFormat===t.LongTimeFormat&&this.NegCurrFormat===t.NegCurrFormat&&this.ShortDateFormat===t.ShortDateFormat&&rtl.arrayEq(this.ShortDayNames,t.ShortDayNames)&&rtl.arrayEq(this.ShortMonthNames,t.ShortMonthNames)&&this.ShortTimeFormat===t.ShortTimeFormat&&this.ThousandSeparator===t.ThousandSeparator&&this.TimeAMString===t.TimeAMString&&this.TimePMString===t.TimePMString&&this.TimeSeparator===t.TimeSeparator&&this.TwoDigitYearCenturyWindow===t.TwoDigitYearCenturyWindow},this.$assign=function(t){return this.CurrencyDecimals=t.CurrencyDecimals,this.CurrencyFormat=t.CurrencyFormat,this.CurrencyString=t.CurrencyString,this.DateSeparator=t.DateSeparator,this.DateTimeToStrFormat=t.DateTimeToStrFormat.slice(0),this.DecimalSeparator=t.DecimalSeparator,this.LongDateFormat=t.LongDateFormat,this.LongDayNames=t.LongDayNames.slice(0),this.LongMonthNames=t.LongMonthNames.slice(0),this.LongTimeFormat=t.LongTimeFormat,this.NegCurrFormat=t.NegCurrFormat,this.ShortDateFormat=t.ShortDateFormat,this.ShortDayNames=t.ShortDayNames.slice(0),this.ShortMonthNames=t.ShortMonthNames.slice(0),this.ShortTimeFormat=t.ShortTimeFormat,this.ThousandSeparator=t.ThousandSeparator,this.TimeAMString=t.TimeAMString,this.TimePMString=t.TimePMString,this.TimeSeparator=t.TimeSeparator,this.TwoDigitYearCenturyWindow=t.TwoDigitYearCenturyWindow,this},this.GetJSLocale=function(){return Intl.DateTimeFormat().resolvedOptions().locale},this.GetLocaleDecimalSeparator=function(t){var e=1.1;return e=e.toLocaleString(t).substring(1,2)},this.GetLocaleLongDayName=function(t,e){var i=new Date(2017,0,1);return i.setDate(i.getDate()+t-1),i.toLocaleDateString(e,{weekday:"long"})},this.GetLocaleLongMonthName=function(t,e){return new Date(2017,t-1,1).toLocaleDateString(e,{month:"long"})},this.GetLocaleLongTimeFormat=function(e){var i="";return i="hh:nn:ss","EN-US"===t.UpperCase(e)&&(i="hh:nn:ss AMPM"),i};this.GetLocaleShortDateFormat=function(e){var i;t.TStringHelper.Empty,e=t.TStringHelper.ToLower.call({get:function(){return e},set:function(t){e=t}}),(i=t.TStringHelper.IndexOf.call({get:function(){return e},set:function(t){e=t}},"-"))>=0?e=t.TStringHelper.Substring$1.call({get:function(){return e},set:function(t){e=t}},0,i)+t.TStringHelper.ToUpper.call({a:t.TStringHelper.Substring.call({get:function(){return e},set:function(t){e=t}},i),get:function(){return this.a},set:function(t){this.a=t}}):2===t.TStringHelper.GetLength.call({get:function(){return e},set:function(t){e=t}})&&(e=e+"-"+t.TStringHelper.ToUpper.call({get:function(){return e},set:function(t){e=t}}));return{"ar-SA":"dd/MM/yy","bg-BG":"dd.M.yyyy","ca-ES":"dd/MM/yyyy","zh-TW":"yyyy/M/d","cs-CZ":"d.M.yyyy","da-DK":"dd-MM-yyyy","de-DE":"dd.MM.yyyy","el-GR":"d/M/yyyy","en-US":"M/d/yyyy","fi-FI":"d.M.yyyy","fr-FR":"dd/MM/yyyy","he-IL":"dd/MM/yyyy","hu-HU":"yyyy. MM. dd.","is-IS":"d.M.yyyy","it-IT":"dd/MM/yyyy","ja-JP":"yyyy/MM/dd","ko-KR":"yyyy-MM-dd","nl-NL":"d-M-yyyy","nb-NO":"dd.MM.yyyy","pl-PL":"yyyy-MM-dd","pt-BR":"d/M/yyyy","ro-RO":"dd.MM.yyyy","ru-RU":"dd.MM.yyyy","hr-HR":"d.M.yyyy","sk-SK":"d. M. yyyy","sq-AL":"yyyy-MM-dd","sv-SE":"yyyy-MM-dd","th-TH":"d/M/yyyy","tr-TR":"dd.MM.yyyy","ur-PK":"dd/MM/yyyy","id-ID":"dd/MM/yyyy","uk-UA":"dd.MM.yyyy","be-BY":"dd.MM.yyyy","sl-SI":"d.M.yyyy","et-EE":"d.MM.yyyy","lv-LV":"yyyy.MM.dd.","lt-LT":"yyyy.MM.dd","fa-IR":"MM/dd/yyyy","vi-VN":"dd/MM/yyyy","hy-AM":"dd.MM.yyyy","az-Latn-AZ":"dd.MM.yyyy","eu-ES":"yyyy/MM/dd","mk-MK":"dd.MM.yyyy","af-ZA":"yyyy/MM/dd","ka-GE":"dd.MM.yyyy","fo-FO":"dd-MM-yyyy","hi-IN":"dd-MM-yyyy","ms-MY":"dd/MM/yyyy","kk-KZ":"dd.MM.yyyy","ky-KG":"dd.MM.yy","sw-KE":"M/d/yyyy","uz-Latn-UZ":"dd/MM yyyy","tt-RU":"dd.MM.yyyy","pa-IN":"dd-MM-yy","gu-IN":"dd-MM-yy","ta-IN":"dd-MM-yyyy","te-IN":"dd-MM-yy","kn-IN":"dd-MM-yy","mr-IN":"dd-MM-yyyy","sa-IN":"dd-MM-yyyy","mn-MN":"yy.MM.dd","gl-ES":"dd/MM/yy","kok-IN":"dd-MM-yyyy","syr-SY":"dd/MM/yyyy","dv-MV":"dd/MM/yy","ar-IQ":"dd/MM/yyyy","zh-CN":"yyyy/M/d","de-CH":"dd.MM.yyyy","en-GB":"dd/MM/yyyy","es-MX":"dd/MM/yyyy","fr-BE":"d/MM/yyyy","it-CH":"dd.MM.yyyy","nl-BE":"d/MM/yyyy","nn-NO":"dd.MM.yyyy","pt-PT":"dd-MM-yyyy","sr-Latn-CS":"d.M.yyyy","sv-FI":"d.M.yyyy","az-Cyrl-AZ":"dd.MM.yyyy","ms-BN":"dd/MM/yyyy","uz-Cyrl-UZ":"dd.MM.yyyy","ar-EG":"dd/MM/yyyy","zh-HK":"d/M/yyyy","de-AT":"dd.MM.yyyy","en-AU":"d/MM/yyyy","es-ES":"dd/MM/yyyy","fr-CA":"yyyy-MM-dd","sr-Cyrl-CS":"d.M.yyyy","ar-LY":"dd/MM/yyyy","zh-SG":"d/M/yyyy","de-LU":"dd.MM.yyyy","en-CA":"dd/MM/yyyy","es-GT":"dd/MM/yyyy","fr-CH":"dd.MM.yyyy","ar-DZ":"dd-MM-yyyy","zh-MO":"d/M/yyyy","de-LI":"dd.MM.yyyy","en-NZ":"d/MM/yyyy","es-CR":"dd/MM/yyyy","fr-LU":"dd/MM/yyyy","ar-MA":"dd-MM-yyyy","en-IE":"dd/MM/yyyy","es-PA":"MM/dd/yyyy","fr-MC":"dd/MM/yyyy","ar-TN":"dd-MM-yyyy","en-ZA":"yyyy/MM/dd","es-DO":"dd/MM/yyyy","ar-OM":"dd/MM/yyyy","en-JM":"dd/MM/yyyy","es-VE":"dd/MM/yyyy","ar-YE":"dd/MM/yyyy","en-029":"MM/dd/yyyy","es-CO":"dd/MM/yyyy","ar-SY":"dd/MM/yyyy","en-BZ":"dd/MM/yyyy","es-PE":"dd/MM/yyyy","ar-JO":"dd/MM/yyyy","en-TT":"dd/MM/yyyy","es-AR":"dd/MM/yyyy","ar-LB":"dd/MM/yyyy","en-ZW":"M/d/yyyy","es-EC":"dd/MM/yyyy","ar-KW":"dd/MM/yyyy","en-PH":"M/d/yyyy","es-CL":"dd-MM-yyyy","ar-AE":"dd/MM/yyyy","es-UY":"dd/MM/yyyy","ar-BH":"dd/MM/yyyy","es-PY":"dd/MM/yyyy","ar-QA":"dd/MM/yyyy","es-BO":"dd/MM/yyyy","es-SV":"dd/MM/yyyy","es-HN":"dd/MM/yyyy","es-NI":"dd/MM/yyyy","es-PR":"dd/MM/yyyy","am-ET":"d/M/yyyy","tzm-Latn-DZ":"dd-MM-yyyy","iu-Latn-CA":"d/MM/yyyy","sma-NO":"dd.MM.yyyy","mn-Mong-CN":"yyyy/M/d","gd-GB":"dd/MM/yyyy","en-MY":"d/M/yyyy","prs-AF":"dd/MM/yy","bn-BD":"dd-MM-yy","wo-SN":"dd/MM/yyyy","rw-RW":"M/d/yyyy","qut-GT":"dd/MM/yyyy","sah-RU":"MM.dd.yyyy","gsw-FR":"dd/MM/yyyy","co-FR":"dd/MM/yyyy","oc-FR":"dd/MM/yyyy","mi-NZ":"dd/MM/yyyy","ga-IE":"dd/MM/yyyy","se-SE":"yyyy-MM-dd","br-FR":"dd/MM/yyyy","smn-FI":"d.M.yyyy","moh-CA":"M/d/yyyy","arn-CL":"dd-MM-yyyy","ii-CN":"yyyy/M/d","dsb-DE":"d. M. yyyy","ig-NG":"d/M/yyyy","kl-GL":"dd-MM-yyyy","lb-LU":"dd/MM/yyyy","ba-RU":"dd.MM.yy","nso-ZA":"yyyy/MM/dd","quz-BO":"dd/MM/yyyy","yo-NG":"d/M/yyyy","ha-Latn-NG":"d/M/yyyy","fil-PH":"M/d/yyyy","ps-AF":"dd/MM/yy","fy-NL":"d-M-yyyy","ne-NP":"M/d/yyyy","se-NO":"dd.MM.yyyy","iu-Cans-CA":"d/M/yyyy","sr-Latn-RS":"d.M.yyyy","si-LK":"yyyy-MM-dd","sr-Cyrl-RS":"d.M.yyyy","lo-LA":"dd/MM/yyyy","km-KH":"yyyy-MM-dd","cy-GB":"dd/MM/yyyy","bo-CN":"yyyy/M/d","sms-FI":"d.M.yyyy","as-IN":"dd-MM-yyyy","ml-IN":"dd-MM-yy","en-IN":"dd-MM-yyyy","or-IN":"dd-MM-yy","bn-IN":"dd-MM-yy","tk-TM":"dd.MM.yy","bs-Latn-BA":"d.M.yyyy","mt-MT":"dd/MM/yyyy","sr-Cyrl-ME":"d.M.yyyy","se-FI":"d.M.yyyy","zu-ZA":"yyyy/MM/dd","xh-ZA":"yyyy/MM/dd","tn-ZA":"yyyy/MM/dd","hsb-DE":"d. M. yyyy","bs-Cyrl-BA":"d.M.yyyy","tg-Cyrl-TJ":"dd.MM.yy","sr-Latn-BA":"d.M.yyyy","smj-NO":"dd.MM.yyyy","rm-CH":"dd/MM/yyyy","smj-SE":"yyyy-MM-dd","quz-EC":"dd/MM/yyyy","quz-PE":"dd/MM/yyyy","hr-BA":"d.M.yyyy.","sr-Latn-ME":"d.M.yyyy","sma-SE":"yyyy-MM-dd","en-SG":"d/M/yyyy","ug-CN":"yyyy-M-d","sr-Cyrl-BA":"d.M.yyyy","es-US":"M/d/yyyy"}[e]||"dd/MM/yyyy"},this.GetLocaleShortDayName=function(t,e){var i=new Date(2017,0,1);i.setDate(i.getDate()+t-1);var s="";return s=""==e?navigator.language:e,i.toLocaleDateString(s,{weekday:"short"})},this.GetLocaleShortMonthName=function(t,e){var i=new Date(2017,t-1,1),s="";return s=""==e?navigator.language:e,i.toLocaleDateString(s,{month:"short"})},this.GetLocaleShortTimeFormat=function(e){var i="";return i="hh:nn","EN-US"===t.UpperCase(e)&&(i="h:nn AMPM"),i},this.Create=function(){var e=t.TFormatSettings.$new();return e.$assign(t.TFormatSettings.Create$1(t.TFormatSettings.GetJSLocale())),e};var i=["/",".","-"],s=[":",".","-"],n=[",","."],o=[".",","];this.Create$1=function(e){var r=t.TFormatSettings.$new(),a="",l=0,h="";h=t.UpperCase(e),1===pas.System.Pos("DE-",h)?(r.LongDayNames[0]="Sonntag",r.LongDayNames[1]="Montag",r.LongDayNames[2]="Dienstag",r.LongDayNames[3]="Mittwoch",r.LongDayNames[4]="Donnerstag",r.LongDayNames[5]="Freitag",r.LongDayNames[6]="Samstag",r.ShortDayNames[0]="Son",r.ShortDayNames[1]="Mon",r.ShortDayNames[2]="Die",r.ShortDayNames[3]="Mit",r.ShortDayNames[4]="Don",r.ShortDayNames[5]="Fre",r.ShortDayNames[6]="Sam",r.ShortMonthNames[0]="Jan",r.ShortMonthNames[1]="Feb",r.ShortMonthNames[2]="M�r",r.ShortMonthNames[3]="Apr",r.ShortMonthNames[4]="Mai",r.ShortMonthNames[5]="Jun",r.ShortMonthNames[6]="Jul",r.ShortMonthNames[7]="Aug",r.ShortMonthNames[8]="Sep",r.ShortMonthNames[9]="Okt",r.ShortMonthNames[10]="Nov",r.ShortMonthNames[11]="Dez",r.LongMonthNames[0]="Januar",r.LongMonthNames[1]="Februar",r.LongMonthNames[2]="M�rz",r.LongMonthNames[3]="April",r.LongMonthNames[4]="Mai",r.LongMonthNames[5]="Juni",r.LongMonthNames[6]="Juli",r.LongMonthNames[7]="August",r.LongMonthNames[8]="September",r.LongMonthNames[9]="Oktober",r.LongMonthNames[10]="November",r.LongMonthNames[11]="Dezember"):1===pas.System.Pos("FR-",t.UpperCase(e))?(r.LongDayNames[0]="Dimanche",r.LongDayNames[1]="Lundi",r.LongDayNames[2]="Mardi",r.LongDayNames[3]="Mecredi",r.LongDayNames[4]="Jeudi",r.LongDayNames[5]="Vendredi",r.LongDayNames[6]="Samedi",r.ShortDayNames[0]="Dim",r.ShortDayNames[1]="Lun",r.ShortDayNames[2]="Mar",r.ShortDayNames[3]="Mer",r.ShortDayNames[4]="Jeu",r.ShortDayNames[5]="Ven",r.ShortDayNames[6]="Sam",r.ShortMonthNames[0]="Jan",r.ShortMonthNames[1]="F�v",r.ShortMonthNames[2]="Mar",r.ShortMonthNames[3]="Avr",r.ShortMonthNames[4]="Mai",r.ShortMonthNames[5]="Jun",r.ShortMonthNames[6]="Jul",r.ShortMonthNames[7]="Ao�",r.ShortMonthNames[8]="Sep",r.ShortMonthNames[9]="Oct",r.ShortMonthNames[10]="Nov",r.ShortMonthNames[11]="Dec",r.LongMonthNames[0]="Janvier",r.LongMonthNames[1]="F�vrier",r.LongMonthNames[2]="Mars",r.LongMonthNames[3]="Avril",r.LongMonthNames[4]="Mai",r.LongMonthNames[5]="Juin",r.LongMonthNames[6]="Juillet",r.LongMonthNames[7]="Ao�t",r.LongMonthNames[8]="Septembre",r.LongMonthNames[9]="Octobre",r.LongMonthNames[10]="Novembre",r.LongMonthNames[11]="D�cembre"):1===pas.System.Pos("ES-",t.UpperCase(e))?(r.LongDayNames[0]="Domingo",r.LongDayNames[1]="Lunes",r.LongDayNames[2]="Martes",r.LongDayNames[3]="Mi�rcoles",r.LongDayNames[4]="Jueves",r.LongDayNames[5]="Viernes",r.LongDayNames[6]="S�bado",r.ShortDayNames[0]="Dom",r.ShortDayNames[1]="Lun",r.ShortDayNames[2]="Mar",r.ShortDayNames[3]="Mi�",r.ShortDayNames[4]="Jue",r.ShortDayNames[5]="Vie",r.ShortDayNames[6]="Sab",r.ShortMonthNames[0]="Ene",r.ShortMonthNames[1]="Feb",r.ShortMonthNames[2]="Mar",r.ShortMonthNames[3]="Abr",r.ShortMonthNames[4]="May",r.ShortMonthNames[5]="Jun",r.ShortMonthNames[6]="Jul",r.ShortMonthNames[7]="Ago",r.ShortMonthNames[8]="Sep",r.ShortMonthNames[9]="Oct",r.ShortMonthNames[10]="Nov",r.ShortMonthNames[11]="Dic",r.LongMonthNames[0]="January",r.LongMonthNames[1]="Febrero",r.LongMonthNames[2]="Marzi",r.LongMonthNames[3]="Abril",r.LongMonthNames[4]="Mayo",r.LongMonthNames[5]="Junio",r.LongMonthNames[6]="Julio",r.LongMonthNames[7]="Agusto",r.LongMonthNames[8]="Septiembre",r.LongMonthNames[9]="Octubre",r.LongMonthNames[10]="Noviembre",r.LongMonthNames[11]="Diciembre"):(r.LongDayNames[0]="Sunday",r.LongDayNames[1]="Monday",r.LongDayNames[2]="Tuesday",r.LongDayNames[3]="Wednesday",r.LongDayNames[4]="Thursday",r.LongDayNames[5]="Friday",r.LongDayNames[6]="Saturday",r.ShortDayNames[0]="Sun",r.ShortDayNames[1]="Mon",r.ShortDayNames[2]="Tue",r.ShortDayNames[3]="Wed",r.ShortDayNames[4]="Thu",r.ShortDayNames[5]="Fri",r.ShortDayNames[6]="Sat",r.ShortMonthNames[0]="Jan",r.ShortMonthNames[1]="Feb",r.ShortMonthNames[2]="Mar",r.ShortMonthNames[3]="Apr",r.ShortMonthNames[4]="May",r.ShortMonthNames[5]="Jun",r.ShortMonthNames[6]="Jul",r.ShortMonthNames[7]="Aug",r.ShortMonthNames[8]="Sep",r.ShortMonthNames[9]="Oct",r.ShortMonthNames[10]="Nov",r.ShortMonthNames[11]="Dec",r.LongMonthNames[0]="January",r.LongMonthNames[1]="February",r.LongMonthNames[2]="March",r.LongMonthNames[3]="April",r.LongMonthNames[4]="May",r.LongMonthNames[5]="June",r.LongMonthNames[6]="July",r.LongMonthNames[7]="August",r.LongMonthNames[8]="September",r.LongMonthNames[9]="October",r.LongMonthNames[10]="November",r.LongMonthNames[11]="December"),r.DateTimeToStrFormat[0]="c",r.DateTimeToStrFormat[1]="f",r.DateSeparator="-",r.TimeSeparator=":",r.ShortDateFormat="yyyy-mm-dd",r.LongDateFormat="ddd, yyyy-mm-dd",r.DecimalSeparator=".",r.ThousandSeparator=",",r.TimeAMString="AM",r.TimePMString="PM",r.TwoDigitYearCenturyWindow=50,r.ShortTimeFormat=t.TFormatSettings.GetLocaleShortTimeFormat(e),r.LongTimeFormat=t.TFormatSettings.GetLocaleLongTimeFormat(e),r.ShortDateFormat=t.TFormatSettings.GetLocaleShortDateFormat(e);for(var F=0,p=rtl.length(i)-1;F<=p;F++)l=F,t.TStringHelper.IndexOf.call({p:r,get:function(){return this.p.ShortDateFormat},set:function(t){this.p.ShortDateFormat=t}},i[l])>=0&&(r.DateSeparator=i[l]);var c=new Date("Jan 1, 1980 06:07:08 GMT+00:00");h="";h=""==e?navigator.language:e,a=c.toLocaleTimeString(h);for(var u=0,T=rtl.length(s)-1;u<=T;u++)l=u,t.TStringHelper.IndexOf.call({get:function(){return a},set:function(t){a=t}},s[l])>=0&&(r.TimeSeparator=s[l]);for(l=1;l<=7;l++)r.ShortDayNames[l-1]=t.TFormatSettings.GetLocaleShortDayName(l,e);for(l=1;l<=7;l++)r.LongDayNames[l-1]=t.TFormatSettings.GetLocaleLongDayName(l,e);for(l=1;l<=12;l++)r.ShortMonthNames[l-1]=t.TFormatSettings.GetLocaleShortMonthName(l,e);for(l=1;l<=12;l++)r.LongMonthNames[l-1]=t.TFormatSettings.GetLocaleLongMonthName(l,e);r.DecimalSeparator=t.TFormatSettings.GetLocaleDecimalSeparator(e);for(var C=0,S=rtl.length(n)-1;C<=S;C++)if(l=C,r.DecimalSeparator===n[l]){r.ThousandSeparator=o[l];break}return null!=t.TFormatSettings.InitLocaleHandler&&t.TFormatSettings.InitLocaleHandler(t.UpperCase(e),t.TFormatSettings.$clone(r)),r},this.Invariant=function(){var i=t.TFormatSettings.$new();return e.FInvariantCreated||(e.FInvariant.$assign(t.TFormatSettings.Create$1("EN-US")),e.FInvariant.CurrencyString="¤",e.FInvariant.CurrencyFormat=0,e.FInvariant.CurrencyDecimals=2,e.FInvariant.DateSeparator="/",e.FInvariant.TimeSeparator=":",e.FInvariant.ShortDateFormat="MM/dd/yyyy",e.FInvariant.LongDateFormat="dddd, dd MMMMM yyyy HH:mm:ss",e.FInvariant.TimeAMString="AM",e.FInvariant.TimePMString="PM",e.FInvariant.ShortTimeFormat="HH:mm",e.FInvariant.LongTimeFormat="HH:mm:ss",e.FInvariant.ShortMonthNames=e.DefaultShortMonthNames.slice(0),e.FInvariant.LongMonthNames=e.DefaultLongMonthNames.slice(0),e.FInvariant.ShortDayNames=e.DefaultShortDayNames.slice(0),e.FInvariant.LongDayNames=e.DefaultLongDayNames.slice(0),e.FInvariant.ThousandSeparator=",",e.FInvariant.DecimalSeparator=".",e.FInvariant.TwoDigitYearCenturyWindow=50,e.FInvariant.NegCurrFormat=0,e.FInvariantCreated=!0),i.$assign(e.FInvariant),i}}),!0),rtl.createClass(this,"Exception",pas.System.TObject,(function(){this.LogMessageOnCreate=!1,this.$init=function(){pas.System.TObject.$init.call(this),this.fMessage=""},this.Create$1=function(t){return this.fMessage=t,this.LogMessageOnCreate&&pas.System.Writeln("Created exception ",this.$classname," with message: ",t),this},this.CreateFmt=function(e,i){return this.Create$1(t.Format(e,i)),this}})),rtl.createClass(this,"EExternal",this.Exception,(function(){})),rtl.createClass(this,"EAbort",this.Exception,(function(){})),rtl.createClass(this,"EConvertError",this.Exception,(function(){})),rtl.createClass(this,"EIntError",this.EExternal,(function(){})),rtl.createClass(this,"ERangeError",this.EIntError,(function(){})),rtl.createClass(this,"EVariantError",this.Exception,(function(){})),rtl.createClass(this,"EArgumentException",this.Exception,(function(){})),rtl.createClass(this,"EArgumentOutOfRangeException",this.EArgumentException,(function(){})),this.Trim=function(t){return t.replace(/^[\s\uFEFF\xA0\x00-\x1f]+/,"").replace(/[\s\uFEFF\xA0\x00-\x1f]+$/,"")},this.TrimLeft=function(t){return t.replace(/^[\s\uFEFF\xA0\x00-\x1f]+/,"")},this.UpperCase=function(t){return t.toUpperCase()},this.LowerCase=function(t){return t.toLowerCase()},this.CompareStr=function(t,e){var i,s=t.length,n=e.length;return s<=n?t<(i=e.substr(0,s))?-1:t>i?1:s<n?-1:0:(i=t.substr(0,n))<e?-1:1},this.SameStr=function(t,e){return t==e},this.CompareText=function(t,e){var i=t.toLowerCase(),s=e.toLowerCase();return i>s?1:i<s?-1:0},this.SameText=function(t,e){return t.toLowerCase()==e.toLowerCase()},this.AnsiSameText=function(t,e){return t.toLowerCase()==e.toLowerCase()},this.AnsiCompareStr=function(e,i){return t.CompareText(e,i)},this.Format=function(e,i){return t.Format$1(e,i,t.FormatSettings)},this.Format$1=function(i,s,n){var o="",r=0,a=0,l=0,h=0,F=0,p="",c="",u=0,T=0,C=0,S=!1,d=0;function m(){var t=0;function n(){var n=0,o=0;if(-1===t){for(a=r;r<=F&&i.charAt(r-1)<="9"&&i.charAt(r-1)>="0";)r+=1;if(r>F&&e.DoFormatError(1,i),"*"===i.charAt(r-1)){255===u?o=l:(o=u,u+=1),(r>a||o>rtl.length(s)-1)&&e.DoFormatError(1,i),l=o+1;var h=s[o].VType;0===h||19===h?t=s[o].VJSValue:e.DoFormatError(1,i),r+=1}else a<r?(pas.System.val(pas.System.Copy(i,a,r-a),{get:function(){return t},set:function(e){t=e}},{get:function(){return n},set:function(t){n=t}}),n>0&&e.DoFormatError(1,i)):t=-1}}return u=255,T=-1,C=-1,t=-1,r+=1,"%"===i.charAt(r-1)?"%":(":"!==i.charAt(r-1)?n():t=0,":"===i.charAt(r-1)&&(-1===t&&e.DoFormatError(2,i),u=t,t=-1,r+=1),"-"===i.charAt(r-1)?(S=!0,r+=1):S=!1,n(),-1!==t&&(T=t,t=-1),"."===i.charAt(r-1)&&(r+=1,n(),-1===t&&(t=0),C=t),pas.System.upcase(i.charAt(r-1)))}function f(t,n){var o=!1;return o=!1,l=(h=255===u?l:u)+1,h>rtl.length(s)-1||s[h].VType!==t?(n&&e.DoFormatError(3,i),l-=1,o):o=!0}for(o="",F=i.length,r=1,a=1,l=0;r<=F;){for(;r<=F&&"%"!==i.charAt(r-1);)r+=1;if(r>a&&(o+=pas.System.Copy(i,a,r-a)),r<F){var g=m();if("D"===g)(f(0,!1)||f(19,!0))&&(c=t.IntToStr(s[h].VJSValue)),T=Math.abs(T),u=C-c.length,"-"!==c.charAt(0)?c=pas.System.StringOfChar("0",u)+c:pas.System.Insert(pas.System.StringOfChar("0",u+1),{get:function(){return c},set:function(t){c=t}},2);else if("U"===g)f(0,!1)?c=t.IntToStr(s[h].VJSValue>>>0):f(19,!0)&&(c=t.IntToStr(s[h].VJSValue)),T=Math.abs(T),u=C-c.length,c=pas.System.StringOfChar("0",u)+c;else if("E"===g)f(12,!1)?c=t.FloatToStrF$1(s[h].VJSValue/1e4,2,3,C,n):f(3,!0)&&(c=t.FloatToStrF$1(s[h].VJSValue,2,3,C,n));else if("F"===g)f(12,!1)?c=t.FloatToStrF$1(s[h].VJSValue/1e4,0,9999,C,n):(f(0,!1)||f(3,!0))&&(c=t.FloatToStrF$1(s[h].VJSValue,0,9999,C,n));else if("G"===g)f(12,!1)?c=t.FloatToStrF$1(s[h].VJSValue/1e4,1,C,3,n):f(3,!0)&&(c=t.FloatToStrF$1(s[h].VJSValue,1,C,3,n));else if("N"===g)f(12,!1)?c=t.FloatToStrF$1(s[h].VJSValue/1e4,3,9999,C,n):f(3,!0)&&(c=t.FloatToStrF$1(s[h].VJSValue,3,9999,C,n));else if("M"===g)f(12,!1)?c=t.FloatToStrF$1(s[h].VJSValue/1e4,4,9999,C,n):f(3,!0)&&(c=t.FloatToStrF$1(s[h].VJSValue,4,9999,C,n));else if("S"===g)(f(18,!1)||f(9,!0))&&(p=s[h].VJSValue),u=p.length,-1!==C&&u>C&&(u=C),c=pas.System.Copy(p,1,u);else if("P"===g)f(0,!1)?c=t.IntToHex(s[h].VJSValue,8):f(0,!0)&&(c=t.IntToHex(s[h].VJSValue,16));else if("X"===g)if(f(0,!1)?(d=s[h].VJSValue,u=16):f(19,!0)&&(d=s[h].VJSValue,u=31),C>u)c=t.IntToHex(d,u);else{for(u=1;rtl.shl(1,4*u)<=d&&u<16;)u+=1;u>C&&(C=u),c=t.IntToHex(d,C)}else"%"===g&&(c="%");-1!==T&&c.length<T&&(S?c+=pas.System.StringOfChar(" ",T-c.length):c=pas.System.StringOfChar(" ",T-c.length)+c),o+=c}a=r+=1}return o},this.BytesOf=function(t){var e=[],i=0;e=rtl.arraySetLength(e,0,t.length);for(var s=0,n=t.length-1;s<=n;s++)e[i=s]=t.charCodeAt(i+1-1);return e},this.StringOf=function(t){var e="",i=0;e="";for(var s=0,n=rtl.length(t)-1;s<=n;s++)i=s,e+=String.fromCharCode(t[i]);return e};var i=rtl.createSet(null,65,90,null,97,122,95),s=rtl.unionSet(i,rtl.createSet(null,48,57));this.IsValidIdent=function(t,e,n){var o,r=!1,a=!1,l=0;if((o=t.length)<1)return!1;for(a=!0,r=!1,l=1;l<=o;){if(a){if(!(t.charCodeAt(l-1)in i))return r;a=!1}else if(e&&"."===t.charAt(l-1)){if(n){if(l>=o)return r;a=!0}}else if(!(t.charCodeAt(l-1)in s))return r;l+=1}return r=!0},this.TStringReplaceFlag={0:"rfReplaceAll",rfReplaceAll:0,1:"rfIgnoreCase",rfIgnoreCase:1},this.StringReplace=function(t,i,s,n){var o,r="";return r="",0 in n&&(r="g"),1 in n&&(r+="i"),o=i.replace(new RegExp(e.RESpecials,"g"),"\\$1"),t.replace(new RegExp(o,r),s)},this.IntToStr=function(t){return""+t},this.TryStrToInt=function(e,i){return t.TryStrToInt$1(e,i,t.FormatSettings)},this.TryStrToInt$1=function(e,i,s){var n=!1,o=0;return(n=(n=t.TryStrToInt$3(e,{get:function(){return o},set:function(t){o=t}},s))&&-2147483648<=o&&o<=2147483647)&&i.set(o),n},this.TryStrToInt$2=function(i,s){return e.IntTryStrToInt(i,s,t.FormatSettings.DecimalSeparator)},this.TryStrToInt$3=function(t,i,s){return e.IntTryStrToInt(t,i,s.DecimalSeparator)},this.StrToIntDef=function(e,i){var s=0;return t.TryStrToInt$2(e,{get:function(){return s},set:function(t){s=t}})?s:i},this.StrToIntDef$1=function(e,i){var s=0;return t.TryStrToInt$2(e,{get:function(){return s},set:function(t){s=t}})?s:i},this.StrToInt=function(e){var i=0;if(!t.TryStrToInt$2(e,{get:function(){return i},set:function(t){i=t}}))throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SErrInvalidInteger"),pas.System.VarRecs(18,e)]);return i},this.StrToInt64=function(e){var i=0;if(!t.TryStrToInt$2(e,{get:function(){return i},set:function(t){i=t}}))throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SErrInvalidInteger"),pas.System.VarRecs(18,e)]);return i},this.TryStrToInt64=function(e,i){var s,n=0;return(s=t.TryStrToInt$2(e,{get:function(){return n},set:function(t){n=t}}))&&i.set(n),s},this.IntToHex=function(e,i){var s="";for(s="",e<0&&e<0&&(e=4294967295+e+1),s=e.toString(16),s=t.UpperCase(s);s.length<i;)s="0"+s;return s},this.TFloatFormat={0:"ffFixed",ffFixed:0,1:"ffGeneral",ffGeneral:1,2:"ffExponent",ffExponent:2,3:"ffNumber",ffNumber:3,4:"ffCurrency",ffCurrency:4};this.FloatToDecimal=function(e,i,s){var n=t.TFloatRec.$new(),o="",r="",a=0,l=0,h=0,F=0,p=0,c=!1,u=!1;for(n.Negative=!1,n.Exponent=0,p=0;p<=19;p++)n.Digits[p]="0";if(0===e)return n;for(h=1,F=(o=e.toPrecision(21)).length;" "===o.charAt(h-1);)h+=1;if(n.Negative="-"===o.charAt(h-1),(n.Negative||"+"===o.charAt(h-1))&&(h+=1),F>=h+2){if("Inf"===(r=pas.System.Copy(o,h,3)))return n.Digits[0]="\0",n.Exponent=32767,n;if("Nan"===r)return n.Digits[0]="\0",n.Exponent=-32768,n}for(a=0,n.Exponent=0,u=!0,c=!1;F>=h&&"E"!==o.charAt(h-1);)"."===o.charAt(h-1)?u=!1:(u?(n.Exponent+=1,n.Digits[a]=o.charAt(h-1),"0"!==o.charAt(h-1)&&(c=!0)):n.Digits[a]=o.charAt(h-1),a+=1),h+=1;for((h+=1)<=F&&(pas.System.val$6(pas.System.Copy(o,h,F-h+1),{get:function(){return p},set:function(t){p=t}},{get:function(){return l},set:function(t){l=t}}),n.Exponent+=p),h=a,F=19;h<F;)n.Digits[h]="0",h+=1;if((h=s+n.Exponent<i?s+n.Exponent:i)>=F&&(h=F-1),0===h)n.Digits[0]>="5"?(n.Digits[0]="1",n.Digits[1]="\0",n.Exponent+=1):n.Digits[0]="\0";else if(h>0)if(n.Digits[h]>="5"){do{n.Digits[h]="\0",h-=1,n.Digits[h]="123456789:".charAt(t.StrToInt(n.Digits[h])+1-1)}while(!(0===h||n.Digits[h]<":"));":"===n.Digits[0]&&(n.Digits[0]="1",n.Exponent+=1)}else for(n.Digits[h]="0";h>-1&&"0"===n.Digits[h];)n.Digits[h]="\0",h-=1;else n.Digits[0]="\0";return"\0"!==n.Digits[0]||c||(n.Exponent=0,n.Negative=!1),n},this.FloatToStr=function(e){return t.FloatToStr$1(e,t.FormatSettings)},this.FloatToStr$1=function(e,i){return t.FloatToStrF$1(e,1,15,0,i)},this.FloatToStrF$1=function(t,i,s,n,o){var r,a,l="";a=o.DecimalSeparator,r=o.ThousandSeparator;var h=i;return 1===h?l=e.FormatGeneralFloat(t,s,a):2===h?l=e.FormatExponentFloat(t,s,n,a):0===h?l=e.FormatFixedFloat(t,n,a):3===h?l=e.FormatNumberFloat(t,n,a,r):4===h&&(l=e.FormatNumberCurrency(1e4*t,n,o)),4!==i&&l.length>1&&"-"===l.charAt(0)&&e.RemoveLeadingNegativeSign({get:function(){return l},set:function(t){l=t}},a,r),l},this.TryStrToFloat=function(e,i){return t.TryStrToFloat$2(e,i)},this.TryStrToFloat$2=function(e,i){return t.TryStrToFloat$3(e,i,t.FormatSettings)},this.TryStrToFloat$3=function(e,i,s){var n,o,r="";return r=e,""!==s.ThousandSeparator&&(r=t.StringReplace(r,s.ThousandSeparator,"",rtl.createSet(0))),"."!==s.DecimalSeparator&&(r=t.StringReplace(r,s.DecimalSeparator,".",{})),o=parseFloat(r),(n=!isNaN(o))&&i.set(rtl.getNumber(o)),n},this.StrToFloatDef=function(e,i){var s=0;return t.TryStrToFloat$3(e,{get:function(){return s},set:function(t){s=t}},t.FormatSettings)||(s=i),s},this.StrToFloat=function(e){return t.StrToFloat$1(e,t.FormatSettings)},this.StrToFloat$1=function(e,i){var s=0;if(!t.TryStrToFloat$3(e,{get:function(){return s},set:function(t){s=t}},i))throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SErrInvalidFloat"),pas.System.VarRecs(18,e)]);return s},this.FormatFloat=function(e,i){return t.FormatFloat$1(e,i,t.TFormatSettings.$clone(t.FormatSettings))};this.FormatFloat$1=function(e,i,s){var n="",o=0,r=t.TFloatRec.$new(),a="",l=0,h=!1,F=!1,p=0,c=0,u=0,T=0,C=0,S=0,d=0,m=0,f=0;function g(t){n+=t}function y(t){n+=t}function b(t){"\0"!==t&&(-1===(f-=1)?(y(s.DecimalSeparator),g(t)):(g(t),h&&f%3==0&&f>1&&y(s.ThousandSeparator)))}function N(){var t="";return t="\0",d<=S?(t=r.Digits[d],d+=1):f<=u?f-=1:t="0",t}function M(){if(0===m)b(N());else if(m<0)m+=1,f<=c?b("0"):f-=1;else{for(;m>0;)b(N()),m-=1;b(N())}}function B(e,i){var s="";return s=t.IntToStr(i),s=pas.System.StringOfChar("0",C-s.length)+s,i<0?s="-"+s:i>0&&"+"===e&&(s=e+s),s}var E=0,L=0,D="",A="",$=[],I=!1;for($=rtl.arraySetLength($,0,4),n="",a="",l=0,h=!1,F=!1,p=0,c=2147483647,u=0,T=0,C=0,S=-1,L=(o=i)>0?1:o<0?2:3,$[0]=0,((E=function(i){var s,n=0,o=0,r="",a="",l=!1;for(n=1,i.get()[1]=-1,i.get()[2]=-1,i.get()[3]=-1,l=!1,a="\0",o=1,s=e.length;o<=s;){var h=r=e.charAt(o-1);if(";"===h){if(!l){if(n>3)throw t.Exception.$create("Create$1",["Invalid float format"]);i.get()[n]=o,n+=1}}else'"'!==h&&"'"!==h||(l?l=r!==a:(l=!0,a=r));o+=1}return-1===i.get()[n]&&(i.get()[n]=s+1),n}({get:function(){return $},set:function(t){$=t}}))<L||$[L]-$[L-1]==0)&&(L=1),l=$[L]-$[L-1]-1,a=pas.System.Copy(e,$[L-1]+1,l),a=rtl.strSetLength(a,l),function(){var t,e=0,i="",n="",o=!1;for(t=a.length,e=1,o=!1,i="\0";e<=t;){if((n=a.charAt(e-1)).charCodeAt()in rtl.createSet(34,39))o?o=n!==i:(o=!0,i=n);else if(!o){var r=n;if("."===r)0===p&&(p=T+1);else if(","===r)h="\0"!==s.ThousandSeparator;else if("e"===r||"E"===r){if((e+=1)<t){if(n=a.charAt(e-1),F=n.charCodeAt()in rtl.createSet(45,43))for(;e<t&&"0"===a.charAt(e+1-1);)C+=1,e+=1;C>4&&(C=4)}}else"#"===r?T+=1:"0"===r&&(T<c&&(c=T+1),u=(T+=1)+1)}e+=1}0===p&&(p=T+1),(u=p-u)>0&&(u=0),(c=p-c)<0&&(c=0)}(),function(){var e=0,s=0;for(F?(s=T,e=9999):(s=18,e=T-p+1),r.$assign(t.FloatToDecimal(i,s,e)),f=p-1,F?m=0:(m=r.Exponent-(p-1))>=0&&(f=r.Exponent),S=-1;S<18&&"\0"!==r.Digits[S+1];)S+=1}(),(0===l||r.Exponent>=18&&!F||2047===r.Exponent||2048===r.Exponent)&&(a=o.toPrecision(15),n=a),E=1,d=0,A=" ",I=!1,r.Negative&&1===L&&g("-");E<=l;){if((D=a.charAt(E-1)).charCodeAt()in rtl.createSet(34,39))I?I=D!==A:(I=!0,A=D);else if(I)g(D);else{var P=D;if("0"===P||"#"===P)M();else if("."===P||","===P);else if("e"===P||"E"===P){if(g(D),(E+=1)<=a.length&&(D=a.charAt(E-1)).charCodeAt()in rtl.createSet(43,45))for(y(B(D,r.Exponent-p+1));E<l&&"0"===a.charAt(E+1-1);)E+=1}else g(D)}E+=1}return n},this.TrueBoolStrs=[],this.FalseBoolStrs=[],this.StrToBool=function(e){var i=!1;if(!t.TryStrToBool(e,{get:function(){return i},set:function(t){i=t}}))throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidBoolean"),pas.System.VarRecs(18,e)]);return i},this.BoolToStr=function(i,s){var n="";return s?(e.CheckBoolStrs(),n=i?t.TrueBoolStrs[0]:t.FalseBoolStrs[0]):n=i?"-1":"0",n},this.StrToBoolDef=function(e,i){var s=!1;return t.TryStrToBool(e,{get:function(){return s},set:function(t){s=t}})||(s=i),s},this.TryStrToBool=function(i,s){var n,o=!1,r=0,a=0,l=0;if(n=t.UpperCase(i),pas.System.val$8(n,{get:function(){return a},set:function(t){a=t}},{get:function(){return l},set:function(t){l=t}}),o=!0,0===l)s.set(0!==a);else{e.CheckBoolStrs();for(var h=0,F=rtl.length(t.TrueBoolStrs)-1;h<=F;h++)if(r=h,n===t.UpperCase(t.TrueBoolStrs[r]))return s.set(!0),o;for(var p=0,c=rtl.length(t.FalseBoolStrs)-1;p<=c;p++)if(r=p,n===t.UpperCase(t.FalseBoolStrs[r]))return s.set(!1),o;o=!1}return o},this.OnShowException=null,this.ShowException=function(i,s){var n="";n=rtl.getResStr(t,"SApplicationException")+i.$classname,t.Exception.isPrototypeOf(i)&&(n=n+" : "+i.fMessage),e.DoShowException(n)},this.Abort=function(){throw t.EAbort.$create("Create$1",[rtl.getResStr(t,"SAbortError")])},rtl.recNewT(this,"TTimeStamp",(function(){this.Time=0,this.Date=0,this.$eq=function(t){return this.Time===t.Time&&this.Date===t.Date},this.$assign=function(t){return this.Time=t.Time,this.Date=t.Date,this}})),this.TimeSeparator="",this.DateSeparator="",this.ShortDateFormat="",this.LongDateFormat="",this.ShortTimeFormat="",this.LongTimeFormat="",this.DecimalSeparator="",this.ThousandSeparator="",this.TimeAMString="",this.TimePMString="",this.HoursPerDay=24,this.MinsPerHour=60,this.SecsPerMin=60,this.MSecsPerSec=1e3,this.MinsPerDay=1440,this.SecsPerDay=86400,this.MSecsPerDay=864e5,this.MaxDateTime=2958465.99999999,this.DateDelta=693594,this.MonthDays$a$clone=function(t){var e=[];e.length=2;for(var i=0;i<2;i++)e[i]=t[i].slice(0);return e},this.MonthDays=[[31,28,31,30,31,30,31,31,30,31,30,31],[31,29,31,30,31,30,31,31,30,31,30,31]],this.ShortMonthNames=rtl.arraySetLength(null,"",12),this.LongMonthNames=rtl.arraySetLength(null,"",12),this.ShortDayNames=rtl.arraySetLength(null,"",7),this.LongDayNames=rtl.arraySetLength(null,"",7),this.FormatSettings=this.TFormatSettings.$new(),this.TwoDigitYearCenturyWindow=50,this.JSDateToDateTime=function(e){return t.EncodeDate(e.getFullYear(),e.getMonth()+1,e.getDate())+t.EncodeTime(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())},this.DateTimeToTimeStamp=function(e){var i=t.TTimeStamp.$new(),s=0;return(s=864e5*e)<0?s-=.5:s+=.5,i.Time=pas.System.Trunc(Math.abs(pas.System.Trunc(s))%864e5),i.Date=693594+rtl.trunc(pas.System.Trunc(s)/864e5),i},this.TryEncodeDate=function(e,i,s,n){var o,r=0,a=0;return(o=e>0&&e<1e4&&i>=1&&i<=12&&s>0&&s<=t.MonthDays[+t.IsLeapYear(e)][i-1])&&(i>2?i-=3:(i+=9,e-=1),a=e-100*(r=rtl.trunc(e/100)),n.set((146097*r>>>2)+(1461*a>>>2)+rtl.trunc((153*i+2)/5)+s),n.set(n.get()-693900)),o},this.TryEncodeTime=function(t,e,i,s,n){var o;return(o=t<24&&e<60&&i<60&&s<1e3)&&n.set((36e5*t+6e4*e+1e3*i+s)/864e5),o},this.EncodeDate=function(e,i,s){var n=0;if(!t.TryEncodeDate(e,i,s,{get:function(){return n},set:function(t){n=t}}))throw t.EConvertError.$create("CreateFmt",["%s-%s-%s is not a valid date specification",pas.System.VarRecs(18,t.IntToStr(e),18,t.IntToStr(i),18,t.IntToStr(s))]);return n},this.EncodeTime=function(e,i,s,n){var o=0;if(!t.TryEncodeTime(e,i,s,n,{get:function(){return o},set:function(t){o=t}}))throw t.EConvertError.$create("CreateFmt",["%s:%s:%s.%s is not a valid time specification",pas.System.VarRecs(18,t.IntToStr(e),18,t.IntToStr(i),18,t.IntToStr(s),18,t.IntToStr(n))]);return o},this.DecodeDate=function(e,i,s,n){var o=0,r=0,a=0,l=0;e<=-693594?(i.set(0),s.set(0),n.set(0)):(e>0?e+=1/1728e5:e-=1/1728e5,e>t.MaxDateTime&&(e=t.MaxDateTime),l=rtl.shl(pas.System.Trunc(e)+693900,2)-1,l-=146097*(o=rtl.trunc(l/146097)),r=rtl.lw(l>>>2),l=rtl.trunc((rtl.lw(r<<2)+3)/1461),r=rtl.lw(rtl.lw(r<<2)+7-1461*l>>>2),a=rtl.trunc((5*r-3)/153),r=rtl.trunc((5*r+2-153*a)/5),o=100*o+l,a<10?a+=3:(a-=9,o+=1),i.set(o),s.set(a),n.set(r))},this.DecodeTime=function(e,i,s,n,o){var r=0;r=t.DateTimeToTimeStamp(e).Time,i.set(rtl.trunc(r/36e5)),r%=36e5,s.set(rtl.trunc(r/6e4)),r%=6e4,n.set(rtl.trunc(r/1e3)),r%=1e3,o.set(r)},this.DecodeDateFully=function(e,i,s,n,o){return t.DecodeDate(e,i,s,n),o.set(t.DayOfWeek(e)),t.IsLeapYear(i.get())},this.ComposeDateTime=function(t,e){return t<0?pas.System.Trunc(t)-Math.abs(pas.System.Frac(e)):pas.System.Trunc(t)+Math.abs(pas.System.Frac(e))},this.Date=function(){return pas.System.Trunc(t.Now())},this.Time=function(){return t.Now()-t.Date()},this.Now=function(){return t.JSDateToDateTime(new Date)},this.DayOfWeek=function(t){var e=0;return(e=1+(pas.System.Trunc(t)-1)%7)<=0&&(e+=7),e},this.IsLeapYear=function(t){return t%4==0&&(t%100!=0||t%400==0)},this.DateToStr=function(e){return t.DateToStr$1(e,t.FormatSettings)},this.DateToStr$1=function(e,i){return t.FormatDateTime$1("ddddd",e,i)},this.StrToDate=function(e){return t.StrToDate$3(e,t.FormatSettings)},this.StrToDate$2=function(i,s,n){var o,r="";if(o=e.IntStrToDate({get:function(){return r},set:function(t){r=t}},i,s,n),""!==r)throw t.EConvertError.$create("Create$1",[r]);return o},this.StrToDate$3=function(e,i){return t.StrToDate$2(e,i.ShortDateFormat,i.DateSeparator)},this.TryStrToDate=function(e,i){return t.TryStrToDate$1(e,i,t.FormatSettings)},this.TryStrToDate$1=function(e,i,s){return t.TryStrToDate$3(e,i,s.ShortDateFormat,s.DateSeparator)},this.TryStrToDate$2=function(e,i,s){return t.TryStrToDate$3(e,i,t.FormatSettings.ShortDateFormat,s)},this.TryStrToDate$3=function(t,i,s,n){var o=!1,r="";return(o=0!==t.length)&&(i.set(e.IntStrToDate({get:function(){return r},set:function(t){r=t}},t,s,n)),o=""===r),o},this.StrToDateDef=function(e,i){return t.StrToDateDef$1(e,i,"\0")},this.StrToDateDef$1=function(e,i,s){var n=0;return t.TryStrToDate$2(e,{get:function(){return n},set:function(t){n=t}},s)||(n=i),n},this.TimeToStr=function(e){return t.TimeToStr$1(e,t.FormatSettings)},this.TimeToStr$1=function(e,i){return t.FormatDateTime$1("tt",e,i)},this.StrToTime=function(e){return t.StrToTime$2(e,t.FormatSettings)},this.StrToTime$2=function(i,s){var n,o="";if(n=e.IntStrToTime({get:function(){return o},set:function(t){o=t}},i,i.length,s),""!==o)throw t.EConvertError.$create("Create$1",[o]);return n},this.TryStrToTime=function(e,i){return t.TryStrToTime$1(e,i,t.TFormatSettings.$clone(t.FormatSettings))},this.TryStrToTime$1=function(t,i,s){var n=!1,o="";return(n=0!==t.length)&&(i.set(e.IntStrToTime({get:function(){return o},set:function(t){o=t}},t,t.length,s)),n=""===o),n},this.TryStrToTime$2=function(e,i,s){var n=t.TFormatSettings.$new();return n.$assign(t.TFormatSettings.Create()),n.TimeSeparator=s,t.TryStrToTime$1(e,i,t.TFormatSettings.$clone(n))},this.StrToTimeDef=function(e,i){return t.StrToTimeDef$1(e,i,"\0")},this.StrToTimeDef$1=function(e,i,s){var n=0;return t.TryStrToTime$2(e,{get:function(){return n},set:function(t){n=t}},s)||(n=i),n},this.DateTimeToStr=function(e,i){return t.DateTimeToStr$1(e,t.FormatSettings,i)},this.DateTimeToStr$1=function(i,s,n){return t.FormatDateTime$1(e.DateTimeToStrFormat[+n],i,s)},this.StrToDateTime=function(e){return t.StrToDateTime$1(e,t.FormatSettings)},this.StrToDateTime$1=function(i,s){var n=0,o="",r="",a=e.SplitDateTimeStr(i,{get:function(){return r},set:function(t){r=t}},{get:function(){return o},set:function(t){o=t}},s);return 0===a?n=t.StrToDate(""):1===a?n=r.length>0?t.StrToDate$2(r,s.ShortDateFormat,s.DateSeparator):t.StrToTime(o):2===a&&(n=t.ComposeDateTime(t.StrToDate$2(r,s.ShortDateFormat,s.DateSeparator),t.StrToTime(o))),n},this.TryStrToDateTime$1=function(e,i,s){var n=!1,o=0,r=0,a=0;if(n=!1,(o=pas.System.Pos(s.TimeSeparator,e))>0){for(;o>0&&" "!==e.charAt(o-1);)o-=1;if(o>0){if(!t.TryStrToDate$1(pas.System.Copy(e,1,o-1),{get:function(){return r},set:function(t){r=t}},s))return n;if(!t.TryStrToTime$1(pas.System.Copy(e,o+1,e.length-o),{get:function(){return a},set:function(t){a=t}},t.TFormatSettings.$clone(s)))return n;i.set(t.ComposeDateTime(r,a)),n=!0}else n=t.TryStrToTime$1(e,i,t.TFormatSettings.$clone(s))}else n=t.TryStrToDate$1(e,i,s);return n},this.StrToDateTimeDef=function(e,i){return t.StrToDateTimeDef$1(e,i,t.TFormatSettings.$clone(t.FormatSettings))},this.StrToDateTimeDef$1=function(e,i,s){var n=0;return t.TryStrToDateTime$1(e,{get:function(){return n},set:function(t){n=t}},s)||(n=i),n},this.FormatDateTime=function(e,i){return t.FormatDateTime$1(e,i,t.FormatSettings)},this.FormatDateTime$1=function(e,i,s){var n="";function o(t,e,i){n+=pas.System.Copy(t,e,i)}function r(t){n+=t}function a(e,i){var s="";for(s=t.IntToStr(e);s.length<i;)s="0"+s;r(s)}var l=0,h=0,F=0,p=0,c=0,u=0,T=0,C=0;function S(e,i,n){var d,m="",f="",g=0,y=!1,b=0,N=0,M=0;if(!(i>1)){for(M=1,d=e.length,y=!1,!1,N=1;N<=d;){var B=m=e.charAt(N-1);if("'"===B||'"'===B)for(N+=1;N<d&&e.charAt(N-1)!==m;)N+=1;else if(!("A"!==B&&"a"!==B||0!==t.CompareText(pas.System.Copy(e,N,3),"A/P")&&0!==t.CompareText(pas.System.Copy(e,N,4),"AMPM")&&0!==t.CompareText(pas.System.Copy(e,N,5),"AM/PM"))){y=!0;break}N+=1}for(m="ÿ",f=" ","H";M<=d;){g=1,N=M+1;var E=m=t.UpperCase(e.charAt(M-1)).charAt(0);if("'"===E||'"'===E){for(;N<d&&e.charAt(N-1)!==m;)N+=1;o(e,M+1,(g=(N+=1)-M)-2)}else if("A"===E)if(0===t.CompareText(pas.System.Copy(e,M,4),"AMPM"))g=4,r(c<12?s.TimeAMString:s.TimePMString);else if(0===t.CompareText(pas.System.Copy(e,M,5),"AM/PM"))g=5,o(e,c<12?M:M+3,2);else{if(0!==t.CompareText(pas.System.Copy(e,M,3),"A/P"))throw t.EConvertError.$create("Create$1",["Illegal character in format string"]);g=3,o(e,c<12?M:M+2,1)}else if("/"===E)r(s.DateSeparator);else if(":"===E)r(s.TimeSeparator);else if(" "===E||"C"===E||"D"===E||"H"===E||"M"===E||"N"===E||"S"===E||"T"===E||"Y"===E||"Z"===E||"F"===E){for(;N<=d&&t.UpperCase(e.charAt(N-1))===m;)N+=1;g=N-M;var L=m;if(" "===L)o(e,M,g);else if("Y"===L)g>2?a(l,4):a(l%100,2);else if("M"===L)if("H"===f||n)a(u,1===g?0:2);else{var D=g;1===D?a(h,0):2===D?a(h,2):r(3===D?s.ShortMonthNames[h-1]:s.LongMonthNames[h-1])}else if("D"===L){var A=g;1===A?a(F,0):2===A?a(F,2):3===A?r(s.ShortDayNames[p-1]):4===A?r(s.LongDayNames[p-1]):S(5===A?s.ShortDateFormat:s.LongDateFormat,i+1,!1)}else"H"===L?y?(0===(b=c%12)&&(b=12),a(b,1===g?0:2)):a(c,1===g?0:2):"N"===L?a(u,1===g?0:2):"S"===L?a(T,1===g?0:2):"Z"===L?a(C,1===g?0:3):"T"===L?S(1===g?s.ShortTimeFormat:s.LongTimeFormat,i+1,!0):"C"===L?(S(s.ShortDateFormat,i+1,!1),0===c&&0===u&&0===T||(r(" "),S(s.LongTimeFormat,i+1,!0))):"F"===L&&(S(s.ShortDateFormat,i+1,!1),r(" "),S(s.LongTimeFormat,i+1,!0));f,f=m}else r(m);M+=g}}}return t.DecodeDateFully(i,{get:function(){return l},set:function(t){l=t}},{get:function(){return h},set:function(t){h=t}},{get:function(){return F},set:function(t){F=t}},{get:function(){return p},set:function(t){p=t}}),t.DecodeTime(i,{get:function(){return c},set:function(t){c=t}},{get:function(){return u},set:function(t){u=t}},{get:function(){return T},set:function(t){T=t}},{get:function(){return C},set:function(t){C=t}}),S(""!==e?e:"C",0,!1),n},this.CurrencyFormat=0,this.NegCurrFormat=0,this.CurrencyDecimals=0,this.CurrencyString="",this.CurrToStr=function(e){return t.FloatToStrF$1(e/1e4,1,-1,0,t.FormatSettings)},this.StrToCurr=function(e){var i=0;if(!t.TryStrToCurr(e,{get:function(){return i},set:function(t){i=t}}))throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidCurrency"),pas.System.VarRecs(18,e)]);return i},this.TryStrToCurr=function(e,i){var s,n=0;return(s=t.TryStrToFloat$3(e,{get:function(){return n},set:function(t){n=t}},t.FormatSettings))&&i.set(rtl.trunc(1e4*n)),s},this.Supports$1=function(t,e,i){return null!==t&&0===t.QueryInterface(e,i)},this.Supports$3=function(t,e,i){return null!==t&&t.GetInterfaceByStr(e,i)},this.TryStringToGUID=function(t,e){var i=!1;return 38===t.length&&((i=new RegExp("^\\{[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}\\}$").test(t))?(rtl.strToGUIDR(t,e),i=!0):(e.D1=0,i))},this.StringToGUID=function(e){var i=pas.System.TGuid.$new();if(!t.TryStringToGUID(e,i))throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidGUID"),pas.System.VarRecs(18,e)]);return i},this.GUIDToString=function(t){return rtl.guidrToStr(t)},this.CreateGUID=function(t){function e(t){var e=0;for(e=pas.System.Random(256);t>1;)e=256*e+pas.System.Random(256),t-=1;return e}var i=0;for(0,t.D1=e(4),t.D2=e(2),t.D3=e(2),i=0;i<=7;i++)t.D4[i]=e(1);return 0},rtl.createHelper(this,"TGuidHelper",null,(function(){this.ToString=function(e){var i="";return i=t.GUIDToString(this),e&&(i=pas.System.Copy(i,2,i.length-2)),i}})),rtl.createHelper(this,"TStringHelper",null,(function(){this.Empty="",this.GetLength=function(){return this.get().length},this.LowerCase=function(e){return t.LowerCase(e)},this.UpperCase=function(e){return t.UpperCase(e)},this.Contains=function(t){return""!==t&&pas.System.Pos(t,this.get())>0},this.IndexOf=function(e){return t.TStringHelper.IndexOf$4.call(this,e,0,t.TStringHelper.GetLength.call(this))},this.IndexOf$4=function(t,e,i){var s,n=0;return s=pas.System.Copy(this.get(),e+1,i),-1!==(n=pas.System.Pos(t,s)-1)&&(n+=e),n},this.Replace$2=function(e,i){return t.TStringHelper.Replace$3.call(this,e,i,rtl.createSet(0))},this.Replace$3=function(e,i,s){return t.StringReplace(this.get(),e,i,rtl.refSet(s))},this.StartsWith=function(e){return t.TStringHelper.StartsWith$1.call(this,e,!1)},this.StartsWith$1=function(e,i){var s,n=!1,o="";return(n=(s=e.length)<=0)||(n=(o=pas.System.Copy(this.get(),1,s)).length===s)&&(n=i?t.SameText(o,e):t.SameStr(o,e)),n},this.Substring=function(e){return t.TStringHelper.Substring$1.call(this,e,t.TStringHelper.GetLength.call(this)-e)},this.Substring$1=function(t,e){return pas.System.Copy(this.get(),t+1,e)},this.ToLower=function(){return t.TStringHelper.LowerCase(this.get())},this.ToUpper=function(){return t.TStringHelper.UpperCase(this.get())},this.Trim=function(){return t.Trim(this.get())}})),rtl.createHelper(this,"TIntegerHelper",null,(function(){this.ToString$1=function(){return t.IntToStr(this.get())}})),rtl.createHelper(this,"TNativeIntHelper",null,(function(){this.ToString$1=function(){return t.IntToStr(this.get())}})),t.$implcode=function(){e.DefaultShortMonthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e.DefaultLongMonthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],e.DefaultShortDayNames=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],e.DefaultLongDayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],e.FInvariant=t.TFormatSettings.$new(),e.FInvariantCreated=!1,e.DoShowException=function(e){null!=t.OnShowException?t.OnShowException(e):window.alert(e)},e.CheckBoolStrs=function(){0===rtl.length(t.TrueBoolStrs)&&(t.TrueBoolStrs=rtl.arraySetLength(t.TrueBoolStrs,"",1),t.TrueBoolStrs[0]="True"),0===rtl.length(t.FalseBoolStrs)&&(t.FalseBoolStrs=rtl.arraySetLength(t.FalseBoolStrs,"",1),t.FalseBoolStrs[0]="False")},e.feInvalidFormat=1,e.feMissingArgument=2,e.feInvalidArgIndex=3,e.DoFormatError=function(e,i){var s=e;if(1===s)throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidFormat"),pas.System.VarRecs(18,i)]);if(2===s)throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SArgumentMissing"),pas.System.VarRecs(18,i)]);if(3===s)throw t.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidArgIndex"),pas.System.VarRecs(18,i)])},e.maxdigits=15,e.ReplaceDecimalSep=function(t,e){var i;return(i=pas.System.Pos(".",t))>0?pas.System.Copy(t,1,i-1)+e+pas.System.Copy(t,i+1,t.length-i):t},e.FormatGeneralFloat=function(i,s,n){var o="",r=0,a=0,l=0,h=0;if((-1===s||s>15)&&(s=15),o=rtl.floatToStr(i,s+7),o=t.TrimLeft(o),0===(r=pas.System.Pos(".",o)))return o;if(0===(a=pas.System.Pos("E",o)))return o=e.ReplaceDecimalSep(o,n);for(l=a+2,h=0;l<=o.length;)h=10*h+o.charCodeAt(l-1)-48,l+=1;if("-"===o.charAt(a+1-1)&&(h=-h),r+h<a&&h>-6){if(o=rtl.strSetLength(o,a-1),h>=0){for(var F=0,p=h-1;F<=p;F++)l=F,o=rtl.setCharAt(o,r-1,o.charAt(r+1-1)),r+=1;for(o=rtl.setCharAt(o,r-1,"."),r=1,"-"===o.charAt(r-1)&&(r+=1);"0"===o.charAt(r-1)&&r<o.length&&pas.System.Copy(o,r+1,n.length)!==n;)pas.System.Delete({get:function(){return o},set:function(t){o=t}},r,1)}else pas.System.Insert(pas.System.Copy("00000",1,-h),{get:function(){return o},set:function(t){o=t}},r-1),o=rtl.setCharAt(o,r-h-1,o.charAt(r-h-1-1)),o=rtl.setCharAt(o,r-1,"."),-1!==h&&(o=rtl.setCharAt(o,r-h-1-1,"0"));for(l=o.length;l>0&&"0"===o.charAt(l-1);)l-=1;"."===o.charAt(l-1)&&(l-=1),o=0===l||1===l&&"-"===o.charAt(0)?"0":rtl.strSetLength(o,l)}else{for(;"0"===o.charAt(a-1-1);)pas.System.Delete({get:function(){return o},set:function(t){o=t}},a-1,1),a-=1;for(o.charAt(a-1-1)===n&&(pas.System.Delete({get:function(){return o},set:function(t){o=t}},a-1,1),a-=1),"+"===o.charAt(a+1-1)?pas.System.Delete({get:function(){return o},set:function(t){o=t}},a+1,1):a+=1;"0"===o.charAt(a+1-1);)pas.System.Delete({get:function(){return o},set:function(t){o=t}},a+1,1)}return o=e.ReplaceDecimalSep(o,n)},e.FormatExponentFloat=function(i,s,n,o){var r="",a=0;for(o=t.FormatSettings.DecimalSeparator,(-1===s||s>15)&&(s=15),r=rtl.floatToStr(i,s+7);" "===r.charAt(0);)pas.System.Delete({get:function(){return r},set:function(t){r=t}},1,1);if(0===(a=pas.System.Pos("E",r)))return r=e.ReplaceDecimalSep(r,o);if(a+=2,n>4&&(n=4),(n=r.length-a-n+1)<0)pas.System.Insert(pas.System.Copy("0000",1,-n),{get:function(){return r},set:function(t){r=t}},a);else for(;n>0&&"0"===r.charAt(a-1);){if(pas.System.Delete({get:function(){return r},set:function(t){r=t}},a,1),a>r.length){pas.System.Delete({get:function(){return r},set:function(t){r=t}},a-2,2);break}n-=1}return r=e.ReplaceDecimalSep(r,o)},e.FormatFixedFloat=function(t,i,s){var n="";return-1===i?i=2:i>18&&(i=18),""!==(n=rtl.floatToStr(t,0,i))&&" "===n.charAt(0)&&pas.System.Delete({get:function(){return n},set:function(t){n=t}},1,1),n=e.ReplaceDecimalSep(n,s)},e.FormatNumberFloat=function(t,i,s,n){var o="",r=0;if(-1===i?i=2:i>15&&(i=15),""!==(o=rtl.floatToStr(t,0,i))&&" "===o.charAt(0)&&pas.System.Delete({get:function(){return o},set:function(t){o=t}},1,1),(r=pas.System.Pos(".",o))<=0&&(r=o.length+1),o=e.ReplaceDecimalSep(o,s),r-=3,""!==n&&"\0"!==n)for(;r>1;)"-"!==o.charAt(r-1-1)&&pas.System.Insert(n,{get:function(){return o},set:function(t){o=t}},r),r-=3;return o},e.RemoveLeadingNegativeSign=function(t,e,i){var s,n=!1,o=0;n=!1,s=i;for(var r=2,a=t.get().length;r<=a&&(o=r,n=t.get().charCodeAt(o-1)in rtl.createSet(48,e.charCodeAt(),69,43)||t.get().charAt(o-1)===s);r++);return n&&"-"===t.get().charAt(0)&&pas.System.Delete(t,1,1),n},e.FormatNumberCurrency=function(t,i,s){var n,o,r,a,l="",h=0;if(r=s.DecimalSeparator,a=s.ThousandSeparator,o=s.CurrencyString,-1===i?i=s.CurrencyDecimals:i>18&&(i=18),(n="-"===(l=rtl.floatToStr(t/1e4,0,i)).charAt(0))&&pas.System.Delete({get:function(){return l},set:function(t){l=t}},1,1),h=pas.System.Pos(".",l),""!==a)for(0!==h?l=e.ReplaceDecimalSep(l,r):h=l.length+1,h-=3;h>1;)pas.System.Insert(a,{get:function(){return l},set:function(t){l=t}},h),h-=3;if(n&&e.RemoveLeadingNegativeSign({get:function(){return l},set:function(t){l=t}},r,a),n){var F=s.NegCurrFormat;0===F?l="("+o+l+")":1===F?l="-"+o+l:2===F?l=o+"-"+l:3===F?l=o+l+"-":4===F?l="("+l+o+")":5===F?l="-"+l+o:6===F?l=l+"-"+o:7===F?l=l+o+"-":8===F?l="-"+l+" "+o:9===F?l="-"+o+" "+l:10===F?l=l+" "+o+"-":11===F?l=o+" "+l+"-":12===F?l=o+" -"+l:13===F?l=l+"- "+o:14===F?l="("+o+" "+l+")":15===F&&(l="("+l+" "+o+")")}else{var p=s.CurrencyFormat;0===p?l=o+l:1===p?l+=o:2===p?l=o+" "+l:3===p&&(l=l+" "+o)}return l},e.RESpecials="([\\$\\+\\[\\]\\(\\)\\\\\\.\\*\\^\\?\\|])",e.DateTimeToStrFormat=["c","f"];e.IntStrToDate=function(e,i,s,n){var o=0;function r(i){e.set(t.Format(rtl.getResStr(pas.RTLConsts,"SInvalidDateFormat"),pas.System.VarRecs(18,i)))}var a="",l=0,h=0,F=0,p=0,c=0,u=0,T=0,C=0,S=0,d=0,m=0,f=0,g=0,y=0,b="",N=[],M=!1;for(N=rtl.arraySetLength(N,0,4),o=0,S=i.length,e.set("");S>0&&pas.System.Pos(i.charAt(S-1)," \b\t\n\f\r")>0;)S-=1;if(0===S)return r(i),o;for(M=!1,"\0"===n&&(n="\0"!==t.FormatSettings.DateSeparator?t.FormatSettings.DateSeparator:"-"),a=t.UpperCase(s),g=0,f=0,m=0,y=0,C=0;C<a.length&&y<3;){C+=1;var B=a.charAt(C-1);"Y"===B?0===g&&(g=y+=1):"M"===B?0===f&&(f=y+=1):"D"===B&&0===m&&(m=y+=1)}for(C=1;C<=3;C++)N[C]=0;b="",T=0;for(var E=1,L=S;E<=L;E++)if(C=E,pas.System.Pos(i.charAt(C-1),"0123456789")>0&&(b+=i.charAt(C-1))," "===n||" "!==i.charAt(C-1))if(i.charAt(C-1)===n||C===S&&pas.System.Pos(i.charAt(C-1),"0123456789")>0){if((T+=1)>3)return r(i),o;if(T===g&&b.length>2&&(M=!0),pas.System.val$6(b,{a:T,p:N,get:function(){return this.p[this.a]},set:function(t){this.p[this.a]=t}},{get:function(){return d},set:function(t){d=t}}),0!==d)return r(i),o;b=""}else if(0===pas.System.Pos(i.charAt(C-1),"0123456789"))return r(i),o;return y<3&&T>y?(r(i),o):(t.DecodeDate(t.Date(),{get:function(){return p},set:function(t){p=t}},{get:function(){return u},set:function(t){u=t}},{get:function(){return c},set:function(t){c=t}}),3===T?(F=N[g],h=N[f],l=N[m]):(F=p,T<2?(l=N[1],h=u):m<f?(l=N[1],h=N[2]):(l=N[2],h=N[1])),F>=0&&F<100&&!M&&(p-=t.TwoDigitYearCenturyWindow,F+=100*rtl.trunc(p/100),t.TwoDigitYearCenturyWindow>0&&F<p&&(F+=100)),t.TryEncodeDate(F,h,l,{get:function(){return o},set:function(t){o=t}})||e.set(rtl.getResStr(pas.RTLConsts,"SErrInvalidDate")),o)};e.IntStrToTime=function(e,i,s,n){var o=0,r=0,a=[];return a=rtl.arraySetLength(a,0,4),r=0,function(e,o){var r=!1,a=0,l=0,h=0,F=0,p=0,c=0,u=0,T=!1,C=!1,S="",d="",m=0,f="";for(r=!1,o.set(0),C=!1,p=0,m=0;m<=3;m++)e.get()[m]=0;for(a=1;a<s&&" "===i.charAt(a-1);)a+=1;if(l=a,a>s-1||i.charAt(a-1)===n.TimeSeparator||i.charAt(a-1)===n.DecimalSeparator)return r;for(T=pas.System.Pos(i.charAt(a-1),"0123456789")>0;a<=s;){if(d=i.charAt(a-1),pas.System.Pos(d,"0123456789")>0){if(!T||p>3)return r;for(l=a,c="0"!==d?l:-1;a<s&&pas.System.Pos(i.charAt(a+1-1),"0123456789")>0;)-1===c&&"0"!==i.charAt(a-1)&&(c=a),a+=1;if(-1===c&&(c=a),!((h=1+a-c)<=2||h<=3&&3===p))return r;pas.System.val$6(pas.System.Copy(i,c,h),{get:function(){return u},set:function(t){u=t}},{get:function(){return F},set:function(t){F=t}}),e.get()[p]=u,p+=1,T=!1}else if(" "===d);else if(d===n.TimeSeparator){if(T||p>2)return r;T=!0,C=!1}else if(d===n.DecimalSeparator){if(T||C||3!==p)return r;T=!0,C=!0}else{if(0!==o.get()||T)return r;for(l=a,f=n.DecimalSeparator+" ","\0"!==n.TimeSeparator&&(f+=n.TimeSeparator);a<s&&0===pas.System.Pos(i.charAt(a+1-1),f)&&0===pas.System.Pos(i.charAt(a+1-1),"0123456789");)a+=1;if(h=1+a-l,S=pas.System.Copy(i,l,h),0===t.CompareText(S,n.TimeAMString))o.set(1);else if(0===t.CompareText(S,n.TimePMString))o.set(2);else if(0===t.CompareText(S,"AM"))o.set(1);else{if(0!==t.CompareText(S,"PM"))return r;o.set(2)}0===p?T=!0:(p=4,T=!1)}a+=1}return 0===p||0!==o.get()&&(e.get()[0]>12||0===e.get()[0])||T?r:r=!0}({get:function(){return a},set:function(t){a=t}},{get:function(){return r},set:function(t){r=t}})?(2===r&&12!==a[0]?a[0]+=12:1===r&&12===a[0]&&(a[0]=0),t.TryEncodeTime(a[0],a[1],a[2],a[3],{get:function(){return o},set:function(t){o=t}})||e.set(t.Format(rtl.getResStr(pas.RTLConsts,"SErrInvalidTimeFormat"),pas.System.VarRecs(18,i))),o):(e.set(t.Format(rtl.getResStr(pas.RTLConsts,"SErrInvalidTimeFormat"),pas.System.VarRecs(18,i))),o)};e.SplitDateTimeStr=function(e,i,s,n){var o=0,r=0,a=0;if(o=0,i.set(""),s.set(""),0===(e=t.Trim(e)).length)return o;if(" "===n.DateSeparator&&" "===n.TimeSeparator&&pas.System.Pos(" ",e)>0)return i.set(e),1;if(r=1," "!==n.DateSeparator)for(;r<e.length&&!(pas.System.Pos(e.charAt(r+1-1),"\t\n\r ")>0);)r+=1;else if(0!==(r=pas.System.Pos(n.TimeSeparator,e)))do{r-=1}while(!(0===r||pas.System.Pos(e.charAt(r-1),"\t\n\r ")>0));return 0===r&&(r=e.length),i.set(pas.System.Copy(e,1,r)),s.set(t.Trim(pas.System.Copy(e,r+1,100))),0!==s.get().length?o=2:(o=1,(n.DateSeparator!==n.TimeSeparator&&pas.System.Pos(n.TimeSeparator,i.get())>0||n.DateSeparator===n.TimeSeparator&&!t.TryStrToDate(i.get(),{get:function(){return a},set:function(t){a=t}}))&&(s.set(i.get()),i.set(""))),o},e.IntTryStrToInt=function(e,i,s){var n,o,r=10,a="";if(a=e,0!==pas.System.Pos(s,a)||0!==pas.System.Pos(".",a))return!1;var l=pas.System.Copy(a,1,1);return"$"===l?r=16:"&"===l?r=8:"%"===l&&(r=2),(16===r||0===pas.System.Pos("e",t.LowerCase(a)))&&(10!==r&&pas.System.Delete({get:function(){return a},set:function(t){a=t}},1,1),o=parseInt(a,r),(n=!isNaN(o))&&i.set(rtl.trunc(o)),n)},e.InitGlobalFormatSettings=function(){t.FormatSettings.$assign(t.TFormatSettings.Create()),t.TimeSeparator=t.FormatSettings.TimeSeparator,t.DateSeparator=t.FormatSettings.DateSeparator,t.ShortDateFormat=t.FormatSettings.ShortDateFormat,t.LongDateFormat=t.FormatSettings.LongDateFormat,t.ShortTimeFormat=t.FormatSettings.ShortTimeFormat,t.LongTimeFormat=t.FormatSettings.LongTimeFormat,t.DecimalSeparator=t.FormatSettings.DecimalSeparator,t.ThousandSeparator=t.FormatSettings.ThousandSeparator,t.TimeAMString=t.FormatSettings.TimeAMString,t.TimePMString=t.FormatSettings.TimePMString,t.CurrencyFormat=t.FormatSettings.CurrencyFormat,t.NegCurrFormat=t.FormatSettings.NegCurrFormat,t.CurrencyDecimals=t.FormatSettings.CurrencyDecimals,t.CurrencyString=t.FormatSettings.CurrencyString},t.$resourcestrings={SAbortError:{org:"Operation aborted"},SApplicationException:{org:"Application raised an exception: "}}},t.$init=function(){e.InitGlobalFormatSettings(),t.ShortMonthNames=e.DefaultShortMonthNames.slice(0),t.LongMonthNames=e.DefaultLongMonthNames.slice(0),t.ShortDayNames=e.DefaultShortDayNames.slice(0),t.LongDayNames=e.DefaultLongDayNames.slice(0)}}),[]),rtl.module("TypInfo",["System","SysUtils","Types","RTLConsts","JS"],(function(){"use strict";var t=this,e=t.$impl;this.pfGetFunction=1,this.pfSetProcedure=2,this.pfHasIndex=16,rtl.createClass(this,"EPropertyError",pas.SysUtils.Exception,(function(){})),this.GetPropList=function(t,e,i){var s=[];var n=null,o=0,r=null,a="",l=null;for(s=[],n=t,r=new Object;null!==n;){for(var h=0,F=n.properties.length-1;h<=F;h++)o=h,a=n.properties[o],r.hasOwnProperty(a)||(l=n.members[a]).typeinfo.kind in e&&(s.push(l),r[a]=!0);if(!rtl.isExt(n,rtl.tTypeInfoClass))break;n=n.ancestor}return i&&s.sort((function(t,e){return t.name<e.name?-1:t.name>e.name?1:0})),s},this.GetPropInfo=function(t,e){var i=null,s=null,n=0,o=null;for(o=t;null!==o;){if(s=o.members[e],rtl.isExt(s,rtl.tTypeMemberProperty))return s;if(!rtl.isExt(o,rtl.tTypeInfoClass))break;o=o.ancestor}i=null;do{for(var r=0,a=t.properties.length-1;r<=a;r++)if(n=r,0===pas.SysUtils.CompareText(e,t.properties[n]))return s=t.members[t.properties[n]],rtl.isExt(s,rtl.tTypeMemberProperty)&&(i=s),i;if(!rtl.isExt(t,rtl.tTypeInfoClass))break;t=t.ancestor}while(null!==t);return i},this.GetPropInfo$1=function(e,i,s){var n=null;return n=t.GetPropInfo(e,i),rtl.neSet(s,{})&&null!==n&&!(n.typeinfo.kind in s)&&(n=null),n},this.GetPropInfo$2=function(e,i){return t.GetPropInfo$1(e.$rtti,i,{})},this.FindPropInfo=function(e,i){var s;if(null===(s=t.GetPropInfo(e.$rtti,i)))throw t.EPropertyError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SErrPropertyNotFound"),pas.System.VarRecs(18,i)]);return s},this.GetJSValueProp$1=function(i,s){var n=void 0,o=e.GetPropGetterKind(s);if(0===o)throw t.EPropertyError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SCantReadPropertyS"),pas.System.VarRecs(18,s.name)]);if(1===o)n=i[s.getter];else if(2===o)n=(16&s.flags)>0?i[s.getter](s.index):i[s.getter]();else if(3===o)throw t.EPropertyError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SIndexedPropertyNeedsParams"),pas.System.VarRecs(18,s.name)]);return n},this.GetJSValueProp$3=function(e,i){return t.GetJSValueProp$1(e,i)},this.SetJSValueProp$1=function(i,s,n){var o=e.GetPropSetterKind(s);if(0===o)throw t.EPropertyError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SCantWritePropertyS"),pas.System.VarRecs(18,s.name)]);if(1===o)i[s.setter]=n;else if(2===o)(16&s.flags)>0?i[s.setter](s.index,n):i[s.setter](n);else if(3===o)throw t.EPropertyError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SIndexedPropertyNeedsParams"),pas.System.VarRecs(18,s.name)])},this.SetJSValueProp$3=function(e,i,s){t.SetJSValueProp$1(e,i,s)},this.GetOrdProp$1=function(e,i){var s=0,n="",o=0,r=void 0;if(5===i.typeinfo.kind)for(n in s=0,t.GetJSValueProp$3(e,i))(o=parseInt(n,10))<32&&(s+=1<<o);else 2===i.typeinfo.kind?(r=t.GetJSValueProp$3(e,i),s=rtl.isNumber(r)?rtl.trunc(r):""===(n=""+r)?0:n.charCodeAt(0)):s=rtl.trunc(t.GetJSValueProp$3(e,i));return s},this.SetOrdProp=function(e,i,s){t.SetOrdProp$1(e,t.FindPropInfo(e,i),s)},this.SetOrdProp$1=function(e,i,s){var n=null,o=0;if(5===i.typeinfo.kind){for(n=new Object,o=0;o<=31;o++)(1<<o&s)>0&&(n[""+o]=!0);t.SetJSValueProp$3(e,i,n)}else 2===i.typeinfo.kind?t.SetJSValueProp$3(e,i,String.fromCharCode(s)):t.SetJSValueProp$3(e,i,s)},this.GetEnumName=function(t,e){return t.enumtype[e]},this.GetStrProp$1=function(e,i){return""+t.GetJSValueProp$3(e,i)},this.SetStrProp$1=function(e,i,s){t.SetJSValueProp$3(e,i,s)},this.GetFloatProp$1=function(e,i){return rtl.getNumber(t.GetJSValueProp$3(e,i))},this.SetFloatProp$1=function(e,i,s){t.SetJSValueProp$3(e,i,s)},this.GetObjectProp=function(e,i){return t.GetObjectProp$2(e,t.FindPropInfo(e,i))},this.GetObjectProp$2=function(e,i){return t.GetObjectProp$3(e,i,null)},this.GetObjectProp$3=function(e,i,s){var n=null;return n=rtl.getObject(t.GetJSValueProp$3(e,i)),null===s||n.$class.InheritsFrom(s)?n:null},this.SetObjectProp=function(e,i,s){t.SetObjectProp$1(e,t.FindPropInfo(e,i),s)},this.SetObjectProp$1=function(e,i,s){t.SetJSValueProp$3(e,i,s)},this.GetMethodProp=function(e,i){var s,n,o=pas.System.TMethod.$new();return o.Code=null,o.Data=null,s=t.GetJSValueProp$3(e,i),rtl.isFunction(s)?(o.Data=s.scope,n=s.fn,rtl.isString(n)?null!==o.Data?o.Code=o.Data[""+n]:o.Code=s:o.Code=n,o):o},this.SetMethodProp=function(e,i,s){var n,o=null;o=null===(n=s.Code)?null:rtl.isFunction(n)?n.scope===s.Data&&(rtl.isFunction(n.fn)||rtl.isString(n.fn))?n:rtl.isString(n.fn)?rtl.createCallback(s.Data,""+n.fn):rtl.createCallback(s.Data,n):rtl.createCallback(s.Data,n),t.SetJSValueProp$3(e,i,o)},this.SetMethodProp$1=function(e,i,s){t.SetMethodProp(e,t.FindPropInfo(e,i),s)},t.$implcode=function(){e.TGetterKind={0:"gkNone",gkNone:0,1:"gkField",gkField:1,2:"gkFunction",gkFunction:2,3:"gkFunctionWithParams",gkFunctionWithParams:3},e.GetPropGetterKind=function(t){return""===t.getter?0:(1&t.flags)>0?rtl.length(t.params)>0?3:2:1},e.TSetterKind={0:"skNone",skNone:0,1:"skField",skField:1,2:"skProcedure",skProcedure:2,3:"skProcedureWithParams",skProcedureWithParams:3},e.GetPropSetterKind=function(t){return""===t.setter?0:(2&t.flags)>0?rtl.length(t.params)>0?3:2:1}}}),[]),rtl.module("Web",["System","Types","JS"],(function(){"use strict";this.$rtti.$ExtClass("TJSEvent"),this.$rtti.$ExtClass("TJSEvent",{ancestor:pas.JS.$rtti.TJSObject,jsclass:"Event"}),rtl.createClassExt(this,"TJSFocusEvent",Event,"",(function(){this.$init=function(){},this.$final=function(){}})),this.$rtti.$ExtClass("TJSHTMLElement",{ancestor:this.$rtti.TJSElement,jsclass:"HTMLElement"}),this.$rtti.$ExtClass("TJSXMLHttpRequest",{ancestor:this.$rtti.TJSXMLHttpRequestEventTarget,jsclass:"XMLHttpRequest"}),rtl.createClass(this,"TJSKeyNames",pas.System.TObject,(function(){this.Alt="Alt",this.CapsLock="CapsLock",this.Control="Control",this.Shift="Shift",this.Enter="Enter",this.Tab="Tab",this.ArrowDown="ArrowDown",this.ArrowLeft="ArrowLeft",this.ArrowRight="ArrowRight",this.ArrowUp="ArrowUp",this._End="End",this.Home="Home",this.PageDown="PageDown",this.PageUp="PageUp",this.BackSpace="Backspace",this.Delete="Delete",this.Insert="Insert",this.Escape="Escape",this.Pause="Pause",this.F1="F1",this.F2="F2",this.F3="F3",this.F4="F4",this.F5="F5",this.F6="F6",this.F7="F7",this.F8="F8",this.F9="F9",this.F10="F10",this.F11="F11",this.F12="F12",this.F13="F13",this.F14="F14",this.F15="F15",this.F16="F16",this.F17="F17",this.F18="F18",this.F19="F19",this.F20="F20"}))})),rtl.module("Classes",["System","RTLConsts","Types","SysUtils","JS","TypInfo"],(function(){"use strict";var t=this,e=t.$impl;this.$rtti.$MethodVar("TNotifyEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject]]),methodkind:0}),rtl.createClass(this,"EStreamError",pas.SysUtils.Exception,(function(){})),rtl.createClass(this,"EListError",pas.SysUtils.Exception,(function(){})),rtl.createClass(this,"EStringListError",this.EListError,(function(){})),rtl.createClass(this,"EComponentError",pas.SysUtils.Exception,(function(){})),this.TAlignment={0:"taLeftJustify",taLeftJustify:0,1:"taRightJustify",taRightJustify:1,2:"taCenter",taCenter:2},this.$rtti.$Enum("TAlignment",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TAlignment}),rtl.createClass(this,"TFPList",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FList=[],this.FCount=0,this.FCapacity=0},this.$final=function(){this.FList=void 0,pas.System.TObject.$final.call(this)},this.Get=function(t){return(t<0||t>=this.FCount)&&this.RaiseIndexError(t),this.FList[t]},this.Put=function(t,e){(t<0||t>=this.FCount)&&this.RaiseIndexError(t),this.FList[t]=e},this.SetCapacity=function(t){t<this.FCount&&this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListCapacityError"),""+t),t!==this.FCapacity&&(this.FList=rtl.arraySetLength(this.FList,void 0,t),this.FCapacity=t)},this.SetCount=function(t){t<0&&this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListCountError"),""+t),t>this.FCount&&t>this.FCapacity&&this.SetCapacity(t),this.FCount=t},this.RaiseIndexError=function(t){this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),""+t)},this.Destroy=function(){this.Clear(),pas.System.TObject.Destroy.call(this)},this.Add=function(t){var e;return this.FCount===this.FCapacity&&this.Expand(),this.FList[this.FCount]=t,e=this.FCount,this.FCount+=1,e},this.Clear=function(){rtl.length(this.FList)>0&&(this.SetCount(0),this.SetCapacity(0))},this.Delete=function(t){(t<0||t>=this.FCount)&&this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),""+t),this.FCount=this.FCount-1,this.FList.splice(t,1),this.FCapacity-=1},this.Error=function(e,i){throw t.EListError.$create("CreateFmt",[e,pas.System.VarRecs(18,i)])},this.Expand=function(){var t=0;return this.FCount<this.FCapacity||(t=4,this.FCapacity>3&&(t+=4),this.FCapacity>8&&(t+=8),this.FCapacity>127&&(t+=this.FCapacity>>>2),this.SetCapacity(this.FCapacity+t),this),this},this.IndexOf=function(t){var e,i=0;for(i=0,e=this.FCount;i<e&&this.FList[i]!=t;)i+=1;return i>=e&&(i=-1),i},this.IndexOfItem=function(t,e){var i=0;if(0===e)i=this.IndexOf(t);else for(i=this.FCount-1;i>=0&&this.FList[i]!=t;)i-=1;return i},this.Insert=function(t,e){(t<0||t>this.FCount)&&this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),""+t),this.FList.splice(t,0,e),this.FCapacity+=1,this.FCount+=1},this.Last=function(){return 0===this.FCount?null:this.Get(this.FCount-1)},this.Move=function(t,e){var i;(t<0||t>this.FCount-1)&&this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),""+t),(e<0||e>this.FCount-1)&&this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),""+e),t!==e&&(i=this.FList[t],this.FList.splice(t,1),this.FList.splice(e,0,i))},this.Remove=function(t){var e;return-1!==(e=this.IndexOf(t))&&this.Delete(e),e}})),this.TListNotification={0:"lnAdded",lnAdded:0,1:"lnExtracted",lnExtracted:1,2:"lnDeleted",lnDeleted:2},rtl.createClass(this,"TList",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FList=null},this.$final=function(){this.FList=void 0,pas.System.TObject.$final.call(this)},this.Get=function(t){return this.FList.Get(t)},this.Put=function(t,e){var i;i=this.Get(t),this.FList.Put(t,e),pas.System.Assigned(i)&&this.Notify(i,2),pas.System.Assigned(e)&&this.Notify(e,0)},this.Notify=function(t,e){pas.System.Assigned(t)},this.SetCount=function(t){if(t<this.FList.FCount)for(;this.FList.FCount>t;)this.Delete(this.FList.FCount-1);else this.FList.SetCount(t)},this.GetCount=function(){return this.FList.FCount},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FList=t.TFPList.$create("Create"),this},this.Destroy=function(){null!=this.FList&&this.Clear(),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FList},set:function(t){this.p.FList=t}})},this.Add=function(t){var e;return e=this.FList.Add(t),pas.System.Assigned(t)&&this.Notify(t,0),e},this.Clear=function(){for(;this.FList.FCount>0;)this.Delete(this.GetCount()-1)},this.Delete=function(t){var e;e=this.FList.Get(t),this.FList.Delete(t),pas.System.Assigned(e)&&this.Notify(e,2)},this.IndexOf=function(t){return this.FList.IndexOf(t)},this.Insert=function(t,e){this.FList.Insert(t,e),pas.System.Assigned(e)&&this.Notify(e,0)},this.Move=function(t,e){this.FList.Move(t,e)},this.Remove=function(t){var e;return-1!==(e=this.IndexOf(t))&&this.Delete(e),e}})),rtl.createClass(this,"TPersistent",pas.System.TObject,(function(){this.AssignError=function(t){var e="";throw e=null!==t?t.$classname:"Nil",pas.SysUtils.EConvertError.$create("Create$1",["Cannot assign a "+e+" to a "+this.$classname+"."])},this.AssignTo=function(t){t.AssignError(this)},this.GetOwner=function(){return null,null},this.Assign=function(t){null!==t?t.AssignTo(this):this.AssignError(null)},this.SetEvent=function(t,e,i){this.SetEvent$1(this,t,e,i)},this.SetEvent$1=function(t,e,i,s){var n=pas.System.TMethod.$new();if(n.Code=e.$class.MethodAddress(s),null===n.Code)throw pas.SysUtils.Exception.$create("Create$1",[e.$classname+' has no published method "'+s+'"']);n.Data=e,pas.TypInfo.SetMethodProp$1(t,i,n)}})),rtl.createClass(this,"TInterfacedPersistent",this.TPersistent,(function(){this.$init=function(){t.TPersistent.$init.call(this),this.FOwnerInterface=null},this.$final=function(){rtl.setIntfP(this,"FOwnerInterface",null),t.TPersistent.$final.call(this)},this._AddRef=function(){var t=0;return t=-1,null!=this.FOwnerInterface&&(t=this.FOwnerInterface._AddRef()),t},this._Release=function(){var t=0;return t=-1,null!=this.FOwnerInterface&&(t=this.FOwnerInterface._Release()),t},this.QueryInterface=function(t,e){var i=0;return i=-2147467262,this.GetInterface(t,e)&&(i=0),i},this.AfterConstruction=function(){try{pas.System.TObject.AfterConstruction.call(this),null!==this.GetOwner()&&this.GetOwner().GetInterface(rtl.getIntfGUIDR(pas.System.IUnknown),{p:this,get:function(){return this.p.FOwnerInterface},set:function(t){this.p.FOwnerInterface=t}})}finally{rtl._Release(this.FOwnerInterface)}},rtl.addIntf(this,pas.System.IUnknown)})),this.$rtti.$Class("TStrings"),rtl.createClass(this,"TStringsEnumerator",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FStrings=null,this.FPosition=0},this.$final=function(){this.FStrings=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.FStrings=t,this.FPosition=-1,this},this.GetCurrent=function(){return this.FStrings.Get(this.FPosition)},this.MoveNext=function(){return this.FPosition+=1,this.FPosition<this.FStrings.GetCount()}})),rtl.createClass(this,"TStrings",this.TPersistent,(function(){this.$init=function(){t.TPersistent.$init.call(this),this.FSpecialCharsInited=!1,this.FAlwaysQuote=!1,this.FQuoteChar="",this.FDelimiter="",this.FNameValueSeparator="",this.FUpdateCount=0,this.FLBS=0,this.FSkipLastLineBreak=!1,this.FStrictDelimiter=!1,this.FLineBreak=""},this.GetValue=function(t){var e,i="",s="";return i="",-1!==(e=this.IndexOfName(t))&&this.GetNameValue(e,{get:function(){return s},set:function(t){s=t}},{get:function(){return i},set:function(t){i=t}}),i},this.SetDelimiter=function(t){this.CheckSpecialChars(),this.FDelimiter=t},this.DoSetTextStr=function(t,e){var i="",s=0;try{for(this.BeginUpdate(),e&&this.Clear(),s=1;this.GetNextLinebreak(t,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}});)this.Add(i)}finally{this.EndUpdate()}},this.GetNameValueSeparator=function(){return this.CheckSpecialChars(),this.FNameValueSeparator},this.SetLineBreak=function(t){this.CheckSpecialChars(),this.FLineBreak=t},this.GetSkipLastLineBreak=function(){return this.CheckSpecialChars(),this.FSkipLastLineBreak},this.SetSkipLastLineBreak=function(t){this.CheckSpecialChars(),this.FSkipLastLineBreak=t},this.Error=function(e,i){throw t.EStringListError.$create("CreateFmt",[e,pas.System.VarRecs(18,pas.SysUtils.IntToStr(i))])},this.GetCapacity=function(){return this.GetCount()},this.GetObject=function(t){return null,null},this.GetTextStr=function(){var t="",e=0,i="";if(this.CheckSpecialChars(),this.FLineBreak!==pas.System.sLineBreak)i=this.FLineBreak;else{var s=this.FLBS;0===s?i="\n":1===s?i="\r\n":2===s&&(i="\r")}t="";for(var n=0,o=this.GetCount()-1;n<=o;n++)e=n,t+=this.Get(e),(e<this.GetCount()-1||!this.GetSkipLastLineBreak())&&(t+=i);return t},this.PutObject=function(t,e){},this.SetTextStr=function(t){this.CheckSpecialChars(),this.DoSetTextStr(t,!0)},this.SetUpdateState=function(t){},this.DoCompareText=function(t,e){return pas.SysUtils.CompareText(t,e)},this.SetDelimitedText=function(t){var e=0,i=0,s=!1;this.CheckSpecialChars(),this.BeginUpdate(),e=1,i=1,s=!1;try{if(this.Clear(),this.FStrictDelimiter)for(;e<=t.length;){if(s&&e<=t.length&&t.charAt(e-1)===this.FDelimiter&&(e+=1),e<=t.length)if(t.charAt(e-1)===this.FQuoteChar){for(i=e+1;i<=t.length&&(t.charAt(i-1)!==this.FQuoteChar||i+1<=t.length&&t.charAt(i+1-1)===this.FQuoteChar);)i<=t.length&&t.charAt(i-1)===this.FQuoteChar?i+=2:i+=1;this.Add(pas.SysUtils.StringReplace(pas.System.Copy(t,e+1,i-e-1),this.FQuoteChar+this.FQuoteChar,this.FQuoteChar,rtl.createSet(0))),e=i+1}else{for(i=e;i<=t.length&&t.charAt(i-1)!==this.FDelimiter;)i+=1;this.Add(pas.System.Copy(t,e,i-e)),e=i}else s&&this.Add("");s=!0}else for(;e<=t.length;){for(s&&e<=t.length&&t.charAt(e-1)===this.FDelimiter&&(e+=1);e<=t.length&&t.charCodeAt(e-1)<=32;)e+=1;if(e<=t.length)if(t.charAt(e-1)===this.FQuoteChar){for(i=e+1;i<=t.length&&(t.charAt(i-1)!==this.FQuoteChar||i+1<=t.length&&t.charAt(i+1-1)===this.FQuoteChar);)i<=t.length&&t.charAt(i-1)===this.FQuoteChar?i+=2:i+=1;this.Add(pas.SysUtils.StringReplace(pas.System.Copy(t,e+1,i-e-1),this.FQuoteChar+this.FQuoteChar,this.FQuoteChar,rtl.createSet(0))),e=i+1}else{for(i=e;i<=t.length&&t.charCodeAt(i-1)>32&&t.charAt(i-1)!==this.FDelimiter;)i+=1;this.Add(pas.System.Copy(t,e,i-e)),e=i}else s&&this.Add("");for(;e<=t.length&&t.charCodeAt(e-1)<=32;)e+=1;s=!0}}finally{this.EndUpdate()}},this.CheckSpecialChars=function(){this.FSpecialCharsInited||(this.FQuoteChar='"',this.FDelimiter=",",this.FNameValueSeparator="=",this.FLBS=pas.System.DefaultTextLineBreakStyle,this.FSpecialCharsInited=!0,this.FLineBreak=pas.System.sLineBreak)},this.GetNextLinebreak=function(t,e,i){var s,n,o=!1,r=0,a=0;return e.set(""),o=!1,t.length-i.get()<0?o:(s=t.indexOf("\n",i.get()-1)+1,n=t.indexOf("\r",i.get()-1)+1,a=1,s>0&&n>0?(s-n==1&&(a=2),r=s<n?s:n):r=s>0&&n<1?s:n>0&&s<1?n:t.length+1,e.set(pas.System.Copy(t,i.get(),r-i.get())),i.set(r+a),o=!0)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FAlwaysQuote=!1,this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)},this.Add=function(t){var e;return e=this.GetCount(),this.Insert(this.GetCount(),t),e},this.AddObject=function(t,e){var i;return i=this.Add(t),this.PutObject(i,e),i},this.AddStrings=function(t){for(var e=0,i=0,s=t.GetCount()-1;i<=s;i++)e=i,this.AddObject(t.Get(e),t.GetObject(e))},this.Assign=function(e){var i=null;if(t.TStrings.isPrototypeOf(e)){i=e,this.BeginUpdate();try{this.Clear(),this.FSpecialCharsInited=i.FSpecialCharsInited,this.FQuoteChar=i.FQuoteChar,this.FDelimiter=i.FDelimiter,this.FNameValueSeparator=i.FNameValueSeparator,this.FLBS=i.FLBS,this.FLineBreak=i.FLineBreak,this.AddStrings(i)}finally{this.EndUpdate()}}else t.TPersistent.Assign.call(this,e)},this.BeginUpdate=function(){0===this.FUpdateCount&&this.SetUpdateState(!0),this.FUpdateCount+=1},this.EndUpdate=function(){this.FUpdateCount>0&&(this.FUpdateCount-=1),0===this.FUpdateCount&&this.SetUpdateState(!1)},this.Equals=function(e){return t.TStrings.isPrototypeOf(e)?this.Equals$2(e):pas.System.TObject.Equals.call(this,e)},this.Equals$2=function(t){var e,i=!1,s=0;if(i=!1,(e=this.GetCount())!==t.GetCount())return i;for(var n=0,o=e-1;n<=o;n++)if(s=n,this.Get(s)!==t.Get(s))return i;return i=!0},this.GetEnumerator=function(){return t.TStringsEnumerator.$create("Create$1",[this])},this.IndexOf=function(t){var e=0;for(e=0;e<this.GetCount()&&0!==this.DoCompareText(this.Get(e),t);)e+=1;return e===this.GetCount()&&(e=-1),e},this.IndexOfName=function(t){var e=0,i=0,s="";for(this.CheckSpecialChars(),e=0;e<this.GetCount();){if(s=this.Get(e),(i=pas.System.Pos(this.FNameValueSeparator,s)-1)>=0&&0===this.DoCompareText(t,pas.System.Copy(s,1,i)))return e;e+=1}return e=-1},this.GetNameValue=function(t,e,i){var s;this.CheckSpecialChars(),i.set(this.Get(t)),0!==(s=pas.System.Pos(this.FNameValueSeparator,i.get()))?(e.set(pas.System.Copy(i.get(),1,s-1)),i.set(pas.System.Copy(i.get(),s+1,i.get().length-s))):e.set("")}})),rtl.recNewT(this,"TStringItem",(function(){this.FString="",this.FObject=null,this.$eq=function(t){return this.FString===t.FString&&this.FObject===t.FObject},this.$assign=function(t){return this.FString=t.FString,this.FObject=t.FObject,this}})),this.$rtti.$Class("TStringList"),this.TStringsSortStyle={0:"sslNone",sslNone:0,1:"sslUser",sslUser:1,2:"sslAuto",sslAuto:2},rtl.createClass(this,"TStringList",this.TStrings,(function(){this.$init=function(){t.TStrings.$init.call(this),this.FList=[],this.FCount=0,this.FOnChange=null,this.FOnChanging=null,this.FDuplicates=0,this.FCaseSensitive=!1,this.FForceSort=!1,this.FOwnsObjects=!1,this.FSortStyle=0},this.$final=function(){this.FList=void 0,this.FOnChange=void 0,this.FOnChanging=void 0,t.TStrings.$final.call(this)},this.ExchangeItemsInt=function(t,e){var i,s;i=this.FList[t].FString,s=this.FList[t].FObject,this.FList[t].FString=this.FList[e].FString,this.FList[t].FObject=this.FList[e].FObject,this.FList[e].FString=i,this.FList[e].FObject=s},this.GetSorted=function(){return this.FSortStyle in rtl.createSet(1,2)},this.Grow=function(){var t=0;(t=this.GetCapacity())>=256?t+=rtl.trunc(t/4):0===t?t=4:t*=4,this.SetCapacity(t)},this.InternalClear=function(t,e){var i=0;if(t<this.FCount){if(this.FOwnsObjects)for(var s=t,n=this.FCount-1;s<=n;s++)i=s,this.FList[i].FString="",pas.SysUtils.FreeAndNil({p:this.FList[i],get:function(){return this.p.FObject},set:function(t){this.p.FObject=t}});else for(var o=t,r=this.FCount-1;o<=r;o++)i=o,this.FList[i].FString="";this.FCount=t}e||this.SetCapacity(0)},this.QuickSort=function(t,e,i){var s=0,n=0,o=0;if(e-t<=1)t<e&&i(this,t,e)>0&&this.ExchangeItems(t,e);else{for(n=t,o=e,s=t+pas.System.Random(e-t);n<o;){for(;n<s&&i(this,n,s)<=0;)n+=1;for(;o>s&&i(this,o,s)>0;)o-=1;this.ExchangeItems(n,o),s===n?s=o:s===o&&(s=n)}s-1>=t&&this.QuickSort(t,s-1,i),s+1<=e&&this.QuickSort(s+1,e,i)}},this.SetSorted=function(t){t?this.SetSortStyle(2):this.SetSortStyle(0)},this.SetCaseSensitive=function(t){if(t!==this.FCaseSensitive&&(this.FCaseSensitive=t,2===this.FSortStyle)){this.FForceSort=!0;try{this.Sort()}finally{this.FForceSort=!1}}},this.SetSortStyle=function(t){this.FSortStyle!==t&&(2===t&&this.Sort(),this.FSortStyle=t)},this.CheckIndex=function(t){(t<0||t>=this.FCount)&&this.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),t)},this.ExchangeItems=function(t,e){this.ExchangeItemsInt(t,e)},this.Changed=function(){0===this.FUpdateCount&&null!=this.FOnChange&&this.FOnChange(this)},this.Changing=function(){0===this.FUpdateCount&&null!=this.FOnChanging&&this.FOnChanging(this)},this.Get=function(t){return this.CheckIndex(t),this.FList[t].FString},this.GetCapacity=function(){return rtl.length(this.FList)},this.GetCount=function(){return this.FCount},this.GetObject=function(t){return this.CheckIndex(t),this.FList[t].FObject},this.PutObject=function(t,e){this.CheckIndex(t),this.Changing(),this.FList[t].FObject=e,this.Changed()},this.SetCapacity=function(e){e<0&&this.Error(rtl.getResStr(pas.RTLConsts,"SListCapacityError"),e),e!==this.GetCapacity()&&(this.FList=rtl.arraySetLength(this.FList,t.TStringItem,e))},this.SetUpdateState=function(t){t?this.Changing():this.Changed()},this.InsertItem=function(t,e){this.InsertItem$1(t,e,null)},this.InsertItem$1=function(e,i,s){var n=t.TStringItem.$new();this.Changing(),this.FCount===this.GetCapacity()&&this.Grow(),n.FString=i,n.FObject=s,this.FList.splice(e,0,n),this.FCount+=1,this.Changed()},this.DoCompareText=function(t,e){return this.FCaseSensitive?pas.SysUtils.CompareStr(t,e):pas.SysUtils.CompareText(t,e)},this.Destroy=function(){this.InternalClear(0,!1),t.TStrings.Destroy.call(this)},this.Add=function(t){var e=0;if(2!==this.FSortStyle)e=this.FCount;else if(this.Find(t,{get:function(){return e},set:function(t){e=t}})){var i=this.FDuplicates;if(0===i)return e;2===i&&this.Error(rtl.getResStr(pas.RTLConsts,"SDuplicateString"),0)}return this.InsertItem(e,t),e},this.Clear=function(){0!==this.FCount&&(this.Changing(),this.InternalClear(0,!1),this.Changed())},this.Delete=function(t){this.CheckIndex(t),this.Changing(),this.FOwnsObjects&&pas.SysUtils.FreeAndNil({p:this.FList[t],get:function(){return this.p.FObject},set:function(t){this.p.FObject=t}}),this.FList.splice(t,1),this.FList[this.GetCount()-1].FString="",this.FList[this.GetCount()-1].FObject=null,this.FCount-=1,this.Changed()},this.Find=function(e,i){var s=!1,n=0,o=0,r=0,a=0;if(s=!1,i.set(-1),!this.GetSorted())throw t.EListError.$create("Create$1",[rtl.getResStr(pas.RTLConsts,"SErrFindNeedsSortedList")]);for(n=0,o=this.GetCount()-1;n<=o;)r=n+rtl.trunc((o-n)/2),(a=this.DoCompareText(e,this.FList[r].FString))>0?n=r+1:(o=r-1,0===a&&(s=!0,1!==this.FDuplicates&&(n=r)));return i.set(n),s},this.IndexOf=function(e){var i=0;return this.GetSorted()?this.Find(e,{get:function(){return i},set:function(t){i=t}})||(i=-1):i=t.TStrings.IndexOf.call(this,e),i},this.Insert=function(t,e){2===this.FSortStyle?this.Error(rtl.getResStr(pas.RTLConsts,"SSortedListError"),0):((t<0||t>this.FCount)&&this.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),t),this.InsertItem(t,e))},this.Sort=function(){this.CustomSort(e.StringListAnsiCompare)},this.CustomSort=function(t){(this.FForceSort||2!==this.FSortStyle)&&this.FCount>1&&(this.Changing(),this.QuickSort(0,this.FCount-1,t),this.Changed())}})),rtl.createClass(this,"TCollectionItem",this.TPersistent,(function(){this.$init=function(){t.TPersistent.$init.call(this),this.FCollection=null,this.FID=0},this.$final=function(){this.FCollection=void 0,t.TPersistent.$final.call(this)},this.GetIndex=function(){return null!=this.FCollection?this.FCollection.FItems.IndexOf(this):-1},this.SetCollection=function(t){t!==this.FCollection&&(null!=this.FCollection&&this.FCollection.RemoveItem(this),null!=t&&t.InsertItem(this))},this.Changed=function(t){null!==this.FCollection&&0===this.FCollection.FUpdateCount&&(t?this.FCollection.Update(null):this.FCollection.Update(this))},this.GetOwner=function(){return this.FCollection},this.SetIndex=function(t){var e;(e=this.GetIndex())>-1&&e!==t&&(this.FCollection.FItems.Move(e,t),this.Changed(!0))},this.SetDisplayName=function(t){this.Changed(!1)},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.SetCollection(t),this},this.Destroy=function(){this.SetCollection(null),pas.System.TObject.Destroy.call(this)}})),this.TCollectionNotification={0:"cnAdded",cnAdded:0,1:"cnExtracting",cnExtracting:1,2:"cnDeleting",cnDeleting:2},rtl.createClass(this,"TCollection",this.TPersistent,(function(){this.$init=function(){t.TPersistent.$init.call(this),this.FItemClass=null,this.FItems=null,this.FUpdateCount=0,this.FNextID=0,this.FPropName=""},this.$final=function(){this.FItemClass=void 0,this.FItems=void 0,t.TPersistent.$final.call(this)},this.GetCount=function(){return this.FItems.FCount},this.InsertItem=function(t){this.FItemClass.isPrototypeOf(t)&&(this.FItems.Add(t),t.FCollection=this,t.FID=this.FNextID,this.FNextID+=1,this.SetItemName(t),this.Notify(t,0),this.Changed())},this.RemoveItem=function(t){var e;this.Notify(t,1),-1!==(e=this.FItems.IndexOfItem(t,1))&&this.FItems.Delete(e),t.FCollection=null,this.Changed()},this.DoClear=function(){for(var t=null;this.FItems.FCount>0;)null!=(t=rtl.getObject(this.FItems.Last()))&&t.$destroy("Destroy")},this.Changed=function(){0===this.FUpdateCount&&this.Update(null)},this.GetItem=function(t){return rtl.getObject(this.FItems.Get(t))},this.SetItemName=function(t){},this.Update=function(t){},this.Notify=function(t,e){},this.Create$1=function(e){return pas.System.TObject.Create.call(this),this.FItemClass=e,this.FItems=t.TFPList.$create("Create"),this},this.Destroy=function(){this.FUpdateCount=1;try{this.DoClear()}finally{this.FUpdateCount=0}null!=this.FItems&&this.FItems.$destroy("Destroy"),pas.System.TObject.Destroy.call(this)},this.Owner=function(){return this.GetOwner()},this.Add=function(){return this.FItemClass.$create("Create$1",[this])},this.Assign=function(e){var i=0;if(t.TCollection.isPrototypeOf(e)){this.Clear();for(var s=0,n=e.GetCount()-1;s<=n;s++)i=s,this.Add().Assign(e.GetItem(i))}else t.TPersistent.Assign.call(this,e)},this.BeginUpdate=function(){this.FUpdateCount+=1},this.Clear=function(){if(0!==this.FItems.FCount){this.BeginUpdate();try{this.DoClear()}finally{this.EndUpdate()}}},this.EndUpdate=function(){this.FUpdateCount>0&&(this.FUpdateCount-=1),0===this.FUpdateCount&&this.Changed()},this.Delete=function(t){var e=null;e=rtl.getObject(this.FItems.Get(t)),this.Notify(e,2),null!=e&&e.$destroy("Destroy")}})),rtl.createClass(this,"TOwnedCollection",this.TCollection,(function(){this.$init=function(){t.TCollection.$init.call(this),this.FOwner=null},this.$final=function(){this.FOwner=void 0,t.TCollection.$final.call(this)},this.GetOwner=function(){return this.FOwner},this.Create$2=function(e,i){return this.FOwner=e,t.TCollection.Create$1.call(this,i),this}})),this.$rtti.$Class("TComponent"),this.TOperation={0:"opInsert",opInsert:0,1:"opRemove",opRemove:1},this.TComponentStateItem={0:"csLoading",csLoading:0,1:"csReading",csReading:1,2:"csWriting",csWriting:2,3:"csDestroying",csDestroying:3,4:"csDesigning",csDesigning:4,5:"csAncestor",csAncestor:5,6:"csUpdating",csUpdating:6,7:"csFixups",csFixups:7,8:"csFreeNotification",csFreeNotification:8,9:"csInline",csInline:9,10:"csDesignInstance",csDesignInstance:10},this.TComponentStyleItem={0:"csInheritable",csInheritable:0,1:"csCheckPropAvail",csCheckPropAvail:1,2:"csSubComponent",csSubComponent:2,3:"csTransient",csTransient:3},rtl.createClass(this,"TComponent",this.TPersistent,(function(){this.$init=function(){t.TPersistent.$init.call(this),this.FOwner=null,this.FName="",this.FTag=0,this.FComponents=null,this.FFreeNotifies=null,this.FComponentState={},this.FComponentStyle={},this.FLeft=0,this.FTop=0},this.$final=function(){this.FOwner=void 0,this.FComponents=void 0,this.FFreeNotifies=void 0,this.FComponentState=void 0,this.FComponentStyle=void 0,t.TPersistent.$final.call(this)},this.GetComponent=function(t){return null==this.FComponents?null:rtl.getObject(this.FComponents.Get(t))},this.GetComponentCount=function(){return null==this.FComponents?0:this.FComponents.FCount},this.Insert=function(e){null==this.FComponents&&(this.FComponents=t.TFPList.$create("Create")),this.FComponents.Add(e),e.FOwner=this},this.Remove=function(t){t.FOwner=null,null!=this.FComponents&&(this.FComponents.Remove(t),0===this.FComponents.FCount&&(this.FComponents.$destroy("Destroy"),this.FComponents=null))},this.RemoveNotification=function(t){null!==this.FFreeNotifies&&(this.FFreeNotifies.Remove(t),0===this.FFreeNotifies.FCount&&(this.FFreeNotifies.$destroy("Destroy"),this.FFreeNotifies=null,this.FComponentState=rtl.excludeSet(this.FComponentState,8)))},this.SetReference=function(t){var e=null,i=null,s=null;""!==this.FName&&null!=this.FOwner&&(s=this.FOwner,null!=(e=this.FOwner.$class.FieldAddress(this.FName))&&(i=t?this:null,s[""+e.name]=i))},this.ChangeName=function(t){this.FName=t},this.GetOwner=function(){return this.FOwner},this.Loaded=function(){this.FComponentState=rtl.excludeSet(this.FComponentState,0)},this.Loading=function(){this.FComponentState=rtl.includeSet(this.FComponentState,0)},this.Notification=function(t,e){var i=0;if(1===e&&this.RemoveFreeNotification(t),null!=this.FComponents)for(i=this.FComponents.FCount-1;i>=0;)rtl.getObject(this.FComponents.Get(i)).Notification(t,e),(i-=1)>=this.FComponents.FCount&&(i=this.FComponents.FCount-1)},this.SetDesigning=function(t,e){var i=0;if(this.FComponentState=t?rtl.includeSet(this.FComponentState,4):rtl.excludeSet(this.FComponentState,4),null!=this.FComponents&&e)for(var s=0,n=this.FComponents.FCount-1;s<=n;s++)i=s,rtl.getObject(this.FComponents.Get(i)).SetDesigning(t,!0)},this.SetName=function(e){if(this.FName!==e){if(""!==e&&!pas.SysUtils.IsValidIdent(e,!1,!1))throw t.EComponentError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidName"),pas.System.VarRecs(18,e)]);null!=this.FOwner?this.FOwner.ValidateRename(this,this.FName,e):this.ValidateRename(null,this.FName,e),this.SetReference(!1),this.ChangeName(e),this.SetReference(!0)}},this.SetChildOrder=function(t,e){},this.SetParentComponent=function(t){},this.ValidateRename=function(e,i,s){if(null!==e&&0!==pas.SysUtils.CompareText(i,s)&&e.FOwner===this&&null!==this.FindComponent(s))throw t.EComponentError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SDuplicateName"),pas.System.VarRecs(18,s)]);4 in this.FComponentState&&null!==this.FOwner&&this.FOwner.ValidateRename(e,i,s)},this.ValidateContainer=function(t){t.ValidateInsert(this)},this.ValidateInsert=function(t){},this._AddRef=function(){return-1,-1},this.GetLeft=function(){return this.FLeft},this.GetTop=function(){return this.FTop},this.SetLeft=function(t){this.FLeft=t},this.SetTop=function(t){this.FTop=t},this._Release=function(){return-1,-1},this.Create$1=function(t){return this.FComponentStyle=rtl.createSet(0),null!=t&&t.InsertComponent(this),this},this.Destroy=function(){var t=0,e=null;if(this.Destroying(),null!=this.FFreeNotifies){for(t=this.FFreeNotifies.FCount-1;t>=0;)e=rtl.getObject(this.FFreeNotifies.Get(t)),this.FFreeNotifies.Delete(t),e.Notification(this,1),null===this.FFreeNotifies?t=0:t>this.FFreeNotifies.FCount&&(t=this.FFreeNotifies.FCount),t-=1;pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FFreeNotifies},set:function(t){this.p.FFreeNotifies=t}})}this.DestroyComponents(),null!==this.FOwner&&this.FOwner.RemoveComponent(this),pas.System.TObject.Destroy.call(this)},this.BeforeDestruction=function(){3 in this.FComponentState||this.Destroying()},this.DestroyComponents=function(){for(var t=null;null!=this.FComponents;)t=rtl.getObject(this.FComponents.Last()),this.Remove(t),t.$destroy("Destroy")},this.Destroying=function(){var t=0;if(!(3 in this.FComponentState)&&(this.FComponentState=rtl.includeSet(this.FComponentState,3),null!=this.FComponents))for(var e=0,i=this.FComponents.FCount-1;e<=i;e++)t=e,rtl.getObject(this.FComponents.Get(t)).Destroying()},this.QueryInterface=function(t,e){return this.GetInterface(t,e)?0:-2147467262},this.AfterLoadDFMValues=function(){this.EndUpdate(),this.Loaded()},this.BeforeLoadDFMValues=function(){4 in this.FComponentState||this.Loading(),this.BeginUpdate()},this.BeginUpdate=function(){},this.EndUpdate=function(){},this.FindComponent=function(t){var e=null,i=0;if(e=null,""===t||null==this.FComponents)return e;for(var s=0,n=this.FComponents.FCount-1;s<=n;s++)if(i=s,0===pas.SysUtils.CompareText(rtl.getObject(this.FComponents.Get(i)).FName,t))return e=rtl.getObject(this.FComponents.Get(i));return e},this.FreeNotification=function(e){null!==this.FOwner&&e===this.FOwner||(null==this.FFreeNotifies&&(this.FFreeNotifies=t.TFPList.$create("Create")),-1===this.FFreeNotifies.IndexOf(e)&&(this.FFreeNotifies.Add(e),e.FreeNotification(this)))},this.RemoveFreeNotification=function(t){this.RemoveNotification(t),t.RemoveNotification(this)},this.GetParentComponent=function(){return null,null},this.HasParent=function(){return!1,!1},this.InsertComponent=function(t){t.ValidateContainer(this),this.ValidateRename(t,"",t.FName),null!==t.FOwner&&t.FOwner.RemoveComponent(t),this.Insert(t),4 in this.FComponentState&&t.SetDesigning(!0,!0),this.Notification(t,0)},this.RemoveComponent=function(t){this.Notification(t,1),this.Remove(t),t.SetDesigning(!1,!0),this.ValidateRename(t,t.FName,"")},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Name",6,rtl.string,"FName","SetName"),e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag",{Default:0})})),this.TSeekOrigin={0:"soBeginning",soBeginning:0,1:"soCurrent",soCurrent:1,2:"soEnd",soEnd:2},rtl.createClass(this,"TStream",pas.System.TObject,(function(){this.GetPosition=function(){return this.Seek(0,1)},this.SetPosition=function(t){this.Seek(t,0)},this.GetSize=function(){var t,e;return e=this.Seek(0,1),t=this.Seek(0,2),this.Seek(e,0),t},this.Read=function(t,e){return this.Read$1(rtl.arrayRef(t.get()),0,e)},this.ReadBuffer=function(t,e){this.ReadBuffer$1(t,0,e)},this.ReadBuffer$1=function(e,i,s){if(this.Read$1(rtl.arrayRef(e.get()),i,s)!==s)throw t.EStreamError.$create("Create$1",[rtl.getResStr(t,"SReadError")])},this.WriteBuffer=function(t,e){this.WriteBuffer$1(t,0,e)},this.WriteBuffer$1=function(e,i,s){if(this.Write$1(e,i,s)!==s)throw t.EStreamError.$create("Create$1",[rtl.getResStr(t,"SWriteError")])};this.CopyFrom=function(t,e){var i=0,s=[],n=0,o=0;if(i=0,0===e&&t.SetPosition(0),n=131072,e>0&&e<n&&(n=e),s=rtl.arraySetLength(s,0,n),0===e)do{(o=t.Read({get:function(){return s},set:function(t){s=t}},n))>0&&this.WriteBuffer(s,o),i+=o}while(!(o<n));else for(;e>0;)o=e>n?n:e,t.ReadBuffer({get:function(){return s},set:function(t){s=t}},o),this.WriteBuffer(s,o),e-=o,i+=o;return i}})),rtl.createClass(this,"TCustomMemoryStream",this.TStream,(function(){this.$init=function(){t.TStream.$init.call(this),this.FMemory=null,this.FDataView=null,this.FDataArray=null,this.FSize=0,this.FPosition=0,this.FSizeBoundsSeek=!1},this.$final=function(){this.FMemory=void 0,this.FDataView=void 0,this.FDataArray=void 0,t.TStream.$final.call(this)},this.GetDataArray=function(){return null===this.FDataArray&&(this.FDataArray=new Uint8Array(this.FMemory)),this.FDataArray},this.GetDataView=function(){return null===this.FDataView&&(this.FDataView=new DataView(this.FMemory)),this.FDataView},this.GetSize=function(){return this.FSize},this.GetPosition=function(){return this.FPosition},this.SetPointer=function(t,e){this.FMemory=t,this.FSize=e,this.FDataView=null,this.FDataArray=null},this.MemoryToBytes=function(t){return this.MemoryToBytes$1(new Uint8Array(t))},this.MemoryToBytes$1=function(t){for(var e=[],i=0,s=0,n=t.length-1;s<=n;s++)e[i=s]=t[i];return e},this.BytesToMemory=function(t){var e;return e=new ArrayBuffer(rtl.length(t)),new Uint8Array(e).set(t),e},this.Read$1=function(t,e,i){var s=0,n=0,o=0,r=0;if(s=0,this.FSize>0&&this.FPosition<this.FSize&&this.FPosition>=0){for((s=i)>this.FSize-this.FPosition&&(s=this.FSize-this.FPosition),o=this.FPosition,r=e,n=0;n<s;)t[r]=this.GetDataView().getUint8(o),o+=1,r+=1,n+=1;this.FPosition=this.FPosition+s}return s},this.Seek=function(t,e){var i=e;return 0===i?this.FPosition=t:2===i?this.FPosition=this.FSize+t:1===i&&(this.FPosition=this.FPosition+t),this.FSizeBoundsSeek&&this.FPosition>this.FSize&&(this.FPosition=this.FSize),this.FPosition}})),rtl.createClass(this,"TMemoryStream",this.TCustomMemoryStream,(function(){this.$init=function(){t.TCustomMemoryStream.$init.call(this),this.FCapacity=0},this.SetCapacity=function(t){this.SetPointer(this.Realloc({get:function(){return t},set:function(e){t=e}}),this.FSize),this.FCapacity=t},this.Realloc=function(e){var i=null,s=0;if(e.get()<0?e.set(0):(s=this.FCapacity+rtl.trunc(this.FCapacity/4),e.get()>this.FCapacity&&e.get()<s&&e.set(s),e.set(e.get()+4095&-4096)),e.get()===this.FCapacity)i=this.FMemory;else if(0===e.get())i=null;else{if(null===(i=new ArrayBuffer(e.get())))throw t.EStreamError.$create("Create$1",[rtl.getResStr(t,"SMemoryStreamError")]);new Uint8Array(i).set(this.GetDataArray())}return i},this.Destroy=function(){this.Clear(),pas.System.TObject.Destroy.call(this)},this.Clear=function(){this.FSize=0,this.FPosition=0,this.SetCapacity(0)},this.Write$1=function(t,e,i){var s;return 0===i||this.FPosition<0?0:((s=this.FPosition+i)>this.FSize&&(s>this.FCapacity&&this.SetCapacity(s),this.FSize=s),this.GetDataArray().set(rtl.arrayCopy(0,t,e,i),this.FPosition),this.FPosition=s,i)},this.Write=function(t,e){return this.Write$1(t,0,e)}})),rtl.createClass(this,"TBytesStream",this.TMemoryStream,(function(){})),rtl.createClass(this,"TStringStream",this.TMemoryStream,(function(){this.$init=function(){t.TMemoryStream.$init.call(this),this.FEncoding=null,this.FOwnsEncoding=!1},this.$final=function(){this.FEncoding=void 0,t.TMemoryStream.$final.call(this)};this.GetDataString=function(){var e="",i=null,s=null,n=0;if(e="",this.FEncoding===t.TEncoding.GetUnicode()){if(null!==(i=new Uint16Array(this.FMemory.slice(0,this.GetSize()))))for(var o=0,r=rtl.trunc(i.length/8192);o<=r;o++)n=o,e+=String.fromCharCode.apply(null,i.slice(8192*n,8192*(n+1)))}else if(null!==(s=new Uint8Array(this.FMemory.slice(0,this.GetSize()))))return s.reduce((function(t,e){return t+String.fromCharCode(e)}),"");return e},this.Create$2=function(e){return this.Create$3(e,t.TEncoding.GetUnicode(),!0),this},this.Create$3=function(e,i,s){var n;return pas.System.TObject.Create.call(this),this.FEncoding=i,n=e.length,this.FEncoding===t.TEncoding.GetUnicode()?(this.SetPointer(t.StringToBuffer$1(e,n,this.FEncoding),2*n),this.FCapacity=2*n):(this.SetPointer(t.StringToBuffer$1(e,n,this.FEncoding),n),this.FCapacity=n),this},this.Destroy=function(){this.FOwnsEncoding&&rtl.free(this,"FEncoding"),t.TMemoryStream.Destroy.call(this)},this.ReadString=function(e){var i,s="",n=[],o=null;return i=this.GetSize()-this.GetPosition(),this.FEncoding===t.TEncoding.GetUnicode()?(i<2*e&&(e=i),n=rtl.arraySetLength(n,0,2*e),this.ReadBuffer$1({get:function(){return n},set:function(t){n=t}},0,2*e),o=this.$class.BytesToMemory(rtl.arrayRef(n)),s=t.BufferToString$1(o,0,2*e,this.FEncoding)):(i<e&&(e=i),n=rtl.arraySetLength(n,0,e),this.ReadBuffer$1({get:function(){return n},set:function(t){n=t}},0,e),o=this.$class.BytesToMemory(rtl.arrayRef(n)),s=t.BufferToString$1(o,0,e,this.FEncoding)),s},this.WriteString=function(e){var i,s;i=t.StringToBuffer$1(e,e.length,this.FEncoding),s=this.$class.MemoryToBytes(i),this.WriteBuffer(s,rtl.length(s))}})),rtl.createClass(this,"TLoadHelper",pas.System.TObject,(function(){})),rtl.createClass(this,"TEncoding",pas.System.TObject,(function(){this.FANSI=null,this.FUnicode=null,this.FUTF8=null,this.GetANSI=function(){return null==this.FANSI&&(t.TEncoding.FANSI=t.TANSIEncoding.$create("Create")),this.FANSI},this.GetUTF8=function(){return null==this.FUTF8&&(t.TEncoding.FUTF8=t.TUTF8Encoding.$create("Create")),this.FUTF8},this.GetUnicode=function(){return null==this.FUnicode&&(t.TEncoding.FUnicode=t.TUnicodeEncoding.$create("Create")),this.FUnicode}})),rtl.createClass(this,"TANSIEncoding",this.TEncoding,(function(){})),rtl.createClass(this,"TUTF8Encoding",this.TEncoding,(function(){})),rtl.createClass(this,"TUnicodeEncoding",this.TEncoding,(function(){})),rtl.createClass(this,"ComponentPlatformsAttribute",pas.System.TCustomAttribute,(function(){this.$init=function(){pas.System.TCustomAttribute.$init.call(this),this.FPlatforms=0},this.Create$1=function(t){return this.FPlatforms=t,this}})),this.TShiftState$a={0:"ssShift",ssShift:0,1:"ssAlt",ssAlt:1,2:"ssCtrl",ssCtrl:2,3:"ssLeft",ssLeft:3,4:"ssRight",ssRight:4,5:"ssMIDdle",ssMIDdle:5,6:"ssDouble",ssDouble:6,7:"ssTouch",ssTouch:7,8:"ssPen",ssPen:8,9:"ssCommand",ssCommand:9},this.$rtti.$Enum("TShiftState$a",{minvalue:0,maxvalue:9,ordtype:1,enumtype:this.TShiftState$a}),this.$rtti.$Set("TShiftState",{comptype:this.$rtti.TShiftState$a}),this.RegisterClass=function(t){e.ClassList[t.$classname]=t},this.RegisterClasses=function(e){for(var i=null,s=e,n=0,o=rtl.length(s)-1;n<=o;n++)i=s[n],t.RegisterClass(i)},this.GetClass=function(t){var i=null;return i=null,""===t?i:e.ClassList.hasOwnProperty(t)?i=rtl.getObject(e.ClassList[t]):i},this.SetLoadHelperClass=function(t){var i;return i=e.GlobalLoadHelper,e.GlobalLoadHelper=t,i},this.StringToBuffer$1=function(e,i,s){var n=null,o=0;if(s===t.TEncoding.GetUnicode()){n=new ArrayBuffer(2*i);for(var r=new Uint16Array(n),a=0,l=i-1;a<=l;a++)r[o=a]=e.charCodeAt(o)}else{n=new ArrayBuffer(i);for(var h=new Uint8Array(n),F=0,p=i-1;F<=p;F++)h[o=F]=e.charCodeAt(o)}return n},this.BufferToString$1=function(e,i,s,n){var o="",r=null,a=null;return o="",n===t.TEncoding.GetUnicode()?null!==(r=new Uint16Array(e.slice(i,s)))&&(o=""+String.fromCharCode.apply(null,r)):null!==(a=new Uint8Array(e.slice(i,s)))&&(o=""+String.fromCharCode.apply(null,a)),o},t.$implcode=function(){e.GlobalLoadHelper=null,e.StringListAnsiCompare=function(t,e,i){return t.DoCompareText(t.FList[e].FString,t.FList[i].FString)},e.TMSGrow=4096,e.ClassList=null,t.$resourcestrings={SReadError:{org:"Could not read data from stream"},SWriteError:{org:"Could not write data to stream"},SMemoryStreamError:{org:"Could not allocate memory"}}},t.$init=function(){e.ClassList=new Object}}),["Web"]),rtl.module("WEBLib.Consts",["System"],(function(){"use strict";this.$resourcestrings={SWarning:{org:"Warning"},SError:{org:"Error"},SInformation:{org:"Information"},SConfirm:{org:"Confirm"},SOK:{org:"OK"},SCancel:{org:"Cancel"},SYes:{org:"Yes"},SNo:{org:"No"},SAbort:{org:"Abort"},SRetry:{org:"Retry"},SIgnore:{org:"Ignore"},SHelp:{org:"Help"},SClose:{org:"Close"},SAll:{org:"All"},SYesToAll:{org:"Yes to all"},SNoToAll:{org:"No to all"},SWarningFR:{org:"Avertissement"},SErrorFR:{org:"Erreur"},SInformationFR:{org:"Information"},SConfirmFR:{org:"Confirmer"},SOKFR:{org:"OK"},SCancelFR:{org:"Annuler"},SYesFR:{org:"Oui"},SNoFR:{org:"Non"},SAbortFR:{org:"Interrompre"},SRetryFR:{org:"Réessayer"},SIgnoreFR:{org:"Ignorer"},SHelpFR:{org:"Aide"},SCloseFR:{org:"Fermer"},SAllFR:{org:"Tout"},SYesToAllFR:{org:"Oui à tout"},SNoToAllFR:{org:"Non à tout"},SWarningDE:{org:"Warnung"},SErrorDE:{org:"Fehler"},SInformationDE:{org:"Information"},SConfirmDE:{org:"Bestätigen"},SOKDE:{org:"OK"},SCancelDE:{org:"Verzögern"},SYesDE:{org:"Ja"},SNoDE:{org:"Nein"},SAbortDE:{org:"Abbrechen"},SRetryDE:{org:"Wiederholen"},SIgnoreDE:{org:"Ignorieren"},SHelpDE:{org:"Hilfe"},SCloseDE:{org:"Schließen"},SAllDE:{org:"Alles"},SYesToAllDE:{org:"Ja auf Alles"},SNoToAllDE:{org:"Nein auf Alles"},SWarningES:{org:"Advertencia"},SErrorES:{org:"Error"},SInformationES:{org:"Información"},SConfirmES:{org:"Confirmado"},SOKES:{org:"OK"},SCancelES:{org:"Cancelar"},SYesES:{org:"Sí"},SNoES:{org:"No"},SAbortES:{org:"Abortar"},SRetryES:{org:"Rever"},SIgnoreES:{org:"Ignorar"},SHelpES:{org:"Ayudar"},SCloseES:{org:"Cerrar"},SAllES:{org:"Todos"},SYesToAllES:{org:"Sí a todo"},SNoToAllES:{org:"No a todo"},SWarningNL:{org:"Waarschuwing"},SErrorNL:{org:"Fout"},SInformationNL:{org:"Informatie"},SConfirmNL:{org:"Bevestiging"},SOKNL:{org:"OK"},SCancelNL:{org:"Afbreken"},SYesNL:{org:"Ja"},SNoNL:{org:"Nee"},SAbortNL:{org:"Afbreken"},SRetryNL:{org:"Opnieuw"},SIgnoreNL:{org:"Negeren"},SHelpNL:{org:"Hulp"},SCloseNL:{org:"Sluiten"},SAllNL:{org:"Alles"},SYesToAllNL:{org:"Ja op alles"},SNoToAllNL:{org:"Nee op alles"}}})),rtl.module("WEBLib.Dialogs",["System","Classes","WEBLib.Controls","Web","JS","SysUtils","WEBLib.WebTools","WEBLib.Graphics"],(function(){"use strict";var t=this,e=t.$impl;this.TMsgDlgType={0:"mtWarning",mtWarning:0,1:"mtError",mtError:1,2:"mtInformation",mtInformation:2,3:"mtConfirmation",mtConfirmation:3,4:"mtCustom",mtCustom:4},this.$rtti.$Enum("TMsgDlgType",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TMsgDlgType}),this.TMsgDlgBtn={0:"mbYes",mbYes:0,1:"mbNo",mbNo:1,2:"mbOK",mbOK:2,3:"mbCancel",mbCancel:3,4:"mbAbort",mbAbort:4,5:"mbRetry",mbRetry:5,6:"mbIgnore",mbIgnore:6,7:"mbAll",mbAll:7,8:"mbNoToAll",mbNoToAll:8,9:"mbYesToAll",mbYesToAll:9,10:"mbHelp",mbHelp:10,11:"mbClose",mbClose:11},this.$rtti.$Enum("TMsgDlgBtn",{minvalue:0,maxvalue:11,ordtype:1,enumtype:this.TMsgDlgBtn}),this.$rtti.$Set("TMsgDlgButtons",{comptype:this.$rtti.TMsgDlgBtn}),rtl.createClass(this,"TCustomDialogButton",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FCaption="",this.FTag=0,this.FElementClassName=""};var t=this.$rtti;t.addProperty("Caption",0,rtl.string,"FCaption","FCaption"),t.addProperty("ElementClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","FElementClassName"),t.addProperty("Tag",0,rtl.longint,"FTag","FTag",{Default:0})})),rtl.createClass(this,"TCustomDialogButtons",pas.Classes.TOwnedCollection,(function(){this.GetItem$1=function(t){return this.GetItem(t)}})),rtl.createClass(this,"TMessageDlg",pas["WEBLib.Controls"].TCustomControl,(function(){this.$init=function(){pas["WEBLib.Controls"].TCustomControl.$init.call(this),this.FOpacity=0,this.FLayer$1=null,this.FDlg=null,this.FCancel=null,this.FMessage="",this.FTitle="",this.FMsgDlgType=0,this.FOnButtonClick=null,this.FOnClose=null,this.FButtons={},this.FDialogProc=null,this.FDialogResult=0,this.FMdx=0,this.FMdy=0,this.FDlgX=0,this.FDlgY=0,this.FCaptured$1=!1,this.FDown=!1,this.FElementTitleClassName="",this.FElementButtonClassName="",this.FElementContentClassName="",this.FDialogText=null,this.FCustomButtons=null,this.FElementDialogClassName="",this.FAutoLanguage=!1},this.$final=function(){this.FLayer$1=void 0,this.FDlg=void 0,this.FCancel=void 0,this.FOnButtonClick=void 0,this.FOnClose=void 0,this.FButtons=void 0,this.FDialogProc=void 0,this.FDialogText=void 0,this.FCustomButtons=void 0,pas["WEBLib.Controls"].TCustomControl.$final.call(this)},this.SetDialogText=function(t){this.FDialogText.Assign(t)},this.SetCustomButtons=function(t){this.FCustomButtons.Assign(t)},this.CreateElement=function(){var t=null;return 4 in this.FComponentState?t=null:pas["WEBLib.Controls"].TCustomControl.CreateElement.call(this),t};this.GetDialogText=function(t){var e="",i="",s=0;if(e="Undefined",t<this.FDialogText.GetCount()&&(e=this.FDialogText.Get(t)),this.FAutoLanguage){i=pas["WEBLib.WebTools"].GetBrowserLocale(),s=0,1===pas.System.Pos("es",i)&&(s=3),1===pas.System.Pos("fr",i)&&(s=1),1===pas.System.Pos("de",i)&&(s=2),1===pas.System.Pos("nl",i)&&(s=4);var n=s;if(3===n){var o=t;0===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SWarningES"):1===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SErrorES"):2===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SInformationES"):3===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SConfirmES"):5===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SOKES"):6===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SCancelES"):7===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesES"):8===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoES"):9===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SAbortES"):10===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SRetryES"):11===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SIgnoreES"):12===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SAllES"):13===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesToAllES"):14===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoToAllES"):15===o?e=rtl.getResStr(pas["WEBLib.Consts"],"SHelpES"):16===o&&(e=rtl.getResStr(pas["WEBLib.Consts"],"SCloseES"))}else if(1===n){var r=t;0===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SWarningFR"):1===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SErrorFR"):2===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SInformationFR"):3===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SConfirmFR"):5===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SOKFR"):6===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SCancelFR"):7===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesFR"):8===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoFR"):9===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SAbortFR"):10===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SRetryFR"):11===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SIgnoreFR"):12===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SAllFR"):13===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesToAllFR"):14===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoToAllFR"):15===r?e=rtl.getResStr(pas["WEBLib.Consts"],"SHelpFR"):16===r&&(e=rtl.getResStr(pas["WEBLib.Consts"],"SCloseFR"))}else if(2===n){var a=t;0===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SWarningDE"):1===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SErrorDE"):2===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SInformationDE"):3===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SConfirmDE"):5===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SOKDE"):6===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SCancelDE"):7===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesDE"):8===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoDE"):9===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SAbortDE"):10===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SRetryDE"):11===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SIgnoreDE"):12===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SAllDE"):13===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesToAllDE"):14===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoToAllDE"):15===a?e=rtl.getResStr(pas["WEBLib.Consts"],"SHelpDE"):16===a&&(e=rtl.getResStr(pas["WEBLib.Consts"],"SCloseDE"))}else if(4===n){var l=t;0===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SWarningNL"):1===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SErrorNL"):2===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SInformationNL"):3===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SConfirmNL"):5===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SOKNL"):6===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SCancelNL"):7===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesNL"):8===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoNL"):9===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SAbortNL"):10===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SRetryNL"):11===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SIgnoreNL"):12===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SAllNL"):13===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SYesToAllNL"):14===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SNoToAllNL"):15===l?e=rtl.getResStr(pas["WEBLib.Consts"],"SHelpNL"):16===l&&(e=rtl.getResStr(pas["WEBLib.Consts"],"SCloseNL"))}}return e},this.BindEvents=function(){},this.SetDialogResult=function(t){this.FDialogResult=t,0!==this.FDialogResult&&this.Close()},this.CreateButton=function(t,e,i){var s=null;return(s=document.createElement("BUTTON")).innerHTML=t,1===pas["WEBLib.Forms"].Application.FMainForm.FCSSLibrary?(s.setAttribute("type","BUTTON"),s.setAttribute("class","btn "+i),s.setAttribute("data-dismiss","modal-dialog")):(s.style.setProperty("width","100px"),s.style.setProperty("margin-left","5px"),""!==this.FElementButtonClassName?s.setAttribute("class",this.FElementButtonClassName+" "+i):""!==pas["WEBLib.Forms"].Application.FThemeButtonClassName&&s.setAttribute("class",pas["WEBLib.Forms"].Application.FThemeButtonClassName+" "+i)),s.id=t,s.addEventListener("click",rtl.createCallback(this,"HandleButtonClick")),s.addEventListener("keydown",rtl.createCallback(this,"HandleKeyDown")),e.get()&&(setTimeout((function(){s.focus()}),1),e.set(!1)),s},this.HandleDocMouseMove=function(t){var e=0,i=0,s=null;return this.FDown&&(e=t.screenX-this.FMdx,i=t.screenY-this.FMdy,(s=this.FDlg).style.setProperty("transform",""),s.style.setProperty("position","absolute"),s.style.setProperty("left",pas.SysUtils.IntToStr(Math.round(this.FDlgX+e))+"px"),s.style.setProperty("top",pas.SysUtils.IntToStr(Math.round(this.FDlgY+i))+"px"),(s=this.FCancel).style.setProperty("position","absolute"),s.style.setProperty("top","0"),s.style.setProperty("right","0")),!0,!0},this.HandleDocMouseUp=function(t){return this.FDown=!1,document.body.removeEventListener("mousemove",rtl.createCallback(this,"HandleDocMouseMove")),document.body.removeEventListener("mouseup",rtl.createCallback(this,"HandleDocMouseUp")),!0,!0},this.HandleMouseDown=function(t){var e;return this.FMdx=Math.round(t.screenX),this.FMdy=Math.round(t.screenY),e=this.FDlg.getBoundingClientRect(),this.FDlgX=Math.round(pas.System.Int(e.left)),this.FDlgY=Math.round(pas.System.Int(e.top)),this.FDown=!0,this.FCaptured$1||(this.FCaptured$1=!0,document.body.addEventListener("mousemove",rtl.createCallback(this,"HandleDocMouseMove")),document.body.addEventListener("mouseup",rtl.createCallback(this,"HandleDocMouseUp"))),!0,!0},this.HandleButtonClick=function(t){var e,i=0;if(this.SetDialogResult(0),(e=t.target.getAttribute("id"))===this.GetDialogText(7)?this.SetDialogResult(6):e===this.GetDialogText(8)?this.SetDialogResult(7):e===this.GetDialogText(5)?this.SetDialogResult(1):e===this.GetDialogText(6)?this.SetDialogResult(2):e===this.GetDialogText(9)?this.SetDialogResult(3):e===this.GetDialogText(10)?this.SetDialogResult(4):e===this.GetDialogText(11)?this.SetDialogResult(5):e===this.GetDialogText(12)?this.SetDialogResult(12):e===this.GetDialogText(13)?this.SetDialogResult(13):e===this.GetDialogText(14)?this.SetDialogResult(14):e===this.GetDialogText(15)?this.SetDialogResult(9):e===this.GetDialogText(16)&&this.SetDialogResult(8),0===this.FDialogResult&&this.FCustomButtons.GetCount()>0)for(var s=0,n=this.FCustomButtons.GetCount()-1;s<=n;s++)if(i=s,e===this.FCustomButtons.GetItem$1(i).FCaption){this.SetDialogResult(100+i);break}return null!=this.FOnButtonClick&&this.FOnButtonClick(this),!0,!0},this.HandleKeyDown=function(t){var e,i=!1;return e=this.GetKeyCode(t.key,!0),pas.System.Assigned(e)?(27===e&&this.SetDialogResult(2),i=!0):i},this.InitBootstrapStyle=function(){this.FElementButtonClassName="btn",this.FElementContentClassName="text-body",this.FElementTitleClassName="text-body",this.FElementDialogClassName="shadow-lg p-3 mb-5 bg-white rounded"},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FOpacity=.2,this.FMessage="",this.FAutoLanguage=!0,this.FMsgDlgType=2,this.FDialogText=pas.Classes.TStringList.$create("Create$1"),this.FDialogText.SetSkipLastLineBreak(!0),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SWarning")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SError")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SInformation")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SConfirm")),this.FDialogText.Add("Custom"),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SOK")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SCancel")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SYes")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SNo")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SAbort")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SRetry")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SIgnore")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SAll")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SYesToAll")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SNoToAll")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SHelp")),this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SClose")),this.FMsgDlgType=4,this.FCustomButtons=t.TCustomDialogButtons.$create("Create$2",[this,t.TCustomDialogButton]),this.FCustomButtons.FPropName="CustomButtons"},this.Destroy=function(){rtl.free(this,"FDialogText"),rtl.free(this,"FCustomButtons"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.Close=function(){pas["WEBLib.Forms"].Application.UnLockForm(pas["WEBLib.Forms"].Application.FMainForm),document.body.removeChild(this.FLayer$1),document.body.removeChild(this.FDlg),this.FDown=!1,this.FCaptured$1=!1,null!=this.FOnClose&&this.FOnClose(this),null!=this.FDialogProc&&this.FDialogProc(this.FDialogResult)},this.Show$1=function(){var t=null,i=null,s=null,n=null,o=null,r=null,a=null,l=null,h=null,F=null,p=null,c=null,u="",T="",C="",S="",d="",m="",f="",g=!1,y=0;if(null!==pas["WEBLib.Forms"].Application&&null!==pas["WEBLib.Forms"].Application.FMainForm){pas["WEBLib.Forms"].Application.HasCSS(e.lMaterial)||this.AddControlLink("material",e.lMaterial),pas["WEBLib.Forms"].Application.LockForm(pas["WEBLib.Forms"].Application.FMainForm),this.FLayer$1=document.createElement("SPAN"),document.body.appendChild(this.FLayer$1),this.FLayer$1.setAttribute("tabindex","0"),this.FLayer$1.addEventListener("keydown",rtl.createCallback(this,"HandleKeyDown")),g=!0,C=this.FTitle,this.FMessage=e.StringToHTML(this.FMessage);var b=this.FMsgDlgType;0===b?(u="warning",T="orange",C=this.GetDialogText(0)):1===b?(u="cancel",T="red",C=this.GetDialogText(1)):2===b?(u="info",T="blue",C=this.GetDialogText(2)):3===b?(u="help",T="blue",C=this.GetDialogText(3)):4===b&&(u="",T="",C=this.GetDialogText(4)),1===pas["WEBLib.Forms"].Application.FMainForm.FCSSLibrary?(this.FDlg=document.createElement("DIV"),this.FDlg.setAttribute("class","modal-dialog"),this.FDlg.setAttribute("role","document"),this.FDlg.style.setProperty("z-index","1999998"),(l=document.createElement("SPAN")).style.setProperty("position","absolute"),l.style.setProperty("top","0"),l.style.setProperty("left","0"),l.style.setProperty("right","0"),l.style.setProperty("bottom","0"),l.style.setProperty("z-index","1999997"),document.body.appendChild(l),l.appendChild(this.FDlg),p=this.FDlg,(F=document.createElement("DIV")).setAttribute("class","modal-content "+this.FElementDialogClassName),p.appendChild(F),c=F,p=F,(F=document.createElement("DIV")).setAttribute("class","modal-header"),c.appendChild(F),p=F,(F=document.createElement("H5")).setAttribute("class","modal-title"),F.innerHTML=C,p.appendChild(F),3 in this.FButtons&&((F=document.createElement("BUTTON")).setAttribute("type","button"),F.setAttribute("class","close btn btn-danger"),F.setAttribute("data-dismiss","modal-dialog"),F.setAttribute("aria-label","Close"),F.setAttribute("id",this.GetDialogText(6)),F.addEventListener("click",rtl.createCallback(this,"HandleButtonClick")),p.appendChild(F),p=F,(F=document.createElement("SPAN")).setAttribute("aria-hidden","true"),F.setAttribute("id",this.GetDialogText(6)),F.innerHTML="&times;",p.appendChild(F)),(F=document.createElement("DIV")).setAttribute("class","modal-body"),c.appendChild(F),p=F,4!==this.FMsgDlgType&&((s=document.createElement("SPAN")).innerHTML='<i class="material-icons" style="color:'+T+'!important;font-size:48px!important">'+u+"</i>",s.style.setProperty("display","inline-block"),s.style.setProperty("float","left"),s.style.setProperty("padding-right","15px"),p.appendChild(s)),(F=document.createElement("H6")).innerHTML=this.FMessage,p.appendChild(F),(F=document.createElement("DIV")).setAttribute("class","modal-footer"),c.appendChild(F),r=p=F,this.FDlg=l):(f="5",m="26",d="#f1f1f1",S="#ababab",this.FDlg=document.createElement("DIV"),document.body.appendChild(this.FDlg),a=this.FDlg,""!==this.FElementDialogClassName?a.setAttribute("class",this.FElementDialogClassName):(a.style.setProperty("background-color","white"),a.style.setProperty("border","1px solid "+S),a.style.setProperty("font-family","Arial"),a.style.setProperty("font-size","10pt")),a.style.setProperty("cursor","default"),a.style.setProperty("position","fixed"),a.style.setProperty("min-width","300px"),a.style.setProperty("min-height","125px"),a.style.setProperty("max-width","100%"),a.style.setProperty("max-height","100%"),a.style.setProperty("top","50%"),a.style.setProperty("left","50%"),a.style.setProperty("transform","translate(-50%, -50%)"),a.style.setProperty("z-index","1999998"),a.style.setProperty("box-shadow","5px 5px 5px gray"),h=document.createElement("DIV"),this.FCancel=h,h.innerHTML='<i id="Cancel" class="material-icons" style="font-size:16px!important">clear</i>',h.id="Cancel",h.style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(pas["WEBLib.Forms"].Application.FThemeTextColor)),h.style.setProperty("position","fixed"),h.style.setProperty("top","0"),h.style.setProperty("right","0"),h.style.setProperty("padding",f+"px"),h.style.setProperty("height",m+"px"),h.style.setProperty("line-height",m+"px"),h.addEventListener("click",rtl.createCallback(this,"HandleButtonClick")),a.appendChild(h),(t=document.createElement("DIV")).innerHTML=C,""!==this.FElementTitleClassName?t.setAttribute("class",this.FElementTitleClassName):(t.style.setProperty("background-color",pas["WEBLib.Graphics"].ColorToHTML(pas["WEBLib.Forms"].Application.FThemeColor)),t.style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(pas["WEBLib.Forms"].Application.FThemeTextColor))),t.style.setProperty("cursor","move"),t.style.setProperty("padding-left",f+"px"),t.style.setProperty("height",m+"px"),t.style.setProperty("vertical-align","middle"),t.style.setProperty("line-height",m+"px"),t.style.setProperty("border-bottom","1px solid "+S),t.style.setProperty("-moz-user-select","none"),t.style.setProperty("-webkit-user-select","none"),t.style.setProperty("-ms-user-select","none"),t.style.setProperty("user-select","none"),t.style.setProperty("-o-user-select","none"),t.addEventListener("mousedown",rtl.createCallback(this,"HandleMouseDown")),a.appendChild(t),(i=document.createElement("DIV")).style.setProperty("padding",f+"px"),i.style.setProperty("height","auto"),i.style.setProperty("min-height","50px"),i.style.setProperty("border-bottom","1px solid "+S),4!==this.FMsgDlgType&&((s=document.createElement("DIV")).innerHTML='<i class="material-icons" style="color:'+T+'!important;font-size:48px!important">'+u+"</i>",s.style.setProperty("display","inline-block"),s.style.setProperty("float","left"),s.style.setProperty("padding-right","15px"),i.appendChild(s)),this.FMessage=pas.SysUtils.StringReplace(this.FMessage,pas.System.sLineBreak,"<BR>",rtl.createSet(0)),(o=document.createElement("DIV")).innerHTML=this.FMessage,o.style.setProperty("height","auto"),o.style.setProperty("min-height","50px"),o.style.setProperty("white-space","pre-wrap"),(n=document.createElement("LABEL")).innerHTML=this.FMessage,""!==this.FElementTitleClassName&&n.setAttribute("class",this.FElementContentClassName),o.appendChild(n),i.appendChild(n),a.appendChild(i),(r=document.createElement("DIV")).style.setProperty("background-color",d),r.style.setProperty("padding",f+"px"),r.style.setProperty("min-height",m+"px"),r.style.setProperty("height","auto"),r.style.setProperty("line-height",m+"px"),r.style.setProperty("text-align","right"),a.appendChild(r)),rtl.eqSet(this.FButtons,{})&&0===this.FCustomButtons.GetCount()?r.appendChild(this.CreateButton(this.GetDialogText(5),{get:function(){return g},set:function(t){g=t}},"")):(0 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(7),{get:function(){return g},set:function(t){g=t}},"")),1 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(8),{get:function(){return g},set:function(t){g=t}},"")),2 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(5),{get:function(){return g},set:function(t){g=t}},"")),3 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(6),{get:function(){return g},set:function(t){g=t}},"")),4 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(9),{get:function(){return g},set:function(t){g=t}},"")),5 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(10),{get:function(){return g},set:function(t){g=t}},"")),6 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(11),{get:function(){return g},set:function(t){g=t}},"")),7 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(12),{get:function(){return g},set:function(t){g=t}},"")),9 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(13),{get:function(){return g},set:function(t){g=t}},"")),8 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(14),{get:function(){return g},set:function(t){g=t}},"")),10 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(15),{get:function(){return g},set:function(t){g=t}},"")),11 in this.FButtons&&r.appendChild(this.CreateButton(this.GetDialogText(16),{get:function(){return g},set:function(t){g=t}},"")));for(var N=0,M=this.FCustomButtons.GetCount()-1;N<=M;N++)y=N,r.appendChild(this.CreateButton(this.FCustomButtons.GetItem$1(y).FCaption,{get:function(){return g},set:function(t){g=t}},this.FCustomButtons.GetItem$1(y).FElementClassName));(l=this.FLayer$1).style.setProperty("background-color","black"),l.style.setProperty("opacity",pas["WEBLib.WebTools"].DoubleToHTML(this.FOpacity)),l.style.setProperty("top","0"),l.style.setProperty("left","0"),l.style.setProperty("right","0"),l.style.setProperty("bottom","0"),l.style.setProperty("z-index","19990"),l.style.setProperty("webkit-user-select","none"),l.style.setProperty("moz-user-select","none"),l.style.setProperty("khtml-user-select","none"),l.style.setProperty("ms-user-select","none"),l.style.setProperty("user-select","none"),l.style.setProperty("position","fixed")}},this.ShowDialog$1=function(t,e,i,s){return 0,this.FButtons=rtl.refSet(i),this.FMessage=t,this.FMsgDlgType=e,this.FDialogProc=s,this.SetDialogResult(0),this.Show$1(),0},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("AutoLanguage",0,rtl.boolean,"FAutoLanguage","FAutoLanguage",{Default:!0}),i.addProperty("Buttons",0,t.$rtti.TMsgDlgButtons,"FButtons","FButtons",{Default:{}}),i.addProperty("CustomButtons",2,t.$rtti.TCustomDialogButtons,"FCustomButtons","SetCustomButtons"),i.addProperty("DialogText",2,pas.Classes.$rtti.TStringList,"FDialogText","SetDialogText"),i.addProperty("DialogType",0,t.$rtti.TMsgDlgType,"FMsgDlgType","FMsgDlgType",{Default:t.TMsgDlgType.mtCustom}),i.addProperty("Message",0,rtl.string,"FMessage","FMessage"),i.addProperty("Opacity",0,rtl.double,"FOpacity","FOpacity"),i.addProperty("ElementButtonClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementButtonClassName","FElementButtonClassName"),i.addProperty("ElementDialogClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementDialogClassName","FElementDialogClassName"),i.addProperty("ElementTitleClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementTitleClassName","FElementTitleClassName"),i.addProperty("ElementContentClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementContentClassName","FElementContentClassName"),i.addProperty("Title",0,rtl.string,"FTitle","FTitle"),i.addProperty("OnButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnButtonClick","FOnButtonClick"),i.addProperty("OnClose",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClose","FOnClose")})),this.MessageDlg=function(i,s,n,o){null==e.WebLibDlg&&(e.WebLibDlg=t.TMessageDlg.$create("Create$1",[null]),1===pas["WEBLib.Forms"].Application.FMainForm.FCSSLibrary&&e.WebLibDlg.InitBootstrapStyle()),e.WebLibDlg.ShowDialog$1(i,s,rtl.refSet(n),o)},this.ShowMessage=function(e){null!==pas["WEBLib.Forms"].Application&&null!==pas["WEBLib.Forms"].Application.FMainForm&&1===pas["WEBLib.Forms"].Application.FMainForm.FCSSLibrary?t.MessageDlg(e,2,rtl.createSet(2),null):alert(e)},t.$implcode=function(){e.lMaterial="https://fonts.googleapis.com/icon?family=Material+Icons",e.WebLibDlg=null,e.StringToHTML=function(t){var e="";return e=pas.SysUtils.StringReplace(t,"\r","<BR>",rtl.createSet(0)),e=pas.SysUtils.StringReplace(e,"\n","",rtl.createSet(0))}},t.$init=function(){e.WebLibDlg=null}}),["WEBLib.Forms","WEBLib.Consts"]),rtl.module("Math",["System"],(function(){"use strict";var t=this.$impl;this.SameValue=function(t,e,i){return 0===i&&(i=Math.max(1e-12*Math.min(Math.abs(t),Math.abs(e)),1e-12)),t>e?t-e<=i:e-t<=i},this.Floor=function(t){return pas.System.Trunc(Math.floor(t))},this.DegToRad=function(t){return t*(Math.PI/180)},this.RadToDeg=function(t){return t*(180/Math.PI)},this.EqualsValue=0,this.LessThanValue=-1,this.GreaterThanValue=1,this.$implcode=function(){t.DZeroResolution=1e-12}}),[]),rtl.module("WEBLib.Utils",["System","Types","Web","SysUtils","Math","Classes","JS"],(function(){"use strict";this.FormatProp=function(t,e){return pas.SysUtils.Format$1(t,e,pas.SysUtils.TFormatSettings.Invariant())}}),["RTLConsts","WEBLib.Consts"]),rtl.module("WEBLib.Controls",["System","Classes","WEBLib.Graphics","Types","SysUtils","Web","JS"],(function(){"use strict";var t=this,e=t.$impl;this.VK_BACK=8,this.VK_TAB=9,this.VK_RETURN=13,this.VK_SHIFT=16,this.VK_CONTROL=17,this.VK_MENU=18,this.VK_ESCAPE=27,this.VK_SPACE=32,this.VK_PRIOR=33,this.VK_NEXT=34,this.VK_END=35,this.VK_HOME=36,this.VK_LEFT=37,this.VK_UP=38,this.VK_RIGHT=39,this.VK_DOWN=40,this.VK_INSERT=45,this.VK_DELETE=46,this.VK_MULTIPLY=106,this.VK_ADD=107,this.VK_SUBTRACT=109,this.VK_DIVIDE=111,this.VK_F2=113,this.VK_F4=115,this.WHEEL_DELTA=120,this.$rtti.$inherited("TCursor",rtl.longint,{}),this.crDefault=0,this.crNone=1,this.crArrow=2,this.crCross=3,this.crIBeam=4,this.crSize=5,this.crSizeNESW=6,this.crSizeNS=7,this.crSizeNWSE=8,this.crSizeWE=9,this.crUpArrow=10,this.crHourGlass=11,this.crDrag=12,this.crNoDrop=13,this.crHSplit=14,this.crVSplit=15,this.crMultIDrag=16,this.crSQLWait=17,this.crNo=18,this.crAppStart=19,this.crHelp=20,this.crHandPoint=21,this.crSizeAll=22,this.CSSBackground="background-color",this.CSSZIndex="z-index",this.TDragState={0:"dsDragEnter",dsDragEnter:0,1:"dsDragLeave",dsDragLeave:1,2:"dsDragMove",dsDragMove:2},this.$rtti.$Enum("TDragState",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TDragState}),this.TDragMode={0:"dmManual",dmManual:0,1:"dmAutomatic",dmAutomatic:1},this.$rtti.$Enum("TDragMode",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TDragMode}),this.TDragKind={0:"dkDrag",dkDrag:0,1:"dkDock",dkDock:1},this.$rtti.$Enum("TDragKind",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TDragKind}),rtl.createClass(this,"TDragObject",pas.System.TObject,(function(){})),this.TAlign={0:"alNone",alNone:0,1:"alTop",alTop:1,2:"alBottom",alBottom:2,3:"alLeft",alLeft:3,4:"alRight",alRight:4,5:"alClient",alClient:5,6:"alCustom",alCustom:6},this.$rtti.$Enum("TAlign",{minvalue:0,maxvalue:6,ordtype:1,enumtype:this.TAlign}),this.TMouseButton={0:"mbLeft",mbLeft:0,1:"mbRight",mbRight:1,2:"mbMiddle",mbMiddle:2},this.$rtti.$Enum("TMouseButton",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TMouseButton}),this.TBorderStyle={0:"bsNone",bsNone:0,1:"bsSingle",bsSingle:1},this.$rtti.$Enum("TBorderStyle",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TBorderStyle}),this.TSizeStyle={0:"ssPercent",ssPercent:0,1:"ssAbsolute",ssAbsolute:1,2:"ssAuto",ssAuto:2},this.$rtti.$Enum("TSizeStyle",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TSizeStyle}),this.TAnchorKind={0:"akLeft",akLeft:0,1:"akTop",akTop:1,2:"akRight",akRight:2,3:"akBottom",akBottom:3},this.$rtti.$Enum("TAnchorKind",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TAnchorKind}),this.$rtti.$Set("TAnchors",{comptype:this.$rtti.TAnchorKind}),this.$rtti.$inherited("TElementClassName",rtl.string,{}),this.$rtti.$inherited("TElementID",rtl.string,{}),this.TElementFont={0:"efProperty",efProperty:0,1:"efCSS",efCSS:1},this.$rtti.$Enum("TElementFont",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TElementFont}),this.TElementPosition={0:"epAbsolute",epAbsolute:0,1:"epRelative",epRelative:1,2:"epIgnore",epIgnore:2},this.$rtti.$Enum("TElementPosition",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TElementPosition}),this.TElementEvent={0:"eeClick",eeClick:0,1:"eeMouseDown",eeMouseDown:1,2:"eeMouseUp",eeMouseUp:2,3:"eeMouseMove",eeMouseMove:3,4:"eeDblClick",eeDblClick:4,5:"eeKeyPress",eeKeyPress:5,6:"eeKeyDown",eeKeyDown:6,7:"eeKeyUp",eeKeyUp:7},this.TTextDirection={0:"tdDefault",tdDefault:0,1:"tdLeftToRight",tdLeftToRight:1,2:"tdRightToLeft",tdRightToLeft:2,3:"tdInherit",tdInherit:3},this.$rtti.$Enum("TTextDirection",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTextDirection}),this.TMaterialGlyphType={0:"mgNormal",mgNormal:0,1:"mgOutlined",mgOutlined:1,2:"mgTwoTone",mgTwoTone:2,3:"mgRound",mgRound:3,4:"mgSharp",mgSharp:4},this.$rtti.$Enum("TMaterialGlyphType",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TMaterialGlyphType}),rtl.recNewT(this,"TJSXMLHttpRequestRecord",(function(){this.req=null,this.$eq=function(t){return this.req===t.req},this.$assign=function(t){return this.req=t.req,this},t.$rtti.$Record("TJSXMLHttpRequestRecord",{}).addField("req",pas.Web.$rtti.TJSXMLHttpRequest)})),rtl.recNewT(this,"TJSEventRecord",(function(){this.event=null,this.$eq=function(t){return this.event===t.event},this.$assign=function(t){return this.event=t.event,this},t.$rtti.$Record("TJSEventRecord",{}).addField("event",pas.Web.$rtti.TJSEvent)})),this.$rtti.$MethodVar("THTTPRequestResponseEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ARequest",this.$rtti.TJSXMLHttpRequestRecord],["AResponse",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("THTTPErrorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ARequest",this.$rtti.TJSXMLHttpRequestRecord],["Event",this.$rtti.TJSEventRecord],["Handled",rtl.boolean,1]]),methodkind:0}),rtl.recNewT(this,"TJSHTMLElementRecord",(function(){this.element=null,this.$eq=function(t){return this.element===t.element},this.$assign=function(t){return this.element=t.element,this},t.$rtti.$Record("TJSHTMLElementRecord",{}).addField("element",pas.Web.$rtti.TJSHTMLElement)})),this.$rtti.$MethodVar("TNotifyEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject]]),methodkind:0}),this.$rtti.$MethodVar("TMouseEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Button",this.$rtti.TMouseButton],["Shift",pas.Classes.$rtti.TShiftState],["X",rtl.longint],["Y",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TMouseWheelEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Shift",pas.Classes.$rtti.TShiftState],["WheelDelta",rtl.longint],["MousePos",pas.Types.$rtti.TPoint],["Handled",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TMouseWheelUpDownEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Shift",pas.Classes.$rtti.TShiftState],["MousePos",pas.Types.$rtti.TPoint],["Handled",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TMouseMoveEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Shift",pas.Classes.$rtti.TShiftState],["X",rtl.longint],["Y",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TKeyEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AKey",rtl.word,1],["Shift",pas.Classes.$rtti.TShiftState]]),methodkind:0}),this.$rtti.$MethodVar("TKeyPressEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AChar",rtl.char,1]]),methodkind:0}),this.$rtti.$MethodVar("TTouchEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["X",rtl.longint],["Y",rtl.longint]]),methodkind:0}),this.TBiDiMode={0:"bdLeftToRight",bdLeftToRight:0,1:"bdRightToLeft",bdRightToLeft:1,2:"bdRightToLeftNoAlign",bdRightToLeftNoAlign:2,3:"bdRightToLeftReadingOnly",bdRightToLeftReadingOnly:3},this.$rtti.$Enum("TBiDiMode",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TBiDiMode}),this.$rtti.$MethodVar("TDragOverEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Source",pas.System.$rtti.TObject],["X",rtl.longint],["Y",rtl.longint],["State",this.$rtti.TDragState],["Accept",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TDragDropEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Source",pas.System.$rtti.TObject],["X",rtl.longint],["Y",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TStartDragEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["DragObject",this.$rtti.TDragObject,1]]),methodkind:0}),this.$rtti.$MethodVar("TEndDragEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Target",pas.System.$rtti.TObject],["X",rtl.longint],["Y",rtl.longint]]),methodkind:0}),this.TControlStyleValue={0:"csAcceptsControls",csAcceptsControls:0,1:"csSetCaption",csSetCaption:1},rtl.createClass(this,"TMargins",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOnChange=null,this.FLeft=0,this.FTop=0,this.FRight=0,this.FBottom=0},this.$final=function(){this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetLeft=function(t){t!==this.FLeft&&(this.FLeft=t,this.DoChange())},this.SetTop=function(t){t!==this.FTop&&(this.FTop=t,this.DoChange())},this.SetRight=function(t){t!==this.FRight&&(this.FRight=t,this.DoChange())},this.SetBottom=function(t){t!==this.FBottom&&(this.FBottom=t,this.DoChange())},this.DoChange=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Create$1=function(){return this.FLeft=3,this.FTop=3,this.FBottom=3,this.FRight=3,this},this.Assign=function(e){t.TMargins.isPrototypeOf(e)?(this.FLeft=rtl.as(e,t.TMargins).FLeft,this.FTop=rtl.as(e,t.TMargins).FTop,this.FBottom=rtl.as(e,t.TMargins).FBottom,this.FRight=rtl.as(e,t.TMargins).FRight):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("Left",2,rtl.longint,"FLeft","SetLeft",{Default:3}),e.addProperty("Top",2,rtl.longint,"FTop","SetTop",{Default:3}),e.addProperty("Right",2,rtl.longint,"FRight","SetRight",{Default:3}),e.addProperty("Bottom",2,rtl.longint,"FBottom","SetBottom",{Default:3})})),rtl.createClass(this,"TPadding",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOnChange=null,this.FLeft=0,this.FTop=0,this.FRight=0,this.FBottom=0},this.$final=function(){this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetLeft=function(t){this.FLeft!==t&&(this.FLeft=t,this.DoChange())},this.SetTop=function(t){this.FTop!==t&&(this.FTop=t,this.DoChange())},this.SetRight=function(t){this.FRight!==t&&(this.FRight=t,this.DoChange())},this.SetBottom=function(t){this.FBottom!==t&&(this.FBottom=t,this.DoChange())},this.DoChange=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FLeft=0,this.FTop=0,this.FRight=0,this.FBottom=0,this},this.Assign=function(e){t.TPadding.isPrototypeOf(e)&&(this.FLeft=rtl.as(e,t.TPadding).FLeft,this.FRight=rtl.as(e,t.TPadding).FRight,this.FTop=rtl.as(e,t.TPadding).FTop,this.FBottom=rtl.as(e,t.TPadding).FBottom)};var e=this.$rtti;e.addProperty("Left",2,rtl.longint,"FLeft","SetLeft",{Default:0}),e.addProperty("Top",2,rtl.longint,"FTop","SetTop",{Default:0}),e.addProperty("Right",2,rtl.longint,"FRight","SetRight",{Default:0}),e.addProperty("Bottom",2,rtl.longint,"FBottom","SetBottom",{Default:0})})),rtl.createClass(this,"TControl",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FGotFocus=!1,this.FAcceptDrag=!1,this.FCaptureDown=!1,this.FMouseInsideLayer=!1,this.FLayer=null,this.FCaptured=!1,this.FControlCreated=!1,this.FUpdateCount=0,this.FBlockUpdateElement=!1,this.FElement=null,this.FID="",this.FNew=!1,this.FContainer=null,this.FElementEvent=null,this.FLastElementEvent=null,this.FElementClassName="",this.FFont=null,this.FParent=null,this.FPrevParent=null,this.FControls=[],this.FOnDragOver=null,this.FOnDragDrop=null,this.FOnStartDrag=null,this.FonEndDrag=null,this.FOnClick=null,this.FOnDblClick=null,this.FOnMouseDown=null,this.FOnMouseUp=null,this.FOnMouseMove=null,this.FOnKeyDown=null,this.FOnKeyUp=null,this.FOnKeyPress=null,this.FOnEnter=null,this.FOnExit=null,this.FEnabled=!1,this.FHint="",this.FRole="",this.FShowHint=!1,this.FTabOrder=0,this.FTabStop=!1,this.FVisible=!1,this.FWidth=0,this.FHeight=0,this.FTag$1=0,this.FAlign=0,this.FAnchors={},this.FAlignWithMargins=!1,this.FIsAligning=!1,this.FOnMouseEnter=null,this.FOnMouseLeave=null,this.FCursor=0,this.FDoubleBuffered=!1,this.FControlStyle={},this.FMargins=null,this.FOnMouseWheel=null,this.FParentDoubleBuffered=!1,this.FParentColor=!1,this.FParentFont=!1,this.FParentBiDiMode=!1,this.FOnTouchMove=null,this.FOnTouchStart=null,this.FOnTouchEnd=null,this.FOnTouchCancel=null,this.FLinkTouchEvents=!1,this.FWidthStyle=0,this.FHeightStyle=0,this.FWidthPercent=0,this.FHeightPercent=0,this.FOrigRect=pas.Types.TRect.$new(),this.FOrigParentRect=pas.Types.TRect.$new(),this.FIsResizing=!1,this.FShowFocus=!1,this.FBorderWidth=0,this.FOrigTop=0,this.FOrigLeft=0,this.FUpdateTopLeft=!1,this.FEnablePropagation=!1,this.FParentShowHint=!1,this.FScriptLoaded=!1,this.FControlScriptCountLoaded=0,this.FRequiredScripts=null,this.FElementFont=0,this.FElementPosition=0,this.FParentElement=null,this.FClipChildren=!1,this.FTextDirection=0,this.FEventStopPropagation={},this.FOnResize=null,this.FMouseMovePtr=null,this.FMouseDownPtr=null,this.FMouseUpPtr=null,this.FMouseEnterPtr=null,this.FMouseLeavePtr=null,this.FClickPtr=null,this.FDblClickPtr=null,this.FKeyDownPtr=null,this.FKeyUpPtr=null,this.FKeyPressPtr=null,this.FInputPtr=null,this.FTouchStartPtr=null,this.FTouchEndPtr=null,this.FTouchMovePtr=null,this.FTouchCancelPtr=null,this.FContextMenuPtr=null,this.FExitPtr=null,this.FEnterPtr=null,this.FWheelPtr=null,this.FLayerMouseEnterPtr=null,this.FLayerMouseLeavePtr=null,this.FScriptLoadedPtr=null,this.FDragStartPtr=null,this.FDragOverPtr=null,this.FDragEnterPtr=null,this.FDragLeavePtr=null,this.FDragEndPtr=null,this.FDragDropPtr=null,this.FChildOrder=0,this.FAllowTouch=!1,this.FWheelAccumulator=0,this.FWheelMousePos=pas.Types.TPoint.$new(),this.FBiDiMode=0,this.FOnMouseWheelDown=null,this.FOnMouseWheelUp=null,this.FNoUserSelect=!1,this.FEventsBound=!1,this.FDragMode=0,this.FToolTip=void 0,this.FColor=0},this.$final=function(){this.FLayer=void 0,this.FElement=void 0,this.FContainer=void 0,this.FElementEvent=void 0,this.FLastElementEvent=void 0,this.FFont=void 0,this.FParent=void 0,this.FPrevParent=void 0,this.FControls=void 0,this.FOnDragOver=void 0,this.FOnDragDrop=void 0,this.FOnStartDrag=void 0,this.FonEndDrag=void 0,this.FOnClick=void 0,this.FOnDblClick=void 0,this.FOnMouseDown=void 0,this.FOnMouseUp=void 0,this.FOnMouseMove=void 0,this.FOnKeyDown=void 0,this.FOnKeyUp=void 0,this.FOnKeyPress=void 0,this.FOnEnter=void 0,this.FOnExit=void 0,this.FAnchors=void 0,this.FOnMouseEnter=void 0,this.FOnMouseLeave=void 0,this.FControlStyle=void 0,this.FMargins=void 0,this.FOnMouseWheel=void 0,this.FOnTouchMove=void 0,this.FOnTouchStart=void 0,this.FOnTouchEnd=void 0,this.FOnTouchCancel=void 0,this.FOrigRect=void 0,this.FOrigParentRect=void 0,this.FRequiredScripts=void 0,this.FParentElement=void 0,this.FEventStopPropagation=void 0,this.FOnResize=void 0,this.FWheelMousePos=void 0,this.FOnMouseWheelDown=void 0,this.FOnMouseWheelUp=void 0,pas.Classes.TComponent.$final.call(this)},this.GetControlsCount=function(){return rtl.length(this.FControls)},this.GetControls=function(t){return this.FControls[t]},this.SetVisible=function(t){this.FVisible!==t&&(this.VisibleChanging(),this.FVisible=t,this.UpdateElement(),this.DoRealign(),this.AlignControl(this),this.VisibleChanged())},this.SetHint=function(t){this.FHint!==t&&(this.FHint=t,this.UpdateElement())},this.SetShowHint=function(t){this.FShowHint!==t&&(this.FShowHint=t,this.UpdateElement())},this.SetTabOrder=function(t){this.FTabOrder!==t&&(this.FTabOrder=t,this.UpdateElement())},this.SetTabStop=function(t){this.FTabStop!==t&&(this.FTabStop=t,this.UpdateElement())},this.SetAlign=function(t){this.FAlign!==t&&(this.FAlign=t,this.DoRealign())},this.SetAlignWithMargins=function(t){this.FAlignWithMargins!==t&&(this.FAlignWithMargins=t,this.DoRealign())},this.GetBoundsRect=function(){var t=pas.Types.TRect.$new();return t.Left=this.GetLeft(),t.Top=this.GetTop(),t.Right=this.GetLeft()+this.GetWidth(),t.Bottom=this.GetTop()+this.GetHeight(),t},this.SetBoundsRect=function(t){this.SetBoundsInt(t.Left,t.Top,t.Right-t.Left,t.Bottom-t.Top)},this.SetID=function(t){var e=null,i=null,s=null,n=null,o=0,r=0,a=0,l=0;if(this.FNew&&this.FID!==t&&null!=(e=document.getElementById(t)))return o=this.FLeft,r=this.FTop,a=this.FWidth,l=this.FHeight,i=null,this.UnbindEvents(),null!=this.FContainer&&(this.FParentElement=this.FContainer.parentElement,i=document.createElement("SPAN"),this.MoveElements(this.FContainer,i)),n=this.FParent,this.SetParent(null),this.CreateWithID(t),this.SetParentComponent(n),this.FID=t,this.FWidth=a,this.FHeight=l,this.UpdateElement(),4 in this.FComponentState&&(this.FLeft=o,this.FTop=r),void(null!=i&&this.MoveElementsAndFree(i,this.GetElementHandle()));if(!this.FNew&&this.FID!==t){if(a=this.FWidth,l=this.FHeight,null!=(e=document.getElementById(this.FID))&&(i=document.createElement("SPAN"),this.MoveElements(e,i),this.UnbindEvents()),""!==t&&null!=(e=document.getElementById(t)))return this.CreateWithID(t),this.FID=t,this.FWidth=a,this.FHeight=l,this.UpdateElement(),void this.MoveElementsAndFree(i,this.FContainer);this.FNew=!0,this.FElement=null,this.CreateControl(),""===t&&(this.CreateInitialize(),this.FWidth=a,this.FHeight=l),null!=this.FParentElement?this.FParentElement.appendChild(this.GetContainer()):document.body.appendChild(this.GetContainer()),null!=(s=pas["WEBLib.Forms"].GetParentForm(this))&&(this.SetParent(s),this.SetElementPosition(0),this.SetLeft(0),this.SetTop(0)),null!=i&&this.MoveElementsAndFree(i,this.FContainer),this.UpdateElement(),this.UpdateElementSize()}this.FID=t,null!=this.FContainer&&this.FContainer.setAttribute("id",t)},this.SetMargins=function(t){this.FMargins.Assign(t)},this.SetAnchors=function(t){rtl.neSet(this.FAnchors,t)&&(this.FAnchors=rtl.refSet(t),0 in this.FComponentState||this.UpdateAnchoring())},this.GetElementEvent=function(){return this.FElementEvent},this.GetClientOrigin=function(){var t=pas.Types.TPoint.$new(),e=null;return t.$assign(pas.Types.Point(0,0)),null!=this.GetElementHandle()&&(e=this.GetElementHandle().getBoundingClientRect(),t.$assign(pas.Types.Point(Math.round(e.left),Math.round(e.top)))),t},this.SetHeightStyle=function(t){this.FHeightStyle!==t&&(this.FHeightStyle=t,2===this.FHeightStyle&&null!=this.GetElementHandle()&&this.GetElementStyle().removeProperty("height"),this.UpdateElementSize(),this.ResetAnchoring(),this.DoBoundsChange())},this.SetWidthStyle=function(t){this.FWidthStyle!==t&&(this.FWidthStyle=t,2===this.FWidthStyle&&null!=this.GetElementHandle()&&this.GetElementStyle().removeProperty("width"),this.UpdateElementSize(),this.ResetAnchoring(),this.DoBoundsChange())},this.SetHeightPercent=function(t){this.FHeightPercent!==t&&(this.FHeightPercent=t,this.UpdateElementSize(),this.ResetAnchoring(),this.DoBoundsChange())},this.SetWidthPercent=function(t){this.FWidthPercent!==t&&(this.FWidthPercent=t,this.UpdateElementSize(),this.ResetAnchoring(),this.DoBoundsChange())},this.SetShowFocus=function(t){this.FShowFocus!==t&&(this.FShowFocus=t,this.UpdateElement())},this.GetIsLinked=function(){return!this.FNew},this.SetElementFont=function(t){this.FElementFont!==t&&(this.FElementFont=t,this.UpdateElementVisual())},this.SetElementPosition=function(t){this.FElementPosition!==t&&(this.FElementPosition=t,null!=this.GetElementHandle()&&(this.UpdateElementSize(),this.RecreateCanvas(),this.InternalResize()))},this.SetClipChildren=function(t){this.FClipChildren=t,this.UpdateElement()},this.GetClientHeight=function(){return this.GetHeight()},this.GetClientWidth=function(){return this.GetWidth()},this.SetClientHeight=function(t){this.SetHeight(t)},this.SetClientWidth=function(t){this.SetWidth(t)},this.SetChildOrderEx=function(t){this.FChildOrder=t},this.GetRole=function(){var t="";return t=this.FRole,null!=this.GetElementHandle()&&(t=this.GetElementHandle().getAttribute("role")),t},this.SetRole=function(t){this.FRole=t,null!=this.GetElementHandle()&&(""===t?this.GetElementHandle().removeAttribute("role"):this.GetElementHandle().setAttribute("role",t))},this.GetContainer=function(){return this.FContainer},this.GetChildContainer=function(){return this.FContainer},this.SetParentFont=function(t){t!==this.FParentFont&&t&&null!=this.FParent&&(this.BeginUpdate(),this.FFont.Assign(this.FParent.FFont),this.EndUpdate(),this.UpdateElement()),this.FParentFont=t},this.SetParentColor=function(t){this.FParentColor!==t&&t&&null!=this.FParent&&this.SetColor(this.FParent.FColor),this.FParentColor=t},this.SetDragMode=function(t){this.FDragMode=t,1===t?this.BeginDrag():this.DisableDrag()},this.SetWidth=function(t){this.FWidth!==t&&(this.FWidth=t,this.ResetAnchoring(),this.DoBoundsChange(),this.GetIsLinked()&&!this.IsUpdating()&&null!=this.GetElementHandle()&&(t>=0?this.GetElementStyle().setProperty("width",pas.SysUtils.IntToStr(t)+"px"):this.GetElementStyle().removeProperty("width")))},this.SetHeight=function(t){var e=null;this.FHeight!==t&&(this.FAlign in rtl.createSet(3,4,5)&&null!=this.GetElementHandle()&&(e=this.GetElementHandle().getBoundingClientRect()).top+t>=pas["WEBLib.Forms"].WinHeight()&&(t=Math.round(pas["WEBLib.Forms"].WinHeight()-e.top)),this.FHeight=t,this.ResetAnchoring(),this.DoBoundsChange(),this.GetIsLinked()&&!this.IsUpdating()&&null!=this.GetElementHandle()&&(t>=0?this.GetElementStyle().setProperty("height",pas.SysUtils.IntToStr(t)+"px"):this.GetElementStyle().removeProperty("height")))},this.SetWidthInt=function(t){this.FWidth=t},this.SetHeightInt=function(t){this.FHeight=t},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t,this.UpdateElementData())},this.RecreateCanvas=function(){},this.VisibleChanging=function(){},this.VisibleChanged=function(){for(var t=0,e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,this.GetControls(t).VisibleChanged()},this.ColorChanging=function(){},this.GetWidth=function(){var t=0,e=null;return t=this.FWidth,null==this.GetElementHandle()||0 in this.FComponentState||(-1===t&&(t=Math.round(pas.System.Int(this.GetElementHandle().offsetWidth))),1!==this.FWidthStyle&&(e=this.GetElementHandle().getBoundingClientRect(),t=Math.round(pas.System.Int(e.right-e.left)))),t},this.GetHeight=function(){var t=0,e=null;return t=this.FHeight,null==this.GetElementHandle()||0 in this.FComponentState||(-1===t&&(t=Math.round(pas.System.Int(this.GetElementHandle().offsetHeight))),1!==this.FHeightStyle&&(e=this.GetElementHandle().getBoundingClientRect(),t=Math.round(pas.System.Int(e.bottom-e.top)))),t},this.GetOuterWidth=function(){return this.FWidth-this.FBorderWidth},this.GetOuterHeight=function(){return this.FHeight-this.FBorderWidth},this.GetDesignWidth=function(){return this.FWidth},this.GetDesignHeight=function(){return this.FHeight},this.GetDesignLeft=function(){return this.FLeft},this.GetDesignTop=function(){return this.FTop},this.GetLeft=function(){var t=0;return-1!==(t=this.FLeft)||null==this.GetElementHandle()||0 in this.FComponentState||(t=Math.round(this.GetElementHandle().offsetLeft)),t},this.GetTop=function(){var t=0;return-1!==(t=this.FTop)||null==this.GetElementHandle()||0 in this.FComponentState||(t=Math.round(this.GetElementHandle().offsetTop)),t},this.CreateElement=function(){return null,null},this.CreateChildElements=function(t){},this.ContainerElement=function(){return document.body},this.IsStructuralElement=function(){return!1,!1},this.IsEnabled=function(){return this.FEnabled},this.GetNewName=function(){var e,i="",s="";return i=this.$classname,pas.System.Delete({get:function(){return i},set:function(t){i=t}},1,1),s="",null!=(e=pas["WEBLib.Forms"].GetParentForm(this))&&(s=e.$classname),s+"_"+t.FindUniqueName(i)},this.IsInputControl=function(){return!1,!1},this.RecreateElement=function(){null!=this.GetContainer()&&(this.UnbindEvents(),this.GetContainer().parentNode.removeChild(this.GetContainer()),this.FElement=null,this.CreateControl(),null!=this.FParent&&null!=this.FParent.GetContainer()&&this.FParent.GetChildContainer().appendChild(this.GetContainer()))},this.BindElement=function(){},this.CreateInitialize=function(){this.FRequiredScripts=pas.Classes.TStringList.$create("Create$1"),this.FOrigRect.$assign(pas.Types.Rect(-1,-1,-1,-1)),this.FClipChildren=!0},this.DestroyControls=function(){for(var t=0,e=null,i=this.GetControlsCount()-1;i>=0;i--)t=i,e=this.GetControls(t),e=rtl.freeLoc(e)},this.ClearControls=function(){this.FControls=rtl.arraySetLength(this.FControls,null,0)},this.GetElementStyle=function(){return this.GetElementHandle().style},this.SetControlCursor=function(t){this.FCursor=t,""===this.FElementClassName&&null!=this.GetElementHandle()&&this.SetElementPointer(this.GetElementHandle(),t)},this.SetBiDiMode=function(t){null!=this.GetElementHandle()&&(0===t?this.GetElementHandle().removeAttribute("dir"):this.GetElementHandle().setAttribute("dir","rtl"))},this.GetMouseEventButton=function(t){var e=0;e=0;var i=t.button;return 0===i?e=0:1===i?e=2:2===i&&(e=1),e},this.GetMouseEventShiftState=function(t){var e={};return e={},t.shiftKey&&(e=rtl.unionSet(e,rtl.createSet(0))),t.ctrlKey&&(e=rtl.unionSet(e,rtl.createSet(2))),t.altKey&&(e=rtl.unionSet(e,rtl.createSet(1))),1==(1&t.buttons)&&(e=rtl.unionSet(e,rtl.createSet(3))),2==(2&t.buttons)&&(e=rtl.unionSet(e,rtl.createSet(4))),4==(4&t.buttons)&&(e=rtl.unionSet(e,rtl.createSet(5))),e},this.GetKeyBoardEventShiftState=function(t){var e={};return e={},t.shiftKey&&(e=rtl.unionSet(e,rtl.createSet(0))),t.ctrlKey&&(e=rtl.unionSet(e,rtl.createSet(2))),t.altKey&&(e=rtl.unionSet(e,rtl.createSet(1))),e},this.GetMouseWheelEventShiftState=function(t){var e={};return e={},t.shiftKey&&(e=rtl.unionSet(e,rtl.createSet(0))),t.ctrlKey&&(e=rtl.unionSet(e,rtl.createSet(2))),t.altKey&&(e=rtl.unionSet(e,rtl.createSet(1))),e},this.GetTouchEventShiftState=function(t){var e={};return e={},t.shiftKey&&(e=rtl.unionSet(e,rtl.createSet(0))),t.ctrlKey&&(e=rtl.unionSet(e,rtl.createSet(2))),t.altKey&&(e=rtl.unionSet(e,rtl.createSet(1))),e},this.HandleDoClick=function(t){return this.FElementEvent=t,0 in this.FEventStopPropagation&&this.StopPropagation(),this.FEnabled&&this.Click(),!0,this.FElementEvent=null,!0},this.HandleDoWheel=function(t){var e,i=!1,s=0,n=0;return this.FElementEvent=t,this.StopPropagation(),this.XYToClient(t.clientX,t.clientY,{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}}),this.FWheelMousePos.x=Math.round(s),this.FWheelMousePos.y=Math.round(n),e=rtl.refSet(this.GetMouseWheelEventShiftState(t)),i=!1,this.MouseWheel(rtl.refSet(e),pas.System.Trunc(-t.deltaY),{get:function(){return i},set:function(t){i=t}}),!0,this.FElementEvent=null,!0},this.HandleDoDblClick=function(t){return this.FElementEvent=t,4 in this.FEventStopPropagation&&this.StopPropagation(),this.FEnabled&&this.DblClick(),!0,this.FElementEvent=null,!0},this.HandleDoMouseDown=function(i){var s,n,o=!1,r=0,a=0;return this.FElementEvent=i,1 in this.FEventStopPropagation&&this.StopPropagation(),this.CanFocus()||this.PreventDefault(),e.FMouseX=Math.round(i.clientX),e.FMouseY=Math.round(i.clientY),this.XYToClient(i.clientX,i.clientY,{get:function(){return r},set:function(t){r=t}},{get:function(){return a},set:function(t){a=t}}),this.HasVertScrollBar()&&r>this.GetWidth()-t.GetScrollBarWidth()||this.HasHorzScrollBar()&&a>this.GetHeight()-t.GetScrollBarHeight()||(s=rtl.refSet(this.GetMouseEventShiftState(i)),n=this.GetMouseEventButton(i),this.MouseDown(n,rtl.refSet(s),pas.System.Trunc(r),pas.System.Trunc(a)),o=!0,this.FElementEvent=null),o},this.HandleDoMouseUp=function(e){var i,s,n=!1,o=0,r=0;return this.FElementEvent=e,2 in this.FEventStopPropagation&&this.StopPropagation(),this.XYToClient(e.clientX,e.clientY,{get:function(){return o},set:function(t){o=t}},{get:function(){return r},set:function(t){r=t}}),this.HasVertScrollBar()&&o>this.GetWidth()-t.GetScrollBarWidth()||this.HasHorzScrollBar()&&r>this.GetHeight()-t.GetScrollBarHeight()?(this.FElementEvent=null,n):(i=rtl.refSet(this.GetMouseEventShiftState(e)),s=this.GetMouseEventButton(e),0===this.FDragMode&&this.DisableDrag(),this.MouseUp(s,rtl.refSet(i),pas.System.Trunc(o),pas.System.Trunc(r)),n=!0,this.FElementEvent=null,n)},this.HandleDoMouseMove=function(t){var i,s=0,n=0;return this.FElementEvent=t,e.FCursorX=Math.round(t.clientX),e.FCursorY=Math.round(t.clientY),3 in this.FEventStopPropagation&&this.StopPropagation(),this.XYToClient(t.clientX,t.clientY,{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}}),i=rtl.refSet(this.GetMouseEventShiftState(t)),this.MouseMove(rtl.refSet(i),pas.System.Trunc(s),pas.System.Trunc(n)),!0,this.FElementEvent=null,!0},this.HandleDoMouseLeave=function(t){var e=!1;return this.Captured()?e:(t.stopPropagation(),this.DoMouseLeave(),e=!0)},this.HandleDoContextMenu=function(t){return!0,!0},this.LayerHandleDoMouseEnter=function(t){return 0===t.buttons&&this.Captured()&&!this.FMouseInsideLayer&&(this.ReleaseCapture(),this.HandleDoMouseUp(t),this.HandleDoMouseLeave(t)),this.FMouseInsideLayer=!0,!0,!0},this.LayerHandleDoMouseLeave=function(t){return this.FMouseInsideLayer=!1,!0,!0},this.HandleDoMouseEnter=function(t){var e=!1;return this.Captured()?e:(t.stopPropagation(),this.DoMouseEnter(),e=!0)},this.HandleDoKeyDown=function(t){var e=0,i={};return this.FElementEvent=t,6 in this.FEventStopPropagation&&this.StopPropagation(),null==t.key||(e=this.GetKeyCode(t.key,!0),i=rtl.refSet(this.GetKeyBoardEventShiftState(t)),this.KeyDown({get:function(){return e},set:function(t){e=t}},rtl.refSet(i))),!0,0===e&&this.PreventDefault(),this.FElementEvent=null,!0},this.HandleDoKeyUp=function(t){var e=0,i={},s="";return this.FElementEvent=t,7 in this.FEventStopPropagation&&this.StopPropagation(),null==t.key||(e=this.GetKeyCode(t.key,!0),i=rtl.refSet(this.GetKeyBoardEventShiftState(t)),27===e&&(s="",this.KeyPress({get:function(){return s},set:function(t){s=t}})),this.KeyUp({get:function(){return e},set:function(t){e=t}},rtl.refSet(i))),!0,0===e&&this.PreventDefault(),this.FElementEvent=null,!0},this.HandleDoKeyPress=function(t){var e="";return this.FElementEvent=t,5 in this.FEventStopPropagation&&this.StopPropagation(),this.IsKeyCharacter(t.key)&&(e=this.GetKeyChar(t.key),this.KeyPress({get:function(){return e},set:function(t){e=t}})),!0,"\0"===e&&this.PreventDefault(),this.FElementEvent=null,!0},this.HandleDoInput=function(e){var i=!1,s="",n="";return t.IsAndroid()&&(this.FElementEvent=e,5 in this.FEventStopPropagation&&this.StopPropagation(),s="\0",""!==e.data&&(n=e.data,s=pas.System.Assigned(n)?n.charAt(n.length-1):"\b",this.KeyPress({get:function(){return s},set:function(t){s=t}})),i=!0,"\0"===s&&this.PreventDefault(),this.FElementEvent=null),i},this.HandleDoExit=function(t){return this.DoExit(),!0,!0},this.HandleDoEnter=function(t){return this.FElementEvent=t,this.StopPropagation(),this.DoEnter(),!0,this.FElementEvent=null,this.FGotFocus=!0,!0},this.HandleDoTouchStart=function(t){var e=0,i=0,s=null,n={};return this.FElementEvent=t,this.FLastElementEvent=t,this.StopPropagation(),this.FAllowTouch||this.PreventDefault(),t.touches.length>0&&(s=t.touches.item(0),this.XYToClient(s.clientX,s.clientY,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),n=rtl.refSet(this.GetTouchEventShiftState(t)),this.FLinkTouchEvents&&this.MouseDown(0,rtl.refSet(n),pas.System.Trunc(e),pas.System.Trunc(i)),this.TouchStart(pas.System.Trunc(e),pas.System.Trunc(i))),!0,this.FElementEvent=null,!0},this.HandleDoTouchMove=function(t){var e=0,i=0,s=null,n={};return this.FElementEvent=t,this.FLastElementEvent=t,this.StopPropagation(),this.FAllowTouch||this.PreventDefault(),this.Captured()&&this.PreventDefault(),t.touches.length>0&&(s=t.touches.item(0),this.XYToClient(s.clientX,s.clientY,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),n=rtl.refSet(this.GetTouchEventShiftState(t)),this.FLinkTouchEvents&&this.MouseMove(rtl.refSet(n),pas.System.Trunc(e),pas.System.Trunc(i)),this.TouchMove(pas.System.Trunc(e),pas.System.Trunc(i))),this.FElementEvent=null,!0,!0},this.HandleDoTouchEnd=function(t){var e=0,i=0,s=null,n={};return this.FElementEvent=t,this.FAllowTouch||this.PreventDefault(),this.ReleaseCapture(),this.StopPropagation(),null!=this.FLastElementEvent&&this.FLastElementEvent.touches.length>0&&(s=this.FLastElementEvent.touches.item(0),this.XYToClient(s.clientX,s.clientY,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),n=rtl.refSet(this.GetTouchEventShiftState(t)),this.FLinkTouchEvents&&this.MouseUp(0,rtl.refSet(n),pas.System.Trunc(e),pas.System.Trunc(i)),this.TouchEnd(pas.System.Trunc(e),pas.System.Trunc(i))),this.FElementEvent=null,!0,!0},this.HandleDoTouchCancel=function(t){var e=0,i=0,s=null,n={};return this.FElementEvent=t,this.ReleaseCapture(),this.StopPropagation(),t.touches.length>0&&(s=t.touches.item(0),this.XYToClient(s.clientX,s.clientY,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),n=rtl.refSet(this.GetTouchEventShiftState(t)),this.FLinkTouchEvents&&this.MouseUp(0,rtl.refSet(n),pas.System.Trunc(e),pas.System.Trunc(i)),this.TouchCancel(pas.System.Trunc(e),pas.System.Trunc(i))),this.FElementEvent=null,!0,!0},this.HandleDoDragStart=function(t){var i=null;return this.FElementEvent=t,t.stopPropagation(),i=null,this.DoStartDrag({get:function(){return i},set:function(t){i=t}}),e.DragObject=null!=i?i:this,!0,!0},this.HandleDoDragOver=function(t){var i;return this.FElementEvent=t,t.stopPropagation(),this.DragOver(e.DragObject,t.clientX,t.clientY,2,{p:this,get:function(){return this.p.FAcceptDrag},set:function(t){this.p.FAcceptDrag=t}}),!this.FAcceptDrag||this.IsInputControl()&&0!==t.dataTransfer.items.length||t.preventDefault(),i=!this.FAcceptDrag,this.FElementEvent=null,i},this.HandleDoDragEnter=function(t){var i;return this.FElementEvent=t,t.stopPropagation(),this.FAcceptDrag=this.IsInputControl(),this.DragOver(e.DragObject,t.clientX,t.clientY,0,{p:this,get:function(){return this.p.FAcceptDrag},set:function(t){this.p.FAcceptDrag=t}}),this.FAcceptDrag&&t.preventDefault(),i=!this.FAcceptDrag,this.FElementEvent=null,i},this.HandledoDragLeave=function(t){return this.FElementEvent=t,t.stopPropagation(),this.DragOver(e.DragObject,t.clientX,t.clientY,1,{p:this,get:function(){return this.p.FAcceptDrag},set:function(t){this.p.FAcceptDrag=t}}),!0,this.FElementEvent=null,!0},this.HandleDoDragEnd=function(t){return this.FElementEvent=t,t.stopPropagation(),this.DoEndDrag(e.DragObject,t.clientX,t.clientY),!0,0===this.FDragMode&&this.DisableDrag(),this.FElementEvent=null,!0},this.HandleDoDragDrop=function(t){var i;return this.FElementEvent=t,t.stopPropagation(),this.FAcceptDrag?(this.IsInputControl()||t.preventDefault(),this.DragDrop(e.DragObject,t.clientX,t.clientY)):t.preventDefault(),i=this.FAcceptDrag,this.FElementEvent=null,i},this.HandleFontChanged=function(t){0===this.FUpdateCount&&(this.SetParentFont(!1),this.ParentFontChanged()),this.FontChanged()},this.ParentFontChanged=function(){for(var t=0,e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,this.GetControls(t).FParentFont&&(this.GetControls(t).FFont.Assign(this.FFont),this.GetControls(t).FontChanged(),this.GetControls(t).FParentFont=!0,this.GetControls(t).ParentFontChanged())},this.DoExit=function(){null!=this.FOnExit&&this.FOnExit(this)},this.DoEnter=function(){null!=this.FOnEnter&&this.FOnEnter(this)},this.Click=function(){null!=this.FOnClick&&this.IsEnabled()&&this.FOnClick(this)},this.UpdateElement=function(){this.FBlockUpdateElement||this.FUpdateCount>0||null==this.GetElementHandle()||this.GetElementHandle()===this.ContainerElement()||this.IsUpdating()||(this.UpdateElementData(),this.GetIsLinked()||this.UpdateElementVisual())},this.UpdateElementSize=function(){var t=null,e=0,i=0,s=0,n=null,o=null;if(!(this.FBlockUpdateElement||this.FUpdateCount>0||this.GetIsLinked()||null==this.GetElementHandle()||this.GetElementHandle()===this.ContainerElement())){for(t=this.GetElementStyle(),e=0,i=0,n=this.FParent;null!=n&&0===this.FElementPosition&&0!==n.FElementPosition&&!pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(n);){if(n.GetIsLinked()&&null!=n.GetElementHandle()&&"absolute"!==n.GetElementHandle().getAttribute("position")){o=n.GetElementHandle().getBoundingClientRect(),e=Math.round(o.left),i=Math.round(o.top);break}n=n.FParent}null!=this.FParent&&this.FParent.IsStructuralElement()&&(e=this.FParent.GetLeft(),i=this.FParent.GetTop()),0===this.FElementPosition?(-1!==this.FTop?t.setProperty("top",pas.SysUtils.IntToStr(this.FTop+i)+"px"):t.setProperty("top",""),-1!==this.FLeft?t.setProperty("left",pas.SysUtils.IntToStr(this.FLeft+e)+"px"):t.setProperty("left","")):(t.removeProperty("top"),t.removeProperty("left")),1===this.FWidthStyle&&(s=this.GetOuterWidth(),-1!==this.FWidth?t.setProperty("width",pas.SysUtils.IntToStr(s)+"px"):t.removeProperty("width")),2===this.FWidthStyle&&t.removeProperty("width"),1===this.FHeightStyle&&(-1!==this.FHeight?t.setProperty("height",pas.SysUtils.IntToStr(this.GetOuterHeight())+"px"):t.removeProperty("height")),2===this.FHeightStyle&&t.removeProperty("height"),0===this.FWidthStyle&&(-1!==this.FWidth?t.setProperty("width",pas["WEBLib.Utils"].FormatProp("%.2f%%",pas.System.VarRecs(3,this.FWidthPercent))):t.removeProperty("width")),0===this.FHeightStyle&&(-1!==this.FHeight?t.setProperty("height",pas["WEBLib.Utils"].FormatProp("%.2f%%",pas.System.VarRecs(3,this.FHeightPercent))):t.removeProperty("height")),0===this.FElementPosition?t.setProperty("position","absolute"):1===this.FElementPosition?t.setProperty("position","relative"):t.removeProperty("position"),t.setProperty("box-sizing","border-box")}},this.UpdateElementVisual=function(){var e,i,s=null;if(null!=(e=this.GetElementHandle())&&!this.IsUpdating()){s=this.GetElementStyle(),this.FParentFont&&null!=this.FParent&&(this.FFont.FOnChange=null,this.FFont.Assign(this.FParent.FFont),this.FFont.FOnChange=rtl.createCallback(this,"HandleFontChanged")),""===this.FElementClassName&&(this.GetIsLinked()||(this.FClipChildren&&pas.SysUtils.LowerCase(e.tagName)!==pas["WEBLib.WebTools"].cBodyTag?s.setProperty("overflow","hidden"):s.setProperty("overflow","")),this.SetElementPointer(e,this.FCursor)),this.Captured()&&this.FLayer.style.setProperty("cursor",s.getPropertyValue("cursor")),""!==this.FElementClassName||this.CanShowFocus()?s.setProperty("outline",""):s.setProperty("outline","none"),this.UpdateElementSize();var n=this.FTextDirection;0===n?s.removeProperty("direction"):2===n?s.setProperty("direction","rtl"):1===n?s.setProperty("direction","ltr"):3===n&&s.setProperty("direction","inherit"),""===this.FElementClassName&&this.FNoUserSelect&&(s.setProperty("webkit-user-select","none"),s.setProperty("moz-user-select","none"),s.setProperty("khtml-user-select","none"),s.setProperty("ms-user-select","none"),s.setProperty("user-select","none"),s.setProperty("-webkit-tap-highlight-color","transparent")),this.SetElementColor(e,this.FColor),i=!(""===this.FElementClassName&&0===this.FElementFont&&!this.GetIsLinked()),t.SetHTMLElementFont(e,this.FFont,i),i?s.removeProperty("color"):this.IsEnabled()&&s.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(this.FFont.FColor))}},this.UpdateElementData=function(){var t=null,e=null,i="",s="",n="",o=0,r=0;if(null!=this.GetElementHandle()){if(4 in this.FComponentState||(this.FVisible?this.GetElementStyle().setProperty("display",""):this.GetElementStyle().setProperty("display","none")),this.EnableTab(),this.IsEnabled()?this.FContainer.removeAttribute("disabled"):this.FContainer.setAttribute("disabled",""),this.GetIsLinked()&&""===this.FHint)return;if(""!==this.GetRole()&&this.FContainer.setAttribute("role",this.FRole),null!=(t=pas["WEBLib.Forms"].GetParentForm(this))&&1===t.FCSSLibrary&&this.FShowHint&&""!==this.FHint){e=this.GetElementHandle(),i=this.FHint;var a=pas["WEBLib.Forms"].Application.FHintPosition;0===a?n="left":2===a?n="right":1===a?n="top":3===a&&(n="bottom"),s=pas["WEBLib.Forms"].Application.FHintClassName,o=pas["WEBLib.Forms"].Application.FHintPause,r=pas["WEBLib.Forms"].Application.FHintHidePause,this.FTooltip=new bootstrap.Tooltip(e,{title:i,placement:n,customClass:s,delay:{show:o,hide:r}})}else this.FShowHint&&""!==this.FHint?this.FContainer.setAttribute("title",this.FHint):this.FContainer.removeAttribute("title");this.IsEnabled()&&1!==this.FElementFont?1!==this.FElementFont&&this.GetElementStyle().setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(this.FFont.FColor)):this.GetElementStyle().removeProperty("color")}},this.UpdateParent=function(){this.InternalUpdateParent(),this.UpdateChildren(this.FPrevParent),this.UpdateChildren(this.FParent)},this.UpdateControlSize=function(t,e){this.FWidth=t,this.FHeight=e},this.InternalUpdateParent=function(){var t=null;t=this.FPrevParent,this.FNew&&(this.CreateControl(),null!=this.GetContainer()&&(null!=this.FParent&&null==this.FParent.GetContainer()&&this.FParent.CreateControl(),this.FParent!==t&&null!=t&&null!=t.GetContainer()&&this.GetContainer().parentNode===t.GetChildContainer()&&t.GetChildContainer().removeChild(this.GetContainer()),null!=this.FParent&&null!=this.FParent.GetContainer()&&this.FParent.GetChildContainer().appendChild(this.GetContainer())))},this.UpdateChildren=function(e){var i=0,s=null;if(null!=e&&!(3 in this.FComponentState)){0!==e.FAlign&&e.DoRealign(),t.TCustomControl.isPrototypeOf(e)&&(rtl.as(e,t.TCustomControl).RecreateCanvas(),rtl.as(e,t.TCustomControl).Invalidate());for(var n=0,o=e.GetControlsCount()-1;n<=o;n++)i=n,s=e.GetControls(i),this.UpdateChildren(s)}},this.DisableTab=function(){var t=0;this.FTabStop&&this.CanFocus()||null!=this.GetContainer()&&this.GetContainer().setAttribute("tabindex","-1");for(var e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,this.GetControls(t).DisableTab()},this.EnableTab=function(){var t=0;null==this.FContainer||this.GetIsLinked()||(this.FTabStop&&this.CanFocus()?this.FContainer.setAttribute("tabindex",pas.SysUtils.IntToStr(this.FTabOrder+1)):this.FContainer.setAttribute("tabindex","-1"));for(var e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,this.GetControls(t).EnableTab()},this.SetElementClassName=function(t){this.FElementClassName!==t&&(this.FElementClassName=t,null!=this.FContainer&&this.FContainer.setAttribute("class",t),this.UpdateElement())},this.SetColor=function(t){this.FColor=t,this.UpdateElementVisual(),this.ColorChanging()},this.SetFont=function(t){this.FFont.SetName(t.FName),this.FFont.SetSize(t.FSize),this.FFont.SetStyle(rtl.refSet(t.FStyle)),this.FFont.SetColor(t.FColor)},this.SetParent=function(t){var e;null!=t&&(t=t.CanAcceptChild(this)),e=this.FNew,this.FParent!==t&&(null!=this.FParent&&this.FParent.UnRegisterParent(this),this.FPrevParent=this.FParent,this.FParent=t,this.FGotFocus=!1,this.UpdateParent(),3 in this.FComponentState||(e||this.UpdateElement(),this.InitScript()),null!=this.FParent&&this.FParent.RegisterParent(this),0 in this.FComponentState&&null!=this.FParent&&!(0 in this.FParent.FComponentState)&&this.Loaded(),null==t||null==this.FParent||this.FParent.IsUpdating()||this.Realign(),this.Invalidate())},this.RegisterParent=function(t){this.FControls=rtl.arraySetLength(this.FControls,null,rtl.length(this.FControls)+1),this.FControls[rtl.length(this.FControls)-1]=t},this.UnRegisterParent=function(t){var e=0,i=!1;i=!1;for(var s=0,n=rtl.length(this.FControls)-1;s<=n;s++)e=s,this.FControls[e]===t&&(i=!0),i&&e<rtl.length(this.FControls)-1&&(this.FControls[e]=this.FControls[e+1]);i&&(this.FControls=rtl.arraySetLength(this.FControls,null,rtl.length(this.FControls)-1))},this.CanAcceptChild=function(t){return this,this},this.SetLeft=function(t){this.FLeft!==t&&(this.FLeft=t,this.ResetAnchoring(),this.FUpdateTopLeft||(this.FOrigLeft=t),this.UpdateElementSize(),this.RecreateCanvas(),this.InternalResize(),0 in this.FComponentState||0===this.FAlign||null==this.FParent||this.DoRealign())},this.SetTop=function(t){this.FTop!==t&&(this.FTop=t,this.ResetAnchoring(),this.FUpdateTopLeft||(this.FOrigTop=t),this.UpdateElementSize(),this.RecreateCanvas(),this.InternalResize(),0 in this.FComponentState||0===this.FAlign||null==this.FParent||this.DoRealign())},this.MouseUp=function(t,e,i,s){this.FEnabled&&null!=this.FOnMouseUp&&this.FOnMouseUp(this,t,rtl.refSet(e),i,s)},this.MouseDown=function(t,e,i,s){this.FEnabled&&null!=this.FOnMouseDown&&this.FOnMouseDown(this,t,rtl.refSet(e),i,s)},this.MouseMove=function(t,e,i){this.FEnabled&&null!=this.FOnMouseMove&&this.FOnMouseMove(this,rtl.refSet(t),e,i)},this.TouchStart=function(t,e){null!=this.FOnTouchStart&&this.FOnTouchStart(this,t,e)},this.TouchMove=function(t,e){null!=this.FOnTouchMove&&this.FOnTouchMove(this,t,e)},this.TouchEnd=function(t,e){null!=this.FOnTouchEnd&&this.FOnTouchEnd(this,t,e)},this.TouchCancel=function(t,e){null!=this.FOnTouchCancel&&this.FOnTouchCancel(this,t,e)},this.DoMouseEnter=function(){null!=this.FOnMouseEnter&&this.FOnMouseEnter(this)},this.DoMouseLeave=function(){null!=this.FOnMouseLeave&&this.FOnMouseLeave(this)},this.MouseWheel=function(t,e,i){var s=!1;for(null!=this.FOnMouseWheel&&this.FOnMouseWheel(this,rtl.refSet(t),e,pas.Types.TPoint.$clone(pas.Types.Point(0,0)),i),this.FWheelAccumulator+=e;Math.abs(this.FWheelAccumulator)>=120;)s=this.FWheelAccumulator<0,this.FWheelAccumulator=Math.abs(this.FWheelAccumulator)-120,s?(0!==this.FWheelAccumulator&&(this.FWheelAccumulator=-this.FWheelAccumulator),this.DoMouseWheelDown(rtl.refSet(t),pas.Types.TPoint.$clone(this.FWheelMousePos))):this.DoMouseWheelUp(rtl.refSet(t),pas.Types.TPoint.$clone(this.FWheelMousePos))},this.DoMouseWheelDown=function(t,e){var i=!1;return i=!1,null!=this.FOnMouseWheelDown&&this.FOnMouseWheelDown(this,rtl.refSet(t),pas.Types.TPoint.$clone(e),{get:function(){return i},set:function(t){i=t}}),i},this.DoMouseWheelUp=function(t,e){var i=!1;return i=!1,null!=this.FOnMouseWheelUp&&this.FOnMouseWheelUp(this,rtl.refSet(t),pas.Types.TPoint.$clone(e),{get:function(){return i},set:function(t){i=t}}),i},this.DblClick=function(){null!=this.FOnDblClick&&this.FOnDblClick(this)},this.KeyDown=function(t,e){null!=this.FOnKeyDown&&this.FOnKeyDown(this,t,rtl.refSet(e))},this.KeyPress=function(t){null!=this.FOnKeyPress&&this.FOnKeyPress(this,t)},this.KeyUp=function(t,e){null!=this.FOnKeyUp&&this.FOnKeyUp(this,t,rtl.refSet(e))},this.SetFocus=function(){var t=null;this.CanFocus()&&null!=this.GetElementHandle()&&(t=this.GetElementHandle(),this.FGotFocus?t.focus():setTimeout((function(){t.focus()}),1))},this.DoMarginsChanged=function(t){this.DoRealign()},this.DoRealign=function(){null==this.FParent||this.FParent.IsUpdating()||this.FParent.AlignControl(this.FParent)},this.DoBoundsChange=function(){var t,e=!1;this.UpdateElementSize(),this.RecreateCanvas(),this.FIsResizing||(this.FIsResizing=!0,this.InternalResize(),this.DoRealign(),e=!1,null!=(t=pas["WEBLib.Forms"].GetParentForm(this))&&(e=(e=t.FIsResizing$1)||t.FUpdateCount>0),(e=(e=e||this.FUpdateCount>0)||this.FIsAligning)||this.UpdateChildAnchoring(),this.FIsResizing=!1)},this.DoEndDrag=function(t,e,i){null!=this.FonEndDrag&&this.FonEndDrag(this,t,e,i)},this.DoStartDrag=function(t){null!=this.FOnStartDrag&&this.FOnStartDrag(this,t)},this.DragOver=function(t,e,i,s,n){null!=this.FOnDragOver&&this.FOnDragOver(this,t,e,i,s,n)},this.IsFocused=function(){return this.FContainer===document.activeElement},this.Focused=function(){return this.FContainer===document.activeElement},this.GetID=function(){return this.FID},this.GetElementHandle=function(){var t=null;return t=null,null!=this.FContainer&&this.FControlCreated&&(t=this.FContainer),t},this.GetElementBindHandle=function(){return this.GetElementHandle()},this.GetElement=function(){return document.getElementById(this.GetID())},this.GetKeyCode=function(t,e){var i=0;i=-1;var s=t;return"Up"===s?i=38:"Down"===s?i=40:"Left"===s?i=37:"Right"===s?i=39:"!"===s?i=56:'"'===s||"#"===s?i=51:"$"===s?i=186:"%"===s?i=192:"'"===s?i=52:"("===s?i=53:")"===s?i=219:"*"===s?i=106:"+"===s?i=107:"-"===s?i=109:","===s?i=44:"."===s?i=46:"/"===s?i=111:"\\"===s?i=226:"="===s?i=187:"<"===s||">"===s?i=226:s===pas.Web.TJSKeyNames.BackSpace?i=8:s===pas.Web.TJSKeyNames.Tab?i=9:s===pas.Web.TJSKeyNames.Enter?i=13:s===pas.Web.TJSKeyNames.Shift?i=16:s===pas.Web.TJSKeyNames.Control?i=17:s===pas.Web.TJSKeyNames.Alt?i=18:s===pas.Web.TJSKeyNames.Pause?i=19:s===pas.Web.TJSKeyNames.CapsLock?i=20:s===pas.Web.TJSKeyNames.Escape?i=27:s===pas.Web.TJSKeyNames.PageUp?i=33:s===pas.Web.TJSKeyNames.PageDown?i=34:s===pas.Web.TJSKeyNames._End?i=35:s===pas.Web.TJSKeyNames.Home?i=36:s===pas.Web.TJSKeyNames.ArrowLeft?i=37:s===pas.Web.TJSKeyNames.ArrowUp?i=38:s===pas.Web.TJSKeyNames.ArrowRight?i=39:s===pas.Web.TJSKeyNames.ArrowDown?i=40:s===pas.Web.TJSKeyNames.Insert?i=45:s===pas.Web.TJSKeyNames.Delete?i=46:s===pas.Web.TJSKeyNames.F1?i=112:s===pas.Web.TJSKeyNames.F2?i=113:s===pas.Web.TJSKeyNames.F3?i=114:s===pas.Web.TJSKeyNames.F4?i=115:s===pas.Web.TJSKeyNames.F5?i=116:s===pas.Web.TJSKeyNames.F6?i=117:s===pas.Web.TJSKeyNames.F7?i=118:s===pas.Web.TJSKeyNames.F8?i=119:s===pas.Web.TJSKeyNames.F9?i=120:s===pas.Web.TJSKeyNames.F10?i=121:s===pas.Web.TJSKeyNames.F11?i=122:s===pas.Web.TJSKeyNames.F12?i=123:s===pas.Web.TJSKeyNames.F13?i=124:s===pas.Web.TJSKeyNames.F14?i=125:s===pas.Web.TJSKeyNames.F15?i=126:s===pas.Web.TJSKeyNames.F16?i=127:s===pas.Web.TJSKeyNames.F17?i=128:s===pas.Web.TJSKeyNames.F18?i=129:s===pas.Web.TJSKeyNames.F19?i=130:s===pas.Web.TJSKeyNames.F20?i=131:pas.System.Assigned(t)&&t.length>0&&(i=t.charCodeAt(0),e&&i>=97&&i<=122?i&=223:i>=65&&i<=90?i|=64:i>122&&(i|=128)),i},this.GetKeyChar=function(t){var e="",i=0;i=-1,e="\0";var s=t;return s===pas.Web.TJSKeyNames.BackSpace?i=8:s===pas.Web.TJSKeyNames.Tab?i=9:s===pas.Web.TJSKeyNames.Enter?i=13:s===pas.Web.TJSKeyNames.Shift?i=16:s===pas.Web.TJSKeyNames.Control?i=17:s===pas.Web.TJSKeyNames.Alt?i=18:s===pas.Web.TJSKeyNames.Pause?i=19:s===pas.Web.TJSKeyNames.CapsLock?i=20:s===pas.Web.TJSKeyNames.Escape?i=27:s===pas.Web.TJSKeyNames.PageUp?i=33:s===pas.Web.TJSKeyNames.PageDown?i=34:s===pas.Web.TJSKeyNames._End?i=35:s===pas.Web.TJSKeyNames.Home?i=36:s===pas.Web.TJSKeyNames.ArrowLeft?i=37:s===pas.Web.TJSKeyNames.ArrowUp?i=38:s===pas.Web.TJSKeyNames.ArrowRight?i=39:s===pas.Web.TJSKeyNames.ArrowDown?i=40:s===pas.Web.TJSKeyNames.Insert?i=45:s===pas.Web.TJSKeyNames.Delete?i=46:s===pas.Web.TJSKeyNames.F1?i=112:s===pas.Web.TJSKeyNames.F2?i=113:s===pas.Web.TJSKeyNames.F3?i=114:s===pas.Web.TJSKeyNames.F4?i=115:s===pas.Web.TJSKeyNames.F5?i=116:s===pas.Web.TJSKeyNames.F6?i=117:s===pas.Web.TJSKeyNames.F7?i=118:s===pas.Web.TJSKeyNames.F8?i=119:s===pas.Web.TJSKeyNames.F9?i=120:s===pas.Web.TJSKeyNames.F10?i=121:s===pas.Web.TJSKeyNames.F11?i=122:s===pas.Web.TJSKeyNames.F12?i=123:s===pas.Web.TJSKeyNames.F13?i=124:s===pas.Web.TJSKeyNames.F14?i=125:s===pas.Web.TJSKeyNames.F15?i=126:s===pas.Web.TJSKeyNames.F16?i=127:s===pas.Web.TJSKeyNames.F17?i=128:s===pas.Web.TJSKeyNames.F18?i=129:s===pas.Web.TJSKeyNames.F19?i=130:s===pas.Web.TJSKeyNames.F20?i=131:e=t.charAt(0),-1!==i&&(e=String.fromCharCode(i)),e},this.IsKeyCharacter=function(t){var e=t;return"Up"!==e&&"Down"!==e&&"Left"!==e&&"Right"!==e&&e!==pas.Web.TJSKeyNames.Shift&&e!==pas.Web.TJSKeyNames.Control&&e!==pas.Web.TJSKeyNames.Alt&&e!==pas.Web.TJSKeyNames.Pause&&e!==pas.Web.TJSKeyNames.CapsLock&&e!==pas.Web.TJSKeyNames.PageUp&&e!==pas.Web.TJSKeyNames.PageDown&&e!==pas.Web.TJSKeyNames._End&&e!==pas.Web.TJSKeyNames.Home&&e!==pas.Web.TJSKeyNames.ArrowLeft&&e!==pas.Web.TJSKeyNames.ArrowUp&&e!==pas.Web.TJSKeyNames.ArrowRight&&e!==pas.Web.TJSKeyNames.ArrowDown&&e!==pas.Web.TJSKeyNames.Insert&&e!==pas.Web.TJSKeyNames.Delete&&e!==pas.Web.TJSKeyNames.F1&&e!==pas.Web.TJSKeyNames.F2&&e!==pas.Web.TJSKeyNames.F3&&e!==pas.Web.TJSKeyNames.F4&&e!==pas.Web.TJSKeyNames.F5&&e!==pas.Web.TJSKeyNames.F6&&e!==pas.Web.TJSKeyNames.F7&&e!==pas.Web.TJSKeyNames.F8&&e!==pas.Web.TJSKeyNames.F9&&e!==pas.Web.TJSKeyNames.F10&&e!==pas.Web.TJSKeyNames.F11&&e!==pas.Web.TJSKeyNames.F12&&e!==pas.Web.TJSKeyNames.F13&&e!==pas.Web.TJSKeyNames.F14&&e!==pas.Web.TJSKeyNames.F15&&e!==pas.Web.TJSKeyNames.F16&&e!==pas.Web.TJSKeyNames.F17&&e!==pas.Web.TJSKeyNames.F18&&e!==pas.Web.TJSKeyNames.F19&&e!==pas.Web.TJSKeyNames.F20},this.GetClientRect=function(){var t=pas.Types.TRect.$new(),e="",i=0,s=0;return e=pas.SysUtils.UpperCase(this.GetStyle("border-width")),s=0,(i=pas.System.Pos("PX",e))>0&&(pas.System.Delete({get:function(){return e},set:function(t){e=t}},i,2),pas.System.val$6(e,{get:function(){return s},set:function(t){s=t}},{get:function(){return i},set:function(t){i=t}})),t.$assign(pas.Types.Rect(0,0,this.GetWidth()-2*s,this.GetHeight()-2*s)),t},this.CreateControl=function(){null==this.FElement&&(this.FElement=this.CreateElement(),null!=this.FElement&&(this.FControlCreated=!0,this.FContainer=this.FElement,"body"!==this.GetID()&&this.GetContainer().setAttribute("id",this.GetID()),this.GetContainer().setAttribute("zindex","0"),""!==this.FElementClassName&&this.GetContainer().setAttribute("class",this.FElementClassName),this.CreateChildElements(this.FElement),this.BindEvents(),this.UpdateElement()))},this.ClearMethodPointers=function(){this.FWheelPtr=null,this.FClickPtr=null,this.FDblClickPtr=null,this.FMouseDownPtr=null,this.FMouseUpPtr=null,this.FMouseMovePtr=null,this.FMouseLeavePtr=null,this.FMouseEnterPtr=null,this.FKeyDownPtr=null,this.FKeyUpPtr=null,this.FKeyPressPtr=null,this.FInputPtr=null,this.FEnterPtr=null,this.FExitPtr=null,this.FTouchStartPtr=null,this.FTouchEndPtr=null,this.FTouchMovePtr=null,this.FTouchCancelPtr=null,this.FLayerMouseLeavePtr=null,this.FLayerMouseEnterPtr=null,this.FScriptLoadedPtr=null,this.FContextMenuPtr=null},this.GetMethodPointers=function(){null===this.FWheelPtr&&(this.FWheelPtr=rtl.createCallback(this,"HandleDoWheel"),this.FClickPtr=rtl.createCallback(this,"HandleDoClick"),this.FDblClickPtr=rtl.createCallback(this,"HandleDoDblClick"),this.FMouseDownPtr=rtl.createCallback(this,"HandleDoMouseDown"),this.FMouseUpPtr=rtl.createCallback(this,"HandleDoMouseUp"),this.FMouseMovePtr=rtl.createCallback(this,"HandleDoMouseMove"),this.FMouseLeavePtr=rtl.createCallback(this,"HandleDoMouseLeave"),this.FMouseEnterPtr=rtl.createCallback(this,"HandleDoMouseEnter"),this.FKeyDownPtr=rtl.createCallback(this,"HandleDoKeyDown"),this.FKeyUpPtr=rtl.createCallback(this,"HandleDoKeyUp"),this.FKeyPressPtr=rtl.createCallback(this,"HandleDoKeyPress"),this.FInputPtr=rtl.createCallback(this,"HandleDoInput"),this.FEnterPtr=rtl.createCallback(this,"HandleDoEnter"),this.FExitPtr=rtl.createCallback(this,"HandleDoExit"),this.FTouchStartPtr=rtl.createCallback(this,"HandleDoTouchStart"),this.FTouchEndPtr=rtl.createCallback(this,"HandleDoTouchEnd"),this.FTouchMovePtr=rtl.createCallback(this,"HandleDoTouchMove"),this.FTouchCancelPtr=rtl.createCallback(this,"HandleDoTouchCancel"),this.FLayerMouseLeavePtr=rtl.createCallback(this,"LayerHandleDoMouseLeave"),this.FLayerMouseEnterPtr=rtl.createCallback(this,"LayerHandleDoMouseEnter"),this.FScriptLoadedPtr=rtl.createCallback(this,"RequiredScriptLoaded"),this.FDragStartPtr=rtl.createCallback(this,"HandleDoDragStart"),this.FDragOverPtr=rtl.createCallback(this,"HandleDoDragOver"),this.FDragEnterPtr=rtl.createCallback(this,"HandleDoDragEnter"),this.FDragLeavePtr=rtl.createCallback(this,"HandledoDragLeave"),this.FDragEndPtr=rtl.createCallback(this,"HandleDoDragEnd"),this.FDragDropPtr=rtl.createCallback(this,"HandleDoDragDrop"),this.FContextMenuPtr=rtl.createCallback(this,"HandleDoContextMenu"))},this.EventsBound=function(){return this.FEventsBound},this.BindEvents=function(){var t=null;null!=this.GetElementBindHandle()&&(this.GetMethodPointers(),this.FEventsBound=!0,(t=this.GetElementBindHandle()).addEventListener("wheel",this.FWheelPtr),t.addEventListener("click",this.FClickPtr),t.addEventListener("dblclick",this.FDblClickPtr),t.addEventListener("mousedown",this.FMouseDownPtr),t.addEventListener("mouseup",this.FMouseUpPtr),t.addEventListener("mousemove",this.FMouseMovePtr),t.addEventListener("mouseleave",this.FMouseLeavePtr),t.addEventListener("mouseenter",this.FMouseEnterPtr),t.addEventListener("keydown",this.FKeyDownPtr),t.addEventListener("keyup",this.FKeyUpPtr),t.addEventListener("keypress",this.FKeyPressPtr),t.addEventListener("input",this.FInputPtr),t.addEventListener("focus",this.FEnterPtr),t.addEventListener("blur",this.FExitPtr),t.addEventListener("touchstart",this.FTouchStartPtr),t.addEventListener("touchmove",this.FTouchMovePtr),t.addEventListener("touchend",this.FTouchEndPtr),t.addEventListener("touchcancel",this.FTouchCancelPtr),t.addEventListener("contextmenu",this.FContextMenuPtr),t.addEventListener("dragstart",this.FDragStartPtr),t.addEventListener("dragover",this.FDragOverPtr),t.addEventListener("dragenter",this.FDragEnterPtr),t.addEventListener("dragleave",this.FDragLeavePtr),t.addEventListener("dragend",this.FDragEndPtr),t.addEventListener("drop",this.FDragDropPtr))},this.UnbindEvents=function(){var t=null;null!=this.GetElementBindHandle()&&((t=this.GetElementBindHandle()).removeEventListener("wheel",this.FWheelPtr),t.removeEventListener("click",this.FClickPtr),t.removeEventListener("dblclick",this.FDblClickPtr),t.removeEventListener("mousedown",this.FMouseDownPtr),t.removeEventListener("mouseup",this.FMouseUpPtr),t.removeEventListener("mousemove",this.FMouseMovePtr),t.removeEventListener("mouseleave",this.FMouseLeavePtr),t.removeEventListener("mouseenter",this.FMouseEnterPtr),t.removeEventListener("keydown",this.FKeyDownPtr),t.removeEventListener("keyup",this.FKeyUpPtr),t.removeEventListener("keypress",this.FKeyPressPtr),t.removeEventListener("focus",this.FEnterPtr),t.removeEventListener("blur",this.FExitPtr),t.removeEventListener("input",this.FInputPtr),t.removeEventListener("touchstart",this.FTouchStartPtr),t.removeEventListener("touchmove",this.FTouchMovePtr),t.removeEventListener("touchend",this.FTouchEndPtr),t.removeEventListener("touchcancel",this.FTouchEndPtr),t.removeEventListener("contextmenu",this.FContextMenuPtr))},this.AlignControls=function(t,e){var i=this,s=0;function n(t,s){var n=0,o=0,r=0,a=0;t.AnchoringInitialized()||i.InitAnchoring(),t.FUpdateTopLeft=!0,t.FAlignWithMargins?(n=t.FMargins.FLeft,o=t.FMargins.FTop,a=t.FMargins.FBottom,r=t.FMargins.FRight):(n=0,o=0,a=0,r=0);var l=s;1===l?(t.SetBoundsInt(e.Left+n,e.Top+o,e.Right-e.Left-n-r,t.GetHeight()),e.Top=e.Top+t.GetHeight()+o+a):2===l?(t.SetBoundsInt(e.Left+n,e.Bottom-t.GetHeight()-a-1,e.Right-e.Left-n-r-1,t.GetHeight()),e.Bottom=e.Bottom-t.GetHeight()-o-a):3===l?(t.SetBoundsInt(e.Left+n,e.Top+o,t.GetWidth(),e.Bottom-e.Top-o-a),e.Left=e.Left+t.GetWidth()+n+r):4===l?(t.SetBoundsInt(e.Right-t.GetWidth()-r,e.Top+o,t.GetWidth(),e.Bottom-e.Top-a-o),e.Right=e.Right-t.GetWidth()-r-n):5===l&&t.SetBoundsInt(e.Left+n,e.Top+o,e.Right-e.Left-n-r,e.Bottom-e.Top-a-o),t.FUpdateTopLeft=!1}function o(t){var e=0,s=0,o=0,r=null;r=pas.Classes.TList.$create("Create$1");for(var a=0,l=i.GetControlsCount()-1;a<=l;a++)if(e=a,i.GetControls(e).FAlign===t&&(i.GetControls(e).FVisible||4 in i.FComponentState)){o=r.GetCount();for(var h=r.GetCount()-1;h>=0;h--){s=h;var F=t;1===F?i.GetControls(e).FOrigTop<rtl.getObject(r.Get(s)).FOrigTop&&(o=s):3===F?i.GetControls(e).FOrigLeft<rtl.getObject(r.Get(s)).FOrigLeft&&(o=s):4===F?i.GetControls(e).FOrigLeft+i.GetControls(e).GetWidth()>rtl.getObject(r.Get(s)).FOrigLeft+rtl.getObject(r.Get(s)).GetWidth()&&(o=s):2===F&&i.GetControls(e).FOrigTop+i.GetControls(e).GetHeight()>rtl.getObject(r.Get(s)).FOrigTop+rtl.getObject(r.Get(s)).GetHeight()&&(o=s)}r.Insert(o,i.GetControls(e))}for(var p=0,c=r.GetCount()-1;p<=c;p++)e=p,n(rtl.getObject(r.Get(e)),t);r=rtl.freeLoc(r)}o(1),o(2),o(3),o(4),o(5),o(6);for(var r=0,a=this.GetControlsCount()-1;r<=a;r++)s=r,this.GetControls(s).AlignControl(this.GetControls(s))},this.AlignControl=function(t){var e,i=pas.Types.TRect.$new(),s=null,n="",o="",r="",a=null,l=null,h=0,F=0;this.FIsAligning||this.IsUpdating()||0 in this.FComponentState||(null==this.FParent||this.FParent.FVisible)&&(null!=(l=pas["WEBLib.Forms"].GetParentForm(this))&&l.IsUpdating()||(h=0,null!=l&&""!==l.FFormContainer&&pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(t)&&null!=(a=document.getElementById(l.FFormContainer))&&(s=a.getBoundingClientRect(),h=Math.round(s.top+1)),this.FIsAligning=!0,null!=t&&(null!=(e=t.GetElementHandle())&&(n=t.GetElementStyle().getPropertyValue("overflow"),o=t.GetElementStyle().getPropertyValue("overflow-x"),r=t.GetElementStyle().getPropertyValue("overflow-y"),this.FClipChildren&&pas.SysUtils.LowerCase(e.tagName)!==pas["WEBLib.WebTools"].cBodyTag?t.GetElementStyle().setProperty("overflow","hidden"):t.GetElementStyle().setProperty("overflow","")),i.$assign(this.GetClientRect()),this.GetIsLinked()&&(s=this.GetElementHandle().getBoundingClientRect(),i.$assign(pas.Types.Rect(0,0,Math.round(s.right-s.left),Math.round(s.bottom-s.top)))),i.Bottom+h>pas["WEBLib.Forms"].WinHeight()&&1!==this.FHeightStyle&&0!==this.FElementPosition&&!this.GetIsLinked()&&null==pas["WEBLib.Forms"].VSIDE&&(null!=this.FParent&&pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(this.FParent)||pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(this))&&(i.Bottom=pas["WEBLib.Forms"].WinHeight()-h),null!=e&&"BODY"===e.tagName&&(F=0,document.body.scrollHeight>document.body.clientHeight&&!(4 in this.FComponentState)&&(F=16),""!==l.FFormContainer?(i.Bottom=Math.round(Math.min(i.Bottom,pas["WEBLib.Forms"].WinHeight())),i.Right=Math.round(Math.min(i.Right-F,pas["WEBLib.Forms"].WinWidth()))):(i.Bottom=l.GetHeight(),i.Right=l.GetWidth())),pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(t)&&null==pas["WEBLib.Forms"].VSIDE&&(i.Bottom>pas["WEBLib.Forms"].WinHeight()&&(i.Bottom=pas["WEBLib.Forms"].WinHeight()),i.Right>pas["WEBLib.Forms"].WinWidth()&&(i.Right=pas["WEBLib.Forms"].WinWidth())),t.IsStructuralElement()&&i.$assign(this.FParent.GetClientRect()),this.AlignControls(t,i),null!=e&&(t.GetElementStyle().setProperty("overflow",n),t.GetElementStyle().setProperty("overflow-x",o),t.GetElementStyle().setProperty("overflow-y",r)),this.FIsAligning=!1)))},this.InitAnchoring=function(){var t=0,e=0,i=0;function s(e,i,s){var n;i.set(0),s.set(0),null!=(n=pas.TypInfo.GetPropInfo(e.$class.ClassInfo(),"BorderStyle"))&&((t=pas.TypInfo.GetOrdProp$1(e,n))in rtl.createSet(1,4,5)&&(i.set(4),s.set(4)),t in rtl.createSet(2,3)&&(i.set(16),s.set(16)))}if(!this.AnchoringInitialized()){e=0,i=0,pas["WEBLib.Forms"].TForm.isPrototypeOf(this)?(rtl.as(this,pas["WEBLib.Forms"].TForm).IsMiletus()&&s(this,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),this.FOrigRect.$assign(pas.Types.Rect(0,0,this.GetDesignWidth()-e,this.GetDesignHeight()-i))):this.FOrigRect.$assign(pas.Types.Rect(this.GetDesignLeft(),this.GetDesignTop(),this.GetDesignLeft()+this.GetDesignWidth(),this.GetDesignTop()+this.GetDesignHeight())),null!=this.FParent&&(pas["WEBLib.Forms"].TForm.isPrototypeOf(this.FParent)?(rtl.as(this.FParent,pas["WEBLib.Forms"].TForm).IsMiletus()&&s(this.FParent,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),this.FOrigParentRect.$assign(pas.Types.Rect(0,0,this.FParent.GetDesignWidth()-e,this.FParent.GetDesignHeight()-i))):(this.FParent.AnchoringInitialized()||this.FParent.InitAnchoring(),this.FOrigParentRect.$assign(pas.Types.Rect(this.FParent.GetDesignLeft(),this.FParent.GetDesignTop(),this.FParent.GetDesignLeft()+this.FParent.GetDesignWidth(),this.FParent.GetDesignTop()+this.FParent.GetDesignHeight()))));for(var n=0,o=this.GetControlsCount()-1;n<=o;n++)t=n,this.GetControls(t).InitAnchoring()}},this.AnchoringInitialized=function(){return-1!==this.FOrigRect.Left||-1!==this.FOrigRect.Top},this.InitScript=function(){},this.Realign=function(){this.AlignControl(this)},this.Loaded=function(){var t=0;if(0 in this.FComponentState){pas.Classes.TComponent.Loaded.call(this);for(var e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,this.GetControls(t).FElementPosition in rtl.createSet(1,2)&&!this.GetControls(t).GetIsLinked()&&this.GetControls(t).FChildOrder>=0&&this.GetControls(t).FChildOrder<this.GetChildContainer().childNodes.length&&this.GetChildContainer().insertBefore(this.GetControls(t).GetContainer(),this.GetChildContainer().childNodes.item(this.GetControls(t).FChildOrder)),this.GetControls(t).Loaded();for(var s=0,n=this.GetComponentCount()-1;s<=n;s++)t=s,0 in this.GetComponent(t).FComponentState&&this.GetComponent(t).Loaded();5===this.FAlign&&null!=this.FParent&&this.SetBoundsInt(0,0,this.FParent.FWidth,this.FParent.FHeight),this.Resize(),this.UpdateElement()}},this.InternalResize=function(){0 in this.FComponentState||this.Resize()},this.FontChanged=function(){this.UpdateElementVisual()},this.ClearChildElements=function(){var t=null;if(null!=this.GetElementHandle())for(;this.GetElementHandle().childElementCount>0;)t=this.GetElementHandle().firstChild,this.GetElementHandle().removeChild(t)},this.SetElementColor=function(e,i){var s;s=!(pas["WEBLib.Forms"].Application.FThemed||""!==this.FElementClassName),this.GetIsLinked()||t.SetHTMLElementColor(e,i,!s)},this.MoveElements=function(t,e){if(t&&e)for(;t.childNodes.length;)e.appendChild(t.firstChild)},this.MoveElementsAndFree=function(t,e){if(t&&e){for(;t.childNodes.length;)e.appendChild(t.firstChild);t.remove()}},this.CreateWithID=function(e){var i;this.ClearMethodPointers(),this.FUpdateCount=0,this.FControlCreated=!1,this.FLinkTouchEvents=!0,this.FIsResizing=!1,(null!=this.FOwner&&0 in this.FOwner.FComponentState||null==this.FOwner)&&(null!=this.FOwner&&4 in this.FOwner.FComponentState||this.Loading()),this.FElementPosition=0,this.FWidthStyle=1,this.FHeightStyle=1,i=document.getElementById(e),this.FNew=!(null!=i),this.FFont=pas["WEBLib.Graphics"].TFont.$create("Create$1"),this.FFont.FOnChange=rtl.createCallback(this,"HandleFontChanged"),this.FNew?this.FContainer=null:(this.FContainer=i,this.FControlCreated=!0,this.FElementPosition=1,this.CreateChildElements(i),this.BindElement(),this.BindEvents()),this.FID=e,this.FEnabled=!0,this.FVisible=!0,this.FLeft=0,this.FTop=0,this.FAlign=0,this.FAlignWithMargins=!1,this.FIsAligning=!1,this.FParentFont=!0,this.FParentBiDiMode=!0,this.FParentColor=!1,this.FAnchors=rtl.createSet(0,1),this.FShowFocus=!1,this.FBorderWidth=0,this.FEnablePropagation=!1,this.FToolTip=null,this.FColor=16711422,this.FMargins=t.TMargins.$create("Create$1"),this.FMargins.FOnChange=rtl.createCallback(this,"DoMarginsChanged"),this.FParent=null,this.FPrevParent=null,0 in this.FControlStyle||this.ClearControls(),this.CreateInitialize()},this.AddControlLink=function(t,e){var i,s,n;i=t,s=e,(n=document.getElementById(i))||((n=document.createElement("link")).id=i,n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",s),document.getElementsByTagName("head")[0].appendChild(n))},this.ResetAnchoring=function(){this.FOrigRect.$assign(pas.Types.Rect(-1,-1,-1,-1)),this.InitAnchoring()},this.UpdateSize=function(){var t=0;this.UpdateElementSize();for(var e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,this.GetControls(t).UpdateSize()},this.UpdateAnchoring=function(){var t=0,e=0,i=0,s=0,n=0,o=0,r=pas.Types.TRect.$new(),a=pas.Types.TRect.$new();0 in this.FComponentState||this.FControlCreated&&(-1===this.FOrigRect.Left&&-1===this.FOrigRect.Top&&this.InitAnchoring(),(null==this.FParent||this.FParent.AnchoringInitialized())&&(5!==this.FAlign&&(null==this.FParent||pas["WEBLib.Forms"].TForm.isPrototypeOf(this)||(a.$assign(this.FParent.GetBoundsRect()),t=a.Right-a.Left-(this.FOrigParentRect.Right-this.FOrigParentRect.Left),e=a.Bottom-a.Top-(this.FOrigParentRect.Bottom-this.FOrigParentRect.Top),r.$assign(this.FOrigRect),i=0,s=0,n=0,o=0,2 in this.FAnchors&&(0 in this.FAnchors?n=t:i=t),3 in this.FAnchors&&(1 in this.FAnchors?o=e:s=e),(3 in this.FAnchors||2 in this.FAnchors)&&this.SetBoundsInt(r.Left+i,r.Top+s,r.Right-r.Left+n,r.Bottom-r.Top+o))),this.UpdateChildAnchoring()))},this.UpdateChildAnchoring=function(){for(var t=0,e=0,i=this.GetControlsCount()-1;e<=i;e++)t=e,this.GetControls(t).UpdateAnchoring()},this.SetElementPointer=function(e,i){0!==i?e.style.setProperty("cursor",t.GetHTMLCursorName(i)):e.style.removeProperty("cursor")},this.IsUpdating=function(){return this.FUpdateCount>0},this.CanShowFocus=function(){return this.FShowFocus},this.RequiredScriptLoaded=function(t){rtl.asExt(t.target,HTMLScriptElement).title="tmswebloaded",this.FControlScriptCountLoaded+=1},this.StartCapture=function(){var e=null;this.FCaptureDown&&(this.Captured()&&this.ReleaseCapture(),this.FMouseInsideLayer=!0,this.FLayer=document.createElement("SPAN"),document.body.appendChild(this.FLayer),(e=this.FLayer).addEventListener("mouseenter",this.FLayerMouseEnterPtr),e.addEventListener("mouseleave",this.FLayerMouseLeavePtr),e.addEventListener("mousedown",this.FMouseDownPtr),e.addEventListener("mouseup",this.FMouseUpPtr),e.addEventListener("mousemove",this.FMouseMovePtr),e.addEventListener("touchstart",this.FTouchStartPtr),e.addEventListener("touchmove",this.FTouchMovePtr),e.addEventListener("touchend",this.FTouchEndPtr),e.addEventListener("touchcancel",this.FTouchCancelPtr),e.style.setProperty("top","0"),e.style.setProperty("left","0"),e.style.setProperty("right","0"),e.style.setProperty("bottom","0"),e.style.setProperty("webkit-user-select","none"),e.style.setProperty("moz-user-select","none"),e.style.setProperty("khtml-user-select","none"),e.style.setProperty("ms-user-select","none"),e.style.setProperty("user-select","none"),e.style.setProperty("position","absolute"),e.style.setProperty(t.CSSZIndex,"999999"),this.FCaptured=!0,this.UpdateElement())},this.GetStyle=function(t){var e,i="",s="";return s="",null==(e=this.GetElementHandle())?i:(window.getComputedStyle&&(s=getComputedStyle(e,"")[t]),e.currentStyle&&(s=e.currentStyle[t]),i=s)},this.SetBoundsInt=function(t,e,i,s){(t!==this.GetLeft()||e!==this.GetTop()||i!==this.GetWidth()&&1===this.FWidthStyle||s!==this.GetHeight()&&1===this.FHeightStyle||null!=this.FParent&&this.FParent.GetIsLinked())&&(this.FBlockUpdateElement=!0,this.FLeft=t,this.FTop=e,this.FWidth=i,this.FHeight=s,this.FBlockUpdateElement=!1,this.UpdateElementSize(),0!==this.FAlign?this.DoRealign():this.Realign(),this.RecreateCanvas(),this.DoBoundsChange(),this.Invalidate(),this.UpdateChildAnchoring())},this.MoveFirst=function(t){var e=0,i=!1;i=!1;for(var s=this.GetControlsCount()-1;s>=0;s--)e=s,this.FControls[e]===t&&(i=!0),i&&(this.FControls[e]=e>0?this.FControls[e-1]:t)},this.MoveLast=function(t){var e=0,i=!1;i=!1;for(var s=0,n=this.GetControlsCount()-1;s<=n;s++)e=s,this.FControls[e]===t&&(i=!0),i&&(e<this.GetControlsCount()-1?this.FControls[e]=this.FControls[e+1]:this.FControls[e]=t)},this.EnableDrag=function(){null!=this.GetContainer()&&this.GetContainer().setAttribute("draggable","true")},this.DisableDrag=function(){null!=this.GetContainer()&&"true"===this.GetContainer().getAttribute("draggable")&&this.GetContainer().setAttribute("draggable","false")},this.Create$2=function(t){return this.FGotFocus=!1,this.FTabStop=!0,this.FAllowTouch=!0,this.CreateWithID(t),this},this.Create$1=function(t){var e,i,s=!1;return this.FGotFocus=!1,this.FEventsBound=!1,this.FTabStop=!0,this.FAllowTouch=!0,this.FNoUserSelect=!0,this.ClearMethodPointers(),pas.Classes.TComponent.Create$1.call(this,t),this.FEventStopPropagation=rtl.createSet(0,4,2,3,1,5,6,7),this.FScriptLoaded=!1,this.FElementFont=0,this.FElementPosition=0,this.FParentElement=null,this.FTextDirection=0,s=!1,null!=(i=pas["WEBLib.Forms"].GetParentForm(this))&&(s=4 in i.FComponentState),e=this.GetNewName(),s?this.CreateWithID(""):this.CreateWithID(e),null==t||4 in t.FComponentState||this.SetName(e),this},this.Destroy=function(){this.UnbindEvents(),this.DestroyControls(),null!=this.GetContainer()&&null!=this.FParent&&null!=this.FParent.GetChildContainer()&&(this.FParent.GetChildContainer()===this.GetContainer().parentNode&&this.FParent.GetChildContainer().removeChild(this.GetContainer()),this.FContainer=null,this.SetParent(null),this.FControlCreated=!1),rtl.free(this,"FRequiredScripts"),rtl.free(this,"FMargins"),rtl.free(this,"FFont"),pas.System.Assigned(this.FToolTip)&&(FToolTip.dispose(),this.FToolTip=null),pas.Classes.TComponent.Destroy.call(this)},this.Assign=function(t){},this.DragDrop=function(t,e,i){null!=this.FOnDragDrop&&this.FOnDragDrop(this,t,e,i)},this.Resize=function(){null!=this.FOnResize&&this.FOnResize(this)},this.Capture=function(){this.FCaptureDown=!0,window.setTimeout(rtl.createSafeCallback(this,"StartCapture"),100)},this.ReleaseCapture=function(){var t=null;this.FCaptureDown=!1,this.FCaptured&&null!=this.FLayer&&((t=this.FLayer).removeEventListener("mouseenter",this.FLayerMouseEnterPtr),t.removeEventListener("mouseleave",this.FLayerMouseLeavePtr),t.removeEventListener("mousedown",this.FMouseDownPtr),t.removeEventListener("mouseup",this.FMouseUpPtr),t.removeEventListener("mousemove",this.FMouseMovePtr),t.removeEventListener("touchstart",this.FTouchStartPtr),t.removeEventListener("touchmove",this.FTouchMovePtr),t.removeEventListener("touchend",this.FTouchEndPtr),t.removeEventListener("touchcancel",this.FTouchEndPtr),document.body.removeChild(t),this.FCaptured=!1,this.FLayer=null,this.UpdateElement())},this.BringToFront=function(){if(null!=this.GetElementHandle()&&null!=this.GetElementHandle().parentElement)try{this.GetElementHandle().parentElement.appendChild(this.GetElementHandle()),null!=this.FParent&&this.FParent.MoveLast(this)}catch(t){}},this.SendToBack=function(){null!=this.GetElementHandle()&&null!=this.GetElementHandle().parentElement&&(this.GetElementHandle().parentElement.insertBefore(this.GetElementHandle(),this.GetElementHandle().parentElement.firstElementChild),null!=this.FParent&&this.FParent.MoveFirst(this))},this.PreventDefault=function(){null!=this.GetElementEvent()&&this.GetElementEvent().preventDefault()},this.StopPropagation=function(){null==this.GetElementEvent()||this.FEnablePropagation||this.GetElementEvent().stopPropagation()},this.BeginDrag=function(){this.EnableDrag()},this.BeginUpdate=function(){this.FUpdateCount+=1},this.EndUpdate=function(){this.FUpdateCount>0&&(this.FUpdateCount-=1,0===this.FUpdateCount&&this.UpdateElement())},this.Invalidate=function(){},this.SetParentComponent=function(e){this.FParent!==e&&t.TControl.isPrototypeOf(e)&&this.SetParent(e)},this.SetBounds=function(t,e,i,s){this.SetBoundsInt(t,e,i,s),this.FWidth=i,this.FHeight=s,this.FUpdateTopLeft||(this.FOrigTop=e,this.FOrigLeft=t),this.ResetAnchoring(),0 in this.FComponentState||0===this.FAlign||null==this.FParent||this.DoRealign()},this.XYToClient=function(t,e,i,s){var n=null,o=null,r=null,a=0,l=0,h=!1,F=!1,p=pas.Types.TRect.$new(),c=null,u=0,T=0,C=0,S=0;if(h=!0,F=!1,C=0,S=0,0!==this.FElementPosition)return h=!1,a=t-(o=this.GetElementHandle().getBoundingClientRect()).left,l=e-o.top,i.set(a),void s.set(l);for(C=document.body.scrollLeft+document.documentElement.scrollLeft,S=document.body.scrollTop+document.documentElement.scrollTop,a=t-this.GetLeft(),l=e-this.GetTop(),i.set(a),s.set(l),n=this.FParent,pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(this)&&null==n&&null!=this.GetContainer()&&(o=this.GetContainer().getBoundingClientRect(),i.set(i.get()-o.left),s.set(s.get()-o.top));null!=n;)n.GetIsLinked()?(o=pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(n)?n.GetContainer().getBoundingClientRect():n.GetElementHandle().getBoundingClientRect(),i.set(i.get()-o.left),s.set(s.get()-o.top),C=0,S=0):pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(n)?(""!==rtl.as(n,pas["WEBLib.Forms"].TCustomForm).FFormContainer&&null!=(r=document.getElementById(rtl.as(n,pas["WEBLib.Forms"].TCustomForm).FFormContainer))&&(F=!0,o=r.getBoundingClientRect(),i.set(i.get()-o.left),s.set(s.get()-o.top)),null!=rtl.as(n,pas["WEBLib.Forms"].TCustomForm).GetContainer()&&""===rtl.as(n,pas["WEBLib.Forms"].TCustomForm).FFormContainer&&rtl.as(n,pas["WEBLib.Forms"].TCustomForm).FPopup&&(o=rtl.as(n,pas["WEBLib.Forms"].TCustomForm).GetContainer().getBoundingClientRect(),i.set(i.get()-o.left),s.set(s.get()-o.top),p.$assign(rtl.as(n,pas["WEBLib.Forms"].TCustomForm).GetClientRect()),s.set(s.get()+p.Top),C=0,S=0)):n.FElementPosition in rtl.createSet(1,2)?null!=n.GetElementHandle()&&(o=n.GetElementHandle().getBoundingClientRect(),i.set(a-o.left),s.set(l-o.top),C=0,S=0,h&&(c=window.getComputedStyle(document.documentElement),u=parseInt(c.marginLeft,10),T=parseInt(c.marginTop,10),i.set(i.get()+u),s.set(s.get()+T)),h=!1):0===n.FElementPosition&&h&&(i.set(i.get()-n.GetLeft()),s.set(s.get()-n.GetTop()),a=i.get(),l=s.get()),n=n.FParent;0!==this.FElementPosition||F||(i.set(i.get()+C),s.set(s.get()+S))},this.Captured=function(){return this.FCaptured&&null!=this.FLayer},this.MakeScreenshot=function(){return null,null},this.ClientToScreen=function(t){var e=pas.Types.TPoint.$new(),i=pas.Types.TPoint.$new();return i.$assign(this.GetClientOrigin()),e.x=t.x+i.x,e.y=t.y+i.y,e},this.ScreenToClient=function(t){var e=pas.Types.TPoint.$new(),i=pas.Types.TPoint.$new();return i.$assign(this.GetClientOrigin()),e.x=t.x-i.x,e.y=t.y-i.y,e},this.CanFocus=function(){return!0,!0},this.HasHorzScrollBar=function(){var t=!1;return t=!1,null!=this.GetElementHandle()&&(t=this.GetElementHandle().clientWidth<this.GetElementHandle().scrollWidth),t},this.HasVertScrollBar=function(){var t=!1;return t=!1,null!=this.GetElementHandle()&&(t=this.GetElementHandle().clientHeight<this.GetElementHandle().scrollHeight),t},rtl.addIntf(this,pas.System.IUnknown)})),this.TScrollBarKind={0:"sbHorizontal",sbHorizontal:0,1:"sbVertical",sbVertical:1},this.$rtti.$Enum("TScrollBarKind",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TScrollBarKind}),rtl.createClass(this,"TWinControl",this.TControl,(function(){rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Cursor",2,t.$rtti.TCursor,"FCursor","SetControlCursor",{Default:0}),e.addProperty("ElementClassName",2,t.$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("Tag",0,rtl.longint,"FTag$1","FTag$1",{Default:0}),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("OnMouseDown",0,t.$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,t.$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,t.$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseEnter",0,t.$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnMouseLeave",0,t.$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnKeyUp",0,t.$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnKeyDown",0,t.$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,t.$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnEnter",0,t.$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,t.$rtti.TNotifyEvent,"FOnExit","FOnExit")})),rtl.createClass(this,"TCustomControl",this.TWinControl,(function(){this.$init=function(){t.TWinControl.$init.call(this),this.FCaption="",this.FPixelRatio=0,this.FPainting=!1,this.FCanvas=null,this.FElementCanvas=null,this.FBorderStyle=0,this.FBorderColor=0,this.FCustomBorder=!1,this.FOnScreenShot=null},this.$final=function(){this.FCanvas=void 0,this.FElementCanvas=void 0,this.FOnScreenShot=void 0,t.TWinControl.$final.call(this)},this.GetCanvas=function(){return null==this.FCanvas&&(this.GetIsLinked()?(null==this.FElementCanvas&&(this.FElementCanvas=document.getElementById(this.GetID())),this.RecreateCanvas()):this.CreateControl()),this.FCanvas},this.RenderDesigning=function(t,e,i,s,n){var o,r=null,a=null,l=null;if(o=null!=(a=(r=e).firstChild)&&"DIV"===a.tagName&&"1"===a.getAttribute("data-design"),4 in i.FComponentState&&s&&""===this.FElementClassName){if(r.style.setProperty("border","1px solid gray"),""===n?r.style.setProperty("background-color","#F0F0F0"):r.style.setProperty("background-color","white"),o)return;r.innerHTML="",""!==n&&((l=document.createElement("DIV")).style.setProperty("background-color","white"),l.style.setProperty("background-repeat","no-repeat"),l.style.setProperty("background-position-y","center"),l.style.setProperty("background-image","url("+n+")"),l.style.setProperty("background-position-x","center"),l.style.setProperty("background-size","128px"),l.style.setProperty("top","50%"),l.style.setProperty("left","50%"),l.style.setProperty("height","70%"),r.appendChild(l)),(a=document.createElement("DIV")).setAttribute("data-design","1"),a.innerHTML=t,a.style.setProperty("position","relative"),a.style.setProperty("top","50%"),a.style.setProperty("left","50%"),a.style.setProperty("display","inline-block"),a.style.setProperty("transform","translateX(-50%)"),this.FCustomBorder=!0,r.appendChild(a)}else if(o){for(;null!=r.firstChild;)r.removeChild(r.firstChild);r.style.removeProperty("border"),r.style.removeProperty("background-color")}},this.GetPixelRatio=function(){var t=document.createElement("canvas").getContext("2d");return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)},this.RecreateCanvas=function(){var t=0,e=null,i=0,s=0;null!=this.FElementCanvas&&(this.FPainting||(null!=(e=this.GetIsLinked()?this.GetElementHandle():document.getElementById(this.GetID()+"_Canvas"))&&(this.FElementCanvas=e,rtl.free(this,"FCanvas"),this.FCanvas=null),t=this.GetPixelRatio(),i=this.GetHeight()-this.GetCanvasHeightOffset(),s=this.GetWidth()-this.GetCanvasWidthOffset(),1===this.FElementPosition?this.FElementCanvas.style.setProperty("position","relative"):this.FElementCanvas.style.setProperty("position","absolute"),this.FElementCanvas.style.setProperty("height",pas.SysUtils.IntToStr(i)+"px"),this.FElementCanvas.style.setProperty("width",pas.SysUtils.IntToStr(s)+"px"),this.FElementCanvas.height=Math.round(i*t),this.FElementCanvas.width=Math.round(s*t)),null==this.FCanvas&&(this.FCanvas=pas["WEBLib.Graphics"].TCanvas.$create("Create$1",[this.FElementCanvas])),this.FCanvas.FApplyPixelRatio=!0,this.FCanvas.SetTransform(1,0,0,1,0,0))},this.SetBorderStyle=function(t){this.FBorderStyle!==t&&(this.FBorderStyle=t,this.UpdateElement())},this.SetBorderColor=function(t){this.FBorderColor!==t&&(this.FBorderColor=t,this.UpdateElement())},this.SetName=function(e){var i={},s="";if(s="",null!=pas["WEBLib.Forms"].VSIDE&&4 in this.FComponentState||pas["WEBLib.Forms"].TFrame.isPrototypeOf(this)&&(s="F"+t.FindUniqueName(this.FName)+"_"),pas.Classes.TComponent.SetName.call(this,s+e),1 in this.FControlStyle&&4 in this.FComponentState&&!(0 in this.FComponentState)){if(null!=this.FOwner&&0 in this.FOwner.FComponentState)return;i=rtl.refSet(this.FControlStyle),this.SetCaption(e),this.FControlStyle=rtl.refSet(i)}},this.SetCaption=function(t){this.FCaption=t,this.FControlStyle=rtl.diffSet(this.FControlStyle,rtl.createSet(1))},this.CreateControl=function(){t.TControl.CreateControl.call(this),this.RecreateCanvas()},this.Loaded=function(){t.TControl.Loaded.call(this),this.Invalidate()},this.UpdateElementVisual=function(){t.TControl.UpdateElementVisual.call(this),null!=this.GetElementHandle()&&(this.GetIsLinked()||""!==this.FElementClassName||(1===this.FBorderStyle?this.FCustomBorder?(this.GetElementStyle().setProperty("border-style","solid"),this.GetElementStyle().setProperty("border-width","1px"),this.GetElementStyle().setProperty("border-color",pas["WEBLib.Graphics"].ColorToHTML(this.FBorderColor))):this.GetElementStyle().setProperty("border-style",""):this.GetElementStyle().setProperty("border-style","none")),""!==this.FElementClassName&&(this.GetElementStyle().removeProperty("border-style"),this.GetElementStyle().removeProperty("border-width"),this.GetElementStyle().removeProperty("border-color")))},this.CreateElement=function(){var t=null;return this.FElementCanvas=document.createElement("CANVAS"),0 in this.FControlStyle?((t=document.createElement("SPAN")).appendChild(this.FElementCanvas),""!==this.GetID()&&this.FElementCanvas.setAttribute("id",this.GetID()+"_Canvas"),this.FElementCanvas.setAttribute("zindex","-1")):t=this.FElementCanvas,t},this.GetCanvasHeightOffset=function(){return 0,0},this.GetCanvasWidthOffset=function(){return 0,0},this.BindElement=function(){"CANVAS"===this.GetContainer().tagName||this.FControlCreated||(this.FElementCanvas=document.createElement("CANVAS"),this.GetContainer().appendChild(this.FElementCanvas))},this.BindEvents=function(){t.TControl.BindEvents.call(this)},this.HandleScreenShot=function(t){null!=this.FOnScreenShot&&this.FOnScreenShot(this,t)},this.Paint=function(){},this.CreateInitialize=function(){t.TControl.CreateInitialize.call(this),this.FControlStyle=rtl.unionSet(this.FControlStyle,rtl.createSet(1)),this.FBorderStyle=1,this.FBorderColor=12632256,this.FPainting=!1,this.FWidth=100,this.FHeight=25,this.FWidthPercent=100,this.FHeightPercent=100,this.FCustomBorder=!1},this.Destroy=function(){null!=this.FCanvas&&rtl.free(this,"FCanvas"),t.TControl.Destroy.call(this)},this.MakeScreenshot=function(){var t=null;return(t=pas["WEBLib.Graphics"].TBitmap.$create("Create$3")).FOnChange=rtl.createCallback(this,"HandleScreenShot"),t.LoadFromCanvas(this.GetCanvas()),t},this.Resize=function(){t.TControl.Resize.call(this),this.Invalidate()},this.Invalidate=function(){var e=null;t.TControl.Invalidate.call(this),null===this.FParent||3 in this.FComponentState||this.FVisible&&(this.FUpdateCount>0||null!=(e=pas["WEBLib.Forms"].GetParentForm(this))&&e.IsUpdating()||(this.GetPixelRatio()!==this.FPixelRatio&&this.RecreateCanvas(),this.FPixelRatio=this.GetPixelRatio(),this.FPainting=!0,null!=this.FCanvas&&this.FCanvas.Clear(),this.Paint(),this.FPainting=!1))},this.SetFocus=function(){t.TControl.SetFocus.call(this)},this.Focused=function(){return t.TControl.Focused.call(this)},this.EndUpdate=function(){t.TControl.EndUpdate.call(this),0===this.FUpdateCount&&this.Invalidate()},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TCustomHTMLDiv",this.TCustomControl,(function(){this.CreateElement=function(){return document.createElement("DIV")},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TControlManager",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FInstanceCount=0},this.Create$1=function(t){return pas.Classes.TComponent.Create$1.apply(this,arguments),this.FInstanceCount=0,this},this.GetInstanceNumber=function(){return this.FInstanceCount+=1,this.FInstanceCount},rtl.addIntf(this,pas.System.IUnknown)})),this.FindGlobalComponent=function(t){return null,null},this.GetMousePos=function(){var t=pas.Types.TPoint.$new();return t.$assign(pas.Types.Point(e.FMouseX,e.FMouseY)),t},this.FindUniqueName=function(t){return t+pas.SysUtils.IntToStr(e.ControlManager.GetInstanceNumber())},this.GetScrollBarHeight=function(){var t=0;if(0===(t=e.ScrollBH)){var i=document.createElement("div");i.style.visibility="hidden",i.style.height="100px",i.style.msOverflowStyle="scrollbar",document.body.appendChild(i);var s=i.offsetHeight;i.style.overflow="scroll";var n=document.createElement("div");n.style.height="100%",i.appendChild(n);var o=n.offsetHeight;i.parentNode.removeChild(i),t=s-o,t=0,e.ScrollBH=t}return t},this.GetScrollBarWidth=function(){var t=0;if(0===(t=e.ScrollBW)){var i=document.createElement("div");i.style.visibility="hidden",i.style.width="100px",i.style.msOverflowStyle="scrollbar",document.body.appendChild(i);var s=i.offsetWidth;i.style.overflow="scroll";var n=document.createElement("div");n.style.width="100%",i.appendChild(n);var o=n.offsetWidth;i.parentNode.removeChild(i),t=s-o,e.ScrollBW=t}return t},this.SetHTMLElementFont=function(t,e,i){var s="";i?(t.style.removeProperty("font-family"),t.style.removeProperty("font-style"),t.style.removeProperty("font-weight"),t.style.removeProperty("font-size"),t.style.removeProperty("text-decoration")):(t.style.setProperty("font-family",e.FName),t.style.setProperty("font-style","normal"),0 in e.FStyle?t.style.setProperty("font-weight","bold"):t.style.setProperty("font-weight",""),1 in e.FStyle&&t.style.setProperty("font-style","italic"),s="",3 in e.FStyle&&(s="underline"),2 in e.FStyle&&(""!==s&&(s+=" "),s+="line-through"),""!==s?t.style.setProperty("text-decoration",s):t.style.removeProperty("text-decoration"),t.style.setProperty("font-size",pas.SysUtils.IntToStr(e.FSize)+"pt"))},this.SetHTMLElementColor=function(t,i,s){s||-1===i||16711422===i?t.style.removeProperty(e.cStyleBkgColor):t.style.setProperty(e.cStyleBkgColor,pas["WEBLib.Graphics"].ColorToHTML(i))},this.GetHTMLCursorName=function(t){var e="";e="default";return 0===t?e="default":2===t?e="auto":1===t?e="none":3===t?e="crosshair":4===t?e="text":6===t?e="nesw-resize":7===t?e="ns-resize":8===t?e="nwse-resize":9===t?e="ew-resize":10===t?e="n-resize":11===t?e="wait":12===t?e="copy":13===t?e="no-drop":14===t?e="col-resize":15===t?e="row-resize":16===t?e="copy":17===t?e="progress":18===t?e="not-allowed":19===t?e="progress":20===t?e="help":21===t?e="pointer":22!==t&&5!==t||(e="move"),e},this.GetHTMLElementAbsoluteRect=function(t){var e=pas.Types.TRect.$new(),i="";function s(t){var e=0,i=0;return t=pas.SysUtils.StringReplace(t,"px","",rtl.createSet(0)),pas.System.val$6(t,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),e}return i=t.style.getPropertyValue("left"),e.Left=s(i),i=t.style.getPropertyValue("top"),e.Top=s(i),i=t.style.getPropertyValue("width"),e.Right=e.Left+s(i),i=t.style.getPropertyValue("height"),e.Bottom=e.Top+s(i),e},this.IsAndroid=function(){var t;return t=navigator.userAgent,pas.System.Pos("Android",t)>0},this.GetMaterialClass=function(t){var e="";e="material-icons";return 1===t?e="material-icons-outlined":2===t?e="material-icons-two-tone":3===t?e="material-icons-round":4===t&&(e="material-icons-sharp"),e},t.$implcode=function(){e.ControlManager=null,e.FMouseX=0,e.FMouseY=0,e.FCursorX=0,e.FCursorY=0,e.ScrollBW=0,e.ScrollBH=0,e.DragObject=null,e.cStyleBkgColor="background-color"},t.$init=function(){e.ScrollBW=0,e.ScrollBH=0,e.DragObject=null,e.ControlManager=t.TControlManager.$create("Create$1",[null])}}),["WEBLib.Dialogs","WEBLib.Forms","Math","TypInfo","WEBLib.WebTools","WEBLib.Utils"]),rtl.module("WEBLib.WebTools",["System","Classes","Web","JS","WEBLib.Controls","WEBLib.Graphics"],(function(){"use strict";var t=this;this.cBodyTag="body",this.cHTMLExt=".html",this.DoubleToHTML=function(t){return pas.SysUtils.Format$1("%g",pas.System.VarRecs(3,t),pas.SysUtils.TFormatSettings.Invariant())},this.GetLocaleShortDateFormat=function(t){return pas.SysUtils.TFormatSettings.Create$1(t).ShortDateFormat},this.GetLocaleLongDayName=function(t,e){var i=new Date(2017,0,1);i.setDate(i.getDate()+t-1);var s="";return s=""==e?navigator.language:e,i.toLocaleDateString(s,{weekday:"long"})},this.GetLocaleShortDayName=function(t,e){var i=new Date(2017,0,1);i.setDate(i.getDate()+t-1);var s="";return s=""==e?navigator.language:e,i.toLocaleDateString(s,{weekday:"short"})},this.GetLocaleLongMonthName=function(t,e){var i=new Date(2017,t-1,1),s="";return s=""==e?navigator.language:e,i.toLocaleDateString(s,{month:"long"})},this.GetLocaleShortMonthName=function(t,e){var i=new Date(2017,t-1,1),s="";return s=""==e?navigator.language:e,i.toLocaleDateString(s,{month:"short"})},this.GetLocaleDecimalSeparator=function(t){var e=1.1,i="";return i=""==t?navigator.language:t,e=e.toLocaleString(i).substring(1,2)},this.GetBrowserLocale=function(){return navigator.language},this.ProcessAccelerator=function(t,e){var i,s=0,n="";for(i=t.length,e.set(""),n="",s=1;s<=i;)"&"===t.charAt(s-1)?(s+1<=i&&"&"!==t.charAt(s+1-1)?(n=n+"<u>"+t.charAt(s+1-1)+"</u>",e.set(t.charAt(s+1-1))):s+1<=i&&"&"===t.charAt(s+1-1)&&(n+="&"),s+=2):(n+=t.charAt(s-1),s+=1);return n},this.HexImageDecode=function(t){var e,i=0,s=0,n=null,o=0,r=0,a=0;e=rtl.trunc(t.length/2),s=0,(o=t.charCodeAt(0)-48)>=10&&(o-=7),(r=t.charCodeAt(1)-48)>=10&&(r-=7),a=1+(r+(o<<4)),(i=pas.System.Pos("4A5045474",t))>1&&i<10&&(a+=4),(i=pas.System.Pos("4269746D6",t))>1&&i<10&&(a+=4),n=new Uint8Array(e-a);for(var l=a+1,h=e;l<=h;l++)i=l,(o=t.charCodeAt(2*i-1-1)-48)>=10&&(o-=7),(r=t.charCodeAt(2*i-1)-48)>=10&&(r-=7),r+=o<<4,n[s]=r,s+=1;return n},this.HexImageEncodeFromBase64=function(e){var i;return e=e.replace(/^data:image\/\S+;base64,/,""),i=Uint8Array.from(atob(e),(function(t){return t.charCodeAt(0)})),t.HexImageEncode(i)},this.HexImageEncode=function(t){var e="",i=0,s=0,n=0,o="",r="";if(e="",0===(s=t.length))return e;s=((255&s)<<24)+((65280&s)<<8)+((16711680&s)>>>8)+((4278190080&s)>>>24),r="",137===t[0]&&80===t[1]&&(n=(o="TPngImage").length),255===t[0]&&216===t[1]&&(n=(o="TJPEGImage").length,r=pas.SysUtils.IntToHex(s,8)),66===t[0]&&77===t[1]&&(n=(o="TBitmap").length,r=pas.SysUtils.IntToHex(s,8)),71===t[0]&&73===t[1]&&(n=(o="TGIFImage").length),e=pas.SysUtils.IntToHex(n,2);for(var a=1,l=o.length;a<=l;a++)i=a,n=o.charCodeAt(i-1),e+=pas.SysUtils.IntToHex(n,2);e+=r;for(var h=0,F=t.length-1;h<=F;h++)n=t[i=h],e+=pas.SysUtils.IntToHex(n,2);return e},this.HexImageDecodeAsBase64=function(e){var i;return i=t.HexImageDecode(e),e=btoa(new Uint8Array(i).reduce((function(t,e){return t+String.fromCharCode(e)}),""))},this.HTMLToString=function(t){return t=pas.SysUtils.StringReplace(t,"<","&lt;",rtl.createSet(0)),pas.SysUtils.StringReplace(t,">","&gt;",rtl.createSet(0))},this.ElementVisible=function(e){var i=!1,s=null;for(i=!1,s=e;null!=s;)pas.SysUtils.LowerCase(s.tagName)===t.cBodyTag&&(i=!0),s=s.parentElement;if(!i)return i;for(;null!=e;){if("none"===e.style.getPropertyValue("display"))return i=!1;if(s=e.parentElement,!rtl.isExt(s,HTMLElement))return i;e=s}return i}}),["SysUtils","WEBLib.Utils"]),rtl.module("contnrs",["System","SysUtils","Classes"],(function(){"use strict";var t=this,e=t.$impl;rtl.createClass(this,"TFPObjectList",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FFreeObjects=!1,this.FList=null},this.$final=function(){this.FList=void 0,pas.System.TObject.$final.call(this)},this.GetCount=function(){return this.FList.FCount},this.GetItem=function(t){return rtl.getObject(this.FList.Get(t))},this.SetItem=function(t,e){var i=null;this.FFreeObjects?(i=rtl.getObject(this.FList.Get(t)),this.FList.Put(t,e),i=rtl.freeLoc(i)):this.FList.Put(t,e)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FList=pas.Classes.TFPList.$create("Create"),this.FFreeObjects=!0,this},this.Create$2=function(t){return this.Create$1(),this.FFreeObjects=t,this},this.Destroy=function(){null!==this.FList&&(this.Clear(),this.FList.$destroy("Destroy")),pas.System.TObject.Destroy.call(this)},this.Clear=function(){var t=0,e=null;if(this.FFreeObjects)for(var i=this.FList.FCount-1;i>=0;i--)t=i,e=rtl.getObject(this.FList.Get(t)),this.FList.Put(t,null),e=rtl.freeLoc(e);this.FList.Clear()},this.Add=function(t){return this.FList.Add(t)}})),rtl.createClass(this,"TObjectList",pas.Classes.TList,(function(){this.$init=function(){pas.Classes.TList.$init.call(this),this.FFreeObjects=!1},this.Notify=function(t,e){var i=null;this.FFreeObjects&&2===e&&(i=rtl.getObject(t),i=rtl.freeLoc(i)),pas.Classes.TList.Notify.call(this,t,e)},this.GetItem=function(t){return rtl.getObject(pas.Classes.TList.Get.call(this,t))},this.Create$2=function(){return pas.Classes.TList.Create$1.call(this),this.FFreeObjects=!0,this},this.Add$1=function(t){return pas.Classes.TList.Add.call(this,t)},this.Remove$1=function(t){return pas.Classes.TList.Remove.call(this,t)},this.IndexOf$1=function(t){return pas.Classes.TList.IndexOf.call(this,t)},this.Insert$1=function(t,e){pas.Classes.TList.Insert.call(this,t,e)}})),rtl.createClass(this,"TClassList",pas.Classes.TList,(function(){this.GetItems=function(t){return rtl.getObject(this.Get(t))},this.Add$1=function(t){return pas.Classes.TList.Add.call(this,t)},this.Insert$1=function(t,e){pas.Classes.TList.Insert.call(this,t,e)}})),rtl.createClass(this,"THTCustomNode",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FKey=""},this.CreateWith=function(t){return pas.System.TObject.Create.call(this),this.FKey=t,this}})),rtl.createClass(this,"TFPCustomHashTable",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FHashTable=null,this.FHashFunction=null,this.FCount=0,this.FHashTableSize=0},this.$final=function(){this.FHashTable=void 0,this.FHashFunction=void 0,pas.System.TObject.$final.call(this)},this.SetHashTableSize=function(t){var i=0,s=0;if(t!==this.FHashTableSize){for(i=0;e.PRIMELIST[i]<t&&i<27;)i+=1;s=e.PRIMELIST[i],0===this.FCount?(this.FHashTableSize=s,this.InitializeHashTable()):this.ChangeTableSize(s)}},this.InitializeHashTable=function(){if(this.FHashTableSize>0)for(var t=0,e=this.FHashTableSize-1;t<=e;t++)t,this.FHashTable.Add(null);this.FCount=0},this.Chain=function(t){return this.FHashTable.GetItem(t)},this.FindChainForAdd=function(e){var i,s=null,n=0;if(i=this.FHashFunction(e,this.FHashTableSize),null!=(s=this.Chain(i))){if(s.GetCount()>0)for(var o=0,r=s.GetCount()-1;o<=r;o++)if(n=o,s.GetItem(n).FKey===e)throw t.EDuplicate.$create("CreateFmt",[rtl.getResStr(t,"DuplicateMsg"),pas.System.VarRecs(18,e)])}else this.FHashTable.SetItem(i,t.TFPObjectList.$create("Create$2",[!0])),s=this.Chain(i);return this.FCount+=1,s},this.Create$1=function(){return this.CreateWith(196613,t.RSHash),this},this.CreateWith=function(e,i){return pas.System.TObject.Create.call(this),this.FHashTable=t.TFPObjectList.$create("Create$2",[!0]),this.SetHashTableSize(e),this.FHashFunction=i,this},this.Destroy=function(){rtl.free(this,"FHashTable"),pas.System.TObject.Destroy.call(this)},this.ChangeTableSize=function(e){var i,s=null,n=null,o=0,r=0,a=null;if(s=this.FHashTable,i=this.FHashTableSize,this.FHashTableSize=e,this.FHashTable=t.TFPObjectList.$create("Create$2",[!0]),this.InitializeHashTable(),i>0)for(var l=0,h=i-1;l<=h;l++)if(o=l,null!=(n=s.GetItem(o)))for(var F=0,p=n.GetCount()-1;F<=p;F++)r=F,a=n.GetItem(r),this.AddNode(a);s=rtl.freeLoc(s)},this.Clear=function(){var t=0;if(this.FHashTableSize>0)for(var e=0,i=this.FHashTableSize-1;e<=i;e++)t=e,null!=this.Chain(t)&&this.Chain(t).Clear();this.FCount=0},this.Find=function(t){var e,i=null,s=0;if(e=this.FHashFunction(t,this.FHashTableSize),null!=(i=this.Chain(e))&&i.GetCount()>0)for(var n=0,o=i.GetCount()-1;n<=o;n++)if(s=n,i.GetItem(s).FKey===t)return i.GetItem(s);return null,null}})),rtl.createClass(this,"THTObjectNode",this.THTCustomNode,(function(){this.$init=function(){t.THTCustomNode.$init.call(this),this.FData=null},this.$final=function(){this.FData=void 0,t.THTCustomNode.$final.call(this)}})),rtl.createClass(this,"THTOwnedObjectNode",this.THTObjectNode,(function(){this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FData},set:function(t){this.p.FData=t}}),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TFPObjectHashTable",this.TFPCustomHashTable,(function(){this.$init=function(){t.TFPCustomHashTable.$init.call(this),this.FOwnsObjects=!1},this.CreateNewNode=function(e){return this.FOwnsObjects?t.THTOwnedObjectNode.$create("CreateWith",[e]):t.THTObjectNode.$create("CreateWith",[e])},this.AddNode=function(t){this.Add(t.FKey,t.FData)},this.GetData=function(t){var e;return null!=(e=this.Find(t))?e.FData:null},this.Create$2=function(e){return t.TFPCustomHashTable.Create$1.call(this),this.FOwnsObjects=e,this},this.Add=function(t,e){var i=null,s=null;i=this.FindChainForAdd(t),(s=this.CreateNewNode(t)).FData=e,i.Add(s)}})),rtl.createClass(this,"EDuplicate",pas.SysUtils.Exception,(function(){}));this.RSHash=function(t,e){var i=0,s=0,n=0;if(s=63689,i=0,t.length>0)for(var o=1,r=t.length;o<=r;o++)n=o,i=i*s+t.charCodeAt(n-1),s*=378551;return i=rtl.lw(2147483647&i)%e},t.$implcode=function(){e.NPRIMES=28,e.PRIMELIST=[53,97,193,389,769,1543,3079,6151,12289,24593,49157,98317,196613,393241,786433,1572869,3145739,6291469,12582917,25165843,50331653,100663319,201326611,402653189,805306457,1610612741,3221225473,4294967291],t.$resourcestrings={DuplicateMsg:{org:"An item with key %0:s already exists"}}}}),["JS"]),rtl.module("WEBLib.Graphics",["System","Classes","Types","Web","JS"],(function(){"use strict";var t=this,e=t.$impl;this.WEBDEFAULTFONT="Arial",this.SysDefault=536870912,this.clNone=-1,this.clBlack=0,this.clSilver=12632256,this.clWhite=16777215,this.clDefault=536870912,this.clBtnFace=15790320,this.clWindow=16711422,this.clHighlight=14120960,this.clHighlightText=197379,this.$rtti.$inherited("TColor",rtl.nativeint,{}),this.TVerticalAlignment={0:"taAlignTop",taAlignTop:0,1:"taAlignBottom",taAlignBottom:1,2:"taVerticalCenter",taVerticalCenter:2},this.TPenStyle={0:"psSolid",psSolid:0,1:"psDash",psDash:1,2:"psDot",psDot:2,3:"psDashDot",psDashDot:3,4:"psDashDotDot",psDashDotDot:4,5:"psClear",psClear:5,6:"psInsideFrame",psInsideFrame:6,7:"psUserStyle",psUserStyle:7,8:"psAlternate",psAlternate:8},this.$rtti.$Enum("TPenStyle",{minvalue:0,maxvalue:8,ordtype:1,enumtype:this.TPenStyle}),this.TPenMode={0:"pmBlack",pmBlack:0,1:"pmWhite",pmWhite:1,2:"pmNop",pmNop:2,3:"pmNot",pmNot:3,4:"pmCopy",pmCopy:4,5:"pmNotCopy",pmNotCopy:5,6:"pmMergePenNot",pmMergePenNot:6,7:"pmMaskPenNot",pmMaskPenNot:7,8:"pmMergeNotPen",pmMergeNotPen:8,9:"pmMaskNotPen",pmMaskNotPen:9,10:"pmMerge",pmMerge:10,11:"pmNotMerge",pmNotMerge:11,12:"pmMask",pmMask:12,13:"pmNotMask",pmNotMask:13,14:"pmXor",pmXor:14,15:"pmNotXor",pmNotXor:15},this.$rtti.$Enum("TPenMode",{minvalue:0,maxvalue:15,ordtype:1,enumtype:this.TPenMode}),this.TBrushStyle={0:"bsSolid",bsSolid:0,1:"bsClear",bsClear:1,2:"bsHorizontal",bsHorizontal:2,3:"bsVertical",bsVertical:3,4:"bsFDiagonal",bsFDiagonal:4,5:"bsBDiagonal",bsBDiagonal:5,6:"bsCross",bsCross:6,7:"bsDiagCross",bsDiagCross:7},this.$rtti.$Enum("TBrushStyle",{minvalue:0,maxvalue:7,ordtype:1,enumtype:this.TBrushStyle}),this.TBrushGradient={0:"bgNone",bgNone:0,1:"bgLinearVert",bgLinearVert:1,2:"bgLinearHorz",bgLinearHorz:2,3:"bgRadial",bgRadial:3},this.$rtti.$Enum("TBrushGradient",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TBrushGradient}),this.TFontStyle={0:"fsBold",fsBold:0,1:"fsItalic",fsItalic:1,2:"fsStrikeOut",fsStrikeOut:2,3:"fsUnderline",fsUnderline:3},this.$rtti.$Enum("TFontStyle",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TFontStyle}),this.$rtti.$Set("TFontStyles",{comptype:this.$rtti.TFontStyle}),this.$rtti.$Int("TFontCharset",{minvalue:0,maxvalue:255,ordtype:3}),this.$rtti.$inherited("TBinaryString",rtl.string,{}),rtl.recNewT(this,"TCanvasPointF",(function(){this.X=0,this.Y=0,this.$eq=function(t){return this.X===t.X&&this.Y===t.Y},this.$assign=function(t){return this.X=t.X,this.Y=t.Y,this}})),rtl.recNewT(this,"TCanvasRectF",(function(){this.Left=0,this.Top=0,this.Right=0,this.Bottom=0,this.$eq=function(t){return this.Left===t.Left&&this.Top===t.Top&&this.Right===t.Right&&this.Bottom===t.Bottom},this.$assign=function(t){return this.Left=t.Left,this.Top=t.Top,this.Right=t.Right,this.Bottom=t.Bottom,this}})),rtl.createClass(this,"TPen",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FWidth=0,this.FColor=0,this.FStyle=0,this.FMode=0},this.SetColor=function(t){this.FColor=t},this.Create$1=function(){return this.FColor=0,this.FWidth=1,this.FStyle=0,this.FMode=4,this},this.Assign=function(e){t.TPen.isPrototypeOf(e)?(this.FColor=rtl.as(e,t.TPen).FColor,this.FStyle=rtl.as(e,t.TPen).FStyle,this.FWidth=rtl.as(e,t.TPen).FWidth):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("Color",2,t.$rtti.TColor,"FColor","SetColor"),e.addProperty("Mode",0,t.$rtti.TPenMode,"FMode","FMode",{Default:t.TPenMode.pmCopy}),e.addProperty("Width",0,rtl.longint,"FWidth","FWidth",{Default:1}),e.addProperty("Style",0,t.$rtti.TPenStyle,"FStyle","FStyle",{Default:t.TPenStyle.psSolid})})),rtl.createClass(this,"TGradientColor",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FColor=0,this.FStop=0},this.Assign=function(e){t.TGradientColor.isPrototypeOf(e)&&(this.FColor=rtl.as(e,t.TGradientColor).FColor,this.FStop=rtl.as(e,t.TGradientColor).FStop)},this.Create$1=function(){return this.FColor=-1,this.FStop=0,this};var e=this.$rtti;e.addProperty("Stop",0,rtl.double,"FStop","FStop"),e.addProperty("Color",0,t.$rtti.TColor,"FColor","FColor",{Default:-1})})),rtl.createClass(this,"TBrush",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FColor=0,this.FStyle=0,this.FGradientColors=null,this.FGradient=0},this.$final=function(){this.FGradientColors=void 0,pas.Classes.TPersistent.$final.call(this)},this.Create$1=function(){return this.FColor=16777215,this.FStyle=0,this.FGradient=0,this.FGradientColors=pas.Classes.TList.$create("Create$1"),this},this.Destroy=function(){rtl.free(this,"FGradientColors"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TBrush.isPrototypeOf(e)?(this.FColor=rtl.as(e,t.TBrush).FColor,this.FStyle=rtl.as(e,t.TBrush).FStyle):pas.Classes.TPersistent.Assign.apply(this,arguments)},this.AddGradientColor=function(e,i){var s=null;(s=t.TGradientColor.$create("Create$1")).FColor=e,s.FStop=i,this.FGradientColors.Add(s)},this.GetGradientColor=function(t,e,i){if(!(t<this.FGradientColors.GetCount()))throw pas.SysUtils.Exception.$create("Create$1",["Invalid gradient color index"]);e.set(rtl.getObject(this.FGradientColors.Get(t)).FColor),i.set(rtl.getObject(this.FGradientColors.Get(t)).FStop)},this.GradientCount=function(){return this.FGradientColors.GetCount()},this.ClearGradient=function(){for(var t=0,e=null,i=this.FGradientColors.GetCount()-1;i>=0;i--)t=i,e=rtl.getObject(this.FGradientColors.Get(t)),e=rtl.freeLoc(e),this.FGradientColors.Delete(t)};var e=this.$rtti;e.addProperty("Gradient",0,t.$rtti.TBrushGradient,"FGradient","FGradient"),e.addProperty("Color",0,t.$rtti.TColor,"FColor","FColor"),e.addProperty("Style",0,t.$rtti.TBrushStyle,"FStyle","FStyle")})),rtl.createClass(this,"TFont",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FName="",this.FSize=0,this.FColor=0,this.FStyle={},this.FOnChange=null,this.FHeight=0,this.FCharset=0},this.$final=function(){this.FStyle=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetHeight=function(t){var e;e=72*-t/96,this.FSize=Math.round(e),this.FHeight!==t&&(this.FHeight=t,this.DoChange())},this.SetName=function(t){this.FName!==t&&(this.FName=t,this.DoChange())},this.SetSize=function(t){this.FSize!==t&&(this.FSize=t,this.DoChange())},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t,this.DoChange())},this.SetStyle=function(t){rtl.neSet(this.FStyle,t)&&(this.FStyle=rtl.refSet(t),this.DoChange())},this.DoChange=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Assign=function(e){t.TFont.isPrototypeOf(e)?(this.FName=rtl.as(e,t.TFont).FName,this.FColor=rtl.as(e,t.TFont).FColor,this.FSize=rtl.as(e,t.TFont).FSize,this.FStyle=rtl.refSet(rtl.as(e,t.TFont).FStyle),this.DoChange()):pas.Classes.TPersistent.Assign.apply(this,arguments)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FName=t.WEBDEFAULTFONT,this.FSize=8,this.FHeight=-11,this.FStyle={},this.FColor=0,this},this.ToString=function(){var e="";return e="",0 in this.FStyle&&1 in this.FStyle?e+="bold italic":0 in this.FStyle?e+="bold":1 in this.FStyle&&(e+="italic"),e+" "+t.FontSizeToHTML(t.FontSizeToPx(this.FSize))+" "+this.FName};var e=this.$rtti;e.addProperty("Charset",0,t.$rtti.TFontCharset,"FCharset","FCharset"),e.addProperty("Name",2,rtl.string,"FName","SetName"),e.addProperty("Height",2,rtl.longint,"FHeight","SetHeight"),e.addProperty("Style",2,t.$rtti.TFontStyles,"FStyle","SetStyle"),e.addProperty("Color",2,t.$rtti.TColor,"FColor","SetColor"),e.addProperty("Size",2,rtl.longint,"FSize","SetSize")})),rtl.createClass(this,"TGraphic",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FAddToQueue=!1,this.FCanvasElement=null,this.FEmpty=!1,this.FData="",this.FDataBin="",this.FCanvas=null,this.FOnChange=null,this.FImage=null,this.FURL="",this.FLoaded=null,this.FUsedCanvas=!1},this.$final=function(){this.FCanvasElement=void 0,this.FCanvas=void 0,this.FOnChange=void 0,this.FImage=void 0,this.FLoaded=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetHeight=function(t){this.FImage.height=t,this.RecreateCanvas(),this.DoChange()},this.SetWidth=function(t){this.FImage.width=t,this.RecreateCanvas(),this.DoChange()},this.GetCanvas=function(){var t;return null==this.FCanvas&&this.RecreateCanvas(),t=this.FCanvas,this.FUsedCanvas=!0,t},this.GetData=function(){return this.FDataBin},this.SetData=function(t){var e="";this.FDataBin!==t&&(this.FDataBin=t,e=pas["WEBLib.WebTools"].HexImageDecodeAsBase64(this.FDataBin),pas.System.Pos("PHN2ZyB",e)>0?this.LoadFromResource("data:image/svg+xml;base64,"+e):this.LoadFromResource("data:image/png;base64,"+e))},this.DoChange=function(){var t=0;this.FEmpty=0===this.GetWidth()&&0===this.GetHeight(),this.FEmpty||""===this.FData||e.FCache.Exists(this.FData)||(e.FCache.Add$1(e.TGraphicCache.$create("Create$1",[this.FImage,this.FData])),(t=e.FQueue.IndexOf(this.FData))>=0&&t<=e.FQueue.GetCount()-1&&e.FQueue.Delete(t),e.FCacheCount-=1,0===e.FCacheCount&&null!=pas["WEBLib.Forms"].Application.FOnImageCacheReady&&pas["WEBLib.Forms"].Application.FOnImageCacheReady(pas["WEBLib.Forms"].Application)),null!=this.FOnChange&&this.FOnChange(this),null!=this.FLoaded&&(this.FLoaded(),this.FLoaded=null)},this.SetURL=function(t){this.LoadFromURL(t,null)},this.GetWidth=function(){var t=0;return t=0,null!=this.FImage&&(t=this.FImage.width),t},this.GetHeight=function(){var t=0;return t=0,null!=this.FImage&&(t=this.FImage.height),t},this.RecreateCanvas=function(){null==this.FCanvasElement&&(this.FCanvasElement=document.createElement("CANVAS")),null!=this.FCanvasElement&&(this.FCanvasElement.height=this.GetHeight(),this.FCanvasElement.width=this.GetWidth(),null==this.FCanvas&&(this.FCanvas=t.TCanvas.$create("Create$1",[this.FCanvasElement]),this.FCanvas.FOnBeginScene=rtl.createCallback(this,"DoBeginScene"),this.FCanvas.FOnEndScene=rtl.createCallback(this,"DoEndScene")))},this.DoBeginScene=function(t){this.FCanvas.Clear()},this.DoEndScene=function(t){this.FAddToQueue=!1,this.CaptureCanvas(),this.FAddToQueue=!0},this.AssignEvents=function(){var t=this;this.FImage.onload=function(){t.DoChange()}},this.CreateImage=function(){this.FImage=new Image},this.LoadFromCache=function(t,i){var s="",n=null,o="",r=!1;this.FData=t,pas.System.Pos("DATA:",pas.SysUtils.UpperCase(t))>0&&(this.FDataBin=pas["WEBLib.WebTools"].HexImageEncodeFromBase64(t)),""!==(s=t)&&(this.FLoaded=i,this.FUsedCanvas=!1,e.FCache.Find(s,{get:function(){return n},set:function(t){n=t}})?(this.FImage=n,this.DoChange()):(!1,o="",(r=""!=(o=this.FImage.src)&&s!==o)&&(this.CreateImage(),this.AssignEvents()),!r&&-1===e.FQueue.IndexOf(s)||r?(this.FImage.src=s,s=this.FImage.src,this.FData=s,pas.System.Pos("DATA:",pas.SysUtils.UpperCase(s))>0&&(this.FDataBin=pas["WEBLib.WebTools"].HexImageEncodeFromBase64(s)),e.FCacheCount+=1,this.FAddToQueue&&e.FQueue.Add(s)):r||-1===e.FQueue.IndexOf(s)||(this.FImage.src=s)),this.FImage&&(this.FEmpty=""==this.FImage.src))},this.CreateFromResource=function(t){return this.CreateFromResource$1(t,0)},this.CreateFromResource$1=function(e,i){var s=null;return(s=t.TGraphic.$create("Create$3")).LoadFromResource(e),s},this.CreateFromURL=function(t){return this.CreateFromURL$1(t,0)},this.CreateFromURL$1=function(e,i){var s=null;return(s=t.TGraphic.$create("Create$3")).LoadFromURL(e,null),s},this.Image=function(){return this.FImage},this.Empty=function(){return this.FEmpty},this.GetBase64Image=function(){var t="";return t="",null!=this.FCanvas&&(t=this.FCanvas.GetBase64Image()),t},this.Create$3=function(){return this.FAddToQueue=!0,this.FEmpty=!0,this.FData="",this.FDataBin="",this.FUsedCanvas=!1,this.CreateImage(),this.AssignEvents(),this},this.CaptureCanvas=function(){null!=this.FCanvas&&null!=this.FCanvas.FElementCanvas&&this.LoadFromResource(this.FCanvas.FElementCanvas.toDataURL())},this.LoadFromCanvas=function(t){null!=t&&null!=t.FElementCanvas&&this.LoadFromResource(t.FElementCanvas.toDataURL())},this.SetSize=function(t,e){this.SetWidth(t),this.SetHeight(e)},this.Assign=function(e){var i="";null!=e&&t.TGraphic.isPrototypeOf(e)&&null!=rtl.as(e,t.TGraphic).FCanvas?this.LoadFromCanvas(rtl.as(e,t.TGraphic).FCanvas):null!=e&&t.TGraphic.isPrototypeOf(e)&&null!=rtl.as(e,t.TGraphic).FImage&&!rtl.as(e,t.TGraphic).Empty()?(i=e.FImage.src,this.LoadFromURL(i,null)):null==e&&(this.CreateImage(),this.DoChange())},this.LoadFromURL=function(t,e){this.LoadFromURL$1(t,0,e)},this.LoadFromURL$1=function(t,e,i){this.FEmpty=!0,this.LoadFromCache(t,i)},this.LoadFromResource=function(t){this.LoadFromResource$1(t,0)},this.LoadFromResource$1=function(t,e){this.FEmpty=!0,this.LoadFromCache(t,null)},this.LoadFromStream=function(t){this.DoChange()};var i=this.$rtti;i.addProperty("OnChange",0,pas.Classes.$rtti.TNotifyEvent,"FOnChange","FOnChange"),i.addProperty("URL",2,rtl.string,"FURL","SetURL"),i.addProperty("Data",3,t.$rtti.TBinaryString,"GetData","SetData")})),rtl.createClass(this,"TBitmap",this.TGraphic,(function(){})),rtl.recNewT(this,"TMatrix",(function(){this.m11=0,this.m12=0,this.m13=0,this.m21=0,this.m22=0,this.m23=0,this.m31=0,this.m32=0,this.m33=0,this.$eq=function(t){return this.m11===t.m11&&this.m12===t.m12&&this.m13===t.m13&&this.m21===t.m21&&this.m22===t.m22&&this.m23===t.m23&&this.m31===t.m31&&this.m32===t.m32&&this.m33===t.m33},this.$assign=function(t){return this.m11=t.m11,this.m12=t.m12,this.m13=t.m13,this.m21=t.m21,this.m22=t.m22,this.m23=t.m23,this.m31=t.m31,this.m32=t.m32,this.m33=t.m33,this}})),rtl.createClass(this,"TCanvas",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FElementCanvas=null,this.FContext=null,this.FPen=null,this.FBrush=null,this.FFont=null,this.FPathOpen=!1,this.FPathX=0,this.FPathY=0,this.FClipRect=t.TCanvasRectF.$new(),this.FOnEndScene=null,this.FOnBeginScene=null,this.FApplyPixelRatio=!1},this.$final=function(){this.FElementCanvas=void 0,this.FContext=void 0,this.FPen=void 0,this.FBrush=void 0,this.FFont=void 0,this.FClipRect=void 0,this.FOnEndScene=void 0,this.FOnBeginScene=void 0,pas.System.TObject.$final.call(this)},this.SetClipRect=function(t){this.FClipRect.$assign(t),null!=this.FContext&&(this.FContext.beginPath(),this.FContext.rect(this.FClipRect.Left,this.FClipRect.Top,this.FClipRect.Right-this.FClipRect.Left,this.FClipRect.Bottom-this.FClipRect.Top),this.FContext.clip())},this.GetAccuOffset=function(t,e,i,s){i.set(0),s.set(0),1===this.FPen.FWidth&&5!==this.FPen.FStyle&&0===pas.System.Frac(t)&&i.set(.5),1===this.FPen.FWidth&&5!==this.FPen.FStyle&&0===pas.System.Frac(e)&&s.set(.5)},this.ApplyStroke=function(){if(null!=this.FContext){this.FContext.lineWidth=this.FPen.FWidth,this.FContext.strokeStyle=t.ColorToHTML(this.FPen.FColor);var e=this.FPen.FStyle;0===e?this.FContext.setLineDash([]):2===e?this.FContext.setLineDash([1,2]):1===e?this.FContext.setLineDash([8,2]):3===e?this.FContext.setLineDash([6,2,2,2]):4===e?this.FContext.setLineDash([6,2,2,2,2,2]):5===e&&this.FContext.setLineDash([0,65535])}},this.ApplyFill=function(){null!=this.FContext&&(this.FContext.fillStyle=t.ColorToHTML(this.FBrush.FColor))},this.ApplyBrush=function(e,i,s,n){var o=0,r=0,a=0,l=null,h=0,F="",p=0,c=0;if(this.GetAccuOffset(e,i,{get:function(){return o},set:function(t){o=t}},{get:function(){return r},set:function(t){r=t}}),this.FBrush.FStyle in rtl.createSet(2,6))for(a=i+r,this.FContext.lineWidth=1,this.FContext.strokeStyle=t.ColorToHTML(this.FBrush.FColor);a<n;)this.FContext.moveTo(e,a),this.FContext.lineTo(s,a),a+=8;if(this.FBrush.FStyle in rtl.createSet(3,6))for(a=e+o,this.FContext.lineWidth=1,this.FContext.strokeStyle=t.ColorToHTML(this.FBrush.FColor);a<s;)this.FContext.moveTo(a,i),this.FContext.lineTo(a,n),a+=8;if(this.FBrush.FStyle in rtl.createSet(4,7))for(a=e+o-(s-e),this.FContext.lineWidth=1,this.FContext.strokeStyle=t.ColorToHTML(this.FBrush.FColor);a<s;)this.FContext.moveTo(a,i),this.FContext.lineTo(a+(n-i),n),a+=8;if(this.FBrush.FStyle in rtl.createSet(5,7))for(a=e+o,this.FContext.lineWidth=1,this.FContext.strokeStyle=t.ColorToHTML(this.FBrush.FColor);a<s+(s-e);)this.FContext.moveTo(a,i),this.FContext.lineTo(a-(n-i),n),a+=8;if(0!==this.FBrush.FGradient){var u=this.FBrush.FGradient;2===u?l=this.FContext.createLinearGradient(e,i,s,i):1===u?l=this.FContext.createLinearGradient(e,i,e,n):3===u&&(l=this.FContext.createRadialGradient(e+(s-e)/2,i+(n-i)/2,0,e+(s-e)/2,i+(n-i)/2,(s-e)/2)),F=t.ColorToHTML(t.ColorToRGB(this.FBrush.FColor)),l.addColorStop(0,F);for(var T=0,C=this.FBrush.GradientCount()-1;T<=C;T++)h=T,this.FBrush.GetGradientColor(h,{get:function(){return p},set:function(t){p=t}},{get:function(){return c},set:function(t){c=t}}),F=t.ColorToHTML(t.ColorToRGB(p)),l.addColorStop(c,F);return this.FContext.fillStyle=l,void this.FContext.fillRect(e,i,s,n)}this.FContext.stroke()},this.Create$1=function(e){return this.FElementCanvas=e,this.FContext=e.getContext("2d"),this.FPen=t.TPen.$create("Create$1"),this.FBrush=t.TBrush.$create("Create$1"),this.FPathOpen=!1,this.FFont=t.TFont.$create("Create$1"),this.FApplyPixelRatio=!1,this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)},this.SetTransform=function(i,s,n,o,r,a){var l=t.TMatrix.$new(),h=0;null!=this.FContext&&(l.$assign(e.MatrixIdentity()),l.m11=i,l.m12=s,l.m21=n,l.m22=o,l.m31=r,l.m32=a,this.FApplyPixelRatio&&(h=e.GetPixelRatio(this),l.$assign(e.MatrixMultiply(l,e.MatrixCreateScaling(h,h)))),this.FContext.setTransform(l.m11,l.m12,l.m21,l.m22,l.m31,l.m32))},this.Transform=function(t,e,i,s,n,o){null!=this.FContext&&this.FContext.transform(t,e,i,s,n,o)},this.AngleArc$1=function(t,e,i,s,n){null!=this.FContext&&(this.FContext.beginPath(),this.ApplyStroke(),this.FContext.arc(t,e,i,s,s+n),this.FContext.stroke())},this.MoveTo$1=function(t,e){var i=0,s=0;null!=this.FContext&&(this.FPathOpen=!0,this.FContext.beginPath(),this.ApplyStroke(),i=0,s=0,this.GetAccuOffset(t,e,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),this.FContext.moveTo(t+i,e+s))},this.LineTo$1=function(e,i){var s=0,n=0,o=0;if(null!=this.FContext){s=0,n=0,this.GetAccuOffset(e,i,{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}});var r=this.FPen.FMode;0===r?this.FContext.strokeStyle=t.ColorToHTML(0):1===r?this.FContext.strokeStyle=t.ColorToHTML(16777215):14===r?this.FContext.globalCompositeOperation="xor":12===r?this.FContext.globalCompositeOperation="source-atop":5===r?(o=4294967295^t.ColorToRGB(this.FPen.FColor),this.FContext.strokeStyle=t.ColorToHTML(o)):15===r&&(o=4294967295^t.ColorToRGB(this.FPen.FColor),this.FContext.strokeStyle=t.ColorToHTML(o),this.FContext.globalCompositeOperation="xor"),this.FPathOpen||(this.FContext.beginPath(),this.ApplyStroke(),this.FContext.moveTo(this.FPathX+s,this.FPathY+n)),this.FContext.lineTo(e+s,i+n),this.FContext.stroke(),this.FPathX=e,this.FPathY=i,this.FPathOpen=!1,this.FContext.globalCompositeOperation="source-over"}},this.Rectangle=function(t,e,i,s){var n=0,o=0;if(null!=this.FContext){this.FContext.save(),this.FContext.beginPath(),this.ApplyStroke(),this.ApplyFill(),this.GetAccuOffset(t,e,{get:function(){return n},set:function(t){n=t}},{get:function(){return o},set:function(t){o=t}});let r=new Path2D;r.rect(t,e,i-t+1,s-e+1),this.FContext.clip(r,"evenodd"),this.ApplyBrush(t,e,i,s),this.FBrush.FStyle in rtl.createSet(1,2,3,6,4,5,7)||(this.FContext.rect(t+n,e+o,i-t,s-e),this.FContext.fill()),5!==this.FPen.FStyle&&(this.ApplyStroke(),this.FContext.beginPath(),this.FContext.rect(t+n,e+o,i-t,s-e),this.FContext.stroke()),this.FContext.restore()}},this.Rectangle$3=function(t){this.Rectangle(t.Left,t.Top,t.Right,t.Bottom)},this.RoundRect$1=function(t,e,i,s,n,o){var r=0,a=0;if(null!=this.FContext){this.FContext.beginPath(),this.ApplyStroke(),this.ApplyFill(),this.GetAccuOffset(t,e,{get:function(){return r},set:function(t){r=t}},{get:function(){return a},set:function(t){a=t}}),this.FContext.moveTo(t+n/2,e+a),this.FContext.lineTo(i-n/2,e+a),this.FContext.quadraticCurveTo(i+r,e+a,i+r,e+a+o/2),this.FContext.lineTo(i+r,s-o/2),this.FContext.quadraticCurveTo(i+r,s+a,i-n/2-r,s+a),this.FContext.lineTo(t+n/2,s+a),this.FContext.quadraticCurveTo(t+r,s+a,t+r,s-o/2),this.FContext.lineTo(t+r,e+o/2+a),this.FContext.quadraticCurveTo(t+r,e+a,t+n/2+r,e+a),0===this.FBrush.FStyle&&this.FContext.fill(),5!==this.FPen.FStyle&&this.FContext.stroke(),this.FContext.save();let l=new Path2D;l.moveTo(t+n/2,e+a),l.lineTo(i-n/2,e+a),l.quadraticCurveTo(i+r,e+a,i+r,e+a+o/2),l.lineTo(i+r,s-o/2),l.quadraticCurveTo(i+r,s+a,i-n/2-r,s+a),l.lineTo(t+n/2,s+a),l.quadraticCurveTo(t+r,s+a,t+r,s-o/2),l.lineTo(t+r,e+o/2+a),l.quadraticCurveTo(t+r,e+a,t+n/2+r,e+a),this.FContext.clip(l,"evenodd"),this.ApplyBrush(t,e,i,s),this.FContext.restore()}},this.RoundRect$3=function(t,e,i){this.RoundRect$1(t.Left,t.Top,t.Right,t.Bottom,e,i)},this.Ellipse$1=function(t,e,i,s){var n=0,o=0,r=0,a=0,l=0,h=0,F=0,p=0,c=0;if(null!=this.FContext){a=(n=i-t)/2*(r=.5522848),l=(o=s-e)/2*r,h=t+n,F=e+o,p=t+n/2,c=e+o/2,this.FContext.save();let u=new Path2D;u.moveTo(t,c),u.bezierCurveTo(t,c-l,p-a,e,p,e),u.bezierCurveTo(p+a,e,h,c-l,h,c),u.bezierCurveTo(h,c+l,p+a,F,p,F),u.bezierCurveTo(p-a,F,t,c+l,t,c),u.closePath(),this.FContext.clip(u,"evenodd"),this.ApplyBrush(t,e,i,s),this.FContext.restore(),this.FContext.beginPath(),this.ApplyStroke(),this.ApplyFill(),this.FContext.moveTo(t,c),this.FContext.bezierCurveTo(t,c-l,p-a,e,p,e),this.FContext.bezierCurveTo(p+a,e,h,c-l,h,c),this.FContext.bezierCurveTo(h,c+l,p+a,F,p,F),this.FContext.bezierCurveTo(p-a,F,t,c+l,t,c),this.FContext.closePath(),0===this.FBrush.FStyle&&0===this.FBrush.FGradient&&this.FContext.fill(),5!==this.FPen.FStyle&&this.FContext.stroke()}},this.Ellipse$3=function(t){this.Ellipse$1(t.Left,t.Top,t.Right,t.Bottom)},this.Polyline$1=function(t){var e=0,i=0;if(null!=this.FContext){if(0===(e=rtl.length(t)))return;for(this.FContext.beginPath(),this.ApplyStroke(),i=0,this.FContext.moveTo(t[i].X,t[i].Y);i<e-1;)i+=1,this.FContext.lineTo(t[i].X,t[i].Y);5!==this.FPen.FStyle&&this.FContext.stroke()}},this.Polygon$1=function(t){var e=0,i=0,s=0,n=0,o=0,r=0;if(null!=this.FContext){if(0===(e=rtl.length(t)))return;this.FContext.beginPath(),this.ApplyStroke(),s=65535,n=65535,o=0,r=0;for(var a=0,l=rtl.length(t)-1;a<=l;a++)t[i=a].X<s&&(s=t[i].X),t[i].X<n&&(n=t[i].Y),t[i].X>o&&(o=t[i].X),t[i].X<r&&(r=t[i].Y);for(0!==this.FBrush.FGradient?this.ApplyBrush(s,n,o,r):this.ApplyFill(),i=0,this.FContext.moveTo(t[i].X,t[i].Y);i<e-1;)i+=1,this.FContext.lineTo(t[i].X,t[i].Y);this.FContext.closePath(),1!==this.FBrush.FStyle&&this.FContext.fill(),5!==this.FPen.FStyle&&this.FContext.stroke()}},this.TextOut$1=function(e,i,s){var n=null;null!=this.FContext&&(this.FContext.fillStyle=t.ColorToHTML(this.FFont.FColor),this.FContext.font=this.FFont.ToString(),this.FContext.textBaseline="top",this.FContext.fillText(s,e,i),3 in this.FFont.FStyle&&(n=this.FContext.measureText(s),this.FContext.fillRect(e,i+1.4*this.FFont.FSize,n.width,1)),2 in this.FFont.FStyle&&(n=this.FContext.measureText(s),this.FContext.fillRect(e,i+.7*this.FFont.FSize,n.width,1)))},this.StretchDraw$1=function(t,e){var i=null;null!=this.FContext&&(i=e.Image(),this.FContext.drawImage(i,0,0,e.GetWidth(),e.GetHeight(),t.Left,t.Top,t.Right-t.Left,t.Bottom-t.Top))},this.BeginScene=function(){null!=this.FOnBeginScene&&this.FOnBeginScene(this)},this.EndScene=function(){null!=this.FOnEndScene&&this.FOnEndScene(this)},this.PathBegin=function(){null!=this.FContext&&this.FContext.beginPath()},this.PathClose=function(){null!=this.FContext&&this.FContext.closePath()},this.PathStroke=function(){null!=this.FContext&&(this.ApplyStroke(),this.FContext.stroke())},this.PathFill=function(){null!=this.FContext&&(this.ApplyFill(),this.FContext.fill())},this.PathMoveTo$1=function(t,e){var i=0,s=0;null!=this.FContext&&(i=0,s=0,this.GetAccuOffset(t,e,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),this.FContext.moveTo(t+i,e+s))},this.PathLineTo$1=function(t,e){var i=0,s=0;null!=this.FContext&&(i=0,s=0,this.GetAccuOffset(t,e,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),this.FContext.lineTo(t+i,e+s))},this.Save=function(){null!=this.FContext&&this.FContext.save()},this.Restore=function(){null!=this.FContext&&this.FContext.restore()},this.Refresh=function(){},this.Clear=function(){null!=this.FContext&&null!=this.FElementCanvas&&this.FContext.clearRect(0,0,this.FElementCanvas.width,this.FElementCanvas.height)},this.TextRect$1=function(e,i,s,n,o,r){var a,l=this,h=t.TCanvasRectF.$new(),F=0,p="",c="",u="",T=0,C=0,S=0,d=!1,m=0,f=0,g=0,y=0,b=t.TCanvasRectF.$new(),N=0,M=0,B=!1,E=!1;function L(t,i,s){if(B){var n=o;2===n?l.TextOut$1(e.Left+(e.Right-e.Left-i)/2,e.Top,t):0===n?l.TextOut$1(e.Left,e.Top,t):1===n&&l.TextOut$1(e.Right-i,e.Top,t)}else{var a=o;if(2===a){var h=r;0===h?l.TextOut$1(e.Left+(e.Right-e.Left-i)/2,e.Top,t):2===h?l.TextOut$1(e.Left+(e.Right-e.Left-i)/2,e.Top+(e.Bottom-e.Top-s)/2,t):1===h&&l.TextOut$1(e.Left+(e.Right-e.Left-i)/2,e.Bottom-s,t)}else if(0===a){var F=r;0===F?l.TextOut$1(e.Left,e.Top,t):2===F?l.TextOut$1(e.Left,e.Top+(e.Bottom-e.Top-s)/2,t):1===F&&l.TextOut$1(e.Left,e.Bottom-s,t)}else if(1===a){var p=r;0===p?l.TextOut$1(e.Right-i,e.Top,t):2===p?l.TextOut$1(e.Right-i,e.Top+(e.Bottom-e.Top-s)/2,t):1===p&&l.TextOut$1(e.Right-i,e.Bottom-s,t)}}}function D(t,e){var i,s="",n=0;if(s="",i=t.length,e.get()>i)return s;for(n=e.get();;){if("\n"===t.charAt(n-1)&&"\r"===t.charAt(n-1-1)||"\r"===t.charAt(n-1)&&"\n"===t.charAt(n-1-1)||" "===t.charAt(n-1)){s=" "===t.charAt(n-1)?pas.System.Copy(t,e.get(),n-(e.get()-1)):pas.System.Copy(t,e.get(),n-e.get());break}if("\n"===t.charAt(n-1)||"\r"===t.charAt(n-1)||" "===t.charAt(n-1)){s=pas.System.Copy(t,e.get(),n-(e.get()-1));break}if(n>=i){s=pas.System.Copy(t,e.get(),n-(e.get()-1));break}n+=1}return e.set(n+1),s}if(B=s||pas.System.Pos("\r",i)>0||pas.System.Pos("\n",i)>0,a=!s&&(pas.System.Pos("\r",i)>0||pas.System.Pos("\n",i)>0),B){for(b.$assign(e),S=0,F=1,M=.5*this.FFont.FSize,y=0,N=0,f=0,p=D(i,{get:function(){return F},set:function(t){F=t}}),C=this.TextWidth(p),g=this.TextHeight(p)+M,S+=C,p.length>0&&" "===p.charAt(p.length-1)&&(S+=N),E=!1;F<=i.length&&((T=p.length)>=2&&("\n"===p.charAt(T-1)&&"\r"===p.charAt(T-1-1)||"\r"===p.charAt(T-1)&&"\n"===p.charAt(T-1-1))?(p=pas.System.Copy(p,1,T-2),d=!0):T>=1&&("\n"===p.charAt(T-1)||"\r"===p.charAt(T-1))?(p=pas.System.Copy(p,1,T-1),d=!0):d=!1,c=D(i,{get:function(){return F},set:function(t){F=t}}),C=this.TextWidth(c),g=Math.max(g,this.TextHeight(c)+M),!((e.Left+S+C>e.Right||d)&&(""===p||E||(m=p.length,u=pas.System.Copy(p,1,m),y+=1,S>f&&(f=S),n||L(u,S,g),S=0),p="",E=!1,a&&d||!a?e.Top=e.Top+g:a&&!d&&(E=!0),pas.System.Trunc(e.Top)>pas.System.Trunc(e.Bottom-g+M)&&!n)));)S+=C,c.length>0&&" "===c.charAt(c.length-1)&&(S+=N),p+=c;""!==p&&(m=p.length,u=pas.System.Copy(p,1,m),y+=1,S>f&&(f=S),n||L(u,S,g)),h.$assign(t.CreateCanvasRectF(b.Left,b.Top,b.Left+f,b.Top+y*g))}else C=this.TextWidth(i),g=this.TextHeight(i),n||L(i,C,g),h.$assign(t.CreateCanvasRectF(e.Left,e.Top,e.Left+C,e.Top+g));return h},this.TextWidth=function(t){var e=0,i="";return null!=this.FContext&&(i=this.FFont.ToString(),this.FContext.font=i,e=this.FContext.measureText(t).width),e},this.TextHeight=function(e){return t.FontSizeToPx(this.FFont.FSize)},this.GetBase64Image=function(){var t="";return t="",null!=this.FElementCanvas&&(t=this.FElementCanvas.toDataURL()),t}})),this.ColorToRGB=function(t){return t},this.ColorToHex=function(t){var e="";for(e=t.toString(16);e.length<6;)e="0"+e;return pas.System.Copy(e,5,2)+pas.System.Copy(e,3,2)+pas.System.Copy(e,1,2)},this.ColorToHTML=function(e){return"#"+t.ColorToHex(e)},this.FontSizeToHTML=function(t){var e="";return e=pas.SysUtils.FloatToStr(t)+"px",e=pas.SysUtils.StringReplace(e,",",".",rtl.createSet(0))},this.HexToColor=function(t){var e="",i=0;e="";for(var s=1,n=t.length;s<=n;s++)i=s,(t.charAt(i-1)>="0"&&t.charAt(i-1)<="9"||t.charAt(i-1)>="A"&&t.charAt(i-1)<="F"||t.charAt(i-1)>="a"&&t.charAt(i-1)<="f")&&(e+=t.charAt(i-1));return e="$"+pas.System.Copy(e,5,2)+pas.System.Copy(e,3,2)+pas.System.Copy(e,1,2),pas.SysUtils.StrToInt64(e)},this.FontSizeToPx=function(t){return 96*t/72},this.GetRValue=function(t){return 255&t},this.GetGValue=function(t){return 255&Math.floor(t/256)},this.GetBValue=function(t){return 255&Math.floor(t/65536)},this.CreateCanvasRectF=function(e,i,s,n){var o=t.TCanvasRectF.$new();return o.Left=e,o.Top=i,o.Right=s,o.Bottom=n,o},this.CreateCanvasPointF=function(e,i){var s=t.TCanvasPointF.$new();return s.X=e,s.Y=i,s},this.RGB=function(t,e,i){return t|e<<8|i<<16},t.$implcode=function(){rtl.createClass(e,"TGraphicCache",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FImage=null,this.FID=""},this.$final=function(){this.FImage=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t,e){return this.FImage=t,this.FID=e,this}})),rtl.createClass(e,"TGraphicCacheList",pas.contnrs.TObjectList,(function(){this.Find=function(t,i){var s=!1,n=0,o=null;s=!1;for(var r=0,a=this.GetCount()-1;r<=a;r++)if(n=r,(o=rtl.as(this.GetItem(n),e.TGraphicCache)).FID===t&&null!=o.FImage){i.set(o.FImage),s=!0;break}return s},this.Exists=function(t){var i=!1,s=0,n=null;i=!1;for(var o=0,r=this.GetCount()-1;o<=r;o++)if(s=o,(n=rtl.as(this.GetItem(s),e.TGraphicCache)).FID===t&&null!=n.FImage){i=!0;break}return i}})),e.FCache=null,e.FQueue=null,e.FCacheCount=0,e.MatrixIdentity=function(){var e=t.TMatrix.$new();return e.m11=1,e.m12=0,e.m13=0,e.m21=0,e.m22=1,e.m23=0,e.m31=0,e.m32=0,e.m33=1,e},e.GetPixelRatio=function(t){var e=t.FContext;return(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)},e.MatrixCreateScaling=function(i,s){var n=t.TMatrix.$new();return n.$assign(e.MatrixIdentity()),n.m11=i,n.m22=s,n},e.MatrixMultiply=function(e,i){var s=t.TMatrix.$new();return s.m11=e.m11*i.m11+e.m12*i.m21+e.m13*i.m31,s.m12=e.m11*i.m12+e.m12*i.m22+e.m13*i.m32,s.m13=e.m11*i.m13+e.m12*i.m23+e.m13*i.m33,s.m21=e.m21*i.m11+e.m22*i.m21+e.m23*i.m31,s.m22=e.m21*i.m12+e.m22*i.m22+e.m23*i.m32,s.m23=e.m21*i.m13+e.m22*i.m23+e.m23*i.m33,s.m31=e.m31*i.m11+e.m32*i.m21+e.m33*i.m31,s.m32=e.m31*i.m12+e.m32*i.m22+e.m33*i.m32,s.m33=e.m31*i.m13+e.m32*i.m23+e.m33*i.m33,s}},t.$init=function(){e.FCache=e.TGraphicCacheList.$create("Create$2"),e.FQueue=pas.Classes.TStringList.$create("Create$1")}}),["WEBLib.Forms","WEBLib.WebTools","Math","SysUtils","contnrs"]),rtl.module("WEBLib.Modules",["System","Classes"],(function(){"use strict";rtl.createClass(this,"TDataModule",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FHeight=0,this.FOldCreateOrder=!1,this.FOnCreate=null,this.FOnDestroy=null,this.FWidth=0},this.$final=function(){this.FOnCreate=void 0,this.FOnDestroy=void 0,pas.Classes.TComponent.$final.call(this)},this.DoCreate=function(){this.LoadDFMValues(),null!=this.FOnCreate&&this.FOnCreate(this)},this.DoDestroy=function(){null!=this.FOnDestroy&&this.FOnDestroy(this)},this.LoadDFMValues=function(){},this.AfterConstruction=function(){pas.System.TObject.AfterConstruction.call(this),this.FOldCreateOrder||this.DoCreate()},this.BeforeDestruction=function(){pas.Classes.TComponent.BeforeDestruction.call(this),this.FOldCreateOrder||this.DoDestroy()},rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("OnCreate",0,pas.Classes.$rtti.TNotifyEvent,"FOnCreate","FOnCreate"),t.addProperty("OnDestroy",0,pas.Classes.$rtti.TNotifyEvent,"FOnDestroy","FOnDestroy")}))})),rtl.module("WEBLib.Lang",["System"],(function(){"use strict";this.TUILanguage={0:"lNone",lNone:0,1:"lAfar",lAfar:1,2:"lAbkhazian",lAbkhazian:2,3:"lAvestan",lAvestan:3,4:"lAfrikaans",lAfrikaans:4,5:"lAkan",lAkan:5,6:"lAmharic",lAmharic:6,7:"lAragonese",lAragonese:7,8:"lArabic",lArabic:8,9:"lAssamese",lAssamese:9,10:"lAvaric",lAvaric:10,11:"lAymara",lAymara:11,12:"lAzerbaijani",lAzerbaijani:12,13:"lBashkir",lBashkir:13,14:"lBelarusian",lBelarusian:14,15:"lBulgarian",lBulgarian:15,16:"lBihari",lBihari:16,17:"lBislama",lBislama:17,18:"lBambara",lBambara:18,19:"lBengali",lBengali:19,20:"lTibetan",lTibetan:20,21:"lBreton",lBreton:21,22:"lBosnian",lBosnian:22,23:"lCatalan",lCatalan:23,24:"lChechen",lChechen:24,25:"lChamorro",lChamorro:25,26:"lCorsican",lCorsican:26,27:"lCree",lCree:27,28:"lCzech",lCzech:28,29:"lOldSlavic",lOldSlavic:29,30:"lChuvash",lChuvash:30,31:"lWelsh",lWelsh:31,32:"lDanish",lDanish:32,33:"lGerman",lGerman:33,34:"lDivehi",lDivehi:34,35:"lDzongkha",lDzongkha:35,36:"lEwe",lEwe:36,37:"lEnglish",lEnglish:37,38:"lEsperanto",lEsperanto:38,39:"lSpanish",lSpanish:39,40:"lEstonian",lEstonian:40,41:"lBasque",lBasque:41,42:"lPersian",lPersian:42,43:"lFulah",lFulah:43,44:"lFinnish",lFinnish:44,45:"lFijian",lFijian:45,46:"lFaroese",lFaroese:46,47:"lFrench",lFrench:47,48:"lWesternFrisian",lWesternFrisian:48,49:"lIrish",lIrish:49,50:"lGaelic",lGaelic:50,51:"lGalician",lGalician:51,52:"lGuarani",lGuarani:52,53:"lGujarati",lGujarati:53,54:"lManx",lManx:54,55:"lHausa",lHausa:55,56:"lHebrew",lHebrew:56,57:"lHindi",lHindi:57,58:"lHiriMotu",lHiriMotu:58,59:"lCroatian",lCroatian:59,60:"lHaitian",lHaitian:60,61:"lHungarian",lHungarian:61,62:"lArmenian",lArmenian:62,63:"lHerero",lHerero:63,64:"lInterlingua",lInterlingua:64,65:"lIndonesian",lIndonesian:65,66:"lInterlingue",lInterlingue:66,67:"lIgbo",lIgbo:67,68:"lSichuanYi",lSichuanYi:68,69:"lInupiaq",lInupiaq:69,70:"lIdo",lIdo:70,71:"lIcelandic",lIcelandic:71,72:"lItalian",lItalian:72,73:"lInuktitut",lInuktitut:73,74:"lJapanese",lJapanese:74,75:"lJavanese",lJavanese:75,76:"lGeorgian",lGeorgian:76,77:"lKongo",lKongo:77,78:"lKikuyu",lKikuyu:78,79:"lKuanyama",lKuanyama:79,80:"lKazakh",lKazakh:80,81:"lKalaallisut",lKalaallisut:81,82:"lCentralKhmer",lCentralKhmer:82,83:"lKannada",lKannada:83,84:"lKorean",lKorean:84,85:"lKanuri",lKanuri:85,86:"lKashmiri",lKashmiri:86,87:"lKurdish",lKurdish:87,88:"lKomi",lKomi:88,89:"lCornish",lCornish:89,90:"lKirghiz",lKirghiz:90,91:"lLatin",lLatin:91,92:"lLuxembourgish",lLuxembourgish:92,93:"lGanda",lGanda:93,94:"lLimburgan",lLimburgan:94,95:"lLingala",lLingala:95,96:"lLao",lLao:96,97:"lLithuanian",lLithuanian:97,98:"lLubaKatanga",lLubaKatanga:98,99:"lLatvian",lLatvian:99,100:"lMalagasy",lMalagasy:100,101:"lMarshallese",lMarshallese:101,102:"lMaori",lMaori:102,103:"lMacedonian",lMacedonian:103,104:"lMalayalam",lMalayalam:104,105:"lMongolian",lMongolian:105,106:"lMarathi",lMarathi:106,107:"lMalay",lMalay:107,108:"lMaltese",lMaltese:108,109:"lBurmese",lBurmese:109,110:"lNauru",lNauru:110,111:"lNdebele",lNdebele:111,112:"lNepali",lNepali:112,113:"lNdonga",lNdonga:113,114:"lDutch",lDutch:114,115:"lNorwegian",lNorwegian:115,116:"lNavajo",lNavajo:116,117:"lChichewa",lChichewa:117,118:"lOccitan",lOccitan:118,119:"lOjibwa",lOjibwa:119,120:"lOromo",lOromo:120,121:"lOriya",lOriya:121,122:"lOssetian",lOssetian:122,123:"lPanjabi",lPanjabi:123,124:"lPali",lPali:124,125:"lPolish",lPolish:125,126:"lPushto",lPushto:126,127:"lPortuguese",lPortuguese:127,128:"lQuechua",lQuechua:128,129:"lRomansh",lRomansh:129,130:"lRundi",lRundi:130,131:"lRomanian",lRomanian:131,132:"lRussian",lRussian:132,133:"lKinyarwanda",lKinyarwanda:133,134:"lSanskrit",lSanskrit:134,135:"lSardinian",lSardinian:135,136:"lSindhi",lSindhi:136,137:"lNorthernSami",lNorthernSami:137,138:"lSango",lSango:138,139:"lSinhala",lSinhala:139,140:"lSlovak",lSlovak:140,141:"lSlovenian",lSlovenian:141,142:"lSamoan",lSamoan:142,143:"lShona",lShona:143,144:"lSomali",lSomali:144,145:"lAlbanian",lAlbanian:145,146:"lSerbian",lSerbian:146,147:"lSwati",lSwati:147,148:"lSotho",lSotho:148,149:"lSundanese",lSundanese:149,150:"lSwedish",lSwedish:150,151:"lSwahili",lSwahili:151,152:"lTamil",lTamil:152,153:"lTelugu",lTelugu:153,154:"lTajik",lTajik:154,155:"lThai",lThai:155,156:"lTigrinya",lTigrinya:156,157:"lTurkmen",lTurkmen:157,158:"lTagalog",lTagalog:158,159:"lTswana",lTswana:159,160:"lTonga",lTonga:160,161:"lTurkish",lTurkish:161,162:"lTsonga",lTsonga:162,163:"lTatar",lTatar:163,164:"lTwi",lTwi:164,165:"lTahitian",lTahitian:165,166:"lUighur",lUighur:166,167:"lUkrainian",lUkrainian:167,168:"lUrdu",lUrdu:168,169:"lUzbek",lUzbek:169,170:"lVenda",lVenda:170,171:"lVietnamese",lVietnamese:171,172:"lWalloon",lWalloon:172,173:"lWolof",lWolof:173,174:"lXhosa",lXhosa:174,175:"lYiddish",lYiddish:175,176:"lYoruba",lYoruba:176,177:"lZhuang",lZhuang:177,178:"lChinese",lChinese:178,179:"lZulu",lZulu:179},this.GetLanguageISO639_1Code=function(t){var e="";return 0===t?e="":1===t?e="aa":2===t?e="ab":3===t?e="ae":4===t?e="af":5===t?e="ak":6===t?e="am":7===t?e="an":8===t?e="ar":9===t?e="as":10===t?e="av":11===t?e="ay":12===t?e="az":13===t?e="ba":14===t?e="be":15===t?e="bg":16===t?e="bh":17===t?e="bi":18===t?e="bm":19===t?e="bn":20===t?e="bo":21===t?e="br":22===t?e="bd":23===t?e="ca":24===t?e="ce":25===t?e="ch":26===t?e="co":27===t?e="cr":28===t?e="cs":29===t?e="cu":30===t?e="cv":31===t?e="cy":32===t?e="da":33===t?e="de":34===t?e="dv":35===t?e="dz":36===t?e="ee":37===t?e="en":38===t?e="eo":39===t?e="es":40===t?e="et":41===t?e="eu":42===t?e="fa":43===t?e="ff":44===t?e="fi":45===t?e="fj":46===t?e="fo":47===t?e="fr":48===t?e="fy":49===t?e="ga":50===t?e="gd":51===t?e="gl":52===t?e="gn":53===t?e="gu":54===t?e="gv":55===t?e="ha":56===t?e="he":57===t?e="hi":58===t?e="ho":59===t?e="hr":60===t?e="ht":61===t?e="hu":62===t?e="hy":63===t?e="hz":64===t?e="ia":65===t?e="id":66===t?e="ie":67===t?e="ig":68===t?e="ii":69===t?e="ik":70===t?e="id":71===t?e="is":72===t?e="it":73===t?e="iu":74===t?e="ja":75===t?e="jv":76===t?e="ka":77===t?e="kg":78===t?e="ki":79===t?e="kj":80===t?e="kk":81===t?e="kl":82===t?e="km":83===t?e="kn":84===t?e="ko":85===t?e="kr":86===t?e="ks":87===t?e="ku":88===t?e="kv":89===t?e="kw":90===t?e="ky":91===t?e="la":92===t?e="lb":93===t?e="lg":94===t?e="li":95===t?e="ln":96===t?e="lo":97===t?e="lt":98===t?e="lu":99===t?e="lv":100===t?e="mg":101===t?e="mh":102===t?e="mi":103===t?e="mk":104===t?e="ml":105===t?e="mn":106===t?e="mr":107===t?e="ms":108===t?e="mt":109===t?e="my":110===t?e="na":111===t?e="nb":112===t?e="nd":113===t?e="ng":114===t?e="nl":115===t?e="no":116===t?e="nv":117===t?e="ny":118===t?e="oc":119===t?e="oj":120===t?e="om":121===t?e="or":122===t?e="os":123===t?e="pa":124===t?e="pi":125===t?e="pl":126===t?e="ps":127===t?e="pt":128===t?e="qu":129===t?e="rm":130===t?e="rn":131===t?e="ro":132===t?e="ru":133===t?e="rw":134===t?e="sa":135===t?e="sc":136===t?e="sd":137===t?e="se":138===t?e="sg":139===t?e="si":140===t?e="sk":141===t?e="sl":142===t?e="sm":143===t?e="sn":144===t?e="so":145===t?e="sq":146===t?e="sr":147===t?e="ss":148===t?e="st":149===t?e="su":150===t?e="sv":151===t?e="sw":152===t?e="ta":153===t?e="te":154===t?e="tg":155===t?e="th":156===t?e="ti":157===t?e="tk":158===t?e="tl":159===t?e="tn":160===t?e="to":161===t?e="tr":162===t?e="ts":163===t?e="tt":164===t?e="tw":165===t?e="ty":166===t?e="ug":167===t?e="uk":168===t?e="ur":169===t?e="uz":170===t?e="ve":171===t?e="vi":172===t?e="wa":173===t?e="wo":174===t?e="xh":175===t?e="yi":176===t?e="yo":177===t?e="za":178===t?e="zh":179===t&&(e="zu"),e}})),rtl.module("WEBLib.Menus",["System","Classes","SysUtils","WEBLib.Controls","WEBLib.Graphics","Web"],(function(){"use strict";var t=this,e=t.$impl;this.$rtti.$Class("TMainMenu"),this.$rtti.$Class("TMenuItem"),this.$rtti.$Class("TCustomMainMenu"),this.TMenuItemAutoFlag={0:"maAutomatic",maAutomatic:0,1:"maManual",maManual:1,2:"maParent",maParent:2},this.$rtti.$Enum("TMenuItemAutoFlag",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TMenuItemAutoFlag}),this.TMenuBreak={0:"mbNone",mbNone:0,1:"mbBreak",mbBreak:1,2:"mbBarBreak",mbBarBreak:2},this.$rtti.$Enum("TMenuBreak",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TMenuBreak}),this.$rtti.$Int("THelpContext",{minvalue:-2147483647,maxvalue:2147483647,ordtype:4}),this.$rtti.$inherited("TShortCut",rtl.word,{}),this.TMainMenuHamburgerMenuVisible={0:"hmAlways",hmAlways:0,1:"hmNever",hmNever:1,2:"hmResponsive",hmResponsive:2},this.$rtti.$Enum("TMainMenuHamburgerMenuVisible",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TMainMenuHamburgerMenuVisible}),this.$rtti.$MethodVar("TMainMenuChangeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Source",this.$rtti.TMenuItem],["Rebuild",rtl.boolean]]),methodkind:0}),rtl.createClass(this,"TMenuItemList",pas.Classes.TList,(function(){this.GetItem=function(t){return rtl.getObject(this.Get(t))}})),rtl.createClass(this,"TMenuItem",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FOwner$1=null,this.FCaption="",this.FItems=null,this.FParentItem=null,this.FOnClick=null,this.FChecked=!1,this.FEnabled=!1,this.FDefault=!1,this.FAutoCheck=!1,this.FHint="",this.FAutoHotkeys=0,this.FRadioItem=!1,this.FGroupIndex=0,this.FVisible=!1,this.FShortCut=0,this.FBreak=0,this.FImageIndex=0,this.FAutoLineReduction=0,this.FHelpContext=0,this.FElementClassName="",this.FParentMenu=null},this.$final=function(){this.FOwner$1=void 0,this.FItems=void 0,this.FParentItem=void 0,this.FOnClick=void 0,this.FParentMenu=void 0,pas.Classes.TComponent.$final.call(this)},this.SetChecked=function(e){var i=null,s=null,n=null,o=null,r=0;if(this.FChecked!==e){if(this.FChecked=e,null!=(o=this.FParentMenu)){if(t.TMenuItem.isPrototypeOf(o)&&e)for(var a=0,l=(s=o).FItems.GetCount()-1;a<=l;a++)r=a,(n=s.FItems.GetItem(r)).FRadioItem&&n!==this&&n.SetChecked(!1);for(;!t.TCustomMainMenu.isPrototypeOf(o)&&null!=o;)o=o.FOwner}null!=(i=this.GetParentMenu())&&i.UpdateElement()}},this.SetCaption=function(t){var e=null;this.FCaption=t,null!=(e=this.GetParentMenu())&&e.UpdateElement()},this.SetImageIndex=function(t){var e=null;this.FImageIndex=t,null!=(e=this.GetParentMenu())&&e.UpdateElement()},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t,this.GetParentMenu().UpdateElement())},this.GetCount=function(){return null===this.FItems?0:this.FItems.GetCount()},this.Create$1=function(e){return this.FParentMenu=null,t.TMainMenu.isPrototypeOf(e)&&(this.FParentMenu=e),pas.Classes.TComponent.Create$1.call(this,e),this.FAutoHotkeys=2,this.FAutoLineReduction=2,this.FImageIndex=-1,this.FHint="",this.FCaption="MenuItem",this.FChecked=!1,this.FEnabled=!0,this.FDefault=!1,this.FRadioItem=!1,this.FVisible=!0,this.FOwner$1=e,this},this.Destroy=function(){var t=0,e=null,i=null;if(e=this.GetParentMenu(),null!=this.FParentItem&&null!=e){e.BeginUpdate();for(var s=this.FParentItem.FItems.GetCount()-1;s>=0;s--)t=s,this.FParentItem.FItems.GetItem(t)===this&&this.FParentItem.FItems.Delete(t);e.EndUpdate()}if(null!=this.FItems)for(var n=this.FItems.GetCount()-1;n>=0;n--)t=n,(i=this.FItems.GetItem(t)).FParentItem=null,i=rtl.freeLoc(i),this.FItems.Delete(t);pas.Classes.TComponent.Destroy.call(this)},this.Assign=function(e){var i=0,s=null,n=null,o=null;if(t.TMenuItem.isPrototypeOf(e)&&(s=rtl.as(e,t.TMenuItem),this.FAutoCheck=s.FAutoCheck,this.FAutoHotkeys=s.FAutoHotkeys,this.FAutoLineReduction=s.FAutoLineReduction,this.FBreak=s.FBreak,this.FCaption=s.FCaption,this.FChecked=s.FChecked,this.FDefault=s.FDefault,this.FEnabled=s.FEnabled,this.FGroupIndex=s.FGroupIndex,this.FHelpContext=s.FHelpContext,this.FHint=s.FHint,this.FImageIndex=s.FImageIndex,this.FRadioItem=s.FRadioItem,this.FShortCut=s.FShortCut,this.FVisible=s.FVisible,this.FElementClassName=s.FElementClassName,o=this.GetParentMenu(),null!=this.FParentItem&&this.SetName(o.GetUniqueName(s.FCaption)),null!=s.FItems)){if(null!=this.FItems){for(var r=this.FItems.GetCount()-1;r>=0;r--)i=r,this.RemoveItem(this.GetParentMenu().FParent,this.FItems.GetItem(i));this.FItems.Clear()}else this.FItems=t.TMenuItemList.$create("Create$1");for(var a=0,l=s.FItems.GetCount()-1;a<=l;a++)i=a,(n=t.TMenuItem.$create("Create$1",[o.FOwner])).FParentMenu=o,n.FParentItem=this,n.Assign(s.FItems.GetItem(i)),this.FItems.Add(n)}},this.SetParentComponent=function(e){pas.Classes.TComponent.SetParentComponent.apply(this,arguments),this.FParentMenu=e,null!==e&&(t.TCustomMainMenu.isPrototypeOf(e)?e.FItems.IsChild(this)||e.FItems.Add(this):t.TMenuItem.isPrototypeOf(e)&&(e.IsChild(this)||e.Add(this)))},this.Add=function(t){this.Insert$1(this.GetCount(),t)},this.Insert$1=function(e,i){null===this.FItems&&(this.FItems=t.TMenuItemList.$create("Create$1")),this.FItems.Insert(e,i),i.FParentItem=this,null!=i.GetParentMenu()&&i.GetParentMenu().UpdateElement()},this.IsChild=function(t){var e=!1,i=0;if(e=!1,null==this.FItems)return e;for(var s=0,n=this.FItems.GetCount()-1;s<=n;s++)i=s,this.FItems.GetItem(i)===t&&(e=!0);return e},this.GetOwner=function(){return this.FOwner$1},this.GetParentMenu=function(){var e=null,i=null;for(e=null,i=this.FParentMenu;null!=i&&t.TMenuItem.isPrototypeOf(i);)i=i.FParentMenu;return null!=i&&(e=i),e},this.SetChildOrder=function(t,e){var i;(i=this.FItems.IndexOf(t))>=0&&e<this.FItems.GetCount()&&this.FItems.Move(i,e)},this.RemoveItem=function(t,e){var i=0;if(null!=e.FItems)for(var s=e.FItems.GetCount()-1;s>=0;s--)i=s,this.RemoveItem(t,e.FItems.GetItem(i));t.RemoveComponent(e)},this.Click=function(){null!=this.FOnClick&&this.FOnClick(this)},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("AutoCheck",0,rtl.boolean,"FAutoCheck","FAutoCheck",{Default:!1}),e.addProperty("AutoHotkeys",0,t.$rtti.TMenuItemAutoFlag,"FAutoHotkeys","FAutoHotkeys",{Default:t.TMenuItemAutoFlag.maParent}),e.addProperty("AutoLineReduction",0,t.$rtti.TMenuItemAutoFlag,"FAutoLineReduction","FAutoLineReduction",{Default:t.TMenuItemAutoFlag.maParent}),e.addProperty("Break",0,t.$rtti.TMenuBreak,"FBreak","FBreak",{Default:t.TMenuBreak.mbNone}),e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("Checked",2,rtl.boolean,"FChecked","SetChecked",{Default:!1}),e.addProperty("Default",0,rtl.boolean,"FDefault","FDefault",{Default:!1}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("GroupIndex",0,rtl.byte,"FGroupIndex","FGroupIndex",{Default:0}),e.addProperty("HelpContext",0,t.$rtti.THelpContext,"FHelpContext","FHelpContext",{Default:0}),e.addProperty("Hint",0,rtl.string,"FHint","FHint"),e.addProperty("ImageIndex",2,rtl.longint,"FImageIndex","SetImageIndex",{Default:-1}),e.addProperty("RadioItem",0,rtl.boolean,"FRadioItem","FRadioItem",{Default:!1}),e.addProperty("ShortCut",0,t.$rtti.TShortCut,"FShortCut","FShortCut",{Default:0}),e.addProperty("Visible",0,rtl.boolean,"FVisible","FVisible",{Default:!0}),e.addProperty("ElementClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","FElementClassName"),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick")})),this.$rtti.$Class("TMainMenuAppearance"),rtl.createClass(this,"THamburgerMenu",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FVisible=0,this.FCaption="",this.FBackgroundColor=0,this.FCaptionColor=0,this.FResponsiveMaxWidth=0},this.$final=function(){this.FOwner=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,this.FOwner.FOwner.UpdateElement())},this.SetBackgroundColor=function(t){this.FBackgroundColor!==t&&(this.FBackgroundColor=t,this.FOwner.FOwner.UpdateElement())},this.SetCaption=function(t){this.FCaption!==t&&(this.FCaption=t,this.FOwner.FOwner.UpdateElement())},this.SetCaptionColor=function(t){this.FCaptionColor!==t&&(this.FCaptionColor=t,this.FOwner.FOwner.UpdateElement())},this.SetResponsiveMaxWidth=function(t){this.FResponsiveMaxWidth!==t&&(this.FResponsiveMaxWidth=t,this.FOwner.FOwner.UpdateElement())},this.Create$1=function(t){return this.FBackgroundColor=12632256,this.FCaption="Menu",this.FCaptionColor=16777215,this.FVisible=2,this.FResponsiveMaxWidth=768,this.FOwner=t,this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)},this.Assign=function(e){pas.Classes.TPersistent.Assign.apply(this,arguments),t.THamburgerMenu.isPrototypeOf(e)&&(this.FBackgroundColor=rtl.as(e,t.THamburgerMenu).FBackgroundColor,this.FCaption=rtl.as(e,t.THamburgerMenu).FCaption,this.FCaptionColor=rtl.as(e,t.THamburgerMenu).FCaptionColor,this.FVisible=rtl.as(e,t.THamburgerMenu).FVisible,this.FResponsiveMaxWidth=rtl.as(e,t.THamburgerMenu).FResponsiveMaxWidth)},this.GetOwner=function(){return this.FOwner};var e=this.$rtti;e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("CaptionColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FCaptionColor","SetCaptionColor",{Default:16777215}),e.addProperty("BackgroundColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FBackgroundColor","SetBackgroundColor",{Default:12632256}),e.addProperty("Visible",2,t.$rtti.TMainMenuHamburgerMenuVisible,"FVisible","SetVisible",{Default:t.TMainMenuHamburgerMenuVisible.hmResponsive}),e.addProperty("ResponsiveMaxWidth",2,rtl.longint,"FResponsiveMaxWidth","SetResponsiveMaxWidth",{Default:768})})),rtl.createClass(this,"TMainMenuAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FBackgroundColor=0,this.FHoverFontColor=0,this.FHoverColor=0,this.FImageURLs=null,this.FHamburgerMenu=null,this.FImageSize=0,this.FSubmenuIndicator=""},this.$final=function(){this.FOwner=void 0,this.FImageURLs=void 0,this.FHamburgerMenu=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetBackgroundColor=function(t){this.FBackgroundColor!==t&&(this.FBackgroundColor=t,this.FOwner.UpdateElement())},this.SetHoverColor=function(t){this.FHoverColor!==t&&(this.FHoverColor=t,this.FOwner.UpdateElement())},this.SetHoverFontColor=function(t){this.FHoverFontColor!==t&&(this.FHoverFontColor=t,this.FOwner.UpdateElement())},this.SetImageURLs=function(t){this.FImageURLs.Assign(t)},this.SetImageSize=function(t){this.FImageSize!==t&&(this.FImageSize=t,this.FOwner.UpdateElement())},this.SetSubmenuIndicator=function(t){this.FSubmenuIndicator!==t&&(this.FSubmenuIndicator=t,this.FOwner.UpdateElement())},this.HandleImageURLsChanged=function(t){this.FOwner.UpdateElement()},this.Create$1=function(e){return this.FBackgroundColor=15790320,this.FHoverColor=14120960,this.FHoverFontColor=197379,this.FHamburgerMenu=t.THamburgerMenu.$create("Create$1",[this]),this.FImageURLs=pas.Classes.TStringList.$create("Create$1"),this.FImageURLs.SetSkipLastLineBreak(!0),this.FImageURLs.FOnChange=rtl.createCallback(this,"HandleImageURLsChanged"),this.FImageSize=16,this.FSubmenuIndicator="&#9658;",this.FOwner=e,this},this.Destroy=function(){rtl.free(this,"FHamburgerMenu"),rtl.free(this,"FImageURLs"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){pas.Classes.TPersistent.Assign.apply(this,arguments),t.TMainMenu.isPrototypeOf(e)&&(this.FBackgroundColor=rtl.as(e,t.TMainMenuAppearance).FBackgroundColor,this.FHoverColor=rtl.as(e,t.TMainMenuAppearance).FHoverColor,this.FHoverFontColor=rtl.as(e,t.TMainMenuAppearance).FHoverFontColor,this.FHamburgerMenu.Assign(rtl.as(e,t.TMainMenuAppearance).FHamburgerMenu),this.FImageURLs.Assign(rtl.as(e,t.TMainMenuAppearance).FImageURLs),this.FImageSize=rtl.as(e,t.TMainMenuAppearance).FImageSize,this.FSubmenuIndicator=rtl.as(e,t.TMainMenuAppearance).FSubmenuIndicator)},this.GetOwner=function(){return this.FOwner};var e=this.$rtti;e.addProperty("BackgroundColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FBackgroundColor","SetBackgroundColor",{Default:15790320}),e.addProperty("HamburgerMenu",0,t.$rtti.THamburgerMenu,"FHamburgerMenu","FHamburgerMenu"),e.addProperty("HoverColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FHoverColor","SetHoverColor",{Default:14120960}),e.addProperty("HoverFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FHoverFontColor","SetHoverFontColor",{Default:197379}),e.addProperty("ImageURLs",2,pas.Classes.$rtti.TStringList,"FImageURLs","SetImageURLs"),e.addProperty("ImageSize",2,rtl.longint,"FImageSize","SetImageSize",{Default:16}),e.addProperty("SubmenuIndicator",2,rtl.string,"FSubmenuIndicator","SetSubmenuIndicator")})),rtl.createClass(this,"TCustomMainMenu",pas["WEBLib.Controls"].TCustomControl,(function(){this.$init=function(){pas["WEBLib.Controls"].TCustomControl.$init.call(this),this.FItems=null,this.FOnChange=null},this.$final=function(){this.FItems=void 0,this.FOnChange=void 0,pas["WEBLib.Controls"].TCustomControl.$final.call(this)},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.IsUpdating()||null!=this.GetElementHandle()&&this.UpdateElement()},this.UpdateElement=function(){pas["WEBLib.Controls"].TControl.UpdateElement.call(this),this.IsUpdating()},this.GetUniqueName=function(t){var i="",s=0,n=0,o=!1;n=1,""===t&&(t=this.FName+"item"),t=e.MakeValidName(t);do{i=t+pas.SysUtils.IntToStr(n),o=!0;for(var r=0,a=this.FOwner.GetComponentCount()-1;r<=a;r++)if(s=r,this.FOwner.GetComponent(s).FName===i){o=!1,n+=1;break}}while(!o);return i},this.SetName=function(t){pas["WEBLib.Controls"].TCustomControl.SetName.apply(this,arguments),this.IsUpdating()||0 in this.FComponentState||this.UpdateElement()},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FItems=t.TMenuItem.$create("Create$1",[this]),this.FItems.FParentMenu=this,this.SetWidthStyle(2),this.SetHeight(30)},this.Destroy=function(){rtl.free(this,"FItems"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.SetChildOrder=function(t,e){var i;(i=this.FItems.FItems.IndexOf(t))>=0&&e<this.FItems.FItems.GetCount()&&this.FItems.FItems.Move(i,e)},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("Items",0,t.$rtti.TMenuItem,"FItems",""),i.addProperty("OnChange",0,t.$rtti.TMainMenuChangeEvent,"FOnChange","FOnChange")})),rtl.createClass(this,"TMainMenu",this.TCustomMainMenu,(function(){this.$init=function(){t.TCustomMainMenu.$init.call(this),this.FMenu=null,this.FMainMenu=!1,this.FMenuIndex=0,this.FAppearance=null,this.FContainer$1=null,this.FIsPopupMenu=!1,this.FShowPopup=!1},this.$final=function(){this.FMenu=void 0,this.FAppearance=void 0,this.FContainer$1=void 0,t.TCustomMainMenu.$final.call(this)},this.HandleChange=function(t){var e=null,i=null;return!0,this.FIsPopupMenu&&(this.FShowPopup=!1,this.UpdateElement()),(e=t.target).hasAttribute("id")||(e=e.parentElement),null!=(i=this.GetItemByName(this.FItems,e.id))&&(i.FAutoCheck&&i.SetChecked(!i.FChecked),null!=this.FOnChange&&this.FOnChange(this,i,!1),i.Click()),!0},this.Loaded=function(){t.TCustomMainMenu.Loaded.call(this),this.IsUpdating()||null!=this.GetElementHandle()&&this.UpdateElement()},this.UpdateElement=function(){var e,i="",s="",n="",o="",r="",a=null,l=null,h=null,F=null,p=null,c=null,u=null;t.TCustomMainMenu.UpdateElement.call(this),this.IsUpdating()||null==this.GetElementHandle()&&null==this.FContainer$1||(null!=this.FContainer$1?(a=this.FContainer$1.GetElementHandle(),this.SetVisible(!1)):((a=this.GetElementHandle()).style.setProperty("top",pas.SysUtils.IntToStr(this.GetTop())+"px"),a.style.setProperty("left",pas.SysUtils.IntToStr(this.GetLeft())+"px"),4 in this.FComponentState&&null==this.FContainer$1&&this.GetElementHandle().style.setProperty("background-color","silver")),this.FMenu=a.firstChild,null!=this.FMenu&&this.FMenu.parentElement.removeChild(this.FMenu),3 in this.FComponentState||(this.FMenu=document.createElement("NAV"),this.FMenu.setAttribute("id",this.GetID()+"menu"),this.FMenu.innerHTML="",null!=this.FContainer$1&&(this.FMenu.style.setProperty("top","0"),this.FMenu.style.setProperty("left","0"),this.FMenu.style.setProperty("position","absolute"),this.FMenu.style.setProperty("width","100%"),this.FMenu.style.setProperty("z-index","999997")),a.innerHTML="",a.style.setProperty("overflow","visible"),0!==this.FAppearance.FHamburgerMenu.FVisible&&(r=this.FShowPopup?"block":"none",n="  #"+this.GetID()+"menu .main-menu {\r    display: block;\r  }\r  #"+this.GetID()+"menu #toggle-menu {\r    display: none;\r  }\r  #"+this.GetID()+"menu ul span.drop-label {\r    display: inline-block;\r  }\r  #"+this.GetID()+"menu li {\r    float: left;\r    border-width: 0 1px 0 0;\r  }\r  #"+this.GetID()+"menu .popup-menu li, \r  #"+this.GetID()+"menu .sub-menu li {\r    float: none;\r  }\r  #"+this.GetID()+"menu .sub-menu {\r    top: 100%;\r  }\r  #"+this.GetID()+"menu .popup-menu { \r    top: 0;\r  }\r  #"+this.GetID()+"menu .popup-menu, \r  #"+this.GetID()+"menu .sub-menu {\r    border-width: 0;\r    margin: 0;\r    position: absolute;\r    left: 0;\r    min-width: 12em;\r    z-index: 9999999;\r\t   white-space: nowrap;\r  }\r  #"+this.GetID()+"menu .sub-menu {\r    top: 100%;\r  }\r  #"+this.GetID()+"menu .popup-menu { \r    display: "+r+";\r  }\r  #"+this.GetID()+"menu .sub-menu,\r  #"+this.GetID()+'menu input[type="checkbox"]:checked + .popup-menu,\r  #'+this.GetID()+'menu input[type="checkbox"]:checked + .sub-menu {\r    display: none;\r  }\r  #'+this.GetID()+"menu .popup-menu li, \r  #"+this.GetID()+"menu .sub-menu li {\r    border-width: 1px;\r  }\r  #"+this.GetID()+"menu .popup-menu .sub-menu, \r  #"+this.GetID()+"menu .sub-menu .sub-menu {\r    top: 0;\r    left: 100%;\r  }\r  #"+this.GetID()+'menu li:hover > input[type="checkbox"] + .popup-menu, \r  #'+this.GetID()+'menu li:hover > input[type="checkbox"] + .sub-menu {\r    display: block;\r  }\r',2===this.FAppearance.FHamburgerMenu.FVisible&&(n="@media only screen and (min-width: "+pas.SysUtils.IntToStr(this.FAppearance.FHamburgerMenu.FResponsiveMaxWidth)+"px) {\r"+n+"}")),this.FAppearance.FImageSize>0&&(o="  width: "+pas.SysUtils.IntToStr(this.FAppearance.FImageSize)+"px;\r  height: "+pas.SysUtils.IntToStr(this.FAppearance.FImageSize)+"px;\r"),i="#"+this.GetID()+"menu ul {\r  margin: 0;\r  padding: 0;\r}\r#"+this.GetID()+"menu .main-menu {\r  display: none;\r}\r#"+this.GetID()+"menu .popup-menu {\r  display: block;\r}\r#"+this.GetID()+"menu label img.icon,#"+this.GetID()+"menu label span.checked {\r"+o+"  margin-right: 10px;\r  pointer-events: none;\r}\r#tm:checked + .main-menu {\r  display: block;\r}\r#"+this.GetID()+'menu input[type="checkbox"],\r#'+this.GetID()+"menu ul span.drop-label {\r  display: none;\r}\r#"+this.GetID()+"menu li,\r#"+this.GetID()+"menu #toggle-menu,\r#"+this.GetID()+"menu .popup-menu,\r#"+this.GetID()+"menu .sub-menu {\r  border-width: 1px;\r  border-style: solid;\r  border-color: rgba(0, 0, 0, .05);\r  border-bottom: 0px;\r  border-top: 0px;\r}\r#"+this.GetID()+"menu li,\r#"+this.GetID()+"menu #toggle-menu {\r  border-width: 0 0 3px;\r}\r#"+this.GetID()+"menu .popup-menu,\r#"+this.GetID()+"menu .sub-menu {\r  border-width: 1px 1px 0;\r  margin: 0 1em;\r}\r#"+this.GetID()+"menu .popup-menu li:first-child,\r#"+this.GetID()+"menu .sub-menu li:first-child {\r  border-top: 1px solid;\r  border-color: rgba(0, 0, 0, .05);\r}\r#"+this.GetID()+"menu .popup-menu li:last-child,\r#"+this.GetID()+"menu .sub-menu li:last-child {\r  border-bottom: 1px solid;\r  border-color: rgba(0, 0, 0, .05);\r}\r#"+this.GetID()+"menu li,\r#"+this.GetID()+"menu #toggle-menu,\r#"+this.GetID()+"menu li label {\r  position: relative;\r  display: block;\r}\r#"+this.GetID()+"menu #toggle-menu,\r#"+this.GetID()+"menu li label { \r  padding: 0.75em 1.5em;\r  text-decoration: none;\r}\r#"+this.GetID()+"menu li span.menu-separator { \r  display: block;\r  width: 100%;\r  height: 1px;\r  background-color: rgba(0, 0, 0, .05);\r}\r#"+this.GetID()+"menu .popup-menu, \r#"+this.GetID()+"menu .sub-menu {\r  display: none;\r}\r#"+this.GetID()+'menu input[type="checkbox"]:checked + .popup-menu,\r#'+this.GetID()+'menu input[type="checkbox"]:checked + .sub-menu {\r  display: block;\r  z-index: 3000;\r}\r#'+this.GetID()+"menu span.drop-icon {\r  margin-left: 10px;}\r#"+this.GetID()+"menu span.hamburger-icon {\r  float: right;\r  padding: 0;\r  margin: 0;\r  font-weight: 900;\r}\r@media only screen and (max-width: 64em) and (min-width: 52.01em) {\r  #"+this.GetID()+"menu li {\r    width: auto;\r  }\r  #"+this.GetID()+"menu .sub-menu li {\r    width: auto;\r  }\r}\r",""===this.FElementClassName&&(s="#"+this.GetID()+"menu .popup-menu, \r#"+this.GetID()+"menu .sub-menu {\r  background-color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FBackgroundColor)+";\r}\r@media only screen and (max-width: 64em) and (min-width: 52.01em) {\r#"+this.GetID()+"menu .sub-menu {\r  background-color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHamburgerMenu.FBackgroundColor)+";\r}\r}\r#"+this.GetID()+"menu li,\r#"+this.GetID()+"menu #toggle-menu,\r#"+this.GetID()+"menu li label {\r}\r#"+this.GetID()+"menu #toggle-menu {\r  background-color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHamburgerMenu.FBackgroundColor)+";\r  color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHamburgerMenu.FCaptionColor)+";\r}\r#"+this.GetID()+"menu .main-menu li label {\r  background-color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FBackgroundColor)+";\r}\r#"+this.GetID()+"menu li label:hover {\r  background-color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHoverColor)+";\r  color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHoverFontColor)+";\r}\r#"+this.GetID()+"menu .popup-menu label:hover, \r#"+this.GetID()+"menu .sub-menu label:hover {\r  background-color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHoverColor)+";\r  color: "+pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHoverFontColor)+";\r}\r"),i=i+s+n,this.FMainMenu=!0,this.FMenuIndex=0,(c=document.createElement("STYLE")).innerHTML=i,(u=document.createElement("SCRIPT")).innerHTML="function "+this.GetID()+'MenuClick(ctrl){  el = ctrl.parentElement.parentElement;  el.style.display = "none";  setTimeout(function(){el.style.removeProperty("display")}, 25);}function '+this.GetID()+'MenuOut(ctrl){  menuel = document.getElementById("'+this.GetID()+'");  if(menuel) {     popupel = menuel.getElementsByClassName("popup-menu");    if(popupel)       setTimeout(function(){popupel[0].style.display = "none"}, 25);  }}',(l=document.createElement("LABEL")).setAttribute("for","tm"),l.setAttribute("id","toggle-menu"),l.innerHTML=this.FAppearance.FHamburgerMenu.FCaption,(h=document.createElement("SPAN")).setAttribute("class","drop-label"),l.appendChild(h),(F=document.createElement("SPAN")).setAttribute("class","hamburger-icon"),F.innerHTML="&#9776;",h.appendChild(F),(p=document.createElement("INPUT")).setAttribute("type","checkbox"),p.setAttribute("id","tm"),this.FMenu.appendChild(c),this.FMenu.appendChild(u),this.FMenu.appendChild(l),this.FMenu.appendChild(p),null!==(e=this.GetMenuSource(this.FItems))&&this.FMenu.appendChild(e),a.appendChild(this.FMenu)))},this.GetMenuSource=function(t){var i=null,s=0,n=null,o="",r=null,a=null,l=null,h=null,F=0,p="";if(i=null,null!=t.FItems&&t.FItems.GetCount()>0){i=document.createElement("UL"),this.FMainMenu?(this.FMainMenu=!1,o=this.FIsPopupMenu?"popup-menu":"main-menu"):o="sub-menu",this.FMenuIndex=this.FMenuIndex+1,i.setAttribute("class",o);for(var c=0,u=t.FItems.GetCount()-1;c<=u;c++)s=c,F+=1,""===(n=t.FItems.GetItem(s)).FName&&(p=pas.SysUtils.StringReplace(n.FCaption," ","",rtl.createSet(0)),""===(p=e.MakeValidName(p))&&(p="MenuItem"+pas.SysUtils.IntToStr(F)),n.SetName(p+pas.SysUtils.IntToStr(F))),n.FVisible&&(r=document.createElement("LI"),"-"!==n.FCaption?((a=document.createElement("LABEL")).setAttribute("class","drop-label"),a.setAttribute("title",n.FHint),n.FImageIndex>=0&&this.FAppearance.FImageURLs.GetCount()>n.FImageIndex?a.innerHTML='<img class="icon" src="'+this.FAppearance.FImageURLs.Get(n.FImageIndex)+'">':n.FChecked&&(n.FRadioItem?a.innerHTML='<span class="checked">&#9679;</span>':a.innerHTML='<span class="checked">&#10004;</span>'),a.innerHTML=a.innerHTML+n.FCaption):((a=document.createElement("SPAN")).setAttribute("class","menu-separator"),a.innerHTML=""),null!=n.FItems&&n.FItems.GetCount()>0?((h=document.createElement("SPAN")).setAttribute("class","drop-icon"),h.innerHTML=this.FAppearance.FSubmenuIndicator,a.setAttribute("for","sm"+pas.SysUtils.IntToStr(this.FMenuIndex)),a.appendChild(h),(l=document.createElement("INPUT")).setAttribute("type","checkbox"),l.setAttribute("id","sm"+pas.SysUtils.IntToStr(this.FMenuIndex)),r.appendChild(a),r.appendChild(l),r.appendChild(this.GetMenuSource(n))):(a.setAttribute("for","tm"),a.setAttribute("id",n.FName),n.FEnabled?("sub-menu"===o&&n.FEnabled&&a.setAttribute("onMouseUp",this.GetID()+"MenuClick(this);"),a.addEventListener("click",rtl.createSafeCallback(this,"HandleChange"))):a.style.setProperty("color","gray"),r.appendChild(a)),i.appendChild(r))}return i},this.GetItemByName=function(t,e){var i=null,s=0,n=null;if(i=null,null!=t.FItems)for(var o=0,r=t.FItems.GetCount()-1;o<=r;o++){if(s=o,(n=t.FItems.GetItem(s)).FName===e)return i=n,null!=n.FOnClick&&(i.FOnClick=n.FOnClick),i;null==i&&(i=this.GetItemByName(n,e))}return i},this.CreateInitialize=function(){t.TCustomMainMenu.CreateInitialize.call(this),this.FAppearance=t.TMainMenuAppearance.$create("Create$1",[this]),this.FContainer$1=null,this.FMainMenu=!0,this.FMenuIndex=0,this.FIsPopupMenu=!1,this.FShowPopup=!1,this.SetTop(0),this.SetLeft(0),this.SetWidth(100),4 in this.FComponentState&&(this.SetElementPosition(1),this.SetWidthPercent(100),this.SetWidthStyle(0))},this.CreateElement=function(){var t=null,e=null;return 4 in this.FComponentState?(t=document.createElement("DIV"),(e=document.createElement("DIV")).innerHTML="TWebMainMenu",this.SetBorderStyle(1),e.setAttribute("align","center"),e.style.setProperty("border","1px solid gray"),e.style.setProperty("vertical-align","middle"),e.style.setProperty("display","table-cell"),t.appendChild(e)):(t=document.createElement("DIV"),this.FIsPopupMenu&&t.setAttribute("onMouseLeave",this.GetID()+"MenuOut(this);")),t},this.Destroy=function(){rtl.free(this,"FAppearance"),t.TCustomMainMenu.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("Appearance",0,t.$rtti.TMainMenuAppearance,"FAppearance","FAppearance"),i.addProperty("Container",0,pas["WEBLib.Controls"].$rtti.TControl,"FContainer$1","FContainer$1")})),rtl.createClass(this,"TPopupMenu",this.TMainMenu,(function(){this.CreateInitialize=function(){t.TMainMenu.CreateInitialize.call(this),this.FAppearance.FHamburgerMenu.SetVisible(1),this.FIsPopupMenu=!0},this.Popup=function(t,e){this.SetTop(e),this.SetLeft(t),this.FShowPopup=!0,this.UpdateElement(),this.FShowPopup=!1},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TWebPopupMenu",this.TPopupMenu,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TWebCustomControl",pas["WEBLib.Controls"].TCustomControl,(function(){this.$init=function(){pas["WEBLib.Controls"].TCustomControl.$init.call(this),this.FPopupMenu=null},this.$final=function(){this.FPopupMenu=void 0,pas["WEBLib.Controls"].TCustomControl.$final.call(this)},this.HandleDoContextMenu=function(t){var e=!1,i=pas.Types.TPoint.$new(),s=null,n=null;return pas["WEBLib.Controls"].TControl.HandleDoContextMenu.apply(this,arguments),null!=this.FPopupMenu&&(t.stopPropagation(),t.preventDefault(),i.$assign(pas.Types.Point(Math.round(t.clientX),Math.round(t.clientY))),null!=(s=pas["WEBLib.Forms"].GetParentForm(this))&&null!=s.GetContainer()&&(n=s.GetContainer().getBoundingClientRect(),i.x=i.x-Math.round(n.left),i.y=i.y-Math.round(n.top)),this.FPopupMenu.Popup(i.x,i.y),e=!0),e},this.Notification=function(t,e){pas.Classes.TComponent.Notification.apply(this,arguments),1===e&&t===this.FPopupMenu&&(this.FPopupMenu=null)},rtl.addIntf(this,pas.System.IUnknown)})),t.$implcode=function(){var t=rtl.createSet(null,65,90,null,97,122,95),i=rtl.unionSet(t,rtl.createSet(null,48,57));e.MakeValidName=function(t){var e="",s=0;e="";for(var n=1,o=t.length;n<=o;n++)s=n,t.charCodeAt(s-1)in i&&(e+=t.charAt(s-1));return e}}}),["Types","WEBLib.Forms"]),rtl.module("Rtl.BrowserLoadHelper",["System","Classes","SysUtils","JS","Web"],(function(){"use strict";var t=this;rtl.createClass(this,"TBrowserLoadHelper",pas.Classes.TLoadHelper,(function(){})),t.$init=function(){pas.Classes.SetLoadHelperClass(t.TBrowserLoadHelper)}})),rtl.module("WEBLib.JSON",["System","Classes","Web","JS","SysUtils"],(function(){"use strict";var t=this;rtl.createClass(this,"TJSONAncestor",pas.System.TObject,(function(){this.GetStrValue=function(){return"",""},this.SetStrValue=function(t){}})),rtl.createClass(this,"TJSONValue",this.TJSONAncestor,(function(){this.$init=function(){t.TJSONAncestor.$init.call(this),this.fjv=void 0,this.fjo=void 0},this.GetStrValue=function(){return""+this.fjv},this.JSONValueFromJS=function(e){var i=null,s=0;return i=null,rtl.isArray(e)?(i=t.TJSONArray.$create("Create"),rtl.as(i,t.TJSONArray).fja=e):rtl.isObject(e)?(i=t.TJSONObject.$create("Create$2"),rtl.as(i,t.TJSONObject).fjo$1=e):rtl.isString(e)?(i=t.TJSONString.$create("Create"),rtl.as(i,t.TJSONString).SetStrValue(""+e)):rtl.isNumber(e)?(i=t.TJSONNumber.$create("Create"),rtl.as(i,t.TJSONNumber).SetStrValue(""+e),s=rtl.getNumber(e),rtl.as(i,t.TJSONNumber).FDouble=s,0===pas.System.Frac(s)&&(rtl.as(i,t.TJSONNumber).FInt=rtl.trunc(e))):pas.JS.isNull(e)?i=t.TJSONNull.$create("Create"):pas.JS.isBoolean(e)&&(i=pas.JS.toBoolean(e)?t.TJSONTrue.$create("Create"):t.TJSONFalse.$create("Create")),null==i&&(i=t.TJSONNull.$create("Create")),i.fjv=e,i},this.ToString=function(){return JSON.stringify(this.fjv)}})),rtl.createClass(this,"TJSONPair",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.fjo=void 0,this.fjv=null,this.fjs=null},this.$final=function(){this.fjv=void 0,this.fjs=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.fjs=t.TJSONString.$create("Create"),this},this.Destroy=function(){rtl.free(this,"fjs"),pas.System.TObject.Destroy.call(this)},this.ToString=function(){return t.TJSONObject.isPrototypeOf(this.fjv)?'"'+this.fjs.GetStrValue()+'":'+rtl.as(this.fjv,t.TJSONObject).ToJSON():null!==this.fjs&&null!==this.fjv?'"'+this.fjs.GetStrValue()+'":'+this.fjv.ToString():""}})),rtl.createClass(this,"TJSONPairList",pas.Classes.TList,(function(){})),rtl.createClass(this,"TJSONObject",this.TJSONValue,(function(){this.$init=function(){t.TJSONValue.$init.call(this),this.fjo$1=null,this.FMembers=null},this.$final=function(){this.fjo$1=void 0,this.FMembers=void 0,t.TJSONValue.$final.call(this)},this.GetCount=function(){return null!=this.fjo$1?rtl.length(Object.keys(this.fjo$1)):null!=this.FMembers?this.FMembers.GetCount():0},this.GetItem=function(t){var e;return e=this.fjo$1[Object.keys(this.fjo$1)[t]],this.$class.JSONValueFromJS(e)},this.Create$2=function(){return pas.System.TObject.Create.call(this),this.FMembers=t.TJSONPairList.$create("Create$1"),this.fjo$1=null,this},this.Destroy=function(){rtl.free(this,"FMembers"),pas.System.TObject.Destroy.call(this)},this.ParseJSONValue=function(t){var e;return e=JSON.parse(t),this.JSONValueFromJS(e)},this.Get=function(e){var i=null,s=void 0,n=null,o=0,r=null;if(i=null,null!=this.fjo$1)null!=(s=this.fjo$1[e])&&(i=t.TJSONPair.$create("Create$1"),n=this.$class.JSONValueFromJS(s),i.fjo=this.fjo$1,i.fjs.SetStrValue(e),i.fjv=n);else for(var a=0,l=this.FMembers.GetCount()-1;a<=l;a++)o=a,(r=rtl.getObject(this.FMembers.Get(o))).fjs.ToString()==='"'+e+'"'&&(i=r);return i},this.Get$1=function(t){return this.Get(Object.keys(this.fjo$1)[t])},this.ToJSON=function(){var t="",e=0,i=0,s=null;t="{",(e=null!=this.fjo$1?this.GetCount():this.FMembers.GetCount())>0&&(null!=this.fjo$1?null!=(s=this.Get$1(0))?t+=s.ToString():t=t+'"'+Object.keys(this.fjo$1)[0]+'":null':t+=rtl.getObject(this.FMembers.Get(0)).ToString());for(var n=1,o=e-1;n<=o;n++)i=n,t=null!=this.fjo$1?null!=(s=this.Get$1(i))?t+","+s.ToString():t+',"'+Object.keys(this.fjo$1)[i]+'":null':t+","+rtl.getObject(this.FMembers.Get(i)).ToString();return t+="}"},this.ToString=function(){return this.ToJSON()}})),rtl.createClass(this,"TJSONString",this.TJSONValue,(function(){this.$init=function(){t.TJSONValue.$init.call(this),this.FValue=""},this.GetStrValue=function(){return this.FValue},this.SetStrValue=function(t){if(this.FValue=t,this.fjv=t,pas.System.Assigned(this.fjo)){var e=Object.keys(this.fjo)[0];this.fjo[e]=t}}})),rtl.createClass(this,"TJSONNumber",this.TJSONString,(function(){this.$init=function(){t.TJSONString.$init.call(this),this.FInt=0,this.FDouble=0},this.GetStrValue=function(){return pas.SysUtils.FloatToStr$1(this.FDouble,pas.SysUtils.TFormatSettings.Invariant())},this.SetStrValue=function(t){this.FDouble=pas.SysUtils.StrToFloat$1(t,pas.SysUtils.TFormatSettings.Invariant()),0===pas.System.Frac(this.FDouble)?(pas.SysUtils.TryStrToInt$1(t,{p:this,get:function(){return this.p.FInt},set:function(t){this.p.FInt=t}},pas.SysUtils.TFormatSettings.Invariant())||(this.FInt=0),this.fjv=this.FInt):this.fjv=this.FDouble}})),rtl.createClass(this,"TJSONTrue",this.TJSONValue,(function(){this.GetStrValue=function(){return"true","true"},this.ToString=function(){return this.GetStrValue()}})),rtl.createClass(this,"TJSONFalse",this.TJSONValue,(function(){this.GetStrValue=function(){return"false","false"},this.ToString=function(){return this.GetStrValue()}})),rtl.createClass(this,"TJSONNull",this.TJSONValue,(function(){this.GetStrValue=function(){return"null","null"},this.ToString=function(){return this.GetStrValue()}})),rtl.createClass(this,"TJSONArray",this.TJSONValue,(function(){this.$init=function(){t.TJSONValue.$init.call(this),this.fja=null},this.$final=function(){this.fja=void 0,t.TJSONValue.$final.call(this)},this.GetItem=function(e){var i;return i=this.GetJA()[e],rtl.isExt(i,t.TJSONObject,1)||rtl.isExt(i,t.TJSONArray,1)?rtl.getObject(i):this.$class.JSONValueFromJS(i)},this.GetCount=function(){return this.GetJA().length},this.GetJA=function(){return null==this.fja&&(this.fja=new Array),this.fja},this.ToString=function(){var e="",i=0,s=null,n="";e="[",n="";for(var o=0,r=this.GetCount()-1;o<=r;o++)i=o,null!=(s=this.GetItem(i))&&(e=t.TJSONObject.isPrototypeOf(s)?e+n+rtl.as(s,t.TJSONObject).ToString():e+n+s.ToString(),n=",");return e+="]"}}))})),rtl.module("WEBLib.Forms",["System","Classes","Types","SysUtils","WEBLib.Graphics","WEBLib.Controls","WEBLib.Modules","WEBLib.Lang","WEBLib.Menus","Web","JS","Rtl.BrowserLoadHelper"],(function(){"use strict";var t=this,e=t.$impl;this.idOK=1,this.idCancel=2,this.idAbort=3,this.idRetry=4,this.idIgnore=5,this.idYes=6,this.idNo=7,this.idClose=8,this.idHelp=9,this.idContinue=11,this.mrNone=0,this.mrOk=1,this.mrCancel=2,this.mrAbort=3,this.mrRetry=4,this.mrIgnore=5,this.mrYes=6,this.mrNo=7,this.mrClose=8,this.mrHelp=9,this.mrContinue=11,this.mrAll=12,this.mrNoToAll=13,this.mrYesToAll=14,this.rgiFirst=-1024,this.igiLast=511,this.clTMSBlue=14917120,this.$rtti.$Int("TConstraintSize",{minvalue:0,maxvalue:2147483647,ordtype:5}),this.TCloseAction={0:"caNone",caNone:0,1:"caHide",caHide:1,2:"caFree",caFree:2,3:"caMinimize",caMinimize:3},this.$rtti.$Enum("TCloseAction",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TCloseAction}),this.TFormStyle={0:"fsNormal",fsNormal:0,1:"fsStayOnTop",fsStayOnTop:1},this.$rtti.$Enum("TFormStyle",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TFormStyle}),this.$rtti.$Int("TGestureID",{minvalue:-1024,maxvalue:511,ordtype:2}),this.TInteractiveGestureFlag={0:"gfBegin",gfBegin:0,1:"gfInertia",gfInertia:1,2:"gfEnd",gfEnd:2},this.$rtti.$Enum("TInteractiveGestureFlag",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TInteractiveGestureFlag}),this.$rtti.$Set("TInteractiveGestureFlags",{comptype:this.$rtti.TInteractiveGestureFlag}),this.TMouseActivate={0:"maDefault",maDefault:0,1:"maActivate",maActivate:1,2:"maActivateAndEat",maActivateAndEat:2,3:"maNoActivate",maNoActivate:3,4:"maNoActivateAndEat",maNoActivateAndEat:4},this.$rtti.$Enum("TMouseActivate",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TMouseActivate}),this.TScreenOrientation={0:"soPortrait",soPortrait:0,1:"soLandscape",soLandscape:1},this.$rtti.$Enum("TScreenOrientation",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TScreenOrientation}),this.TApplicationColorScheme={0:"csNoScheme",csNoScheme:0,1:"csLight",csLight:1,2:"csDark",csDark:2},rtl.recNewT(this,"TSmallPoint",(function(){this.x=0,this.y=0,this.$eq=function(t){return this.x===t.x&&this.y===t.y},this.$assign=function(t){return this.x=t.x,this.y=t.y,this};var e=t.$rtti.$Record("TSmallPoint",{});e.addField("x",rtl.smallint),e.addField("y",rtl.smallint)})),rtl.recNewT(this,"TAlignInfo",(function(){this.AlignList=null,this.ControlIndex=0,this.Align=0,this.Scratch=0,this.$eq=function(t){return this.AlignList===t.AlignList&&this.ControlIndex===t.ControlIndex&&this.Align===t.Align&&this.Scratch===t.Scratch},this.$assign=function(t){return this.AlignList=t.AlignList,this.ControlIndex=t.ControlIndex,this.Align=t.Align,this.Scratch=t.Scratch,this};var e=t.$rtti.$Record("TAlignInfo",{});e.addField("AlignList",pas.Classes.$rtti.TList),e.addField("ControlIndex",rtl.longint),e.addField("Align",pas["WEBLib.Controls"].$rtti.TAlign),e.addField("Scratch",rtl.longint)})),rtl.recNewT(this,"TGestureEventInfo",(function(){this.GestureID=0,this.Angle=0,this.Distance=0,this.$new=function(){var e=Object.create(this);return e.Location=pas.Types.TPoint.$new(),e.Flags={},e.InertiaVector=t.TSmallPoint.$new(),e.TapLocation=t.TSmallPoint.$new(),e},this.$eq=function(t){return this.GestureID===t.GestureID&&this.Location.$eq(t.Location)&&rtl.eqSet(this.Flags,t.Flags)&&this.Angle===t.Angle&&this.InertiaVector.$eq(t.InertiaVector)&&this.Distance===t.Distance&&this.TapLocation.$eq(t.TapLocation)},this.$assign=function(t){return this.GestureID=t.GestureID,this.Location.$assign(t.Location),this.Flags=rtl.refSet(t.Flags),this.Angle=t.Angle,this.InertiaVector.$assign(t.InertiaVector),this.Distance=t.Distance,this.TapLocation.$assign(t.TapLocation),this};var e=t.$rtti.$Record("TGestureEventInfo",{});e.addField("GestureID",t.$rtti.TGestureID),e.addField("Location",pas.Types.$rtti.TPoint),e.addField("Flags",t.$rtti.TInteractiveGestureFlags),e.addField("Angle",rtl.double),e.addField("InertiaVector",t.$rtti.TSmallPoint),e.addField("Distance",rtl.longint),e.addField("TapLocation",t.$rtti.TSmallPoint)})),this.$rtti.$MethodVar("TCloseEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Action",this.$rtti.TCloseAction,1]]),methodkind:0}),this.$rtti.$MethodVar("TCloseQueryEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["CanClose",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TOrientationChangeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AOrientation",this.$rtti.TScreenOrientation]]),methodkind:0}),this.$rtti.$MethodVar("TBeforeUnloadEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AMessage",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TAlignInsertBeforeEvent",{procsig:rtl.newTIProcSig([["Sender",pas["WEBLib.Controls"].$rtti.TWinControl],["C1",pas["WEBLib.Controls"].$rtti.TControl],["C2",pas["WEBLib.Controls"].$rtti.TControl]],rtl.boolean),methodkind:1}),this.$rtti.$MethodVar("TAlignPositionEvent",{procsig:rtl.newTIProcSig([["Sender",pas["WEBLib.Controls"].$rtti.TWinControl],["Control",pas["WEBLib.Controls"].$rtti.TControl],["NewLeft",rtl.longint,1],["NewTop",rtl.longint,1],["NewWidth",rtl.longint,1],["NewHeight",rtl.longint,1],["AlignRect",pas.Types.$rtti.TRect,1],["AlignInfo",this.$rtti.TAlignInfo]]),methodkind:0}),this.$rtti.$MethodVar("TCanResizeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["NewWidth",rtl.longint,1],["NewHeight",rtl.longint,1],["Resize",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TConstrainedResizeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["MinWidth",rtl.longint,1],["MinHeight",rtl.longint,1],["MaxWidth",rtl.longint,1],["MaxHeight",rtl.longint,1]]),methodkind:0}),this.$rtti.$MethodVar("TContextPopupEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["MousePos",pas.Types.$rtti.TPoint],["Handled",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TDockDropEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Source",this.$rtti.TDragDockObject],["X",rtl.longint],["Y",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TDockOverEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Source",this.$rtti.TDragDockObject],["X",rtl.longint],["Y",rtl.longint],["State",pas["WEBLib.Controls"].$rtti.TDragState],["Accept",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TGestureEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["EventInfo",this.$rtti.TGestureEventInfo,2],["Handled",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TGetSiteInfoEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["DockClient",pas["WEBLib.Controls"].$rtti.TControl],["InfluenceRect",pas.Types.$rtti.TRect,1],["MousePos",pas.Types.$rtti.TPoint],["CanDock",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TMouseActivateEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Button",pas["WEBLib.Controls"].$rtti.TMouseButton],["Shift",pas.Classes.$rtti.TShiftState],["X",rtl.longint],["Y",rtl.longint],["HitTest",rtl.longint],["MouseActivate",this.$rtti.TMouseActivate,1]]),methodkind:0}),this.$rtti.$MethodVar("TMouseWheelUpDownEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Shift",pas.Classes.$rtti.TShiftState],["MousePos",pas.Types.$rtti.TPoint],["Handled",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TStartDockEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["DragObject",this.$rtti.TDragDockObject,1]]),methodkind:0}),this.$rtti.$MethodVar("TUnDockEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Client",pas["WEBLib.Controls"].$rtti.TControl],["NewTarget",pas["WEBLib.Controls"].$rtti.TWinControl],["Allow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("THashChangeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["oldURL",rtl.string],["newURL",rtl.string]]),methodkind:0}),this.TPopupMode={0:"pmNone",pmNone:0,1:"pmAuto",pmAuto:1,2:"pmExplicit",pmExplicit:2},this.TPopupClose={0:"pcOnDeactivate",pcOnDeactivate:0,1:"pcNever",pcNever:1},this.TPosition={0:"poDesigned",poDesigned:0,1:"poDefault",poDefault:1,2:"poDefaultPosOnly",poDefaultPosOnly:2,3:"poDefaultSizeOnly",poDefaultSizeOnly:3,4:"poScreenCenter",poScreenCenter:4,5:"poDesktopCenter",poDesktopCenter:5,6:"poMainFormCenter",poMainFormCenter:6,7:"poOwnerFormCenter",poOwnerFormCenter:7},this.TApplicationErrorType={0:"aeSilent",aeSilent:0,1:"aeDialog",aeDialog:1,2:"aeAlert",aeAlert:2,3:"aeFooter",aeFooter:3},this.TFormBorderStyle={0:"fbNone",fbNone:0,1:"fbSingle",fbSingle:1,2:"fbSizeable",fbSizeable:2,3:"fbDialog",fbDialog:3,4:"fbDialogSizeable",fbDialogSizeable:4},this.TCSSLibrary={0:"cssNone",cssNone:0,1:"cssBootstrap",cssBootstrap:1},this.$rtti.$Enum("TCSSLibrary",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TCSSLibrary}),rtl.createClass(this,"TCustomSizeConstraints",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FControl=null,this.FMaxHeight=0,this.FMaxWidth=0,this.FMinHeight=0,this.FMinWidth=0,this.FOnChange=null},this.$final=function(){this.FControl=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetConstraints=function(t,e){var i=t;0===i?e!==this.FMaxHeight&&(this.FMaxHeight=e,e>0&&e<this.FMinHeight&&(this.FMinHeight=e),this.Change()):1===i?e!==this.FMaxWidth&&(this.FMaxWidth=e,e>0&&e<this.FMinWidth&&(this.FMinWidth=e),this.Change()):2===i?e!==this.FMinHeight&&(this.FMinHeight=e,this.FMaxHeight>0&&e>this.FMaxHeight&&(this.FMaxHeight=e),this.Change()):3===i&&e!==this.FMinWidth&&(this.FMinWidth=e,this.FMaxWidth>0&&e>this.FMaxWidth&&(this.FMaxWidth=e),this.Change())},this.Change=function(){null!=this.FOnChange&&this.FOnChange(this)},this.AssignTo=function(e){t.TCustomSizeConstraints.isPrototypeOf(e)?(e.FMinHeight=this.FMinHeight,e.FMaxHeight=this.FMaxHeight,e.FMinWidth=this.FMinWidth,e.FMaxWidth=this.FMaxWidth,e.Change()):pas.Classes.TPersistent.AssignTo.call(this,e)},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.FControl=t,this}})),rtl.createClass(this,"TSizeConstraints",this.TCustomSizeConstraints,(function(){var e=this.$rtti;e.addProperty("MaxHeight",18,t.$rtti.TConstraintSize,"FMaxHeight","SetConstraints",{index:0,Default:0}),e.addProperty("MaxWidth",18,t.$rtti.TConstraintSize,"FMaxWidth","SetConstraints",{index:1,Default:0}),e.addProperty("MinHeight",18,t.$rtti.TConstraintSize,"FMinHeight","SetConstraints",{index:2,Default:0}),e.addProperty("MinWidth",18,t.$rtti.TConstraintSize,"FMinWidth","SetConstraints",{index:3,Default:0})})),rtl.createClass(this,"TDragDockObject",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FBrush=null},this.$final=function(){this.FBrush=void 0,pas.System.TObject.$final.call(this)},this.Destroy=function(){rtl.free(this,"FBrush"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TCustomForm",pas["WEBLib.Controls"].TWinControl,(function(){this.$init=function(){pas["WEBLib.Controls"].TWinControl.$init.call(this),this.FDesignContainer=null,this.FLayer$1=null,this.FPopup=!1,this.FPopupElement=null,this.FFormFileName="",this.FFormContainer="",this.FFormElement="",this.FFormStyle=0,this.FOnCreate=null,this.FOnShow=null,this.FModalResult=0,this.FOnPaint=null,this.FOnDeactivate=null,this.FOnCloseQuery=null,this.FOnClose=null,this.FModalProc=null,this.FCreatedProc=null,this.FCaption="",this.FIsResizing$1=!1,this.FOnScroll=null,this.FOnUnload=null,this.FOnBeforeUnload=null,this.FPopupMode=0,this.FPopupClose=0,this.FPosition=0,this.FActiveControl=null,this.FMdx=0,this.FMdy=0,this.FDlgX=0,this.FDlgY=0,this.FCaptured$1=!1,this.FDown=!1,this.FHasCaption=!1,this.FMoveSpan=null,this.FCaptionElement=null,this.FCaptionCloseElement=null,this.FBorder=0,this.FShadow=!1,this.FTimerID=0,this.FOrigWidth=0,this.FOrigHeight=0,this.FOldWidth=0,this.FOldHeight=0,this.FOnDestroy=null,this.FPopupOpacity=0,this.FCreating=!1,this.FLoadedPtr=null,this.FDOMContentLoadedPtr=null,this.FUnloadPtr=null,this.FBeforeUnloadPtr=null,this.FResizePtr=null,this.FScrollPtr=null,this.FDocMouseUpPtr=null,this.FDocMouseMovePtr=null,this.FTitleDownPtr=null,this.FDoClickPtr=null,this.FKeyDownPtr$1=null,this.FOrientationChangePtr=null,this.FHashChangePtr=null,this.FCSSLibrary=0,this.FNoHTML=!1,this.FPrevActiveForm=null,this.FElementCaptionClassName="",this.FMenu=null,this.FResizeObserver=null,this.FOnOrientationChange=null,this.FOnDOMContentLoaded=null,this.FShowClose=!1,this.FOnHashChange=null},this.$final=function(){this.FDesignContainer=void 0,this.FLayer$1=void 0,this.FPopupElement=void 0,this.FOnCreate=void 0,this.FOnShow=void 0,this.FOnPaint=void 0,this.FOnDeactivate=void 0,this.FOnCloseQuery=void 0,this.FOnClose=void 0,this.FModalProc=void 0,this.FCreatedProc=void 0,this.FOnScroll=void 0,this.FOnUnload=void 0,this.FOnBeforeUnload=void 0,this.FActiveControl=void 0,this.FMoveSpan=void 0,this.FCaptionElement=void 0,this.FCaptionCloseElement=void 0,this.FOnDestroy=void 0,this.FPrevActiveForm=void 0,this.FMenu=void 0,this.FResizeObserver=void 0,this.FOnOrientationChange=void 0,this.FOnDOMContentLoaded=void 0,this.FOnHashChange=void 0,pas["WEBLib.Controls"].TWinControl.$final.call(this)},this.SetModalResult=function(t){this.FModalResult=t,0!==this.FModalResult&&this.Close()},this.GetFormStyle=function(){return this.FFormStyle},this.SetFormStyle=function(t){this.FFormStyle=t},this.GetCanvas=function(){return null,null},this.SetCaption=function(t){this.FCaption!==t&&(this.FCaption=t,this.UpdateElement())},this.SetShadow=function(t){this.FShadow!==t&&(this.FShadow=t,this.UpdateElement())},this.SetBorder=function(t){this.FBorder!==t&&(this.FBorder=t,null!=this.GetContainer()&&this.AlignControl(this))},this.SetFormContainer=function(t){var e,i=null,s=0;if(e=this.GetContainer(),4 in this.FComponentState?this.FFormContainer=t:"BODY"===pas.SysUtils.UpperCase(t)?this.FFormContainer="":this.FFormContainer=t,(!(0 in this.FComponentState)||4 in this.FComponentState)&&(null!=this.FLayer$1?i=this.FLayer$1:(""===t||null==(i=document.getElementById(t)))&&(i=document.body),null!=i&&(this.FContainer=i,null!=e)))for(var n=0,o=this.GetControlsCount()-1;n<=o;n++)s=n,this.GetControls(s).FParentElement===e&&(this.GetControls(s).FParentElement=i),null!=this.GetControls(s).GetElementHandle()&&this.GetControls(s).GetElementHandle().parentElement===e&&i.appendChild(this.GetControls(s).GetElementHandle())},this.GetActiveControl=function(){var t=null,e=0;t=this.FActiveControl;for(var i=0,s=this.GetControlsCount()-1;i<=s;i++)if(e=i,this.GetControls(e).GetElementHandle()===document.activeElement){t=this.GetControls(e);break}return t},this.SetWidth=function(t){var e=null;0 in this.FComponentState&&""!==this.FFormContainer||!this.FPopup&&null==this.GetElementHandle()?this.SetWidthInt(t):(pas["WEBLib.Controls"].TControl.SetWidth.apply(this,arguments),this.FPopup&&null!=(e=this.FPopupElement)&&e.style.setProperty("width",pas.SysUtils.IntToStr(t)+"px"))},this.SetHeight=function(t){var e=null;0 in this.FComponentState&&""!==this.FFormContainer||!this.FPopup&&null==this.GetElementHandle()?this.SetHeightInt(t):(pas["WEBLib.Controls"].TControl.SetHeight.apply(this,arguments),this.FPopup&&null!=(e=this.FPopupElement)&&e.style.setProperty("height",pas.SysUtils.IntToStr(t)+"px"))},this.SetPosition=function(t){this.FPosition=t},this.HandleHashChange=function(t){var e,i;return e=t.oldURL,i=t.newURL,null!=this.FOnHashChange&&this.FOnHashChange(this,e,i),!0,!0},this.HandleLoaded=function(t){return this.Resize$1(),this.InitAnchoring(),!0,!0},this.HandleDOMContentLoaded=function(t){return null!=this.FOnDOMContentLoaded&&this.FOnDOMContentLoaded(this),!0,!0},this.HandleScroll=function(t){return null!=this.FOnScroll&&this.FOnScroll(this),!0,!0},this.HandleUnload=function(t){return null!=this.FOnUnload&&this.FOnUnload(this),!0,!0},this.HandleBeforeUnload=function(t){var e="";return e="",null!=this.FOnBeforeUnload&&this.FOnBeforeUnload(this,{get:function(){return e},set:function(t){e=t}}),""!==e?(t.returnValue=e,e):(!0,!0)},this.HandleObserver=function(){return this.Resize$1(),!0,!0},this.HandleResize=function(t){return this.FVisible&&(null==this.GetContainer()&&this.CreateControl(),this.Resize$1()),!0,!0},this.HandleDocMouseMove=function(t){var e=0,i=0,s=null,n=0,o=0;return this.FDown&&null!=this.GetContainer()&&(e=t.screenX-this.FMdx,i=t.screenY-this.FMdy,(s=this.FHasCaption&&""!==this.FFormFileName?this.GetContainer().parentNode:this.GetContainer()).style.setProperty("transform",""),s.style.setProperty("position","absolute"),n=Math.round(this.FDlgX+e),o=Math.round(this.FDlgY+i),s.style.setProperty("left",pas.SysUtils.IntToStr(n)+"px"),s.style.setProperty("top",pas.SysUtils.IntToStr(o)+"px"),this.FLeft=n,this.FTop=o),!0,!0},this.HandleDocMouseUp=function(t){return this.FDown&&(this.FCaptured$1=!1,this.FDown=!1,document.body.removeEventListener("mousemove",this.FDocMouseMovePtr),document.body.removeEventListener("mouseup",this.FDocMouseUpPtr),null!=this.FMoveSpan&&document.body.removeChild(this.FMoveSpan),this.FEventStopPropagation=rtl.unionSet(this.FEventStopPropagation,rtl.createSet(3,2)),this.FMoveSpan=null),!0,!0},this.HandleTitleDown=function(t){var e=null;return t.stopPropagation(),t.preventDefault(),this.FPopupClose=1,this.FMdx=Math.round(t.screenX),this.FMdy=Math.round(t.screenY),e=this.FHasCaption&&""!==this.FFormFileName?this.GetContainer().parentNode.getBoundingClientRect():this.GetContainer().getBoundingClientRect(),this.FDlgX=Math.round(pas.System.Int(e.left)),this.FDlgY=Math.round(pas.System.Int(e.top)),this.FDown=!0,this.FCaptured$1||(this.FCaptured$1=!0,this.FMoveSpan=document.createElement("SPAN"),this.FMoveSpan.style.setProperty("top","0"),this.FMoveSpan.style.setProperty("left","0"),this.FMoveSpan.style.setProperty("right","0"),this.FMoveSpan.style.setProperty("bottom","0"),this.FMoveSpan.style.setProperty("position","absolute"),document.body.appendChild(this.FMoveSpan),this.FEventStopPropagation=rtl.diffSet(this.FEventStopPropagation,rtl.createSet(3,2)),document.body.addEventListener("mousemove",this.FDocMouseMovePtr),document.body.addEventListener("mouseup",this.FDocMouseUpPtr)),!0,!0},this.HandleCloseClick=function(t){var e=!1;return e=!0,null!=this.FOnCloseQuery&&this.FOnCloseQuery(this,{get:function(){return e},set:function(t){e=t}}),e&&this.Close(),!0,!0},this.SetLeft=function(t){var e=null;pas["WEBLib.Controls"].TControl.SetLeft.apply(this,arguments),this.FPopup&&null!=(e=this.FPopupElement)&&e.style.setProperty("left",pas.SysUtils.IntToStr(t)+"px")},this.SetTop=function(t){var e=null;pas["WEBLib.Controls"].TControl.SetTop.apply(this,arguments),this.FPopup&&null!=(e=this.FPopupElement)&&e.style.setProperty("top",pas.SysUtils.IntToStr(t)+"px")},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FLoadedPtr=null,this.FDOMContentLoadedPtr=null,this.FUnloadPtr=null,this.FBeforeUnloadPtr=null,this.FResizePtr=null,this.FScrollPtr=null,this.FDocMouseUpPtr=null,this.FDocMouseMovePtr=null,this.FTitleDownPtr=null,this.FDoClickPtr=null,this.FKeyDownPtr$1=null,this.FOrientationChangePtr=null,this.FHashChangePtr=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),null===this.FLoadedPtr&&(this.FLoadedPtr=rtl.createCallback(this,"HandleLoaded"),this.FDOMContentLoadedPtr=rtl.createCallback(this,"HandleDOMContentLoaded"),this.FUnloadPtr=rtl.createCallback(this,"HandleUnload"),this.FBeforeUnloadPtr=rtl.createCallback(this,"HandleBeforeUnload"),this.FResizePtr=rtl.createCallback(this,"HandleResize"),this.FScrollPtr=rtl.createCallback(this,"HandleScroll"),this.FDocMouseUpPtr=rtl.createCallback(this,"HandleDocMouseUp"),this.FDocMouseMovePtr=rtl.createCallback(this,"HandleDocMouseMove"),this.FTitleDownPtr=rtl.createCallback(this,"HandleTitleDown"),this.FDoClickPtr=rtl.createCallback(this,"HandleDoClick$1"),this.FKeyDownPtr$1=rtl.createCallback(this,"HandleKeyDown"),this.FOrientationChangePtr=rtl.createCallback(this,"HandleOrientationChange"),this.FHashChangePtr=rtl.createCallback(this,"HandleHashChange"))},this.VisibleChanged=function(){pas["WEBLib.Controls"].TControl.VisibleChanged.call(this),null!=this.FLayer$1?this.FVisible?this.FLayer$1.style.setProperty("display",""):this.FLayer$1.style.setProperty("display","none"):null!=this.GetContainer()&&""!==this.FFormContainer&&(this.FVisible?this.GetContainer().style.setProperty("display",""):this.GetContainer().style.setProperty("display","none"))},this.Resize$1=function(){var t=0,e=0,i=0,s=0,n=null;if(!(3 in this.FComponentState)&&(this.FIsResizing$1=!0,this.FPopup&&null!=this.FPopupElement?(n=this.FPopupElement.getBoundingClientRect(),i=Math.round(n.right-n.left-2),this.FBorder in rtl.createSet(3,4)?(e=this.GetCaptionHeight(),s=Math.round(n.bottom-n.top-e-2)):s=Math.round(n.bottom-n.top-2)):(i=window.innerWidth,s=window.innerHeight),this.UpdateControlSize(i,s),pas["WEBLib.Controls"].IsAndroid()&&"INPUT"===document.activeElement.tagName||this.AlignControl(this),this.DoResize(),this.FIsResizing$1=!1,!this.IsUpdating())){-1===this.FOrigRect.Left&&-1===this.FOrigRect.Top&&this.InitAnchoring();for(var o=0,r=this.GetControlsCount()-1;o<=r;o++)t=o,this.GetControls(t).UpdateAnchoring()}},this.CreateControl=function(){(this.FVisible||this.FPopup)&&(pas["WEBLib.Controls"].TControl.CreateControl.call(this),this.UpdateSize())},this.DoClose=function(t){null!=this.FModalProc&&0!==t.get()&&(this.FModalProc(this.FModalResult),this.FModalProc=null)},this.BindEvents=function(){pas["WEBLib.Controls"].TControl.BindEvents.call(this),"loading"!==document.readyState&&null!=this.FOnDOMContentLoaded&&this.FOnDOMContentLoaded(this),window.addEventListener("resize",this.FResizePtr),window.addEventListener("load",this.FLoadedPtr),window.addEventListener("DOMContentLoaded",this.FDOMContentLoadedPtr),document.addEventListener("scroll",this.FScrollPtr),window.addEventListener("unload",this.FUnloadPtr),window.addEventListener("beforeunload",this.FBeforeUnloadPtr),window.addEventListener("keydown",this.FKeyDownPtr$1),window.addEventListener("orientationchange",this.FOrientationChangePtr),window.addEventListener("hashchange",this.FHashChangePtr)},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.FLayer$1&&0===this.FPopupClose&&this.FLayer$1.removeEventListener("click",this.FDoClickPtr),null!=this.FResizeObserver&&this.FResizeObserver.disconnect(),window.removeEventListener("resize",this.FResizePtr),window.removeEventListener("load",this.FLoadedPtr),window.removeEventListener("DOMContentLoaded",this.FDOMContentLoadedPtr),document.removeEventListener("scroll",this.FScrollPtr),window.removeEventListener("unload",this.FUnloadPtr),window.removeEventListener("beforeunload",this.FBeforeUnloadPtr),window.removeEventListener("keydown",this.FKeyDownPtr$1),window.removeEventListener("orientationchange",this.FOrientationChangePtr),window.removeEventListener("hashchange",this.FHashChangePtr)},this.DoCreate=function(){this.BeginUpdate(),this.LoadDFMValues(),this.Loaded(),null!=this.FOnCreate&&this.FOnCreate(this),this.FCreating=!1,this.EndUpdate(),this.UpdateChildren(this),this.Realign(),this.DoResize()},this.Realign=function(){var t=null,e=null,i=pas.Types.TRect.$new();""!==this.FFormContainer&&0!==this.FAlign&&null!=(t=document.getElementById(this.FFormContainer))&&(0===(e=t.getBoundingClientRect()).width&&0===e.height&&"absolute"===t.style.getPropertyValue("position")?i.$assign(pas["WEBLib.Controls"].GetHTMLElementAbsoluteRect(t)):i.$assign(pas.Types.Rect(Math.round(e.left),Math.round(e.top),Math.round(e.right),Math.round(e.bottom))),this.SetBoundsInt(i.Left,i.Top,i.Right-i.Left,i.Bottom-i.Top)),pas["WEBLib.Controls"].TControl.Realign.call(this)},this.DoResize=function(){var t,e;t=this.GetWidth(),e=this.GetHeight(),t===this.FOldWidth&&e===this.FOldHeight||(this.FOldWidth=t,this.FOldHeight=e,null!=this.FOnResize&&this.FOnResize(this))},this.DoShow=function(){null!=this.FOnShow&&this.FOnShow(this)},this.HandleDoClick$1=function(t){return t.stopPropagation(),0===this.FPopupClose&&this.Close(),!0,!0},this.HandleKeyDown=function(t){var e,i=!1;return e=this.GetKeyCode(t.key,!0),pas.System.Assigned(e)?(27===e&&!(4 in this.FComponentState)&&this.FPopup&&this.Close(),i=!0):i},this.HandleOrientationChange=function(t){var e=0;(this.Resize$1(),this.Realign(),!0,null!=this.FOnOrientationChange)&&(e=window.matchMedia("(orientation: portrait)").matches?1:0,this.FOnOrientationChange(this,e));return null!=this.FOnResize&&this.FOnResize(this),!0},this.HandleDoResize=function(){var t,e,i=null;i=this.GetContainer().getBoundingClientRect(),t=Math.round(i.right-i.left),e=Math.round(i.bottom-i.top),t===this.FOrigWidth&&e===this.FOrigHeight||(this.SetWidth(t),this.SetHeight(e),i=this.GetContainer().getBoundingClientRect(),this.FOrigWidth=Math.round(i.right-i.left),this.FOrigHeight=Math.round(i.bottom-i.top),this.AlignControl(this))},this.GetWidth=function(){var t=0,e=null,i=null;return""!==this.FFormElement&&null!=(i=document.getElementById(this.FFormElement))?(e=i.getBoundingClientRect(),t=Math.round(e.right-e.left)):(this.GetElementHandle()===document.body?(t=window.innerWidth,e=document.documentElement.getBoundingClientRect(),(t=Math.round(e.width))>window.innerWidth&&(t=window.innerWidth)):this.FPopup?t=pas["WEBLib.Controls"].TControl.GetWidth.call(this):0===(t=Math.round(this.GetElementHandle().offsetWidth))&&(t=""!==this.FFormContainer?pas["WEBLib.Controls"].TControl.GetWidth.call(this):window.innerWidth),t)},this.GetHeight=function(){var t=0,e=0,i="",s=null,n=null;return""!==this.FFormElement&&null!=(s=document.getElementById(this.FFormElement))?(n=s.getBoundingClientRect(),t=Math.round(n.bottom-n.top)):(this.GetElementHandle()===document.body?(i=window.getComputedStyle(this.GetElementHandle()).getPropertyValue("margin-top"),i=pas.System.Copy(i,1,i.length-2),e=Math.round(pas.SysUtils.StrToFloat$1(i,pas.SysUtils.TFormatSettings.Invariant())-2),n=document.documentElement.getBoundingClientRect(),(t=Math.round(n.height))>window.innerHeight&&(t=window.innerHeight-Math.max(0,e))):this.FPopup?t=pas["WEBLib.Controls"].TControl.GetHeight.call(this):0===(t=Math.round(this.GetElementHandle().offsetHeight))&&(t=""!==this.FFormContainer?pas["WEBLib.Controls"].TControl.GetHeight.call(this):window.innerHeight),t)},this.GetLeft=function(){var t=0,e=null,i=null;return this.FPopup?t=pas["WEBLib.Controls"].TControl.GetLeft.call(this):""!==this.FFormElement?null!=(e=document.getElementById(this.FFormElement))&&(i=e.getBoundingClientRect(),t=Math.round(i.left)):(e=null,""!==this.FFormContainer&&(e=document.getElementById(this.FFormContainer)),null==e&&(e=this.GetElementHandle()),t=Math.round(e.offsetLeft)),t},this.GetTop=function(){var t=0,e=null,i=null;return this.FPopup?t=pas["WEBLib.Controls"].TControl.GetTop.call(this):""!==this.FFormElement?null!=(e=document.getElementById(this.FFormElement))&&(i=e.getBoundingClientRect(),t=Math.round(i.top)):(e=null,""!==this.FFormContainer&&(e=document.getElementById(this.FFormContainer)),null==e&&(e=this.GetElementHandle()),t=Math.round(e.offsetTop)),t},this.GetClientRect=function(){var t=pas.Types.TRect.$new();return t.$assign(pas["WEBLib.Controls"].TControl.GetClientRect.call(this)),t},this.CreateElement=function(){var e=null,i=null,s=null;return this.FPopup||null==this.FormContainerElement()?(e=document.createElement("DIV"),this.FLayer$1=this.CreateLayer(),document.body.appendChild(this.FLayer$1),i=this.FLayer$1,0===this.FPopupClose&&(this.GetMethodPointers(),i.addEventListener("click",this.FDoClickPtr)),i.style.setProperty(pas["WEBLib.Controls"].CSSZIndex,t.Application.MaxZIndexStr()),2===this.FBorder&&(e.style.setProperty("resize","both"),e.style.setProperty("overflow","auto")),this.FHasCaption=!1,this.FBorder in rtl.createSet(2,3,4)&&(s=this.CreateCaption(),e.appendChild(s)),e):e=this.FormContainerElement()},this.UpdateElement=function(){var t="",e=null;this.FCreating||(pas["WEBLib.Controls"].TControl.UpdateElement.call(this),this.IsUpdating()||(null==this.GetElementHandle()&&null==this.GetContainer()||""!==this.FCaption&&(this.FPopup?null!=this.FCaptionElement&&(null!=(e=this.FCaptionElement.childNodes.item(0))&&(e.nodeValue=this.FCaption),this.FShowClose&&null==this.FCaptionCloseElement&&(this.FCaptionCloseElement=document.createElement("SPAN"),this.FCaptionCloseElement.style.setProperty("float","right"),this.FCaptionCloseElement.style.setProperty("cursor","default"),this.FCaptionCloseElement.style.setProperty("margin-right","8px"),this.FCaptionCloseElement.innerHTML="&#x2716;",this.FCaptionElement.appendChild(this.FCaptionCloseElement),this.FCaptionCloseElement.addEventListener("click",rtl.createSafeCallback(this,"HandleCloseClick"))),pas["WEBLib.Controls"].SetHTMLElementFont(this.FCaptionElement,this.FFont,!(""===this.FElementCaptionClassName&&0===this.FElementFont))):window.document.title=this.FCaption),null!=this.GetContainer()&&(t=pas["WEBLib.Graphics"].ColorToHTML(this.FColor),null!=this.GetContainer()&&(-1===this.FColor||16777215===this.FColor||this.FPopup||""!==this.FElementClassName||this.GetContainer().style.setProperty(pas["WEBLib.Controls"].CSSBackground,t),(""!==this.FElementClassName||-1===this.FColor||16777215===this.FColor&&!this.FPopup)&&this.GetContainer().style.removeProperty(pas["WEBLib.Controls"].CSSBackground),""!==this.FElementClassName||this.FPopup||document.documentElement.style.setProperty("height","100%"),pas["WEBLib.Controls"].SetHTMLElementFont(this.GetContainer(),this.FFont,!(""===this.FElementClassName&&0===this.FElementFont))),this.FPopup?(null==this.FPopupElement&&(this.FPopupElement=this.GetContainer()),this.FShadow?this.FPopupElement.style.setProperty("box-shadow","3px 3px 3px silver"):this.FPopupElement.style.removeProperty("box-shadow"),this.FPopupElement.style.setProperty("border","1px solid gray")):this.GetContainer().style.removeProperty("box-shadow"))))},this.ContainerElement=function(){return this.FormContainerElement()},this.FormContainerElement=function(){var t=null;return 4 in this.FComponentState&&null!=this.FDesignContainer&&(t=this.FDesignContainer),""!==this.FFormContainer?null==(t=document.getElementById(this.FFormContainer))&&(t=document.body):t=document.body,t},this.GetElementBindHandle=function(){return 4 in this.FComponentState||""!==this.FFormContainer?window:this.FPopup?pas["WEBLib.Controls"].TControl.GetElementBindHandle.call(this):window},this.GetElementHandle=function(){return this.FPopup?pas["WEBLib.Controls"].TControl.GetElementHandle.call(this):this.FormContainerElement()},this.SetElementClassName=function(t){pas["WEBLib.Controls"].TControl.SetElementClassName.apply(this,arguments),this.FPopup&&null!=this.FPopupElement&&this.FPopupElement.setAttribute("class",t)},this.CloseQuery=function(){var t=!1;return t=!0,null!=this.FOnCloseQuery&&this.FOnCloseQuery(this,{get:function(){return t},set:function(e){t=e}}),t},this.LoadDFMValues=function(){},this.Init=function(){},this.IsFocused=function(){return!1,!1},this.CreateLayer=function(){var e=null;return(e=document.createElement("SPAN")).style.setProperty("top","0"),e.style.setProperty("left","0"),e.style.setProperty("right","0"),e.style.setProperty("bottom","0"),e.style.setProperty("webkit-user-select","none"),e.style.setProperty("moz-user-select","none"),e.style.setProperty("khtml-user-select","none"),e.style.setProperty("ms-user-select","none"),e.style.setProperty("user-select","none"),e.style.setProperty("position","absolute"),e.style.setProperty("z-index",t.Application.MaxZIndexStr()),e},this.CreateCaption=function(){var e;return e=pas.SysUtils.IntToStr(t.Application.FFormCaptionHeight),this.FCaptionElement=document.createElement("DIV"),this.FCaptionElement.innerHTML=this.FCaption,this.FCaptionElement.style.setProperty(pas["WEBLib.Controls"].CSSBackground,pas["WEBLib.Graphics"].ColorToHTML(t.Application.FThemeColor)),this.FCaptionElement.style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(t.Application.FThemeTextColor)),this.FCaptionElement.style.setProperty("cursor","move"),this.FCaptionElement.style.setProperty("height",e+"px"),this.FCaptionElement.style.setProperty("line-height",e+"px"),this.FCaptionElement.style.setProperty("border-bottom","1px solid black"),this.FCaptionElement.style.setProperty("padding-left","4px"),this.FCaptionElement.style.setProperty("-moz-user-select","none"),this.FCaptionElement.style.setProperty("-webkit-user-select","none"),this.FCaptionElement.style.setProperty("-ms-user-select","none"),this.FCaptionElement.style.setProperty("user-select","none"),this.FCaptionElement.style.setProperty("-o-user-select","none"),""!==this.FElementCaptionClassName&&this.FCaptionElement.setAttribute("class",this.FElementCaptionClassName),pas["WEBLib.Controls"].SetHTMLElementFont(this.FCaptionElement,this.FFont,!(""===this.FElementCaptionClassName&&0===this.FElementFont)),null==this.FTitleDownPtr&&this.GetMethodPointers(),this.FCaptionElement.innerHTML=this.FCaption,this.FCaptionElement.addEventListener("mousedown",this.FTitleDownPtr),this.FHasCaption=!0,this.FCaptionElement},this.GetCaptionHeight=function(){var t=0,e=null;return t=0,null!=this.FCaptionElement&&this.FBorder in rtl.createSet(3,4)&&(e=this.FCaptionElement.getBoundingClientRect(),t=Math.round(e.bottom-e.top)),t},this.SetColorScheme=function(e){var i="";if(t.Application.FThemed){var s=e;2===s?(i="label,option,td,table,ul,li {background-color: #202124; color: #BEC1C6;}\r\nbody,input,textarea,select,fieldset {background-color: #202124; color: #BEC1C6; border: 1px solid gray;}\r\ninput:focus, textarea:focus, select:focus, span:focus { border: 1px solid silver; outline: none !important;}",this.AddCSS("appscheme",i)):1===s&&this.RemoveCSS("appscheme")}},this.SetFormPos=function(){null!=this.GetContainer()&&(4===this.FPosition&&(this.FLeft=Math.round((t.WinWidth()-this.GetWidth())/2)+window.scrollX,this.FTop=Math.round((t.WinHeight()-this.GetHeight())/2)+window.scrollY),this.GetContainer().style.setProperty("position","absolute"),this.GetContainer().style.setProperty("width",pas.SysUtils.IntToStr(this.GetWidth())+"px"),this.GetContainer().style.setProperty("height",pas.SysUtils.IntToStr(this.GetHeight())+"px"),this.GetContainer().style.setProperty("left",pas.SysUtils.IntToStr(this.GetLeft())+"px"),this.GetContainer().style.setProperty("top",pas.SysUtils.IntToStr(this.GetTop())+"px"))},this.GetHTMLFileName=function(){return this.$module.$name+t.Application.GetFormExtension()},this.LoadedDone=function(){t.Application.TriggerNotification()},this.Loaded=function(){pas["WEBLib.Controls"].TControl.Loaded.call(this),this.LoadedDone()},this.ColorChanging=function(){pas["WEBLib.Controls"].TControl.ColorChanging.call(this),null!=this.GetContainer()&&this.GetContainer().style.setProperty(pas["WEBLib.Controls"].CSSBackground,pas["WEBLib.Graphics"].ColorToHTML(this.FColor))},this.CreateInitialize=function(){pas["WEBLib.Controls"].TControl.CreateInitialize.call(this),this.FAllowTouch=!0,this.FModalResult=0,this.FFormStyle=0,this.FBorder=2,this.FShadow=!0,this.FShowClose=!0,this.FTimerID=-1,this.FCaptionElement=null,this.FColor=16777215,window.addEventListener("load",this.FLoadedPtr)},this.Create$2=function(t){return this.FNoHTML=!1,this.FCreating=!0,this.FFormContainer=t,""===t?pas["WEBLib.Controls"].TControl.Create$2.call(this,pas["WEBLib.WebTools"].cBodyTag):pas["WEBLib.Controls"].TControl.Create$2.call(this,t),this.FFormElement="",this.FModalResult=0,this.FFormStyle=0,this.DoCreate(),this},this.Create$5=function(t,e){return this.FCreating=!0,this.FFormContainer=t,pas["WEBLib.Controls"].TControl.Create$2.call(this,t),e.set(this),this.FFormElement="",this.FModalResult=0,this.FFormStyle=0,this.DoCreate(),this},this.Create$1=function(t){return this.FNoHTML=!1,this.FCreating=!0,this.FResizeObserver=null,pas["WEBLib.Controls"].TControl.Create$1.apply(this,arguments),this.FBorder=1,this.FFormFileName="",this.FPopupMode=0,this.FPopupClose=0,this.FPopup=!0,this.FPosition=4,this.FPopupOpacity=1,this},this.CreateNew=function(t,e){return this.Create$1(t),this},this.Load=function(){var e=this;return this.FFormFileName=this.$class.GetHTMLFileName(),""===this.FFormFileName?new Promise((function(t,i){t(e)})):new Promise((function(i,s){t.Application.LoadForm$1(e,e.FFormFileName,(function(t){i(t)}))}))},this.Execute=function(){var t=this;return new Promise((function(e,i){t.ShowModal$1((function(t){e(t)}))}))},this.Destroy=function(){this.FVisible&&this.Close(),null!=this.FOnDestroy&&this.FOnDestroy(this),pas["WEBLib.Controls"].TControl.Destroy.call(this),null!=this.FLayer$1&&(this.FormContainerElement()===this.FLayer$1.parentNode&&this.FormContainerElement().removeChild(this.FLayer$1),this.FLayer$1=null)},this.Close=function(){var i=0,s=null;this.CloseQuery()&&(this.UnbindEvents(),i=1,-1!==this.FTimerID&&(window.clearInterval(this.FTimerID),this.FTimerID=-1),null!=this.FOnClose&&this.FOnClose(this,{get:function(){return i},set:function(t){i=t}}),0!==i&&(null!=this.FLayer$1&&(this.GetContainer().parentNode===this.FLayer$1?this.FLayer$1.removeChild(this.GetContainer()):this.GetContainer().parentNode.parentNode===this.FLayer$1&&this.FLayer$1.removeChild(this.GetContainer().parentNode),this.FContainer=null,this.FormContainerElement()===this.FLayer$1.parentNode&&(this.FormContainerElement().removeChild(this.FLayer$1),t.Application.ChangeMaxZIndex(-1)),this.FLayer$1=null),""===this.FFormFileName?""!==this.FFormElement&&null!=this.GetContainer()?(this.GetContainer().innerHTML="",this.FContainer=null):null!=this.GetContainer()&&(this.FormContainerElement()===this.GetContainer().parentNode&&this.FormContainerElement().removeChild(this.GetContainer()),this.FContainer=null):""!==this.FFormElement&&(this.GetContainer().innerHTML="",this.FContainer=null),this.FFormElement!==this.FFormContainer&&""!==this.FFormElement&&null!=(s=document.getElementById(this.FFormElement))&&(s.innerHTML=""),this.DoClose({get:function(){return i},set:function(t){i=t}}),2!==i||3 in this.FComponentState||(e.ReleaseForm(this),t.Application.FMainForm===this&&(t.Application.FMainForm=null)),t.Application.FActiveForm=this.FPrevActiveForm,this.SetVisible(!1)))},this.IsMiletus=function(){var t=!1,e=null;e=this.$class.ClassType(),t=!1;do{if(null!=(e=e.$ancestor)&&"TMiletusForm"===e.$classname){t=!0;break}}while(null!=e&&"TForm"!==e.$classname);return t},this.SetBounds=function(t,e,i,s){4 in this.FComponentState?(this.Resize$1(),this.SetBoundsInt(t,e,i,s)):pas["WEBLib.Controls"].TControl.SetBounds.call(this,t,e,i,s)},this.Show$1=function(){var e=0,i=null;this.FCreating&&this.FPopup&&(t.Application.ChangeMaxZIndex(1),this.FCreating=!1,this.UpdateElement()),""===this.FFormFileName&&(null==this.GetContainer()?this.FPopup?(this.FContainer=this.CreateElement(),this.FPopupElement=this.GetContainer(),this.SetFormPos(),this.UpdateElement(),this.FLayer$1.appendChild(this.GetContainer())):(this.FContainer=this.CreateLayer(),this.GetContainer().style.setProperty(pas["WEBLib.Controls"].CSSBackground,pas["WEBLib.Graphics"].ColorToHTML(this.FColor)),document.body.appendChild(this.GetContainer())):this.FPopup?(this.SetFormPos(),this.FLayer$1.appendChild(this.GetContainer())):null!=this.FLayer$1?this.FLayer$1.appendChild(this.GetContainer()):document.body.appendChild(this.GetContainer()),this.FPopup&&(2===this.FBorder?(i=this.GetContainer().getBoundingClientRect(),this.FOrigWidth=Math.round(i.right-i.left),this.FOrigHeight=Math.round(i.bottom-i.top),this.FTimerID=window.setInterval(rtl.createSafeCallback(this,"HandleDoResize"),100)):(this.GetContainer().style.setProperty("resize",""),this.GetContainer().style.setProperty("overflow","")))),this.SetVisible(!0);for(var s=0,n=this.GetControlsCount()-1;s<=n;s++)e=s,0===this.GetControls(e).FTabOrder&&this.GetControls(e).FTabStop&&this.GetControls(e).SetFocus()},this.ShowModal=function(){return this.ShowModal$1(null)},this.ShowModal$1=function(e){return this.FNoHTML&&(this.FPrevActiveForm=t.Application.FActiveForm,t.Application.FActiveForm=this,t.Application.CreateNewForm(this,"")),0,this.FNoHTML=!1,this.FModalProc=e,this.SetModalResult(0),this.Show$1(),0},this.AddCSS=function(t,e){var i,s,n;i=t,s=e,(n=document.getElementById(i))?n.innerHTML=s:((n=document.createElement("style")).type="text/css",n.id=i,n.innerHTML=s,document.getElementsByTagName("head")[0].appendChild(n))},this.RemoveCSS=function(t){var e;null!=(e=document.getElementById(t))&&document.head.removeChild(e)},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TForm",this.TCustomForm,(function(){rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("CSSLibrary",0,t.$rtti.TCSSLibrary,"FCSSLibrary","FCSSLibrary",{Default:t.TCSSLibrary.cssNone}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("FormContainer",2,pas["WEBLib.Controls"].$rtti.TElementID,"FFormContainer","SetFormContainer"),e.addProperty("FormStyle",3,t.$rtti.TFormStyle,"GetFormStyle","SetFormStyle"),e.addProperty("Menu",0,pas["WEBLib.Controls"].$rtti.TCustomControl,"FMenu","FMenu"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("Shadow",2,rtl.boolean,"FShadow","SetShadow",{Default:!0}),e.addProperty("ShowClose",0,rtl.boolean,"FShowClose","FShowClose",{Default:!0}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("OnBeforeUnload",0,t.$rtti.TBeforeUnloadEvent,"FOnBeforeUnload","FOnBeforeUnload"),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnClose",0,t.$rtti.TCloseEvent,"FOnClose","FOnClose"),e.addProperty("OnCloseQuery",0,t.$rtti.TCloseQueryEvent,"FOnCloseQuery","FOnCloseQuery"),e.addProperty("OnCreate",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnCreate","FOnCreate"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnDeactivate",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDeactivate","FOnDeactivate"),e.addProperty("OnDestroy",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDestroy","FOnDestroy"),e.addProperty("OnDOMContentLoaded",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDOMContentLoaded","FOnDOMContentLoaded"),e.addProperty("OnHashChange",0,t.$rtti.THashChangeEvent,"FOnHashChange","FOnHashChange"),e.addProperty("OnResize",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnResize","FOnResize"),e.addProperty("OnShow",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnShow","FOnShow"),e.addProperty("OnScroll",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnScroll","FOnScroll"),e.addProperty("OnOrientationChange",0,t.$rtti.TOrientationChangeEvent,"FOnOrientationChange","FOnOrientationChange"),e.addProperty("OnPaint",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnPaint","FOnPaint"),e.addProperty("OnTouchStart",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchStart","FOnTouchStart"),e.addProperty("OnTouchMove",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchMove","FOnTouchMove"),e.addProperty("OnTouchEnd",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchEnd","FOnTouchEnd"),e.addProperty("OnUnload",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnUnload","FOnUnload")})),rtl.createClass(this,"TCustomFrame",pas["WEBLib.Controls"].TCustomHTMLDiv,(function(){this.$init=function(){pas["WEBLib.Controls"].TCustomHTMLDiv.$init.call(this),this.FAutoScroll=!1,this.FAutoSize=!1,this.FBiDiMode$1=0,this.FConstraints=null,this.FCtl3D$1=!1,this.FDockSite=!1,this.FDragCursor=0,this.FDragKind=0,this.FDragMode$1=0,this.FOnAlignInsertBefore=null,this.FOnAlignPosition=null,this.FOnCanResize=null,this.FOnConstrainedResize=null,this.FOnContextPopup=null,this.FOnDockDrop=null,this.FOnDockOver=null,this.FOnEndDock=null,this.FOnGesture=null,this.FOnGetSiteInfo=null,this.FOnMouseActivate=null,this.FOnMouseWheelDown$1=null,this.FOnMouseWheelUp$1=null,this.FOnStartDock=null,this.FOnUnDock=null,this.FPadding=null,this.FParentBackground=!1,this.FParentCtl3D$1=!1,this.FPopupMenu=null},this.$final=function(){this.FConstraints=void 0,this.FOnAlignInsertBefore=void 0,this.FOnAlignPosition=void 0,this.FOnCanResize=void 0,this.FOnConstrainedResize=void 0,this.FOnContextPopup=void 0,this.FOnDockDrop=void 0,this.FOnDockOver=void 0,this.FOnEndDock=void 0,this.FOnGesture=void 0,this.FOnGetSiteInfo=void 0,this.FOnMouseActivate=void 0,this.FOnMouseWheelDown$1=void 0,this.FOnMouseWheelUp$1=void 0,this.FOnStartDock=void 0,this.FOnUnDock=void 0,this.FPadding=void 0,this.FPopupMenu=void 0,pas["WEBLib.Controls"].TCustomHTMLDiv.$final.call(this)},this.SetConstraints=function(t){this.FConstraints.Assign(t)},this.SetPopupMenu=function(t){this.FPopupMenu=t},this.UpdateElement=function(){var t;pas["WEBLib.Controls"].TControl.UpdateElement.call(this),t=this.FColor in rtl.createSet(15790320,-1,16777215,16711422),null!=this.GetElementHandle()&&!this.IsUpdating()&&4 in this.FComponentState&&t&&this.GetElementHandle().style.setProperty("background-color",pas["WEBLib.Graphics"].ColorToHTML(15790320))},this.Create$1=function(e){return pas["WEBLib.Controls"].TControl.Create$1.call(this,e),this.FConstraints=t.TSizeConstraints.$create("Create$1",[this]),this},this.Destroy=function(){rtl.free(this,"FConstraints"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TFrame",this.TCustomFrame,(function(){rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("AutoScroll",0,rtl.boolean,"FAutoScroll","FAutoScroll",{Default:!1}),e.addProperty("AutoSize",0,rtl.boolean,"FAutoSize","FAutoSize",{Default:!1}),e.addProperty("BiDiMode",4,pas["WEBLib.Controls"].$rtti.TBiDiMode,"FBiDiMode$1","FBiDiMode$1"),e.addProperty("Constraints",2,t.$rtti.TSizeConstraints,"FConstraints","SetConstraints"),e.addProperty("DockSite",0,rtl.boolean,"FDockSite","FDockSite",{Default:!1}),e.addProperty("DoubleBuffered",0,rtl.boolean,"FDoubleBuffered","FDoubleBuffered",{Default:!1}),e.addProperty("DragCursor",0,pas["WEBLib.Controls"].$rtti.TCursor,"FDragCursor","FDragCursor",{Default:12}),e.addProperty("DragKind",0,pas["WEBLib.Controls"].$rtti.TDragKind,"FDragKind","FDragKind",{Default:pas["WEBLib.Controls"].TDragKind.dkDrag}),e.addProperty("DragMode",0,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode$1","FDragMode$1",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("Ctl3D",4,rtl.boolean,"FCtl3D$1","FCtl3D$1"),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Padding",0,pas["WEBLib.Controls"].$rtti.TPadding,"FPadding","FPadding"),e.addProperty("ParentBackground",0,rtl.boolean,"FParentBackground","FParentBackground",{Default:!0}),e.addProperty("ParentBiDiMode",0,rtl.boolean,"FParentBiDiMode","FParentBiDiMode",{Default:!0}),e.addProperty("ParentColor",2,rtl.boolean,"FParentColor","SetParentColor",{Default:!1}),e.addProperty("ParentCtl3D",0,rtl.boolean,"FParentCtl3D$1","FParentCtl3D$1",{Default:!0}),e.addProperty("ParentDoubleBuffered",0,rtl.boolean,"FParentDoubleBuffered","FParentDoubleBuffered",{Default:!0}),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("ParentShowHint",0,rtl.boolean,"FParentShowHint","FParentShowHint"),e.addProperty("PopupMenu",2,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","SetPopupMenu"),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("OnAlignInsertBefore",0,t.$rtti.TAlignInsertBeforeEvent,"FOnAlignInsertBefore","FOnAlignInsertBefore"),e.addProperty("OnAlignPosition",0,t.$rtti.TAlignPositionEvent,"FOnAlignPosition","FOnAlignPosition"),e.addProperty("OnCanResize",0,t.$rtti.TCanResizeEvent,"FOnCanResize","FOnCanResize"),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnConstrainedResize",0,t.$rtti.TConstrainedResizeEvent,"FOnConstrainedResize","FOnConstrainedResize"),e.addProperty("OnContextPopup",0,t.$rtti.TContextPopupEvent,"FOnContextPopup","FOnContextPopup"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnDockDrop",0,t.$rtti.TDockDropEvent,"FOnDockDrop","FOnDockDrop"),e.addProperty("OnDockOver",0,t.$rtti.TDockOverEvent,"FOnDockOver","FOnDockOver"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDock",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FOnEndDock","FOnEndDock"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnGesture",0,t.$rtti.TGestureEvent,"FOnGesture","FOnGesture"),e.addProperty("OnGetSiteInfo",0,t.$rtti.TGetSiteInfoEvent,"FOnGetSiteInfo","FOnGetSiteInfo"),e.addProperty("OnMouseActivate",0,t.$rtti.TMouseActivateEvent,"FOnMouseActivate","FOnMouseActivate"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseWheel",0,pas["WEBLib.Controls"].$rtti.TMouseWheelEvent,"FOnMouseWheel","FOnMouseWheel"),e.addProperty("OnMouseWheelDown",0,t.$rtti.TMouseWheelUpDownEvent,"FOnMouseWheelDown$1","FOnMouseWheelDown$1"),e.addProperty("OnMouseWheelUp",0,t.$rtti.TMouseWheelUpDownEvent,"FOnMouseWheelUp$1","FOnMouseWheelUp$1"),e.addProperty("OnResize",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnResize","FOnResize"),e.addProperty("OnStartDock",0,t.$rtti.TStartDockEvent,"FOnStartDock","FOnStartDock"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag"),e.addProperty("OnUnDock",0,t.$rtti.TUnDockEvent,"FOnUnDock","FOnUnDock")})),rtl.recNewT(this,"TApplicationError",(function(){this.AMessage="",this.AFile="",this.ALineNumber=0,this.AColNumber=0,this.AStack="",this.AError=null,this.$eq=function(t){return this.AMessage===t.AMessage&&this.AFile===t.AFile&&this.ALineNumber===t.ALineNumber&&this.AColNumber===t.AColNumber&&this.AStack===t.AStack&&this.AError===t.AError},this.$assign=function(t){return this.AMessage=t.AMessage,this.AFile=t.AFile,this.ALineNumber=t.ALineNumber,this.AColNumber=t.AColNumber,this.AStack=t.AStack,this.AError=t.AError,this}})),this.THintPosition={0:"hpLeft",hpLeft:0,1:"hpTop",hpTop:1,2:"hpRight",hpRight:2,3:"hpBottom",hpBottom:3},this.TOnlineStatus={0:"osOnline",osOnline:0,1:"osOffline",osOffline:1},rtl.createClass(this,"TApplication",pas["WEBLib.Controls"].TControl,(function(){this.$init=function(){pas["WEBLib.Controls"].TControl.$init.call(this),this.FAppContainer="",this.FMainFormOnTaskBar=!1,this.FCanCreateForm=!1,this.FAppInitializing=!1,this.FLastReq=null,this.FFormCaptionHeight=0,this.FActiveForm=null,this.FMainForm=null,this.FLoadForm=null,this.FInitFormClassName="",this.FFormStack=null,this.FParameters=null,this.FIsRedirect=!1,this.FLanguage=0,this.FOnImageCacheReady=null,this.FOnError=null,this.FOnHashChange=null,this.FAutoFormRoute=!1,this.FErrorType=0,this.FOnOnlineChange=null,this.FOnActivate=null,this.FThemeTextColor=0,this.FThemeColor=0,this.FThemed=!1,this.FThemeButtonClassName="",this.FOnOAuthToken=null,this.FOnOAuthCallBack=null,this.FMaxZIndex=0,this.FCreatedProc=null,this.FHintPause=0,this.FHintHidePause=0,this.FHintPosition=0,this.FHintClassName=""},this.$final=function(){this.FLastReq=void 0,this.FActiveForm=void 0,this.FMainForm=void 0,this.FLoadForm=void 0,this.FFormStack=void 0,this.FParameters=void 0,this.FOnImageCacheReady=void 0,this.FOnError=void 0,this.FOnHashChange=void 0,this.FOnOnlineChange=void 0,this.FOnActivate=void 0,this.FOnOAuthToken=void 0,this.FOnOAuthCallBack=void 0,this.FCreatedProc=void 0,pas["WEBLib.Controls"].TControl.$final.call(this)},this.DoFormLoad=function(t){var e;return e=t.target.responseText,this.CreateNewForm(this.FLoadForm,e),null!=this.FCreatedProc&&(this.FCreatedProc(this),this.FCreatedProc=null),!0,!0},this.DoFormAbort=function(t){return pas["WEBLib.Dialogs"].ShowMessage("Failed to load form HTML template file"),!0,!0},this.DoHandleError=function(e){var i,s=!1,n=t.TApplicationError.$new(),o=null,r=null,a=null,l="",h=!1;if(h=!0,null==e.message&&(h=!1),!h)return n.AMessage="Undefined JavaScript exception",n.AFile="",n.ALineNumber=0,n.AColNumber=0,n.AError=null,null!=this.FOnError&&this.FOnError(this,t.TApplicationError.$clone(n),{get:function(){return s},set:function(t){s=t}}),s;if(n.AMessage=e.message,n.AFile=e.filename,n.ALineNumber=e.lineno,n.AColNumber=e.colno,n.AError=e.error,n.AStack="",l="",null!=e.error){e.error.stack&&(n.AStack=e.error.stack),e.error.fMessage&&(n.AMessage=e.error.fMessage),l=function(t){var e="";for(var i in t)t.hasOwnProperty(i)&&(e+=i+"::"+t[i]+"\n");return e}(e.error)}s=!1,i="ERROR<br>"+n.AMessage+" | "+l+n.AStack+"<BR> at "+n.AFile+" ["+pas.SysUtils.IntToStr(n.ALineNumber)+":"+pas.SysUtils.IntToStr(n.AColNumber)+"]";var F=this.FErrorType;return 3===F?null!=(o=document.getElementById("tmserrormessage"))?rtl.asExt(o.firstChild,HTMLElement).innerHTML=i:((o=document.createElement("DIV")).setAttribute("id","tmserrormessage"),o.style.setProperty("position","absolute"),o.style.setProperty("font-family","Courier"),o.style.setProperty("font-size","8pt"),o.style.setProperty("bottom","0"),o.style.setProperty("width","100%"),o.style.setProperty("height","100px"),o.style.setProperty("background","#ff0000"),o.style.setProperty("color","#ffffff"),document.body.style.setProperty("padding","0"),document.body.style.setProperty("margin","0"),(r=document.createElement("SPAN")).style.setProperty("margin-left","4px"),r.style.setProperty("float","left"),r.style.setProperty("overflow","hidden"),r.style.setProperty("display","block"),r.innerHTML=i,o.appendChild(r),(a=document.createElement("SPAN")).style.setProperty("font-family","Courier"),a.style.setProperty("font-size","8pt"),a.style.setProperty("font-weight","bold"),a.style.setProperty("position","absolute"),a.style.setProperty("width","20px"),a.style.setProperty("vertical-align","top"),a.style.setProperty("cursor","pointer"),a.style.setProperty("text-align","right"),a.style.setProperty("right","4px"),a.style.setProperty("display","block"),a.innerHTML="X",a.onclick=rtl.createSafeCallback(this,"DoErrorClose"),o.appendChild(a),document.body.appendChild(o)):2===F?window.alert(i):1===F&&(this.AddControlLink("googlematerial","https://fonts.googleapis.com/icon?family=Material+Icons"),pas["WEBLib.Dialogs"].MessageDlg(i,1,rtl.createSet(2),null)),null!=this.FOnError&&this.FOnError(this,t.TApplicationError.$clone(n),{get:function(){return s},set:function(t){s=t}}),s},this.DoHashChange=function(t){var e="",i=null,s=null,n=null,o=!1;return!0,!this.FAutoFormRoute||(e=location.hash,pas.System.Delete({get:function(){return e},set:function(t){e=t}},1,1),o=!1,null!=this.FOnHashChange&&this.FOnHashChange(this,e,{get:function(){return o},set:function(t){o=t}}),o||(""===e&&(e=this.FInitFormClassName),""!==e&&(""===this.FInitFormClassName&&(this.FInitFormClassName=this.FActiveForm.$classname),null!=(i=pas.Classes.GetClass(e))&&(n=document.body,this.CreateForm$6(i,n,{get:function(){return s},set:function(t){s=t}})))),!0)},this.DoErrorClose=function(t){return document.body.removeChild(t.target.parentElement),!0,!0},this.DoUpdateOnlineStatus=function(t){return!0,null!=this.FOnOnlineChange&&(window.navigator.onLine?this.FOnOnlineChange(this,0):this.FOnOnlineChange(this,1)),!0},this.DoVisibilityChange=function(t){var e;return!0,e="visible"===document.visibilityState,null!=this.FOnActivate&&this.FOnActivate(this,e),!0},this.CreateNewForm=function(e,i){var s=null,n=null,o=null,r=null,a=null,l=0,h=0,F=0,p=0,c=null,u=null,T=0,C=null;if(null===this.FMainForm&&(this.FMainForm=e),o=null,a=null,T=0,e.FPopup||""===e.FFormElement){if(e.ClearControls(),e.FLayer$1=e.CreateLayer(),document.body.appendChild(e.FLayer$1),s=e.FLayer$1,e.FPopup&&e.FPopupOpacity<1&&((n=e.CreateLayer()).style.setProperty(pas["WEBLib.Controls"].CSSBackground,"black"),n.style.setProperty("opacity",pas["WEBLib.WebTools"].DoubleToHTML(e.FPopupOpacity)),n.style.setProperty(pas["WEBLib.Controls"].CSSZIndex,t.Application.MaxZIndexStr()),s.appendChild(n)),t.Application.ChangeMaxZIndex(1),(o=document.createElement("DIV")).style.setProperty(pas["WEBLib.Controls"].CSSZIndex,t.Application.MaxZIndexStr()),e.FPopupElement=o,4===e.FBorder){o.style.setProperty("resize","both"),o.style.setProperty("overflow","auto"),C=null;try{var S=e;(C=new ResizeObserver((function(t){window.requestAnimationFrame(()=>{Array.isArray(t)&&t.length&&t.forEach((function(t){S.HandleObserver()}))})}))).observe(o)}catch(t){o.style.removeProperty("resize"),o.style.removeProperty("overflow")}e.FResizeObserver=C}""!==e.FElementClassName&&o.setAttribute("class",e.FElementClassName),e.FShadow&&e.FPopup&&o.style.setProperty("box-shadow","3px 3px 3px silver"),s.appendChild(o),e.FBorder in rtl.createSet(3,4)?(e.GetMethodPointers(),u=e.CreateCaption(),o.appendChild(u),(r=document.createElement("DIV")).style.setProperty("position","absolute"),r.style.setProperty("width","100%"),r.setAttribute("id","childspan"),o.appendChild(r),a=r,T=t.Application.FFormCaptionHeight):a=o,a.innerHTML=i,e.FContainer=a}else e.FLayer$1=null,null!=(s=document.getElementById(e.FFormElement))&&(s.innerHTML=i,""===e.FElementClassName&&s.style.setProperty(pas["WEBLib.Controls"].CSSBackground,pas["WEBLib.Graphics"].ColorToHTML(e.FColor)));e.Init(),e.LoadDFMValues(),e.FBorder in rtl.createSet(3,4)&&""!==e.FElementCaptionClassName&&(u.classList.add(e.FElementCaptionClassName),u.style.removeProperty("background-color"),u.style.removeProperty("color")),null!=e.FLayer$1&&(e.FPopup||(""===e.FElementClassName?-1!==e.FColor?s.style.setProperty(pas["WEBLib.Controls"].CSSBackground,pas["WEBLib.Graphics"].ColorToHTML(e.FColor)):s.style.setProperty(pas["WEBLib.Controls"].CSSBackground,"white"):s.setAttribute("class",e.FElementClassName))),null!=o&&""===e.FFormContainer&&e.FPopup&&(o.style.setProperty("position","absolute"),l=Math.max(0,Math.round((t.WinWidth()-e.GetWidth())/2))+window.scrollX,h=Math.max(0,Math.round((t.WinHeight()-e.GetHeight())/2))+window.scrollY,F=e.GetWidth(),p=e.GetHeight()+T,""===e.FElementClassName&&(o.style.setProperty(pas["WEBLib.Controls"].CSSBackground,pas["WEBLib.Graphics"].ColorToHTML(e.FColor)),o.style.setProperty("border","1px Black solid")),o.style.setProperty("top",pas.SysUtils.IntToStr(h)+"px"),o.style.setProperty("left",pas.SysUtils.IntToStr(l)+"px"),o.style.setProperty("width",pas.SysUtils.IntToStr(F)+"px"),o.style.setProperty("height",pas.SysUtils.IntToStr(p)+"px")),null!=a&&this.ActivateChildScripts(a),null!=e.FCreatedProc&&(c=e.FCreatedProc,e.FCreatedProc=null,c(e)),null!=e.FOnCreate&&e.FOnCreate(e),e.Loaded(),e.InitAnchoring(),e.UpdateChildAnchoring(),e.FCreating=!1,e.UpdateElement(),e.EventsBound()||e.BindEvents(),e.Resize$1(),e.DoShow()},this.GetFormExtension=function(){return 0!==this.FLanguage?"_"+pas["WEBLib.Lang"].GetLanguageISO639_1Code(this.FLanguage)+pas["WEBLib.WebTools"].cHTMLExt:pas["WEBLib.WebTools"].cHTMLExt};this.GetAuthorizationPageHTML=function(t){function e(t,e){var i=0,s="";s='<!doctype html>\r\n<html lang="en">\r\n<head>\r\n  <title>Authentication Result</title>\r\n  <meta name="viewport" content="width=device-width, initial-scale=1">\r\n</head>\r\n<body>\r\n<style>\r\n  hr\r\n  {\r\n    border: none;\r\n    height: 1px;\r\n    background-color: rgb(171, 171, 171);\r\n  }\r\n  div.container\r\n  {\r\n    position: fixed;\r\n    font-family: Arial;\r\n    font-size: 12pt;\r\n    max-width: 100%;\r\n    max-height: 100%;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n  }\r\n  div.section\r\n  {\r\n    display: inline-block;\r\n    margin: 15px;\r\n    padding: 5px;\r\n    float: left;\r\n  }\r\n  div.image img\r\n  {\r\n    height: 100%;\r\n  }\r\n  div.text\r\n  {\r\n    padding-top: 15px;\r\n  }\r\n  div.text2\r\n  {\r\n    font-size: 18pt;\r\n    color: #PLACEHOLDERCOLOR#;\r\n  }\r\n  span.title\r\n  {\r\n    font-size: 26px;\r\n  }\r\n</style>\r\n  <div class="container">\r\n  <div class="section image">\r\n    <img src="#PLACEHOLDERIMAGE#">\r\n  </div>\r\n  <div class="section text">\r\n  #PLACEHOLDERTEXT#\r\n  </div>\r\n  </div>\r\n </body>\r\n</html>';for(var n=0,o=rtl.length(t)-1;n<=o;n++)i=n,s=pas.SysUtils.StringReplace(s,t[i],e[i],rtl.createSet(0));return s}return e(["#PLACEHOLDERIMAGE#","#PLACEHOLDERTEXT#","#PLACEHOLDERCOLOR#"],t?["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACC0lEQVR4nO2Zv3GDMBSHv+QyQEbICM4EOW+Q9BS4o2QTU9LZBQNkg6zgETyCR0iRkOMIAv3Xk0+/zsiI931nI3iCkpKSkpKSkpKSkpJ7SDN0x2bo3nW//xCymNhphu4E1MAN2PdVe9k6524ETODHXIHXvmpva+c9BqwpWhbgAV6Ar61zsxeggB+z+x1XJmsBG/Bj6mboWtVgtvcATfhpPvqq/ZwfzFKABTwoVobsBFjCj7kyWxmyugc4wsPCypCNAA/wY/L7C3iEP/dVe5geEC8gJDwIFxAaHgQLiAEPQgXEggeBAmLCgzABseFBkIAU8CBEQCp4ECAgJTwYChibCzYXWpmv9jCVFTwYCJgVa31BxXwucapFS4CiWOsLS4EHDQEbxRoXIAkeNgRoFqtdiDR4WBFgWOxmQRLhQdEQsSi2bobuqBqUCg8LvwDHYg991Z49zjeNd3iYCfBU7J8E6fAAT7PPOw9znpqhA3hDODz8F7Dnp2vqKmJ1O8ogQeFh+R7wjB8JrgkOD4plUICEKPCw/hyQSkI0eNh+EowtISo86L0LxJIQHR703wZDS0gCD2b9gFASksGDeUfIt4Sk8GDRE/QoITk8WDZFPUgQAQ8OXWEHCWLgwbEtbiFBFDx42BcwkCAOHjxtjGhIEAkPHneGViSIhQfPW2MLEkTDQ4C9wYmEi3T4kpKSkm+5ax+YhPsUTQAAAABJRU5ErkJggg==",'<div class="text2">Application succesfully authorized</div>You can close this browser window',"rgb(104, 164, 144)"]:["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABtElEQVR4nO2bUY7CMAxEhz0NB+EgrDjXCg6yB+E4+9NKCAiN7XHcjf1+ED+Z6ahNHScFiqIoBNwvp+v9crpG+3hG6+sgFQFwXv7ejj+/31JBDyy+ugN4ElkJD8HqqyuAhohYjA3D12YAGyIiMSYsXx8D6BTpFmPB9NUMQCjSJcaA7ettAEqRTTErHr5eAjCKfBSz4OXryzhgizOzWCJd/Fs8HoFHzHeCtxf2JNgt3MMID8zXoMpAtDarEDIbidJklMJUQ6MDty6GNDSNRdxtluWwhReDUfONKADAx2jkZCsOAOAaXn4pY2let6oAAN/qTIG61lAHAOwmBFO1aQoACA/BXGqbAwDCQqCsOCkBAMNDoC23aQEAw0Kg9hqoAQDuIdAbLfQAALcQXFptLgEA9BDc+oxeLbF/Qz0C7AFTT4KpX4OpC6HUpXDqxVDq5fBOLn5lbEMkdUssdVM0dVs89cZI6q2x1JujqbfHUx+Q2MPFj/LidUqsKajB05NXS4y6Zl/GurHGe6QOSpLF5jgqqxSb67C0UGzO4/KdYnN/MLEhluOTmYZY+MWvDPU122dzRVHk5g+X6Lw5aVkK9AAAAABJRU5ErkJggg==",'<div class="text2">Application authorization failed</div><br/>Please try again.',"rgb(216, 99, 68)"])},this.GetColorScheme=function(){var t=0;return t=0,"not all"!==window.matchMedia("(prefers-color-scheme)").media&&(t=window.matchMedia("(prefers-color-scheme: dark)").matches?2:1),t},this.ActivateChildScripts=function(t){!function t(e){if(!0===function(t){return"SCRIPT"===t.tagName}(e))e.parentNode.replaceChild(function(t){var e=document.createElement("script");e.async=!1,e.text=t.innerHTML;for(var i=t.attributes.length-1;i>=0;i--)e.setAttribute(t.attributes[i].name,t.attributes[i].value);return e}(e),e);else for(var i=0,s=e.childNodes;i<s.length;)t(s[i++]);return e}(t)},this.ChangeMaxZIndex=function(t){this.FMaxZIndex=this.FMaxZIndex+t},this.TriggerNotification=function(){},this.LockForm=function(t){for(var e=0,i=0,s=t.GetControlsCount()-1;i<=s;i++)e=i,t.GetControls(e).DisableTab()},this.UnLockForm=function(t){for(var e=0,i=0,s=t.GetControlsCount()-1;i<=s;i++)e=i,t.GetControls(e).EnableTab()},this.Create$1=function(t){return this.FFormStack=pas.Classes.TList.$create("Create$1"),this.FParameters=pas.Classes.TStringList.$create("Create$1"),this.FAppContainer=pas["WEBLib.WebTools"].cBodyTag,this.FMainForm=null,this.FActiveForm=null,this.FInitFormClassName="",this.FIsRedirect=!1,this.FAutoFormRoute=!1,this.FThemed=!1,this.FThemeColor=14917120,this.FThemeTextColor=16777215,this.FFormCaptionHeight=22,this.FMaxZIndex=999998,this.FHintPause=200,this.FHintHidePause=250,this.FHintPosition=1,this.FHintClassName="",window.addEventListener("error",rtl.createCallback(this,"DoHandleError")),window.addEventListener("unhandledrejection",rtl.createCallback(this,"DoHandleError")),this.FErrorType=0,this},this.Destroy=function(){rtl.free(this,"FFormStack"),rtl.free(this,"FParameters"),pas["WEBLib.Controls"].TControl.Destroy.call(this)},this.MaxZIndexStr=function(){return pas.SysUtils.IntToStr(this.FMaxZIndex)},this.CreateForm=function(t,e){this.CreateForm$2(t,this.FAppContainer,e,null)},this.CreateForm$2=function(t,e,i,s){this.CreateForm$3(t,e,i,s,!0)},this.CreateForm$3=function(e,i,s,n,o){var r=this,a="";function l(o){var l,h=null,F=null,p="",c=!1;return(l=null!=o)?(p=o.target.responseText,(h=(c=pas.SysUtils.LowerCase(i)===pas["WEBLib.WebTools"].cBodyTag)?document.body:document.getElementById(i)).innerHTML=p):h=document.body,(F=e.$create("Create$5",[i,s])).FFormFileName=a,""===F.FFormContainer&&F.SetFormContainer(i),c||(F.FFormElement=i,F.FContainer=h),F.CreateControl(),F.Init(),F.SetColorScheme(t.Application.GetColorScheme()),F.FPrevActiveForm=r.FActiveForm,r.FActiveForm=F,null===r.FMainForm&&(r.FMainForm=F),null!=n&&n(F),!0,l&&r.ActivateChildScripts(h),r.FActiveForm.DoShow(),r.FActiveForm.Resize$1(),!0}if(!this.FIsRedirect){if(this.FAppInitializing){if(!this.FCanCreateForm)return;this.FCanCreateForm=!1}""!==(a=e.GetHTMLFileName())&&o?(this.FLastReq=new XMLHttpRequest,this.FLastReq.addEventListener("load",rtl.createSafeCallback(null,l)),this.FLastReq.open("GET",a),this.FLastReq.send()):l(null)}},this.CreateForm$4=function(t,e){var i;i=t.$create("Create$1",[this]),e.set(i)},this.CreateForm$6=function(t,e,i){this.CreateForm$2(t,e.id,i,null)},this.CreateFormDirect$1=function(t,e){this.CreateForm$4(t,e)},this.LoadForm=function(t,e){t.FPrevActiveForm=this.FActiveForm,this.FActiveForm=t,this.FLoadForm=t,null===this.FMainForm&&(this.FMainForm=t),this.FLastReq=new XMLHttpRequest,this.FLastReq.addEventListener("load",rtl.createSafeCallback(this,"DoFormLoad")),this.FLastReq.addEventListener("abort",rtl.createSafeCallback(this,"DoFormAbort")),this.FLastReq.open("GET",e),this.FLastReq.send()},this.LoadForm$1=function(t,e,i){this.FCreatedProc=i,this.LoadForm(t,e)},this.HasCSS=function(t){var e=!1,i=null,s=0,n="";e=!1;for(var o=0,r=(i=document.querySelectorAll("head > link")).length-1;o<=r;o++)if(s=o,n=i.item(s).href,0===pas.SysUtils.CompareText(n,t)){e=!0;break}return e},this.Initialize=function(){var t,e,i="",s="";if(this.FCanCreateForm=!0,this.FAppInitializing=!0,this.FParameters.Clear(),i=window.location.href,this.InitFormatSettings(pas["WEBLib.WebTools"].GetBrowserLocale()),this.FParameters.SetDelimiter("&"),this.FParameters.FStrictDelimiter=!0,(t=pas.System.Pos("?",i))>0&&(i=pas.System.Copy(i,t+1,i.length)),this.FParameters.SetDelimitedText(i),e="Authentication"==window.name,null!=this.FOnOAuthCallBack&&(-1!==this.FParameters.IndexOfName("oauthcallback")||e))return this.FOnOAuthCallBack(this,i),this.FIsRedirect=!0,void(document.body.innerHTML=this.GetAuthorizationPageHTML(!0));null!=this.FOnOAuthToken&&-1!==this.FParameters.IndexOfName("code")&&(this.FOnOAuthToken(this,i),this.FIsRedirect=!0,s=this.FParameters.GetValue("code"),window.opener&&window.opener.processAuthData&&(window.opener.processAuthData(s),window.close())),window.addEventListener("hashchange",rtl.createSafeCallback(this,"DoHashChange")),window.addEventListener("online",rtl.createSafeCallback(this,"DoUpdateOnlineStatus")),window.addEventListener("offline",rtl.createSafeCallback(this,"DoUpdateOnlineStatus")),document.addEventListener("visibilitychange",rtl.createSafeCallback(this,"DoVisibilityChange")),null!==window.opener&&-1!==this.FParameters.IndexOfName("access_token")&&(this.FIsRedirect=!0,s=this.FParameters.GetValue("access_token"),window.opener&&window.opener.processAuthData&&(window.opener.processAuthData(s),window.close()))},this.InitFormatSettings=function(t){var e,i,s=0;i=t,pas.SysUtils.FormatSettings.ShortDateFormat=pas["WEBLib.WebTools"].GetLocaleShortDateFormat(i),pas.System.Pos("/",pas.SysUtils.FormatSettings.ShortDateFormat)>0&&(pas.SysUtils.FormatSettings.DateSeparator="/"),pas.System.Pos(".",pas.SysUtils.FormatSettings.ShortDateFormat)>0&&(pas.SysUtils.FormatSettings.DateSeparator="."),pas.System.Pos("-",pas.SysUtils.FormatSettings.ShortDateFormat)>0&&(pas.SysUtils.FormatSettings.DateSeparator="-");var n=new Date("Jan 1, 1980 06:07:08 GMT+00:00"),o="";for(o=""==i?navigator.language:i,e=n.toLocaleTimeString(o),pas.System.Pos(":",e)>0&&(pas.SysUtils.FormatSettings.TimeSeparator=":"),pas.System.Pos(".",e)>0&&(pas.SysUtils.FormatSettings.TimeSeparator="."),pas.System.Pos("-",e)>0&&(pas.SysUtils.FormatSettings.TimeSeparator="-"),s=1;s<=7;s++)pas.SysUtils.FormatSettings.ShortDayNames[s-1]=pas["WEBLib.WebTools"].GetLocaleShortDayName(s,i),pas.SysUtils.FormatSettings.LongDayNames[s-1]=pas["WEBLib.WebTools"].GetLocaleLongDayName(s,i);for(s=1;s<=12;s++)pas.SysUtils.FormatSettings.ShortMonthNames[s-1]=pas["WEBLib.WebTools"].GetLocaleShortMonthName(s,i),pas.SysUtils.FormatSettings.LongMonthNames[s-1]=pas["WEBLib.WebTools"].GetLocaleLongMonthName(s,i);pas.SysUtils.FormatSettings.DecimalSeparator=pas["WEBLib.WebTools"].GetLocaleDecimalSeparator(""),"."===pas.SysUtils.FormatSettings.DecimalSeparator?pas.SysUtils.FormatSettings.ThousandSeparator=",":pas.SysUtils.FormatSettings.ThousandSeparator="."},this.Run=function(){this.FCanCreateForm=!0,this.FAppInitializing=!1},rtl.addIntf(this,pas.System.IUnknown)})),this.GetParentForm=function(e){var i=null,s=null;for(i=null,s=e;null!=s&&!t.TCustomForm.isPrototypeOf(s);)s=s.FOwner;return null!=s&&t.TCustomForm.isPrototypeOf(s)&&(i=rtl.as(s,t.TCustomForm)),i},this.WinWidth=function(){return null!=t.VSIDE?pas["WEBLib.Forms"].VSIDE.clientWidth():window.innerWidth},this.WinHeight=function(){return null!=t.VSIDE?pas["WEBLib.Forms"].VSIDE.clientHeight():window.innerHeight},this.Application=null,this.HandShakeScript=null,this.VSIDE=null,t.$implcode=function(){e.ReleaseForm=function(t){t=rtl.freeLoc(t),t=null}},t.$init=function(){t.HandShakeScript=document.createElement("script"),t.HandShakeScript.id="HandShakeScript",t.HandShakeScript.type="text/javascript",t.HandShakeScript.innerHTML='var IDE = null;\r\nvar TMSWEBCoreClientIdentifier = "unknown";\r\nvar TMSWEBCoreOAuthCallback = "unknown";\r\nfunction HandShake(cid){\r\n  TMSWEBCoreClientIdentifier = cid;\r\n}',document.body.appendChild(t.HandShakeScript),t.Application=t.TApplication.$create("Create$1",[null])}}),["WEBLib.Dialogs","WEBLib.WebTools","WEBLib.JSON","WEBLib.Utils","Math"]),rtl.module("WEBLib.StdCtrls",["System","Classes","WEBLib.Controls","SysUtils","Web","WEBLib.Graphics","Types","WEBLib.WebTools","WEBLib.Forms","WEBLib.Menus"],(function(){"use strict";var t=this;this.TEditCharCase={0:"wecLowerCase",wecLowerCase:0,1:"wecNormal",wecNormal:1,2:"wecMixedCase",wecMixedCase:2,3:"wecUpperCase",wecUpperCase:3},this.$rtti.$Enum("TEditCharCase",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TEditCharCase}),this.TCheckBoxState={0:"cbChecked",cbChecked:0,1:"cbGrayed",cbGrayed:1,2:"cbUnchecked",cbUnchecked:2},this.$rtti.$Enum("TCheckBoxState",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TCheckBoxState}),this.TDateTimeKind={0:"dtkDate",dtkDate:0,1:"dtkTime",dtkTime:1},this.$rtti.$Enum("TDateTimeKind",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TDateTimeKind}),this.TEllipsisPosition={0:"epEndEllipsis",epEndEllipsis:0,1:"epNone",epNone:1,2:"epPathEllipsis",epPathEllipsis:2,3:"epWordEllipsis",epWordEllipsis:3},this.$rtti.$Enum("TEllipsisPosition",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TEllipsisPosition}),this.TTextLayout={0:"tlTop",tlTop:0,1:"tlCenter",tlCenter:1,2:"tlBottom",tlBottom:2},this.$rtti.$Enum("TTextLayout",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTextLayout}),this.TAutoCompletion={0:"acOff",acOff:0,1:"acHonorificPrefix",acHonorificPrefix:1,2:"acGivenName",acGivenName:2,3:"acAdditionalName",acAdditionalName:3,4:"acFamilyName",acFamilyName:4,5:"acHonorificSuffix",acHonorificSuffix:5,6:"acNickName",acNickName:6,7:"acEmail",acEmail:7,8:"acUserName",acUserName:8,9:"acNewPassword",acNewPassword:9,10:"acCurrentPassword",acCurrentPassword:10,11:"acOrganizationTitle",acOrganizationTitle:11,12:"acOrganization",acOrganization:12,13:"acStreetAddress",acStreetAddress:13,14:"acAddressLine1",acAddressLine1:14,15:"acAddressLine2",acAddressLine2:15,16:"acAddressLine3",acAddressLine3:16,17:"acAddressLevel1",acAddressLevel1:17,18:"acAddressLevel2",acAddressLevel2:18,19:"acAddressLevel3",acAddressLevel3:19,20:"acAddressLevel4",acAddressLevel4:20,21:"acCountry",acCountry:21,22:"acCountryName",acCountryName:22,23:"acPostalCode",acPostalCode:23,24:"acCCName",acCCName:24,25:"acCCGivenName",acCCGivenName:25,26:"acCCAdditionalName",acCCAdditionalName:26,27:"acCCFamilyName",acCCFamilyName:27,28:"acCCNumber",acCCNumber:28,29:"acExpiry",acExpiry:29,30:"acExpiryMonth",acExpiryMonth:30,31:"acExpiryYear",acExpiryYear:31,32:"acCSC",acCSC:32,33:"acType",acType:33,34:"acTransactionCurrency",acTransactionCurrency:34,35:"acTransactionAmount",acTransactionAmount:35,36:"acLanguage",acLanguage:36,37:"acBirthday",acBirthday:37,38:"acBirthdayDay",acBirthdayDay:38,39:"acBirthDayMonth",acBirthDayMonth:39,40:"acBirthDayYear",acBirthDayYear:40,41:"acSex",acSex:41,42:"acTelephone",acTelephone:42,43:"acTelephoneCountryCode",acTelephoneCountryCode:43,44:"acTelephoneNational",acTelephoneNational:44,45:"acTelephoneAreaCode",acTelephoneAreaCode:45,46:"acTelephoneLocal",acTelephoneLocal:46,47:"acTelephoneExtension",acTelephoneExtension:47,48:"acIMPP",acIMPP:48,49:"acURL",acURL:49,50:"acPhoto",acPhoto:50,51:"acNone",acNone:51,52:"acNope",acNope:52},this.$rtti.$Enum("TAutoCompletion",{minvalue:0,maxvalue:52,ordtype:1,enumtype:this.TAutoCompletion}),this.TEditType={0:"weString",weString:0,1:"weFloat",weFloat:1,2:"weHex",weHex:2,3:"weNumeric",weNumeric:3,4:"weSignedFloat",weSignedFloat:4,5:"weSignedNumeric",weSignedNumeric:5,6:"weSearch",weSearch:6},this.$rtti.$Enum("TEditType",{minvalue:0,maxvalue:6,ordtype:1,enumtype:this.TEditType}),this.THTMLType={0:"tLABELTAG",tLABELTAG:0,1:"tSPAN",tSPAN:1,2:"tDIV",tDIV:2,3:"tH1",tH1:3,4:"tH2",tH2:4,5:"tH3",tH3:5,6:"tH4",tH4:6,7:"tH5",tH5:7,8:"tH6",tH6:8,9:"tP",tP:9},this.$rtti.$Enum("THTMLType",{minvalue:0,maxvalue:9,ordtype:1,enumtype:this.THTMLType}),rtl.createClass(this,"TCustomLabel",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FContent=null,this.FAutoSize=!1,this.FEllipsisPosition=0,this.FWordWrap=!1,this.FAlignment=0,this.FLayout=0,this.FTransparent=!1,this.FHTMLType=0,this.FFocusControl=null,this.FShowAccelChar=!1,this.FColor$1=0,this.FHasAccel=!1,this.FHasHTML=!1,this.FElementLabelClassName="",this.FOrigWidth=0,this.FOldWidth=0,this.FOldHeight=0,this.FHTML=""},this.$final=function(){this.FContent=void 0,this.FFocusControl=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.SetLayout=function(t){this.FLayout!==t&&(this.FLayout=t,this.UpdateElementVisual())},this.SetAlignment=function(t){this.FAlignment!==t&&(this.FAlignment=t,this.UpdateElementVisual())},this.GetContentHandle=function(){return this.FContent},this.SetTransparent=function(t){this.FTransparent!==t&&(this.FTransparent=t,this.UpdateElementVisual())},this.SetHTMLType=function(t){var e=null;this.FHTMLType!==t&&(this.FHTMLType=t,this.FHTMLType in rtl.createSet(null,3,8)&&this.SetElementFont(1),null!=this.GetElementHandle()&&null!=this.FContent&&null!=(e=this.GetElementHandle().firstChild)&&"lbl"===e.getAttribute("data-lbl")&&(this.GetElementHandle().removeChild(this.FContent),this.FContent=this.CreateLabelElement(),this.GetElementHandle().appendChild(this.FContent),this.UpdateElement()))},this.SetColorEx=function(t){this.FColor$1=t,4 in this.FComponentState&&16777215!==this.FColor$1&&this.SetTransparent(!1),this.UpdateElement()},this.SetElementLabelClassName=function(t){this.FElementLabelClassName!==t&&(this.FElementLabelClassName=t,this.UpdateElement())},this.SetHTML=function(t){this.FHTML!==t&&(this.FHTML=t,this.UpdateElementData())},this.SetWidth=function(t){-1!==t&&0 in this.FComponentState&&(this.FOrigWidth=t),pas["WEBLib.Controls"].TControl.SetWidth.apply(this,arguments)},this.CreateElement=function(){var t=null;return t=document.createElement("DIV"),this.FContent=this.CreateLabelElement(),t.appendChild(this.FContent),t},this.CreateLabelElement=function(){var t=null;t=null;var e=this.FHTMLType;return 1===e?t=document.createElement("SPAN"):2===e?t=document.createElement("DIV"):3===e?t=document.createElement("H1"):4===e?t=document.createElement("H2"):5===e?t=document.createElement("H3"):6===e?t=document.createElement("H4"):7===e?t=document.createElement("H5"):8===e?t=document.createElement("H6"):0===e?t=document.createElement("LABEL"):9===e&&(t=document.createElement("P")),t.setAttribute("data-lbl","lbl"),t},this.GetDisplayText=function(){return this.FCaption},this.CanShowFocus=function(){return!1,!1},this.SetParent=function(t){pas["WEBLib.Controls"].TControl.SetParent.apply(this,arguments),this.FAutoSize&&0!==this.FAlignment&&-1!==this.FOrigWidth&&(this.SetLeft(this.GetLeft()+this.FOrigWidth-this.GetWidth()),this.FOrigWidth=-1)},this.BindElement=function(){this.FContent=this.GetContainer().firstElementChild},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.FShowAccelChar&&null!=this.FFocusControl&&this.UpdateElementData()},this.UpdateAutoSize=function(){this.FAutoSize&&0===this.FAlign&&(null!=this.GetElementHandle()&&pas["WEBLib.WebTools"].ElementVisible(this.GetElementHandle())&&(this.SetWidth(-1),this.SetHeight(-1)),this.FEllipsisPosition=1)},this.UpdateElementData=function(){var t="",e="",i=null;pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),e="",t=this.FShowAccelChar?pas["WEBLib.WebTools"].ProcessAccelerator(this.GetDisplayText(),{get:function(){return e},set:function(t){e=t}}):this.GetDisplayText(),t=""===this.FHTML?pas["WEBLib.WebTools"].HTMLToString(t):this.FHTML,this.GetIsLinked()&&""===t&&0 in this.FComponentState||(null!=this.GetContentHandle()?this.GetIsLinked()?(i=this.GetContentHandle(),""!==this.GetID()&&(i=document.getElementById(this.GetID())),null!=i&&(pas.System.Assigned(this.GetContentHandle().nodeValue)?i.nodeValue=t:0===i.childElementCount&&(i.innerHTML=t))):this.GetContentHandle().childElementCount>0&&!this.FHasAccel&&!this.FHasHTML?this.GetContentHandle().nodeValue=t:this.GetContentHandle().innerHTML=t:this.GetElementHandle().innerHTML=t,this.FHasHTML=pas.System.Pos("</",t)>0,this.FHasAccel=""!==e,""!==e&&null!=this.FFocusControl&&(this.GetContentHandle().setAttribute("accesskey",e),this.GetContentHandle().setAttribute("for",this.FFocusControl.GetID())))},this.UpdateElementVisual=function(){var t=0,e=0;if(pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),!this.IsUpdating()&&(null!=this.GetElementHandle()&&(e=Math.round(this.GetElementHandle().offsetHeight),t=Math.round(this.GetElementHandle().offsetWidth),e>0&&(this.FOldHeight=e),t>0&&(this.FOldWidth=t),!this.FVisible||this.FAutoSize&&0===this.FAlign||0===this.FAlignment||this.GetElementHandle().style.setProperty("display","table"),this.GetElementHandle().setAttribute("zindex","1"),this.FAutoSize&&0===this.FAlign&&!(4 in this.FComponentState)?this.GetElementHandle().style.setProperty("overflow",""):this.GetElementHandle().style.setProperty("overflow","hidden")),null!=this.GetContentHandle())){var i=this.FLayout;0===i?this.GetContentHandle().style.setProperty("vertical-align","top"):1===i?this.GetContentHandle().style.setProperty("vertical-align","middle"):2===i&&this.GetContentHandle().style.setProperty("vertical-align","bottom");var s=this.FAlignment;0===s?this.GetContentHandle().style.removeProperty("text-align"):2===s?this.GetContentHandle().style.setProperty("text-align","center"):1===s&&this.GetContentHandle().style.setProperty("text-align","right"),pas["WEBLib.Controls"].SetHTMLElementColor(this.GetElementHandle(),this.FColor$1,this.FTransparent||-1===this.FColor$1||16711422===this.FColor$1),pas["WEBLib.Controls"].SetHTMLElementColor(this.GetContentHandle(),this.FColor$1,this.FTransparent||-1===this.FColor$1||16711422===this.FColor$1),this.GetContentHandle().style.setProperty("display","table-cell"),""===this.FElementClassName?(this.FEnabled&&0===this.FElementFont&&!this.GetIsLinked()?this.GetContentHandle().style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(this.FFont.FColor)):this.GetContentHandle().style.removeProperty("color"),this.SetElementPointer(this.GetContentHandle(),this.FCursor),pas["WEBLib.Controls"].SetHTMLElementFont(this.GetContentHandle(),this.FFont,!(0===this.FElementFont&&!this.GetIsLinked()))):(this.GetContentHandle().style.removeProperty("color"),pas["WEBLib.Controls"].SetHTMLElementFont(this.GetContentHandle(),this.FFont,!0)),""!==this.FElementLabelClassName?this.GetContentHandle().setAttribute("class",this.FElementLabelClassName):this.GetContentHandle().removeAttribute("class"),0===this.FElementPosition||1===this.FWidthStyle?1===this.FEllipsisPosition?this.GetContentHandle().style.setProperty("text-overflow","clip"):this.GetContentHandle().style.setProperty("text-overflow","ellipsis"):this.GetContentHandle().style.removeProperty("text-overflow"),this.FWordWrap?this.GetContentHandle().style.setProperty("white-space","normal"):this.GetContentHandle().style.setProperty("white-space","nowrap"),this.GetElementHandle().style.setProperty("user-select",""),0===this.FCursor&&this.GetElementHandle().style.setProperty("cursor",""),this.FAutoSize&&0===this.FAlign&&!(4 in this.FComponentState)&&(this.GetElementHandle().style.removeProperty("width"),this.GetElementHandle().style.removeProperty("height"))}},this.UpdateElementSize=function(){pas["WEBLib.Controls"].TControl.UpdateElementSize.call(this),this.FAutoSize&&0===this.FAlign&&null!=this.GetElementHandle()&&(4 in this.FComponentState||(this.GetElementHandle().style.removeProperty("width"),this.GetElementHandle().style.removeProperty("height"))),null!=this.GetContentHandle()&&this.FAlign in rtl.createSet(3,4,5)&&!this.FAutoSize&&this.FLayout in rtl.createSet(1,2)&&this.GetContentHandle().style.setProperty("height",pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.GetHeight(),get:function(){return this.p},set:function(t){this.p=t}})+"px")},this.SetAutoSize=function(t){this.FAutoSize!==t&&(this.FAutoSize=t,this.UpdateAutoSize(),this.UpdateElement())},this.SetCaption=function(t){var e=0;this.FCaption!==t&&(e=this.GetWidth(),pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,t),this.UpdateAutoSize(),this.UpdateElement(),e-=this.GetWidth(),this.FAutoSize&&0!==this.FAlignment&&0!==e&&2 in this.FAnchors&&!this.IsUpdating()&&this.SetLeft(this.GetLeft()+e))},this.SetControlCursor=function(t){pas["WEBLib.Controls"].TControl.SetControlCursor.apply(this,arguments),""===this.FElementClassName&&null!=this.GetContentHandle()&&this.SetElementPointer(this.GetContentHandle(),this.FCursor)},this.SetEllipsisPosition=function(t){this.FEllipsisPosition!==t&&(this.FEllipsisPosition=t,1!==this.FEllipsisPosition&&(this.FAutoSize=!1),this.UpdateElement())},this.GetWidth=function(){var t=0;return this.FAutoSize&&null!=this.GetElementHandle()&&null!=this.FParent?(0===(t=Math.round(this.GetElementHandle().offsetWidth))&&(t=pas["WEBLib.Controls"].TControl.GetWidth.call(this)),0===t&&""!==this.FCaption&&4 in this.FComponentState&&(t=this.FOldWidth)):t=pas["WEBLib.Controls"].TControl.GetWidth.call(this),t},this.GetHeight=function(){var t=0;return this.FAutoSize&&null!=this.GetElementHandle()&&null!=this.FParent?(0===(t=Math.round(this.GetElementHandle().offsetHeight))&&(t=pas["WEBLib.Controls"].TControl.GetHeight.call(this)),0===t&&""!==this.FCaption&&4 in this.FComponentState&&(t=this.FOldHeight)):t=pas["WEBLib.Controls"].TControl.GetHeight.call(this),t},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FAutoSize=!0,this.FLayout=0,this.FEllipsisPosition=1,this.FColor$1=16777215,this.FTransparent=!0,this.FAlignment=0,this.SetTabStop(!1),this.FShowAccelChar=!0},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TLabel",this.TCustomLabel,(function(){rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment",{Default:pas.Classes.TAlignment.taLeftJustify}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAutoSize",{Default:!0}),e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor$1","SetColorEx",{Default:16777215}),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("EllipsisPosition",2,t.$rtti.TEllipsisPosition,"FEllipsisPosition","SetEllipsisPosition",{Default:t.TEllipsisPosition.epNone}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementLabelClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementLabelClassName","SetElementLabelClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("FocusControl",0,pas["WEBLib.Controls"].$rtti.TWinControl,"FFocusControl","FFocusControl"),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("HTML",2,rtl.string,"FHTML","SetHTML"),e.addProperty("HTMLType",2,t.$rtti.THTMLType,"FHTMLType","SetHTMLType",{Default:t.THTMLType.tLABELTAG}),e.addProperty("Layout",2,t.$rtti.TTextLayout,"FLayout","SetLayout",{Default:t.TTextLayout.tlTop}),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("ShowAccelChar",0,rtl.boolean,"FShowAccelChar","FShowAccelChar",{Default:!0}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Transparent",2,rtl.boolean,"FTransparent","SetTransparent",{Default:!0}),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("WordWrap",0,rtl.boolean,"FWordWrap","FWordWrap",{Default:!1}),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnTouchStart",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchStart","FOnTouchStart"),e.addProperty("OnTouchEnd",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchEnd","FOnTouchEnd"),e.addProperty("OnTouchMove",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchMove","FOnTouchMove"),e.addProperty("OnTouchCancel",0,pas["WEBLib.Controls"].$rtti.TTouchEvent,"FOnTouchCancel","FOnTouchCancel"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag")})),rtl.createClass(this,"TWebLabel",this.TLabel,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TCustomInput",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.IsInputControl=function(){return!0,!0},this.GetInputType=function(){return"EDIT","EDIT"},this.CreateElement=function(){var t=null;return(t=document.createElement("INPUT")).setAttribute("type",this.GetInputType()),t},this.UpdateElementVisual=function(){pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null==this.GetContainer()||this.GetIsLinked()||(this.GetContainer().style.setProperty("-moz-box-sizing","border-box"),this.GetContainer().style.setProperty("-webkit-box-sizing","border-box"),this.GetContainer().style.setProperty("box-sizing","border-box"))},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.SetShowFocus(!0),this.FNoUserSelect=!1},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TCustomEdit",this.TCustomInput,(function(){this.$init=function(){t.TCustomInput.$init.call(this),this.FCharCase=0,this.FMaxLength=0,this.FReadOnly=!1,this.FText="",this.FTextHint="",this.FSelStart=0,this.FAlignment=0,this.FHideSelection=!1,this.FPasswordChar="",this.FOnChange=null,this.FAutoSize=!1,this.FAutoSelect=!1,this.FSelLength=0,this.FNumeric=!1,this.FAutoCompletion=0,this.FEditType=0,this.FRequired=!1,this.FAutoFocus=!1,this.FPattern="",this.FHandlePastePtr=null,this.FHandleCutPtr=null,this.FHandleChangePtr=null,this.FHandleInvalidPtr=null,this.FSpellCheck=!1,this.FRequiredText=""},this.$final=function(){this.FOnChange=void 0,t.TCustomInput.$final.call(this)},this.SetAlignment=function(t){this.FAlignment=t,this.UpdateElement()},this.SetHideSelection=function(t){this.FHideSelection!==t&&(this.FHideSelection=t,this.UpdateElement())},this.SetAutoSelect=function(t){this.FAutoSelect!==t&&(this.FAutoSelect=t,this.UpdateElement())},this.SetAutoSize=function(t){this.FAutoSize!==t&&(this.FAutoSize=t,this.UpdateElement())},this.SetSelLength=function(t){this.FSelLength=t,this.UpdateElement()},this.SetSelStart=function(t){this.FSelStart=t,this.UpdateElement()},this.SetPasswordChar=function(t){this.FPasswordChar=t,this.UpdateElement()},this.SetAutoCompletion=function(t){this.FAutoCompletion!==t&&(this.FAutoCompletion=t,this.UpdateElement())},this.SetAutoFocus=function(t){this.FAutoFocus!==t&&(this.FAutoFocus=t,this.UpdateElement())},this.SetRequired=function(t){this.FRequired=t,this.UpdateElement()},this.SetPattern=function(t){this.FPattern!==t&&(this.FPattern=t,this.UpdateElement())},this.GetSelLength=function(){var t=0;return t=-1,null!=this.GetElementInputHandle()&&(t=this.GetElementInputHandle().selectionEnd-this.GetElementInputHandle().selectionStart),t},this.GetSelStart=function(){var t=0;return t=-1,null!=this.GetElementInputHandle()&&(t=this.GetElementInputHandle().selectionStart),t},this.SetEditType=function(t){this.FEditType!==t&&(this.FEditType=t,this.UpdateElement())},this.SetSpellCheck=function(t){this.FSpellCheck!==t&&(this.FSpellCheck=t,this.UpdateElement())},this.GetElementInputHandle=function(){return this.GetContainer()},this.DoHandlePaste=function(t){var e;return e=(t.clipboardData||window.clipboardData).getData("Text"),this.CanPaste(e)&&this.Validate(e)||(t.preventDefault(),t.stopPropagation()),!1,!1},this.DoHandleCut=function(t){return this.CanCut()||(t.preventDefault(),t.stopPropagation()),!1,!1},this.DoHandleChange=function(t){return this.Change(),!0,""!==this.FRequiredText&&this.GetElementInputHandle().setCustomValidity(""),!0},this.DoHandleInvalid=function(t){return this.GetElementInputHandle().setCustomValidity(this.FRequiredText),!0,!0},this.IsCustomEditor=function(){return!1,!1},this.KeyPress=function(t){var e=!1;pas["WEBLib.Controls"].TControl.KeyPress.call(this,t),e=!0;var i=this.FEditType;3===i?e=t.get().charCodeAt()in rtl.createSet(null,48,57):5===i?e=t.get().charCodeAt()in rtl.createSet(null,48,57,43,45):1===i?e=t.get().charCodeAt()in rtl.createSet(null,48,57,44,46):4===i?e=t.get().charCodeAt()in rtl.createSet(null,48,57,44,46,43,45):2===i&&(e=t.get().charCodeAt()in rtl.createSet(null,48,57,null,65,70)),e||t.set("\0")},this.GetInputType=function(){return"\0"!==this.FPasswordChar?"PASSWORD":this.FNumeric?"NUMBER":this.FEditType in rtl.createSet(1,3)?"TEL":6===this.FEditType?"SEARCH":"TEXT"},this.GetText=function(){var t="";return t=this.FText,null!=this.GetElementInputHandle()&&(t=this.GetElementInputHandle().value),3===this.FCharCase&&(t=pas.SysUtils.UpperCase(t)),0===this.FCharCase&&(t=pas.SysUtils.LowerCase(t)),t},this.GetDisplayText=function(){return this.FText},this.IsReadOnly=function(){return this.FReadOnly},this.Validate=function(t){var e=!1,i=0,s="",n=!1;e=!0;for(var o=1,r=t.length;o<=r;o++){i=o,s=t.charAt(i-1),n=!0;var a=this.FEditType;if(3===a?n=s.charCodeAt()in rtl.createSet(null,48,57):5===a?n=s.charCodeAt()in rtl.createSet(null,48,57,43,45):1===a?n=s.charCodeAt()in rtl.createSet(null,48,57,44,46):4===a?n=s.charCodeAt()in rtl.createSet(null,48,57,44,46,43,45):2===a&&(n=s.charCodeAt()in rtl.createSet(null,48,57,null,65,70)),!n){e=!1;break}}return e},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FHandlePastePtr=null,this.FHandleCutPtr=null,this.FHandleChangePtr=null,this.FHandleInvalidPtr=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),this.FHandlePastePtr=rtl.createCallback(this,"DoHandlePaste"),this.FHandleCutPtr=rtl.createCallback(this,"DoHandleCut"),this.FHandleChangePtr=rtl.createCallback(this,"DoHandleChange"),this.FHandleInvalidPtr=rtl.createCallback(this,"DoHandleInvalid")},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),null!=this.GetElementInputHandle()&&(this.GetElementInputHandle().addEventListener("input",this.FHandleChangePtr),this.GetElementInputHandle().addEventListener("paste",this.FHandlePastePtr),this.GetElementInputHandle().addEventListener("cut",this.FHandleCutPtr),this.GetElementInputHandle().addEventListener("invalid",this.FHandleInvalidPtr))},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.GetElementInputHandle()&&(this.GetElementInputHandle().removeEventListener("input",this.FHandleChangePtr),this.GetElementInputHandle().removeEventListener("paste",this.FHandlePastePtr),this.GetElementInputHandle().removeEventListener("cut",this.FHandleCutPtr),this.GetElementInputHandle().removeEventListener("invalid",this.FHandleInvalidPtr))},this.UpdateElementData=function(){var e=null,i=0,s=0,n=!1;if(pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null!=this.GetElementInputHandle()){if(!this.GetIsLinked()){var o=this.FCharCase;3===o?this.GetElementInputHandle().style.setProperty("text-transform","uppercase"):0===o?this.GetElementInputHandle().style.setProperty("text-transform","lowercase"):2===o?this.GetElementInputHandle().style.setProperty("text-transform","capitalize"):1===o&&this.GetElementInputHandle().style.setProperty("text-transform","initial")}if(this.GetElementInputHandle().readOnly=this.IsReadOnly(),""!==this.FTextHint&&(this.GetElementInputHandle().placeholder=this.FTextHint),!this.GetIsLinked()){this.GetElementInputHandle().setAttribute("type",this.GetInputType()),this.GetElementInputHandle().setAttribute("role","textbox"),52===this.FAutoCompletion?(this.GetElementInputHandle().setAttribute("autocomplete","nope"),this.GetElementInputHandle().removeAttribute("name")):51===this.FAutoCompletion?(this.GetElementInputHandle().setAttribute("autocomplete","off"),this.GetElementInputHandle().removeAttribute("name")):0!==this.FAutoCompletion?(this.GetElementInputHandle().setAttribute("autocomplete","on"),this.GetElementInputHandle().setAttribute("name",t.GetAutoCompletionName(this.FAutoCompletion))):(this.GetElementInputHandle().removeAttribute("autocomplete"),this.GetElementInputHandle().removeAttribute("name"));var r=this.FAlignment;0===r?this.GetElementInputHandle().style.removeProperty("text-align"):2===r?this.GetElementInputHandle().style.setProperty("text-align","center"):1===r&&this.GetElementInputHandle().style.setProperty("text-align","right")}this.FAutoFocus?this.GetElementInputHandle().setAttribute("autofocus",""):this.GetElementInputHandle().removeAttribute("autofocus"),this.FRequired?this.GetElementInputHandle().setAttribute("required",""):this.GetElementInputHandle().removeAttribute("required"),""!==this.FPattern?this.GetElementInputHandle().setAttribute("pattern",this.FPattern):this.GetElementInputHandle().removeAttribute("pattern"),this.FMaxLength<=0?this.GetElementInputHandle().removeAttribute("maxLength"):this.GetElementInputHandle().maxLength=this.FMaxLength,this.GetElementInputHandle().value=this.GetDisplayText(),n="NUMBER"===pas.SysUtils.UpperCase(this.GetInputType()),this.FSpellCheck?this.GetElementInputHandle().removeAttribute("spellcheck"):this.GetElementInputHandle().setAttribute("spellcheck","false"),n||this.GetIsLinked()||this.IsCustomEditor()||(i=this.FSelStart,s=this.FSelStart+this.FSelLength,e=this.GetElementInputHandle(),setTimeout((function(){e.setSelectionRange(i,s)}),1))}},this.SetCharCase=function(t){this.FCharCase!==t&&(this.FCharCase=t,this.UpdateElement())},this.SetMaxLength=function(t){this.FMaxLength!==t&&(this.FMaxLength=t,this.UpdateElementData())},this.SetReadOnly=function(t){this.FReadOnly=t,this.UpdateElement()},this.SetText=function(t){this.FText=t,null!=this.GetElementInputHandle()&&(this.GetElementInputHandle().value=this.GetDisplayText(),this.GetElementInputHandle().readOnly=this.IsReadOnly())},this.SetTextHint=function(t){this.FTextHint=t,this.UpdateElement()},this.CanPaste=function(t){return!0,!0},this.CanCut=function(){return!0,!0},this.CreateInitialize=function(){t.TCustomInput.CreateInitialize.call(this),this.FAutoCompletion=0,this.FEditType=0,this.FText="",this.FCharCase=1,this.FMaxLength=0,this.FReadOnly=!1,this.FTextHint="",this.FPasswordChar="\0",this.FSpellCheck=!0,this.SetHeight(25)},this.Change=function(){null!=this.GetElementHandle()&&(this.FText=this.GetElementInputHandle().value),null!=this.FOnChange&&this.FOnChange(this)},this.SelectAll=function(){null!=this.GetElementInputHandle()&&this.GetElementInputHandle().select()},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TEdit",this.TCustomEdit,(function(){rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment"),e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("AutoCompletion",2,t.$rtti.TAutoCompletion,"FAutoCompletion","SetAutoCompletion",{Default:t.TAutoCompletion.acOff}),e.addProperty("AutoFocus",2,rtl.boolean,"FAutoFocus","SetAutoFocus",{Default:!1}),e.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAutoSize",{Default:!1}),e.addProperty("AutoSelect",2,rtl.boolean,"FAutoSelect","SetAutoSelect",{Default:!1}),e.addProperty("BiDiMode",2,pas["WEBLib.Controls"].$rtti.TBiDiMode,"FBiDiMode","SetBiDiMode",{Default:pas["WEBLib.Controls"].TBiDiMode.bdLeftToRight}),e.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),e.addProperty("CharCase",2,t.$rtti.TEditCharCase,"FCharCase","SetCharCase",{Default:t.TEditCharCase.wecNormal}),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("EditType",2,t.$rtti.TEditType,"FEditType","SetEditType",{Default:t.TEditType.weString}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("HideSelection",2,rtl.boolean,"FHideSelection","SetHideSelection"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("PasswordChar",2,rtl.char,"FPasswordChar","SetPasswordChar",{Default:"\0"}),e.addProperty("Pattern",2,rtl.string,"FPattern","SetPattern"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("MaxLength",2,rtl.longint,"FMaxLength","SetMaxLength",{Default:0}),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("ReadOnly",2,rtl.boolean,"FReadOnly","SetReadOnly",{Default:!1}),e.addProperty("Required",2,rtl.boolean,"FRequired","SetRequired",{Default:!1}),e.addProperty("RequiredText",0,rtl.string,"FRequiredText","FRequiredText"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("SpellCheck",2,rtl.boolean,"FSpellCheck","SetSpellCheck",{Default:!0}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("Text",3,rtl.string,"GetText","SetText"),e.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),e.addProperty("TextHint",2,rtl.string,"FTextHint","SetTextHint"),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TDateTimePicker",this.TCustomInput,(function(){this.$init=function(){t.TCustomInput.$init.call(this),this.FDate=0,this.FTime=0,this.FKind=0,this.FOnChange=null,this.FReadOnly=!1,this.FElementCheck=null,this.FElementPicker=null,this.FShowCheckBox=!1,this.FClickPtr$1=null,this.FHandleChangePtr=null,this.FFocusPtr=null,this.FBlurPtr=null,this.FChecked=!1,this.FShowSeconds=!1,this.FAutoDropDown=!1},this.$final=function(){this.FOnChange=void 0,this.FElementCheck=void 0,this.FElementPicker=void 0,t.TCustomInput.$final.call(this)},this.SetDate=function(t){this.FDate!==t&&(this.FDate=pas.System.Int(t),this.FTime=0,this.UpdateElementData())},this.GetDate=function(){var t,e=0,i="",s="",n="",o=0,r=0,a=0,l=0;return e=pas.System.Int(this.FDate)+pas.System.Frac(this.FTime),null==this.GetElementPicker()||(t=this.GetElementPicker().value,0===this.FKind?(i=pas.System.Copy(t,1,4),s=pas.System.Copy(t,6,2),n=pas.System.Copy(t,9,2),pas.System.val$5(i,{get:function(){return o},set:function(t){o=t}},{get:function(){return l},set:function(t){l=t}}),pas.System.val$5(s,{get:function(){return r},set:function(t){r=t}},{get:function(){return l},set:function(t){l=t}}),pas.System.val$5(n,{get:function(){return a},set:function(t){a=t}},{get:function(){return l},set:function(t){l=t}}),e=0!==o&&0!==r&&0!==a?pas.SysUtils.EncodeDate(o,r,a)+pas.System.Frac(this.FTime):pas.System.Frac(this.FTime)):e=this.FTime),e},this.SetTime=function(t){this.FTime!==t&&(this.FDate=0,this.FTime=t,this.UpdateElementData())},this.GetTime=function(){var t,e=0,i=0;return e=this.FDate>0?pas.System.Frac(this.FTime)+pas.System.Int(this.FDate):pas.System.Frac(this.FTime),null==this.GetElementPicker()||(t=this.GetElementPicker().value,pas.SysUtils.TryStrToTime(t,{get:function(){return i},set:function(t){i=t}})&&(e=i+pas.System.Int(this.FDate))),e},this.SetKind=function(t){var e=0;this.FKind=t,null!=this.GetElementPicker()&&(e=pas.System.Int(this.FDate)+pas.System.Frac(this.FTime),0===t?this.GetElementPicker().setAttribute("type","DATE"):this.GetElementPicker().setAttribute("type","TIME"),this.SetDate(e),this.SetTime(e),this.UpdateElement())},this.SetText=function(t){this.GetElementPicker()},this.GetText=function(){var t="";return t="",null==this.GetElementPicker()?t:t=this.GetElementPicker().value},this.SetReadOnly=function(t){this.FReadOnly=t,this.UpdateElement()},this.SetShowCheckBox=function(t){this.FShowCheckBox!==t&&(this.FShowCheckBox=t,this.UpdateElementVisual())},this.SetChecked=function(t){this.FChecked!==t&&(this.FChecked=t,this.UpdateElementVisual())},this.SetShowSeconds=function(t){this.FShowSeconds!==t&&(this.FShowSeconds=t,this.UpdateElement())},this.DoCheckClick=function(t){return this.FChecked=this.FElementCheck.checked,this.FChecked?this.GetElementPicker().removeAttribute("disabled"):this.GetElementPicker().setAttribute("disabled","true"),!0,!0},this.DoPickerFocus=function(t){return this.GetElementHandle().style.setProperty("outline","auto"),!0,this.DoEnter(),!0},this.DoPickerBlur=function(t){return this.GetElementHandle().style.setProperty("outline","none"),!0,this.DoExit(),!0},this.DoHandleChange=function(t){return this.Change(),!0,!0},this.HandleDoEnter=function(t){var e;return e=pas["WEBLib.Controls"].TControl.HandleDoEnter.call(this,t),this.FAutoDropDown&&this.GetElementPicker().showPicker(),e},this.GetElementBindHandle=function(){return this.GetElementPicker()},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),null!=this.GetContainer()&&this.GetContainer().addEventListener("input",this.FHandleChangePtr),null!=this.FElementCheck&&this.FElementCheck.addEventListener("click",this.FClickPtr$1),null!=this.GetElementPicker()&&(this.GetElementPicker().addEventListener("focus",this.FFocusPtr),this.GetElementPicker().addEventListener("blur",this.FBlurPtr))},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.GetContainer()&&this.GetContainer().removeEventListener("input",this.FHandleChangePtr),null!=this.FElementCheck&&this.FElementCheck.removeEventListener("click",this.FClickPtr$1),null!=this.GetElementPicker()&&(this.GetElementPicker().removeEventListener("focus",this.FFocusPtr),this.GetElementPicker().removeEventListener("blur",this.FBlurPtr))},this.UpdateElementData=function(){var t=null;if(pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null!=(t=this.GetElementPicker())){t.setAttribute("step","1");var e=this.FKind;1===e?(t.value=pas.SysUtils.FormatDateTime(pas.SysUtils.TFormatSettings.Invariant().LongTimeFormat,this.FTime),this.FShowSeconds||t.setAttribute("step","60")):0===e&&(0===this.FDate?t.value="":t.value=pas.SysUtils.FormatDateTime("yyyy-MM-dd",this.FDate)),t.readOnly=this.IsReadOnly(),this.IsEnabled()?t.removeAttribute("disabled"):t.setAttribute("disabled","")}},this.UpdateElementVisual=function(){t.TCustomInput.UpdateElementVisual.call(this),null!=this.GetElementPicker()&&null!=this.GetElementHandle()&&null!=this.FElementCheck&&(this.FElementCheck.setAttribute("type","CHECKBOX"),0===this.FKind?this.GetElementPicker().setAttribute("type","DATE"):this.GetElementPicker().setAttribute("type","TIME"),this.GetElementPicker().style.setProperty("border","none"),this.GetElementPicker().style.setProperty("border-width","0px"),this.GetElementPicker().style.setProperty("outline","none"),this.GetElementPicker().style.setProperty("font-family","inherit"),this.GetElementPicker().style.setProperty("font-size","inherit"),this.GetElementPicker().style.setProperty("width","100%"),this.GetElementPicker().style.setProperty("height","100%"),this.GetElementHandle().style.setProperty("padding","1px"),this.GetElementHandle().style.setProperty("outline","none"),1===this.FBorderStyle?(this.FEnabled?this.GetElementHandle().style.setProperty("border","1px solid"):this.GetElementHandle().style.setProperty("border","1px silver solid"),this.GetElementHandle().style.setProperty("border-radius","3px")):this.GetElementHandle().style.removeProperty("border"),null!=this.FElementCheck&&(this.FShowCheckBox?this.FElementCheck.style.setProperty("display",""):this.FElementCheck.style.setProperty("display","none")),this.FShowCheckBox&&(this.FChecked?this.GetElementPicker().removeAttribute("disabled"):this.GetElementPicker().setAttribute("disabled","true")))},this.CreateElement=function(){var t=null;return t=document.createElement("DIV"),this.FElementCheck=document.createElement("INPUT"),this.FElementPicker=document.createElement("INPUT"),t.appendChild(this.FElementCheck),t.appendChild(this.FElementPicker),t},this.GetInputType=function(){return 0===this.FKind?"DATE":"TIME"},this.Change=function(){this.FTime=this.GetTime(),this.FDate=this.GetDate(),null!=this.FOnChange&&this.FOnChange(this)},this.IsReadOnly=function(){return this.FReadOnly},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FHandleChangePtr=null,this.FBlurPtr=null,this.FFocusPtr=null,this.FClickPtr$1=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),this.FHandleChangePtr=rtl.createCallback(this,"DoHandleChange"),this.FClickPtr$1=rtl.createCallback(this,"DoCheckClick"),this.FFocusPtr=rtl.createCallback(this,"DoPickerFocus"),this.FBlurPtr=rtl.createCallback(this,"DoPickerBlur")},this.GetElementPicker=function(){return this.GetIsLinked()?this.GetElementHandle():this.FElementPicker},this.SetEnabled=function(t){var e=null;pas["WEBLib.Controls"].TControl.SetEnabled.apply(this,arguments),null!=(e=this.GetElementPicker())&&(t?e.removeAttribute("disabled"):e.setAttribute("disabled",""))},this.CreateInitialize=function(){t.TCustomInput.CreateInitialize.call(this),this.SetDate(pas.SysUtils.Now()),this.SetShowFocus(!0),4 in this.FComponentState&&(this.SetWidth(170),this.SetHeight(25)),this.FDate=pas.System.Int(pas.SysUtils.Now()),this.FTime=0,this.FReadOnly=!1,this.FShowSeconds=!0},this.SetFocus=function(){null!=this.GetElementPicker()&&this.GetElementPicker().focus()},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("AutoDropDown",0,rtl.boolean,"FAutoDropDown","FAutoDropDown",{Default:!1}),e.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),e.addProperty("Checked",2,rtl.boolean,"FChecked","SetChecked",{Default:!1}),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("Date",3,pas.System.$rtti.TDate,"GetDate","SetDate"),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("Kind",2,t.$rtti.TDateTimeKind,"FKind","SetKind"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("ReadOnly",2,rtl.boolean,"FReadOnly","SetReadOnly",{Default:!1}),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("ShowCheckBox",2,rtl.boolean,"FShowCheckBox","SetShowCheckBox",{Default:!1}),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("ShowSeconds",2,rtl.boolean,"FShowSeconds","SetShowSeconds",{Default:!0}),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("Text",3,rtl.string,"GetText","SetText"),e.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),e.addProperty("Time",3,pas.System.$rtti.TTime,"GetTime","SetTime"),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TWebDateTimePicker",this.TDateTimePicker,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TButton",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FDefault=!1,this.FButtonType=""},this.SetButtonType=function(t){this.FButtonType=t,this.UpdateElementData()},this.SetDefault=function(t){this.FDefault=t,this.FDefault&&this.SetFocus()},this.CreateElement=function(){var t=null;return(t=document.createElement("BUTTON")).setAttribute("type","BUTTON"),t},this.SetCaption=function(t){this.FCaption!==t&&(pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,t),this.UpdateElementData())},this.UpdateElementData=function(){var t="";pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),this.GetIsLinked()&&""===this.FCaption||null!=this.GetElementHandle()&&((0===this.GetElementHandle().childElementCount||pas.System.Pos("</",this.FCaption)>0||!this.GetIsLinked())&&(this.GetElementHandle().innerHTML=pas["WEBLib.WebTools"].ProcessAccelerator(this.FCaption,{get:function(){return t},set:function(e){t=e}})),""!==t&&this.GetElementHandle().setAttribute("accesskey",t),this.GetElementHandle().setAttribute("role","button"),this.GetElementHandle().setAttribute("aria-label",this.FCaption),""!==this.FButtonType?this.GetElementHandle().setAttribute("type",this.FButtonType):this.GetElementHandle().setAttribute("type","BUTTON"))},this.UpdateElementVisual=function(){var t="";pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null!=this.GetElementHandle()&&(this.GetElementHandle().style.removeProperty("outline"),this.GetElementHandle().style.removeProperty("user-select"),"BTN"===(t=pas.SysUtils.UpperCase(this.FElementClassName))||pas.System.Pos("BTN ",t))},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),4 in this.FComponentState&&""===this.FCaption&&this.SetCaption(this.FName),this.SetColor(-1)},rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),t.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),t.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),t.addProperty("BiDiMode",2,pas["WEBLib.Controls"].$rtti.TBiDiMode,"FBiDiMode","SetBiDiMode",{Default:pas["WEBLib.Controls"].TBiDiMode.bdLeftToRight}),t.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),t.addProperty("ButtonType",2,rtl.string,"FButtonType","SetButtonType"),t.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),t.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),t.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),t.addProperty("Default",2,rtl.boolean,"FDefault","SetDefault"),t.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),t.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),t.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),t.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),t.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),t.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),t.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),t.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),t.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),t.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("Hint",2,rtl.string,"FHint","SetHint"),t.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),t.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),t.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),t.addProperty("Role",3,rtl.string,"GetRole","SetRole"),t.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),t.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),t.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),t.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),t.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),t.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),t.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),t.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),t.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),t.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),t.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),t.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),t.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),t.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),t.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),t.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),t.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),t.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),t.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),t.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),t.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),t.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),t.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),t.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TWebButton",this.TButton,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TCheckBox",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FChecked=!1,this.FState=0,this.FElementButtonClassName="",this.FElementLabelClassName="",this.FOnCheckClick=null},this.$final=function(){this.FOnCheckClick=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),null!=this.GetContainer()&&(this.GetIsLinked()||(this.GetContainer().children.item(1).onclick=rtl.createSafeCallback(this,"HandleLabelClick")))},this.UpdateElementData=function(){var t=null;pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null!=this.GetContainer()&&((t=this.GetCheckElement()).disabled=!this.IsEnabled(),t.checked=this.FChecked,t.indeterminate=1===this.GetState(),this.GetIsLinked()||(""!==this.FCaption&&(this.GetContainer().lastElementChild.innerHTML=this.FCaption),this.GetElementHandle().setAttribute("tabindex","-1"),this.GetElementHandle().firstChild.setAttribute("tabindex","-1")),this.FTabStop&&this.GetContainer().setAttribute("tabindex",pas.SysUtils.IntToStr(this.FTabOrder)))},this.UpdateElementSize=function(){pas["WEBLib.Controls"].TControl.UpdateElementSize.call(this),null==this.GetContainer()||this.GetIsLinked()||0!==this.FElementPosition||(2!==this.FHeightStyle?this.GetContainer().firstElementChild.style.setProperty("height","100%"):this.GetContainer().firstElementChild.style.removeProperty("height"))},this.UpdateElementVisual=function(){var t=null,e=null,i=null,s=!1;pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null!=this.GetElementHandle()&&(null!=(t=this.GetElementHandle().firstChild)&&(null!=t.style&&t.style.setProperty("margin-right","4px"),""!==this.FElementButtonClassName?t.setAttribute("class",this.FElementButtonClassName):t.removeAttribute("class")),null!=(e=this.GetElementHandle().lastElementChild)&&(""!==this.FElementLabelClassName?e.setAttribute("class",this.FElementLabelClassName):e.removeAttribute("class")),this.FTabStop&&this.FShowFocus&&""===this.FElementClassName||this.GetElementHandle().style.setProperty("outline","none"),this.GetIsLinked()||(this.GetElementHandle().style.setProperty("user-select","none"),0===this.FElementPosition&&(""===this.FElementButtonClassName&&(t.style.setProperty("float","left"),2===this.FHeightStyle?t.style.removeProperty("height"):0===this.FElementPosition&&t.style.setProperty("height","100%"),t.style.setProperty("vertical-align","middle"),t.style.setProperty("margin-top","0px"),t.style.setProperty("margin-bottom","0px")),s=null!=(i=pas["WEBLib.Forms"].GetParentForm(this))&&1===i.FCSSLibrary,(""===this.FElementLabelClassName||s)&&((e=this.GetContainer().lastElementChild).style.setProperty("vertical-align","middle"),e.style.setProperty("min-height","100%"),e.style.setProperty("height","100%"),e.style.setProperty("position","absolute"),e.style.setProperty("overflow","hidden"),e.style.setProperty("display","inline-flex"),e.style.setProperty("align-items","center")))))},this.CreateElement=function(){var t=null,e=null,i=null;return t=document.createElement("SPAN"),e=document.createElement("INPUT"),i=document.createElement("SPAN"),e.setAttribute("TYPE","CHECKBOX"),e.setAttribute("id",this.GetID()),e.setAttribute("role","checkbox"),i.setAttribute("id",this.GetID()+"lbl"),i.setAttribute("value",this.GetID()),t.appendChild(e),t.appendChild(i),rtl.asExt(e,HTMLInputElement).onclick=rtl.createSafeCallback(this,"HandleCheckClick"),t},this.SetChecked=function(t){this.FChecked=t,this.FState=t?0:2,this.UpdateElement()},this.GetChecked=function(){return null!=this.GetContainer()&&(this.FChecked=this.GetCheckElement().checked),this.FChecked},this.SetState=function(t){this.FState=t,this.FChecked=0===this.FState,this.UpdateElement()},this.GetState=function(){return this.FState},this.SetCaption=function(t){this.FCaption!==t&&(pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,t),null==this.GetContainer()||this.GetIsLinked()||null!=this.GetContainer().lastElementChild&&(this.GetContainer().lastElementChild.innerHTML=t))},this.SetEnabled=function(t){pas["WEBLib.Controls"].TControl.SetEnabled.apply(this,arguments),null!=this.GetContainer()&&(this.GetCheckElement().disabled=!t)},this.HandleLabelClick=function(t){var e=null;return null!=this.GetContainer()&&this.FEnabled&&((e=this.GetCheckElement()).checked=!e.checked,this.SetChecked(e.checked)),this.DoCheckClick(),!0,!0},this.HandleCheckClick=function(t){return this.DoCheckClick(),!0,!0},this.Click=function(){pas["WEBLib.Controls"].TControl.Click.call(this),this.FChecked=this.GetChecked(),this.FChecked?this.FState=0:this.FState=2,this.SetFocus()},this.DoCheckClick=function(){null!=this.FOnCheckClick&&this.FOnCheckClick(this)},this.GetCheckElement=function(){return this.GetIsLinked()?this.GetElementHandle():this.GetContainer().firstElementChild},this.KeyPress=function(t){var e=null;pas["WEBLib.Controls"].TControl.KeyPress.apply(this,arguments)," "===t.get()&&null!=this.GetContainer()&&((e=this.GetCheckElement()).checked=!e.checked)},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.SetColor(-1),this.FChecked=!1,this.FState=2,4 in this.FComponentState&&""===this.FCaption&&this.SetCaption(this.FName),this.SetShowFocus(!0)},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("Checked",3,rtl.boolean,"GetChecked","SetChecked",{Default:!1}),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:-1}),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementButtonClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementButtonClassName","FElementButtonClassName"),e.addProperty("ElementLabelClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementLabelClassName","FElementLabelClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("State",3,t.$rtti.TCheckBoxState,"GetState","SetState"),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TWebCheckBox",this.TCheckBox,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TRadioButton",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FChecked=!1,this.FGroupName="",this.FElementButtonClassName="",this.FElementLabelClassName=""},this.CreateElement=function(){var t=null,e=null,i=null;return t=document.createElement("SPAN"),e=document.createElement("INPUT"),i=document.createElement("SPAN"),t.addEventListener("click",rtl.createCallback(this,"HandleLabelClick")),e.setAttribute("TYPE","RADIO"),e.setAttribute("id",this.GetID()+"rd"),e.setAttribute("name",this.FGroupName),e.setAttribute("role","radio"),e.setAttribute("tabindex","-1"),e.addEventListener("click",rtl.createCallback(this,"HandleRadioClick")),i.setAttribute("id",this.GetID()+"lbl"),i.setAttribute("value",this.GetID()),t.appendChild(e),t.appendChild(i),t},this.SetChecked=function(t){this.FChecked=t,null!=this.GetContainer()&&(this.GetRadioElement().checked=t)},this.GetChecked=function(){var t=!1;return t=this.FChecked,null!=this.GetContainer()&&(t=this.GetRadioElement().checked),t},this.SetEnabled=function(t){pas["WEBLib.Controls"].TControl.SetEnabled.apply(this,arguments),null!=this.GetContainer()&&(this.GetRadioElement().disabled=!t)},this.SetCaption=function(t){this.FCaption!==t&&(pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,t),null==this.GetContainer()||this.GetIsLinked()||(this.GetContainer().lastElementChild.innerHTML=t))},this.SetGroupName=function(t){this.FGroupName=t,this.UpdateElementData()},this.HandleLabelClick=function(t){return null!=this.GetContainer()&&this.FEnabled&&(this.GetRadioElement().checked=!0),!0,!0},this.HandleRadioClick=function(t){return this.SetFocus(),!0,!0},this.UpdateElementSize=function(){pas["WEBLib.Controls"].TControl.UpdateElementSize.call(this),null==this.GetContainer()||this.GetIsLinked()||(2!==this.FHeightStyle?this.GetContainer().firstElementChild.style.setProperty("height","100%"):this.GetContainer().firstElementChild.style.removeProperty("height"))},this.UpdateElementData=function(){var t=null;pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null!=this.GetContainer()&&(this.GetIsLinked()?this.GetElementHandle().setAttribute("name",this.FGroupName):(this.GetContainer().firstElementChild.setAttribute("name",this.FGroupName),(t=this.GetElementHandle().firstChild).disabled=!this.FEnabled),this.GetIsLinked()||(""!==this.FCaption&&(this.GetContainer().lastElementChild.innerHTML=this.FCaption),this.GetElementHandle().setAttribute("tabindex","-1"),this.FTabStop&&null!=t&&t.setAttribute("tabindex","-1")),this.FTabStop&&this.GetContainer().setAttribute("tabindex",pas.SysUtils.IntToStr(this.FTabOrder)))},this.UpdateElementVisual=function(){var e=null,i=null,s=!1,n=null;pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null!=this.GetElementHandle()&&(this.GetIsLinked()||((e=this.GetElementHandle().firstChild).style.setProperty("margin-right","4px"),null!=e&&(""!==this.FElementButtonClassName?e.setAttribute("class",this.FElementButtonClassName):e.removeAttribute("class")),null!=(i=this.GetElementHandle().lastElementChild)&&(""!==this.FElementLabelClassName?i.setAttribute("class",this.FElementLabelClassName):i.removeAttribute("class"))),this.FTabStop&&this.FShowFocus&&""===this.FElementClassName||this.GetElementHandle().style.setProperty("outline","none"),this.GetIsLinked()||(this.GetElementHandle().style.setProperty("user-select","none"),this.GetElementHandle().style.setProperty("white-space","normal"),0===this.FElementPosition&&(""===this.FElementButtonClassName&&(e.style.setProperty("float","left"),2!==this.FHeightStyle?e.style.setProperty("height","100%"):e.style.removeProperty("height"),e.style.setProperty("vertical-align","middle"),e.style.setProperty("margin-top","0px"),e.style.setProperty("margin-bottom","0px")),s=null!=(n=pas["WEBLib.Forms"].GetParentForm(this))&&1===n.FCSSLibrary,(""===this.FElementLabelClassName||s)&&((i=this.GetContainer().lastElementChild).style.setProperty("vertical-align","middle"),i.style.setProperty("min-height","100%"),i.style.setProperty("height","100%"),t.TRadioGroup.isPrototypeOf(this.FParent)||i.style.setProperty("position","absolute"),i.style.setProperty("overflow","hidden"),i.style.setProperty("display","inline-flex"),i.style.setProperty("align-items","center")))))},this.GetRadioElement=function(){return this.GetIsLinked()?this.GetElementHandle():this.GetContainer().firstElementChild},this.KeyPress=function(t){pas["WEBLib.Controls"].TControl.KeyPress.apply(this,arguments)," "===t.get()&&(this.GetRadioElement().checked=!0)},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.SetColor(-1),4 in this.FComponentState&&""===this.FCaption&&this.SetCaption(this.FName),this.FGroupName="",this.SetShowFocus(!0)},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("Checked",3,rtl.boolean,"GetChecked","SetChecked",{Default:!1}),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:-1}),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementButtonClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementButtonClassName","FElementButtonClassName"),e.addProperty("ElementLabelClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementLabelClassName","FElementLabelClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("GroupName",2,rtl.string,"FGroupName","SetGroupName"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TWebRadioButton",this.TRadioButton,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TListBox",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FItems=null,this.FItemIndex=0,this.FMultiSelect=!1,this.FSelected=null,this.FItemHeight=0,this.FSorted=!1,this.FOnChange=null,this.FHandleChangePtr=null,this.FElementItemClassName=""},this.$final=function(){this.FItems=void 0,this.FSelected=void 0,this.FOnChange=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.SetItemHeight=function(t){this.FItemHeight=t},this.SetSorted=function(t){this.FSorted=t,this.FItems.Sort()},this.GetCount=function(){return this.FItems.GetCount()},this.GetElementSelectHandle=function(){return this.GetContainer()},this.DoHandleChange=function(t){return this.Change(),!0,!0},this.DoItemsChange=function(t){this.DoUpdateList()},this.DoUpdateList=function(){var t=0,e=null;if(null!=this.GetContainer()&&!this.IsUpdating()&&"SELECT"===this.GetElementHandle().tagName){for(var i=this.GetContainer().options.length-1;i>=0;i--)t=i,this.GetContainer().remove(t);for(var s=0,n=this.FItems.GetCount()-1;s<=n;s++)t=s,(e=new Option(this.FItems.Get(t))).setAttribute("role","listitem"),""!==this.FElementItemClassName&&e.setAttribute("class",this.FElementItemClassName),1===this.FDragMode&&e.setAttribute("draggable","true"),this.GetContainer().add(e),this.SetSelected(t,!1);this.UpdateElementData()}},this.GetItemIndex=function(){var t=0;return t=this.FItemIndex,null!=this.GetContainer()&&(t=this.GetContainer().selectedIndex),t},this.CreateElement=function(){var t=null;return(t=document.createElement("SELECT")).setAttribute("Size","2"),t},this.SetSelected=function(t,e){for(;t>=this.FSelected.GetCount();)this.FSelected.Add(!1);this.FSelected.Put(t,e),null!=this.GetContainer()&&(this.GetContainer().options.item(t).selected=e)},this.SetItems=function(t){this.FItems.Assign(t)},this.SetItemIndex=function(t){this.FItemIndex!==t&&(this.FItemIndex=t,this.UpdateElement())},this.SetMultiSelect=function(t){this.FMultiSelect=t,null!=this.GetContainer()&&(this.GetContainer().multiple=t)},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.DoUpdateList(),this.UpdateElement()},this.UpdateElementData=function(){pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null!=this.GetElementSelectHandle()&&(this.GetElementSelectHandle().style.setProperty("overflow","auto"),this.GetElementSelectHandle().selectedIndex=this.FItemIndex)},this.UpdateElementVisual=function(){pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null!=this.GetElementSelectHandle()&&(this.GetElementSelectHandle().style.setProperty("overflow","auto"),this.GetElementSelectHandle().setAttribute("role","listbox"),this.GetElementSelectHandle().setAttribute("aria-busy","true"))},this.UpdateParent=function(){pas["WEBLib.Controls"].TControl.UpdateParent.call(this),this.DoUpdateList()},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),null!=this.GetElementHandle()&&this.GetElementHandle().addEventListener("change",this.FHandleChangePtr)},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.GetElementHandle()&&this.GetElementHandle().removeEventListener("change",this.FHandleChangePtr)},this.Change=function(){null!=this.FOnChange&&this.FOnChange(this)},this.EnableDrag=function(){var t=0;if(null!=this.GetContainer())for(var e=0,i=this.GetContainer().options.length-1;e<=i;e++)t=e,this.GetContainer().options.item(t).setAttribute("draggable","true")},this.DisableDrag=function(){var t=0;if(null!=this.GetContainer())for(var e=0,i=this.GetContainer().options.length-1;e<=i;e++)t=e,this.GetContainer().options.item(t).setAttribute("draggable","false")},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FHandleChangePtr=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),this.FHandleChangePtr=rtl.createCallback(this,"DoHandleChange")},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FItems=pas.Classes.TStringList.$create("Create$1"),this.FItems.SetSkipLastLineBreak(!0),this.FItems.FOnChange=rtl.createCallback(this,"DoItemsChange"),this.FMultiSelect=!1,this.FSelected=pas.Classes.TList.$create("Create$1"),this.FItemIndex=-1,this.SetShowFocus(!0),4 in this.FComponentState&&(this.SetWidth(160),this.SetHeight(180))},this.Destroy=function(){rtl.free(this,"FItems"),rtl.free(this,"FSelected"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.EndUpdate=function(){pas["WEBLib.Controls"].TCustomControl.EndUpdate.call(this),this.DoUpdateList()},rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),t.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),t.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),t.addProperty("BiDiMode",2,pas["WEBLib.Controls"].$rtti.TBiDiMode,"FBiDiMode","SetBiDiMode",{Default:pas["WEBLib.Controls"].TBiDiMode.bdLeftToRight}),t.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),t.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),t.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),t.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),t.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),t.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),t.addProperty("ElementItemClassName",0,rtl.string,"FElementItemClassName","FElementItemClassName"),t.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),t.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),t.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),t.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),t.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),t.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),t.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("Hint",2,rtl.string,"FHint","SetHint"),t.addProperty("ItemHeight",2,rtl.longint,"FItemHeight","SetItemHeight"),t.addProperty("ItemIndex",3,rtl.longint,"GetItemIndex","SetItemIndex",{Default:-1}),t.addProperty("Items",2,pas.Classes.$rtti.TStrings,"FItems","SetItems"),t.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),t.addProperty("MultiSelect",2,rtl.boolean,"FMultiSelect","SetMultiSelect"),t.addProperty("ParentColor",2,rtl.boolean,"FParentColor","SetParentColor",{Default:!1}),t.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),t.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),t.addProperty("Role",3,rtl.string,"GetRole","SetRole"),t.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),t.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),t.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),t.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),t.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),t.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),t.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),t.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),t.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),t.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),t.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),t.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),t.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),t.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),t.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),t.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),t.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),t.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),t.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),t.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),t.addProperty("OnMouseWheel",0,pas["WEBLib.Controls"].$rtti.TMouseWheelEvent,"FOnMouseWheel","FOnMouseWheel"),t.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),t.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),t.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),t.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),t.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),t.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),this.TComboBoxStyle={0:"csDropDownList",csDropDownList:0,1:"csDropDown",csDropDown:1},this.$rtti.$Enum("TComboBoxStyle",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TComboBoxStyle}),rtl.createClass(this,"TCustomComboBox",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FItems=null,this.FItemIndex=0,this.FStyle=0,this.FOnChange=null,this.FTextHint="",this.FListName="",this.FText="",this.FHandleChangePtr=null,this.FHandleInputPtr=null,this.FHandleFocusInPtr=null,this.FHandleFocusOutPtr=null,this.FOnFocusOut=null,this.FOnFocusIn=null},this.$final=function(){this.FItems=void 0,this.FOnChange=void 0,this.FOnFocusOut=void 0,this.FOnFocusIn=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.GetText=function(){var t="";return t="",1===this.FStyle?null!=this.GetElementHandle()&&(t=this.GetElementHandle().value):this.GetItemIndex()>=0&&(t=this.FItems.Get(this.GetItemIndex())),t},this.SetText=function(t){var e=0;if(1===this.FStyle)this.FText=t,this.UpdateElement();else for(var i=0,s=this.FItems.GetCount()-1;i<=s;i++)e=i,t===this.FItems.Get(e)&&this.SetItemIndex(e)},this.SetStyle=function(t){this.FStyle!==t&&(this.FStyle=t,this.GetIsLinked()||this.RecreateElement())},this.GetElementSelectHandle=function(){return this.GetContainer()},this.SetTextHint=function(t){this.FTextHint!==t&&(this.FTextHint=t,this.DoUpdateList())},this.DoHandleChange=function(t){return this.Change(),!0,!0},this.DoHandleInput=function(t){return 1===this.FStyle&&this.Change(),!0,!0},this.DoHandleFocusIn=function(t){return null!=this.FOnFocusIn&&this.FOnFocusIn(this),!0,!0},this.DoHandleFocusOut=function(t){return null!=this.FOnFocusOut&&this.FOnFocusOut(this),!0,!0},this.DoItemsChange=function(t){this.DoUpdateList()},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FHandleChangePtr=null,this.FHandleInputPtr=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),this.FHandleChangePtr=rtl.createCallback(this,"DoHandleChange"),this.FHandleInputPtr=rtl.createCallback(this,"DoHandleInput"),this.FHandleFocusInPtr=rtl.createCallback(this,"DoHandleFocusIn"),this.FHandleFocusOutPtr=rtl.createCallback(this,"DoHandleFocusOut")},this.AddTextHint=function(){var t=null;""!==this.FTextHint&&0===this.FStyle&&((t=document.createElement("OPTION")).setAttribute("value",""),t.setAttribute("disabled","true"),t.setAttribute("selected","true"),t.setAttribute("hidden","true"),t.innerHTML=this.FTextHint,this.GetContainer().appendChild(t))},this.DoUpdateList=function(){var t=0,e=0,i="",s="",n="",o=null,r=null;if(null!=this.GetContainer()){if("INPUT"===this.GetElementHandle().tagName){this.GetElementHandle().value=this.GetText(),null!=(r=document.getElementById(this.FName+"_LIST"))&&r.parentNode.removeChild(r),""!==this.FTextHint&&(this.GetElementHandle().placeholder=this.FTextHint),(r=document.createElement("DATALIST")).setAttribute("id",this.FListName),document.body.appendChild(r);for(var a=0,l=this.FItems.GetCount()-1;a<=l;a++)t=a,i=this.FItems.Get(t),o=document.createElement("OPTION"),s=i,n=i,(e=pas.System.Pos(this.FItems.GetNameValueSeparator(),i))>0&&(n=pas.System.Copy(i,1,e-1),s=pas.System.Copy(i,e+1,65535)),o.setAttribute("value",n),o.innerHTML=s,r.appendChild(o)}else{if("SELECT"!==this.GetElementHandle().tagName)return;for(var h=this.GetContainer().options.length-1;h>=0;h--)t=h,this.GetContainer().remove(t);this.AddTextHint();for(var F=0,p=this.FItems.GetCount()-1;F<=p;F++)t=F,i=this.FItems.Get(t),o=document.createElement("OPTION"),s=i,n=i,(e=pas.System.Pos(this.FItems.GetNameValueSeparator(),i))>0&&(n=pas.System.Copy(i,1,e-1),s=pas.System.Copy(i,e+1,65535)),o.setAttribute("value",n),o.innerHTML=s,this.GetContainer().appendChild(o)}this.UpdateElement()}},this.GetItemIndex=function(){var t=0;return 1===this.FStyle?t=this.FItems.IndexOf(this.GetText()):(t=this.FItemIndex,null!=this.GetContainer()&&(t=this.GetContainer().selectedIndex,""!==this.FTextHint&&(t-=1))),t},this.CreateElement=function(){var t=null;return 0===this.FStyle?t=document.createElement("SELECT"):(t=document.createElement("INPUT"),this.FListName=this.FName+"_LIST",t.setAttribute("list",this.FListName)),t},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),null!=this.GetElementHandle()&&(this.GetElementHandle().addEventListener("input",this.FHandleInputPtr),this.GetElementHandle().addEventListener("change",this.FHandleChangePtr),this.GetElementHandle().addEventListener("focusin",this.FHandleFocusInPtr),this.GetElementHandle().addEventListener("focusout",this.FHandleFocusOutPtr))},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.GetElementHandle()&&(this.GetElementHandle().removeEventListener("input",this.FHandleInputPtr),this.GetElementHandle().removeEventListener("change",this.FHandleChangePtr),this.GetElementHandle().removeEventListener("focusin",this.FHandleFocusInPtr),this.GetElementHandle().removeEventListener("focusout",this.FHandleFocusOutPtr))},this.UpdateElementData=function(){var t=0;pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),1===this.FStyle?null!=this.GetElementHandle()&&(this.GetElementHandle().value=this.FText,this.FListName=this.FName+"_LIST",this.GetElementHandle().setAttribute("list",this.FListName)):null!=this.GetElementSelectHandle()&&(t=0,""!==this.FTextHint&&(t=1),this.GetElementSelectHandle().selectedIndex=this.FItemIndex+t,this.GetElementSelectHandle().setAttribute("role","combobox"))},this.UpdateParent=function(){pas["WEBLib.Controls"].TControl.UpdateParent.call(this),this.DoUpdateList()},this.SetItems=function(t){this.FItems.Assign(t)},this.SetItemIndex=function(t){this.FItemIndex!==t&&(this.FItemIndex=t,t>=0&&this.FStyle in rtl.createSet(1,0)&&t<this.FItems.GetCount()&&(this.FText=this.FItems.Get(t)),this.UpdateElement())},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.DoUpdateList()},this.Change=function(){this.FItemIndex=this.GetItemIndex(),null!=this.FOnChange&&this.FOnChange(this)},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FItems=pas.Classes.TStringList.$create("Create$1"),this.FItems.FOnChange=rtl.createCallback(this,"DoItemsChange"),this.FItemIndex=-1,this.FStyle=0,this.SetShowFocus(!0),this.SetHeight(25)},this.Destroy=function(){rtl.free(this,"FItems"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TComboBox",this.TCustomComboBox,(function(){rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("BiDiMode",2,pas["WEBLib.Controls"].$rtti.TBiDiMode,"FBiDiMode","SetBiDiMode",{Default:pas["WEBLib.Controls"].TBiDiMode.bdLeftToRight}),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("ItemIndex",3,rtl.longint,"GetItemIndex","SetItemIndex",{Default:-1}),e.addProperty("Items",2,pas.Classes.$rtti.TStrings,"FItems","SetItems"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("Style",2,t.$rtti.TComboBoxStyle,"FStyle","SetStyle"),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("Text",3,rtl.string,"GetText","SetText"),e.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),e.addProperty("TextHint",2,rtl.string,"FTextHint","SetTextHint"),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TWebComboBox",this.TComboBox,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TCustomMemo",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FWordWrap=!1,this.FBlockChange=!1,this.FLines=null,this.FSelStart=0,this.FSelLength=0,this.FCaretPosition=pas.Types.TPoint.$new(),this.FAutoSize=!1,this.FOnChange=null,this.FReadOnly=!1,this.FTextHint="",this.FHandleChangePtr=null,this.FHandlePastePtr=null,this.FHandleCutPtr=null,this.FHandleInputPtr=null,this.FWantTabs=!1,this.FAutoCompletion=0,this.FSpellCheck=!1,this.FModified=!1},this.$final=function(){this.FLines=void 0,this.FCaretPosition=void 0,this.FOnChange=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.GetText=function(){return null!=this.GetElementInputHandle()&&(this.FBlockChange=!0,this.FLines.SetTextStr(this.GetElementInputHandle().value),this.FBlockChange=!1),this.FLines.GetTextStr()},this.SetText=function(t){this.FLines.SetTextStr(t)},this.SetSelLength=function(t){this.FSelLength!==t&&(this.FSelLength=t,this.UpdateElement())},this.SetSelStart=function(t){this.FSelStart!==t&&(this.FSelStart=t,this.UpdateElement())},this.SetAutoSize=function(t){this.FAutoSize!==t&&(this.FAutoSize=t,this.UpdateElement())},this.GetElementInputHandle=function(){return this.GetContainer()},this.SetReadOnly=function(t){this.FReadOnly!==t&&(this.FReadOnly=t,this.UpdateElement())},this.GetSelLength=function(){var t=0;return t=-1,null!=this.GetElementInputHandle()&&(t=this.GetElementInputHandle().selectionEnd-this.GetElementInputHandle().selectionStart),t},this.GetSelStart=function(){var t=0;return t=-1,null!=this.GetElementInputHandle()&&(t=this.GetElementInputHandle().selectionStart),t},this.SetSpellCheck=function(t){this.FSpellCheck!==t&&(this.FSpellCheck=t,this.UpdateElement())},this.IsInputControl=function(){return!0,!0},this.HandleDoKeyDown=function(t){var e=!1,i=null;if(9===this.GetKeyCode(t.key,!0)&&this.FWantTabs){var s=(i=this.GetElementInputHandle()).selectionStart,n=i.selectionEnd;i.value=i.value.substring(0,s)+"\t"+i.value.substring(n),i.selectionStart=i.selectionEnd=s+1,t.stopPropagation(),t.preventDefault()}else pas["WEBLib.Controls"].TControl.HandleDoKeyDown.apply(this,arguments);return e},this.CreateElement=function(){return document.createElement("TEXTAREA")},this.DoHandlePaste=function(t){var e;return e=(t.clipboardData||window.clipboardData).getData("Text"),this.CanPaste(e)||(t.preventDefault(),t.stopPropagation()),!1,!1},this.DoHandleCut=function(t){return this.CanCut()||(t.preventDefault(),t.stopPropagation()),!1,!1},this.DoHandleInput=function(t){return this.GetText(),this.Change(),!0,!0},this.DoHandleChange=function(t){return this.FModified=!0,this.Change(),!0,!0},this.IsReadOnly=function(){return this.FReadOnly},this.GetDisplayText=function(){return this.FLines.GetTextStr()},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),null!=this.GetElementInputHandle()&&(this.GetElementInputHandle().addEventListener("input",this.FHandleInputPtr),this.GetElementInputHandle().addEventListener("change",this.FHandleChangePtr),this.GetElementInputHandle().addEventListener("paste",this.FHandlePastePtr),this.GetElementInputHandle().addEventListener("cut",this.FHandleCutPtr))},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.GetElementInputHandle()&&(this.GetElementInputHandle().removeEventListener("input",this.FHandleInputPtr),this.GetElementInputHandle().removeEventListener("change",this.FHandleChangePtr),this.GetElementInputHandle().removeEventListener("paste",this.FHandlePastePtr),this.GetElementInputHandle().removeEventListener("cut",this.FHandleCutPtr))},this.UpdateElementData=function(){var e=0,i=0,s=null;pas["WEBLib.Controls"].TControl.UpdateElementData.call(this),null==this.GetElementInputHandle()||this.FBlockChange||(this.GetElementInputHandle().value=this.GetDisplayText(),"TEXTAREA"===this.GetElementInputHandle().tagName&&this.GetElementInputHandle().setSelectionRange(this.GetSelStart(),this.GetSelStart()+this.GetSelLength()),this.GetIsLinked()||this.GetElementInputHandle().style.setProperty("resize","none"),this.GetElementInputHandle().readOnly=this.IsReadOnly(),""!==this.FTextHint&&(this.GetElementInputHandle().placeholder=this.FTextHint),this.GetIsLinked()||(51===this.FAutoCompletion?(this.GetElementInputHandle().setAttribute("autocomplete","none"),this.GetElementInputHandle().removeAttribute("name")):0!==this.FAutoCompletion?(this.GetElementInputHandle().setAttribute("autocomplete","on"),this.GetElementInputHandle().setAttribute("name",t.GetAutoCompletionName(this.FAutoCompletion))):(this.GetElementInputHandle().removeAttribute("autocomplete"),this.GetElementInputHandle().removeAttribute("name")),e=this.FSelStart,i=this.FSelStart+this.FSelLength,s=this.GetElementInputHandle(),setTimeout((function(){s.setSelectionRange(e,i)}),1)))},this.UpdateElementVisual=function(){pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null==this.GetElementInputHandle()||this.FBlockChange||this.GetIsLinked()||(this.GetElementInputHandle().style.setProperty("overflow","auto"),this.GetElementInputHandle().style.setProperty("margin","0"),-1!==this.FColor&&16711422!==this.FColor?this.GetElementInputHandle().style.setProperty("background-color",pas["WEBLib.Graphics"].ColorToHTML(this.FColor)):this.GetElementInputHandle().style.removeProperty("background-color"),this.FSpellCheck?this.GetElementInputHandle().hasAttribute("spellcheck")&&this.GetElementInputHandle().removeAttribute("spellcheck"):this.GetElementInputHandle().setAttribute("spellcheck","false"),this.FWordWrap?this.GetElementInputHandle().hasAttribute("wrap")&&this.GetElementInputHandle().removeAttribute("wrap"):this.GetElementInputHandle().setAttribute("wrap","off"))},this.SetLines=function(t){this.FLines.Assign(t)},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FHandleChangePtr=null,this.FHandleInputPtr=null,this.FHandlePastePtr=null,this.FHandleCutPtr=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),this.FHandleChangePtr=rtl.createCallback(this,"DoHandleChange"),this.FHandleInputPtr=rtl.createCallback(this,"DoHandleInput"),this.FHandlePastePtr=rtl.createCallback(this,"DoHandlePaste"),this.FHandleCutPtr=rtl.createCallback(this,"DoHandleCut")},this.DoLinesChange=function(t){null==this.GetElementInputHandle()||this.FBlockChange||(this.GetElementInputHandle().value=this.GetDisplayText(),this.GetElementInputHandle().readOnly=this.IsReadOnly())},this.CanPaste=function(t){return!0,!0},this.CanCut=function(){return!0,!0},this.Change=function(){null!=this.FOnChange&&this.FOnChange(this)},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FSpellCheck=!0,this.FLines=pas.Classes.TStringList.$create("Create$1"),this.FLines.SetSkipLastLineBreak(!0),this.FLines.FOnChange=rtl.createCallback(this,"DoLinesChange"),4 in this.FComponentState&&(this.SetWidth(400),this.SetHeight(300)),this.SetShowFocus(!0),this.SetClipChildren(!1),this.FWantTabs=!1,this.FAutoCompletion=0,this.FWordWrap=!0,this.FNoUserSelect=!1},this.Destroy=function(){rtl.free(this,"FLines"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TMemo",this.TCustomMemo,(function(){rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),t.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),t.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),t.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAutoSize"),t.addProperty("BiDiMode",2,pas["WEBLib.Controls"].$rtti.TBiDiMode,"FBiDiMode","SetBiDiMode",{Default:pas["WEBLib.Controls"].TBiDiMode.bdLeftToRight}),t.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),t.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),t.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),t.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),t.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),t.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),t.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),t.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),t.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),t.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),t.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),t.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),t.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("Hint",2,rtl.string,"FHint","SetHint"),t.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),t.addProperty("Lines",2,pas.Classes.$rtti.TStrings,"FLines","SetLines"),t.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),t.addProperty("ParentColor",2,rtl.boolean,"FParentColor","SetParentColor",{Default:!1}),t.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),t.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),t.addProperty("ReadOnly",2,rtl.boolean,"FReadOnly","SetReadOnly"),t.addProperty("Role",3,rtl.string,"GetRole","SetRole"),t.addProperty("SelStart",3,rtl.longint,"GetSelStart","SetSelStart"),t.addProperty("SelLength",3,rtl.longint,"GetSelLength","SetSelLength"),t.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!1}),t.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),t.addProperty("Spellcheck",2,rtl.boolean,"FSpellCheck","SetSpellCheck",{Default:!0}),t.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),t.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),t.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti.TTextDirection,"FTextDirection","FTextDirection",{Default:pas["WEBLib.Controls"].TTextDirection.tdDefault}),t.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),t.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),t.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),t.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),t.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),t.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),t.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),t.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),t.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),t.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),t.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),t.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),t.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),t.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),t.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),t.addProperty("OnMouseWheel",0,pas["WEBLib.Controls"].$rtti.TMouseWheelEvent,"FOnMouseWheel","FOnMouseWheel"),t.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),t.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),t.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),t.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),t.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),t.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TWebMemo",this.TMemo,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TControlGroup",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FControls$1=null,this.FOldCount=0,this.FColumns=0,this.FItems=null,this.FOnChange=null,this.FElementButtonClassName="",this.FElementLabelClassName="",this.FElementGroupClassName="",this.FControlPosition=0,this.FElementLegendClassName=""},this.$final=function(){this.FControls$1=void 0,this.FItems=void 0,this.FOnChange=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.SetControlPosition=function(t){this.FControlPosition!==t&&(this.FControlPosition=t,this.DoUpdateList())},this.CreateElement=function(){var t=null,e=null;return t=document.createElement("FIELDSET"),e=document.createElement("LEGEND"),t.appendChild(e),e.innerHTML=this.FCaption,e.setAttribute("class","w-auto "+this.FElementLegendClassName),""===this.FCaption?e.style.setProperty("display","none"):e.style.setProperty("display",""),e.style.setProperty("float","none"),t.style.setProperty("display","inline-block"),t.style.setProperty("-webkit-padding-before","0px"),t.style.setProperty("-webkit-padding-after","0px"),t.style.setProperty("-webkit-padding-end","0px"),t.style.setProperty("-webkit-padding-start","0px"),t.style.setProperty("border","1px"),t},this.DoHandleClick=function(t){this.Change()},this.DoItemsChange=function(t){this.DoUpdateList()},this.DoControlClick=function(t){this.DoHandleClick(rtl.as(t,pas["WEBLib.Controls"].TCustomControl))},this.SetCaption=function(t){var e=null;pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,t),null!=this.GetContainer()&&null!=(e=this.GetContainer().firstElementChild)&&(e.innerHTML=t,""===t?e.style.setProperty("display","none"):e.style.setProperty("display",""))},this.SetColumns=function(t){this.FColumns>0&&this.FColumns!==t&&(this.FColumns=t,this.DoUpdateList())},this.SetItems=function(t){this.FItems.Assign(t),this.DoUpdateList()},this.DoUpdateList=function(){var e,i,s=0,n="",o=null,r=0,a=0,l=0,h=0,F=null,p=[];if(null!=this.GetContainer()&&0!==this.FItems.GetCount()){i=Math.round(2.5*this.FFont.FSize),e=rtl.trunc(this.GetWidth()/this.FColumns),r=""!==this.FCaption?this.FFont.FSize:4,a=0,l=0,this.FOldCount>0&&(p=rtl.arraySetLength(p,!1,this.FOldCount));for(var c=0,u=this.FOldCount-1;c<=u;c++)s=c,o=rtl.getObject(this.FControls$1.Get(s)),t.TRadioButton.isPrototypeOf(o)&&(p[s]=rtl.as(o,t.TRadioButton).GetChecked()),t.TCheckBox.isPrototypeOf(o)&&(p[s]=rtl.as(o,t.TCheckBox).GetChecked()),o=rtl.freeLoc(o);for(this.FControls$1.Clear();this.GetContainer().childElementCount>0;)this.GetContainer().removeChild(this.GetContainer().firstChild);""!==this.FCaption&&(F=document.createElement("LEGEND"),this.GetElementHandle().appendChild(F),F.innerHTML=this.FCaption,F.setAttribute("class","w-auto "+this.FElementLegendClassName),F.style.setProperty("float","none"),pas["WEBLib.Controls"].SetHTMLElementFont(F,this.FFont,!(0===this.FElementFont&&""===this.FElementClassName))),""!==this.FElementGroupClassName?this.GetElementHandle().setAttribute("class",this.FElementGroupClassName):this.GetElementHandle().setAttribute("class","border p-2"),this.GetContainer().style.setProperty("margin","0px");for(var T=0,C=this.FItems.GetCount()-1;T<=C;T++)s=T,h=r+l*i,n=this.FItems.Get(s),(o=this.CreateGroupControl(4+a*e,h,s,n,this.FControlPosition,this.GetGroupControlState(s),!0)).SetEnabled(this.FEnabled),this.FControls$1.Add(o),s<=this.FOldCount&&(t.TRadioButton.isPrototypeOf(o)&&rtl.as(o,t.TRadioButton).SetChecked(p[s]),t.TCheckBox.isPrototypeOf(o)&&rtl.as(o,t.TCheckBox).SetChecked(p[s])),this.GetIsLinked()||(o.GetContainer().style.setProperty("float","left"),o.GetContainer().style.setProperty("width",pas.SysUtils.IntToStr(pas.System.Trunc(100/this.FColumns)-5)+"%")),s%this.FColumns==0&&o.GetContainer().style.setProperty("clear","left"),this.GetElementHandle().appendChild(o.GetContainer()),a<this.FColumns-1?a+=1:(a=0,l+=1);this.FOldCount=this.FItems.GetCount()}},this.Change=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.DoUpdateList()},this.CreateGroupControl=function(t,e,i,s,n,o,r){return null,null},this.GetGroupControlState=function(t){return!1,!1},this.GetGroupControl=function(t){return rtl.getObject(this.FControls$1.Get(t))},this.SetEnabled=function(t){var e=0;pas["WEBLib.Controls"].TControl.SetEnabled.apply(this,arguments);for(var i=0,s=this.FControls$1.GetCount()-1;i<=s;i++)e=i,rtl.getObject(this.FControls$1.Get(e)).SetEnabled(t)},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FColumns=1,this.FControls$1=pas.Classes.TList.$create("Create$1"),this.FItems=pas.Classes.TStringList.$create("Create$1"),this.FItems.FOnChange=rtl.createCallback(this,"DoItemsChange"),this.FOldCount=-1,this.FControlPosition=0,4 in this.FComponentState&&(this.SetWidth(200),this.SetHeight(200))},this.Destroy=function(){rtl.free(this,"FControls$1"),rtl.free(this,"FItems"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.EndUpdate=function(){pas["WEBLib.Controls"].TCustomControl.EndUpdate.call(this),this.DoUpdateList()},this.SetHeight=function(t){pas["WEBLib.Controls"].TControl.SetHeight.apply(this,arguments),this.DoUpdateList()},this.SetWidth=function(t){pas["WEBLib.Controls"].TControl.SetWidth.apply(this,arguments),this.DoUpdateList()},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("Columns",2,rtl.longint,"FColumns","SetColumns"),e.addProperty("ControlPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FControlPosition","SetControlPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementButtonClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementButtonClassName","FElementButtonClassName"),e.addProperty("ElementGroupClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementGroupClassName","FElementGroupClassName"),e.addProperty("ElementLabelClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementLabelClassName","FElementLabelClassName"),e.addProperty("ElementLegendClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementLegendClassName","FElementLegendClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Items",2,pas.Classes.$rtti.TStrings,"FItems","SetItems"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TRadioGroup",this.TControlGroup,(function(){this.$init=function(){t.TControlGroup.$init.call(this),this.FItemIndex=0,this.FOldItemIndex=0},this.DoHandleClick=function(t){this.GetItemIndex()!==this.FOldItemIndex&&(this.Change(),this.FOldItemIndex=this.GetItemIndex())},this.GetItemIndex=function(){var t=0,e=null,i=0;t=this.FItemIndex;for(var s=0,n=this.FItems.GetCount()-1;s<=n;s++)i=s,null!=(e=document.getElementById(this.GetID()+pas.SysUtils.IntToStr(i)+"rd"))&&e.checked&&(t=i);return t},this.SetItemIndex=function(t){var e=null;-1===t&&this.GetItemIndex()>=0?(null!=(e=document.getElementById(this.GetID()+pas.SysUtils.IntToStr(this.GetItemIndex())+"rd"))&&(e.checked=!1),this.FItemIndex=-1):(this.FItemIndex=t,t>=0&&t<this.FItems.GetCount()&&null!=(e=document.getElementById(this.GetID()+pas.SysUtils.IntToStr(t)+"rd"))&&(e.checked=!0))},this.CreateGroupControl=function(e,i,s,n,o,r,a){var l=null,h="";return""===(h=this.GetID())&&(h=this.FName),(l=t.TRadioButton.$create("Create$2",[h+pas.SysUtils.IntToStr(s)])).SetElementPosition(o),l.SetElementFont(this.FElementFont),l.SetElementClassName(this.FElementClassName),l.FElementButtonClassName=this.FElementButtonClassName,l.FElementLabelClassName=this.FElementLabelClassName,l.SetHeightStyle(2),l.SetParentFont(!1),l.FFont.Assign(this.FFont),l.SetParent(this),l.SetCaption(n),l.SetGroupName(h),l.SetTop(i),l.SetLeft(e),l.SetWidthStyle(2),l.SetWidthPercent(100),l.FOnClick=rtl.createCallback(this,"DoControlClick"),l.SetChecked(r),l.SetEnabled(a),l.FTag$1=s,l.SetTabStop(!0),l},this.GetGroupControlState=function(t){return t===this.FItemIndex},this.CreateInitialize=function(){t.TControlGroup.CreateInitialize.call(this),this.FItemIndex=-1,this.FOldItemIndex=-2},this.SetFocus=function(){var t=0,e=null;0!==this.FItems.GetCount()&&((t=this.GetItemIndex())<0&&(t=0),null!=(e=this.GetGroupControl(t))&&e.SetFocus())},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("ItemIndex",3,rtl.longint,"GetItemIndex","SetItemIndex")})),rtl.createClass(this,"TScrollBarContent",pas["WEBLib.Controls"].TCustomControl,(function(){this.CreateElement=function(){return document.createElement("SPAN")},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TScrollBar",pas["WEBLib.Controls"].TCustomControl,(function(){this.$init=function(){pas["WEBLib.Controls"].TCustomControl.$init.call(this),this.FScrolling=!1,this.FContent=null,this.FKind=0,this.FPosition=0,this.FSmallChange=0,this.FMax=0,this.FMin=0,this.FLargeChange=0,this.FPageSize=0,this.FOnChange=null,this.FScrollPtr=null},this.$final=function(){this.FContent=void 0,this.FOnChange=void 0,pas["WEBLib.Controls"].TCustomControl.$final.call(this)},this.SetKind=function(t){if(this.FKind!==t){this.FKind=t;var e=this.FKind;0===e?this.SetBounds(this.GetLeft(),this.GetTop(),this.GetHeight(),17):1===e&&this.SetBounds(this.GetLeft(),this.GetTop(),17,this.GetWidth()),this.UpdateElement(),this.UpdateContent()}},this.SetPosition=function(t){this.FPosition!==t&&(this.FPosition=t,this.UpdateContent())},this.SetMax=function(t){this.FMax!==t&&(this.FMax=t,this.UpdateContent())},this.SetMin=function(t){this.FMin!==t&&(this.FMin=t,this.UpdateContent())},this.SetPageSize=function(t){this.FPageSize!==t&&(this.FPageSize=t,this.UpdateContent())},this.GetPosition=function(){var t=0;if(t=0,null!=this.GetElement()){var e=this.FKind;0===e?t=Math.round(this.GetValue(this.GetElement().scrollLeft)):1===e&&(t=Math.round(this.GetValue(this.GetElement().scrollTop)))}else t=this.FPosition;return t},this.GetPageSize=function(){var t=0;return 0===(t=this.FPageSize)&&(t=25),t},this.GetValue=function(t){var e=0;if(e=0,null!=this.FContent){var i=this.FKind;0===i?this.FContent.GetWidth()>0&&(e=t/this.FContent.GetWidth()*(this.FMax-this.FMin)):1===i&&this.FContent.GetHeight()>0&&(e=t/this.FContent.GetHeight()*(this.FMax-this.FMin))}return e},this.CreateElement=function(){return document.createElement("SPAN")},this.DoScroll=function(t){return this.FScrolling=!0,null!=this.FOnChange&&this.FOnChange(this),this.FScrolling=!1,!0,!0},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),null!=this.GetElementHandle()&&this.GetElementHandle().addEventListener("scroll",this.FScrollPtr)},this.UnbindEvents=function(){pas["WEBLib.Controls"].TControl.UnbindEvents.call(this),null!=this.GetElementHandle()&&this.GetElementHandle().removeEventListener("scroll",this.FScrollPtr)},this.UpdateElementVisual=function(){if(pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null!=this.GetElementHandle()){this.GetElementHandle().style.setProperty("overflow","auto");var t=this.FKind;0===t?(this.GetElementHandle().style.setProperty("overflow-y","hidden"),this.GetElementHandle().style.setProperty("overflow-x","")):1===t&&(this.GetElementHandle().style.setProperty("overflow-y",""),this.GetElementHandle().style.setProperty("overflow-x","hidden"))}},this.UpdateContent=function(){var t,e,i=0,s=0,n=0,o=0;if(null!=this.FContent&&null!=this.GetElementHandle()&&!this.FScrolling){t=this.GetPageSize(),e=(this.FMax-this.FMin)/t;var r=this.FKind;0===r?(s=0,o=this.GetHeight(),n=Math.round(e*this.GetWidth()),i=Math.round((this.FPosition-this.FMin)/(this.FMax-this.FMin)*n)):1===r&&(i=0,n=this.GetWidth(),o=Math.round(e*this.GetHeight()),s=Math.round((this.FPosition-this.FMin)/(this.FMax-this.FMin)*o)),this.FContent.SetBounds(0,0,n,o),this.GetElementHandle().scrollLeft=i,this.GetElementHandle().scrollTop=s}},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.UpdateContent()},this.ClearMethodPointers=function(){pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this),this.FScrollPtr=null},this.GetMethodPointers=function(){pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this),this.FScrollPtr=rtl.createCallback(this,"DoScroll")},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.SetTabStop(!0),this.FKind=0,this.FPosition=0,this.FMin=0,this.FMax=100,this.FSmallChange=1,this.FLargeChange=1,this.FContent=t.TScrollBarContent.$create("Create$1",[this]),this.FContent.SetParent(this),this.FContent.SetWidth(121),this.FContent.SetHeight(17),4 in this.FComponentState&&(this.SetWidth(121),this.SetHeight(17)),this.UpdateContent()},this.Destroy=function(){rtl.free(this,"FContent"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.SetBounds=function(t,e,i,s){pas["WEBLib.Controls"].TControl.SetBounds.apply(this,arguments),this.UpdateContent()},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("Kind",2,pas["WEBLib.Controls"].$rtti.TScrollBarKind,"FKind","SetKind"),e.addProperty("Position",3,rtl.longint,"GetPosition","SetPosition"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("SmallChange",0,rtl.longint,"FSmallChange","FSmallChange"),e.addProperty("LargeChange",0,rtl.longint,"FLargeChange","FLargeChange"),e.addProperty("Max",2,rtl.longint,"FMax","SetMax"),e.addProperty("Min",2,rtl.longint,"FMin","SetMin"),e.addProperty("PageSize",3,rtl.longint,"GetPageSize","SetPageSize"),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),this.GetAutoCompletionName=function(t){var e="";return 0===t?e="":1===t?e="honorific-prefix":2===t?e="given-name":3===t?e="additional-name":4===t?e="family-name":5===t?e="honorific-suffix":6===t?e="nickname":7===t?e="email":8===t?e="username":9===t?e="new-password":10===t?e="current-password":11===t?e="organization-title":12===t?e="organization":13===t?e="street-address":14===t?e="address-line1":15===t?e="address-line2":16===t?e="address-line3":17===t?e="address-level1":18===t?e="address-level2":19===t?e="address-level3":20===t?e="address-level4":21===t?e="country":22===t?e="country-name":23===t?e="postal-code":24===t?e="cc-name":25===t?e="cc-given-name":26===t?e="cc-additional-name":27===t?e="cc-family-name":28===t?e="cc-number":29===t?e="cc-exp":30===t?e="cc-exp-month":31===t?e="cc-exp-year":32===t?e="cc-csc":33===t?e="cc-type":34===t?e="transaction-currency":35===t?e="transaction-amount":36===t?e="language":37===t?e="bday":38===t?e="bday-day":39===t?e="bday-month":40===t?e="bday-year":41===t?e="sex":42===t?e="tel":43===t?e="tel-country-code":44===t?e="tel-national":45===t?e="tel-area-code":46===t?e="tel-local":47===t?e="tel-extension":48===t?e="impp":49===t?e="url":50===t?e="photo":52===t&&(e="nope"),e}})),rtl.module("WEBLib.ExtCtrls",["System","Classes","SysUtils","Types","WEBLib.Controls","WEBLib.StdCtrls","WEBLib.Graphics","Web","JS","WEBLib.WebTools","WEBLib.Menus"],(function(){"use strict";rtl.createClass(this,"TTimer",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FInterval=0,this.FTimerID=0,this.FOnTimer=null,this.FEnabled=!1},this.$final=function(){this.FOnTimer=void 0,pas.Classes.TComponent.$final.call(this)},this.SetEnabled=function(t){this.FEnabled=t,this.DoUpdateTimer()},this.SetInterval=function(t){this.FInterval=t,this.DoUpdateTimer()},this.DoTimer=function(){null!=this.FOnTimer&&this.FOnTimer(this)},this.DoUpdateTimer=function(){this.DoClearTimer(),this.FEnabled&&(this.FTimerID=window.setInterval(rtl.createSafeCallback(this,"DoTimer"),this.FInterval))},this.DoClearTimer=function(){-1!==this.FTimerID&&(window.clearInterval(this.FTimerID),this.FTimerID=-1)},this.Create$1=function(t){return pas.Classes.TComponent.Create$1.apply(this,arguments),this.FInterval=1e3,this.FTimerID=-1,this.SetEnabled(!0),this},this.Destroy=function(){this.DoClearTimer(),pas.Classes.TComponent.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),t.addProperty("Interval",2,rtl.longint,"FInterval","SetInterval",{Default:1e3}),t.addProperty("OnTimer",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnTimer","FOnTimer")})),rtl.createClass(this,"TWebTimer",this.TTimer,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TCustomPanel",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FAutoSize=!1,this.FIsSizing=!1,this.FPadding=null,this.FShowCaption=!1,this.FLabel=null,this.FPanelBody=null,this.FElementBodyClassName="",this.FAlignment=0},this.$final=function(){this.FPadding=void 0,this.FLabel=void 0,this.FPanelBody=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.SetShowCaption=function(t){this.FShowCaption!==t&&(this.FShowCaption=t,this.UpdateElementVisual())},this.SetPadding=function(t){this.FPadding.Assign(t)},this.SetAlignment=function(t){this.FAlignment!==t&&(this.FAlignment=t,this.UpdateElement())},this.CreateElement=function(){var t=null;return t=document.createElement("SPAN"),this.FPanelBody=document.createElement("DIV"),this.FPanelBody.setAttribute("class","card-body"),t.appendChild(this.FPanelBody),t},this.SetCaption=function(t){pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,t),null!=this.GetElementHandle()&&this.FShowCaption&&(null==this.FLabel?(this.FLabel=document.createElement("SPAN"),this.FLabel.innerHTML=this.FCaption,null!=this.GetChildContainer()?this.GetChildContainer().appendChild(this.FLabel):this.GetElementHandle().appendChild(this.FLabel),this.UpdateElementVisual()):this.FLabel.innerHTML=this.FCaption)},this.SetBorderStyle=function(t){pas["WEBLib.Controls"].TCustomControl.SetBorderStyle.apply(this,arguments),this.UpdateElement()},this.SetAutoSize=function(t){this.FAutoSize=t,this.FAutoSize&&!this.IsUpdating()&&this.DoAutoSize()},this.UpdateElementVisual=function(){if(pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this),null!=this.GetElementHandle()){if(this.GetIsLinked()||(this.FAutoSize?(this.GetElementHandle().style.setProperty("overflow",""),this.GetElementHandle().style.setProperty("white-space","normal"),this.FVisible&&this.GetElementHandle().style.setProperty("display","inline")):(this.GetElementHandle().style.setProperty("overflow","hidden"),this.GetElementHandle().style.setProperty("white-space","nowrap"),this.FVisible&&this.GetElementHandle().style.setProperty("display","inline-block")),this.GetElementHandle().style.setProperty("padding-left",pas.SysUtils.IntToStr(this.FPadding.FLeft)+"px"),this.GetElementHandle().style.setProperty("padding-right",pas.SysUtils.IntToStr(this.FPadding.FRight)+"px"),this.GetElementHandle().style.setProperty("padding-top",pas.SysUtils.IntToStr(this.FPadding.FTop)+"px"),this.GetElementHandle().style.setProperty("padding-bottom",pas.SysUtils.IntToStr(this.FPadding.FBottom)+"px"),this.GetElementHandle().style.setProperty("box-sizing","border-box"),""!==this.FElementBodyClassName?this.GetChildContainer().setAttribute("class",this.FElementBodyClassName):this.GetChildContainer().removeAttribute("class")),null!=this.FLabel&&(this.FShowCaption?this.FLabel.innerHTML=this.FCaption:this.FLabel.innerHTML="",this.FVisible)){this.GetElementHandle().style.setProperty("display","flex");var t=this.FAlignment;0===t?this.GetElementHandle().style.setProperty("justify-content","flex-start"):2===t?this.GetElementHandle().style.setProperty("justify-content","center"):1===t&&this.GetElementHandle().style.setProperty("justify-content","flex-end"),this.GetElementHandle().style.setProperty("align-items","center")}this.GetElementHandle().style.setProperty("user-select",""),0===this.FCursor&&this.GetElementHandle().style.setProperty("cursor","")}},this.GetOuterWidth=function(){return pas["WEBLib.Controls"].TControl.GetOuterWidth.call(this)},this.GetOuterHeight=function(){return pas["WEBLib.Controls"].TControl.GetOuterHeight.call(this)},this.GetChildContainer=function(){return null!=this.FPanelBody?this.FPanelBody:pas["WEBLib.Controls"].TControl.GetChildContainer.call(this)},this.RegisterParent=function(t){pas["WEBLib.Controls"].TControl.RegisterParent.apply(this,arguments),this.FAutoSize&&this.DoAutoSize()},this.UnRegisterParent=function(t){pas["WEBLib.Controls"].TControl.UnRegisterParent.apply(this,arguments),this.FAutoSize&&this.DoAutoSize()},this.DoAutoSize=function(){var t=0,e=0,i=0,s=0,n=0,o=null,r=null;if(!this.FIsSizing){if(this.FIsSizing=!0,1===this.FWidthStyle&&1===this.FHeightStyle){s=0,n=0,e=65535,i=65535;for(var a=0,l=this.GetControlsCount()-1;a<=l;a++)t=a,1===this.GetControls(t).FWidthStyle?(this.GetControls(t).GetLeft()+this.GetControls(t).GetWidth()>s&&(s=this.GetControls(t).GetLeft()+this.GetControls(t).GetWidth()),this.GetControls(t).GetLeft()<e&&(e=this.GetControls(t).GetLeft())):null!=(r=this.GetControls(t).GetElementHandle())&&((o=r.getBoundingClientRect()).x-this.GetLeft()+o.width>s&&(s=Math.round(o.x-this.GetLeft()+o.width)),e=0),1===this.GetControls(t).FHeightStyle?(this.GetControls(t).GetTop()+this.GetControls(t).GetHeight()>n&&(n=this.GetControls(t).GetTop()+this.GetControls(t).GetHeight()),this.GetControls(t).GetTop()<i&&(i=this.GetControls(t).GetTop())):null!=(r=this.GetControls(t).GetElementHandle())&&((o=r.getBoundingClientRect()).y-this.GetTop()+o.height>n&&(n=Math.round(o.y-this.GetTop()+o.height)),i=0);if(4 in this.FComponentState&&(0===this.GetControlsCount()||0===s||0===n))return;1===this.FBorderStyle&&(s+=1,n+=1);for(var h=0,F=this.GetControlsCount()-1;h<=F;h++)t=h,this.GetControls(t).SetLeft(this.GetControls(t).GetLeft()-e),this.GetControls(t).SetTop(this.GetControls(t).GetTop()-i);this.SetWidth(s-e),this.SetHeight(n-i)}else this.SetWidth(-1),this.SetHeight(-1);this.UpdateElement(),this.FIsSizing=!1}},this.AlignControl=function(t){pas["WEBLib.Controls"].TControl.AlignControl.apply(this,arguments),this.FAutoSize&&this.DoAutoSize()},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),4 in this.FComponentState&&(this.FEnablePropagation=!0),this.FAutoSize=!1,this.FAlignment=2,this.SetColor(15790320),this.SetTabStop(!1),this.FCustomBorder=!0,this.SetShowCaption(!0),this.FControlStyle=rtl.unionSet(this.FControlStyle,rtl.createSet(0)),this.FLabel=null,this.FPadding=pas["WEBLib.Controls"].TPadding.$create("Create$1"),4 in this.FComponentState&&(this.SetWidth(400),this.SetHeight(300))},this.Destroy=function(){rtl.free(this,"FPadding"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.EndUpdate=function(){pas["WEBLib.Controls"].TCustomControl.EndUpdate.call(this),this.FAutoSize&&this.SetAutoSize(!0)},this.SetBounds=function(t,e,i,s){pas["WEBLib.Controls"].TControl.SetBounds.apply(this,arguments),this.FAutoSize&&this.DoAutoSize()},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TPanel",this.TCustomPanel,(function(){rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),t.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment",{Default:pas.Classes.TAlignment.taCenter}),t.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),t.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),t.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAutoSize",{Default:!1}),t.addProperty("BorderColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FBorderColor","SetBorderColor",{Default:12632256}),t.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),t.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),t.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),t.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),t.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),t.addProperty("ElementBodyClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementBodyClassName","FElementBodyClassName"),t.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),t.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),t.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),t.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),t.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),t.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),t.addProperty("Padding",2,pas["WEBLib.Controls"].$rtti.TPadding,"FPadding","SetPadding"),t.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),t.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),t.addProperty("Role",3,rtl.string,"GetRole","SetRole"),t.addProperty("ShowCaption",2,rtl.boolean,"FShowCaption","SetShowCaption",{Default:!0}),t.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),t.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),t.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),t.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),t.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),t.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),t.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),t.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TWebPanel",this.TPanel,(function(){rtl.addIntf(this,pas.System.IUnknown)}))}),["WEBLib.Utils"]),rtl.module("WEBLib.ComCtrls",["System","Classes","SysUtils","Web","WEBLib.Controls","WEBLib.Graphics","WEBLib.ExtCtrls","WEBLib.Menus"],(function(){"use strict";var t=this;rtl.createClass(this,"TTabSheet",pas["WEBLib.ExtCtrls"].TCustomPanel,(function(){this.$init=function(){pas["WEBLib.ExtCtrls"].TCustomPanel.$init.call(this),this.FTabVisible=!1,this.FPosUpdating=!1,this.FOnShow=null,this.FOnHide=null,this.FMaterialGlyph="",this.FMaterialGlyphColor=0,this.FMaterialGlyphType=0,this.FMaterialGlyphSize=0},this.$final=function(){this.FOnShow=void 0,this.FOnHide=void 0,pas["WEBLib.ExtCtrls"].TCustomPanel.$final.call(this)},this.SetTabVisible=function(e){this.FTabVisible!==e&&(this.FTabVisible=e,null!=this.FParent&&t.TPageControl.isPrototypeOf(this.FParent)&&rtl.as(this.FParent,t.TPageControl).DoUpdateList())},this.GetPageIndex=function(){var e=0,i=0,s=0,n=null;if(e=-1,t.TPageControl.isPrototypeOf(this.FParent)){s=0;for(var o=0,r=(n=rtl.as(this.FParent,t.TPageControl)).GetControlsCount()-1;o<=r;o++)i=o,t.TTabSheet.isPrototypeOf(n.GetControls(i))&&(n.GetControls(i)===this?e=s:s+=1)}return e},this.SetPageIndex=function(t){},this.SetMaterialGlyph=function(e){this.FMaterialGlyph!==e&&(this.FMaterialGlyph=e,t.TPageControl.isPrototypeOf(this.FParent)&&rtl.as(this.FParent,t.TPageControl).DoUpdateList())},this.SetMaterialGlyphColor=function(e){this.FMaterialGlyphColor!==e&&(this.FMaterialGlyphColor=e,t.TPageControl.isPrototypeOf(this.FParent)&&rtl.as(this.FParent,t.TPageControl).DoUpdateList())},this.SetMaterialGlyphSize=function(e){this.FMaterialGlyphSize!==e&&(this.FMaterialGlyphSize=e,t.TPageControl.isPrototypeOf(this.FParent)&&rtl.as(this.FParent,t.TPageControl).DoUpdateList())},this.SetMaterialGlyphType=function(e){this.FMaterialGlyphType!==e&&(this.FMaterialGlyphType=e,t.TPageControl.isPrototypeOf(this.FParent)&&rtl.as(this.FParent,t.TPageControl).DoUpdateList())},this.SetCaption=function(e){pas["WEBLib.ExtCtrls"].TCustomPanel.SetCaption.apply(this,arguments),null!=this.FParent&&t.TPageControl.isPrototypeOf(this.FParent)&&rtl.as(this.FParent,t.TPageControl).DoUpdateList()},this.SetParent=function(e){t.TTabSheet.isPrototypeOf(e)&&t.TPageControl.isPrototypeOf(rtl.as(e,t.TTabSheet).FParent)&&(e=rtl.as(e,t.TTabSheet).FParent),pas["WEBLib.Controls"].TControl.SetParent.call(this,e),null!=this.FParent&&t.TPageControl.isPrototypeOf(this.FParent)&&rtl.as(this.FParent,t.TPageControl).DoUpdateList()},this.ResetUpdate=function(){pas["WEBLib.ExtCtrls"].TCustomPanel.EndUpdate.call(this)},this.CreateInitialize=function(){pas["WEBLib.ExtCtrls"].TCustomPanel.CreateInitialize.call(this),this.FEnablePropagation=!0,this.FControlStyle=rtl.unionSet(this.FControlStyle,rtl.createSet(0)),this.SetColor(16777215),this.SetTabVisible(!0),this.SetShowCaption(!1),this.FPosUpdating=!1,this.FMaterialGlyphSize=18,this.FMaterialGlyphType=0,this.FMaterialGlyphColor=-1},this.EndUpdate=function(){pas["WEBLib.ExtCtrls"].TCustomPanel.EndUpdate.call(this),null!=this.FParent&&t.TPageControl.isPrototypeOf(this.FParent)&&rtl.as(this.FParent,t.TPageControl).DoUpdateList()},this.SetBounds=function(e,i,s,n){pas["WEBLib.ExtCtrls"].TCustomPanel.SetBounds.apply(this,arguments),t.TPageControl.isPrototypeOf(this.FParent)&&!this.FPosUpdating&&(this.FPosUpdating=!0,rtl.as(this.FParent,t.TPageControl).DoUpdateList(),this.FPosUpdating=!1)},this.Destroy=function(){var e=null;e=null,null!=this.FParent&&t.TPageControl.isPrototypeOf(this.FParent)&&(e=rtl.as(this.FParent,t.TPageControl)),pas["WEBLib.ExtCtrls"].TCustomPanel.Destroy.call(this),null!=e&&(e.DoUpdateList(),e.SetTabIndex(0))},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment",{Default:pas.Classes.TAlignment.taCenter}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("BorderColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FBorderColor","SetBorderColor",{Default:12632256}),e.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),e.addProperty("Caption",2,rtl.string,"FCaption","SetCaption"),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementBodyClassName",0,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementBodyClassName","FElementBodyClassName"),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("MaterialGlyph",2,rtl.string,"FMaterialGlyph","SetMaterialGlyph"),e.addProperty("MaterialGlyphColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FMaterialGlyphColor","SetMaterialGlyphColor",{Default:-1}),e.addProperty("MaterialGlyphSize",2,rtl.longint,"FMaterialGlyphSize","SetMaterialGlyphSize",{Default:18}),e.addProperty("MaterialGlyphType",2,pas["WEBLib.Controls"].$rtti.TMaterialGlyphType,"FMaterialGlyphType","SetMaterialGlyphType",{Default:pas["WEBLib.Controls"].TMaterialGlyphType.mgNormal}),e.addProperty("Padding",2,pas["WEBLib.Controls"].$rtti.TPadding,"FPadding","SetPadding"),e.addProperty("PageIndex",7,rtl.longint,"GetPageIndex","SetPageIndex"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("Role",3,rtl.string,"GetRole","SetRole"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("TabVisible",2,rtl.boolean,"FTabVisible","SetTabVisible",{Default:!0}),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnHide",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnHide","FOnHide"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnShow",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnShow","FOnShow"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TWebTabSheet",this.TTabSheet,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TPageControl",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FDesignTime=!1,this.FPrevTabIndex=0,this.FItems=null,this.FTabIndex=0,this.FSelectedColor=0,this.FOnChange=null,this.FSelectedTextColor=0,this.FShowTabs=!1,this.FOldVisible=!1},this.$final=function(){this.FItems=void 0,this.FOnChange=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.SetSelectedColor=function(t){this.FSelectedColor!==t&&(this.FSelectedColor=t,this.DoUpdateList())},this.SetTabIndex=function(t){0 in this.FComponentState&&(this.FTabIndex=t),this.FTabIndex!==t&&t>=0&&t<this.PageCount()&&(this.FTabIndex=t,this.FPrevTabIndex=this.FTabIndex,this.DoUpdateList())},this.SetSelectedTextColor=function(t){this.FSelectedTextColor!==t&&(this.FSelectedTextColor=t,this.DoUpdateList())},this.SetShowTabs=function(t){this.FShowTabs!==t&&(this.FShowTabs=t,this.DoUpdateList())},this.GetPage=function(e){var i=null,s=0,n=0;s=-1,i=null;for(var o=0,r=this.GetControlsCount()-1;o<=r;o++)if(n=o,t.TTabSheet.isPrototypeOf(this.GetControls(n))&&(s+=1),s===e){i=rtl.as(this.GetControls(n),t.TTabSheet);break}return i},this.CreateElement=function(){return document.createElement("SPAN")},this.HandleDoClick=function(t){var e="",i="",s=0,n=null,o=null;return e="",(n=t.target).hasAttribute("id")&&(e=n.getAttribute("id")),""!==e&&(""===(i=this.GetID())&&(i=this.FName),e=pas.SysUtils.StringReplace(e,i+"_","",{}),pas.SysUtils.TryStrToInt(e,{get:function(){return s},set:function(t){s=t}})&&(-1!==this.FTabIndex&&null!=(o=this.GetPage(this.FTabIndex))&&null!=o.FOnHide&&o.FOnHide(o),this.FTabIndex=s,this.DoUpdateList(),-1!==this.FTabIndex&&null!=(o=this.GetPage(this.FTabIndex))&&null!=o.FOnShow&&o.FOnShow(o)),pas["WEBLib.Controls"].TControl.HandleDoClick.apply(this,arguments)),!0},this.HandleDoChange=function(t){return this.FPrevTabIndex!==this.FTabIndex&&(this.FPrevTabIndex=this.FTabIndex,null!=this.FOnChange&&this.FOnChange(this)),!0,!0},this.CanAcceptChild=function(e){var i=null;return i=pas["WEBLib.Controls"].TControl.CanAcceptChild.apply(this,arguments),null==e||t.TTabSheet.isPrototypeOf(e)||(i=this.FParent),i},this.BindEvents=function(){pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this),null!=this.GetElementHandle()&&(this.GetElementHandle().onclick=rtl.createSafeCallback(this,"HandleDoChange"))},this.UpdateElement=function(){pas["WEBLib.Controls"].TControl.UpdateElement.call(this)},this.DoUpdateList=function(){var e=0,i=0,s="",n="",o="",r=null,a=null,l=null,h=null,F=null,p=null,c=null,u="",T="",C="",S="",d=0;if(null!=this.GetContainer()&&null!=this.GetElementHandle()&&!this.IsUpdating()){if(p=null,this.GetControlsCount()>0){this.SetBorderStyle(0),null!=(c=this.GetElementHandle().firstChild)&&"DIV"===c.tagName&&"1"===c.getAttribute("data-design")&&(this.GetElementHandle().removeChild(this.GetElementHandle().firstChild),this.GetElementHandle().style.removeProperty("border")),F=pas.Classes.TStringList.$create("Create$1"),o="{#hidden#}",i=this.FTabIndex;for(var m=0,f=this.GetControlsCount()-1;m<=f;m++)e=m,3 in this.GetControls(e).FComponentState&&e<=this.FTabIndex&&(i+=1),t.TTabSheet.isPrototypeOf(this.GetControls(e))&&!(3 in this.GetControls(e).FComponentState)&&(T="",(p=this.GetControls(e)).FTabVisible?(""!==p.FMaterialGlyph&&(u="",S="",p.FEnabled||(S=" md-light md-inactive"),-1!==p.FMaterialGlyphColor&&(u=";color:"+pas["WEBLib.Graphics"].ColorToHTML(p.FMaterialGlyphColor)),C="pointer-events:none",T='<i class="'+pas["WEBLib.Controls"].GetMaterialClass(p.FMaterialGlyphType)+S+'" style="'+C+";font-size:"+pas.SysUtils.IntToStr(p.FMaterialGlyphSize)+"px"+u+'">'+p.FMaterialGlyph+"</i>&nbsp;"),F.Add(T+p.FCaption)):F.Add(o),p.BeginUpdate(),i===e?p.SetAlign(5):p.SetAlign(0),p.SetAlignWithMargins(!0),p.FMargins.SetLeft(0),p.FMargins.SetRight(0),p.FMargins.SetBottom(0),p.SetBorderStyle(1),p.SetVisible(i===e),p.ResetUpdate(),i===e&&p.GetElementHandle().parentElement.insertBefore(p.GetElementHandle(),null),p.GetElementHandle().style.setProperty("background-color",pas["WEBLib.Graphics"].ColorToHTML(p.FColor)));""===(n=this.GetID())&&(n=this.FName);for(var g=0,y=this.GetContainer().childNodes.length-1;g<=y;g++)e=g,null!=(r=this.GetContainer().childNodes.item(e))&&r.getAttribute("id")===n+"_UL"&&this.GetContainer().removeChild(r);this.GetContainer().setAttribute("class",""),this.FEnabled?this.GetElementHandle().style.setProperty("pointer-events","auto"):this.GetElementHandle().style.setProperty("pointer-events","none"),(a=document.createElement("UL")).setAttribute("class",this.FElementClassName),a.setAttribute("id",n+"_UL"),""!==this.FElementClassName?a.setAttribute("role","tablist"):(a.style.setProperty("list-style-type","none"),a.style.setProperty("margin","0"),a.style.setProperty("padding","0"),a.style.setProperty("display","inline-block")),this.FShowTabs||a.style.setProperty("display","none"),this.GetContainer().appendChild(a);for(var b=0,N=F.GetCount()-1;b<=N;b++)e=b,(s=F.Get(e))!==o&&(""===s&&(s="tab"+pas.SysUtils.IntToStr(e)),l=document.createElement("LI"),""!==this.FElementClassName?l.setAttribute("class","nav-item"):(l.style.setProperty("float","left"),0!==this.FBorderStyle&&l.style.setProperty("border-bottom","1px solid lightgray")),1===this.FDragMode&&l.setAttribute("draggable","true"),pas["WEBLib.Controls"].SetHTMLElementFont(l,this.FFont,!(""===this.FElementClassName&&0===this.FElementFont)),a.appendChild(l),this.FEnabled?(h=document.createElement("A")).setAttribute("href","#"+s):h=document.createElement("SPAN"),1===this.FDragMode&&h.setAttribute("draggable","false"),h.innerHTML=s,h.setAttribute("id",n+"_"+pas.SysUtils.IntToStr(e)),""!==this.FElementClassName?(this.FTabIndex===e?h.setAttribute("class","nav-link active"):h.setAttribute("class","nav-link"),h.setAttribute("role","tab"),h.setAttribute("data-toggle","tab"),h.setAttribute("aria-controls",s),this.FTabIndex===e?h.setAttribute("aria-selected","true"):h.setAttribute("aria-selected","false")):(h.style.setProperty("display","block"),h.style.setProperty("text-align","center"),h.style.setProperty("padding","3px 15px"),h.style.setProperty("text-decoration","none"),h.style.setProperty("min-width","50px"),h.style.setProperty("color","inherit"),h.style.setProperty("font-family","inherit"),h.style.setProperty("font-style","inherit"),h.style.setProperty("font-size","inherit"),this.FEnabled||h.style.setProperty("pointer-events","none"),this.FTabIndex===e&&(-1!==this.FSelectedColor&&h.style.setProperty("background-color",pas["WEBLib.Graphics"].ColorToHTML(this.FSelectedColor)),-1!==this.FSelectedTextColor&&h.style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(this.FSelectedTextColor)))),l.appendChild(h));for(var M=0,B=this.GetControlsCount()-1;M<=B;M++)e=M,t.TTabSheet.isPrototypeOf(this.GetControls(e))&&(d=Math.round(a.offsetHeight)-1,this.GetControls(e).FMargins.SetTop(d),this.GetControls(e).GetElementHandle().style.setProperty("white-space",""));F=rtl.freeLoc(F)}else this.GetIsLinked()||(this.ClearChildElements(),4 in this.FComponentState&&this.RenderDesigning("TWebPageControl",this.GetContainer(),this,!0,""));this.DoUpdateResize(),null!=p&&(p.SetAlign(0),p.SetAlign(5)),this.UpdateElement(),this.GetIsLinked()||0!==this.GetControlsCount()||this.GetElementHandle().style.setProperty("border","1px solid lightgray")}},this.DoUpdateResize=function(){for(var e=0,i=0,s=0,n=this.GetControlsCount()-1;s<=n;s++)e=s,t.TTabSheet.isPrototypeOf(this.GetControls(e))&&this.GetControls(e).SetVisible(!1);for(var o=0,r=this.GetControlsCount()-1;o<=r;o++)e=o,t.TTabSheet.isPrototypeOf(this.GetControls(e))&&(this.GetControls(e).SetVisible(!0),this.GetControls(e).SetAlign(0),this.GetControls(e).SetAlign(5),this.GetControls(e).SetVisible(!1));i=this.FTabIndex;for(var a=0,l=this.GetControlsCount()-1;a<=l;a++)e=a,3 in this.GetControls(e).FComponentState&&e<=this.FTabIndex&&(i+=1),t.TTabSheet.isPrototypeOf(this.GetControls(e))&&this.GetControls(e).SetVisible(i===e)},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.DoUpdateList(),this.SetTabIndex(this.FTabIndex),this.FOldVisible=this.FVisible},this.VisibleChanged=function(){pas["WEBLib.Controls"].TControl.VisibleChanged.call(this),this.FOldVisible!==this.FVisible&&(this.DoUpdateList(),this.FOldVisible=this.FVisible)},this.ItemsChanged=function(e){var i=0,s=null;0===this.PageCount()&&this.FItems.GetCount()>0&&this.GetElementHandle().childElementCount>0&&this.GetElementHandle().removeChild(this.GetElementHandle().firstChild);for(var n=0,o=this.FItems.GetCount()-1;n<=o;n++)i=n,this.PageCount()<=i&&((s=t.TTabSheet.$create("Create$1",[this.FOwner])).SetParent(this),s.SetName(this.FName+"sheet"+pas.SysUtils.IntToStr(i+1))),this.GetPage(i).SetCaption(this.FItems.Get(i));for(var r=this.PageCount()-1;r>=0;r--)(i=r)>=this.FItems.GetCount()&&(s=this.GetPage(i),s=rtl.freeLoc(s));this.DoUpdateList()},this.SetParent=function(e){var i=null,s=null;pas["WEBLib.Controls"].TControl.SetParent.apply(this,arguments),this.FDesignTime&&(s=pas["WEBLib.Forms"].GetParentForm(this),this.FDesignTime=!1,(i=t.TWebTabSheet.$create("Create$1",[s])).SetParent(this),i.SetCaption("Page1"),i.SetName(this.GetUniqueName()),(i=t.TWebTabSheet.$create("Create$1",[s])).SetParent(this),i.SetCaption("Page2"),i.SetName(this.GetUniqueName())),this.DoUpdateList()},this.GetUniqueName=function(){var t,e="",i=0,s=0,n=!1;s=1,t=this.FName+"sheet";do{e=t+pas.SysUtils.IntToStr(s),n=!0;for(var o=0,r=this.FOwner.GetComponentCount()-1;o<=r;o++)if(i=o,this.FOwner.GetComponent(i).FName===e){n=!1,s+=1;break}}while(!n);return e},this.EnableDrag=function(){null!=this.GetContainer()&&function t(e){for(var i=0,s="",n=0,o=e.children.length-1;n<=o;n++)i=n,"LI"===(s=e.children.item(i).tagName)?(e.children.item(i).setAttribute("draggable","true"),t(e.children.item(i))):"A"===s?e.children.item(i).setAttribute("draggable","false"):"UL"===s&&t(e.children.item(i))}(this.GetContainer())},this.DisableDrag=function(){null!=this.GetContainer()&&function t(e){for(var i=0,s="",n=0,o=e.children.length-1;n<=o;n++)i=n,"LI"===(s=e.children.item(i).tagName)?(e.children.item(i).removeAttribute("draggable"),t(e.children.item(i))):"A"===s?e.children.item(i).removeAttribute("draggable"):"UL"===s&&t(e.children.item(i))}(this.GetContainer())},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FDesignTime=4 in this.FComponentState&&!(1 in this.FOwner.FComponentState||0 in this.FOwner.FComponentState),this.FControlStyle=rtl.unionSet(this.FControlStyle,rtl.createSet(0)),this.SetBorderStyle(0),this.FItems=pas.Classes.TStringList.$create("Create$1"),this.FItems.FOnChange=rtl.createCallback(this,"ItemsChanged"),this.FTabIndex=0,this.FPrevTabIndex=this.FTabIndex,this.FShowTabs=!0,this.SetTabStop(!1),this.FSelectedColor=12632256,this.FSelectedTextColor=0,4 in this.FComponentState&&(this.SetWidth(400),this.SetHeight(300)),this.FEnablePropagation=!0,this.FOldVisible=!0},this.Destroy=function(){rtl.free(this,"FItems"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.EndUpdate=function(){pas["WEBLib.Controls"].TCustomControl.EndUpdate.call(this),this.DoUpdateList()},this.PageCount=function(){var e=0,i=0;e=0;for(var s=0,n=this.GetControlsCount()-1;s<=n;s++)i=s,t.TTabSheet.isPrototypeOf(this.GetControls(i))&&(e+=1);return e},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsNone}),e.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default:0}),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti.TElementClassName,"FElementClassName","SetElementClassName"),e.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti.TElementFont,"FElementFont","SetElementFont",{Default:pas["WEBLib.Controls"].TElementFont.efProperty}),e.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti.TElementID,"GetID","SetID"),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("TabIndex",2,rtl.longint,"FTabIndex","SetTabIndex"),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default:!0}),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("ShowTabs",2,rtl.boolean,"FShowTabs","SetShowTabs",{Default:!0}),e.addProperty("SelectedColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FSelectedColor","SetSelectedColor",{Default:12632256}),e.addProperty("SelectedTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FSelectedTextColor","SetSelectedTextColor",{Default:0}),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),this.TProgressBarStyle={0:"pbstNormal",pbstNormal:0,1:"pbstMarquee",pbstMarquee:1,2:"pbstDiv",pbstDiv:2},this.$rtti.$Enum("TProgressBarStyle",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TProgressBarStyle}),this.TProgressBarValue={0:"pbvNone",pbvNone:0,1:"pbvPercentage",pbvPercentage:1,2:"pbvAbsolute",pbvAbsolute:2},this.$rtti.$Enum("TProgressBarValue",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TProgressBarValue}),rtl.createClass(this,"TProgressBar",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FMax=0,this.FMin=0,this.FPosition=0,this.FStyle=0,this.FElementBarClassName="",this.FValue=0},this.SetStyle=function(t){this.FStyle!==t&&(this.FStyle=t,null!=this.GetElementHandle()&&(this.CreateProgressElement(this.GetElementHandle()),this.DoUpdate()))},this.SetElementBarClassName=function(t){this.FElementBarClassName=t,this.DoUpdate()},this.SetValue=function(t){this.FValue=t,this.DoUpdate()},this.CreateElement=function(){var t;return t=document.createElement("SPAN"),this.CreateProgressElement(t),t},this.SetMax=function(t){this.FMax=t,this.DoUpdate()},this.SetMin=function(t){this.FMin=t,this.DoUpdate()},this.SetPosition=function(t){t>=this.FMin&&t<=this.FMax&&(this.FPosition=t,this.DoUpdate())},this.DoUpdate=function(){var t=0,e=0,i=null,s=0;if(null!=this.GetContainer())if(s=this.FMax!==this.FMin?Math.round((this.FPosition-this.FMin)/(this.FMax-this.FMin)*100):0,this.GetIsLinked())"DIV"===this.GetElementHandle().tagName?"progressbar"===this.GetElementHandle().getAttribute("role")?this.GetElementHandle().style.setProperty("width",pas.SysUtils.IntToStr(s)+"%"):this.GetElementHandle().innerHTML=pas.SysUtils.IntToStr(s):this.GetElementHandle().setAttribute("value",pas.SysUtils.IntToStr(s));else if(2===this.FStyle){i=this.GetElementHandle().firstChild,""!==this.FElementClassName&&(i.setAttribute("class",this.FElementClassName),this.GetElementHandle().removeAttribute("class")),i.style.setProperty("height",pas.SysUtils.IntToStr(this.GetHeight())+"px"),1===this.FWidthStyle&&i.style.setProperty("width",pas.SysUtils.IntToStr(this.GetWidth())+"px"),i=i.firstChild,""!==this.FElementBarClassName&&i.setAttribute("class",this.FElementBarClassName),i.setAttribute("role","progressbar"),i.style.setProperty("width",pas.SysUtils.IntToStr(s)+"%");var n=this.FValue;1===n?i.innerHTML=pas.SysUtils.IntToStr(s)+"%":2===n?i.innerHTML=pas.SysUtils.IntToStr(this.FPosition):0===n&&(i.innerHTML="")}else(i=this.GetElementHandle().firstChild).style.setProperty("width","100%"),i.style.setProperty("height","100%"),t=this.FPosition-this.FMin,e=this.FMax-this.FMin,i.setAttribute("max",pas.SysUtils.IntToStr(e)),0===this.FStyle?i.setAttribute("value",pas.SysUtils.IntToStr(t)):i.removeAttribute("value")},this.CreateProgressElement=function(t){for(var e=null;null!=t.firstChild;)t.removeChild(t.firstChild);2===this.FStyle?(e=document.createElement("DIV")).appendChild(document.createElement("DIV")):e=document.createElement("PROGRESS"),t.appendChild(e)},this.CreateInitialize=function(){pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this),this.FMax=100,this.FMin=0,this.FPosition=0,this.FStyle=0},this.AfterLoadDFMValues=function(){pas.Classes.TComponent.AfterLoadDFMValues.call(this),this.DoUpdate()},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),e.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti.TDragMode,"FDragMode","SetDragMode",{Default:pas["WEBLib.Controls"].TDragMode.dmManual}),e.addProperty("ElementBarClassName",2,rtl.string,"FElementBarClassName","SetElementBarClassName"),e.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti.TElementPosition,"FElementPosition","SetElementPosition",{Default:pas["WEBLib.Controls"].TElementPosition.epAbsolute}),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default:100}),e.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FHeightStyle","SetHeightStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("Max",2,rtl.longint,"FMax","SetMax"),e.addProperty("Min",2,rtl.longint,"FMin","SetMin"),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("Position",2,rtl.longint,"FPosition","SetPosition"),e.addProperty("Style",2,t.$rtti.TProgressBarStyle,"FStyle","SetStyle"),e.addProperty("Top",3,rtl.longint,"GetTop","SetTop"),e.addProperty("Value",2,t.$rtti.TProgressBarValue,"FValue","SetValue"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default:100}),e.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti.TSizeStyle,"FWidthStyle","SetWidthStyle",{Default:pas["WEBLib.Controls"].TSizeStyle.ssAbsolute}),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti.TEndDragEvent,"FonEndDrag","FonEndDrag"),e.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti.TStartDragEvent,"FOnStartDrag","FOnStartDrag")})),rtl.createClass(this,"TWebProgressBar",this.TProgressBar,(function(){rtl.addIntf(this,pas.System.IUnknown)}))}),["WEBLib.Forms","WEBLib.Utils"]),rtl.module("WEBLib.Actions",["System","Classes","Web","JS","WEBLib.Controls"],(function(){"use strict";var t=this;this.THTMLEvent={0:"heClick",heClick:0,1:"heDblClick",heDblClick:1,2:"heKeypress",heKeypress:2,3:"heKeydown",heKeydown:3,4:"heKeyup",heKeyup:4,5:"heMouseDown",heMouseDown:5,6:"heMouseMove",heMouseMove:6,7:"heMouseUp",heMouseUp:7,8:"heMouseEnter",heMouseEnter:8,9:"heMouseLeave",heMouseLeave:9,10:"heBlur",heBlur:10,11:"heFocus",heFocus:11,12:"heChange",heChange:12,13:"heSelect",heSelect:13,14:"heInput",heInput:14,15:"heInvalid",heInvalid:15,16:"heCustom",heCustom:16,17:"heNone",heNone:17,18:"heTouchStart",heTouchStart:18,19:"heTouchEnd",heTouchEnd:19,20:"heTouchCancel",heTouchCancel:20,21:"heTouchMove",heTouchMove:21,22:"heWheel",heWheel:22},this.$rtti.$Enum("THTMLEvent",{minvalue:0,maxvalue:22,ordtype:1,enumtype:this.THTMLEvent}),this.THTMLAction={0:"actNone",actNone:0,1:"actSetHidden",actSetHidden:1,2:"actRemoveHidden",actRemoveHidden:2,3:"actToggleHidden",actToggleHidden:3,4:"actSetReadOnly",actSetReadOnly:4,5:"actRemoveReadOnly",actRemoveReadOnly:5,6:"actToggleReadOnly",actToggleReadOnly:6,7:"actSetDisabled",actSetDisabled:7,8:"actRemoveDisabled",actRemoveDisabled:8,9:"actToggleDisabled",actToggleDisabled:9,10:"actClear",actClear:10},this.$rtti.$Enum("THTMLAction",{minvalue:0,maxvalue:10,ordtype:1,enumtype:this.THTMLAction}),rtl.recNewT(this,"TJSEventParameter",(function(){this.JSEvent=null,this.$eq=function(t){return this.JSEvent===t.JSEvent},this.$assign=function(t){return this.JSEvent=t.JSEvent,this},t.$rtti.$Record("TJSEventParameter",{}).addField("JSEvent",pas.Web.$rtti.TJSEvent)})),this.$rtti.$MethodVar("THTMLEventEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Element",pas["WEBLib.Controls"].$rtti.TJSHTMLElementRecord],["Event",this.$rtti.TJSEventParameter]]),methodkind:0}),this.$rtti.$MethodVar("THTMLUpdateEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Element",pas["WEBLib.Controls"].$rtti.TJSHTMLElementRecord],["Event",this.$rtti.TJSEventParameter],["TargetElement",pas["WEBLib.Controls"].$rtti.TJSHTMLElementRecord]]),methodkind:0}),this.$rtti.$inherited("TCustomHTMLEvent",rtl.string,{}),rtl.createClass(this,"TElementAction",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FElementEvent=0,this.FElementID="",this.FOnExecute=null,this.FTag=0,this.FStopPropagation=!1,this.FPreventDefault=!1,this.FElementHandle=null,this.FElementHandles=[],this.FControlHandle=null,this.FHandlePtr=null,this.FCustomEvent="",this.FEnabled=!1,this.FSelector="",this.FControl=null,this.FOnUpdate=null,this.FTargetControl=null,this.FTargetID="",this.FTargetAction=0,this.FTargetSelector="",this.FName=""},this.$final=function(){this.FOnExecute=void 0,this.FElementHandle=void 0,this.FElementHandles=void 0,this.FControlHandle=void 0,this.FControl=void 0,this.FOnUpdate=void 0,this.FTargetControl=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetElementID=function(t){this.FElementID!==t&&(this.FElementID=t,""!==this.FElementID&&(this.FSelector=""))},this.SetSelector=function(t){this.FSelector!==t&&(this.FSelector=t,""!==this.FSelector&&(this.FElementID=""))},this.SetName=function(t){this.FName=t},this.SetElementEvent=function(e){var i;i=null!=this.FCollection&&null!=this.FCollection.Owner()&&0 in rtl.as(this.FCollection.Owner(),t.TElementActionList).FComponentState,this.FElementEvent!==e&&(i||this.UnBind(),this.FElementEvent=e,i||this.Bind())},this.DoHandleEvent=function(e){var i=t.TJSEventParameter.$new(),s=pas["WEBLib.Controls"].TJSHTMLElementRecord.$new(),n=null,o=null,r=0;if(i.JSEvent=e,s.element=e.target,this.FEnabled&&(null!=rtl.as(this.FCollection.Owner(),t.TElementActionList).FOnExecute&&rtl.as(this.FCollection.Owner(),t.TElementActionList).FOnExecute(this.FCollection,this,pas["WEBLib.Controls"].TJSHTMLElementRecord.$clone(s),t.TJSEventParameter.$clone(i)),null!=this.FOnExecute&&this.FOnExecute(this,pas["WEBLib.Controls"].TJSHTMLElementRecord.$clone(s),t.TJSEventParameter.$clone(i))),0!==this.FTargetAction&&(null!=this.FTargetControl&&null!=this.FTargetControl.GetElementHandle()&&this.DoAction(i.JSEvent,s.element,this.FTargetControl.GetElementHandle()),""!==this.FTargetID&&null!=(n=document.getElementById(this.FTargetID))&&this.DoAction(i.JSEvent,s.element,n),""!==this.FTargetSelector&&(o=document.querySelectorAll(this.FTargetSelector)).length>0))for(var a=0,l=o.length-1;a<=l;a++)r=a,this.DoAction(i.JSEvent,s.element,o.item(r));return!0,this.FStopPropagation&&e.stopPropagation(),this.FPreventDefault&&e.preventDefault(),!0},this.DoAction=function(e,i,s){var n=pas["WEBLib.Controls"].TJSHTMLElementRecord.$new(),o=pas["WEBLib.Controls"].TJSHTMLElementRecord.$new(),r=t.TJSEventParameter.$new(),a=this.FTargetAction;1===a?s.setAttribute("hidden","true"):2===a?s.removeAttribute("hidden"):3===a?s.hasAttribute("hidden")?s.removeAttribute("hidden"):s.setAttribute("hidden","true"):4===a?s.setAttribute("readonly","true"):5===a?s.removeAttribute("readonly"):6===a?s.hasAttribute("readonly")?s.removeAttribute("readonly"):s.setAttribute("readonly","true"):7===a?s.setAttribute("disabled","true"):8===a?s.removeAttribute("disabled"):9===a?s.hasAttribute("disabled")?s.removeAttribute("disabled"):s.setAttribute("disabled","true"):10===a&&(s.value=""),null!=this.FOnUpdate&&(n.element=i,o.element=s,r.JSEvent=e,this.FOnUpdate(this,pas["WEBLib.Controls"].TJSHTMLElementRecord.$clone(n),t.TJSEventParameter.$clone(r),pas["WEBLib.Controls"].TJSHTMLElementRecord.$clone(o)),null!=rtl.as(this.FCollection.Owner(),t.TElementActionList).FOnUpdate&&rtl.as(this.FCollection.Owner(),t.TElementActionList).FOnUpdate(this.FCollection,this,pas["WEBLib.Controls"].TJSHTMLElementRecord.$clone(n),t.TJSEventParameter.$clone(r),pas["WEBLib.Controls"].TJSHTMLElementRecord.$clone(o)))},this.BindEvent=function(t,e){var i=t;0===i?e.addEventListener("click",this.FHandlePtr):1===i?e.addEventListener("dblclick",this.FHandlePtr):5===i?e.addEventListener("mousedown",this.FHandlePtr):7===i?e.addEventListener("mouseup",this.FHandlePtr):6===i?e.addEventListener("mousemove",this.FHandlePtr):9===i?e.addEventListener("mouseleave",this.FHandlePtr):8===i?e.addEventListener("mouseenter",this.FHandlePtr):2===i?e.addEventListener("keypress",this.FHandlePtr):3===i?e.addEventListener("keydown",this.FHandlePtr):4===i?e.addEventListener("keyup",this.FHandlePtr):11===i?e.addEventListener("focus",this.FHandlePtr):10===i?e.addEventListener("blur",this.FHandlePtr):12===i?e.addEventListener("change",this.FHandlePtr):13===i?e.addEventListener("select",this.FHandlePtr):15===i?e.addEventListener("invalid",this.FHandlePtr):14===i?e.addEventListener("input",this.FHandlePtr):18===i?e.addEventListener("touchstart",this.FHandlePtr):19===i?e.addEventListener("touchend",this.FHandlePtr):21===i?e.addEventListener("touchmove",this.FHandlePtr):20===i?e.addEventListener("touchcancel",this.FHandlePtr):22===i?e.addEventListener("wheel",this.FHandlePtr):16===i&&""!==this.FCustomEvent&&e.addEventListener(this.FCustomEvent,this.FHandlePtr)},this.UnBindEvent=function(t,e){if(null!=e){var i=this.FElementEvent;0===i?e.removeEventListener("click",this.FHandlePtr):1===i?e.removeEventListener("dblclick",this.FHandlePtr):5===i?e.removeEventListener("mousedown",this.FHandlePtr):7===i?e.removeEventListener("mouseup",this.FHandlePtr):6===i?e.removeEventListener("mousemove",this.FHandlePtr):9===i?e.removeEventListener("mouseleave",this.FHandlePtr):8===i?e.removeEventListener("mouseenter",this.FHandlePtr):2===i?e.removeEventListener("keypress",this.FHandlePtr):3===i?e.removeEventListener("keydown",this.FHandlePtr):4===i?e.removeEventListener("keyup",this.FHandlePtr):11===i?e.removeEventListener("focus",this.FHandlePtr):10===i?e.removeEventListener("blur",this.FHandlePtr):12===i?e.removeEventListener("change",this.FHandlePtr):13===i?e.removeEventListener("select",this.FHandlePtr):15===i?e.removeEventListener("invalid",this.FHandlePtr):14===i?e.removeEventListener("input",this.FHandlePtr):18===i?e.removeEventListener("touchstart",this.FHandlePtr):19===i?e.removeEventListener("touchend",this.FHandlePtr):21===i?e.removeEventListener("touchmove",this.FHandlePtr):20===i?e.removeEventListener("touchcancel",this.FHandlePtr):22===i?e.removeEventListener("wheel",this.FHandlePtr):16===i&&""!==this.FCustomEvent&&e.removeEventListener(this.FCustomEvent,this.FHandlePtr)}},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FHandlePtr=rtl.createCallback(this,"DoHandleEvent"),this.FElementHandle=null,this.FControlHandle=null,this.FTag=0,this.FName="Action"+pas.SysUtils.IntToStr(this.GetIndex()),this.FEnabled=!0,this.FStopPropagation=!0,this.FPreventDefault=!0,this},this.Destroy=function(){this.UnBind(),pas.Classes.TCollectionItem.Destroy.call(this)},this.Assign=function(e){t.TElementAction.isPrototypeOf(e)&&(this.FEnabled=rtl.as(e,t.TElementAction).FEnabled,this.FElementEvent=rtl.as(e,t.TElementAction).FElementEvent,this.FElementID=rtl.as(e,t.TElementAction).FElementID,this.FTag=rtl.as(e,t.TElementAction).FTag,this.FStopPropagation=rtl.as(e,t.TElementAction).FStopPropagation,this.FPreventDefault=rtl.as(e,t.TElementAction).FPreventDefault,this.FCustomEvent=rtl.as(e,t.TElementAction).FCustomEvent,this.FSelector=rtl.as(e,t.TElementAction).FSelector,this.FControl=rtl.as(e,t.TElementAction).FControl,this.FTargetAction=rtl.as(e,t.TElementAction).FTargetAction,this.FTargetControl=rtl.as(e,t.TElementAction).FTargetControl,this.FTargetID=rtl.as(e,t.TElementAction).FTargetID,this.FTargetSelector=rtl.as(e,t.TElementAction).FTargetSelector)},this.Bind=function(){var t=null,e=0,i=null;if(this.UnBind(),null!=this.FControl&&(this.FControlHandle=this.FControl.GetElementHandle(),null!=this.FControlHandle&&this.BindEvent(this.FElementEvent,this.FControlHandle)),""!==this.FElementID&&(null!=this.FElementHandle&&this.UnBindEvent(this.FElementEvent,this.FElementHandle),this.FElementHandle=document.getElementById(this.FElementID),null!=this.FElementHandle&&this.BindEvent(this.FElementEvent,this.FElementHandle)),""!==this.FSelector){t=document.querySelectorAll(this.FSelector),this.FElementHandles=rtl.arraySetLength(this.FElementHandles,null,t.length);for(var s=0,n=t.length-1;s<=n;s++)e=s,i=t.item(e),this.FElementHandles[e]=i,this.BindEvent(this.FElementEvent,i)}},this.UnBind=function(){var t=0;if(null!=this.FControlHandle&&(this.UnBindEvent(this.FElementEvent,this.FControlHandle),this.FControlHandle=null),""!==this.FElementID&&null!=this.FElementHandle&&(this.UnBindEvent(this.FElementEvent,this.FElementHandle),this.FElementHandle=null),""!==this.FSelector&&rtl.length(this.FElementHandles)>0){for(var e=0,i=rtl.length(this.FElementHandles)-1;e<=i;e++)t=e,null!=this.FElementHandles[t]&&this.UnBindEvent(this.FElementEvent,this.FElementHandles[t]),this.FElementHandles[t]=null;this.FElementHandles=rtl.arraySetLength(this.FElementHandles,null,0)}};var e=this.$rtti;e.addProperty("Control",0,pas["WEBLib.Controls"].$rtti.TControl,"FControl","FControl"),e.addProperty("CustomEvent",0,t.$rtti.TCustomHTMLEvent,"FCustomEvent","FCustomEvent"),e.addProperty("Enabled",0,rtl.boolean,"FEnabled","FEnabled",{Default:!0}),e.addProperty("Event",2,t.$rtti.THTMLEvent,"FElementEvent","SetElementEvent",{Default:t.THTMLEvent.heClick}),e.addProperty("ID",2,pas["WEBLib.Controls"].$rtti.TElementID,"FElementID","SetElementID"),e.addProperty("Name",2,rtl.string,"FName","SetName"),e.addProperty("PreventDefault",0,rtl.boolean,"FPreventDefault","FPreventDefault",{Default:!0}),e.addProperty("Selector",2,rtl.string,"FSelector","SetSelector"),e.addProperty("StopPropagation",0,rtl.boolean,"FStopPropagation","FStopPropagation",{Default:!0}),e.addProperty("Tag",0,rtl.longint,"FTag","FTag",{Default:0}),e.addProperty("TargetAction",0,t.$rtti.THTMLAction,"FTargetAction","FTargetAction",{Default:t.THTMLAction.actNone}),e.addProperty("TargetControl",0,pas["WEBLib.Controls"].$rtti.TControl,"FTargetControl","FTargetControl"),e.addProperty("TargetID",0,pas["WEBLib.Controls"].$rtti.TElementID,"FTargetID","FTargetID"),e.addProperty("TargetSelector",0,rtl.string,"FTargetSelector","FTargetSelector"),e.addProperty("OnExecute",0,t.$rtti.THTMLEventEvent,"FOnExecute","FOnExecute"),e.addProperty("OnUpdate",0,t.$rtti.THTMLUpdateEvent,"FOnUpdate","FOnUpdate")})),rtl.createClass(this,"TElementActions",pas.Classes.TOwnedCollection,(function(){this.GetItems=function(t){return this.GetItem(t)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TElementAction),this}})),this.$rtti.$MethodVar("THTMLActionEventEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AAction",this.$rtti.TElementAction],["Element",pas["WEBLib.Controls"].$rtti.TJSHTMLElementRecord],["Event",this.$rtti.TJSEventParameter]]),methodkind:0}),this.$rtti.$MethodVar("THTMLActionUpdateEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AAction",this.$rtti.TElementAction],["Element",pas["WEBLib.Controls"].$rtti.TJSHTMLElementRecord],["Event",this.$rtti.TJSEventParameter],["TargetElement",pas["WEBLib.Controls"].$rtti.TJSHTMLElementRecord]]),methodkind:0}),rtl.createClass(this,"TElementActionList",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FActions=null,this.FOnUpdate=null,this.FOnExecute=null},this.$final=function(){this.FActions=void 0,this.FOnUpdate=void 0,this.FOnExecute=void 0,pas.Classes.TComponent.$final.call(this)},this.SetActions=function(t){this.FActions.Assign(t)},this.BeforeLoadDFMValues=function(){pas.Classes.TComponent.BeforeLoadDFMValues.call(this),this.Loading()},this.CreateActions=function(){return t.TElementActions.$create("Create$3",[this])},this.Create$1=function(t){return pas.Classes.TComponent.Create$1.apply(this,arguments),this.FActions=this.CreateActions(),this},this.Destroy=function(){rtl.free(this,"FActions"),pas.Classes.TComponent.Destroy.call(this)},this.BindActions=function(){var t=0;if(null!=this.FActions)for(var e=0,i=this.FActions.GetCount()-1;e<=i;e++)t=e,this.FActions.GetItems(t).Bind()},this.Loaded=function(){pas.Classes.TComponent.Loaded.call(this),this.BindActions()},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Actions",2,t.$rtti.TElementActions,"FActions","SetActions"),e.addProperty("OnExecute",0,t.$rtti.THTMLActionEventEvent,"FOnExecute","FOnExecute"),e.addProperty("OnUpdate",0,t.$rtti.THTMLActionUpdateEvent,"FOnUpdate","FOnUpdate")}))}),["SysUtils"]),rtl.module("WebLib.SEFNC.Layout",["System","Classes","WEBLib.ExtCtrls","WEBLib.Controls"],(function(){"use strict";var t=this;this.TSEFNCControlAlignment={0:"caNone",caNone:0,1:"caTop",caTop:1,2:"caBottom",caBottom:2,3:"caLeft",caLeft:3,4:"caRight",caRight:4,5:"caClient",caClient:5},rtl.createClass(this,"TSEFNCAlign",pas.System.TObject,(function(){this.GetAlign=function(t){var e=0;e=0;return 1===t?e=1:2===t?e=2:3===t?e=3:4===t?e=4:5===t&&(e=5),e}})),rtl.createClass(this,"TSEFNCLayout",pas["WEBLib.ExtCtrls"].TWebPanel,(function(){this.SetAlignment$1=function(e){this.SetAlign(t.TSEFNCAlign.GetAlign(e))},rtl.addIntf(this,pas.System.IUnknown)}))})),rtl.module("Generics.Strings",["System"],(function(){"use strict";this.$resourcestrings={SArgumentOutOfRange:{org:"Argument out of range"}}})),rtl.module("Generics.Defaults",["System"],(function(){"use strict";rtl.createInterface(this,"IComparer$G19","{505778ED-F783-4456-9691-32F419CC5E18}",["Compare"],pas.System.IUnknown,"IComparer<System.String>"),rtl.createInterface(this,"IComparer$G20","{505778ED-F783-4456-9691-32F419CC5E18}",["Compare"],pas.System.IUnknown,"IComparer<System.TObject>"),rtl.createInterface(this,"IComparer$G26","{505778ED-F783-4456-9691-32F419CC5E18}",["Compare"],pas.System.IUnknown,"IComparer<System.TGuid>"),rtl.createInterface(this,"IComparer$G28","{505778ED-F783-4456-9691-32F419CC5E18}",["Compare"],pas.System.IUnknown,"IComparer<WebLib.SEConstable.Repository.TSERTTKRepoItem>"),rtl.createInterface(this,"IComparer$G30","{505778ED-F783-4456-9691-32F419CC5E18}",["Compare"],pas.System.IUnknown,"IComparer<WebLib.SEConstable.Repository.TSESRepoRoot>"),rtl.createInterface(this,"IComparer$G33","{505778ED-F783-4456-9691-32F419CC5E18}",["Compare"],pas.System.IUnknown,"IComparer<WebLib.SEConstable.Repository.TSESTransformBase>"),rtl.createInterface(this,"IComparer$G34","{505778ED-F783-4456-9691-32F419CC5E18}",["Compare"],pas.System.IUnknown,"IComparer<System.TClass>"),rtl.createInterface(this,"IComparer$G36","{505778ED-F783-4456-9691-32F419CC5E18}",["Compare"],pas.System.IUnknown,"IComparer<WEBLib.TMSFNCPageControl.TTMSFNCPageControlPage>")})),rtl.module("Generics.Collections",["System","Classes","SysUtils","RTLConsts","Types","JS","Generics.Strings","Generics.Defaults"],(function(){"use strict";var t=this;t.$impl;this.TCollectionNotification={0:"cnAdded",cnAdded:0,1:"cnRemoved",cnRemoved:1,2:"cnExtracted",cnExtracted:2},rtl.createClass(this,"EDictionary",pas.SysUtils.Exception,(function(){})),this.TDictionaryOwnership={0:"doOwnsKeys",doOwnsKeys:0,1:"doOwnsValues",doOwnsValues:1},rtl.createClass(this,"TEnumerable$G19",pas.System.TObject,(function(){}),"TEnumerable<System.Longint>"),rtl.recNewT(this,"TPair$G5",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G20",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.String,System.TObject>>"),rtl.createClass(this,"TEnumerator$G22",pas.System.TObject,(function(){}),"TEnumerator<System.String>"),rtl.createClass(this,"TEnumerable$G21",pas.System.TObject,(function(){}),"TEnumerable<System.TObject>"),rtl.createClass(this,"TEnumerable$G22",pas.System.TObject,(function(){}),"TEnumerable<System.String>"),rtl.createClass(this,"TDictionary$G3",this.TEnumerable$G20,(function(){rtl.createClass(this,"TKeyEnumerator",t.TEnumerator$G22,(function(){this.$init=function(){t.TEnumerator$G22.$init.call(this),this.FIter=null,this.FVal=null},this.$final=function(){this.FIter=void 0,this.FVal=void 0,t.TEnumerator$G22.$final.call(this)},this.GetCurrent=function(){return this.DoGetCurrent()},this.DoGetCurrent=function(){return""+this.FVal.value},this.DoMoveNext=function(){return this.FVal=this.FIter.next(),!this.FVal.done},this.Create$1=function(t){return this.FIter=t,this},this.MoveNext$1=function(){return this.DoMoveNext()}}),"TDictionary<System.String,System.TObject>.TKeyEnumerator"),rtl.createClass(this,"TValueCollection",t.TEnumerable$G21,(function(){}),"TDictionary<System.String,System.TObject>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G22,(function(){this.$init=function(){t.TEnumerable$G22.$init.call(this),this.FMap=null},this.$final=function(){this.FMap=void 0,t.TEnumerable$G22.$final.call(this)},this.Create$1=function(t){return this.FMap=t.FMap,this},this.GetEnumerator$1=function(){return t.TDictionary$G3.TKeyEnumerator.$create("Create$1",[this.FMap.keys()])}}),"TDictionary<System.String,System.TObject>.TKeyCollection"),this.$init=function(){t.TEnumerable$G20.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G20.$final.call(this)},this.GetEffectiveKey=function(t){var e="",i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=""+s.value,0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.GetItem=function(e){var i;if(i=this.FMap.get(this.GetEffectiveKey(e)),pas.JS.isUndefined(i))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictKeyNotFound")]);return rtl.getObject(i)},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Clear=function(){var t=null,e=null,i=[],s="",n=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(s=""+(i=e.value)[0],n=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,n,1))}while(!e.done)}},this.GetKeys=function(){return null===this.FKeyCollection&&(this.FKeyCollection=this.TKeyCollection.$create("Create$1",[this])),this.FKeyCollection}}),"TDictionary<System.String,System.TObject>"),rtl.createClass(this,"TCustomList$G10",this.TEnumerable$G21,(function(){this.$init=function(){t.TEnumerable$G21.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G21.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<System.TObject>"),rtl.createClass(this,"TList$G3",this.TCustomList$G10,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.GetItem=function(t){if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return this.FItems[t]},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var n=0,o=rtl.length(i)-1;n<=o;n++)s=n,this.Notify(i[s],1)}},this.Clear=function(){this.SetCount(0),this.SetCapacity(0)}}),"TList<System.TObject>"),rtl.createClass(this,"TObjectList$G1",this.TList$G3,(function(){this.$init=function(){t.TList$G3.$init.call(this),this.FObjectsOwner=!1},this.Notify=function(e,i){t.TCustomList$G10.Notify.call(this,e,i),this.FObjectsOwner&&1===i&&(e=rtl.freeLoc(e))}}),"TObjectList<System.TObject>"),rtl.createClass(this,"TCustomList$G11",this.TEnumerable$G22,(function(){this.$init=function(){t.TEnumerable$G22.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G22.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(""),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<System.String>"),rtl.createClass(this,"TList$G4",this.TCustomList$G11,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,"",t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.GetItem=function(t){if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return this.FItems[t]},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var n=0,o=rtl.length(i)-1;n<=o;n++)s=n,this.Notify(i[s],1)}},this.Clear=function(){this.SetCount(0),this.SetCapacity(0)}}),"TList<System.String>"),rtl.createClass(this,"TCustomList$G12",this.TEnumerable$G19,(function(){this.$init=function(){t.TEnumerable$G19.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G19.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(-2147483648),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)},this.GetCount=function(){return this.FLength}}),"TCustomList<System.Longint>"),rtl.createClass(this,"TList$G5",this.TCustomList$G12,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,0,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.GetItem=function(t){if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return this.FItems[t]},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var n=0,o=rtl.length(i)-1;n<=o;n++)s=n,this.Notify(i[s],1)}},this.Clear=function(){this.SetCount(0),this.SetCapacity(0)}}),"TList<System.Longint>"),rtl.createClass(this,"TEnumerable$G23",pas.System.TObject,(function(){}),"TEnumerable<System.Double>"),rtl.createClass(this,"TCustomList$G13",this.TEnumerable$G23,(function(){this.$init=function(){t.TEnumerable$G23.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G23.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(0),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<System.Double>"),rtl.createClass(this,"TList$G6",this.TCustomList$G13,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,0,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.GetItem=function(t){if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return this.FItems[t]},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var n=0,o=rtl.length(i)-1;n<=o;n++)s=n,this.Notify(i[s],1)}},this.Clear=function(){this.SetCount(0),this.SetCapacity(0)}}),"TList<System.Double>"),rtl.createClass(this,"TEnumerable$G24",pas.System.TObject,(function(){}),"TEnumerable<WEBLib.TMSFNCPersistence.TTMSFNCObjectReference>"),rtl.createClass(this,"TCustomList$G14",this.TEnumerable$G24,(function(){this.$init=function(){t.TEnumerable$G24.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G24.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WEBLib.TMSFNCPersistence.TTMSFNCObjectReference>"),rtl.createClass(this,"TList$G7",this.TCustomList$G14,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var n=0,o=rtl.length(i)-1;n<=o;n++)s=n,this.Notify(i[s],1)}}}),"TList<WEBLib.TMSFNCPersistence.TTMSFNCObjectReference>"),rtl.createClass(this,"TObjectList$G2",this.TList$G7,(function(){this.$init=function(){t.TList$G7.$init.call(this),this.FObjectsOwner=!1},this.Notify=function(e,i){t.TCustomList$G14.Notify.call(this,e,i),this.FObjectsOwner&&1===i&&(e=rtl.freeLoc(e))},this.Create$4=function(e){return t.TList$G7.Create$1.call(this),this.FObjectsOwner=e,this}}),"TObjectList<WEBLib.TMSFNCPersistence.TTMSFNCObjectReference>"),rtl.createClass(this,"TEnumerable$G26",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SEconstable.Session.TSESSessionScreenDiff>"),rtl.createClass(this,"TCustomList$G15",this.TEnumerable$G26,(function(){this.$init=function(){t.TEnumerable$G26.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G26.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WebLib.SEconstable.Session.TSESSessionScreenDiff>"),rtl.createClass(this,"TList$G8",this.TCustomList$G15,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.GetItem=function(t){if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return this.FItems[t]},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var n=0,o=rtl.length(i)-1;n<=o;n++)s=n,this.Notify(i[s],1)}}}),"TList<WebLib.SEconstable.Session.TSESSessionScreenDiff>"),rtl.createClass(this,"TObjectList$G3",this.TList$G8,(function(){this.$init=function(){t.TList$G8.$init.call(this),this.FObjectsOwner=!1},this.Notify=function(e,i){t.TCustomList$G15.Notify.call(this,e,i),this.FObjectsOwner&&1===i&&(e=rtl.freeLoc(e))},this.Create$4=function(e){return t.TList$G8.Create$1.call(this),this.FObjectsOwner=e,this}}),"TObjectList<WebLib.SEconstable.Session.TSESSessionScreenDiff>"),rtl.recNewT(this,"TPair$G7",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G27",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.String,WebLib.SEconstable.Session.TSERTTKSessionInfoStream>>"),rtl.createClass(this,"TEnumerable$G28",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SEconstable.Session.TSERTTKSessionInfoStream>"),rtl.createClass(this,"TDictionary$G5",this.TEnumerable$G27,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G28,(function(){}),"TDictionary<System.String,WebLib.SEconstable.Session.TSERTTKSessionInfoStream>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G22,(function(){}),"TDictionary<System.String,WebLib.SEconstable.Session.TSERTTKSessionInfoStream>.TKeyCollection"),this.$init=function(){t.TEnumerable$G27.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G27.$final.call(this)},this.GetEffectiveKey=function(t){var e="",i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=""+s.value,0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Clear=function(){var t=null,e=null,i=[],s="",n=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(s=""+(i=e.value)[0],n=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,n,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i}}),"TDictionary<System.String,WebLib.SEconstable.Session.TSERTTKSessionInfoStream>"),rtl.createClass(this,"TObjectDictionary$G1",this.TDictionary$G5,(function(){this.$init=function(){t.TDictionary$G5.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G5.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G5.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G5.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G5.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.Create$5=function(e){return t.TDictionary$G5.Create$1.call(this,0),this.FOwnerships=rtl.refSet(e),this}}),"TObjectDictionary<System.String,WebLib.SEconstable.Session.TSERTTKSessionInfoStream>"),rtl.createClass(this,"TEnumerator$G30",pas.System.TObject,(function(){this.MoveNext=function(){return this.DoMoveNext()}}),"TEnumerator<WEBLib.TMSFNCTypes.TRectF>"),rtl.createClass(this,"TEnumerable$G29",pas.System.TObject,(function(){}),"TEnumerable<WEBLib.TMSFNCTypes.TRectF>"),rtl.createClass(this,"TCustomList$G16",this.TEnumerable$G29,(function(){this.$init=function(){t.TEnumerable$G29.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G29.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WEBLib.TMSFNCTypes.TRectF>"),rtl.createClass(this,"TCustomListEnumerator$G14",this.TEnumerator$G30,(function(){this.$init=function(){t.TEnumerator$G30.$init.call(this),this.FList=null,this.FIndex=0},this.$final=function(){this.FList=void 0,t.TEnumerator$G30.$final.call(this)},this.DoMoveNext=function(){return this.FIndex+=1,this.FList.FLength>0&&this.FIndex<this.FList.FLength},this.DoGetCurrent=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(this.GetCurrent()),t},this.GetCurrent=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(this.FList.FItems[this.FIndex]),t},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.FIndex=-1,this.FList=t,this}}),"TCustomListEnumerator<WEBLib.TMSFNCTypes.TRectF>"),rtl.createClass(this,"TList$G9",this.TCustomList$G16,(function(){rtl.createClass(this,"TEnumerator",t.TCustomListEnumerator$G14,(function(){}),"TList<WEBLib.TMSFNCTypes.TRectF>.TEnumerator"),this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,pas["WEBLib.TMSFNCTypes"].TRectF,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.GetEnumerator$1=function(){return this.TEnumerator.$create("Create$1",[this])},this.Destroy=function(){this.SetCapacity(0)},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var n=0,o=rtl.length(i)-1;n<=o;n++)s=n,this.Notify(i[s],1)}}}),"TList<WEBLib.TMSFNCTypes.TRectF>"),rtl.recNewT(this,"TPair$G8",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G30",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.String,WebLib.SEconstable.Session.TSESScreenDiffInfo>>"),rtl.createClass(this,"TEnumerable$G31",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SEconstable.Session.TSESScreenDiffInfo>"),rtl.createClass(this,"TDictionary$G6",this.TEnumerable$G30,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G31,(function(){}),"TDictionary<System.String,WebLib.SEconstable.Session.TSESScreenDiffInfo>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G22,(function(){}),"TDictionary<System.String,WebLib.SEconstable.Session.TSESScreenDiffInfo>.TKeyCollection"),this.$init=function(){t.TEnumerable$G30.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G30.$final.call(this)},this.GetEffectiveKey=function(t){var e="",i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=""+s.value,0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Clear=function(){var t=null,e=null,i=[],s="",n=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(s=""+(i=e.value)[0],n=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,n,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i}}),"TDictionary<System.String,WebLib.SEconstable.Session.TSESScreenDiffInfo>"),rtl.createClass(this,"TObjectDictionary$G2",this.TDictionary$G6,(function(){this.$init=function(){t.TDictionary$G6.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G6.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G6.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G6.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G6.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))}}),"TObjectDictionary<System.String,WebLib.SEconstable.Session.TSESScreenDiffInfo>"),rtl.createClass(this,"TEnumerable$G32",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SEconstable.Session.TSESupSessionStepInfo>"),rtl.createClass(this,"TCustomList$G17",this.TEnumerable$G32,(function(){this.$init=function(){t.TEnumerable$G32.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G32.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WebLib.SEconstable.Session.TSESupSessionStepInfo>"),rtl.createClass(this,"TList$G10",this.TCustomList$G17,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var n=0,o=rtl.length(i)-1;n<=o;n++)s=n,this.Notify(i[s],1)}}}),"TList<WebLib.SEconstable.Session.TSESupSessionStepInfo>"),rtl.createClass(this,"TObjectList$G4",this.TList$G10,(function(){this.$init=function(){t.TList$G10.$init.call(this),this.FObjectsOwner=!1},this.Notify=function(e,i){t.TCustomList$G17.Notify.call(this,e,i),this.FObjectsOwner&&1===i&&(e=rtl.freeLoc(e))},this.Create$4=function(e){return t.TList$G10.Create$1.call(this),this.FObjectsOwner=e,this}}),"TObjectList<WebLib.SEconstable.Session.TSESupSessionStepInfo>"),rtl.recNewT(this,"TPair$G9",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G33",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.String,WebLib.SEconstable.Session.TSERTTKSessionStorageBitmap>>"),rtl.createClass(this,"TEnumerable$G34",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SEconstable.Session.TSERTTKSessionStorageBitmap>"),rtl.createClass(this,"TDictionary$G7",this.TEnumerable$G33,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G34,(function(){}),"TDictionary<System.String,WebLib.SEconstable.Session.TSERTTKSessionStorageBitmap>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G22,(function(){}),"TDictionary<System.String,WebLib.SEconstable.Session.TSERTTKSessionStorageBitmap>.TKeyCollection"),this.$init=function(){t.TEnumerable$G33.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G33.$final.call(this)},this.GetEffectiveKey=function(t){var e="",i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=""+s.value,0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Clear=function(){var t=null,e=null,i=[],s="",n=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(s=""+(i=e.value)[0],n=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,n,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i}}),"TDictionary<System.String,WebLib.SEconstable.Session.TSERTTKSessionStorageBitmap>"),rtl.createClass(this,"TObjectDictionary$G3",this.TDictionary$G7,(function(){this.$init=function(){t.TDictionary$G7.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G7.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G7.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G7.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G7.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.Create$5=function(e){return t.TDictionary$G7.Create$1.call(this,0),this.FOwnerships=rtl.refSet(e),this}}),"TObjectDictionary<System.String,WebLib.SEconstable.Session.TSERTTKSessionStorageBitmap>"),rtl.recNewT(this,"TPair$G10",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G35",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.String,WebLib.SEconstable.Session.TSESSessionStepLog>>"),rtl.createClass(this,"TEnumerable$G36",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SEconstable.Session.TSESSessionStepLog>"),rtl.createClass(this,"TDictionary$G8",this.TEnumerable$G35,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G36,(function(){}),"TDictionary<System.String,WebLib.SEconstable.Session.TSESSessionStepLog>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G22,(function(){}),"TDictionary<System.String,WebLib.SEconstable.Session.TSESSessionStepLog>.TKeyCollection"),this.$init=function(){t.TEnumerable$G35.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G35.$final.call(this)},this.GetEffectiveKey=function(t){var e="",i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=""+s.value,0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Clear=function(){var t=null,e=null,i=[],s="",n=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(s=""+(i=e.value)[0],n=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,n,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i}}),"TDictionary<System.String,WebLib.SEconstable.Session.TSESSessionStepLog>"),rtl.createClass(this,"TObjectDictionary$G4",this.TDictionary$G8,(function(){this.$init=function(){t.TDictionary$G8.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G8.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G8.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G8.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G8.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.Create$5=function(e){return t.TDictionary$G8.Create$1.call(this,0),this.FOwnerships=rtl.refSet(e),this}}),"TObjectDictionary<System.String,WebLib.SEconstable.Session.TSESSessionStepLog>"),rtl.recNewT(this,"TPair$G11",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G37",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.TGuid,WebLib.SEconstable.Session.TSEStepDiffAnalysis>>"),rtl.createClass(this,"TEnumerable$G38",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SEconstable.Session.TSEStepDiffAnalysis>"),rtl.createClass(this,"TEnumerable$G39",pas.System.TObject,(function(){}),"TEnumerable<System.TGuid>"),rtl.createClass(this,"TDictionary$G9",this.TEnumerable$G37,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G38,(function(){}),"TDictionary<System.TGuid,WebLib.SEconstable.Session.TSEStepDiffAnalysis>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G39,(function(){}),"TDictionary<System.TGuid,WebLib.SEconstable.Session.TSEStepDiffAnalysis>.TKeyCollection"),this.$init=function(){t.TEnumerable$G37.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G37.$final.call(this)},this.GetEffectiveKey=function(t){var e=pas.System.TGuid.$new(),i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e.$assign(rtl.getObject(s.value)),0===this.FComparer.Compare(e,t))return e;s=i.next()}return e.$assign(t),e},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Clear=function(){var t=null,e=null,i=[],s=pas.System.TGuid.$new(),n=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(i=e.value,s.$assign(rtl.getObject(i[0])),n=rtl.getObject(i[1]),this.FMap.delete(pas.System.TGuid.$clone(s)),this.PairNotify(s,n,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s=pas.System.TGuid.$new();return s.$assign(this.GetEffectiveKey(pas.System.TGuid.$clone(t))),(i=this.FMap.has(pas.System.TGuid.$clone(s)))&&e.set(rtl.getObject(this.FMap.get(pas.System.TGuid.$clone(s)))),i}}),"TDictionary<System.TGuid,WebLib.SEconstable.Session.TSEStepDiffAnalysis>"),rtl.createClass(this,"TObjectDictionary$G5",this.TDictionary$G9,(function(){this.$init=function(){t.TDictionary$G9.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G9.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G9.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G9.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G9.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.Create$5=function(e){return t.TDictionary$G9.Create$1.call(this,0),this.FOwnerships=rtl.refSet(e),this}}),"TObjectDictionary<System.TGuid,WebLib.SEconstable.Session.TSEStepDiffAnalysis>"),rtl.createClass(this,"TEnumerable$G40",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SEConstable.Repository.TSESRepoLabel>"),rtl.createClass(this,"TCustomList$G18",this.TEnumerable$G40,(function(){this.$init=function(){t.TEnumerable$G40.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G40.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WebLib.SEConstable.Repository.TSESRepoLabel>"),rtl.createClass(this,"TList$G11",this.TCustomList$G18,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var n=0,o=rtl.length(i)-1;n<=o;n++)s=n,this.Notify(i[s],1)}}}),"TList<WebLib.SEConstable.Repository.TSESRepoLabel>"),rtl.createClass(this,"TObjectList$G5",this.TList$G11,(function(){this.$init=function(){t.TList$G11.$init.call(this),this.FObjectsOwner=!1},this.Notify=function(e,i){t.TCustomList$G18.Notify.call(this,e,i),this.FObjectsOwner&&1===i&&(e=rtl.freeLoc(e))},this.Create$4=function(e){return t.TList$G11.Create$1.call(this),this.FObjectsOwner=e,this}}),"TObjectList<WebLib.SEConstable.Repository.TSESRepoLabel>"),rtl.createClass(this,"TEnumerator$G42",pas.System.TObject,(function(){this.MoveNext=function(){return this.DoMoveNext()}}),"TEnumerator<WebLib.SEConstable.Repository.TSERTTKRepoItem>"),rtl.createClass(this,"TEnumerable$G41",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SEConstable.Repository.TSERTTKRepoItem>"),rtl.createClass(this,"TCustomList$G19",this.TEnumerable$G41,(function(){this.$init=function(){t.TEnumerable$G41.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G41.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)},this.DoRemove=function(t,e){var i;if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return i=this.FItems[t],this.FLength-=1,this.FItems[t]=null,this.FItems.splice(t,1),this.Notify(i,e),i}}),"TCustomList<WebLib.SEConstable.Repository.TSERTTKRepoItem>"),rtl.createClass(this,"TCustomListEnumerator$G17",this.TEnumerator$G42,(function(){this.$init=function(){t.TEnumerator$G42.$init.call(this),this.FList=null,this.FIndex=0},this.$final=function(){this.FList=void 0,t.TEnumerator$G42.$final.call(this)},this.DoMoveNext=function(){return this.FIndex+=1,this.FList.FLength>0&&this.FIndex<this.FList.FLength},this.DoGetCurrent=function(){return this.GetCurrent()},this.GetCurrent=function(){return this.FList.FItems[this.FIndex]},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.FIndex=-1,this.FList=t,this}}),"TCustomListEnumerator<WebLib.SEConstable.Repository.TSERTTKRepoItem>"),rtl.createClass(this,"TList$G12",this.TCustomList$G19,(function(){rtl.createClass(this,"TEnumerator",t.TCustomListEnumerator$G17,(function(){}),"TList<WebLib.SEConstable.Repository.TSERTTKRepoItem>.TEnumerator"),this.$init=function(){t.TCustomList$G19.$init.call(this),this.FComparer=null},this.$final=function(){rtl.setIntfP(this,"FComparer",null),t.TCustomList$G19.$final.call(this)},this.SameValue=function(t,e){return null!=this.FComparer?0===this.FComparer.Compare(t,e):t===e},this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.GetItem=function(t){if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return this.FItems[t]},this.GetEnumerator$1=function(){return this.TEnumerator.$create("Create$1",[this])},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var n=0,o=rtl.length(i)-1;n<=o;n++)s=n,this.Notify(i[s],1)}},this.Extract=function(t){var e;return(e=this.IndexOf(t))<0?null:this.DoRemove(e,2)},this.Clear=function(){this.SetCount(0),this.SetCapacity(0)},this.Contains=function(t){return this.IndexOf(t)>=0},this.IndexOf=function(t){for(var e=0,i=0,s=this.FLength-1;i<=s;i++)if(e=i,this.SameValue(t,this.FItems[e]))return e;return-1,-1}}),"TList<WebLib.SEConstable.Repository.TSERTTKRepoItem>"),rtl.createClass(this,"TEnumerable$G42",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SEConstable.Repository.TSESInspectToolBase>"),rtl.createClass(this,"TCustomList$G20",this.TEnumerable$G42,(function(){this.$init=function(){t.TEnumerable$G42.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G42.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WebLib.SEConstable.Repository.TSESInspectToolBase>"),rtl.createClass(this,"TList$G13",this.TCustomList$G20,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.GetItem=function(t){if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return this.FItems[t]},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var n=0,o=rtl.length(i)-1;n<=o;n++)s=n,this.Notify(i[s],1)}}}),"TList<WebLib.SEConstable.Repository.TSESInspectToolBase>"),rtl.createClass(this,"TObjectList$G6",this.TList$G13,(function(){this.$init=function(){t.TList$G13.$init.call(this),this.FObjectsOwner=!1},this.Notify=function(e,i){t.TCustomList$G20.Notify.call(this,e,i),this.FObjectsOwner&&1===i&&(e=rtl.freeLoc(e))},this.Create$4=function(e){return t.TList$G13.Create$1.call(this),this.FObjectsOwner=e,this}}),"TObjectList<WebLib.SEConstable.Repository.TSESInspectToolBase>"),rtl.createClass(this,"TEnumerator$G44",pas.System.TObject,(function(){this.MoveNext=function(){return this.DoMoveNext()}}),"TEnumerator<WebLib.SEConstable.Repository.TSESRepoRoot>"),rtl.createClass(this,"TEnumerable$G43",pas.System.TObject,(function(){this.GetEnumerator=function(){return this.DoGetEnumerator()}}),"TEnumerable<WebLib.SEConstable.Repository.TSESRepoRoot>"),rtl.createClass(this,"TCustomList$G21",this.TEnumerable$G43,(function(){this.$init=function(){t.TEnumerable$G43.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G43.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WebLib.SEConstable.Repository.TSESRepoRoot>"),rtl.createClass(this,"TCustomListEnumerator$G19",this.TEnumerator$G44,(function(){this.$init=function(){t.TEnumerator$G44.$init.call(this),this.FList=null,this.FIndex=0},this.$final=function(){this.FList=void 0,t.TEnumerator$G44.$final.call(this)},this.DoMoveNext=function(){return this.FIndex+=1,this.FList.FLength>0&&this.FIndex<this.FList.FLength},this.DoGetCurrent=function(){return this.GetCurrent()},this.GetCurrent=function(){return this.FList.FItems[this.FIndex]},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.FIndex=-1,this.FList=t,this}}),"TCustomListEnumerator<WebLib.SEConstable.Repository.TSESRepoRoot>"),rtl.createClass(this,"TList$G14",this.TCustomList$G21,(function(){rtl.createClass(this,"TEnumerator",t.TCustomListEnumerator$G19,(function(){}),"TList<WebLib.SEConstable.Repository.TSESRepoRoot>.TEnumerator"),this.$init=function(){t.TCustomList$G21.$init.call(this),this.FComparer=null},this.$final=function(){rtl.setIntfP(this,"FComparer",null),t.TCustomList$G21.$final.call(this)},this.SameValue=function(t,e){return null!=this.FComparer?0===this.FComparer.Compare(t,e):t===e},this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.DoGetEnumerator=function(){return this.GetEnumerator$1()},this.GetItem=function(t){if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return this.FItems[t]},this.GetEnumerator$1=function(){return this.TEnumerator.$create("Create$1",[this])},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.AddRange$2=function(t){var e=null,i=t.GetEnumerator();try{for(;i.MoveNext();)e=i.DoGetCurrent(),this.Add(e)}finally{i=rtl.freeLoc(i)}},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var n=0,o=rtl.length(i)-1;n<=o;n++)s=n,this.Notify(i[s],1)}},this.IndexOf=function(t){for(var e=0,i=0,s=this.FLength-1;i<=s;i++)if(e=i,this.SameValue(t,this.FItems[e]))return e;return-1,-1}}),"TList<WebLib.SEConstable.Repository.TSESRepoRoot>"),rtl.recNewT(this,"TPair$G12",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G44",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.TObject,WebLib.SEConstable.Repository.TSERTTKRepoItem>>"),rtl.createClass(this,"TDictionary$G10",this.TEnumerable$G44,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G41,(function(){}),"TDictionary<System.TObject,WebLib.SEConstable.Repository.TSERTTKRepoItem>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G21,(function(){}),"TDictionary<System.TObject,WebLib.SEConstable.Repository.TSERTTKRepoItem>.TKeyCollection"),this.$init=function(){t.TEnumerable$G44.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G44.$final.call(this)},this.GetEffectiveKey=function(t){var e=null,i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=rtl.getObject(s.value),0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.SetItem=function(t,e){var i;i=this.FMap.get(this.GetEffectiveKey(t)),pas.JS.isUndefined(i)||this.ValueNotify(rtl.getObject(i),1),this.FMap.set(t,e),this.ValueNotify(e,0)},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Clear=function(){var t=null,e=null,i=[],s=null,n=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(i=e.value,s=rtl.getObject(i[0]),n=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,n,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i},this.AddOrSetValue=function(t,e){var i;i=this.GetEffectiveKey(t),this.FMap.has(i)?this.SetItem(i,e):this.DoAdd(t,e)}}),"TDictionary<System.TObject,WebLib.SEConstable.Repository.TSERTTKRepoItem>"),rtl.createClass(this,"TObjectDictionary$G6",this.TDictionary$G10,(function(){this.$init=function(){t.TDictionary$G10.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G10.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G10.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G10.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G10.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.Create$5=function(e){return t.TDictionary$G10.Create$1.call(this,0),this.FOwnerships=rtl.refSet(e),this}}),"TObjectDictionary<System.TObject,WebLib.SEConstable.Repository.TSERTTKRepoItem>"),rtl.createClass(this,"TEnumerator$G50",pas.System.TObject,(function(){this.MoveNext=function(){return this.DoMoveNext()}}),"TEnumerator<WebLib.SEConstable.Repository.TSESTransformBase>"),rtl.createClass(this,"TEnumerable$G49",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SEConstable.Repository.TSESTransformBase>"),rtl.createClass(this,"TCustomList$G24",this.TEnumerable$G49,(function(){this.$init=function(){t.TEnumerable$G49.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G49.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)},this.DoRemove=function(t,e){var i;if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return i=this.FItems[t],this.FLength-=1,this.FItems[t]=null,this.FItems.splice(t,1),this.Notify(i,e),i}}),"TCustomList<WebLib.SEConstable.Repository.TSESTransformBase>"),rtl.createClass(this,"TCustomListEnumerator$G22",this.TEnumerator$G50,(function(){this.$init=function(){t.TEnumerator$G50.$init.call(this),this.FList=null,this.FIndex=0},this.$final=function(){this.FList=void 0,t.TEnumerator$G50.$final.call(this)},this.DoMoveNext=function(){return this.FIndex+=1,this.FList.FLength>0&&this.FIndex<this.FList.FLength},this.DoGetCurrent=function(){return this.GetCurrent()},this.GetCurrent=function(){return this.FList.FItems[this.FIndex]},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.FIndex=-1,this.FList=t,this}}),"TCustomListEnumerator<WebLib.SEConstable.Repository.TSESTransformBase>"),rtl.createClass(this,"TList$G17",this.TCustomList$G24,(function(){rtl.createClass(this,"TEnumerator",t.TCustomListEnumerator$G22,(function(){}),"TList<WebLib.SEConstable.Repository.TSESTransformBase>.TEnumerator"),this.$init=function(){t.TCustomList$G24.$init.call(this),this.FComparer=null},this.$final=function(){rtl.setIntfP(this,"FComparer",null),t.TCustomList$G24.$final.call(this)},this.SameValue=function(t,e){return null!=this.FComparer?0===this.FComparer.Compare(t,e):t===e},this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.GetItem=function(t){if(t<0||t>=this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return this.FItems[t]},this.GetEnumerator$1=function(){return this.TEnumerator.$create("Create$1",[this])},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var n=0,o=rtl.length(i)-1;n<=o;n++)s=n,this.Notify(i[s],1)}},this.Extract=function(t){var e;return(e=this.IndexOf(t))<0?null:this.DoRemove(e,2)},this.IndexOf=function(t){for(var e=0,i=0,s=this.FLength-1;i<=s;i++)if(e=i,this.SameValue(t,this.FItems[e]))return e;return-1,-1}}),"TList<WebLib.SEConstable.Repository.TSESTransformBase>"),rtl.createClass(this,"TObjectList$G8",this.TList$G17,(function(){this.$init=function(){t.TList$G17.$init.call(this),this.FObjectsOwner=!1},this.Notify=function(e,i){t.TCustomList$G24.Notify.call(this,e,i),this.FObjectsOwner&&1===i&&(e=rtl.freeLoc(e))},this.Create$4=function(e){return t.TList$G17.Create$1.call(this),this.FObjectsOwner=e,this}}),"TObjectList<WebLib.SEConstable.Repository.TSESTransformBase>"),rtl.recNewT(this,"TPair$G14",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G50",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.TClass,Generics.Collections.TObjectList<WebLib.SEConstable.Repository.TSESTransformBase>>>"),rtl.createClass(this,"TEnumerable$G51",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TObjectList<WebLib.SEConstable.Repository.TSESTransformBase>>"),rtl.createClass(this,"TEnumerable$G52",pas.System.TObject,(function(){}),"TEnumerable<System.TClass>"),rtl.createClass(this,"TDictionary$G12",this.TEnumerable$G50,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G51,(function(){}),"TDictionary<System.TClass,Generics.Collections.TObjectList<WebLib.SEConstable.Repository.TSESTransformBase>>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G52,(function(){}),"TDictionary<System.TClass,Generics.Collections.TObjectList<WebLib.SEConstable.Repository.TSESTransformBase>>.TKeyCollection"),this.$init=function(){t.TEnumerable$G50.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G50.$final.call(this)},this.GetEffectiveKey=function(t){var e=null,i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=rtl.getObject(s.value),0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.GetCount=function(){return this.FMap.size},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Clear=function(){var t=null,e=null,i=[],s=null,n=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(i=e.value,s=rtl.getObject(i[0]),n=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,n,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i}}),"TDictionary<System.TClass,Generics.Collections.TObjectList<WebLib.SEConstable.Repository.TSESTransformBase>>"),rtl.createClass(this,"TObjectDictionary$G8",this.TDictionary$G12,(function(){this.$init=function(){t.TDictionary$G12.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G12.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G12.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G12.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G12.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.Create$5=function(e){return t.TDictionary$G12.Create$1.call(this,0),this.FOwnerships=rtl.refSet(e),this}}),"TObjectDictionary<System.TClass,Generics.Collections.TObjectList<WebLib.SEConstable.Repository.TSESTransformBase>>"),rtl.recNewT(this,"TPair$G15",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G53",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.TClass,WebLib.SEConstable.Repository.TSERTTKClassTransforms>>"),rtl.createClass(this,"TEnumerable$G54",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SEConstable.Repository.TSERTTKClassTransforms>"),rtl.createClass(this,"TDictionary$G13",this.TEnumerable$G53,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G54,(function(){}),"TDictionary<System.TClass,WebLib.SEConstable.Repository.TSERTTKClassTransforms>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G52,(function(){}),"TDictionary<System.TClass,WebLib.SEConstable.Repository.TSERTTKClassTransforms>.TKeyCollection"),this.$init=function(){t.TEnumerable$G53.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G53.$final.call(this)},this.GetEffectiveKey=function(t){var e=null,i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=rtl.getObject(s.value),0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Clear=function(){var t=null,e=null,i=[],s=null,n=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(i=e.value,s=rtl.getObject(i[0]),n=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,n,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i}}),"TDictionary<System.TClass,WebLib.SEConstable.Repository.TSERTTKClassTransforms>"),rtl.createClass(this,"TObjectDictionary$G9",this.TDictionary$G13,(function(){this.$init=function(){t.TDictionary$G13.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G13.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G13.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G13.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G13.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.Create$5=function(e){return t.TDictionary$G13.Create$1.call(this,0),this.FOwnerships=rtl.refSet(e),this}}),"TObjectDictionary<System.TClass,WebLib.SEConstable.Repository.TSERTTKClassTransforms>"),rtl.recNewT(this,"TPair$G16",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G55",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.String,WEBLib.TMSFNCToolBar.TTMSFNCToolBarButton>>"),rtl.createClass(this,"TEnumerable$G56",pas.System.TObject,(function(){}),"TEnumerable<WEBLib.TMSFNCToolBar.TTMSFNCToolBarButton>"),rtl.createClass(this,"TDictionary$G14",this.TEnumerable$G55,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G56,(function(){}),"TDictionary<System.String,WEBLib.TMSFNCToolBar.TTMSFNCToolBarButton>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G22,(function(){}),"TDictionary<System.String,WEBLib.TMSFNCToolBar.TTMSFNCToolBarButton>.TKeyCollection"),this.$init=function(){t.TEnumerable$G55.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G55.$final.call(this)},this.GetEffectiveKey=function(t){var e="",i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=""+s.value,0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Clear=function(){var t=null,e=null,i=[],s="",n=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(s=""+(i=e.value)[0],n=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,n,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i}}),"TDictionary<System.String,WEBLib.TMSFNCToolBar.TTMSFNCToolBarButton>"),rtl.createClass(this,"TEnumerable$G57",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SEConstable.CVTypes.TSECVLogToolBase>"),rtl.createClass(this,"TCustomList$G25",this.TEnumerable$G57,(function(){this.$init=function(){t.TEnumerable$G57.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G57.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WebLib.SEConstable.CVTypes.TSECVLogToolBase>"),rtl.createClass(this,"TList$G18",this.TCustomList$G25,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var n=0,o=rtl.length(i)-1;n<=o;n++)s=n,this.Notify(i[s],1)}}}),"TList<WebLib.SEConstable.CVTypes.TSECVLogToolBase>"),rtl.createClass(this,"TObjectList$G9",this.TList$G18,(function(){this.$init=function(){t.TList$G18.$init.call(this),this.FObjectsOwner=!1},this.Notify=function(e,i){t.TCustomList$G25.Notify.call(this,e,i),this.FObjectsOwner&&1===i&&(e=rtl.freeLoc(e))},this.Create$4=function(e){return t.TList$G18.Create$1.call(this),this.FObjectsOwner=e,this}}),"TObjectList<WebLib.SEConstable.CVTypes.TSECVLogToolBase>"),rtl.recNewT(this,"TPair$G17",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G58",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<WEBLib.TMSFNCPageControl.TTMSFNCPageControlPage,WebLib.SE.ConstableCV.TSECVToolInstance>>"),rtl.createClass(this,"TEnumerable$G59",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SE.ConstableCV.TSECVToolInstance>"),rtl.createClass(this,"TEnumerable$G60",pas.System.TObject,(function(){}),"TEnumerable<WEBLib.TMSFNCPageControl.TTMSFNCPageControlPage>"),rtl.createClass(this,"TDictionary$G15",this.TEnumerable$G58,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G59,(function(){}),"TDictionary<WEBLib.TMSFNCPageControl.TTMSFNCPageControlPage,WebLib.SE.ConstableCV.TSECVToolInstance>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G60,(function(){}),"TDictionary<WEBLib.TMSFNCPageControl.TTMSFNCPageControlPage,WebLib.SE.ConstableCV.TSECVToolInstance>.TKeyCollection"),this.$init=function(){t.TEnumerable$G58.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G58.$final.call(this)},this.GetEffectiveKey=function(t){var e=null,i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=rtl.getObject(s.value),0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Clear=function(){var t=null,e=null,i=[],s=null,n=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(i=e.value,s=rtl.getObject(i[0]),n=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,n,1))}while(!e.done)}}}),"TDictionary<WEBLib.TMSFNCPageControl.TTMSFNCPageControlPage,WebLib.SE.ConstableCV.TSECVToolInstance>"),rtl.createClass(this,"TObjectDictionary$G10",this.TDictionary$G15,(function(){this.$init=function(){t.TDictionary$G15.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G15.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G15.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G15.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G15.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.Create$5=function(e){return t.TDictionary$G15.Create$1.call(this,0),this.FOwnerships=rtl.refSet(e),this}}),"TObjectDictionary<WEBLib.TMSFNCPageControl.TTMSFNCPageControlPage,WebLib.SE.ConstableCV.TSECVToolInstance>"),rtl.createClass(this,"TEnumerable$G61",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SE.ConstableCV.TSERTTKInspectorCVInfo>"),rtl.createClass(this,"TCustomList$G26",this.TEnumerable$G61,(function(){this.$init=function(){t.TEnumerable$G61.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G61.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WebLib.SE.ConstableCV.TSERTTKInspectorCVInfo>"),rtl.createClass(this,"TList$G19",this.TCustomList$G26,(function(){this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var n=0,o=rtl.length(i)-1;n<=o;n++)s=n,this.Notify(i[s],1)}}}),"TList<WebLib.SE.ConstableCV.TSERTTKInspectorCVInfo>"),rtl.createClass(this,"TObjectList$G10",this.TList$G19,(function(){this.$init=function(){t.TList$G19.$init.call(this),this.FObjectsOwner=!1},this.Notify=function(e,i){t.TCustomList$G26.Notify.call(this,e,i),this.FObjectsOwner&&1===i&&(e=rtl.freeLoc(e))},this.Create$4=function(e){return t.TList$G19.Create$1.call(this),this.FObjectsOwner=e,this}}),"TObjectList<WebLib.SE.ConstableCV.TSERTTKInspectorCVInfo>"),rtl.createClass(this,"TStack$G2",this.TCustomList$G12,(function(){this.DoRemove=function(t,e){var i;if(0===this.FLength||t!==this.FLength-1)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);return i=this.FItems[t],this.FItems[t]=-2147483648,this.FLength-=1,this.Notify(i,e),i},this.SetCapacity=function(t){if(t<this.GetCount())throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);this.FItems=rtl.arraySetLength(this.FItems,0,t)},this.Destroy=function(){this.Clear(),pas.System.TObject.Destroy.call(this)},this.Clear=function(){for(;this.GetCount()>0;)this.Pop()},this.Push=function(t){this.GetCapacity()<=this.FLength&&this.SetCapacity(this.FLength+10),this.FItems[this.FLength]=t,this.FLength+=1,this.Notify(t,0)},this.Pop=function(){return this.DoRemove(this.FLength-1,1)}}),"TStack<System.Longint>"),rtl.recNewT(this,"TPair$G18",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G62",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.String,WEBLib.Menus.TMenuItem>>"),rtl.createClass(this,"TEnumerable$G63",pas.System.TObject,(function(){}),"TEnumerable<WEBLib.Menus.TMenuItem>"),rtl.createClass(this,"TDictionary$G16",this.TEnumerable$G62,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G63,(function(){}),"TDictionary<System.String,WEBLib.Menus.TMenuItem>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G22,(function(){}),"TDictionary<System.String,WEBLib.Menus.TMenuItem>.TKeyCollection"),this.$init=function(){t.TEnumerable$G62.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G62.$final.call(this)},this.GetEffectiveKey=function(t){var e="",i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=""+s.value,0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Clear=function(){var t=null,e=null,i=[],s="",n=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(s=""+(i=e.value)[0],n=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,n,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i}}),"TDictionary<System.String,WEBLib.Menus.TMenuItem>"),rtl.createClass(this,"TEnumerator$G65",pas.System.TObject,(function(){this.MoveNext=function(){return this.DoMoveNext()}}),"TEnumerator<WebLib.SE.ConstableCV.TSERTTKRepoItemBinder>"),rtl.createClass(this,"TEnumerable$G64",pas.System.TObject,(function(){}),"TEnumerable<WebLib.SE.ConstableCV.TSERTTKRepoItemBinder>"),rtl.createClass(this,"TCustomList$G27",this.TEnumerable$G64,(function(){this.$init=function(){t.TEnumerable$G64.$init.call(this),this.FOnNotify=null,this.FLength=0,this.FItems=[]},this.$final=function(){this.FOnNotify=void 0,this.FItems=void 0,t.TEnumerable$G64.$final.call(this)},this.GetCapacity=function(){return rtl.length(this.FItems)},this.PrepareAddingItem=function(){var t;return this.FLength===rtl.length(this.FItems)&&this.FItems.push(null),t=this.FLength,this.FLength+=1,t},this.Notify=function(t,e){null!=this.FOnNotify&&this.FOnNotify(this,t,e)}}),"TCustomList<WebLib.SE.ConstableCV.TSERTTKRepoItemBinder>"),rtl.createClass(this,"TCustomListEnumerator$G25",this.TEnumerator$G65,(function(){this.$init=function(){t.TEnumerator$G65.$init.call(this),this.FList=null,this.FIndex=0},this.$final=function(){this.FList=void 0,t.TEnumerator$G65.$final.call(this)},this.DoMoveNext=function(){return this.FIndex+=1,this.FList.FLength>0&&this.FIndex<this.FList.FLength},this.DoGetCurrent=function(){return this.GetCurrent()},this.GetCurrent=function(){return this.FList.FItems[this.FIndex]},this.Create$1=function(t){return pas.System.TObject.Create.call(this),this.FIndex=-1,this.FList=t,this}}),"TCustomListEnumerator<WebLib.SE.ConstableCV.TSERTTKRepoItemBinder>"),rtl.createClass(this,"TList$G20",this.TCustomList$G27,(function(){rtl.createClass(this,"TEnumerator",t.TCustomListEnumerator$G25,(function(){}),"TList<WebLib.SE.ConstableCV.TSERTTKRepoItemBinder>.TEnumerator"),this.SetCapacity=function(t){t<this.FLength&&this.SetCount(t),this.FItems=rtl.arraySetLength(this.FItems,null,t)},this.SetCount=function(t){if(t<0)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);t>this.GetCapacity()?this.SetCapacity(t):t<this.FLength&&this.DeleteRange(t,this.FLength-t),this.FLength=t},this.InitializeList=function(){},this.GetEnumerator$1=function(){return this.TEnumerator.$create("Create$1",[this])},this.Create$1=function(){return this.InitializeList(),this},this.Destroy=function(){this.SetCapacity(0)},this.Add=function(t){var e;return e=this.PrepareAddingItem(),this.FItems[e]=t,this.Notify(t,0),e},this.DeleteRange=function(t,e){var i,s=0;if(0!==e){if(e<0||t<0||t+e>this.FLength)throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);i=this.FItems.splice(t,this.FLength),this.FLength-=e;for(var n=0,o=rtl.length(i)-1;n<=o;n++)s=n,this.Notify(i[s],1)}}}),"TList<WebLib.SE.ConstableCV.TSERTTKRepoItemBinder>"),rtl.recNewT(this,"TPair$G19",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G65",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<WebLib.SEConstable.Repository.TSERTTKRepoItem,WebLib.SE.ConstableCV.TSERTTKRepoItemBinder>>"),rtl.createClass(this,"TDictionary$G17",this.TEnumerable$G65,(function(){rtl.createClass(this,"TKeyEnumerator",t.TEnumerator$G42,(function(){this.$init=function(){t.TEnumerator$G42.$init.call(this),this.FIter=null,this.FVal=null},this.$final=function(){this.FIter=void 0,this.FVal=void 0,t.TEnumerator$G42.$final.call(this)},this.GetCurrent=function(){return this.DoGetCurrent()},this.DoGetCurrent=function(){return rtl.getObject(this.FVal.value)},this.DoMoveNext=function(){return this.FVal=this.FIter.next(),!this.FVal.done},this.Create$1=function(t){return this.FIter=t,this},this.MoveNext$1=function(){return this.DoMoveNext()}}),"TDictionary<WebLib.SEConstable.Repository.TSERTTKRepoItem,WebLib.SE.ConstableCV.TSERTTKRepoItemBinder>.TKeyEnumerator"),rtl.createClass(this,"TValueCollection",t.TEnumerable$G64,(function(){}),"TDictionary<WebLib.SEConstable.Repository.TSERTTKRepoItem,WebLib.SE.ConstableCV.TSERTTKRepoItemBinder>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G41,(function(){this.$init=function(){t.TEnumerable$G41.$init.call(this),this.FMap=null},this.$final=function(){this.FMap=void 0,t.TEnumerable$G41.$final.call(this)},this.Create$1=function(t){return this.FMap=t.FMap,this},this.GetEnumerator$1=function(){return t.TDictionary$G17.TKeyEnumerator.$create("Create$1",[this.FMap.keys()])}}),"TDictionary<WebLib.SEConstable.Repository.TSERTTKRepoItem,WebLib.SE.ConstableCV.TSERTTKRepoItemBinder>.TKeyCollection"),this.$init=function(){t.TEnumerable$G65.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G65.$final.call(this)},this.GetEffectiveKey=function(t){var e=null,i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=rtl.getObject(s.value),0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.DoRemove=function(t,e){var i,s,n=null;return s=this.GetEffectiveKey(t),i=this.FMap.get(s),pas.JS.isUndefined(i)||(this.FMap.delete(s),n=rtl.getObject(i),this.KeyNotify(t,e),this.ValueNotify(n,e)),n},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Remove=function(t){this.DoRemove(t,1)},this.Clear=function(){var t=null,e=null,i=[],s=null,n=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(i=e.value,s=rtl.getObject(i[0]),n=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,n,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i},this.GetKeys=function(){return null===this.FKeyCollection&&(this.FKeyCollection=this.TKeyCollection.$create("Create$1",[this])),this.FKeyCollection}}),"TDictionary<WebLib.SEConstable.Repository.TSERTTKRepoItem,WebLib.SE.ConstableCV.TSERTTKRepoItemBinder>"),rtl.createClass(this,"TObjectDictionary$G11",this.TDictionary$G17,(function(){this.$init=function(){t.TDictionary$G17.$init.call(this),this.FOwnerships={}},this.$final=function(){this.FOwnerships=void 0,t.TDictionary$G17.$final.call(this)},this.CanClearMap=function(){return t.TDictionary$G17.CanClearMap.call(this)&&rtl.eqSet(this.FOwnerships,{})},this.KeyNotify=function(e,i){t.TDictionary$G17.KeyNotify.call(this,e,i),0 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.ValueNotify=function(e,i){t.TDictionary$G17.ValueNotify.call(this,e,i),1 in this.FOwnerships&&1===i&&(e=rtl.freeLoc(e))},this.Create$5=function(e){return t.TDictionary$G17.Create$1.call(this,0),this.FOwnerships=rtl.refSet(e),this}}),"TObjectDictionary<WebLib.SEConstable.Repository.TSERTTKRepoItem,WebLib.SE.ConstableCV.TSERTTKRepoItemBinder>"),rtl.recNewT(this,"TPair$G20",(function(){this.$eq=function(t){return!0},this.$assign=function(t){return this}})),rtl.createClass(this,"TEnumerable$G66",pas.System.TObject,(function(){}),"TEnumerable<Generics.Collections.TPair<System.TObject,WebLib.SE.ConstableCV.TSERTTKRepoItemBinder>>"),rtl.createClass(this,"TDictionary$G18",this.TEnumerable$G66,(function(){rtl.createClass(this,"TValueCollection",t.TEnumerable$G64,(function(){}),"TDictionary<System.TObject,WebLib.SE.ConstableCV.TSERTTKRepoItemBinder>.TValueCollection"),rtl.createClass(this,"TKeyCollection",t.TEnumerable$G21,(function(){}),"TDictionary<System.TObject,WebLib.SE.ConstableCV.TSERTTKRepoItemBinder>.TKeyCollection"),this.$init=function(){t.TEnumerable$G66.$init.call(this),this.FMap=null,this.FComparer=null,this.FOnKeyNotify=null,this.FOnValueNotify=null,this.FKeyCollection=null,this.FValueCollection=null},this.$final=function(){this.FMap=void 0,rtl.setIntfP(this,"FComparer",null),this.FOnKeyNotify=void 0,this.FOnValueNotify=void 0,this.FKeyCollection=void 0,this.FValueCollection=void 0,t.TEnumerable$G66.$final.call(this)},this.GetEffectiveKey=function(t){var e=null,i=null,s=null;if(null==this.FComparer)return t;for(s=(i=this.FMap.keys()).next();!s.done;){if(e=rtl.getObject(s.value),0===this.FComparer.Compare(e,t))return e;s=i.next()}return e=t},this.DoAdd=function(t,e){this.FMap.set(this.GetEffectiveKey(t),e),this.KeyNotify(t,0),this.ValueNotify(e,0)},this.CanClearMap=function(){return null===this.FOnKeyNotify&&null===this.FOnValueNotify},this.PairNotify=function(t,e,i){this.KeyNotify(t,i),this.ValueNotify(e,i)},this.KeyNotify=function(t,e){null!=this.FOnKeyNotify&&this.FOnKeyNotify(this,t,e)},this.ValueNotify=function(t,e){null!=this.FOnValueNotify&&this.FOnValueNotify(this,t,e)},this.Create$1=function(t){return this.FMap=new Map,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FKeyCollection},set:function(t){this.p.FKeyCollection=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FValueCollection},set:function(t){this.p.FValueCollection=t}}),this.Clear(),this.FMap=null,pas.System.TObject.Destroy.call(this)},this.Add=function(e,i){if(this.FMap.has(this.GetEffectiveKey(e)))throw t.EDictionary.$create("Create$1",[rtl.getResStr(t,"SErrDictDuplicateKey")]);this.DoAdd(e,i)},this.Clear=function(){var t=null,e=null,i=[],s=null,n=null;if(this.CanClearMap())this.FMap.clear();else{t=this.FMap.entries();do{(e=t.next()).done||(i=e.value,s=rtl.getObject(i[0]),n=rtl.getObject(i[1]),this.FMap.delete(s),this.PairNotify(s,n,1))}while(!e.done)}},this.TryGetValue=function(t,e){var i,s;return s=this.GetEffectiveKey(t),(i=this.FMap.has(s))&&e.set(rtl.getObject(this.FMap.get(s))),i}}),"TDictionary<System.TObject,WebLib.SE.ConstableCV.TSERTTKRepoItemBinder>"),t.$implcode=function(){t.$resourcestrings={SErrDictKeyNotFound:{org:"Key value not found"},SErrDictDuplicateKey:{org:"Duplicate key value"}}}}),[]),rtl.module("DateUtils",["System","SysUtils","Math"],(function(){"use strict";var t=this,e=t.$impl;this.YearOf=function(t){var e=0,i=0,s=0;return pas.SysUtils.DecodeDate(t,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),e},this.DateTimeToRFC3339=function(t){return pas.SysUtils.FormatDateTime('yyyy-mm-dd"T"hh":"nn":"ss"."zzz"Z"',t)};var i=[11,1,6,9,12,15,18,21];this.TryRFC3339ToDateTime=function(t,e){var s,n,o,r=!1,a=0,l=0,h=0,F=0;return""===pas.SysUtils.Trim(t)&&(r=!0,e.set(0)),s=pas.SysUtils.StrToIntDef(pas.System.Copy(t,i[1],4),-1),n=pas.SysUtils.StrToIntDef(pas.System.Copy(t,i[2],2),-1),o=pas.SysUtils.StrToIntDef(pas.System.Copy(t,i[3],2),-1),t.length>=i[0]?(a=pas.SysUtils.StrToIntDef(pas.System.Copy(t,i[4],2),-1),l=pas.SysUtils.StrToIntDef(pas.System.Copy(t,i[5],2),-1),h=t.length>=i[6]?pas.SysUtils.StrToIntDef(pas.System.Copy(t,i[6],2),-1):0,t.length>=i[7]&&(F=pas.SysUtils.StrToIntDef(pas.System.Copy(t,i[7],3),-1))):(a=0,l=0,h=0,F=0),(r=s>=0&&n>=0&&o>=0&&a>=0&&l>=0&&h>=0&&F>=0)?0===s||0===n||0===o?e.set(pas.SysUtils.EncodeTime(a,l,h,0)):e.set(pas.SysUtils.EncodeDate(s,n,o)+pas.SysUtils.EncodeTime(a,l,h,F)):e.set(0),r},rtl.createClass(this,"TDateTimeScanner",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FPattern="",this.FText="",this.FPatternOffset=0,this.FLen=0,this.FPatternLen=0,this.FPatternPos=0,this.FPos=0,this.FY=0,this.FM=0,this.FD=0,this.FTimeval=0},this.ArrayMatchError=function(){e.raiseexception(pas.SysUtils.Format(e.SNoArrayMatch,pas.System.VarRecs(0,this.FPatternPos+1,0,this.FPos)))},this.DoDateTime=function(){this.MatchPattern(pas.SysUtils.FormatSettings.ShortDateFormat),this.MatchPattern("\t"),this.MatchPattern(pas.SysUtils.FormatSettings.LongTimeFormat),this.FPatternPos+=1},this.SetPattern=function(t){this.FPattern!==t&&(this.FPattern=t,this.FPatternLen=this.FPattern.length)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.FLen=this.FText.length)},this.ScanFixedInt=function(t){var i,s,n=0,o="";for(n=0,s=this.FPos,i=this.FPattern.charAt(this.FPatternPos-1);this.FPatternPos<=this.FPatternLen&&this.FPattern.charAt(this.FPatternPos-1)===i;)this.FPatternPos+=1;for(o=this.FText.charAt(this.FPos-1);t>0&&this.FPos<=this.FLen&&o.charCodeAt()in rtl.createSet(null,48,57);)n=10*n+o.charCodeAt()-48,this.FPos+=1,t-=1,this.FPos<=this.FLen&&(o=this.FText.charAt(this.FPos-1));return s===this.FPos&&e.raiseexception(pas.SysUtils.Format(e.SPatternCharMismatch,pas.System.VarRecs(9,i,0,s))),n},this.ScanPatternLength=function(){var t,e=0,i=0;for(e=this.FPatternPos,i=this.FPatternPos,t=this.FPattern.charAt(i-1);i<=this.FPatternLen&&this.FPattern.charAt(i-1)===t;)i+=1;return e=i-e},this.MatchChar=function(t){var i="";(i=this.FPos<=this.FLen?this.FText.charAt(this.FPos-1):"?")!==t&&e.raiseexception(pas.SysUtils.Format(e.SNoCharMatch,pas.System.VarRecs(9,i,9,t,0,this.FPatternPos+this.FPatternOffset,0,this.FPos))),this.FPatternPos+=1,this.FPos+=1},this.FindIMatch=function(t,e){var i,s=0,n=0;for(s=-1,i=rtl.length(t)-1,n=0;n<=i&&-1===s;)pas.SysUtils.SameText(pas.System.Copy(e,1,t[n].length),t[n])&&(s=n),n+=1;return s},this.FindMatch=function(t){var e=0;return-1===(e=this.FindIMatch(t,pas.System.Copy(this.FText,this.FPos,this.FLen-this.FPos+1)))?this.ArrayMatchError():(this.FPos+=t[e].length+1,this.FPatternPos+=t[e].length+1,e+=1),e},this.MatchPattern=function(t){var e,i;e=this.FPattern,i=this.FPatternPos,this.FPatternOffset=this.FPatternPos,this.FPattern=t,this.FPatternLen=t.length;try{this.Scan(-1)}finally{this.FPattern=e,this.FPatternLen=t.length,this.FPatternPos=i,this.FPatternOffset=0}},this.DoYear=function(){var e,i=0;e=this.ScanPatternLength(),this.FY=this.ScanFixedInt(4),e<=2&&(i=t.YearOf(pas.SysUtils.Now())-pas.SysUtils.TwoDigitYearCenturyWindow,this.FY+=100*rtl.trunc(i/100),pas.SysUtils.TwoDigitYearCenturyWindow>0&&this.FY<i&&(this.FY+=100))},this.DoMonth=function(){var t=this.ScanPatternLength();1===t||2===t?this.FM=this.ScanFixedInt(2):3===t?this.FM=this.FindMatch(pas.SysUtils.FormatSettings.ShortMonthNames):4===t&&(this.FM=this.FindMatch(pas.SysUtils.FormatSettings.LongMonthNames))},this.DoDay=function(){var t=this.ScanPatternLength();1===t||2===t?this.FD=this.ScanFixedInt(2):3===t?this.FD=this.FindMatch(pas.SysUtils.FormatSettings.ShortDayNames):4===t?this.FD=this.FindMatch(pas.SysUtils.FormatSettings.LongDayNames):5===t?this.MatchPattern(pas.SysUtils.FormatSettings.ShortDateFormat):6===t&&this.MatchPattern(pas.SysUtils.FormatSettings.LongDateFormat)},this.DoTime=function(){var t=this.ScanPatternLength();1===t?this.MatchPattern(pas.SysUtils.FormatSettings.ShortTimeFormat):2===t&&this.MatchPattern(pas.SysUtils.FormatSettings.LongTimeFormat)},this.DoAMPM=function(){var t=0,i=t=this.FindIMatch(e.AMPMformatting,pas.System.Copy(this.FPattern,this.FPatternPos,5));if(0===i){t=this.FindIMatch(["AM","PM"],pas.System.Copy(this.FText,this.FPos,2));0===t||(1===t?this.FTimeval=this.FTimeval+.5:this.ArrayMatchError()),this.FPatternPos+=e.AMPMformatting[0].length,this.FPos+=2}else if(1===i){var s=pas.System.upcase(this.FText.charAt(this.FPos-1));"A"===s||("P"===s?this.FTimeval=this.FTimeval+.5:this.ArrayMatchError()),this.FPatternPos+=e.AMPMformatting[1].length,this.FPos+=1}else if(2===i){var n=t=this.FindIMatch([pas.SysUtils.FormatSettings.TimeAMString,pas.SysUtils.FormatSettings.TimePMString],pas.System.Copy(this.FText,this.FPos,5));0===n?this.FPos+=pas.SysUtils.FormatSettings.TimeAMString.length:1===n?(this.FTimeval=this.FTimeval+.5,this.FPos+=pas.SysUtils.FormatSettings.TimePMString.length):this.ArrayMatchError(),this.FPatternPos+=e.AMPMformatting[2].length,this.FPatternPos+=2,this.FPos+=2}else this.MatchChar(this.FPattern.charAt(this.FPatternPos-1))},this.Scan=function(t){var i=0,s="",n="",o="";for(t<1&&(t=1),this.FPos<t&&(this.FPos=t),this.FPatternPos=1,n="\0",s=" ";this.FPos<=this.FLen&&this.FPatternPos<=this.FPatternLen;)if(o=pas.System.upcase(this.FPattern.charAt(this.FPatternPos-1)),"\0"!==n)n!==o?this.MatchChar(o):(n="\0",this.FPatternPos+=1);else{if("M"===o&&"H"===s)this.ScanPatternLength()>2&&e.raiseexception(pas.SysUtils.Format(e.SHHMMError,pas.System.VarRecs(0,this.FPatternOffset+this.FPatternPos+1))),this.FTimeval=this.FTimeval+.0006944444444444445*this.ScanFixedInt(2);else{var r=o;if("Y"===r)this.DoYear();else if("M"===r)this.DoMonth();else if("D"===r)this.DoDay();else if("T"===r)this.DoTime();else if("H"===r)this.FTimeval=this.FTimeval+.041666666666666664*this.ScanFixedInt(2);else if("N"===r)this.FTimeval=this.FTimeval+.0006944444444444445*this.ScanFixedInt(2);else if("S"===r)this.FTimeval=this.FTimeval+11574074074074073e-21*this.ScanFixedInt(2);else if("Z"===r)this.FTimeval=this.FTimeval+1.1574074074074074e-8*this.ScanFixedInt(3);else if("A"===r)this.DoAMPM();else if("/"===r)this.MatchChar(pas.SysUtils.FormatSettings.DateSeparator);else if(":"===r)this.MatchChar(pas.SysUtils.FormatSettings.TimeSeparator),o=s;else if("'"===r||'"'===r)n=o,this.FPatternPos+=1;else if("C"===r)this.DoDateTime();else if("?"===r)this.FPatternPos+=1,this.FPos+=1;else if("\t"===r){for(;this.FPos<=this.FLen&&this.FText.charCodeAt(this.FPos-1)in e.whitespace;)this.FPos+=1;this.FPatternPos+=1}else this.MatchChar(this.FPattern.charAt(this.FPatternPos-1))}s=o}return i=this.FTimeval,this.FY>0&&this.FM>0&&this.FD>0&&(i+=pas.SysUtils.EncodeDate(this.FY,this.FM,this.FD)),i}})),this.ScanDateTime=function(e,i,s){var n=0,o=null;o=t.TDateTimeScanner.$create("Create");try{o.SetPattern(e),o.SetText(i),n=o.Scan(s)}finally{o=rtl.freeLoc(o)}return n},t.$implcode=function(){e.whitespace=rtl.createSet(32,13,10),e.hrfactor=1/24,e.minfactor=1/1440,e.secfactor=1/86400,e.mssecfactor=1/864e5,e.AMPMformatting=["am/pm","a/p","ampm"],e.raiseexception=function(t){throw pas.SysUtils.EConvertError.$create("Create$1",[t])},e.SPatternCharMismatch='Pattern mismatch char "%s" at position %d.',e.SNoCharMatch='Mismatch char "%s" <> "%s" at pattern position %d, string position %d.',e.SHHMMError="mm in a sequence hh:mm is interpreted as minutes. No longer versions allowed! (Position : %d).",e.SNoArrayMatch="Can't match any allowed value at pattern position %d, string position %d."}}),["JS","RTLConsts"]),rtl.module("WEBLib.TMSFNCUtils",["System","Classes","SysUtils","Types","WEBLib.Graphics","WEBLib.TMSFNCTypes","WEBLib.Controls","WEBLib.Forms","JS","WEBLib.Dialogs","WEBLib.JSON","Web"],(function(){"use strict";var t=this,e=t.$impl;rtl.createClass(this,"TTMSFNCUtils",pas.System.TObject,(function(){this.OpenURL=function(t){window.open(t,"_blank")},this.SetFontSize=function(t,e,i){t.SetSize(Math.round(e/96*72))},this.ScaleForCurrentDPI=function(t){},this.IsHTML=function(t){return pas.System.Pos("</",t)>0||pas.System.Pos("/>",t)>0||pas.System.Pos("<BR>",pas.SysUtils.UpperCase(t))>0},this.GetMousePos=function(){var t=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),e=pas.Types.TPoint.$new();return t.$assign(pas["WEBLib.TMSFNCTypes"].PointF(-1,-1)),e.$assign(pas["WEBLib.Controls"].GetMousePos()),t.$assign(pas["WEBLib.TMSFNCTypes"].PointF(e.x,e.y)),t},this.IsHighDPIScale=function(t,e){return this.GetDPIScale(t,e)>1},this.GetDPIScale=function(t,e){return 1,1},this.Clone=function(t){throw pas.SysUtils.Exception.$create("Create$1",["Implement Clone"])},this.HTMLStrip=function(t){var e="",i=0;for(e="";pas.System.Pos("<BR>",pas.SysUtils.UpperCase(t))>0;)t=pas.SysUtils.StringReplace(t,"<BR>",String.fromCharCode(13)+String.fromCharCode(10),rtl.createSet(1));for(;pas.System.Pos("<HR>",pas.SysUtils.UpperCase(t))>0;)t=pas.SysUtils.StringReplace(t,"<HR>",String.fromCharCode(13)+String.fromCharCode(10),rtl.createSet(1));for(i=0;this.VarPos("<",t,{get:function(){return i},set:function(t){rtl.rc(t,-2147483648,2147483647),i=t}})>0&&(e+=pas.System.Copy(t,1,i-1),this.VarPos(">",t,{get:function(){return i},set:function(t){rtl.rc(t,-2147483648,2147483647),i=t}})>0);)pas.System.Delete({get:function(){return t},set:function(e){t=e}},1,i);return e+=t},this.VarPos=function(t,e,i){rtl.rc(i.get(),-2147483648,2147483647);return i.set(pas.System.Pos(t,e)),rtl.rc(i.get(),-2147483648,2147483647)},this.CharInStr=function(t,e){var i="";return i="\0",e>0&&e<=t.length&&(i=t.charAt(e-1)),i},this.HexStrToBytes=function(t){var e=0,i=0,s=[];for([],s=rtl.arraySetLength(s,0,rtl.trunc(t.length/2)),e=1,i=0;e<=t.length;)s[i]=pas.SysUtils.StrToInt("$"+t.charAt(e-1)+t.charAt(e+1-1)),e+=2,i+=1;return rtl.arrayRef(s)},this.SaveBitmapToHexStr=function(t){var e="",i=null,s="",n=null,o=null;i=pas.Classes.TMemoryStream.$create("Create");try{if(s="",!t.Empty()){n=t.Image();var r=document.createElement("canvas");r.width=n.width,r.height=n.height,r.getContext("2d").drawImage(n,0,0),s=r.toDataURL("image/png"),o=pas.Classes.TStringStream.$create("Create$2",[s]);try{s=this.SaveStreamToHexStr(o)}finally{o=rtl.freeLoc(o)}}e=s}finally{i=rtl.freeLoc(i)}return e},this.SaveStreamToHexStr=function(t){var e="",i=[];e="",t.SetPosition(0);for(var s=1,n=t.GetSize();s<=n;s++)s,i=rtl.arraySetLength(i,0,1),t.Read({get:function(){return i},set:function(t){i=t}},1),e+=pas.SysUtils.IntToHex(i[0],2);return e},this.MulDivInt=function(t,e,i){var s,n=0;return 0===i?n=-1:n=(s=t*e/i)>=0?pas.System.Trunc(s+.5):pas.System.Trunc(s-.5),n},this.LoadBitmapFromHexStr=function(t,e){var i=null,s=null,n=null,o=[],r="";i=pas.Classes.TStringStream.$create("Create$2",[t]),n=pas.Classes.TBytesStream.$create("Create");try{for(var a=1,l=rtl.trunc(i.GetSize()/2);a<=l;a++)a,o=this.HexStrToBytes(i.ReadString(2)),n.Write(o,rtl.length(o));n.SetPosition(0),r="",s=pas.Classes.TStringStream.$create("Create$2",[""]);try{s.CopyFrom(n,n.GetSize()),r=s.GetDataString()}finally{s=rtl.freeLoc(s)}pas.System.Pos(";base64,",r)>0?e.LoadFromResource(r):e.LoadFromStream(n)}finally{i=rtl.freeLoc(i),n=rtl.freeLoc(n)}},this.LoadBitmapFromBase64=function(t,e,i){var s="";s=t,pas.System.Pos(";base64,",s)>0||(s="data:image/png;base64,"+s),e.LoadFromResource(s)},this.Split=function(t,e,i,s){rtl.rcc(t,0,65535);var n=0;if(i.Clear(),i.SetDelimiter(t),i.FStrictDelimiter=!0,i.SetDelimitedText(e),s)for(var o=i.GetCount()-1;o>=0;o--)n=o,""===i.Get(n)&&i.Delete(n)},this.Encode64$1=function(t,e){var i="",s="";if(i="",0===rtl.length(t))return i;return s="",s=function(t){for(var e="",i=new Uint8Array(t),s=i.byteLength,n=0;n<s;n++)e+=String.fromCharCode(i[n]);return window.btoa(e)}(rtl.arrayRef(t)),e&&(s=pas.SysUtils.StringReplace(s,"+","-",rtl.createSet(0,1)),s=pas.SysUtils.StringReplace(s,"/","_",rtl.createSet(0,1)),s=pas.SysUtils.StringReplace(s,"=","",rtl.createSet(0,1))),i=s},this.GetJSONArraySize=function(t){return t.GetCount()},this.GetJSONArrayItem=function(t,e){var i=null;return i=null,e>=0&&e<=this.GetJSONArraySize(t)-1&&(i=t.GetItem(e)),i},this.GetJSONObjectSize=function(t){return t.GetCount()},this.GetJSONObjectItem=function(t,e){var i=null;return i=null,e>=0&&e<=this.GetJSONObjectSize(t)-1&&(i=t.GetItem(e)),i},this.GetJSONObjectName=function(t,e){var i="",s=null;return i="",e>=0&&e<=this.GetJSONObjectSize(t)-1&&null!=(s=t.Get$1(e))&&(i=s.fjs.GetStrValue()),i},this.ParseJSON=function(t){return pas["WEBLib.JSON"].TJSONObject.ParseJSONValue(t)},this.Decode64ToBytes=function(t,e){var i,s=[],n="",o=null;if(s=[],0===t.length)return s;n=t,e&&(n+=pas.System.StringOfChar("=",n.length%4),n=pas.SysUtils.StringReplace(n,"-","+",rtl.createSet(0)),n=pas.SysUtils.StringReplace(n,"_","/",rtl.createSet(0))),i=n,n=window.atob(i),o=pas.Classes.TStringStream.$create("Create$3",["",pas.Classes.TEncoding.GetUTF8(),!0]);try{o.WriteString(n),s=pas["WEBLib.TMSFNCTypes"].TTMSFNCMemoryStream.GetBytes.call(o)}finally{o=rtl.freeLoc(o)}return s},this.MatchStrEx=function(e,i,s){var n="",o="",r=0,a=0,l=!1,h=!1,F=[];if(e=pas.SysUtils.Trim(e),e=this.StripLogicSpaces(e),r=rtl.rc(-1,-2147483648,2147483647),1===t.TTMSFNCUtils.VarPos("=",e,{get:function(){return r},set:function(t){rtl.rc(t,-2147483648,2147483647),r=t}})&&pas.System.Delete({get:function(){return e},set:function(t){e=t}},r,1),o="\0",l=!0,(F=rtl.arraySetLength(F,"",5))[0]="(",F[1]=";",F[2]="^",F[3]="&",F[4]="|",""===e)return""===i;if("*"!==e&&""===i)return!1;do{if("\0"!==(n=rtl.rcc(this.FirstChar(rtl.arrayRef(F),e,{get:function(){return r},set:function(t){rtl.rc(t,-2147483648,2147483647),r=t}}),0,65535))){if(e.length>0&&"("===rtl.rcCharAt(e,0)&&pas.System.Pos("(",e)>0?(a=rtl.rc(this.ClosingParenthesis(e),-2147483648,2147483647),h=this.MatchStrEx(pas.System.Copy(e,2,a-2),i,s),pas.System.Delete({get:function(){return e},set:function(t){e=t}},1,a)):(h=this.MatchStr(pas.System.Copy(e,1,r-1),i,s),pas.System.Delete({get:function(){return e},set:function(t){e=t}},1,r)),"\0"===o)l=h;else{";"===o||"^"===o||"|"===o?l=l||h:"&"===o&&(l=l&&h)}o=rtl.rcc(n,0,65535)}}while("\0"!==n);if(h=this.MatchStr(e,i,s),"\0"===o)l=h;else{";"===o||"^"===o||"|"===o?l=l||h:"&"===o&&(l=l&&h)}return l},this.MatchStr=function(t,e,i){return i?this.Matches(t,e):this.Matches(pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(t),pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(e))},this.StripLogicSpaces=function(t){var e,i="",s=0,n=0;for(n=0,s=1,e=t.length,i="";s<=e;)'"'===t.charAt(s-1)&&(n+=1)," "===t.charAt(s-1)?pas.System.Odd(n)&&(i+=t.charAt(s-1)):i+=t.charAt(s-1),s+=1;return i},this.FirstChar=function(t,e,i){var s="",n=0,o=0;for(0,n=1,o=0,i.set(-1),s="\0";n<=e.length;){if('"'===e.charAt(n-0-1)&&(o+=1),this.CharInSet(e.charAt(n-0-1),rtl.arrayRef(t))&&!pas.System.Odd(o)){i.set(n),s=e.charAt(n-0-1);break}n+=1}return s},this.CharInSet=function(t,e){var i=!1;i=!1;for(var s=0,n=rtl.length(e)-1;s<=n;s++)if(t===e[s]){i=!0;break}return i},this.CreateCharSet=function(t){var e=[],i=0;e=rtl.arraySetLength(e,"",t.length);for(var s=1,n=t.length;s<=n;s++)e[(i=s)-1]=this.CharInStr(t,i);return e},this.IsDate=function(e,i){var s,n,o,r=!1,a="",l="",h=0,F=0,p=0,c=0,u=0,T=0,C=0,S=0;if(r=!1,l="",a=pas.SysUtils.UpperCase(pas.SysUtils.FormatSettings.ShortDateFormat),s=pas.System.Pos("D",a),n=pas.System.Pos("M",a),o=pas.System.Pos("Y",a),h=0,F=0,p=0,c=0,u=0,T=0,S=-1,t.TTMSFNCUtils.VarPos(pas.SysUtils.FormatSettings.DateSeparator,e,{get:function(){return S},set:function(t){S=t}})>0){if(a=pas.System.Copy(e,1,S-1),s<n&&s<o?pas.System.val$5(a,{get:function(){return h},set:function(t){h=t}},{get:function(){return C},set:function(t){C=t}}):n<s&&n<o?pas.System.val$5(a,{get:function(){return F},set:function(t){F=t}},{get:function(){return C},set:function(t){C=t}}):o<n&&o<s&&pas.System.val$5(a,{get:function(){return p},set:function(t){p=t}},{get:function(){return C},set:function(t){C=t}}),0!==C)return r;if(pas.System.Delete({get:function(){return e},set:function(t){e=t}},1,S),t.TTMSFNCUtils.VarPos(pas.SysUtils.FormatSettings.DateSeparator,e,{get:function(){return S},set:function(t){S=t}})>0){if(a=pas.System.Copy(e,1,S-1),s>n&&s<o||s>o&&s<n?pas.System.val$5(a,{get:function(){return h},set:function(t){h=t}},{get:function(){return C},set:function(t){C=t}}):n>s&&n<o||n>o&&n<s?pas.System.val$5(a,{get:function(){return F},set:function(t){F=t}},{get:function(){return C},set:function(t){C=t}}):(o>n&&o<s||o>s&&o<n)&&pas.System.val$5(a,{get:function(){return p},set:function(t){p=t}},{get:function(){return C},set:function(t){C=t}}),0!==C)return r;if(pas.System.Delete({get:function(){return e},set:function(t){e=t}},1,S),e=pas.SysUtils.Trim(e),t.TTMSFNCUtils.VarPos(" ",e,{get:function(){return S},set:function(t){S=t}})>0&&(l=pas.System.Copy(e,S,e.length),e=pas.System.Copy(e,1,S-1)),s>n&&s>o?pas.System.val$5(e,{get:function(){return h},set:function(t){h=t}},{get:function(){return C},set:function(t){C=t}}):n>s&&n>o?pas.System.val$5(e,{get:function(){return F},set:function(t){F=t}},{get:function(){return C},set:function(t){C=t}}):o>n&&o>s&&pas.System.val$5(e,{get:function(){return p},set:function(t){p=t}},{get:function(){return C},set:function(t){C=t}}),0!==C)return r;if(h>31)return r;if(F>12)return r;if(""!==l){if(t.TTMSFNCUtils.VarPos(pas.SysUtils.FormatSettings.TimeSeparator,l,{get:function(){return S},set:function(t){S=t}})>0){if(a=pas.System.Copy(l,1,S-1),pas.System.val$5(a,{get:function(){return c},set:function(t){c=t}},{get:function(){return C},set:function(t){C=t}}),0!==C)return r;if(c>23)return r;if(pas.System.Delete({get:function(){return l},set:function(t){l=t}},1,S),t.TTMSFNCUtils.VarPos(pas.SysUtils.FormatSettings.TimeSeparator,l,{get:function(){return S},set:function(t){S=t}})>0){if(a=pas.System.Copy(l,1,S-1),pas.System.val$5(a,{get:function(){return u},set:function(t){u=t}},{get:function(){return C},set:function(t){C=t}}),0!==C)return r;if(pas.System.Delete({get:function(){return l},set:function(t){l=t}},1,S),pas.System.val$5(l,{get:function(){return T},set:function(t){T=t}},{get:function(){return C},set:function(t){C=t}}),0!==C)return r;if(T>60)return r}else if(pas.System.val$5(a,{get:function(){return u},set:function(t){u=t}},{get:function(){return C},set:function(t){C=t}}),0!==C)return r;if(u>59)return r;r=!0}}else r=!0;try{i.set(pas.SysUtils.EncodeDate(p,F,h)+pas.SysUtils.EncodeTime(c,u,T,0))}catch(t){r=!1}}}return r},this.IPos=function(t,e){return pas.System.Pos(pas.SysUtils.UpperCase(t),pas.SysUtils.UpperCase(e))},this.UnFixMarkup=function(t,i,s){var n=0;if(!s){for(;pas.System.Pos("&lt;",t)>0;)this.TagReplaceString("&lt;","<",{get:function(){return t},set:function(e){t=e}});for(;pas.System.Pos("&gt;",t)>0;)this.TagReplaceString("&gt;",">",{get:function(){return t},set:function(e){t=e}});for(;pas.System.Pos("&amp;",t)>0;)this.TagReplaceString("&amp;","&",{get:function(){return t},set:function(e){t=e}});for(;pas.System.Pos("&quot;",t)>0;)this.TagReplaceString("&quot;",'"',{get:function(){return t},set:function(e){t=e}})}if(i)for(n=4;n<=92;n++)for(;pas.System.Pos(e.HTMLSpecialChar[n-1],t)>0;)this.TagReplaceString(e.HTMLSpecialChar[n-1],e.HTMLEncodedChar[n-1],{get:function(){return t},set:function(e){t=e}});return t},this.TagReplaceString=function(t,e,i){var s,n=!1;return(s=this.IPos(t,i.get()))>0?(n=!0,pas.System.Delete(i,s,t.length),i.set(pas.System.Copy(i.get(),1,s-1)+e+pas.System.Copy(i.get(),s,i.get().length))):n=!1,n};this.Matches=function(e,i){var s=!1,n=!1,o=0,r="",a=0,l=0,h=0,F=0,p=!1,c=!1,u=!1,T="",C=!1,S=!1,d=!1,m=!1,f=0,g=0,y=0,b=0,N=0,M=0,B=0;if(0,p=!0,c=!0,C=!1,S=!1,d=!1,u=!1,m=!1,0!==(h=rtl.rc(pas.System.Pos(">",e),-2147483648,2147483647))){for(h+=1,"="===rtl.rcCharAt(e,h-0-1)&&(m=!0,h+=1);" "===rtl.rcCharAt(e,h-0-1);)h+=1;for(F=rtl.rc(h,-2147483648,2147483647),o=0,r="\0",B=0;h-0<=e.length&&" "!==rtl.rcCharAt(e,h-0-1)&&h<=e.length&&(pas.System.Odd(B)||"&"!==rtl.rcCharAt(e,h-0-1)&&"|"!==rtl.rcCharAt(e,h-0-1));)'"'===rtl.rcCharAt(e,h-0-1)&&(B+=1),0===o&&'"'===rtl.rcCharAt(e,h-0-1)?F+=1:o+=1,r=rtl.rcc(rtl.rcCharAt(e,h-0-1),0,65535),(h+=1)-0<=e.length&&" "===rtl.rcCharAt(e,h-0-1)&&pas.System.Odd(B)&&(r=rtl.rcc(rtl.rcCharAt(e,h-0-1),0,65535),h+=1);o>0&&'"'===r&&(o-=1),T=pas.System.Copy(e,F,o),pas.System.val$8(t.TTMSFNCUtils.StripThousandSep(i),{get:function(){return f},set:function(t){f=t}},{get:function(){return y},set:function(t){rtl.rc(t,-2147483648,2147483647),y=t}}),pas.System.val$8(t.TTMSFNCUtils.StripThousandSep(T),{get:function(){return g},set:function(t){g=t}},{get:function(){return b},set:function(t){rtl.rc(t,-2147483648,2147483647),b=t}}),M=0,t.TTMSFNCUtils.IsDate(T,{get:function(){return M},set:function(t){M=t}})&&(b=1),N=0,t.TTMSFNCUtils.IsDate(i,{get:function(){return N},set:function(t){N=t}})&&(y=1),c=0===y&&0===b?m?f>=g:f>g:t.TTMSFNCUtils.IsDate(T,{get:function(){return M},set:function(t){M=t}})&&t.TTMSFNCUtils.IsDate(i,{get:function(){return N},set:function(t){N=t}})?m?N>=M:N>M:m?pas.SysUtils.CompareStr(T,i)<=0:pas.SysUtils.CompareStr(T,i)<0,C=!0}if(m=!1,0!==(h=rtl.rc(pas.System.Pos("<",e),-2147483648,2147483647))){for(h+=1,"="===rtl.rcCharAt(e,h-0-1)&&(m=!0,h+=1),r="\0";h-0<=e.length&&" "===rtl.rcCharAt(e,h-0-1);)h+=1;for(F=rtl.rc(h,-2147483648,2147483647),o=0,B=0;h-0<=e.length&&" "!==rtl.rcCharAt(e,h-0-1)&&h<=e.length&&(pas.System.Odd(B)||"&"!==rtl.rcCharAt(e,h-0-1)&&"|"!==rtl.rcCharAt(e,h-0-1));)'"'===rtl.rcCharAt(e,h-0-1)&&(B+=1),0===o&&'"'===rtl.rcCharAt(e,h-0-1)?F+=1:o+=1,r=rtl.rcc(rtl.rcCharAt(e,h-0-1),0,65535),h+=1;o>0&&'"'===r&&(o-=1),T=pas.System.Copy(e,F,o),pas.System.val$8(t.TTMSFNCUtils.StripThousandSep(i),{get:function(){return f},set:function(t){f=t}},{get:function(){return y},set:function(t){rtl.rc(t,-2147483648,2147483647),y=t}}),pas.System.val$8(t.TTMSFNCUtils.StripThousandSep(T),{get:function(){return g},set:function(t){g=t}},{get:function(){return b},set:function(t){rtl.rc(t,-2147483648,2147483647),b=t}}),t.TTMSFNCUtils.IsDate(T,{get:function(){return M},set:function(t){M=t}})&&(b=1),t.TTMSFNCUtils.IsDate(i,{get:function(){return N},set:function(t){N=t}})&&(y=1),p=0===y&&0===b?m?f<=g:f<g:t.TTMSFNCUtils.IsDate(T,{get:function(){return M},set:function(t){M=t}})&&t.TTMSFNCUtils.IsDate(i,{get:function(){return N},set:function(t){N=t}})?m?N<=M:N<M:m?pas.SysUtils.CompareStr(T,i)>=0:pas.SysUtils.CompareStr(T,i)>0,S=!0}if(0!==(h=rtl.rc(pas.System.Pos("!",e),-2147483648,2147483647))){for(h+=1;" "===rtl.rcCharAt(e,h-0-1);)h+=1;for(F=rtl.rc(h,-2147483648,2147483647),o=0,r="\0",B=0;" "!==rtl.rcCharAt(e,h-0-1)&&h<=e.length&&(pas.System.Odd(B)||"&"!==rtl.rcCharAt(e,h-0-1)&&"|"!==rtl.rcCharAt(e,h-0-1));)'"'===rtl.rcCharAt(e,h-0-1)&&(B+=1),0===o&&'"'===rtl.rcCharAt(e,h-0-1)?F+=1:o+=1,r=rtl.rcc(rtl.rcCharAt(e,h-0-1),0,65535),h+=1;o>0&&'"'===r&&(o-=1),T=pas.System.Copy(e,F,o),d=!0}if(d&&(0===pas.System.Pos(">",e)&&(C=d),0===pas.System.Pos("<",e)&&(S=d)),0!==pas.System.Pos("^",e)&&(C||S))return p||c;if(0!==pas.System.Pos("&",e)&&C&&S)return p&&c;if(0!==pas.System.Pos(">",e)&&c||0!==pas.System.Pos("<",e)&&p)return!0;for(a=1,l=1,n=""===e||""===i,s=!0;!n&&s;){var E=rtl.rcCharAt(e,a-0-1);if("?"===E)(s=l<=i.length)&&(a+=1,l+=1);else if("!"===E)u=!0,a+=1;else if('"'===E)a+=1;else if("*"===E){do{a+=1}while(!(a-0>e.length||"*"!==rtl.rcCharAt(e,a-0-1)));for(l+=o=rtl.rc(i.length-l,-2147483648,2147483647),s=this.Matches(pas.System.Copy(e,a,e.length),pas.System.Copy(i,l,i.length));o>=0&&!s;)l-=1,o-=1,s=this.Matches(pas.System.Copy(e,a,e.length),pas.System.Copy(i,l,i.length));s&&(a=rtl.rc(e.length+1,-2147483648,2147483647),l=rtl.rc(i.length+1,-2147483648,2147483647))}else(s=a<=e.length&&l<=i.length&&rtl.rcCharAt(e,a-0-1)===rtl.rcCharAt(i,l-0-1))&&(a+=1,l+=1);n=a>e.length&&l>i.length}return u?!s:s},this.StripThousandSep=function(t){for(;pas.System.Pos(pas.SysUtils.FormatSettings.ThousandSeparator,t)>0;)pas.System.Delete({get:function(){return t},set:function(e){t=e}},pas.System.Pos(pas.SysUtils.FormatSettings.ThousandSeparator,t),1);return t},this.ClosingParenthesis=function(t){var e=0,i=0,s=0,n=0;for(n=0,i=0,s=0,e=1;e<=t.length;){if(")"===t.charAt(e-1)&&(s+=1),"("===t.charAt(e-1)&&(i+=1),")"===t.charAt(e-1)&&i===s){n=e;break}e+=1}return n},this.IndexOfTextInArray=function(t,e){var i=0,s=0;i=-1;for(var n=0,o=rtl.length(e)-1;n<=o;n++)if(s=n,pas.SysUtils.SameText(t,e[s])){if(!(pas.System.Pos("cute",t)>0||pas.System.Pos("grave",t)>0||pas.System.Pos("uml",t)>0||pas.System.Pos("circ",t)>0||pas.System.Pos("tilde",t)>0||pas.System.Pos("ring",t)>0||pas.System.Pos("cedil",t)>0)){i=s;break}if(t===e[s]){i=s;break}}return i},this.GetParentForm=function(t){var e,i=null;return i=null,null==(e=t)?i:i=pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(e.FParent)?rtl.as(e.FParent,pas["WEBLib.Forms"].TCustomForm):this.GetParentForm(e.FParent)},this.GetOwnerForm=function(t){var e,i=null;return i=null,null==(e=t)?i:i=pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(e.FOwner)?rtl.as(e.FOwner,pas["WEBLib.Forms"].TCustomForm):this.GetOwnerForm(e.FOwner)},this.EscapeString=function(t){var i="",s="",n="",o=0;function r(t,i){var s=!1,n=0;for(s=!1,i.set(""),n=1;n<=7;n++)if(t===e.JSONSpecialChar[n-1]){i.set(e.JSONEncodedSpecialChar[n-1]),s=!0;break}return s}i="";for(var a=1,l=t.length;a<=l;a++)o=a,(n=this.CharInStr(t,o))>""?i=i+"\\u"+pas.SysUtils.IntToHex(n.charCodeAt(),4):(s="",r(n,{get:function(){return s},set:function(t){s=t}})?i+=s:i+=n);return i},this.UnescapeString=function(t){var e=0,i=0,s=0,n="",o=0;for(n=rtl.strSetLength(n,t.length),0,e=1,i=1;e<=t.length;){if("\\"===t.charAt(e-0-1)){if(!(e<t.length))throw pas.SysUtils.Exception.$create("Create$1",["Unexpected end of string"]);if("\\"===t.charAt(e+1-0-1))o=i-0,n=rtl.setCharAt(n,o-1,"\\"),e+=2;else if("/"===t.charAt(e+1-0-1))o=i-0,n=rtl.setCharAt(n,o-1,"/"),e+=2;else if("b"===t.charAt(e+1-0-1))o=i-0,n=rtl.setCharAt(n,o-1,"\b"),e+=2;else if("f"===t.charAt(e+1-0-1))o=i-0,n=rtl.setCharAt(n,o-1,"\f"),e+=2;else if("n"===t.charAt(e+1-0-1))o=i-0,n=rtl.setCharAt(n,o-1,"\n"),e+=2;else if("r"===t.charAt(e+1-0-1))o=i-0,n=rtl.setCharAt(n,o-1,"\r"),e+=2;else if("t"===t.charAt(e+1-0-1))o=i-0,n=rtl.setCharAt(n,o-1,"\t"),e+=2;else if('"'===t.charAt(e+1-0-1))o=i-0,n=rtl.setCharAt(n,o-1,'"'),e+=2;else{if(!("u"===t.charAt(e+1-0-1)&&e+1+4<=t.length&&pas.SysUtils.TryStrToInt("$"+pas.System.Copy(t,e+2,4),{get:function(){return s},set:function(t){s=t}})))throw pas.SysUtils.Exception.$create("CreateFmt",["Invalid code at position %s",pas.System.VarRecs(18,pas.SysUtils.IntToStr(e))]);e+=6,o=i-0,n=rtl.setCharAt(n,o-1,String.fromCharCode(s))}}else o=i-0,n=rtl.setCharAt(n,o-1,t.charAt(e-0-1)),e+=1;i+=1}return n=rtl.strSetLength(n,i-1)}})),this.TTMSFNCClipBoardFormat={0:"cfText",cfText:0,1:"cfRTF",cfRTF:1,2:"cfHTML",cfHTML:2,3:"cfBitmap",cfBitmap:3,4:"cfBitmapWin",cfBitmapWin:4,5:"cfStream",cfStream:5,6:"cfRichTextStream",cfRichTextStream:6},rtl.createClass(this,"TTMSFNCClipBoard",pas.System.TObject,(function(){this.FClipboardData="",this.HasFormat=function(t){rtl.rc(t,0,6);return!0,!0},this.SetText=function(e){t.TTMSFNCClipBoard.FClipboardData=e;const i=document.createElement("textarea");i.value=e,document.body.appendChild(i),i.focus(),i.setSelectionRange(0,i.value.length),document.execCommand("copy"),document.body.removeChild(i)},this.GetText=function(){return this.FClipboardData}})),t.$implcode=function(){e.HTMLNumSpecialChar=92,e.JSONNumSpecialChar=7,e.HTMLEncodedChar=["&","<",">",'"'," ","é","è","ë","ê","ó","ò","ö","ô","í","ì","ï","î","ú","ù","ü","û","á","à","ä","â","É","È","Ë","Ê","Ó","Ò","Ö","Ô","Í","Ì","Ï","Î","Ú","Ù","Ü","Û","Á","À","Ä","Â","ç","Ç","ø","Ø","å","Å","©","®","€","«","»","ã","Ã","õ","Õ","™","§","¶","ß","£","$","§","‰","¶","'","¥","¤","¢","±","¡","°","ý","Ý","¼","½","¾","Æ","æ","Ñ","ñ","Ð","´","µ","¶","·","²","³"],e.HTMLSpecialChar=["amp;","lt;","gt;","quot;","&nbsp;","&eacute;","&egrave;","&euml;","&ecirc;","&oacute;","&ograve;","&ouml;","&ocirc;","&iacute;","&igrave;","&iuml;","&icirc;","&uacute;","&ugrave;","&uuml;","&ucirc;","&aacute;","&agrave;","&auml;","&acirc;","&Eacute;","&Egrave;","&Euml;","&Ecirc;","&Oacute;","&Ograve;","&Ouml;","&Ocirc;","&Iacute;","&Igrave;","&Iuml;","&Icirc;","&Uacute;","&Ugrave;","&Uuml;","&Ucirc;","&Aacute;","&Agrave;","&Auml;","&Acirc;","&ccedil;","&Ccedil;","&oslash;","&Oslash;","&aring;","&Aring;","&copy;","&reg;","&euro;","&laquo;","&raquo;","&atilde;","&Atilde;","&otilde;","&Otilde","&trade;","&sect;","&para;","&szlig;","&pound;","&#36;","&sect;","&permil;","&para;","&#39;","&yen;","&curren;","&cent;","&plusmn;","&iexcl;","&deg;","&#x00FD;","&#221;","&frac14;","&frac12;","&frac34;","&AElig;","&aelig;","&Ntilde;","&ntilde;","&ETH;","&acute;","&micro;","&para;","&middot","&sup2;","&sup3;"],e.JSONSpecialChar=['"',"\\","\b","\f","\n","\r","\t"],e.JSONEncodedSpecialChar=["\\u0022","\\u005C","\\u0008","\\u000C","\\u000A","\\u000D","\\u0009"],e.FMimeTypes=null,e.RegisterMimeTypes=function(){function t(t,i){e.FMimeTypes.Add(t+e.FMimeTypes.GetNameValueSeparator()+i)}t("ez","application/andrew-inset"),t("aw","application/applixware"),t("atom","application/atom+xml"),t("atomcat","application/atomcat+xml"),t("atomsvc","application/atomsvc+xml"),t("bson","application/bson"),t("ccxml","application/ccxml+xml"),t("cdmia","application/cdmi-capability"),t("cdmic","application/cdmi-container"),t("cdmid","application/cdmi-domain"),t("cdmio","application/cdmi-object"),t("cdmiq","application/cdmi-queue"),t("cu","application/cu-seeme"),t("davmount","application/davmount+xml"),t("dbk","application/docbook+xml"),t("dssc","application/dssc+der"),t("xdssc","application/dssc+xml"),t("ecma","application/ecmascript"),t("emma","application/emma+xml"),t("epub","application/epub+zip"),t("exi","application/exi"),t("pfr","application/font-tdpfr"),t("gml","application/gml+xml"),t("gpx","application/gpx+xml"),t("gxf","application/gxf"),t("stk","application/hyperstudio"),t("ink","application/inkml+xml"),t("inkml","application/inkml+xml"),t("ipfix","application/ipfix"),t("jar","application/java-archive"),t("ser","application/java-serialized-object"),t("class","application/java-vm"),t("js","application/javascript"),t("json","application/json"),t("jsonml","application/jsonml+json"),t("lostxml","application/lost+xml"),t("hqx","application/mac-binhex40"),t("cpt","application/mac-compactpro"),t("mads","application/mads+xml"),t("mrc","application/marc"),t("mrcx","application/marcxml+xml"),t("ma","application/mathematica"),t("nb","application/mathematica"),t("mb","application/mathematica"),t("mathml","application/mathml+xml"),t("mbox","application/mbox"),t("mscml","application/mediaservercontrol+xml"),t("metalink","application/metalink+xml"),t("meta4","application/metalink4+xml"),t("mets","application/mets+xml"),t("mods","application/mods+xml"),t("m21","application/mp21"),t("mp21","application/mp21"),t("mp4s","application/mp4"),t("doc","application/msword"),t("dot","application/msword"),t("mxf","application/mxf"),t("bin","application/octet-stream"),t("bpk","application/octet-stream"),t("class","application/octet-stream"),t("deploy","application/octet-stream"),t("dist","application/octet-stream"),t("distz","application/octet-stream"),t("dmg","application/octet-stream"),t("dms","application/octet-stream"),t("dump","application/octet-stream"),t("elc","application/octet-stream"),t("iso","application/octet-stream"),t("lha","application/octet-stream"),t("lrf","application/octet-stream"),t("lzh","application/octet-stream"),t("mar","application/octet-stream"),t("pkg","application/octet-stream"),t("so","application/octet-stream"),t("oda","application/oda"),t("opf","application/oebps-package+xml"),t("ogx","application/ogg"),t("omdoc","application/omdoc+xml"),t("onetoc","application/onenote"),t("onetoc2","application/onenote"),t("onetmp","application/onenote"),t("onepkg","application/onenote"),t("oxps","application/oxps"),t("xer","application/patch-ops-error+xml"),t("pdf","application/pdf"),t("pgp","application/pgp-encrypted"),t("asc","application/pgp-signature"),t("sig","application/pgp-signature"),t("prf","application/pics-rules"),t("p10","application/pkcs10"),t("p7m","application/pkcs7-mime"),t("p7c","application/pkcs7-mime"),t("p7s","application/pkcs7-signature"),t("p8","application/pkcs8"),t("ac","application/pkix-attr-cert"),t("cer","application/pkix-cert"),t("crl","application/pkix-crl"),t("pkipath","application/pkix-pkipath"),t("pki","application/pkixcmp"),t("pls","application/pls+xml"),t("ai","application/postscript"),t("eps","application/postscript"),t("ps","application/postscript"),t("cww","application/prs.cww"),t("pskcxml","application/pskc+xml"),t("rdf","application/rdf+xml"),t("rif","application/reginfo+xml"),t("rnc","application/relax-ng-compact-syntax"),t("rl","application/resource-lists+xml"),t("rld","application/resource-lists-diff+xml"),t("rs","application/rls-services+xml"),t("gbr","application/rpki-ghostbusters"),t("mft","application/rpki-manifest"),t("roa","application/rpki-roa"),t("rsd","application/rsd+xml"),t("rss","application/rss+xml"),t("rtf","application/rtf"),t("sbml","application/sbml+xml"),t("scq","application/scvp-cv-request"),t("scs","application/scvp-cv-response"),t("spq","application/scvp-vp-request"),t("spp","application/scvp-vp-response"),t("sdp","application/sdp"),t("setpay","application/set-payment-initiation"),t("setreg","application/set-registration-initiation"),t("shf","application/shf+xml"),t("smi","application/smil+xml"),t("smil","application/smil+xml"),t("soap","application/soap+xml"),t("rq","application/sparql-query"),t("srx","application/sparql-results+xml"),t("gram","application/srgs"),t("grxml","application/srgs+xml"),t("sru","application/sru+xml"),t("ssdl","application/ssdl+xml"),t("ssml","application/ssml+xml"),t("tei","application/tei+xml"),t("teicorpus","application/tei+xml"),t("tfi","application/thraud+xml"),t("tsd","application/timestamped-data"),t("plb","application/vnd.3gpp.pic-bw-large"),t("psb","application/vnd.3gpp.pic-bw-small"),t("pvb","application/vnd.3gpp.pic-bw-var"),t("tcap","application/vnd.3gpp2.tcap"),t("pwn","application/vnd.3m.post-it-notes"),t("aso","application/vnd.accpac.simply.aso"),t("imp","application/vnd.accpac.simply.imp"),t("acu","application/vnd.acucobol"),t("atc","application/vnd.acucorp"),t("acutc","application/vnd.acucorp"),t("air","application/vnd.adobe.air-application-installer-package+zip"),t("fcdt","application/vnd.adobe.formscentral.fcdt"),t("fxp","application/vnd.adobe.fxp"),t("fxpl","application/vnd.adobe.fxp"),t("xdp","application/vnd.adobe.xdp+xml"),t("xfdf","application/vnd.adobe.xfdf"),t("ahead","application/vnd.ahead.space"),t("azf","application/vnd.airzip.filesecure.azf"),t("azs","application/vnd.airzip.filesecure.azs"),t("azw","application/vnd.amazon.ebook"),t("acc","application/vnd.americandynamics.acc"),t("ami","application/vnd.amiga.ami"),t("apk","application/vnd.android.package-archive"),t("cii","application/vnd.anser-web-certificate-issue-initiation"),t("fti","application/vnd.anser-web-funds-transfer-initiation"),t("atx","application/vnd.antix.game-component"),t("mpkg","application/vnd.apple.installer+xml"),t("m3u8","application/vnd.apple.mpegurl"),t("swi","application/vnd.aristanetworks.swi"),t("iota","application/vnd.astraea-software.iota"),t("aep","application/vnd.audiograph"),t("mpm","application/vnd.blueice.multipass"),t("bmi","application/vnd.bmi"),t("rep","application/vnd.businessobjects"),t("cdxml","application/vnd.chemdraw+xml"),t("mmd","application/vnd.chipnuts.karaoke-mmd"),t("cdy","application/vnd.cinderella"),t("cla","application/vnd.claymore"),t("rp9","application/vnd.cloanto.rp9"),t("c4g","application/vnd.clonk.c4group"),t("c4d","application/vnd.clonk.c4group"),t("c4f","application/vnd.clonk.c4group"),t("c4p","application/vnd.clonk.c4group"),t("c4u","application/vnd.clonk.c4group"),t("c11amc","application/vnd.cluetrust.cartomobile-config"),t("c11amz","application/vnd.cluetrust.cartomobile-config-pkg"),t("csp","application/vnd.commonspace"),t("cdbcmsg","application/vnd.contact.cmsg"),t("cmc","application/vnd.cosmocaller"),t("clkx","application/vnd.crick.clicker"),t("clkk","application/vnd.crick.clicker.keyboard"),t("clkp","application/vnd.crick.clicker.palette"),t("clkt","application/vnd.crick.clicker.template"),t("clkw","application/vnd.crick.clicker.wordbank"),t("wbs","application/vnd.criticaltools.wbs+xml"),t("pml","application/vnd.ctc-posml"),t("ppd","application/vnd.cups-ppd"),t("car","application/vnd.curl.car"),t("pcurl","application/vnd.curl.pcurl"),t("dart","application/vnd.dart"),t("rdz","application/vnd.data-vision.rdz"),t("uvf","application/vnd.dece.data"),t("uvvf","application/vnd.dece.data"),t("uvd","application/vnd.dece.data"),t("uvvd","application/vnd.dece.data"),t("uvt","application/vnd.dece.ttml+xml"),t("uvvt","application/vnd.dece.ttml+xml"),t("uvx","application/vnd.dece.unspecified"),t("uvvx","application/vnd.dece.unspecified"),t("uvz","application/vnd.dece.zip"),t("uvvz","application/vnd.dece.zip"),t("fe_launch","application/vnd.denovo.fcselayout-link"),t("dna","application/vnd.dna"),t("mlp","application/vnd.dolby.mlp"),t("dpg","application/vnd.dpgraph"),t("dfac","application/vnd.dreamfactory"),t("kpxx","application/vnd.ds-keypoint"),t("ait","application/vnd.dvb.ait"),t("svc","application/vnd.dvb.service"),t("geo","application/vnd.dynageo"),t("mag","application/vnd.ecowin.chart"),t("nml","application/vnd.enliven"),t("esf","application/vnd.epson.esf"),t("msf","application/vnd.epson.msf"),t("qam","application/vnd.epson.quickanime"),t("slt","application/vnd.epson.salt"),t("ssf","application/vnd.epson.ssf"),t("es3","application/vnd.eszigno3+xml"),t("et3","application/vnd.eszigno3+xml"),t("ez2","application/vnd.ezpix-album"),t("ez3","application/vnd.ezpix-package"),t("fdf","application/vnd.fdf"),t("mseed","application/vnd.fdsn.mseed"),t("seed","application/vnd.fdsn.seed"),t("dataless","application/vnd.fdsn.seed"),t("json","application/vnd.firedac.json"),t("xml","application/vnd.firedac.xml"),t("bin","application/vnd.firedac.bin"),t("gph","application/vnd.flographit"),t("ftc","application/vnd.fluxtime.clip"),t("fm","application/vnd.framemaker"),t("frame","application/vnd.framemaker"),t("maker","application/vnd.framemaker"),t("book","application/vnd.framemaker"),t("fnc","application/vnd.frogans.fnc"),t("ltf","application/vnd.frogans.ltf"),t("fsc","application/vnd.fsc.weblaunch"),t("oas","application/vnd.fujitsu.oasys"),t("oa2","application/vnd.fujitsu.oasys2"),t("oa3","application/vnd.fujitsu.oasys3"),t("fg5","application/vnd.fujitsu.oasysgp"),t("bh2","application/vnd.fujitsu.oasysprs"),t("ddd","application/vnd.fujixerox.ddd"),t("xdw","application/vnd.fujixerox.docuworks"),t("xbd","application/vnd.fujixerox.docuworks.binder"),t("fzs","application/vnd.fuzzysheet"),t("txd","application/vnd.genomatix.tuxedo"),t("ggb","application/vnd.geogebra.file"),t("ggt","application/vnd.geogebra.tool"),t("gex","application/vnd.geometry-explorer"),t("gre","application/vnd.geometry-explorer"),t("gxt","application/vnd.geonext"),t("g2w","application/vnd.geoplan"),t("g3w","application/vnd.geospace"),t("gmx","application/vnd.gmx"),t("kml","application/vnd.google-earth.kml+xml"),t("kmz","application/vnd.google-earth.kmz"),t("gqf","application/vnd.grafeq"),t("gqs","application/vnd.grafeq"),t("gac","application/vnd.groove-account"),t("ghf","application/vnd.groove-help"),t("gim","application/vnd.groove-identity-message"),t("grv","application/vnd.groove-injector"),t("gtm","application/vnd.groove-tool-message"),t("tpl","application/vnd.groove-tool-template"),t("vcg","application/vnd.groove-vcard"),t("hal","application/vnd.hal+xml"),t("zmm","application/vnd.handheld-entertainment+xml"),t("hbci","application/vnd.hbci"),t("les","application/vnd.hhe.lesson-player"),t("hpgl","application/vnd.hp-hpgl"),t("hpid","application/vnd.hp-hpid"),t("hps","application/vnd.hp-hps"),t("jlt","application/vnd.hp-jlyt"),t("pcl","application/vnd.hp-pcl"),t("pclxl","application/vnd.hp-pclxl"),t("sfd-hdstx","application/vnd.hydrostatix.sof-data"),t("mpy","application/vnd.ibm.minipay"),t("afp","application/vnd.ibm.modcap"),t("listafp","application/vnd.ibm.modcap"),t("list3820","application/vnd.ibm.modcap"),t("irm","application/vnd.ibm.rights-management"),t("sc","application/vnd.ibm.secure-container"),t("icc","application/vnd.iccprofile"),t("icm","application/vnd.iccprofile"),t("igl","application/vnd.igloader"),t("ivp","application/vnd.immervision-ivp"),t("ivu","application/vnd.immervision-ivu"),t("igm","application/vnd.insors.igm"),t("xpw","application/vnd.intercon.formnet"),t("xpx","application/vnd.intercon.formnet"),t("i2g","application/vnd.intergeo"),t("qbo","application/vnd.intu.qbo"),t("qfx","application/vnd.intu.qfx"),t("rcprofile","application/vnd.ipunplugged.rcprofile"),t("irp","application/vnd.irepository.package+xml"),t("xpr","application/vnd.is-xpr"),t("fcs","application/vnd.isac.fcs"),t("jam","application/vnd.jam"),t("rms","application/vnd.jcp.javame.midlet-rms"),t("jisp","application/vnd.jisp"),t("joda","application/vnd.joost.joda-archive"),t("ktz","application/vnd.kahootz"),t("ktr","application/vnd.kahootz"),t("karbon","application/vnd.kde.karbon"),t("chrt","application/vnd.kde.kchart"),t("kfo","application/vnd.kde.kformula"),t("flw","application/vnd.kde.kivio"),t("kon","application/vnd.kde.kontour"),t("kpr","application/vnd.kde.kpresenter"),t("kpt","application/vnd.kde.kpresenter"),t("ksp","application/vnd.kde.kspread"),t("kwd","application/vnd.kde.kword"),t("kwt","application/vnd.kde.kword"),t("htke","application/vnd.kenameaapp"),t("kia","application/vnd.kidspiration"),t("kne","application/vnd.kinar"),t("knp","application/vnd.kinar"),t("skp","application/vnd.koan"),t("skd","application/vnd.koan"),t("skt","application/vnd.koan"),t("skm","application/vnd.koan"),t("sse","application/vnd.kodak-descriptor"),t("lasxml","application/vnd.las.las+xml"),t("lbd","application/vnd.llamagraphics.life-balance.desktop"),t("lbe","application/vnd.llamagraphics.life-balance.exchange+xml"),t("123","application/vnd.lotus-1-2-3"),t("apr","application/vnd.lotus-approach"),t("pre","application/vnd.lotus-freelance"),t("nsf","application/vnd.lotus-notes"),t("org","application/vnd.lotus-organizer"),t("scm","application/vnd.lotus-screencam"),t("lwp","application/vnd.lotus-wordpro"),t("portpkg","application/vnd.macports.portpkg"),t("mcd","application/vnd.mcd"),t("mc1","application/vnd.medcalcdata"),t("cdkey","application/vnd.mediastation.cdkey"),t("mwf","application/vnd.mfer"),t("mfm","application/vnd.mfmp"),t("flo","application/vnd.micrografx.flo"),t("igx","application/vnd.micrografx.igx"),t("mif","application/vnd.mif"),t("daf","application/vnd.mobius.daf"),t("dis","application/vnd.mobius.dis"),t("mbk","application/vnd.mobius.mbk"),t("mqy","application/vnd.mobius.mqy"),t("msl","application/vnd.mobius.msl"),t("plc","application/vnd.mobius.plc"),t("txf","application/vnd.mobius.txf"),t("mpn","application/vnd.mophun.application"),t("mpc","application/vnd.mophun.certificate"),t("xul","application/vnd.mozilla.xul+xml"),t("cil","application/vnd.ms-artgalry"),t("cab","application/vnd.ms-cab-compressed"),t("xls","application/vnd.ms-excel"),t("xlm","application/vnd.ms-excel"),t("xla","application/vnd.ms-excel"),t("xlc","application/vnd.ms-excel"),t("xlt","application/vnd.ms-excel"),t("xlw","application/vnd.ms-excel"),t("xlam","application/vnd.ms-excel.addin.macroenabled.12"),t("xlsb","application/vnd.ms-excel.sheet.binary.macroenabled.12"),t("xlsm","application/vnd.ms-excel.sheet.macroenabled.12"),t("xltm","application/vnd.ms-excel.template.macroenabled.12"),t("eot","application/vnd.ms-fontobject"),t("chm","application/vnd.ms-htmlhelp"),t("ims","application/vnd.ms-ims"),t("lrm","application/vnd.ms-lrm"),t("thmx","application/vnd.ms-officetheme"),t("cat","application/vnd.ms-pki.seccat"),t("stl","application/vnd.ms-pki.stl"),t("ppt","application/vnd.ms-powerpoint"),t("pps","application/vnd.ms-powerpoint"),t("pot","application/vnd.ms-powerpoint"),t("ppam","application/vnd.ms-powerpoint.addin.macroenabled.12"),t("pptm","application/vnd.ms-powerpoint.presentation.macroenabled.12"),t("sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"),t("ppsm","application/vnd.ms-powerpoint.slideshow.macroenabled.12"),t("potm","application/vnd.ms-powerpoint.template.macroenabled.12"),t("mpp","application/vnd.ms-project"),t("mpt","application/vnd.ms-project"),t("docm","application/vnd.ms-word.document.macroenabled.12"),t("dotm","application/vnd.ms-word.template.macroenabled.12"),t("wps","application/vnd.ms-works"),t("wks","application/vnd.ms-works"),t("wcm","application/vnd.ms-works"),t("wdb","application/vnd.ms-works"),t("wpl","application/vnd.ms-wpl"),t("xps","application/vnd.ms-xpsdocument"),t("mseq","application/vnd.mseq"),t("mus","application/vnd.musician"),t("msty","application/vnd.muvee.style"),t("taglet","application/vnd.mynfc"),t("nlu","application/vnd.neurolanguage.nlu"),t("ntf","application/vnd.nitf"),t("nitf","application/vnd.nitf"),t("nnd","application/vnd.noblenet-directory"),t("nns","application/vnd.noblenet-sealer"),t("nnw","application/vnd.noblenet-web"),t("ngdat","application/vnd.nokia.n-gage.data"),t("n-gage","application/vnd.nokia.n-gage.symbian.install"),t("rpst","application/vnd.nokia.radio-preset"),t("rpss","application/vnd.nokia.radio-presets"),t("edm","application/vnd.novadigm.edm"),t("edx","application/vnd.novadigm.edx"),t("FExt","application/vnd.novadigm.FExt"),t("odc","application/vnd.oasis.opendocument.chart"),t("otc","application/vnd.oasis.opendocument.chart-template"),t("odb","application/vnd.oasis.opendocument.database"),t("odf","application/vnd.oasis.opendocument.formula"),t("odft","application/vnd.oasis.opendocument.formula-template"),t("odg","application/vnd.oasis.opendocument.graphics"),t("otg","application/vnd.oasis.opendocument.graphics-template"),t("odi","application/vnd.oasis.opendocument.image"),t("oti","application/vnd.oasis.opendocument.image-template"),t("odp","application/vnd.oasis.opendocument.presentation"),t("otp","application/vnd.oasis.opendocument.presentation-template"),t("ods","application/vnd.oasis.opendocument.spreadsheet"),t("ots","application/vnd.oasis.opendocument.spreadsheet-template"),t("odt","application/vnd.oasis.opendocument.text"),t("odm","application/vnd.oasis.opendocument.text-master"),t("ott","application/vnd.oasis.opendocument.text-template"),t("oth","application/vnd.oasis.opendocument.text-web"),t("xo","application/vnd.olpc-sugar"),t("dd2","application/vnd.oma.dd2+xml"),t("oxt","application/vnd.openofficeorg.extension"),t("pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"),t("sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"),t("ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"),t("potx","application/vnd.openxmlformats-officedocument.presentationml.template"),t("xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),t("xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"),t("docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"),t("dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"),t("mgp","application/vnd.osgeo.mapguide.package"),t("dp","application/vnd.osgi.dp"),t("esa","application/vnd.osgi.subsystem"),t("pdb","application/vnd.palm"),t("pqa","application/vnd.palm"),t("oprc","application/vnd.palm"),t("paw","application/vnd.pawaafile"),t("str","application/vnd.pg.format"),t("ei6","application/vnd.pg.osasli"),t("efif","application/vnd.picsel"),t("wg","application/vnd.pmi.widget"),t("plf","application/vnd.pocketlearn"),t("pbd","application/vnd.powerbuilder6"),t("box","application/vnd.previewsystems.box"),t("mgz","application/vnd.proteus.magazine"),t("qps","application/vnd.publishare-delta-tree"),t("ptid","application/vnd.pvi.ptid1"),t("qxd","application/vnd.quark.quarkxpress"),t("qxt","application/vnd.quark.quarkxpress"),t("qwd","application/vnd.quark.quarkxpress"),t("qwt","application/vnd.quark.quarkxpress"),t("qxl","application/vnd.quark.quarkxpress"),t("qxb","application/vnd.quark.quarkxpress"),t("bed","application/vnd.realvnc.bed"),t("mxl","application/vnd.recordare.musicxml"),t("musicxml","application/vnd.recordare.musicxml+xml"),t("cryptonote","application/vnd.rig.cryptonote"),t("cod","application/vnd.rim.cod"),t("rm","application/vnd.rn-realmedia"),t("rmvb","application/vnd.rn-realmedia-vbr"),t("link66","application/vnd.route66.link66+xml"),t("st","application/vnd.sailingtracker.track"),t("see","application/vnd.seemail"),t("sema","application/vnd.sema"),t("semd","application/vnd.semd"),t("semf","application/vnd.semf"),t("ifm","application/vnd.shana.informed.formdata"),t("itp","application/vnd.shana.informed.formtemplate"),t("iif","application/vnd.shana.informed.interchange"),t("ipk","application/vnd.shana.informed.package"),t("twd","application/vnd.simtech-mindmapper"),t("twds","application/vnd.simtech-mindmapper"),t("mmf","application/vnd.smaf"),t("teacher","application/vnd.smart.teacher"),t("sdkm","application/vnd.solent.sdkm+xml"),t("sdkd","application/vnd.solent.sdkm+xml"),t("dxp","application/vnd.spotfire.dxp"),t("sfs","application/vnd.spotfire.sfs"),t("sdc","application/vnd.stardivision.calc"),t("sda","application/vnd.stardivision.draw"),t("sdd","application/vnd.stardivision.impress"),t("smf","application/vnd.stardivision.math"),t("sdw","application/vnd.stardivision.writer"),t("vor","application/vnd.stardivision.writer"),t("sgl","application/vnd.stardivision.writer-global"),t("smzip","application/vnd.stepmania.package"),t("sm","application/vnd.stepmania.stepchart"),t("sxc","application/vnd.sun.xml.calc"),t("stc","application/vnd.sun.xml.calc.template"),t("sxd","application/vnd.sun.xml.draw"),t("std","application/vnd.sun.xml.draw.template"),t("sxi","application/vnd.sun.xml.impress"),t("sti","application/vnd.sun.xml.impress.template"),t("sxm","application/vnd.sun.xml.math"),t("sxw","application/vnd.sun.xml.writer"),t("sxg","application/vnd.sun.xml.writer.global"),t("stw","application/vnd.sun.xml.writer.template"),t("sus","application/vnd.sus-calendar"),t("susp","application/vnd.sus-calendar"),t("svd","application/vnd.svd"),t("sis","application/vnd.symbian.install"),t("sisx","application/vnd.symbian.install"),t("xsm","application/vnd.syncml+xml"),t("bdm","application/vnd.syncml.dm+wbxml"),t("xdm","application/vnd.syncml.dm+xml"),t("tao","application/vnd.tao.intent-module-archive"),t("pcap","application/vnd.tcpdump.pcap"),t("cap","application/vnd.tcpdump.pcap"),t("dmp","application/vnd.tcpdump.pcap"),t("tmo","application/vnd.tmobile-livetv"),t("tpt","application/vnd.trid.tpt"),t("mxs","application/vnd.triscape.mxs"),t("tra","application/vnd.trueapp"),t("ufd","application/vnd.ufdl"),t("ufdl","application/vnd.ufdl"),t("utz","application/vnd.uiq.theme"),t("umj","application/vnd.umajin"),t("unityweb","application/vnd.unity"),t("uoml","application/vnd.uoml+xml"),t("vcx","application/vnd.vcx"),t("vsd","application/vnd.visio"),t("vst","application/vnd.visio"),t("vss","application/vnd.visio"),t("vsw","application/vnd.visio"),t("vis","application/vnd.visionary"),t("vsf","application/vnd.vsf"),t("wbxml","application/vnd.wap.wbxml"),t("wmlc","application/vnd.wap.wmlc"),t("wmlsc","application/vnd.wap.wmlscriptc"),t("wtb","application/vnd.webturbo"),t("nbp","application/vnd.wolfram.player"),t("wpd","application/vnd.wordperfect"),t("wqd","application/vnd.wqd"),t("stf","application/vnd.wt.stf"),t("xar","application/vnd.xara"),t("xfdl","application/vnd.xfdl"),t("hvd","application/vnd.yamaha.hv-dic"),t("hvs","application/vnd.yamaha.hv-script"),t("hvp","application/vnd.yamaha.hv-voice"),t("osf","application/vnd.yamaha.openscoreformat"),t("osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"),t("saf","application/vnd.yamaha.smaf-audio"),t("spf","application/vnd.yamaha.smaf-phrase"),t("cmp","application/vnd.yellowriver-custom-menu"),t("zir","application/vnd.zul"),t("zirz","application/vnd.zul"),t("zaz","application/vnd.zzazz.deck+xml"),t("vxml","application/voicexml+xml"),t("wgt","application/widget"),t("hlp","application/winhlp"),t("wsdl","application/wsdl+xml"),t("wspolicy","application/wspolicy+xml"),t("7z","application/x-7z-compressed"),t("abw","application/x-abiword"),t("ace","application/x-ace-compressed"),t("dmg","application/x-apple-diskimage"),t("aab","application/x-authorware-bin"),t("x32","application/x-authorware-bin"),t("u32","application/x-authorware-bin"),t("vox","application/x-authorware-bin"),t("aam","application/x-authorware-map"),t("aas","application/x-authorware-seg"),t("bcpio","application/x-bcpio"),t("torrent","application/x-bittorrent"),t("blb","application/x-blorb"),t("blorb","application/x-blorb"),t("bz","application/x-bzip"),t("bz2","application/x-bzip2"),t("boz","application/x-bzip2"),t("cbr","application/x-cbr"),t("cba","application/x-cbr"),t("cbt","application/x-cbr"),t("cbz","application/x-cbr"),t("cb7","application/x-cbr"),t("vcd","application/x-cdlink"),t("cfs","application/x-cfs-compressed"),t("chat","application/x-chat"),t("pgn","application/x-chess-pgn"),t("nsc","application/x-conference"),t("cpio","application/x-cpio"),t("csh","application/x-csh"),t("deb","application/x-debian-package"),t("udeb","application/x-debian-package"),t("dgc","application/x-dgc-compressed"),t("dir","application/x-director"),t("dcr","application/x-director"),t("dxr","application/x-director"),t("cst","application/x-director"),t("cct","application/x-director"),t("cxt","application/x-director"),t("w3d","application/x-director"),t("fgd","application/x-director"),t("swa","application/x-director"),t("wad","application/x-doom"),t("ncx","application/x-dtbncx+xml"),t("dtb","application/x-dtbook+xml"),t("res","application/x-dtbresource+xml"),t("dvi","application/x-dvi"),t("evy","application/x-envoy"),t("eva","application/x-eva"),t("bdf","application/x-font-bdf"),t("gsf","application/x-font-ghostscript"),t("psf","application/x-font-linux-psf"),t("otf","application/x-font-otf"),t("pcf","application/x-font-pcf"),t("snf","application/x-font-snf"),t("ttf","application/x-font-ttf"),t("ttc","application/x-font-ttf"),t("pfa","application/x-font-type1"),t("pfb","application/x-font-type1"),t("pfm","application/x-font-type1"),t("afm","application/x-font-type1"),t("woff","application/x-font-woff"),t("arc","application/x-freearc"),t("spl","application/x-futuresplash"),t("gca","application/x-gca-compressed"),t("ulx","application/x-glulx"),t("gnumeric","application/x-gnumeric"),t("gramps","application/x-gramps-xml"),t("gtar","application/x-gtar"),t("hdf","application/x-hdf"),t("install","application/x-install-instructions"),t("iso","application/x-iso9660-image"),t("jnlp","application/x-java-jnlp-file"),t("latex","application/x-latex"),t("lzh","application/x-lzh-compressed"),t("lha","application/x-lzh-compressed"),t("mie","application/x-mie"),t("prc","application/x-mobipocket-ebook"),t("mobi","application/x-mobipocket-ebook"),t("application","application/x-ms-application"),t("lnk","application/x-ms-shortcut"),t("wmd","application/x-ms-wmd"),t("wmz","application/x-ms-wmz"),t("xbap","application/x-ms-xbap"),t("mdb","application/x-msaccess"),t("obd","application/x-msbinder"),t("crd","application/x-mscardfile"),t("clp","application/x-msclip"),t("exe","application/x-msdownload"),t("dll","application/x-msdownload"),t("com","application/x-msdownload"),t("bat","application/x-msdownload"),t("msi","application/x-msdownload"),t("mvb","application/x-msmediaview"),t("m13","application/x-msmediaview"),t("m14","application/x-msmediaview"),t("wmf","application/x-msmetafile"),t("wmz","application/x-msmetafile"),t("emf","application/x-msmetafile"),t("emz","application/x-msmetafile"),t("mny","application/x-msmoney"),t("pub","application/x-mspublisher"),t("scd","application/x-msschedule"),t("trm","application/x-msterminal"),t("wri","application/x-mswrite"),t("nc","application/x-netcdf"),t("cdf","application/x-netcdf"),t("nzb","application/x-nzb"),t("p12","application/x-pkcs12"),t("pfx","application/x-pkcs12"),t("p7b","application/x-pkcs7-certificates"),t("spc","application/x-pkcs7-certificates"),t("p7r","application/x-pkcs7-certreqresp"),t("rar","application/x-rar-compressed"),t("ris","application/x-research-info-systems"),t("sh","application/x-sh"),t("shar","application/x-shar"),t("swf","application/x-shockwave-flash"),t("xap","application/x-silverlight-app"),t("sql","application/x-sql"),t("sit","application/x-stuffit"),t("sitx","application/x-stuffitx"),t("srt","application/x-subrip"),t("sv4cpio","application/x-sv4cpio"),t("sv4crc","application/x-sv4crc"),t("t3","application/x-t3vm-image"),t("gam","application/x-tads"),t("tar","application/x-tar"),t("tcl","application/x-tcl"),t("tex","application/x-tex"),t("tfm","application/x-tex-tfm"),t("texinfo","application/x-texinfo"),t("texi","application/x-texinfo"),t("obj","application/x-tgif"),t("ustar","application/x-ustar"),t("src","application/x-wais-source"),t("der","application/x-x509-ca-cert"),t("crt","application/x-x509-ca-cert"),t("fig","application/x-xfig"),t("xlf","application/x-xliff+xml"),t("xpi","application/x-xpinstall"),t("xz","application/x-xz"),t("z1","application/x-zmachine"),t("z2","application/x-zmachine"),t("z3","application/x-zmachine"),t("z4","application/x-zmachine"),t("z5","application/x-zmachine"),t("z6","application/x-zmachine"),t("z7","application/x-zmachine"),t("z8","application/x-zmachine"),t("xaml","application/xaml+xml"),t("xdf","application/xcap-diff+xml"),t("xenc","application/xenc+xml"),t("xhtml","application/xhtml+xml"),t("xht","application/xhtml+xml"),t("xml","application/xml"),t("xsl","application/xml"),t("dtd","application/xml-dtd"),t("xop","application/xop+xml"),t("xpl","application/xproc+xml"),t("xslt","application/xslt+xml"),t("xspf","application/xspf+xml"),t("mxml","application/xv+xml"),t("xhvml","application/xv+xml"),t("xvml","application/xv+xml"),t("xvm","application/xv+xml"),t("yang","application/yang"),t("yin","application/yin+xml"),t("zip","application/zip"),t("adp","audio/adpcm"),t("au","audio/basic"),t("snd","audio/basic"),t("mid","audio/midi"),t("midi","audio/midi"),t("kar","audio/midi"),t("rmi","audio/midi"),t("mp4a","audio/mp4"),t("mpga","audio/mpeg"),t("mp2","audio/mpeg"),t("mp2a","audio/mpeg"),t("mp3","audio/mpeg"),t("m2a","audio/mpeg"),t("m3a","audio/mpeg"),t("oga","audio/ogg"),t("ogg","audio/ogg"),t("spx","audio/ogg"),t("s3m","audio/s3m"),t("sil","audio/silk"),t("uva","audio/vnd.dece.audio"),t("uvva","audio/vnd.dece.audio"),t("eol","audio/vnd.digital-winds"),t("dra","audio/vnd.dra"),t("dts","audio/vnd.dts"),t("dtshd","audio/vnd.dts.hd"),t("lvp","audio/vnd.lucent.voice"),t("pya","audio/vnd.ms-playready.media.pya"),t("ecelp4800","audio/vnd.nuera.ecelp4800"),t("ecelp7470","audio/vnd.nuera.ecelp7470"),t("ecelp9600","audio/vnd.nuera.ecelp9600"),t("rip","audio/vnd.rip"),t("weba","audio/webm"),t("aac","audio/aac"),t("aif","audio/x-aiff"),t("aiff","audio/x-aiff"),t("aifc","audio/x-aiff"),t("caf","audio/x-caf"),t("flac","audio/x-flac"),t("mka","audio/x-matroska"),t("m3u","audio/x-mpegurl"),t("wax","audio/x-ms-wax"),t("wma","audio/x-ms-wma"),t("ram","audio/x-pn-realaudio"),t("ra","audio/x-pn-realaudio"),t("rmp","audio/x-pn-realaudio-plugin"),t("wav","audio/x-wav"),t("xm","audio/xm"),t("cdx","chemical/x-cdx"),t("cif","chemical/x-cif"),t("cmdf","chemical/x-cmdf"),t("cml","chemical/x-cml"),t("csml","chemical/x-csml"),t("xyz","chemical/x-xyz"),t("bmp","image/bmp"),t("cgm","image/cgm"),t("g3","image/g3fax"),t("gif","image/gif"),t("ief","image/ief"),t("jpeg","image/jpeg"),t("jpg","image/jpeg"),t("jpe","image/jpeg"),t("ktx","image/ktx"),t("png","image/png"),t("btif","image/prs.btif"),t("sgi","image/sgi"),t("svg","image/svg+xml");t("svgz","image/svg+xml"),t("tiff","image/tiff"),t("tif","image/tiff"),t("psd","image/vnd.adobe.photoshop"),t("uvi","image/vnd.dece.graphic"),t("uvvi","image/vnd.dece.graphic"),t("uvg","image/vnd.dece.graphic"),t("uvvg","image/vnd.dece.graphic"),t("sub","image/vnd.dvb.subtitle"),t("djvu","image/vnd.djvu"),t("djv","image/vnd.djvu"),t("dwg","image/vnd.dwg"),t("dxf","image/vnd.dxf"),t("fbs","image/vnd.fastbidsheet"),t("fpx","image/vnd.fpx"),t("fst","image/vnd.fst"),t("mmr","image/vnd.fujixerox.edmics-mmr"),t("rlc","image/vnd.fujixerox.edmics-rlc"),t("mdi","image/vnd.ms-modi"),t("wdp","image/vnd.ms-photo"),t("npx","image/vnd.net-fpx"),t("wbmp","image/vnd.wap.wbmp"),t("xif","image/vnd.xiff"),t("webp","image/webp"),t("3ds","image/x-3ds"),t("ras","image/x-cmu-raster"),t("cmx","image/x-cmx"),t("fh","image/x-freehand"),t("fhc","image/x-freehand"),t("fh4","image/x-freehand"),t("fh5","image/x-freehand"),t("fh7","image/x-freehand"),t("ico","image/x-icon"),t("sid","image/x-mrsid-image"),t("pcx","image/x-pcx"),t("pic","image/x-pict"),t("pct","image/x-pict"),t("pnm","image/x-portable-anymap"),t("pbm","image/x-portable-bitmap"),t("pgm","image/x-portable-graymap"),t("ppm","image/x-portable-pixmap"),t("rgb","image/x-rgb"),t("tga","image/x-tga"),t("xbm","image/x-xbitmap"),t("xpm","image/x-xpixmap"),t("xwd","image/x-xwindowdump"),t("eml","message/rfc822"),t("mime","message/rfc822"),t("igs","model/iges"),t("iges","model/iges"),t("msh","model/mesh"),t("mesh","model/mesh"),t("silo","model/mesh"),t("dae","model/vnd.collada+xml"),t("dwf","model/vnd.dwf"),t("gdl","model/vnd.gdl"),t("gtw","model/vnd.gtw"),t("mts","model/vnd.mts"),t("vtu","model/vnd.vtu"),t("wrl","model/vrml"),t("vrml","model/vrml"),t("x3db","model/x3d+binary"),t("x3dbz","model/x3d+binary"),t("x3dv","model/x3d+vrml"),t("x3dvz","model/x3d+vrml"),t("x3d","model/x3d+xml"),t("x3dz","model/x3d+xml"),t("appcache","text/cache-manifest"),t("ics","text/calendar"),t("ifb","text/calendar"),t("cmd","text/cmd"),t("css","text/css"),t("csv","text/csv"),t("html","text/html"),t("htm","text/html"),t("n3","text/n3"),t("txt","text/plain"),t("text","text/plain"),t("conf","text/plain"),t("def","text/plain"),t("list","text/plain"),t("log","text/plain"),t("in","text/plain"),t("js","text/plain"),t("dsc","text/prs.lines.tag"),t("rtx","text/richtext"),t("sgml","text/sgml"),t("sgm","text/sgml"),t("tsv","text/tab-separated-values"),t("t","text/troff"),t("tr","text/troff"),t("roff","text/troff"),t("man","text/troff"),t("me","text/troff"),t("ms","text/troff"),t("ttl","text/turtle"),t("uri","text/uri-list"),t("uris","text/uri-list"),t("urls","text/uri-list"),t("vcard","text/vcard"),t("curl","text/vnd.curl"),t("dcurl","text/vnd.curl.dcurl"),t("scurl","text/vnd.curl.scurl"),t("mcurl","text/vnd.curl.mcurl"),t("sub","text/vnd.dvb.subtitle"),t("fly","text/vnd.fly"),t("flx","text/vnd.fmi.flexstor"),t("gv","text/vnd.graphviz"),t("3dml","text/vnd.in3d.3dml"),t("spot","text/vnd.in3d.spot"),t("jad","text/vnd.sun.j2me.app-descriptor"),t("wml","text/vnd.wap.wml"),t("wmls","text/vnd.wap.wmlscript"),t("s","text/x-asm"),t("asm","text/x-asm"),t("c","text/x-c"),t("cc","text/x-c"),t("cxx","text/x-c"),t("cpp","text/x-c"),t("h","text/x-c"),t("hh","text/x-c"),t("dic","text/x-c"),t("f","text/x-fortran"),t("for","text/x-fortran"),t("f77","text/x-fortran"),t("f90","text/x-fortran"),t("java","text/x-java-source"),t("opml","text/x-opml"),t("p","text/x-pascal"),t("pas","text/x-pascal"),t("nfo","text/x-nfo"),t("etx","text/x-setext"),t("sfv","text/x-sfv"),t("uu","text/x-uuencode"),t("vcs","text/x-vcalendar"),t("vcf","text/x-vcard"),t("xml","text/xml"),t("xsl","text/xml"),t("dtd","text/xml-dtd"),t("3gp","video/3gpp"),t("3g2","video/3gpp2"),t("h261","video/h261"),t("h263","video/h263"),t("h264","video/h264"),t("jpgv","video/jpeg"),t("jpm","video/jpm"),t("jpgm","video/jpm"),t("mj2","video/mj2"),t("mjp2","video/mj2"),t("mp4","video/mp4"),t("mp4v","video/mp4"),t("mpg4","video/mp4"),t("mpeg","video/mpeg"),t("mpg","video/mpeg"),t("mpe","video/mpeg"),t("m1v","video/mpeg"),t("m2v","video/mpeg"),t("ogv","video/ogg"),t("qt","video/quicktime"),t("mov","video/quicktime"),t("uvh","video/vnd.dece.hd"),t("uvvh","video/vnd.dece.hd"),t("uvm","video/vnd.dece.mobile"),t("uvvm","video/vnd.dece.mobile"),t("uvp","video/vnd.dece.pd"),t("uvvp","video/vnd.dece.pd"),t("uvs","video/vnd.dece.sd"),t("uvvs","video/vnd.dece.sd"),t("uvv","video/vnd.dece.video"),t("uvvv","video/vnd.dece.video"),t("dvb","video/vnd.dvb.file"),t("fvt","video/vnd.fvt"),t("mxu","video/vnd.mpegurl"),t("m4u","video/vnd.mpegurl"),t("pyv","video/vnd.ms-playready.media.pyv"),t("uvu","video/vnd.uvvu.mp4"),t("uvvu","video/vnd.uvvu.mp4"),t("viv","video/vnd.vivo"),t("webm","video/webm"),t("f4v","video/x-f4v"),t("fli","video/x-fli"),t("flv","video/x-flv"),t("m4v","video/x-m4v"),t("mkv","video/x-matroska"),t("mk3d","video/x-matroska"),t("mks","video/x-matroska"),t("mng","video/x-mng"),t("asf","video/x-ms-asf"),t("asx","video/x-ms-asf"),t("vob","video/x-ms-vob"),t("wm","video/x-ms-wm"),t("wmv","video/x-ms-wmv"),t("wmx","video/x-ms-wmx"),t("wvx","video/x-ms-wvx"),t("avi","video/x-msvideo"),t("movie","video/x-sgi-movie"),t("smv","video/x-smv"),t("ice","x-conference/x-cooltalk")}},t.$init=function(){e.FMimeTypes=pas.Classes.TStringList.$create("Create$1"),e.RegisterMimeTypes()}}),["DateUtils"]),rtl.module("WEBLib.TMSFNCJSONReader",["System","Classes","SysUtils","WEBLib.TMSFNCTypes"],(function(){"use strict";var t=this,e=t.$impl;rtl.createClass(this,"TTMSFNCJSONStreamReader",pas.System.TObject,(function(){rtl.createClass(this,"EEndOfInputReached",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"End of JSON input reached."),this}}),"TTMSFNCJSONStreamReader.EEndOfInputReached"),this.$init=function(){pas.System.TObject.$init.call(this),this.FStream=null,this.FReadStream=null},this.$final=function(){this.FStream=void 0,this.FReadStream=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t){return this.FStream=t,this.FReadStream=pas.Classes.TStringStream.$create("Create$3",["",pas.Classes.TEncoding.GetANSI(),!0]),this.FReadStream.CopyFrom(this.FStream,this.FStream.GetSize()),this.FReadStream.SetPosition(0),this},this.Destroy=function(){rtl.free(this,"FReadStream"),pas.System.TObject.Destroy.call(this)},this.NextChar=function(){if(this.Eof())throw this.EEndOfInputReached.$create("Create$2");return this.ReadChar()},this.PeekChar=function(){var t,e;return e=this.FReadStream.GetPosition(),t=this.ReadChar(),this.FReadStream.SetPosition(e),t},this.ReadChar=function(){var t="",e="";return t="\0",1,this.FReadStream.GetPosition()<this.FReadStream.GetSize()&&""!==(e=this.FReadStream.ReadString(1))&&pas.System.Assigned(e)&&(t=e.charAt(0)),t},this.Backup=function(t){this.FReadStream.SetPosition(this.FReadStream.GetPosition()-1)},this.MoveNext=function(t){this.FReadStream.SetPosition(this.FReadStream.GetPosition()+t)},this.Eof=function(){return this.FReadStream.GetPosition()===this.FReadStream.GetSize()}})),this.TTMSFNCJSONToken={0:"jstoBeginObject",jstoBeginObject:0,1:"jstoEndObject",jstoEndObject:1,2:"jstoBeginArray",jstoBeginArray:2,3:"jstoEndArray",jstoEndArray:3,4:"jstoName",jstoName:4,5:"jstoBoolean",jstoBoolean:5,6:"jstoNull",jstoNull:6,7:"jstoText",jstoText:7,8:"jstoNumber",jstoNumber:8,9:"jstoEOF",jstoEOF:9},rtl.createClass(this,"TTMSFNCJSONReader",pas.System.TObject,(function(){this.TTMSFNCJSONState={0:"jstNone",jstNone:0,1:"jstBeginObject",jstBeginObject:1,2:"jstEndObject",jstEndObject:2,3:"jstBeginArray",jstBeginArray:3,4:"jstEndArray",jstEndArray:4,5:"jstTrue",jstTrue:5,6:"jstFalse",jstFalse:6,7:"jstNull",jstNull:7,8:"jstDoubleQuoted",jstDoubleQuoted:8,9:"jstBuffered",jstBuffered:9,10:"jstDoubleQuotedName",jstDoubleQuotedName:10,11:"jstInt64",jstInt64:11,12:"jstNumber",jstNumber:12,13:"jstEOF",jstEOF:13},this.TTMSFNCJSONNumberState={0:"jnstNone",jnstNone:0,1:"jnstSign",jnstSign:1,2:"jnstDigit",jnstDigit:2,3:"jnstDecimal",jnstDecimal:3,4:"jnstFraction",jnstFraction:4,5:"jnstExpE",jnstExpE:5,6:"jnstExpSign",jnstExpSign:6,7:"jnstExpDigit",jnstExpDigit:7},this.TTMSFNCJSONScope={0:"jscEmptyDocument",jscEmptyDocument:0,1:"jscEmptyArray",jscEmptyArray:1,2:"jscEmptyObject",jscEmptyObject:2,3:"jscNonEmptyDocument",jscNonEmptyDocument:3,4:"jscNonEmptyArray",jscNonEmptyArray:4,5:"jscNonEmptyObject",jscNonEmptyObject:5,6:"jscDanglingName",jscDanglingName:6},rtl.createClass(this,"EInvalidStateException",pas.SysUtils.Exception,(function(){this.Create$2=function(t){return pas.SysUtils.Exception.CreateFmt.call(this,"Invalid Json parser state. Expected state: %d",pas.System.VarRecs(0,t)),this}}),"TTMSFNCJSONReader.EInvalidStateException"),rtl.createClass(this,"EUnterminatedArray",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Unterminated array"),this}}),"TTMSFNCJSONReader.EUnterminatedArray"),rtl.createClass(this,"EUnterminatedObject",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Unterminated object"),this}}),"TTMSFNCJSONReader.EUnterminatedObject"),rtl.createClass(this,"ENameExpected",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Name expected"),this}}),"TTMSFNCJSONReader.ENameExpected"),rtl.createClass(this,"EColonExpected",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Colon expected"),this}}),"TTMSFNCJSONReader.EColonExpected"),rtl.createClass(this,"EMultipleRootNotAllowed",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Multiple root values not allowed"),this}}),"TTMSFNCJSONReader.EMultipleRootNotAllowed"),rtl.createClass(this,"EExpectedValue",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Value expected but invalid character found"),this}}),"TTMSFNCJSONReader.EExpectedValue"),rtl.createClass(this,"EObjectOrArrayExpected",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Object or array expected as top-level value"),this}}),"TTMSFNCJSONReader.EObjectOrArrayExpected"),rtl.createClass(this,"ETooManyDepthLevels",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Maximum level of nested structured reached."),this}}),"TTMSFNCJSONReader.ETooManyDepthLevels"),this.MaxNumberBuffer=255,this.MaxStackSize=255,this.$init=function(){pas.System.TObject.$init.call(this),this.FReader=null,this.FStack=rtl.arraySetLength(null,0,256),this.FStackSize=0,this.FPeeked=0,this.FPeekedInt64=0,this.FPeekedNumber=rtl.arraySetLength(null,"",256),this.FPeekedString=""},this.$final=function(){this.FReader=void 0,this.FStack=void 0,this.FPeekedNumber=void 0,pas.System.TObject.$final.call(this)},this.NextPeek=function(){return 0===this.FPeeked&&(this.FPeeked=this.DoPeek()),this.FPeeked},this.CheckState=function(t){if(this.NextPeek()!==t)throw this.EInvalidStateException.$create("Create$2",[t])},this.SkipChar=function(){for(this.FReader.MoveNext(1);this.FReader.PeekChar().charCodeAt()in e.Wspace;)this.FReader.MoveNext(1)},this.IsLiteral=function(t){return!pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.CharInSet(t,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.CreateCharSet("/\\;#{}[]:,' \r\n\f\t"))},this.IsDigit=function(t){return t<="ÿ"&&pas["WEBLib.TMSFNCTypes"].CharIsNumber(t)},this.DoPeek=function(){var t,i=0;if(1===(t=this.FStack[this.FStackSize-1]))this.FStack[this.FStackSize-1]=4;else if(4===t){var s=this.NextNonWhitespace();if("]"===s)return this.SkipChar(),this.FPeeked=4,this.FPeeked;if(","!==s)throw this.EUnterminatedArray.$create("Create$2");this.SkipChar()}else{if(t in rtl.createSet(2,5)){if(this.FStack[this.FStackSize-1]=6,5===t){var n=this.NextNonWhitespace();if("}"===n){for(;this.FReader.PeekChar().charCodeAt()in e.Wspace;)this.FReader.MoveNext(1);return this.SkipChar(),this.FPeeked=2,this.FPeeked}if(","!==n)throw this.EUnterminatedObject.$create("Create$2");this.SkipChar()}var o=this.NextNonWhitespace();if('"'===o)return this.SkipChar(),this.FPeeked=10,this.FPeeked;if("}"===o){if(5!==t)return this.SkipChar(),this.FPeeked=2,this.FPeeked;throw this.ENameExpected.$create("Create$2")}throw this.ENameExpected.$create("Create$2")}if(6===t){if(this.FStack[this.FStackSize-1]=5,":"!==this.NextNonWhitespace())throw this.EColonExpected.$create("Create$2");this.SkipChar()}else if(0===t)this.FStack[this.FStackSize-1]=3;else if(3===t){if(this.SkipWhitespaceUntilEnd())return this.FPeeked=13,this.FPeeked;throw this.EMultipleRootNotAllowed.$create("Create$2")}}var r=this.NextNonWhitespace();if("]"===r){if(1===t)return this.SkipChar(),this.FPeeked=4,this.FPeeked;throw this.EExpectedValue.$create("Create$2")}if('"'===r){if(1===this.FStackSize)throw this.EObjectOrArrayExpected.$create("Create$2");return this.SkipChar(),this.FPeeked=8,this.FPeeked}if("["===r)return this.SkipChar(),this.FPeeked=3,this.FPeeked;if("{"===r)return this.SkipChar(),this.FPeeked=1,this.FPeeked;if(1===this.FStackSize)throw this.EObjectOrArrayExpected.$create("Create$2");if(0!==(i=this.PeekKeyword()))return i;if(0!==(i=this.PeekNumber()))return i;throw this.EExpectedValue.$create("Create$2")},this.PushScope=function(t){if(this.FStackSize>255)throw this.ETooManyDepthLevels.$create("Create$2");this.FStack[this.FStackSize]=t,this.FStackSize+=1},this.NextNonWhitespace=function(){var t,i="";t=this.FReader.FReadStream.GetPosition(),i=this.ReadChar();do{if(i>" "||!(i.charCodeAt()in e.Wspace))return this.FReader.FReadStream.SetPosition(t),i;i=this.ReadChar()}while(!this.FReader.Eof());return this.FReader.FReadStream.SetPosition(t),"\0"},this.ReadChar=function(){return this.FReader.ReadChar()},this.PeekKeyword=function(){var t=this.FReader.PeekChar();if("t"===t||"T"===t){this.FReader.MoveNext(1);var e=this.FReader.NextChar();if("r"===e||"R"===e){var i=this.FReader.NextChar();if("u"===i||"U"===i){var s=this.FReader.NextChar();if(("e"===s||"E"===s)&&(this.FReader.Eof()||!this.IsLiteral(this.FReader.PeekChar())))return 5}}}else if("f"===t||"F"===t){this.FReader.MoveNext(1);var n=this.FReader.NextChar();if("a"===n||"A"===n){var o=this.FReader.NextChar();if("l"===o||"L"===o){var r=this.FReader.NextChar();if("s"===r||"S"===r){var a=this.FReader.NextChar();if(("e"===a||"E"===a)&&(this.FReader.Eof()||!this.IsLiteral(this.FReader.PeekChar())))return 6}}}}else{if("n"!==t&&"N"!==t)return 0;this.FReader.MoveNext(1);var l=this.FReader.NextChar();if("u"===l||"U"===l){var h=this.FReader.NextChar();if("l"===h||"L"===h){var F=this.FReader.NextChar();if(("l"===F||"L"===F)&&(this.FReader.Eof()||!this.IsLiteral(this.FReader.PeekChar())))return 7}}}throw this.EExpectedValue.$create("Create$2")};rtl.trunc(-900719925474099.1);this.PeekNumber=function(){var t=0,e=!1,i=!1,s=0,n=0,o="",r=0;if("-"!==(o=this.FReader.PeekChar())&&!this.IsDigit(o))return 0;for(e=!1,i=!0,t=0,r=0,s=-1;;){if(r>=255)throw this.EExpectedValue.$create("Create$2");o=this.FReader.NextChar(),this.FPeekedNumber[r]=o,r+=1;var a=o;if("-"===a){if(0===t){e=!0,t=1;continue}if(5===t){t=6;continue}throw this.EExpectedValue.$create("Create$2")}if("+"===a){if(5===t){t=6;continue}throw this.EExpectedValue.$create("Create$2")}if("e"===a||"E"===a){if(t in rtl.createSet(2,4)){t=5;continue}throw this.EExpectedValue.$create("Create$2")}if("."===a){if(2===t){t=3;continue}throw this.EExpectedValue.$create("Create$2")}if(!this.IsDigit(o)){if(this.IsLiteral(o))throw this.EExpectedValue.$create("Create$2");this.FReader.Backup(o),r-=1;break}if(t in rtl.createSet(1,0))s=-(o.charCodeAt()-48),t=2;else if(2===t){if(0===s)throw this.EExpectedValue.$create("Create$2");n=10*s-(o.charCodeAt()-48),i=i&&(s>-900719925474099||-900719925474099===s&&n<s),s=n}else 3===t?t=4:t in rtl.createSet(5,6)&&(t=7)}if(2===t&&i&&(-9007199254740991!==s||e))return this.FPeekedInt64=e?s:-s,11;if(t in rtl.createSet(2,4,7))return this.FPeekedNumber[r]="\0",12;throw this.EExpectedValue.$create("Create$2")},this.InternalReadQuoted=function(t){var e="",i="",s="",n="";for(e="",n="",i="";!this.FReader.Eof()&&('"'!==(s=this.ReadChar())||"\\"===i);)n+=s,i=s;return t&&(e=n),e},this.ReadQuoted=function(){return this.InternalReadQuoted(!0)},this.SkipQuoted=function(){this.InternalReadQuoted(!1)},this.SkipWhitespaceUntilEnd=function(){var t,i="";t=this.FReader.FReadStream.GetPosition(),i=this.ReadChar();do{if(i>" "||!(i.charCodeAt()in e.Wspace))return this.FReader.FReadStream.SetPosition(t),!1;i=this.ReadChar()}while(!this.FReader.Eof());return this.FReader.FReadStream.SetPosition(t),!0},this.Create$1=function(e){return pas.System.TObject.Create.call(this),this.FReader=t.TTMSFNCJSONStreamReader.$create("Create$1",[e]),this.FPeeked=0,this.FStack[0]=0,this.FStackSize=1,this},this.Destroy=function(){rtl.free(this,"FReader"),pas.System.TObject.Destroy.call(this)},this.ReadBeginArray=function(){this.CheckState(3),this.PushScope(1),this.FPeeked=0},this.ReadEndArray=function(){this.CheckState(4),this.FStackSize-=1,this.FPeeked=0},this.ReadBeginObject=function(){this.CheckState(1),this.PushScope(2),this.FPeeked=0},this.ReadEndObject=function(){this.CheckState(2),this.FStackSize-=1,this.FPeeked=0},this.PeekName=function(){var t,e;return e=this.FReader.FReadStream.GetPosition(),t=this.ReadQuoted(),this.FReader.FReadStream.SetPosition(e),t},this.ReadName=function(){return this.CheckState(10),this.FPeeked=0,this.ReadQuoted()},this.ReadString=function(){var t="",i=this.NextPeek();if(8===i)t=this.ReadQuoted();else if(11===i)t=pas.SysUtils.IntToStr(this.FPeekedInt64);else if(12===i)t=e.ArrayOfCharToString(this.FPeekedNumber.slice(0));else{if(9!==i)throw this.EInvalidStateException.$create("Create$2",[8]);t=this.FPeekedString}return this.FPeeked=0,t=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.UnescapeString(t)},this.ReadBoolean=function(){var t=!1,e=this.NextPeek();if(5===e)t=!0;else{if(6!==e)throw this.EInvalidStateException.$create("Create$2",[5]);t=!1}return this.FPeeked=0,t},this.ReadDouble=function(){var t=0,i=this.NextPeek();if(11===i)return this.FPeeked=0,this.FPeekedInt64;if(12===i){if(pas.SysUtils.TryStrToFloat$2(e.ArrayOfCharToString(this.FPeekedNumber.slice(0)),{get:function(){return t},set:function(e){t=e}}))return this.FPeeked=0,t;this.FPeekedString=e.ArrayOfCharToString(this.FPeekedNumber.slice(0))}else if(8===i)this.FPeekedString=this.ReadQuoted();else if(9!==i)throw this.EInvalidStateException.$create("Create$2",[12]);return this.FPeeked=9,t=pas.SysUtils.StrToFloat(this.FPeekedString),this.FPeekedString="",this.FPeeked=0,t},this.ReadInteger=function(){var t,i=0,s=this.NextPeek();if(11===s){if((i=4294967295&this.FPeekedInt64)!==this.FPeekedInt64)throw this.EInvalidStateException.$create("Create$2",[11]);return this.FPeeked=0,i}if(12===s){if(pas.SysUtils.TryStrToInt(e.ArrayOfCharToString(this.FPeekedNumber.slice(0)),{get:function(){return i},set:function(t){i=t}}))return this.FPeeked=0,i;this.FPeekedString=e.ArrayOfCharToString(this.FPeekedNumber.slice(0))}else if(8===s){if(this.FPeekedString=this.ReadQuoted(),pas.SysUtils.TryStrToInt(this.FPeekedString,{get:function(){return i},set:function(t){i=t}}))return this.FPeeked=0,i}else if(9!==s)throw this.EInvalidStateException.$create("Create$2",[11]);if(this.FPeeked=9,(t=pas.SysUtils.StrToFloat(this.FPeekedString))!==(i=Math.round(t)))throw this.EInvalidStateException.$create("Create$2",[11]);return this.FPeekedString="",this.FPeeked=0,i},this.SkipValue=function(){var t=0;t=0;do{var e=this.NextPeek();3===e?(this.PushScope(1),t+=1):1===e?(this.PushScope(2),t+=1):4===e||2===e?(this.FStackSize-=1,t-=1):8!==e&&10!==e||this.SkipQuoted(),this.FPeeked=0}while(!(t<=0))},this.ReadNull=function(){this.CheckState(7),this.FPeeked=0},this.HasNext=function(){return!(this.NextPeek()in rtl.createSet(2,4))},this.Peek=function(){var t=this.NextPeek();return 1===t?0:2===t?1:3===t?2:4===t?3:10===t?4:5===t||6===t?5:7===t?6:8===t||9===t?7:11===t||12===t?8:9},this.IsNull=function(){return 6===this.Peek()}})),t.$implcode=function(){e.Wspace=rtl.createSet(32,10,13,9,12),e.ArrayOfCharToString=function(t){var e="",i=0;e="";for(var s=0,n=rtl.length(t)-1;s<=n&&"\0"!==t[i=s];s++)e+=t[i];return e}}}),["WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCJSONWriter",["System","Classes","SysUtils","WEBLib.TMSFNCTypes"],(function(){"use strict";var t=this;rtl.createClass(this,"TTMSFNCJSONStreamWriter",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FStream=null,this.FWriteStream=null},this.$final=function(){this.FStream=void 0,this.FWriteStream=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t){return this.FStream=t,this.FWriteStream=pas.Classes.TStringStream.$create("Create$3",["",pas.Classes.TEncoding.GetANSI(),!0]),this},this.Destroy=function(){try{this.FWriteStream.SetPosition(0),this.FStream.CopyFrom(this.FWriteStream,this.FWriteStream.GetSize())}finally{rtl.free(this,"FWriteStream")}pas.System.TObject.Destroy.call(this)},this.Write=function(t){this.FWriteStream.WriteString(t)}})),rtl.createClass(this,"TTMSFNCJSONWriter",pas.System.TObject,(function(){rtl.createClass(this,"ECannotWriteName",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Cannot write name in current Json scope"),this}}),"TTMSFNCJSONWriter.ECannotWriteName"),rtl.createClass(this,"EMultipleRootNotAllowed",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Multiple root values not allowed"),this}}),"TTMSFNCJSONWriter.EMultipleRootNotAllowed"),rtl.createClass(this,"EObjectOrArrayExpected",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Object or array expected as top-level value"),this}}),"TTMSFNCJSONWriter.EObjectOrArrayExpected"),rtl.createClass(this,"EInvalidNesting",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Invalid nesting. Not all arrays/objects were properly closed."),this}}),"TTMSFNCJSONWriter.EInvalidNesting"),rtl.createClass(this,"EMissingValue",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Json value missing"),this}}),"TTMSFNCJSONWriter.EMissingValue"),rtl.createClass(this,"ETooManyDepthLevels",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Maximum level of nested structured reached."),this}}),"TTMSFNCJSONWriter.ETooManyDepthLevels"),rtl.createClass(this,"EEmptyJson",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Json is still empty. Cannot perform operation."),this}}),"TTMSFNCJSONWriter.EEmptyJson"),rtl.createClass(this,"EEmptyName",pas.SysUtils.Exception,(function(){this.Create$2=function(){return pas.SysUtils.Exception.Create$1.call(this,"Cannot write empty name"),this}}),"TTMSFNCJSONWriter.EEmptyName"),this.TTMSFNCJSONScope={0:"jscEmptyDocument",jscEmptyDocument:0,1:"jscEmptyArray",jscEmptyArray:1,2:"jscEmptyObject",jscEmptyObject:2,3:"jscNonEmptyDocument",jscNonEmptyDocument:3,4:"jscNonEmptyArray",jscNonEmptyArray:4,5:"jscNonEmptyObject",jscNonEmptyObject:5,6:"jscDanglingName",jscDanglingName:6},this.MaxStackSize=255,this.$init=function(){pas.System.TObject.$init.call(this),this.FWriter=null,this.FStack=rtl.arraySetLength(null,0,256),this.FStackSize=0,this.FIndent="",this.FSeparator="",this.FDeferredName=""},this.$final=function(){this.FWriter=void 0,this.FStack=void 0,pas.System.TObject.$final.call(this)},this.OpenItem=function(t,e){return this.BeforeValue(!0),this.PushScope(t),this.FWriter.Write(e),this,this},this.CloseItem=function(t,e,i){var s;if(!((s=this.PeekScope())in rtl.createSet(t,e)))throw this.EInvalidNesting.$create("Create$2");if(""!==this.FDeferredName)throw this.EMissingValue.$create("Create$2");return this.FStackSize-=1,s===e&&this.NewLine(),this.FWriter.Write(i),this,this},this.PushScope=function(t){if(this.FStackSize>255)throw this.ETooManyDepthLevels.$create("Create$2");this.FStack[this.FStackSize]=t,this.FStackSize+=1},this.PeekScope=function(){if(0===this.FStackSize)throw this.EEmptyJson.$create("Create$2");return this.FStack[this.FStackSize-1]},this.ReplaceTop=function(t){if(0===this.FStackSize)throw this.EEmptyJson.$create("Create$2");this.FStack[this.FStackSize-1]=t},this.WriteDeferredName=function(){""!==this.FDeferredName&&(this.BeforeName(),this.InternalWriteString(this.FDeferredName),this.FDeferredName="")},this.InternalWriteString=function(t){this.FWriter.Write('"'),this.FWriter.Write(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.EscapeString(t)),this.FWriter.Write('"')},this.NewLine=function(){if(""!==this.FIndent){this.FWriter.Write("\r\n");for(var t=1,e=this.FStackSize-1;t<=e;t++)t,this.FWriter.Write(this.FIndent)}},this.BeforeName=function(){var t=this.PeekScope();if(5===t)this.FWriter.Write(",");else if(2!==t)throw this.ECannotWriteName.$create("Create$2");this.NewLine(),this.ReplaceTop(6)},this.BeforeValue=function(t){var e=this.PeekScope();if(3===e)throw this.EMultipleRootNotAllowed.$create("Create$2");if(0===e){if(!t)throw this.EObjectOrArrayExpected.$create("Create$2");this.ReplaceTop(3)}else if(1===e)this.ReplaceTop(4),this.NewLine();else if(4===e)this.FWriter.Write(","),this.NewLine();else{if(6!==e)throw this.EInvalidNesting.$create("Create$2");this.FWriter.Write(this.FSeparator),this.ReplaceTop(5)}},this.Create$1=function(e){return pas.System.TObject.Create.call(this),this.FWriter=t.TTMSFNCJSONStreamWriter.$create("Create$1",[e]),this.FSeparator=":",this.PushScope(0),this},this.Destroy=function(){rtl.free(this,"FWriter"),pas.System.TObject.Destroy.call(this)},this.WriteBeginArray=function(){return this.WriteDeferredName(),this.OpenItem(1,"[")},this.WriteEndArray=function(){return this.CloseItem(1,4,"]")},this.WriteBeginObject=function(){return this.WriteDeferredName(),this.OpenItem(2,"{")},this.WriteEndObject=function(){return this.CloseItem(2,5,"}")},this.WriteName=function(t){if(""===t)throw this.EEmptyName.$create("Create$2");if(""!==this.FDeferredName)throw this.EMissingValue.$create("Create$2");if(0===this.FStackSize)throw this.EEmptyJson.$create("Create$2");return this.FDeferredName=t,this,this},this.WriteString=function(t){return this.WriteDeferredName(),this.BeforeValue(!1),this.InternalWriteString(t),this,this},this.WriteBoolean=function(t){return this.WriteDeferredName(),this.BeforeValue(!1),t?this.FWriter.Write("true"):this.FWriter.Write("false"),this,this},this.WriteNull=function(){return this.WriteDeferredName(),this.BeforeValue(!1),this.FWriter.Write("null"),this,this},this.WriteDouble=function(t){return this.WriteDeferredName(),this.BeforeValue(!1),this.FWriter.Write(pas.SysUtils.FloatToStr(t)),this,this},this.WriteInteger=function(t){return this.WriteDeferredName(),this.BeforeValue(!1),this.FWriter.Write(pas.SysUtils.IntToStr(t)),this,this}}))}),["WEBLib.TMSFNCUtils"]),rtl.module("StrUtils",["System","SysUtils","Types"],(function(){"use strict";var t=this,e=t.$impl;this.AnsiStartsStr=function(t,e){return e.length>=t.length&&""!==t&&t===pas.System.Copy(e,1,t.length)},this.Soundex=function(t,i){var s="",n="",o="",r=0,a=0;if(s="",o="\0",t.length>0)for(s=pas.System.upcase(t.charAt(0)),r=2,a=t.length;r<=a&&s.length<i;)(n=e.SScore.charAt(t.charCodeAt(r-1)-1)).charCodeAt()in rtl.createSet(48,105,o.charCodeAt())||(s+=n),"i"!==n&&(o=n),r+=1;return(a=s.length)<i&&(s+=pas.System.StringOfChar("0",i-a)),s},this.SoundexSimilar=function(e,i,s){return t.Soundex(e,s)===t.Soundex(i,s)},this.SoundexSimilar$1=function(e,i){return t.SoundexSimilar(e,i,4)},this.SoundexProc=function(e,i){return t.SoundexSimilar$1(e,i)},this.AnsiResemblesProc=null,this.ResemblesProc=null,t.$implcode=function(){e.SScore="00000000000000000000000000000000000000000000000000000000000000000123012i02245501262301i2i20000000123012i02245501262301i2i20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"},t.$init=function(){t.AnsiResemblesProc=t.SoundexProc,t.ResemblesProc=t.SoundexProc}}),["JS"]),rtl.module("WEBLib.TMSFNCPersistence",["System","Generics.Collections","Classes","TypInfo","SysUtils","WEBLib.TMSFNCTypes","WEBLib.TMSFNCJSONReader","WEBLib.TMSFNCJSONWriter"],(function(){"use strict";var t=this,e=t.$impl;rtl.createInterface(this,"ITMSFNCPersistence","{363F04AF-B8A7-4C47-A2D6-8ED9C44CEFF6}",["CanSaveProperty","CanLoadProperty"],pas.System.IUnknown),rtl.createInterface(this,"ITMSFNCBaseListIO","{FAB1D21E-D798-4CE0-B17B-9D75E4456AB4}",["GetItemClass"],pas.System.IUnknown),rtl.createInterface(this,"ITMSFNCBasePersistenceIO","{91DEAFC3-8932-45F4-A3ED-5AAA0C0E9250}",["CreateObject"],pas.System.IUnknown),rtl.createInterface(this,"ITMSFNCBaseCollectionIO","{90FDF257-7362-411D-B7F6-E2BEE2265016}",["AddItem"],pas.System.IUnknown),rtl.createInterface(this,"ITMSFNCPersistenceIO","{11B625F8-447A-4AE5-BB88-5ECDEA979AF7}",["NeedsObjectReference","GetObjectReference","FixOwners"],this.ITMSFNCBasePersistenceIO),rtl.createClass(this,"ETMSFNCReaderException",pas.SysUtils.Exception,(function(){})),rtl.createClass(this,"TTMSFNCObjectDictionary",pas["Generics.Collections"].TDictionary$G3,(function(){})),rtl.createClass(this,"TTMSFNCObjectList",pas["Generics.Collections"].TObjectList$G1,(function(){})),rtl.createClass(this,"TTMSFNCStringList",pas["Generics.Collections"].TList$G4,(function(){})),rtl.createClass(this,"TTMSFNCIntegerList",pas["Generics.Collections"].TList$G5,(function(){})),rtl.createClass(this,"TTMSFNCDoubleList",pas["Generics.Collections"].TList$G6,(function(){})),rtl.createClass(this,"TTMSFNCWriter",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FWriter=null,this.FIOReference=null,this.FOnCustomWriteProperty=null,this.FRootObject=null,this.FOnCustomIsAssignableProperty=null},this.$final=function(){this.FWriter=void 0,this.FIOReference=void 0,this.FOnCustomWriteProperty=void 0,this.FRootObject=void 0,this.FOnCustomIsAssignableProperty=void 0,pas.System.TObject.$final.call(this)},this.SetRootObject=function(e){this.FRootObject=e,t.TTMSFNCPersistence.FRootObject=this.FRootObject},this.SetIOReference=function(e){this.FIOReference=e,t.TTMSFNCPersistence.FIOReference=this.FIOReference},this.WritePropInfoValue=function(i,s){var n,o,r,a,l="",h=pas.System.TMethod.$new(),F=0;if(t.TTMSFNCPersistence.IsWriteOnly(s))this.FWriter.WriteNull();else{a=i,r=s,o=t.TTMSFNCPersistence.GetPropInfoType(r),n=t.TTMSFNCPersistence.GetPropInfoName(r);var p=o;1===p?"TAlphaColor"===(l=t.TTMSFNCPersistence.GetPropInfoTypeName(r))||"TColor"===l||"TGraphicsColor"===l?-1===pas.TypInfo.GetOrdProp$1(a,r)?this.FWriter.WriteString("gcNull"):(F=pas.TypInfo.GetOrdProp$1(a,r),this.FWriter.WriteString(e.ColorToHTMLEx(F))):this.FWriter.WriteInteger(pas.TypInfo.GetOrdProp$1(a,r)):2===p||3===p?this.FWriter.WriteString(pas.TypInfo.GetStrProp$1(a,r)):4===p?t.TTMSFNCPersistence.GetPropInfoDataTypeInfo(r)===rtl.boolean?this.FWriter.WriteBoolean(0!=pas.TypInfo.GetOrdProp$1(a,r)):this.FWriter.WriteInteger(pas.TypInfo.GetOrdProp$1(a,r)):7===p?this.FWriter.WriteBoolean(0!=pas.TypInfo.GetOrdProp$1(a,r)):p===pas.System.TTypeKind.tkDouble?this.FWriter.WriteDouble(pas.TypInfo.GetFloatProp$1(a,r)):5===p?this.FWriter.WriteInteger(pas.TypInfo.GetOrdProp$1(a,r)):9===p?(h.$assign(pas.TypInfo.GetMethodProp(a,r)),null===h.Code?this.FWriter.WriteNull():null!=t.TTMSFNCPersistence.FRootObject?this.FWriter.WriteString(t.TTMSFNCPersistence.FRootObject.$class.MethodName(h.Code)):this.FWriter.WriteNull()):(t.TTMSFNCPersistence.GetEnumName(pas.System.$rtti.TTypeKind,o),this.FWriter.WriteNull()),pas["WEBLib.Graphics"].TFont.isPrototypeOf(a)&&"Size"===n&&(this.FWriter.WriteName("IsFMX"),this.FWriter.WriteBoolean(!1))}},this.WriteProperties=function(t){var e=null,i=[],s=0;if(null!=t){e=t.$rtti;try{i=pas.TypInfo.GetPropList(e,pas.System.tkAny,!0);for(var n=0,o=rtl.length(i)-1;n<=o;n++)s=n,this.WriteProperty(t,i[s])}finally{}}},this.WriteProperty=function(e,i){var s="",n=0,o=!1,r=!1,a=!1,l=null,h=null;try{if(null==i)return;s=t.TTMSFNCPersistence.GetPropInfoName(i),n=t.TTMSFNCPersistence.GetPropInfoType(i),o=-1===pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IndexOfTextInArray(s,t.TTMSFNCPersistence.FExcludeProperties),pas.SysUtils.Supports$3(e,t.ITMSFNCPersistence.$guid,{get:function(){return l},set:function(t){l=t}})&&(o=l.CanSaveProperty(e,s,n)),o&&(r=!0,null!=this.FOnCustomWriteProperty&&this.FOnCustomWriteProperty(e,s,n,this.FWriter,{get:function(){return r},set:function(t){r=t}}),r&&(this.FWriter.WriteName(s),n in rtl.createSet(13)?(h=pas.TypInfo.GetObjectProp(e,s),a=t.TTMSFNCPersistence.IsAssignableProperty(e,i),null!=this.FOnCustomIsAssignableProperty&&this.FOnCustomIsAssignableProperty(e,s,{get:function(){return a},set:function(t){a=t}}),a?pas.Classes.TComponent.isPrototypeOf(h)?this.FWriter.WriteString(rtl.as(h,pas.Classes.TComponent).FName):this.FWriter.WriteString(""):this.WriteObject(h)):this.WritePropInfoValue(e,i)))}finally{rtl._Release(l)}},this.WriteGenericObjectList=function(t){var e=0;this.FWriter.WriteBeginArray();for(var i=0,s=t.FLength-1;i<=s;i++)e=i,this.WriteSingleObject(t.GetItem(e));this.FWriter.WriteEndArray()},this.WriteGenericStringList=function(t){var e=0;this.FWriter.WriteBeginArray();for(var i=0,s=t.FLength-1;i<=s;i++)e=i,this.FWriter.WriteString(t.GetItem(e));this.FWriter.WriteEndArray()},this.WriteGenericIntegerList=function(t){var e=0;this.FWriter.WriteBeginArray();for(var i=0,s=t.FLength-1;i<=s;i++)e=i,this.FWriter.WriteInteger(t.GetItem(e));this.FWriter.WriteEndArray()},this.WriteGenericDoubleList=function(t){var e=0;this.FWriter.WriteBeginArray();for(var i=0,s=t.FLength-1;i<=s;i++)e=i,this.FWriter.WriteDouble(t.GetItem(e));this.FWriter.WriteEndArray()},this.WriteStrings=function(t){var e=0;this.FWriter.WriteBeginArray();for(var i=0,s=t.GetCount()-1;i<=s;i++)e=i,this.FWriter.WriteString(t.Get(e));this.FWriter.WriteEndArray()},this.WriteGenericDictionary=function(t){var e="";this.FWriter.WriteBeginArray();var i=t.GetKeys().GetEnumerator$1();try{for(;i.MoveNext$1();)e=i.GetCurrent(),this.FWriter.WriteBeginObject(),this.FWriter.WriteName(e),this.WriteSingleObject(t.GetItem(e)),this.FWriter.WriteEndObject()}finally{i=rtl.freeLoc(i)}this.FWriter.WriteEndArray()},this.WriteCollection=function(t){var e=0;this.FWriter.WriteBeginArray();for(var i=0,s=t.GetCount()-1;i<=s;i++)e=i,this.WriteSingleObject(t.GetItem(e));this.FWriter.WriteEndArray()},this.WriteList=function(t){var e=0;this.FWriter.WriteBeginArray();for(var i=0,s=t.GetCount()-1;i<=s;i++)e=i,this.WriteSingleObject(rtl.getObject(t.Get(e)));this.FWriter.WriteEndArray()},this.WriteBitmap=function(t){pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(t)?this.FWriter.WriteString(""):this.FWriter.WriteString(t.GetData())},this.WriteSingleObject=function(e){this.FWriter.WriteBeginObject(),""!==t.TTMSFNCPersistence.ClassTypeVariable&&(this.FWriter.WriteName(t.TTMSFNCPersistence.ClassTypeVariable),this.FWriter.WriteString(e.$classname)),this.WriteProperties(e),this.FWriter.WriteEndObject()},this.WriteObject=function(e){var i=null;try{null===e?this.FWriter.WriteNull():t.TTMSFNCPersistence.IsGenericList(e.$class.ClassType(),"String")?this.WriteGenericStringList(e):t.TTMSFNCPersistence.IsGenericList(e.$class.ClassType(),"Integer")?this.WriteGenericIntegerList(e):t.TTMSFNCPersistence.IsGenericList(e.$class.ClassType(),"Double")?this.WriteGenericDoubleList(e):t.TTMSFNCPersistence.IsGenericList(e.$class.ClassType(),"")?this.WriteGenericObjectList(e):t.TTMSFNCPersistence.IsGenericDictionary(e.$class.ClassType())?this.WriteGenericDictionary(e):t.TTMSFNCPersistence.IsList(e.$class.ClassType())?this.WriteList(e):t.TTMSFNCPersistence.IsCollection(e.$class.ClassType())?this.WriteCollection(e):t.TTMSFNCPersistence.IsBitmap(e.$class.ClassType())?this.WriteBitmap(e):t.TTMSFNCPersistence.IsDescendingClass(e.$class.ClassType(),["TStrings"])?this.WriteStrings(e):null!=this.FIOReference&&pas.SysUtils.Supports$3(this.FIOReference,t.ITMSFNCPersistenceIO.$guid,{get:function(){return i},set:function(t){i=t}})&&i.NeedsObjectReference(e.$class.ClassType())?this.FWriter.WriteString(i.GetObjectReference(e)):this.WriteSingleObject(e)}finally{rtl._Release(i)}},this.Create$1=function(t){return this.FWriter=pas["WEBLib.TMSFNCJSONWriter"].TTMSFNCJSONWriter.$create("Create$1",[t]),this},this.Destroy=function(){rtl.free(this,"FWriter"),pas.System.TObject.Destroy.call(this)},this.Write=function(t){this.WriteObject(t)}})),rtl.createClass(this,"TTMSFNCObjectReference",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.Instance=null,this.Prop=null,this.Id=""},this.$final=function(){this.Instance=void 0,this.Prop=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t,e,i){return this.Instance=t,this.Prop=e,this.Id=i,this}})),rtl.createClass(this,"TTMSFNCReader",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FReferences=null,this.FReader=null,this.FIOReference=null,this.FOnCustomReadProperty=null,this.FRootObject=null,this.FOnCustomIsAssignableProperty=null},this.$final=function(){this.FReferences=void 0,this.FReader=void 0,this.FIOReference=void 0,this.FOnCustomReadProperty=void 0,this.FRootObject=void 0,this.FOnCustomIsAssignableProperty=void 0,pas.System.TObject.$final.call(this)},this.ReadSingleObject=function(e){var i=null,s="",n=null,o=null;try{if(this.FReader.ReadBeginObject(),""!==t.TTMSFNCPersistence.ClassTypeVariable){if(!this.FReader.HasNext()||this.FReader.ReadName()!==t.TTMSFNCPersistence.ClassTypeVariable)throw t.ETMSFNCReaderException.$create("Create$1",['"'+t.TTMSFNCPersistence.ClassTypeVariable+'" property not found in Object descriptor.']);s=this.FReader.ReadString()}""===s&&(s=e.$classname),null!=this.FIOReference?(i=null,pas.SysUtils.Supports$3(this.FIOReference,t.ITMSFNCBasePersistenceIO.$guid,{get:function(){return n},set:function(t){n=t}})?i=n.CreateObject(s,e):pas.SysUtils.Supports$3(this.FIOReference,t.ITMSFNCPersistenceIO.$guid,{get:function(){return o},set:function(t){o=t}})&&(i=o.CreateObject(s,e))):i=t.TTMSFNCPersistence.CreateObject(s,e);try{this.ReadProperties(i),this.FReader.ReadEndObject()}catch(t){throw i=rtl.freeLoc(i),t}}finally{rtl._Release(n),rtl._Release(o)}return i},this.SetRootObject=function(e){this.FRootObject=e,t.TTMSFNCPersistence.FRootObject=this.FRootObject},this.SetIOReference=function(e){this.FIOReference=e,t.TTMSFNCPersistence.FIOReference=this.FIOReference},this.ReadSingleObject$1=function(e){if(this.FReader.ReadBeginObject(),""!==t.TTMSFNCPersistence.ClassTypeVariable){if(!this.FReader.HasNext()||this.FReader.ReadName()!==t.TTMSFNCPersistence.ClassTypeVariable)throw t.ETMSFNCReaderException.$create("Create$1",['"'+t.TTMSFNCPersistence.ClassTypeVariable+'" property not found in Object descriptor.']);this.FReader.ReadString()}try{this.ReadProperties(e),this.FReader.ReadEndObject()}catch(t){throw t}},this.ReadProperties=function(t){for(var e=null;this.FReader.HasNext();)this.FReader.IsNull()?this.FReader.SkipValue():(e=null,null!=t&&(e=pas.TypInfo.GetPropInfo$2(t,this.FReader.ReadName())),null!=e?this.ReadProperty(t,e):this.FReader.SkipValue())},this.ReadProperty=function(e,i){var s="",n=null,o=!1,r=null,a=null,l=0,h=!1,F=!1,p=null,c="";try{if(null==i)return;l=t.TTMSFNCPersistence.GetPropInfoType(i),s=t.TTMSFNCPersistence.GetPropInfoName(i),o=-1===pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IndexOfTextInArray(s,t.TTMSFNCPersistence.FExcludeProperties),pas.SysUtils.Supports$3(e,t.ITMSFNCPersistence.$guid,{get:function(){return r},set:function(t){r=t}})&&(o=r.CanLoadProperty(e,s,l)),o?(h=!0,null!=this.FOnCustomReadProperty&&this.FOnCustomReadProperty(e,s,l,this.FReader,{get:function(){return h},set:function(t){h=t}}),h&&(l in rtl.createSet(13)?(n=t.TTMSFNCPersistence.GetPropInfoDataTypeInfoClassType(i),t.TTMSFNCPersistence.IsGenericList(n,"String")?this.ReadGenericStringList(pas.TypInfo.GetObjectProp(e,s)):t.TTMSFNCPersistence.IsGenericList(n,"")?this.ReadGenericObjectList(pas.TypInfo.GetObjectProp(e,s)):t.TTMSFNCPersistence.IsGenericDictionary(n)?this.ReadGenericDictionary(pas.TypInfo.GetObjectProp(e,s)):t.TTMSFNCPersistence.IsList(n)?this.ReadList(pas.TypInfo.GetObjectProp(e,s)):t.TTMSFNCPersistence.IsCollection(n)?this.ReadCollection(pas.TypInfo.GetObjectProp(e,s)):t.TTMSFNCPersistence.IsBitmap(n)?this.ReadBitmap(pas.TypInfo.GetObjectProp(e,s)):t.TTMSFNCPersistence.IsDescendingClass(n,["TStrings"])?this.ReadStrings(pas.TypInfo.GetObjectProp(e,s)):(h=!1,null!=this.FIOReference&&pas.SysUtils.Supports$3(this.FIOReference,t.ITMSFNCPersistenceIO.$guid,{get:function(){return a},set:function(t){a=t}})&&(h=a.NeedsObjectReference(n)),h?this.FReader.IsNull()?(this.FReader.ReadNull(),pas.TypInfo.SetObjectProp(e,s,null)):this.FReferences.Add(t.TTMSFNCObjectReference.$create("Create$1",[e,i,this.FReader.ReadString()])):(p=pas.TypInfo.GetObjectProp(e,s),F=t.TTMSFNCPersistence.IsAssignableProperty(e,i),null!=this.FOnCustomIsAssignableProperty&&this.FOnCustomIsAssignableProperty(e,s,{get:function(){return F},set:function(t){F=t}}),F?(c=this.FReader.ReadString(),null!=this.FRootObject&&pas.Classes.TComponent.isPrototypeOf(this.FRootObject)&&pas.TypInfo.SetObjectProp(e,s,rtl.as(this.FRootObject,pas.Classes.TComponent).FindComponent(c))):this.ReadExistingObject(p)))):this.ReadPropInfoValue(e,i))):this.FReader.SkipValue()}finally{rtl._Release(r),rtl._Release(a)}},this.ReadPropInfoValue=function(i,s){var n,o,r,a,l="",h="",F=0,p="",c=!1,u=0,T="",C=pas.System.TMethod.$new();if(t.TTMSFNCPersistence.IsWriteOnly(s)||this.FReader.IsNull())this.FReader.ReadNull();else{a=i,r=s,n=t.TTMSFNCPersistence.GetPropInfoName(r);var S=o=rtl.rc(t.TTMSFNCPersistence.GetPropInfoType(r),0,20);1===S?"TAlphaColor"===(l=t.TTMSFNCPersistence.GetPropInfoTypeName(r))||"TColor"===l||"TGraphicsColor"===l?(h=this.FReader.ReadString(),t.TTMSFNCPersistence.IsReadOnly(r)||("gcNull"===h?pas.TypInfo.SetOrdProp(a,n,-1):pas.TypInfo.SetOrdProp(a,n,e.HTMLToColorEx(h)))):(F=rtl.rc(this.FReader.ReadInteger(),-2147483648,2147483647),t.TTMSFNCPersistence.IsReadOnly(r)||pas.TypInfo.SetOrdProp$1(a,r,F)):2===S||3===S?(p=this.FReader.ReadString(),t.TTMSFNCPersistence.IsReadOnly(r)||pas.TypInfo.SetStrProp$1(a,r,p)):4===S?t.TTMSFNCPersistence.GetPropInfoDataTypeInfo(r)===rtl.boolean?(c=this.FReader.ReadBoolean(),t.TTMSFNCPersistence.IsReadOnly(r)||pas.TypInfo.SetOrdProp$1(a,r,c?1:0)):(F=rtl.rc(this.FReader.ReadInteger(),-2147483648,2147483647),t.TTMSFNCPersistence.IsReadOnly(r)||pas.TypInfo.SetOrdProp$1(a,r,F)):7===S?(c=this.FReader.ReadBoolean(),t.TTMSFNCPersistence.IsReadOnly(r)||pas.TypInfo.SetOrdProp$1(a,r,c?1:0)):S===pas.System.TTypeKind.tkDouble?(u=this.FReader.ReadDouble(),t.TTMSFNCPersistence.IsReadOnly(r)||pas.TypInfo.SetFloatProp$1(a,r,u)):5===S?(F=rtl.rc(this.FReader.ReadInteger(),-2147483648,2147483647),t.TTMSFNCPersistence.IsReadOnly(r)||pas.TypInfo.SetOrdProp$1(a,r,F)):9===S?(C.Data=null,C.Code=null,this.FReader.IsNull()?this.FReader.ReadNull():null!=t.TTMSFNCPersistence.FRootObject?(T=this.FReader.ReadString(),C.Code=t.TTMSFNCPersistence.FRootObject.$class.MethodAddress(T),null!==C.Code&&(C.Data=t.TTMSFNCPersistence.FRootObject)):this.FReader.ReadNull(),pas.TypInfo.SetMethodProp(a,r,C)):(t.TTMSFNCPersistence.GetEnumName(pas.System.$rtti.TTypeKind,o),this.FReader.ReadNull()),pas["WEBLib.Graphics"].TFont.isPrototypeOf(a)&&"Size"===n&&this.FReader.HasNext()&&"IsFMX"===(p=this.FReader.PeekName())&&(this.FReader.ReadName(),this.FReader.ReadBoolean()&&rtl.as(a,pas["WEBLib.Graphics"].TFont).SetSize(Math.round(rtl.as(a,pas["WEBLib.Graphics"].TFont).FSize/96*72)))}},this.ReadExistingObject=function(e){if(null!=e){if(this.FReader.ReadBeginObject(),""!==t.TTMSFNCPersistence.ClassTypeVariable){if(!this.FReader.HasNext()||this.FReader.ReadName()!==t.TTMSFNCPersistence.ClassTypeVariable)throw t.ETMSFNCReaderException.$create("Create$1",['"'+t.TTMSFNCPersistence.ClassTypeVariable+'" property not found in Object descriptor.']);this.FReader.ReadString()}this.ReadProperties(e),this.FReader.ReadEndObject()}else this.FReader.ReadNull()},this.ReadGenericStringList=function(t){var e="";for(t.Clear(),this.FReader.ReadBeginArray();this.FReader.HasNext();)this.FReader.IsNull()?this.FReader.SkipValue():(e=this.FReader.ReadString(),t.Add(e));this.FReader.ReadEndArray()},this.ReadGenericDoubleList=function(t){var e=0;for(t.Clear(),this.FReader.ReadBeginArray();this.FReader.HasNext();)this.FReader.IsNull()?this.FReader.SkipValue():(e=this.FReader.ReadDouble(),t.Add(e));this.FReader.ReadEndArray()},this.ReadGenericIntegerList=function(t){var e=0;for(t.Clear(),this.FReader.ReadBeginArray();this.FReader.HasNext();)this.FReader.IsNull()?this.FReader.SkipValue():(e=this.FReader.ReadInteger(),t.Add(e));this.FReader.ReadEndArray()},this.ReadStrings=function(t){var e="";for(t.Clear(),this.FReader.ReadBeginArray();this.FReader.HasNext();)this.FReader.IsNull()?this.FReader.SkipValue():(e=this.FReader.ReadString(),t.Add(e));this.FReader.ReadEndArray()},this.ReadGenericObjectList=function(e){var i=null,s=null,n=null,o=null,r=!1;try{if(n=pas.System.TObject,pas.SysUtils.Supports$3(e,t.ITMSFNCBaseListIO.$guid,{get:function(){return o},set:function(t){o=t}})&&(n=o.GetItemClass()),r=!1,this.FReader.ReadBeginArray(),this.FReader.HasNext())for(;this.FReader.HasNext();)this.FReader.IsNull()?this.FReader.SkipValue():null!=(i=this.ReadSingleObject(n))&&(r||(e.Clear(),r=!0),null!=this.FIOReference&&pas.SysUtils.Supports$3(this.FIOReference,t.ITMSFNCPersistenceIO.$guid,{get:function(){return s},set:function(t){s=t}})&&s.FixOwners(i,e),e.Add(i));else e.Clear();this.FReader.ReadEndArray()}finally{rtl._Release(o),rtl._Release(s)}},this.ReadGenericDictionary=function(e){var i=null,s="",n=null,o=null,r=!1;try{if(n=pas.System.TObject,pas.SysUtils.Supports$3(e,t.ITMSFNCBaseListIO.$guid,{get:function(){return o},set:function(t){o=t}})&&(n=o.GetItemClass()),r=!1,e.Clear(),this.FReader.ReadBeginArray(),this.FReader.HasNext())for(;this.FReader.HasNext();)this.FReader.IsNull()?this.FReader.SkipValue():(this.FReader.ReadBeginObject(),s=this.FReader.ReadName(),null!=(i=this.ReadSingleObject(n))&&(r||(e.Clear(),r=!0),e.Add(s,i)),this.FReader.ReadEndObject());else e.Clear();this.FReader.ReadEndArray()}finally{rtl._Release(o)}},this.ReadCollection=function(e){var i=null,s=null,n=null,o=null,r=!1;try{if(s=pas.System.TObject,pas.SysUtils.Supports$3(e,t.ITMSFNCBaseListIO.$guid,{get:function(){return n},set:function(t){n=t}})&&(s=n.GetItemClass()),pas.SysUtils.Supports$3(e,t.ITMSFNCBaseCollectionIO.$guid,{get:function(){return o},set:function(t){o=t}}),r=!1,this.FReader.ReadBeginArray(),this.FReader.HasNext()){for(;this.FReader.HasNext();)if(this.FReader.IsNull())this.FReader.SkipValue();else if(null!=(i=this.ReadSingleObject(s))){r||(e.Clear(),r=!0);try{pas.Classes.TPersistent.isPrototypeOf(i)&&(null!=o?o.AddItem(i).Assign(rtl.as(i,pas.Classes.TPersistent)):e.Add().Assign(rtl.as(i,pas.Classes.TPersistent)))}finally{i=rtl.freeLoc(i)}}}else e.Clear();this.FReader.ReadEndArray()}finally{rtl._Release(n),rtl._Release(o)}},this.ReadList=function(e){var i=null,s=null,n=null,o=null,r=!1;try{if(n=pas.System.TObject,pas.SysUtils.Supports$3(e,t.ITMSFNCBaseListIO.$guid,{get:function(){return o},set:function(t){o=t}})&&(n=o.GetItemClass()),r=!1,this.FReader.ReadBeginArray(),this.FReader.HasNext())for(;this.FReader.HasNext();)this.FReader.IsNull()?this.FReader.SkipValue():null!=(i=this.ReadSingleObject(n))&&(r||(e.Clear(),r=!0),null!=this.FIOReference&&pas.SysUtils.Supports$3(this.FIOReference,t.ITMSFNCPersistenceIO.$guid,{get:function(){return s},set:function(t){s=t}})&&s.FixOwners(i,e),e.Add(i));else e.Clear();this.FReader.ReadEndArray()}finally{rtl._Release(o),rtl._Release(s)}},this.ReadBitmap=function(t){var e;this.FReader.IsNull()||""!==(e=this.FReader.ReadString())&&t.SetData(e)},this.ReadObject=function(e){null===e?this.FReader.ReadNull():t.TTMSFNCPersistence.IsGenericList(e.$class.ClassType(),"String")?this.ReadGenericStringList(e):t.TTMSFNCPersistence.IsGenericList(e.$class.ClassType(),"Double")?this.ReadGenericDoubleList(e):t.TTMSFNCPersistence.IsGenericList(e.$class.ClassType(),"Integer")?this.ReadGenericIntegerList(e):t.TTMSFNCPersistence.IsGenericList(e.$class.ClassType(),"")?this.ReadGenericObjectList(e):t.TTMSFNCPersistence.IsGenericDictionary(e.$class.ClassType())?this.ReadGenericDictionary(e):t.TTMSFNCPersistence.IsList(e.$class.ClassType())?this.ReadList(e):t.TTMSFNCPersistence.IsCollection(e.$class.ClassType())?this.ReadCollection(e):t.TTMSFNCPersistence.IsBitmap(e.$class.ClassType())?this.ReadBitmap(e):t.TTMSFNCPersistence.IsDescendingClass(e.$class.ClassType(),["TStrings"])?this.ReadStrings(e):this.ReadSingleObject$1(e)},this.Create$1=function(t){return this.FReader=pas["WEBLib.TMSFNCJSONReader"].TTMSFNCJSONReader.$create("Create$1",[t]),this.FReferences=pas["Generics.Collections"].TObjectList$G2.$create("Create$4",[!0]),this},this.Destroy=function(){rtl.free(this,"FReader"),rtl.free(this,"FReferences"),pas.System.TObject.Destroy.call(this)},this.Read$1=function(t){this.ReadObject(t)}})),rtl.createClass(this,"TTMSFNCObjectPersistence",pas.System.TObject,(function(){this.LoadObjectFromString=function(e,i){var s=null;s=pas.Classes.TStringStream.$create("Create$2",[i]);try{t.TTMSFNCPersistence.LoadSettingsFromStream(e,s)}finally{s=rtl.freeLoc(s)}}})),rtl.createClass(this,"TTMSFNCPersistence",pas.System.TObject,(function(){this.ClassTypeVariable="",this.FOnCustomReadProperty=null,this.FOnCustomWriteProperty=null,this.FRootObject=null,this.FExcludeProperties=[],this.FIOReference=null,this.DoCustomReadProperty=function(t,e,i,s,n){rtl.rc(i,0,20),null!=this.FOnCustomReadProperty&&this.FOnCustomReadProperty(t,e,i,s,n)},this.DoCustomWriteProperty=function(t,e,i,s,n){rtl.rc(i,0,20),null!=this.FOnCustomWriteProperty&&this.FOnCustomWriteProperty(t,e,i,s,n)},this.SaveSettingsToFile=function(t,e){var i=null;i=pas.Classes.TMemoryStream.$create("Create");try{this.SaveSettingsToStream(t,i),pas["WEBLib.TMSFNCTypes"].TTMSFNCMemoryStream.SaveToFile.call(i,e)}finally{i=rtl.freeLoc(i)}},this.SaveSettingsToStream=function(e,i){var s,n,o=null;o=t.TTMSFNCWriter.$create("Create$1",[i]),n=pas.SysUtils.FormatSettings.ThousandSeparator,s=pas.SysUtils.FormatSettings.DecimalSeparator;try{o.SetIOReference(t.TTMSFNCPersistence.FIOReference),o.SetRootObject(t.TTMSFNCPersistence.FRootObject),o.FOnCustomWriteProperty=rtl.createCallback(this,"DoCustomWriteProperty"),pas.SysUtils.FormatSettings.DecimalSeparator=".",pas.SysUtils.FormatSettings.ThousandSeparator=",",o.Write(e)}finally{pas.SysUtils.FormatSettings.DecimalSeparator=s,pas.SysUtils.FormatSettings.ThousandSeparator=n,o=rtl.freeLoc(o)}},this.LoadSettingsFromStream=function(e,i){var s,n,o=null;i.SetPosition(0),o=t.TTMSFNCReader.$create("Create$1",[i]),n=pas.SysUtils.FormatSettings.ThousandSeparator,s=pas.SysUtils.FormatSettings.DecimalSeparator;try{o.SetIOReference(t.TTMSFNCPersistence.FIOReference),o.SetRootObject(t.TTMSFNCPersistence.FRootObject),o.FOnCustomReadProperty=rtl.createCallback(this,"DoCustomReadProperty"),pas.SysUtils.FormatSettings.DecimalSeparator=".",pas.SysUtils.FormatSettings.ThousandSeparator=",",o.Read$1(e)}finally{pas.SysUtils.FormatSettings.DecimalSeparator=s,pas.SysUtils.FormatSettings.ThousandSeparator=n,o=rtl.freeLoc(o)}},this.CreateObject=function(e,i){var s=null,n=null;if(null===(n=pas.Classes.GetClass(e)))throw t.ETMSFNCReaderException.$create("CreateFmt",['Type "%s" not found',pas.System.VarRecs(18,e)]);if(!n.InheritsFrom(pas.System.TObject))throw t.ETMSFNCReaderException.$create("Create$1",['Type "%s" is not an class type']);if(null!==i&&!n.InheritsFrom(i))throw t.ETMSFNCReaderException.$create("CreateFmt",['Type "%s" does not inherit from %s',pas.System.VarRecs(18,e,18,i.$classname)]);if(n.InheritsFrom(pas["WEBLib.Controls"].TCustomControl))s=n.$create("Create$1",[null]);else if(n.InheritsFrom(pas.Classes.TComponent))s=n.$create("Create$1",[null]);else if(n.InheritsFrom(pas.Classes.TCollectionItem))s=n.$create("Create$1",[null]);else{if(!n.InheritsFrom(pas.Classes.TPersistent))throw t.ETMSFNCReaderException.$create("CreateFmt",['Type "%s" not supported',pas.System.VarRecs(18,e)]);s=n.$create("Create")}return s},this.GetPropInfoDataTypeInfo=function(t){var e=null;return e=null,null!=t&&(e=t.typeinfo),e},this.GetPropInfoDataTypeInfoClassType=function(t){var e=null;return null,null!=t&&null!=t.typeinfo&&(e=t.typeinfo).class?e.class.ClassType():null},this.GetPropInfoType=function(t){return null!=t.typeinfo?rtl.rc(t.typeinfo.kind,0,20):0},this.GetPropInfoName=function(t){return t.name},this.GetPropInfoTypeName=function(t){var e="";return e="",null!=t.typeinfo&&(e=t.typeinfo.name),e},this.GetEnumName=function(t,e){rtl.rc(e,-2147483648,2147483647);return t.enumtype[e]},this.IsWriteOnly=function(t){return""===t.getter},this.IsReadOnly=function(t){return""===t.setter},this.IsAssignableProperty=function(t,e){var i=!1,s=null,n="";return i=!1,rtl.rc(this.GetPropInfoType(e),0,20)in rtl.createSet(13)&&(n=this.GetPropInfoName(e),i=null!=(s=pas.TypInfo.GetObjectProp(t,n))&&this.IsComponent(s.$class.ClassType())||!(null!=s)),i},this.IsGenericList=function(t,e){var i="";if(null==t)return!1;do{if(i=t.$classname,(pas.StrUtils.AnsiStartsStr("TList<",i)||pas.StrUtils.AnsiStartsStr("TObjectList<",i))&&(""===e||""!==e&&pas.System.Pos(pas.SysUtils.LowerCase(e),pas.SysUtils.LowerCase(i))>0||pas.System.Pos(pas.SysUtils.LowerCase(e),pas.SysUtils.LowerCase(i))>0))return!0;t=t.$ancestor}while(null!=t);return!1,!1},this.IsGenericDictionary=function(t){var e="";if(null==t)return!1;do{if(e=t.$classname,pas.StrUtils.AnsiStartsStr("TDictionary<",e)||pas.StrUtils.AnsiStartsStr("TObjectDictionary<",e))return!0;t=t.$ancestor}while(null!=t);return!1,!1},this.IsCollection=function(t){return this.IsDescendingClass(t,["TCollection"])},this.IsComponent=function(t){return this.IsDescendingClass(t,["TComponent","TTMSFNCCustomComponent"])},this.IsList=function(t){return this.IsDescendingClass(t,["TList"])},this.IsDescendingClass=function(t,e){var i="",s=0;if(null==t)return!1;do{i=t.$classname;for(var n=0,o=rtl.length(e)-1;n<=o;n++)if(s=n,i===rtl.rcArrR(e,s))return!0;t=t.$ancestor}while(null!=t);return!1,!1},this.IsBitmap=function(t){return this.IsDescendingClass(t,["TBitmap","TPicture","TTMSFNCBitmap","TGraphic"])}})),this.ExcludePropertyList=["Align","AllowFocus","Anchors","BevelEdges","BevelInner","BevelKind","BevelOuter","BevelWidth","BiDiMode","BitmapContainer","BorderSpacing","CanParentFocus","ClipChildren","ClipParent","Constraints","Ctl3D","DisableFocusEffect","DoubleBuffered","DragCursor","DragKind","DragMode","Enabled","EnableDragHighLight","Height","Hint","HitTest","Locked","Margins","Name","Opacity","Padding","ParentBiDiMode","ParentColor","ParentCtl3D","ParentDoubleBuffered","ParentFont","ParentShowHint","PopupMenu","Position","RotationAngle","RotationCenter","Scale","ShowHint","Size","StyleElements","StyleName","TabOrder","TabStop","Tag","Touch","TouchTargetExpansion","Visible","Width"],t.$implcode=function(){e.gcNull=-1,e.GetColorRed=function(t){return t=pas["WEBLib.Graphics"].ColorToRGB(t),pas["WEBLib.Graphics"].GetRValue(t)},e.GetColorGreen=function(t){return t=pas["WEBLib.Graphics"].ColorToRGB(t),pas["WEBLib.Graphics"].GetGValue(t)},e.GetColorBlue=function(t){return t=pas["WEBLib.Graphics"].ColorToRGB(t),pas["WEBLib.Graphics"].GetBValue(t)},e.HTMLToColorEx=function(t){function e(t){return t.length<2?0:(1,2,((t.charAt(0)>="A"?t.charCodeAt(0)-65+10:t.charCodeAt(0)-48)<<4)+(t.charAt(1)>="A"?t.charCodeAt(1)-65+10:t.charCodeAt(1)-48))}var i,s;return i=e(pas.System.Copy(t,2,2)),s=e(pas.System.Copy(t,4,2))<<8,(e(pas.System.Copy(t,6,2))<<16)+s+i};var t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"];e.ColorToHTMLEx=function(i){var s,n="";return 1,s=pas["WEBLib.Graphics"].ColorToRGB(i),n="#RRGGBB",n=rtl.setCharAt(n,1,t[e.GetColorRed(s)>>>4]),n=rtl.setCharAt(n,2,t[15&e.GetColorRed(s)]),n=rtl.setCharAt(n,3,t[e.GetColorGreen(s)>>>4]),n=rtl.setCharAt(n,4,t[15&e.GetColorGreen(s)]),n=rtl.setCharAt(n,5,t[e.GetColorBlue(s)>>>4]),n=rtl.setCharAt(n,6,t[15&e.GetColorBlue(s)])}},t.$init=function(){t.TTMSFNCPersistence.ClassTypeVariable="$type"}}),["StrUtils","WEBLib.Controls","WEBLib.Graphics","WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCTypes",["System","Types","Classes","WEBLib.Graphics","SysUtils","WEBLib.Controls","Math","WEBLib.JSON"],(function(){"use strict";var t=this;this.ssCommand=2,this.TMSPlatformsWeb=0,this.KEY_CONTROL=17,this.KEY_SHIFT=16,this.KEY_ESCAPE=27,this.KEY_INSERT=45,this.KEY_DELETE=46,this.KEY_TAB=9,this.KEY_SUBTRACT=109,this.KEY_ADD=107,this.KEY_MULTIPLY=106,this.KEY_DIVIDE=111,this.KEY_PRIOR=33,this.KEY_NEXT=34,this.KEY_UP=38,this.KEY_DOWN=40,this.KEY_RIGHT=39,this.KEY_LEFT=37,this.KEY_HOME=36,this.KEY_END=35,this.KEY_RETURN=13,this.KEY_SPACE=32,this.KEY_MENU=18,this.KEY_BACK=8,this.KEY_F2=113,this.KEY_F4=115,rtl.createHelper(this,"TTMSFNCMemoryStream",null,(function(){this.GetBytes=function(){var t,e,i=[];return e=this.GetPosition(),this.SetPosition(0),i=rtl.arraySetLength(i,0,this.GetSize()),this.Read$1(rtl.arrayRef(i),0,rtl.length(i)),t=rtl.arrayRef(i),this.SetPosition(e),t},this.SaveToFile=function(e){var i,s;if(i=e,s=rtl.arrayRef(t.TTMSFNCMemoryStream.GetBytes.call(this)),navigator.userAgent.toLowerCase().indexOf("electron/")>-1){var n=new Uint8Array(s);nfs.writeFileSync(i,n)}else{var o=new Blob([new Uint8Array(s)],{type:"octet/stream"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)return void window.navigator.msSaveOrOpenBlob(o,i);const t=window.URL.createObjectURL(o);var r=document.createElement("a");r.href=t,r.download=i,document.body.appendChild(r),r.click(),setTimeout((function(){document.body.removeChild(r),window.URL.revokeObjectURL(t)}),100)}}})),rtl.recNewT(this,"TSizeF",(function(){this.cx=0,this.cy=0,this.$eq=function(t){return this.cx===t.cx&&this.cy===t.cy},this.$assign=function(t){return this.cx=t.cx,this.cy=t.cy,this}})),rtl.recNewT(this,"TPointF",(function(){this.X=0,this.Y=0,this.$eq=function(t){return this.X===t.X&&this.Y===t.Y},this.$assign=function(t){return this.X=t.X,this.Y=t.Y,this};var e=t.$rtti.$Record("TPointF",{});e.addField("X",rtl.double),e.addField("Y",rtl.double)})),rtl.recNewT(this,"TRectF",(function(){this.Left=0,this.Top=0,this.Right=0,this.Bottom=0,this.$eq=function(t){return this.Left===t.Left&&this.Top===t.Top&&this.Right===t.Right&&this.Bottom===t.Bottom},this.$assign=function(t){return this.Left=t.Left,this.Top=t.Top,this.Right=t.Right,this.Bottom=t.Bottom,this};var e=t.$rtti.$Record("TRectF",{});e.addField("Left",rtl.double),e.addField("Top",rtl.double),e.addField("Right",rtl.double),e.addField("Bottom",rtl.double)})),rtl.createClass(this,"TTMSFNCBitmap",pas["WEBLib.Graphics"].TBitmap,(function(){})),rtl.createHelper(this,"TTMSFNCObjectHelper",null,(function(){this.ToJSON$1=function(){var t="",e=null;e=pas.Classes.TStringStream.$create("Create$3",["",pas.Classes.TEncoding.GetANSI(),!0]);try{pas["WEBLib.TMSFNCPersistence"].TTMSFNCPersistence.SaveSettingsToStream(this,e),t=e.GetDataString()}finally{e=rtl.freeLoc(e)}return t},this.SaveToJSONFile=function(t){pas["WEBLib.TMSFNCPersistence"].TTMSFNCPersistence.SaveSettingsToFile(this,t)},this.LoadFromJSONStream=function(t){pas["WEBLib.TMSFNCPersistence"].TTMSFNCPersistence.LoadSettingsFromStream(this,t)}})),rtl.createClass(this,"TTMSFNCMargins",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FRight=0,this.FBottom=0,this.FTop=0,this.FLeft=0,this.FOnChange=null},this.$final=function(){this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetBottom=function(t){this.FBottom!==t&&(this.FBottom=t,this.Changed())},this.SetLeft=function(t){this.FLeft!==t&&(this.FLeft=t,this.Changed())},this.SetRight=function(t){this.FRight!==t&&(this.FRight=t,this.Changed())},this.SetTop=function(t){this.FTop!==t&&(this.FTop=t,this.Changed())},this.IsLeftStored=function(){return 0!==this.FLeft},this.IsTopStored=function(){return 0!==this.FTop},this.IsRightStored=function(){return 0!==this.FRight},this.IsBottomStored=function(){return 0!==this.FBottom},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Create$1=function(){return this.FLeft=0,this.FBottom=0,this.FRight=0,this.FTop=0,this},this.Assign=function(e){t.TTMSFNCMargins.isPrototypeOf(e)&&(this.FLeft=rtl.as(e,t.TTMSFNCMargins).FLeft,this.FTop=rtl.as(e,t.TTMSFNCMargins).FTop,this.FRight=rtl.as(e,t.TTMSFNCMargins).FRight,this.FBottom=rtl.as(e,t.TTMSFNCMargins).FBottom)},this.Empty=function(){var e=t.TRectF.$new();return e.$assign(t.RectF(this.FLeft,this.FTop,this.FRight,this.FBottom)),t.RectIsEmpty(e)},this.Rect=function(){var e=t.TRectF.$new();return e.$assign(t.RectF(this.FLeft,this.FTop,this.FRight,this.FBottom)),e};var e=this.$rtti;e.addProperty("Left",14,rtl.double,"FLeft","SetLeft",{stored:"IsLeftStored"}),e.addProperty("Top",14,rtl.double,"FTop","SetTop",{stored:"IsTopStored"}),e.addProperty("Right",14,rtl.double,"FRight","SetRight",{stored:"IsRightStored"}),e.addProperty("Bottom",14,rtl.double,"FBottom","SetBottom",{stored:"IsBottomStored"}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange")})),rtl.createClass(this,"TTMSFNCPoint",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FY=0,this.FX=0,this.FOnChange=null},this.$final=function(){this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetX=function(t){this.FX!==t&&(this.FX=t,this.Changed())},this.SetY=function(t){this.FY!==t&&(this.FY=t,this.Changed())},this.IsXStored=function(){return 0!==this.FX},this.IsYStored=function(){return 0!==this.FY},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Create$1=function(){return this.FX=0,this.FY=0,this},this.Assign=function(e){t.TTMSFNCPoint.isPrototypeOf(e)&&(this.FX=rtl.as(e,t.TTMSFNCPoint).FX,this.FY=rtl.as(e,t.TTMSFNCPoint).FY)};var e=this.$rtti;e.addProperty("X",14,rtl.double,"FX","SetX",{stored:"IsXStored"}),e.addProperty("Y",14,rtl.double,"FY","SetY",{stored:"IsYStored"}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange")})),rtl.createClass(this,"TTMSFNCScaledBitmap",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FBitmap=null,this.FScale=0,this.FBitmapName=""},this.$final=function(){this.FBitmap=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.IsScaleStored=function(){return 1!==this.FScale},this.SetBitmap=function(t){this.FBitmap!==t&&(this.FBitmap.Assign(t),this.Changed(!1))},this.SetScale=function(t){this.FScale!==t&&(this.FScale=t,this.Changed(!1))},this.SetBitmapName=function(t){this.FBitmapName!==t&&(this.FBitmapName=t,this.Changed(!1))},this.BitmapChanged=function(t){this.Changed(!1)},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FBitmap=t.TTMSFNCBitmap.$create("Create$3"),this.FBitmap.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FScale=1,this},this.Destroy=function(){rtl.free(this,"FBitmap"),pas.Classes.TCollectionItem.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCScaledBitmap.isPrototypeOf(e)&&(this.FBitmap.Assign(rtl.as(e,t.TTMSFNCScaledBitmap).FBitmap),this.FBitmapName=rtl.as(e,t.TTMSFNCScaledBitmap).FBitmapName,this.FScale=rtl.as(e,t.TTMSFNCScaledBitmap).FScale)};var e=this.$rtti;e.addProperty("Bitmap",2,t.$rtti.TTMSFNCBitmap,"FBitmap","SetBitmap"),e.addProperty("BitmapName",2,rtl.string,"FBitmapName","SetBitmapName"),e.addProperty("Scale",14,rtl.double,"FScale","SetScale",{stored:"IsScaleStored"})})),rtl.createClass(this,"TTMSFNCScaledBitmaps",pas.Classes.TOwnedCollection,(function(){this.$init=function(){pas.Classes.TOwnedCollection.$init.call(this),this.FOnChange=null},this.$final=function(){this.FOnChange=void 0,pas.Classes.TOwnedCollection.$final.call(this)},this.GetItems=function(t){return this.GetItem(t)},this.Update=function(t){pas.Classes.TCollection.Update.apply(this,arguments),null!=this.FOnChange&&this.FOnChange(this)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TTMSFNCScaledBitmap),this},this.Add$1=function(t){var e=null;return(e=pas.Classes.TCollection.Add.call(this)).SetScale(t),e},this.AddBitmapFromResource=function(t,e){return this.AddBitmapFromResource$1(t,0,e)},this.AddBitmapFromResource$1=function(t,e,i){var s=null;return(s=this.Add$1(i)).FBitmap.LoadFromResource$1(t,e),s},this.AddBitmap=function(t,e){var i=null;return(i=this.Add$1(e)).FBitmap.Assign(t),i},this.AddBitmapName=function(t,e){var i=null;return(i=this.Add$1(e)).SetBitmapName(t),i},this.GetItemByScale=function(t){var e=null,i=0,s=null,n=null,o=0;e=null,s=null,o=0;for(var r=0,a=this.GetCount()-1;r<=a;r++){if(i=r,(n=this.GetItems(i)).FScale===t){e=n;break}n.FScale!==t&&n.FScale>o&&(s=n,o=n.FScale)}return null===e&&(e=s),e}})),rtl.createClass(this,"TTMSFNCOwnedCollection",pas.Classes.TOwnedCollection,(function(){})),this.InflateRectEx=function(t,e,i){t.Left=t.Left-e,t.Right=t.Right+e,t.Top=t.Top-i,t.Bottom=t.Bottom+i},this.ConvertToRectF=function(e){var i=t.TRectF.$new();return i.Left=e.Left,i.Top=e.Top,i.Right=e.Right,i.Bottom=e.Bottom,i},this.ConvertToRect=function(t){var e=pas.Types.TRect.$new();return e.Left=Math.round(t.Left),e.Top=Math.round(t.Top),e.Right=Math.round(t.Right),e.Bottom=Math.round(t.Bottom),e},this.OffsetRectEx$1=function(t,e,i){return t.Left=t.Left+e,t.Right=t.Right+e,t.Top=t.Top+i,t.Bottom=t.Bottom+i,!0,!0},this.PtInRectEx=function(t,e){return e.X>=t.Left&&e.X<t.Right&&e.Y>=t.Top&&e.Y<t.Bottom},this.IntersectRectEx=function(t,e){return t.Left<e.Right&&t.Right>e.Left&&t.Top<e.Bottom&&t.Bottom>e.Top},this.IntersectRectEx$1=function(e,i,s){var n,o=t.TRectF.$new();return o.$assign(i),s.Left>i.Left&&(o.Left=s.Left),s.Top>i.Top&&(o.Top=s.Top),s.Right<i.Right&&(o.Right=s.Right),s.Bottom<i.Bottom&&(o.Bottom=s.Bottom),(n=!t.RectIsEmpty(o))||(o.Top=0,o.Bottom=0,o.Left=0,o.Right=0),e.$assign(o),n},this.EqualRectEx=function(t,e){return t.Left===e.Left&&t.Right===e.Right&&t.Top===e.Top&&t.Bottom===e.Bottom},this.RectWidthEx$1=function(t){return t.Right-t.Left},this.RectHeightEx$1=function(t){return t.Bottom-t.Top},this.RectCenterEx$1=function(e,i){var s=t.TRectF.$new();return t.OffsetRectEx$1(e,-e.Left,-e.Top),t.OffsetRectEx$1(e,Math.round((t.RectWidthEx$1(i)-t.RectWidthEx$1(e))/2),Math.round((t.RectHeightEx$1(i)-t.RectHeightEx$1(e))/2)),t.OffsetRectEx$1(e,i.Left,i.Top),s.$assign(e),s},this.RectCenterAtEx=function(e,i){var s=t.TRectF.$new();return s.$assign(e),t.RectCenterEx$1(s,i),s},this.RectSnapToPixelEx=function(e,i,s){var n=t.TRectF.$new(),o=0,r=0;return o=i<=0?1:i,n.Left=pas.System.Trunc(e.Left*o)/o,n.Top=pas.System.Trunc(e.Top*o)/o,n.Right=n.Left+Math.round((e.Right-e.Left)*o)/o,n.Bottom=n.Top+Math.round((e.Bottom-e.Top)*o)/o,s&&(r=1/(2*o),t.OffsetRectEx$1(n,r,r)),n},this.RectFitIntoEx=function(e,i,s){var n=t.TRectF.$new();return i.Right-i.Left<=0||i.Bottom-i.Top<=0?(s.set(1),e):((e.Right-e.Left)/(i.Right-i.Left)>(e.Bottom-e.Top)/(i.Bottom-i.Top)?s.set((e.Right-e.Left)/(i.Right-i.Left)):s.set((e.Bottom-e.Top)/(i.Bottom-i.Top)),n.$assign(t.RectF(0,0,(e.Right-e.Left)/s.get(),(e.Bottom-e.Top)/s.get())),t.RectCenterEx$1(n,i),n)},this.RectFitIntoEx$1=function(e,i){var s=t.TRectF.$new(),n=0;return s.$assign(t.RectFitIntoEx(e,i,{get:function(){return n},set:function(t){n=t}})),s},this.GetPointLength=function(t){return Math.sqrt(pas.System.Sqr$1(t.X)+pas.System.Sqr$1(t.Y))},this.MakeRectF=function(e,i,s,n){var o=t.TRectF.$new();return o.Left=e,o.Top=i,o.Right=e+s,o.Bottom=i+n,o},this.CenterPointEx=function(e){var i=t.TPointF.$new();return i.X=(e.Right-e.Left)/2+e.Left,i.Y=(e.Bottom-e.Top)/2+e.Top,i},this.CompareValueEx=function(t,e,i){return pas.Math.SameValue(t,e,i)?0:t<e?-1:1},this.RectIsEmpty=function(t){return t.Right<t.Left||pas.Math.SameValue(t.Right,t.Left,0)||t.Bottom<t.Top||pas.Math.SameValue(t.Bottom,t.Top,0)},this.EmptyRect=function(){var e=t.TRectF.$new();return e.$assign(t.RectF(0,0,0,0)),e},this.RectIntersectsWithEx=function(t,e){return t.Left<e.Right&&t.Right>e.Left&&t.Top<e.Bottom&&t.Bottom>e.Top},this.RectF=function(e,i,s,n){var o=t.TRectF.$new();return o.Left=e,o.Top=i,o.Bottom=n,o.Right=s,o},this.PointF=function(e,i){var s=t.TPointF.$new();return s.X=e,s.Y=i,s},this.BitmapToDrawBitmap=function(t){var e=null;return e=null,null!=t&&(e=t),e},this.IsBitmapEmpty=function(e){var i=!1,s=null;return i=!0,null!=e&&null!=(s=t.BitmapToDrawBitmap(e))&&(i=s.Empty()),i},this.CharInArray=function(t,e){var i=!1;i=!1;for(var s=0,n=rtl.length(e)-1;s<=n;s++)if(e[s]===t)return i=!0;return i},this.CharIsNumber=function(t){return t.charCodeAt()in rtl.createSet(null,48,57)},this.CharIsLetter=function(t){return t.charCodeAt()in rtl.createSet(null,97,122)||t.charCodeAt()in rtl.createSet(null,65,90)},this.CharIsHex=function(t){return t.charCodeAt()in rtl.createSet(null,48,57)||t.charCodeAt()in rtl.createSet(null,97,102)||t.charCodeAt()in rtl.createSet(null,65,70)},this.CharIsLetterOrNumber=function(e){return t.CharIsLetter(e)||t.CharIsNumber(e)},this.AnsiUpperCase=function(t){return pas.SysUtils.UpperCase(t)},this.AnsiLowerCase=function(t){return pas.SysUtils.LowerCase(t)},this.HInstance=function(){return 0,0}}),["WEBLib.TMSFNCUtils","WEBLib.TMSFNCPersistence","JS"]),rtl.module("WEBLib.TMSFNCGraphicsTypes",["System","Classes","Types","WEBLib.TMSFNCTypes","WEBLib.Graphics"],(function(){"use strict";var t=this,e=t.$impl;this.PathPosition=.001,this.gcAliceblue=16775408,this.gcAntiquewhite=14150650,this.gcAqua=16776960,this.gcAquamarine=13959039,this.gcAzure=16777200,this.gcBeige=14480885,this.gcBisque=12903679,this.gcBlack=0,this.gcBlanchedalmond=13495295,this.gcBlue=16711680,this.gcBlueviolet=14822282,this.gcBrown=2763429,this.gcBurlywood=8894686,this.gcCadetblue=10526303,this.gcChartreuse=65407,this.gcChocolate=1993170,this.gcCoral=5275647,this.gcCornflowerblue=15570276,this.gcCornsilk=14481663,this.gcCrimson=3937500,this.gcCyan=16776960,this.gcDarkblue=9109504,this.gcDarkcyan=9145088,this.gcDarkgoldenrod=755384,this.gcDarkgray=11119017,this.gcDarkgreen=25600,this.gcDarkgrey=11119017,this.gcDarkkhaki=7059389,this.gcDarkmagenta=9109643,this.gcDarkolivegreen=3107669,this.gcDarkorange=36095,this.gcDarkorchid=13382297,this.gcDarkred=139,this.gcDarksalmon=8034025,this.gcDarkseagreen=9419919,this.gcDarkslateblue=9125192,this.gcDarkslategray=5197615,this.gcDarkslategrey=5197615,this.gcDarkturquoise=13749760,this.gcDarkviolet=13828244,this.gcDeeppink=9639167,this.gcDeepskyblue=16760576,this.gcDimgray=6908265,this.gcDimgrey=6908265,this.gcDodgerblue=16748574,this.gcFirebrick=2237106,this.gcFloralwhite=15792895,this.gcForestgreen=2263842,this.gcFuchsia=16711935,this.gcGainsboro=14474460,this.gcGhostwhite=16775416,this.gcGold=55295,this.gcGoldenrod=2139610,this.gcGray=8421504,this.gcGreen=32768,this.gcGreenyellow=3145645,this.gcGrey=8421504,this.gcHoneydew=15794160,this.gcHotpink=11823615,this.gcIndianred=6053069,this.gcIndigo=8519755,this.gcIvory=15794175,this.gcKhaki=9234160,this.gcLavender=16443110,this.gcLavenderblush=16118015,this.gcLawngreen=64636,this.gcLemonchiffon=13499135,this.gcLightblue=15128749,this.gcLightcoral=8421616,this.gcLightcyan=16777184,this.gcLightgoldenrodyellow=13826810,this.gcLightgray=13882323,this.gcLightgreen=9498256,this.gcLightgrey=13882323,this.gcLightpink=12695295,this.gcLightsalmon=8036607,this.gcLightseagreen=11186720,this.gcLightskyblue=16436871,this.gcLightslategray=10061943,this.gcLightslategrey=10061943,this.gcLightsteelblue=14599344,this.gcLightyellow=14745599,this.gcMedGray=10789024,this.gcLime=65280,this.gcLimegreen=3329330,this.gcLinen=15134970,this.gcMagenta=16711935,this.gcMaroon=128,this.gcMediumaquamarine=11193702,this.gcMediumblue=13434880,this.gcMediumorchid=13850042,this.gcMediumpurple=14381203,this.gcMediumseagreen=7451452,this.gcMediumslateblue=15624315,this.gcMediumspringgreen=10156544,this.gcMediumturquoise=13422920,this.gcMediumvioletred=8721863,this.gcMidnightblue=7346457,this.gcMintcream=16449525,this.gcMistyrose=14804223,this.gcMoccasin=11920639,this.gcNavajowhite=11394815,this.gcNavy=8388608,this.gcOldlace=15136253,this.gcOlive=32896,this.gcOlivedrab=2330219,this.gcOrange=42495,this.gcOrangered=17919,this.gcOrchid=14053594,this.gcPalegoldenrod=11200750,this.gcPalegreen=10025880,this.gcPaleturquoise=15658671,this.gcPalevioletred=9662683,this.gcPapayawhip=14020607,this.gcPeachpuff=12180223,this.gcPeru=4163021,this.gcPink=13353215,this.gcPlum=14524637,this.gcPowderblue=15130800,this.gcPurple=8388736,this.gcRed=255,this.gcRosybrown=9408444,this.gcRoyalblue=14772545,this.gcSaddlebrown=1262987,this.gcSalmon=7504122,this.gcSandybrown=6333684,this.gcSeagreen=5737262,this.gcSeashell=15660543,this.gcSienna=2970272,this.gcSilver=12632256,this.gcSkyblue=15453831,this.gcSlateblue=13458026,this.gcSlategray=9470064,this.gcSlategrey=9470064,this.gcSnow=16448255,this.gcSpringgreen=8388352,this.gcSteelblue=11829830,this.gcTan=9221330,this.gcTeal=8421376,this.gcThistle=14204888,this.gcTomato=4678655,this.gcTurquoise=13688896,this.gcViolet=15631086,this.gcWheat=11788021,this.gcWhite=16777215,this.gcWhitesmoke=16119285,this.gcYellow=65535,this.gcYellowgreen=3329434,this.gcNull=-1,this.TTMSFNCGraphicsStrokeKind={0:"gskNone",gskNone:0,1:"gskSolid",gskSolid:1,2:"gskDash",gskDash:2,3:"gskDot",gskDot:3,4:"gskDashDot",gskDashDot:4,5:"gskDashDotDot",gskDashDotDot:5},this.$rtti.$Enum("TTMSFNCGraphicsStrokeKind",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TTMSFNCGraphicsStrokeKind}),this.TTMSFNCGraphicsTextureMode={0:"gtmOriginal",gtmOriginal:0,1:"gtmFit",gtmFit:1,2:"gtmStretch",gtmStretch:2,3:"gtmCenter",gtmCenter:3,4:"gtmTile",gtmTile:4},this.$rtti.$Enum("TTMSFNCGraphicsTextureMode",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TTMSFNCGraphicsTextureMode}),this.TTMSFNCGraphicsFillKind={0:"gfkNone",gfkNone:0,1:"gfkSolid",gfkSolid:1,2:"gfkGradient",gfkGradient:2,3:"gfkTexture",gfkTexture:3},this.$rtti.$Enum("TTMSFNCGraphicsFillKind",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCGraphicsFillKind}),this.TTMSFNCGraphicsFillGradientMode={0:"gfgmDefault",gfgmDefault:0,1:"gfgmCollection",gfgmCollection:1},this.TTMSFNCGraphicsFillGradientType={0:"gfgtLinear",gfgtLinear:0,1:"gfgtRadial",gfgtRadial:1},this.TTMSFNCGraphicsFillOrientation={0:"gfoHorizontal",gfoHorizontal:0,1:"gfoVertical",gfoVertical:1,2:"gfoCustom",gfoCustom:2},this.$rtti.$Enum("TTMSFNCGraphicsFillOrientation",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCGraphicsFillOrientation}),this.TTMSFNCGraphicsTextAlign={0:"gtaCenter",gtaCenter:0,1:"gtaLeading",gtaLeading:1,2:"gtaTrailing",gtaTrailing:2},this.$rtti.$Enum("TTMSFNCGraphicsTextAlign",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCGraphicsTextAlign}),this.TTMSFNCGraphicsTextTrimming={0:"gttNone",gttNone:0,1:"gttCharacter",gttCharacter:1,2:"gttWord",gttWord:2},this.$rtti.$Enum("TTMSFNCGraphicsTextTrimming",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCGraphicsTextTrimming}),this.TTMSFNCGraphicsSide={0:"gsLeft",gsLeft:0,1:"gsTop",gsTop:1,2:"gsRight",gsRight:2,3:"gsBottom",gsBottom:3},this.$rtti.$Enum("TTMSFNCGraphicsSide",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCGraphicsSide}),this.$rtti.$Set("TTMSFNCGraphicsSides",{comptype:this.$rtti.TTMSFNCGraphicsSide}),this.TTMSFNCGraphicsTextQuality={0:"gtqDefault",gtqDefault:0,1:"gtqAntiAliasing",gtqAntiAliasing:1,2:"gtqClearType",gtqClearType:2},this.AllSides=rtl.createSet(0,1,2,3),rtl.recNewT(this,"TTMSFNCGraphicsMatrix",(function(){this.m11=0,this.m12=0,this.m13=0,this.m21=0,this.m22=0,this.m23=0,this.m31=0,this.m32=0,this.m33=0,this.$eq=function(t){return this.m11===t.m11&&this.m12===t.m12&&this.m13===t.m13&&this.m21===t.m21&&this.m22===t.m22&&this.m23===t.m23&&this.m31===t.m31&&this.m32===t.m32&&this.m33===t.m33},this.$assign=function(t){return this.m11=t.m11,this.m12=t.m12,this.m13=t.m13,this.m21=t.m21,this.m22=t.m22,this.m23=t.m23,this.m31=t.m31,this.m32=t.m32,this.m33=t.m33,this}})),this.$rtti.$Class("TTMSFNCGraphicsStroke"),this.$rtti.$Class("TTMSFNCGraphicsFill"),this.$rtti.$Class("TTMSFNCGraphicsFont"),rtl.createClass(this,"TTMSFNCGraphicsSaveState",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FSaveDC=0,this.FFont=null,this.FStroke=null,this.FFill=null},this.$final=function(){this.FFont=void 0,this.FStroke=void 0,this.FFill=void 0,pas.Classes.TPersistent.$final.call(this)},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FFill=t.TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FStroke=t.TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FFont=t.TTMSFNCGraphicsFont.$create("Create$2"),this},this.Destroy=function(){rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FFont"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TTMSFNCGraphicsFillGradientItem",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FColor=0,this.FPosition=0,this.FOpacity=0},this.IsPositionStored=function(){return 0!==this.FPosition},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t,this.UpdateGradient())},this.SetPosition=function(t){this.FPosition!==t&&(this.FPosition=t,this.UpdateGradient())},this.IsOpacityStored=function(){return 1!==this.FOpacity},this.SetOpacity=function(t){this.FOpacity!==t&&(this.FOpacity=t,this.UpdateGradient())},this.UpdateGradient=function(){t.TTMSFNCGraphicsFillGradientItems.isPrototypeOf(this.FCollection)&&rtl.as(this.FCollection,t.TTMSFNCGraphicsFillGradientItems).UpdateGradient()},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FColor=16777215,this.FPosition=0,this.FOpacity=1,this},this.Assign=function(e){t.TTMSFNCGraphicsFillGradientItem.isPrototypeOf(e)?(this.FColor=rtl.as(e,t.TTMSFNCGraphicsFillGradientItem).FColor,this.FOpacity=rtl.as(e,t.TTMSFNCGraphicsFillGradientItem).FOpacity,this.FPosition=rtl.as(e,t.TTMSFNCGraphicsFillGradientItem).FPosition):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("Opacity",14,rtl.double,"FOpacity","SetOpacity",{stored:"IsOpacityStored"}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:16777215}),e.addProperty("Position",14,rtl.double,"FPosition","SetPosition",{stored:"IsPositionStored"})})),rtl.createClass(this,"TTMSFNCGraphicsFillGradientItems",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FOwner$1=null},this.$final=function(){this.FOwner$1=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.UpdateGradient=function(){null!=this.FOwner$1&&this.FOwner$1.Changed()},this.GetGradientClass=function(){return t.TTMSFNCGraphicsFillGradientItem},this.Create$3=function(t){return pas.Classes.TOwnedCollection.Create$2.call(this,t,this.GetGradientClass()),this.FOwner$1=t,this}})),rtl.createClass(this,"TTMSFNCCustomGraphicsFill",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FUpdateCount=0,this.FOnChanged=null,this.FOrientation=0,this.FKind=0,this.FDefaultKind=0,this.FColor=0,this.FDefaultColor=0,this.FColorTo=0,this.FColorMirror=0,this.FColorMirrorTo=0,this.FDefaultColorTo=0,this.FDefaultColorMirror=0,this.FDefaultColorMirrorTo=0,this.FOpacity=0,this.FTexture=null,this.FTextureMode=0,this.FGradientMode=0,this.FGradientItems=null,this.FGradientType=0,this.FGradientAngle=0,this.FGradientCenterPoint=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),this.FGradientCenterColor=0,this.FGradientMatrix=t.TTMSFNCGraphicsMatrix.$new()},this.$final=function(){this.FOnChanged=void 0,this.FTexture=void 0,this.FGradientItems=void 0,this.FGradientCenterPoint=void 0,this.FGradientMatrix=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetKind=function(t){this.FKind!==t&&(this.FKind=t,this.Changed())},this.SetOrientation=function(t){this.FOrientation!==t&&(this.FOrientation=t,this.Changed())},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t,-1===this.FColor?this.FColor=-1:536870912===this.FColor&&(this.FColor=15790320),this.Changed())},this.SetColorTo=function(t){this.FColorTo!==t&&(this.FColorTo=t,-1===this.FColorTo?this.FColorTo=-1:536870912===this.FColorTo&&(this.FColorTo=15790320),this.Changed())},this.SetColorMirror=function(t){this.FColorMirror!==t&&(this.FColorMirror=t,-1===this.FColorMirror?this.FColorMirror=-1:536870912===this.FColorMirror&&(this.FColorMirror=15790320),this.Changed())},this.SetColorMirrorTo=function(t){this.FColorMirrorTo!==t&&(this.FColorMirrorTo=t,-1===this.FColorMirrorTo?this.FColorMirrorTo=-1:536870912===this.FColorMirrorTo&&(this.FColorMirrorTo=15790320),this.Changed())},this.SetTexture=function(t){this.FTexture!==t&&(this.FTexture.Assign(t),this.Changed())},this.SetTextureMode=function(t){this.FTextureMode!==t&&(this.FTextureMode=t,this.Changed())},this.IsColorStored=function(){return this.FColor!==this.FDefaultColor},this.IsKindStored=function(){return this.FKind!==this.FDefaultKind},this.IsColorMirrorStored=function(){return this.FColorMirror!==this.FDefaultColorMirror},this.IsColorMirrorToStored=function(){return this.FColorMirrorTo!==this.FDefaultColorMirrorTo},this.IsColorToStored=function(){return this.FColorTo!==this.FDefaultColorTo},this.Changed=function(){null!=this.FOnChanged&&0===this.FUpdateCount&&this.FOnChanged(this)},this.TextureChanged=function(t){this.Changed()},this.Create$1=function(e,i,s,n,o){return this.FGradientItems=t.TTMSFNCGraphicsFillGradientItems.$create("Create$3",[this]),this.FKind=e,this.FDefaultKind=e,this.FGradientMatrix.$assign(t.MatrixIdentity()),this.FGradientCenterColor=-1,this.FGradientMode=0,this.FGradientAngle=0,this.FGradientCenterPoint.$assign(pas["WEBLib.TMSFNCTypes"].PointF(0,0)),this.FGradientType=0,this.FColor=i,this.FDefaultColor=i,this.FOpacity=1,this.FOrientation=1,this.FColorTo=s,this.FColorMirror=n,this.FColorMirrorTo=o,this.FDefaultColorTo=s,this.FDefaultColorMirror=n,this.FDefaultColorMirrorTo=o,this.FTextureMode=2,this.FTexture=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FTexture.FOnChange=rtl.createCallback(this,"TextureChanged"),this},this.Destroy=function(){rtl.free(this,"FTexture"),rtl.free(this,"FGradientItems"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCustomGraphicsFill.isPrototypeOf(e)?(this.FColor=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FColor,this.FColorTo=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FColorTo,this.FColorMirror=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FColorMirror,this.FColorMirrorTo=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FColorMirrorTo,this.FKind=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FKind,this.FOrientation=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FOrientation,this.FOpacity=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FOpacity,this.FTexture.Assign(rtl.as(e,t.TTMSFNCCustomGraphicsFill).FTexture),this.FTextureMode=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FTextureMode,this.FGradientMode=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FGradientMode,this.FGradientAngle=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FGradientAngle,this.FGradientCenterPoint.$assign(rtl.as(e,t.TTMSFNCCustomGraphicsFill).FGradientCenterPoint),this.FGradientItems.Assign(rtl.as(e,t.TTMSFNCCustomGraphicsFill).FGradientItems),this.FGradientType=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FGradientType,this.FGradientCenterColor=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FGradientCenterColor):t.TTMSFNCCustomGraphicsStroke.isPrototypeOf(e)&&(this.FColor=rtl.as(e,t.TTMSFNCCustomGraphicsStroke).FColor,this.FColorTo=-1,this.FColorMirror=-1,this.FColorMirrorTo=-1,this.FKind=1,this.FOrientation=1,this.FOpacity=1),this.Changed()}})),rtl.createClass(this,"TTMSFNCGraphicsFill",this.TTMSFNCCustomGraphicsFill,(function(){var e=this.$rtti;e.addProperty("OnChanged",0,pas.Classes.$rtti.TNotifyEvent,"FOnChanged","FOnChanged"),e.addProperty("Kind",14,t.$rtti.TTMSFNCGraphicsFillKind,"FKind","SetKind",{stored:"IsKindStored"}),e.addProperty("Orientation",2,t.$rtti.TTMSFNCGraphicsFillOrientation,"FOrientation","SetOrientation",{Default:t.TTMSFNCGraphicsFillOrientation.gfoVertical}),e.addProperty("Color",14,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{stored:"IsColorStored"}),e.addProperty("ColorTo",14,pas["WEBLib.Graphics"].$rtti.TColor,"FColorTo","SetColorTo",{stored:"IsColorToStored"}),e.addProperty("ColorMirror",14,pas["WEBLib.Graphics"].$rtti.TColor,"FColorMirror","SetColorMirror",{stored:"IsColorMirrorStored"}),e.addProperty("ColorMirrorTo",14,pas["WEBLib.Graphics"].$rtti.TColor,"FColorMirrorTo","SetColorMirrorTo",{stored:"IsColorMirrorToStored"}),e.addProperty("TextureMode",2,t.$rtti.TTMSFNCGraphicsTextureMode,"FTextureMode","SetTextureMode",{Default:t.TTMSFNCGraphicsTextureMode.gtmStretch}),e.addProperty("Texture",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FTexture","SetTexture")})),rtl.createClass(this,"TTMSFNCGraphicsFont",pas["WEBLib.Graphics"].TFont,(function(){this.$init=function(){pas["WEBLib.Graphics"].TFont.$init.call(this),this.FUpdateCount=0,this.FOnChanged=null},this.$final=function(){this.FOnChanged=void 0,pas["WEBLib.Graphics"].TFont.$final.call(this)},this.DoChanged=function(t){null!=this.FOnChanged&&0===this.FUpdateCount&&this.FOnChanged(this)},this.Create$2=function(){return pas["WEBLib.Graphics"].TFont.Create$1.call(this),this.SetHeight(-11),this.FOnChange=rtl.createCallback(this,"DoChanged"),this},this.Assign=function(t){pas["WEBLib.Graphics"].TFont.Assign.call(this,t),this.DoChanged(this)},this.AssignSource=function(t){this.Assign(t)}})),this.TTMSFNCAppearanceGlobalFontType={0:"aftNone",aftNone:0,1:"aftColor",aftColor:1,2:"aftSize",aftSize:2,3:"aftName",aftName:3,4:"aftScale",aftScale:4,5:"aftStyle",aftStyle:5},rtl.createInterface(this,"ITMSFNCAppearanceGlobalFont","{85CF4F6B-3FF9-4CB7-AD6A-7FC477ED5462}",["SetFonts"],pas.System.IUnknown),rtl.createClass(this,"TTMSFNCAppearanceGlobalFont",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FColor=0,this.FSize=0,this.FName="",this.FScale=0,this.FOldScale=0,this.FStyle={}},this.$final=function(){this.FOwner=void 0,this.FStyle=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t,this.SetFonts(1))},this.SetSize=function(t){this.FSize!==t&&(this.FSize=t,this.SetFonts(2))},this.SetName=function(t){this.FName!==t&&(this.FName=t,this.SetFonts(3))},this.SetScale=function(t){this.FScale!==t&&(this.FOldScale=this.FScale,this.FScale=t,this.SetFonts(4))},this.SetStyle=function(t){rtl.neSet(this.FStyle,t)&&(this.FStyle=rtl.refSet(t),this.SetFonts(5))},this.SetFonts=function(e){var i=null,s=rtl.createIntfRefs();try{pas.SysUtils.Supports$1(s.ref(1,rtl.queryIntfT(this.FOwner,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCAppearanceGlobalFont),{get:function(){return i},set:function(t){i=t}})&&i.SetFonts(e)}finally{s.free(),rtl._Release(i)}},this.Create$1=function(t){return this.FOwner=t,this.FColor=-1,this.FSize=0,this.FScale=1,this.FName="",this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCAppearanceGlobalFont.isPrototypeOf(e)?(this.SetColor(rtl.as(e,t.TTMSFNCAppearanceGlobalFont).FColor),this.SetSize(rtl.as(e,t.TTMSFNCAppearanceGlobalFont).FSize),this.SetName(rtl.as(e,t.TTMSFNCAppearanceGlobalFont).FName),this.SetScale(rtl.as(e,t.TTMSFNCAppearanceGlobalFont).FScale),this.SetStyle(rtl.refSet(rtl.as(e,t.TTMSFNCAppearanceGlobalFont).FStyle))):pas.Classes.TPersistent.Assign.apply(this,arguments)},this.ApplyChange=function(t,e){if(null!=t){var i=e;1===i?t.SetColor(this.FColor):2===i?t.SetSize(Math.round(this.FSize)):3===i?t.SetName(this.FName):4===i?t.SetHeight(Math.round(t.FHeight*this.FScale/this.FOldScale)):5===i&&t.SetStyle(rtl.refSet(this.FStyle))}};var e=this.$rtti;e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:-1}),e.addProperty("Size",2,rtl.double,"FSize","SetSize"),e.addProperty("Name",2,rtl.string,"FName","SetName"),e.addProperty("Scale",2,rtl.double,"FScale","SetScale"),e.addProperty("Style",2,pas["WEBLib.Graphics"].$rtti.TFontStyles,"FStyle","SetStyle")})),rtl.createClass(this,"TTMSFNCCustomGraphicsStroke",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FUpdateCount=0,this.FOnChanged=null,this.FKind=0,this.FColor=0,this.FWidth=0,this.FOpacity=0,this.FDefaultKind=0,this.FDefaultColor=0},this.$final=function(){this.FOnChanged=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetKind=function(t){this.FKind!==t&&(this.FKind=t,this.Changed())},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t,-1===this.FColor?this.FColor=-1:536870912===this.FColor&&(this.FColor=15790320),this.Changed())},this.SetWidth=function(t){this.FWidth!==t&&(this.FWidth=t,this.Changed())},this.IsWidthStored=function(){return 1!==this.FWidth},this.IsKindStored=function(){return this.FKind!==this.FDefaultKind},this.IsColorStored=function(){return this.FColor!==this.FDefaultColor},this.Changed=function(){null!=this.FOnChanged&&0===this.FUpdateCount&&this.FOnChanged(this)},this.Create$1=function(t,e){return this.FKind=t,this.FDefaultKind=t,this.FColor=e,this.FDefaultColor=e,this.FOpacity=1,this.FWidth=1,this},this.Assign=function(e){t.TTMSFNCCustomGraphicsStroke.isPrototypeOf(e)?(this.FColor=rtl.as(e,t.TTMSFNCCustomGraphicsStroke).FColor,this.FKind=rtl.as(e,t.TTMSFNCCustomGraphicsStroke).FKind,this.FOpacity=rtl.as(e,t.TTMSFNCCustomGraphicsStroke).FOpacity,this.FWidth=rtl.as(e,t.TTMSFNCCustomGraphicsStroke).FWidth):t.TTMSFNCCustomGraphicsFill.isPrototypeOf(e)&&(this.FColor=rtl.as(e,t.TTMSFNCCustomGraphicsFill).FColor,this.FKind=1,this.FOpacity=1,this.FWidth=1),this.Changed()}})),rtl.createClass(this,"TTMSFNCGraphicsStroke",this.TTMSFNCCustomGraphicsStroke,(function(){var e=this.$rtti;e.addProperty("OnChanged",0,pas.Classes.$rtti.TNotifyEvent,"FOnChanged","FOnChanged"),e.addProperty("Kind",14,t.$rtti.TTMSFNCGraphicsStrokeKind,"FKind","SetKind",{stored:"IsKindStored"}),e.addProperty("Color",14,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{stored:"IsColorStored"}),e.addProperty("Width",14,rtl.double,"FWidth","SetWidth",{stored:"IsWidthStored"})})),this.TTMSFNCGraphicsPathPointKind={0:"gppMoveTo",gppMoveTo:0,1:"gppLineTo",gppLineTo:1,2:"gppCurveTo",gppCurveTo:2,3:"gppClose",gppClose:3},this.TTMSFNCGraphicsPathCubicBezier$clone=function(t){var e=[];e.length=4;for(var i=0;i<4;i++)e[i]=pas["WEBLib.TMSFNCTypes"].TPointF.$clone(t[i]);return e},rtl.recNewT(this,"TTMSFNCGraphicsPathPoint",(function(){this.Kind=0,this.$new=function(){var t=Object.create(this);return t.Point=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),t},this.$eq=function(t){return this.Kind===t.Kind&&this.Point.$eq(t.Point)},this.$assign=function(t){return this.Kind=t.Kind,this.Point.$assign(t.Point),this}})),this.TTMSFNCGraphicsPathDrawMode={0:"pdmPolygon",pdmPolygon:0,1:"pdmPolyline",pdmPolyline:1,2:"pdmPath",pdmPath:2},rtl.createClass(this,"TTMSFNCGraphicsPathPoints",pas.Classes.TList,(function(){this.GetItem=function(e){var i=t.TTMSFNCGraphicsPathPoint.$new();return i.$assign(rtl.getObject(this.Get(e))),i},this.SetItem=function(e,i){var s=t.TTMSFNCGraphicsPathPoint.$new();s.$assign(i),this.Put(e,s)}})),rtl.createClass(this,"TTMSFNCGraphicsPath",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FStartPoint=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),this.FClippable=!1,this.FPoints=null},this.$final=function(){this.FStartPoint=void 0,this.FPoints=void 0,pas.Classes.TPersistent.$final.call(this)},this.CalculateBezierCoefficients=function(t,e,i,s,n,o,r){s.set(3*(t[1].X-t[0].X)),r.set(3*(t[1].Y-t[0].Y)),i.set(3*(t[2].X-t[1].X)-s.get()),o.set(3*(t[2].Y-t[1].Y)-r.get()),e.set(t[3].X-t[0].X-s.get()-i.get()),n.set(t[3].Y-t[0].Y-r.get()-o.get())},this.GetCount=function(){return this.FPoints.GetCount()},this.GetPoint=function(e){var i=t.TTMSFNCGraphicsPathPoint.$new();return i.$assign(this.FPoints.GetItem(e)),i},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FPoints=t.TTMSFNCGraphicsPathPoints.$create("Create$1"),this},this.Destroy=function(){rtl.free(this,"FPoints"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){var i=0;if(t.TTMSFNCGraphicsPath.isPrototypeOf(e)){this.FPoints.SetCount(e.GetCount());for(var s=0,n=e.GetCount()-1;s<=n;s++)i=s,this.FPoints.SetItem(i,e.GetPoint(i))}else pas.Classes.TPersistent.Assign.apply(this,arguments)},this.IsPointVisible=function(e){var i=[];return i=rtl.arraySetLength(i,pas["WEBLib.TMSFNCTypes"].TPointF,0),this.FlattenToPolygon({get:function(){return i},set:function(t){i=t}},.25),t.PointInPoly(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(e),rtl.arrayRef(i))},this.PointOnBezier=function(t,e,i,s,n,o,r,a){var l,h,F=pas["WEBLib.TMSFNCTypes"].TPointF.$new();return h=(l=a*a)*a,F.X=e*h+i*l+s*a+t.X,F.Y=n*h+o*l+r*a+t.Y,F},this.CreateBezier=function(t,e){var i,s=[],n=0,o=0,r=0,a=0,l=0,h=0,F=0;if(0===e)return s;i=1/(1*e-1),F=0,s=rtl.arraySetLength(s,pas["WEBLib.TMSFNCTypes"].TPointF,e),this.CalculateBezierCoefficients(t,{get:function(){return n},set:function(t){n=t}},{get:function(){return o},set:function(t){o=t}},{get:function(){return r},set:function(t){r=t}},{get:function(){return a},set:function(t){a=t}},{get:function(){return l},set:function(t){l=t}},{get:function(){return h},set:function(t){h=t}});for(var p=0,c=e-1;p<=c;p++)s[p].$assign(this.PointOnBezier(t[0],n,o,r,a,l,h,F)),F+=i;return s};this.GetBounds=function(){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=0,s=t.TTMSFNCGraphicsPathPoint.$new();if(this.FPoints.GetCount()<1)return pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0);e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(65535,65535,-65535,-65535));for(var n=0,o=this.FPoints.GetCount()-1;n<=o;n++)i=n,s.$assign(this.FPoints.GetItem(i)),3!==s.Kind&&(s.Point.X<e.Left&&(e.Left=s.Point.X),s.Point.X>e.Right&&(e.Right=s.Point.X),s.Point.Y<e.Top&&(e.Top=s.Point.Y),s.Point.Y>e.Bottom&&(e.Bottom=s.Point.Y));return pas.Math.SameValue(e.Right-e.Left,0,.001)&&(e.Right=e.Left+.001),pas.Math.SameValue(e.Bottom-e.Top,0,.001)&&(e.Bottom=e.Top+.001),e},this.MoveTo=function(e){var i=t.TTMSFNCGraphicsPathPoint.$new();i.Kind=0,i.Point.$assign(e),this.FPoints.Add(t.TTMSFNCGraphicsPathPoint.$clone(i)),this.FStartPoint.$assign(this.FPoints.GetItem(this.FPoints.GetCount()-1).Point)},this.LineTo=function(e){var i=t.TTMSFNCGraphicsPathPoint.$new();i.Kind=1,i.Point.$assign(e),this.FPoints.Add(t.TTMSFNCGraphicsPathPoint.$clone(i)),e.X===this.FStartPoint.X&&e.Y===this.FStartPoint.Y&&(this.FClippable=!0)},this.CurveTo=function(e,i,s){var n=t.TTMSFNCGraphicsPathPoint.$new();n.Kind=2,n.Point.$assign(e),this.FPoints.Add(t.TTMSFNCGraphicsPathPoint.$clone(n)),n.Kind=2,n.Point.$assign(i),this.FPoints.Add(t.TTMSFNCGraphicsPathPoint.$clone(n)),n.Kind=2,n.Point.$assign(s),this.FPoints.Add(t.TTMSFNCGraphicsPathPoint.$clone(n))},this.ClosePath=function(){var e=t.TTMSFNCGraphicsPathPoint.$new();e.Kind=3,e.Point.$assign(this.FStartPoint),this.FPoints.Add(t.TTMSFNCGraphicsPathPoint.$clone(e)),this.FClippable=!0},this.AddEllipse=function(t){var e,i,s,n,o;o=.5522847498,e=(t.Left+t.Right)/2,i=(t.Top+t.Bottom)/2,s=o*((t.Right-t.Left)/2),n=o*((t.Bottom-t.Top)/2),this.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left,i)),this.CurveTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left,i-n),pas["WEBLib.TMSFNCTypes"].PointF(e-s,t.Top),pas["WEBLib.TMSFNCTypes"].PointF(e,t.Top)),this.CurveTo(pas["WEBLib.TMSFNCTypes"].PointF(e+s,t.Top),pas["WEBLib.TMSFNCTypes"].PointF(t.Right,i-n),pas["WEBLib.TMSFNCTypes"].PointF(t.Right,i)),this.CurveTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Right,i+n),pas["WEBLib.TMSFNCTypes"].PointF(e+s,t.Bottom),pas["WEBLib.TMSFNCTypes"].PointF(e,t.Bottom)),this.CurveTo(pas["WEBLib.TMSFNCTypes"].PointF(e-s,t.Bottom),pas["WEBLib.TMSFNCTypes"].PointF(t.Left,i+n),pas["WEBLib.TMSFNCTypes"].PointF(t.Left,i)),this.FClippable=!0},this.AddRectangle=function(t,e,i){var s={};0===e&&0===i?(this.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left,t.Top)),this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Right,t.Top)),this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Right,t.Bottom)),this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left,t.Bottom))):(2 in(s=rtl.createSet(0,1,2,3))?(this.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left+e,t.Bottom)),this.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(t.Left+e,t.Bottom-i),pas["WEBLib.TMSFNCTypes"].PointF(e,i),-270,90),this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left,t.Bottom-i))):this.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left,t.Bottom)),0 in s?(this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left,t.Top+i)),this.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(t.Left+e,t.Top+i),pas["WEBLib.TMSFNCTypes"].PointF(e,i),-180,90),this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left+e,t.Top))):this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left,t.Top)),1 in s?(this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Right-e,t.Top)),this.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(t.Right-e,t.Top+i),pas["WEBLib.TMSFNCTypes"].PointF(e,i),-90,90),this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Right,t.Top+i))):this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Right,t.Top)),3 in s?(this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Right,t.Bottom-i)),this.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(t.Right-e,t.Bottom-i),pas["WEBLib.TMSFNCTypes"].PointF(e,i),0,90),this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Right-e,t.Bottom))):this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Right,t.Bottom)),2 in s?this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left+e,t.Bottom)):this.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(t.Left,t.Bottom))),this.ClosePath(),this.FClippable=!0};this.AddArc=function(t,i,s,n){var o=!1,r=0,a=0,l=0,h=!1;if(s=pas.Math.DegToRad(s),n=pas.Math.DegToRad(n),s=s-2*pas.System.Trunc(s/(2*Math.PI))*Math.PI,n>=2*Math.PI&&(n=2*Math.PI),n<=-2*Math.PI&&(n=-2*Math.PI),!(Math.abs(n)<1e-10)){r=0,h=!1,o=!0;do{n<0?(l=r,a=-Math.PI/2,(r-=Math.PI/2)<=n+.01&&(a=n-l,h=!0)):(l=r,a=Math.PI/2,(r+=Math.PI/2)>=n-.01&&(a=n-l,h=!0)),e.DrawArcWithBezier(this,t.X,t.Y,i.X,i.Y,s,a,o),o=!1,s+=a}while(!h)}},this.FlattenToPolygon=function(t,e){function i(e){rtl.length(t.get())>0&&pas.Math.SameValue(e.X,t.get()[rtl.length(t.get())-1].X,.001)&&pas.Math.SameValue(e.Y,t.get()[rtl.length(t.get())-1].Y,.001)||(t.set(rtl.arraySetLength(t.get(),pas["WEBLib.TMSFNCTypes"].TPointF,rtl.length(t.get())+1)),t.get()[rtl.length(t.get())-1].$assign(e))}var s=0,n=0,o=[],r=rtl.arraySetLength(null,pas["WEBLib.TMSFNCTypes"].TPointF,4),a=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),l=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),h=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),F=0,p=0,c=0;if(t.set(rtl.arraySetLength(t.get(),pas["WEBLib.TMSFNCTypes"].TPointF,0)),this.FPoints.GetCount()>0)for(F=Math.max(e,.05),s=0;s<this.FPoints.GetCount();){var u=this.FPoints.GetItem(s).Kind;if(0===u)i(this.FPoints.GetItem(s).Point),l.$assign(this.FPoints.GetItem(s).Point),a.$assign(l);else if(1===u)i(this.FPoints.GetItem(s).Point),l.$assign(this.FPoints.GetItem(s).Point);else if(2===u){r[0].$assign(l),r[1].$assign(this.FPoints.GetItem(s).Point),s+=1,r[2].$assign(this.FPoints.GetItem(s).Point),s+=1,r[3].$assign(this.FPoints.GetItem(s).Point),o=this.CreateBezier(r,6),p=0;for(var T=0,C=rtl.length(o)-1-1;T<=C;T++)n=T,h.X=o[n].X-o[n+1].X,h.Y=o[n].Y-o[n+1].Y,p+=pas["WEBLib.TMSFNCTypes"].GetPointLength(h);if((c=Math.round(p/F))<2)i(r[0]),i(r[3]);else{o=this.CreateBezier(r,c);for(var S=0,d=rtl.length(o)-1;S<=d;S++)i(o[n=S])}l.$assign(this.FPoints.GetItem(s).Point)}else 3===u&&i(a);s+=1}}})),rtl.createClass(this,"TTMSFNCGraphicsColorObject",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FColor=0},this.Create$1=function(t){return this.FColor=t,this}})),this.TTMSFNCGraphicsModifyRectMode={0:"gcrmNone",gcrmNone:0,1:"gcrmExpandAll",gcrmExpandAll:1,2:"gcrmShrinkAll",gcrmShrinkAll:2,3:"gcrmShiftRightAndExpandHeight",gcrmShiftRightAndExpandHeight:3,4:"gcrmShiftDownAndExpandWidth",gcrmShiftDownAndExpandWidth:4,5:"gcrmShiftRightAndShrinkHeight",gcrmShiftRightAndShrinkHeight:5,6:"gcrmShiftRightDown",gcrmShiftRightDown:6,7:"gcrmShiftRightUp",gcrmShiftRightUp:7,8:"gcrmShiftLeftUp",gcrmShiftLeftUp:8,9:"gcrmShiftLeftDown",gcrmShiftLeftDown:9,10:"gcrmShiftUpAndExpandWidth",gcrmShiftUpAndExpandWidth:10,11:"gcrmShiftLeftAndExpandHeight",gcrmShiftLeftAndExpandHeight:11},this.TTMSFNCGraphicsModifyPointMode={0:"gcpmNone",gcpmNone:0,1:"gcpmLeftUp",gcpmLeftUp:1,2:"gcpmRightDown",gcpmRightDown:2,3:"gcpmLeftDown",gcpmLeftDown:3,4:"gcpmRightUp",gcpmRightUp:4},this.TTMSFNCGraphicsExpanderState={0:"gesCollapsed",gesCollapsed:0,1:"gesExpanded",gesExpanded:1},this.TTMSFNCGraphicsCompactState={0:"gcsCollapsed",gcsCollapsed:0,1:"gcsExpanded",gcsExpanded:1},this.TTMSFNCGraphicsCorner={0:"gcTopLeft",gcTopLeft:0,1:"gcTopRight",gcTopRight:1,2:"gcBottomLeft",gcBottomLeft:2,3:"gcBottomRight",gcBottomRight:3},this.$rtti.$Enum("TTMSFNCGraphicsCorner",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCGraphicsCorner}),this.$rtti.$Set("TTMSFNCGraphicsCorners",{comptype:this.$rtti.TTMSFNCGraphicsCorner}),this.ModifyRect=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();i.$assign(t);var s=e;return 1===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)-.5,pas.System.Int(i.Top)-.5,pas.System.Int(i.Right)+.5,pas.System.Int(i.Bottom)+.5)):2===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)+.5,pas.System.Int(i.Top)+.5,pas.System.Int(i.Right)-.5,pas.System.Int(i.Bottom)-.5)):3===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)+.5,pas.System.Int(i.Top)-.5,pas.System.Int(i.Right)+.5,pas.System.Int(i.Bottom)+.5)):6===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)+.5,pas.System.Int(i.Top)+.5,pas.System.Int(i.Right)+.5,pas.System.Int(i.Bottom)+.5)):5===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)+.5,pas.System.Int(i.Top)+.5,pas.System.Int(i.Right)+.5,pas.System.Int(i.Bottom)-.5)):4===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)-.5,pas.System.Int(i.Top)+.5,pas.System.Int(i.Right)+.5,pas.System.Int(i.Bottom)+.5)):10===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)-.5,pas.System.Int(i.Top)-.5,pas.System.Int(i.Right)+.5,pas.System.Int(i.Bottom)-.5)):7===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)+.5,pas.System.Int(i.Top)-.5,pas.System.Int(i.Right)+.5,pas.System.Int(i.Bottom)-.5)):8===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)-.5,pas.System.Int(i.Top)-.5,pas.System.Int(i.Right)-.5,pas.System.Int(i.Bottom)-.5)):9===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)-.5,pas.System.Int(i.Top)+.5,pas.System.Int(i.Right)-.5,pas.System.Int(i.Bottom)+.5)):11===s&&i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)-.5,pas.System.Int(i.Top)-.5,pas.System.Int(i.Right)-.5,pas.System.Int(i.Bottom)+.5)),i},this.MakeGraphicsColor=function(t,e,i){return pas["WEBLib.Graphics"].RGB(t,e,i)},this.Lighter=function(e,i){var s=0,n=0,o=0;return e=pas["WEBLib.Graphics"].ColorToRGB(e),s=pas["WEBLib.Graphics"].GetRValue(e),n=pas["WEBLib.Graphics"].GetGValue(e),o=pas["WEBLib.Graphics"].GetBValue(e),s+=Math.min(255,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.MulDivInt(255-s,i,100)),n+=Math.min(255,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.MulDivInt(255-n,i,100)),o+=Math.min(255,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.MulDivInt(255-o,i,100)),t.MakeGraphicsColor(s,n,o)},this.Darker=function(e,i){var s=0,n=0,o=0;return e=pas["WEBLib.Graphics"].ColorToRGB(e),s=pas["WEBLib.Graphics"].GetRValue(e),n=pas["WEBLib.Graphics"].GetGValue(e),o=pas["WEBLib.Graphics"].GetBValue(e),s-=Math.max(0,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.MulDivInt(255-s,i,100)),n-=Math.max(0,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.MulDivInt(255-n,i,100)),o-=Math.max(0,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.MulDivInt(255-o,i,100)),t.MakeGraphicsColor(s,n,o)},this.Blend=function(t,e,i){var s,n,o,r,a=0,l=0;return i=Math.round(2.55*i),a=255&(s=pas["WEBLib.Graphics"].ColorToRGB(t)),l=255&(n=pas["WEBLib.Graphics"].ColorToRGB(e)),o=Math.max(0,Math.min(255,(i*(a-l)>>>8)+l)),a=255&Math.floor(s/256),l=255&Math.floor(n/256),r=Math.max(0,Math.min(255,(i*(a-l)>>>8)+l)),a=255&Math.floor(s/65536),l=255&Math.floor(n/65536),(Math.max(0,Math.min(255,(i*(a-l)>>>8)+l))<<16)+(r<<8)+o},this.ColorLookup=function(){return e.FColorLookup},this.PointInPoly=function(t,e){var i=!1,s=0,n=0,o=0,r=0,a=0,l=0,h=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),F=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),p=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),c=!1,u=!1,T=0,C=!1;if(i=!1,0===rtl.length(e))return i;s=e[0].X,n=e[0].X,o=e[0].Y,r=e[0].Y;for(var S=1,d=rtl.length(e)-1;S<=d;S++)a=S,h.$assign(e[a]),s=Math.min(h.X,s),n=Math.max(h.X,n),o=Math.min(h.Y,o),r=Math.max(h.Y,r);if(t.X<s||t.X>n||t.Y<o||t.Y>r)return i=!1;c=!1,l=rtl.length(e)-1;for(var m=0,f=rtl.length(e)-1;m<=f;m++)a=m,F.$assign(e[a]),p.$assign(e[l]),u=F.Y>t.Y!=p.Y>t.Y,p.Y-F.Y!=0&&(T=(p.X-F.X)*(t.Y-F.Y)/(p.Y-F.Y)+F.X,C=t.X<T,u&&C&&(c=!c)),l=a;return i=c},this.DrawGradient=function(t,e,i,s,n,o,r){var a,l,h,F,p,c,u,T,C,S,d=0,m=0,f=0,g=0,y=0,b=0,N=0,M=0,B=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),E=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),L=0,D=0;B.$assign(s),0===(M=r?Math.round(B.Right-B.Left):Math.round(B.Bottom-B.Top))&&(M=1),e=pas["WEBLib.Graphics"].ColorToRGB(e),i=pas["WEBLib.Graphics"].ColorToRGB(i),a=255&e,l=Math.floor((65280&e)/256),h=Math.floor((16711680&e)/65536),F=((d=255&i)-a)/M,p=((m=Math.floor((65280&i)/256))-l)/M,c=((f=Math.floor((16711680&i)/65536))-h)/M,y=r?(B.Right-B.Left)/M:(B.Bottom-B.Top)/M,T=t.FBrush.FColor,S=t.FBrush.FStyle,u=t.FPen.FColor,C=t.FPen.FStyle,t.FPen.FStyle=0,t.FBrush.FStyle=0;for(var A=0,$=M-1;A<=$;A++)b=A,d=a+Math.round(F*b),m=l+Math.round(p*b),f=h+Math.round(c*b),N=Math.round(b*y),t.FPen.SetColor(d+(m<<8)+(f<<16)),t.FBrush.FColor=t.FPen.FColor,r?(g=pas.System.Trunc(y),L=B.Left+N+g,L=Math.min(L,B.Right),E.$assign(B),b<=n&&(0 in o||2 in o)?(D=Math.sqrt(Math.pow(n,2)-Math.pow(n-b,2)),0 in o&&(E.Top=E.Top+Math.round(n-D)),2 in o&&(E.Bottom=E.Bottom-Math.round(n-D))):b>=M-n&&(3 in o||1 in o)&&(D=Math.sqrt(Math.pow(n,2)-Math.pow(n-(M-b),2)),1 in o&&(E.Top=E.Top+Math.round(n-D)),3 in o&&(E.Bottom=E.Bottom-Math.round(n-D))),t.Rectangle(E.Left+N,E.Top,L,E.Bottom)):(g=pas.System.Trunc(y),L=B.Top+N+g,L=Math.min(L,B.Bottom),E.$assign(B),b<=n&&(0 in o||1 in o)?(D=Math.sqrt(Math.pow(n,2)-Math.pow(n-b,2)),0 in o&&(E.Left=E.Left+Math.round(n-D)),1 in o&&(E.Right=E.Right-Math.round(n-D))):b>=M-n&&(2 in o||3 in o)&&(D=Math.sqrt(Math.pow(n,2)-Math.pow(n-(M-b),2)),2 in o&&(E.Left=E.Left+Math.round(n-D)),3 in o&&(E.Right=E.Right-Math.round(n-D))),t.Rectangle(E.Left,E.Top+N,E.Right,L));t.FBrush.FColor=T,t.FBrush.FStyle=S,t.FPen.SetColor(u),t.FPen.FStyle=C},this.MatrixIdentity=function(){var e=t.TTMSFNCGraphicsMatrix.$new();return e.m11=1,e.m12=0,e.m13=0,e.m21=0,e.m22=1,e.m23=0,e.m31=0,e.m32=0,e.m33=1,e},t.$implcode=function(){e.FColorLookup=null,e.DrawArcWithBezier=function(t,e,i,s,n,o,r,a){var l,h,F,p,c,u,T=[],C=[],S=0;if(0===r)return a&&(t.FPoints.GetCount()<1?t.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(e+s*Math.cos(o),i-n*Math.sin(o))):t.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(e+s*Math.cos(o),i-n*Math.sin(o)))),void t.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(e+s*Math.cos(o),i-n*Math.sin(o)));for(h=(p=Math.sin(r/2))-(l=4*(1-(F=Math.cos(r/2)))/3)*F/p,u=Math.sin(o+r/2),c=Math.cos(o+r/2),(T=rtl.arraySetLength(T,pas["WEBLib.TMSFNCTypes"].TPointF,4))[0].$assign(pas["WEBLib.TMSFNCTypes"].PointF(F,-p)),T[1].$assign(pas["WEBLib.TMSFNCTypes"].PointF(F+l,-h)),T[2].$assign(pas["WEBLib.TMSFNCTypes"].PointF(F+l,h)),T[3].$assign(pas["WEBLib.TMSFNCTypes"].PointF(F,p)),C=rtl.arraySetLength(C,pas["WEBLib.TMSFNCTypes"].TPointF,4),S=0;S<=3;S++)C[S].$assign(pas["WEBLib.TMSFNCTypes"].PointF(e+s*(T[S].X*c-T[S].Y*u),i+n*(T[S].X*u+T[S].Y*c)));a&&(t.FPoints.GetCount()<1?t.MoveTo(C[0]):t.LineTo(C[0])),t.CurveTo(C[1],C[2],C[3])}},t.$init=function(){e.FColorLookup=pas.Classes.TStringList.$create("Create$1"),e.FColorLookup.AddObject("aliceblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16775408])),e.FColorLookup.AddObject("antiquewhite",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14150650])),e.FColorLookup.AddObject("aqua",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16776960])),e.FColorLookup.AddObject("aquamarine",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13959039])),e.FColorLookup.AddObject("azure",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16777200])),e.FColorLookup.AddObject("beige",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14480885])),e.FColorLookup.AddObject("bisque",t.TTMSFNCGraphicsColorObject.$create("Create$1",[12903679])),e.FColorLookup.AddObject("black",t.TTMSFNCGraphicsColorObject.$create("Create$1",[0])),e.FColorLookup.AddObject("blanchedalmond",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13495295])),e.FColorLookup.AddObject("blue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16711680])),e.FColorLookup.AddObject("blueviolet",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14822282])),e.FColorLookup.AddObject("brown",t.TTMSFNCGraphicsColorObject.$create("Create$1",[2763429])),e.FColorLookup.AddObject("burlywood",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8894686])),e.FColorLookup.AddObject("cadetblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[10526303])),e.FColorLookup.AddObject("chartreuse",t.TTMSFNCGraphicsColorObject.$create("Create$1",[65407])),e.FColorLookup.AddObject("chocolate",t.TTMSFNCGraphicsColorObject.$create("Create$1",[1993170])),e.FColorLookup.AddObject("coral",t.TTMSFNCGraphicsColorObject.$create("Create$1",[5275647])),e.FColorLookup.AddObject("cornflowerblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15570276])),e.FColorLookup.AddObject("cornsilk",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14481663])),e.FColorLookup.AddObject("crimson",t.TTMSFNCGraphicsColorObject.$create("Create$1",[3937500])),e.FColorLookup.AddObject("cyan",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16776960])),e.FColorLookup.AddObject("darkblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9109504])),e.FColorLookup.AddObject("darkcyan",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9145088])),e.FColorLookup.AddObject("darkgoldenrod",t.TTMSFNCGraphicsColorObject.$create("Create$1",[755384])),e.FColorLookup.AddObject("darkgray",t.TTMSFNCGraphicsColorObject.$create("Create$1",[11119017])),e.FColorLookup.AddObject("darkgreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[25600])),e.FColorLookup.AddObject("darkgrey",t.TTMSFNCGraphicsColorObject.$create("Create$1",[11119017])),e.FColorLookup.AddObject("darkkhaki",t.TTMSFNCGraphicsColorObject.$create("Create$1",[7059389])),e.FColorLookup.AddObject("darkmagenta",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9109643])),e.FColorLookup.AddObject("darkolivegreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[3107669])),e.FColorLookup.AddObject("darkorange",t.TTMSFNCGraphicsColorObject.$create("Create$1",[36095])),e.FColorLookup.AddObject("darkorchid",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13382297])),e.FColorLookup.AddObject("darkred",t.TTMSFNCGraphicsColorObject.$create("Create$1",[139])),e.FColorLookup.AddObject("darksalmon",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8034025])),e.FColorLookup.AddObject("darkseagreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9419919])),e.FColorLookup.AddObject("darkslateblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9125192])),e.FColorLookup.AddObject("darkslategray",t.TTMSFNCGraphicsColorObject.$create("Create$1",[5197615])),e.FColorLookup.AddObject("darkslategrey",t.TTMSFNCGraphicsColorObject.$create("Create$1",[5197615])),e.FColorLookup.AddObject("darkturquoise",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13749760])),e.FColorLookup.AddObject("darkviolet",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13828244])),e.FColorLookup.AddObject("deeppink",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9639167])),e.FColorLookup.AddObject("deepskyblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16760576])),e.FColorLookup.AddObject("dimgray",t.TTMSFNCGraphicsColorObject.$create("Create$1",[6908265])),e.FColorLookup.AddObject("dimgrey",t.TTMSFNCGraphicsColorObject.$create("Create$1",[6908265])),e.FColorLookup.AddObject("dodgerblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16748574])),e.FColorLookup.AddObject("firebrick",t.TTMSFNCGraphicsColorObject.$create("Create$1",[2237106])),e.FColorLookup.AddObject("floralwhite",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15792895])),e.FColorLookup.AddObject("forestgreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[2263842])),e.FColorLookup.AddObject("fuchsia",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16711935])),e.FColorLookup.AddObject("gainsboro",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14474460])),e.FColorLookup.AddObject("ghostwhite",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16775416])),e.FColorLookup.AddObject("gold",t.TTMSFNCGraphicsColorObject.$create("Create$1",[55295])),e.FColorLookup.AddObject("goldenrod",t.TTMSFNCGraphicsColorObject.$create("Create$1",[2139610])),e.FColorLookup.AddObject("gray",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8421504])),e.FColorLookup.AddObject("green",t.TTMSFNCGraphicsColorObject.$create("Create$1",[32768])),e.FColorLookup.AddObject("greenyellow",t.TTMSFNCGraphicsColorObject.$create("Create$1",[3145645])),e.FColorLookup.AddObject("grey",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8421504])),e.FColorLookup.AddObject("honeydew",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15794160])),e.FColorLookup.AddObject("hotpink",t.TTMSFNCGraphicsColorObject.$create("Create$1",[11823615])),e.FColorLookup.AddObject("indianred",t.TTMSFNCGraphicsColorObject.$create("Create$1",[6053069])),e.FColorLookup.AddObject("indigo",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8519755])),e.FColorLookup.AddObject("ivory",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15794175])),e.FColorLookup.AddObject("khaki",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9234160])),e.FColorLookup.AddObject("lavender",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16443110])),e.FColorLookup.AddObject("lavenderblush",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16118015])),e.FColorLookup.AddObject("lawngreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[64636])),e.FColorLookup.AddObject("lemonchiffon",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13499135])),e.FColorLookup.AddObject("lightblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15128749])),e.FColorLookup.AddObject("lightcoral",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8421616])),e.FColorLookup.AddObject("lightcyan",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16777184])),e.FColorLookup.AddObject("lightgoldenrodyellow",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13826810])),e.FColorLookup.AddObject("lightgray",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13882323])),e.FColorLookup.AddObject("lightgreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9498256])),e.FColorLookup.AddObject("lightgrey",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13882323])),e.FColorLookup.AddObject("lightpink",t.TTMSFNCGraphicsColorObject.$create("Create$1",[12695295])),e.FColorLookup.AddObject("lightsalmon",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8036607])),e.FColorLookup.AddObject("lightseagreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[11186720])),e.FColorLookup.AddObject("lightskyblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16436871])),e.FColorLookup.AddObject("lightslategray",t.TTMSFNCGraphicsColorObject.$create("Create$1",[10061943])),e.FColorLookup.AddObject("lightslategrey",t.TTMSFNCGraphicsColorObject.$create("Create$1",[10061943])),e.FColorLookup.AddObject("lightsteelblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14599344])),e.FColorLookup.AddObject("lightyellow",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14745599])),e.FColorLookup.AddObject("lime",t.TTMSFNCGraphicsColorObject.$create("Create$1",[65280])),e.FColorLookup.AddObject("limegreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[3329330])),e.FColorLookup.AddObject("linen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15134970])),e.FColorLookup.AddObject("magenta",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16711935])),e.FColorLookup.AddObject("maroon",t.TTMSFNCGraphicsColorObject.$create("Create$1",[128])),e.FColorLookup.AddObject("mediumaquamarine",t.TTMSFNCGraphicsColorObject.$create("Create$1",[11193702])),e.FColorLookup.AddObject("mediumblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13434880])),e.FColorLookup.AddObject("mediumorchid",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13850042])),e.FColorLookup.AddObject("mediumpurple",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14381203])),e.FColorLookup.AddObject("mediumseagreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[7451452])),e.FColorLookup.AddObject("mediumslateblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15624315])),e.FColorLookup.AddObject("mediumspringgreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[10156544])),e.FColorLookup.AddObject("mediumturquoise",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13422920])),e.FColorLookup.AddObject("mediumvioletred",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8721863])),e.FColorLookup.AddObject("midnightblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[7346457])),e.FColorLookup.AddObject("mintcream",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16449525])),e.FColorLookup.AddObject("mistyrose",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14804223])),e.FColorLookup.AddObject("moccasin",t.TTMSFNCGraphicsColorObject.$create("Create$1",[11920639])),e.FColorLookup.AddObject("navajowhite",t.TTMSFNCGraphicsColorObject.$create("Create$1",[11394815])),e.FColorLookup.AddObject("navy",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8388608])),e.FColorLookup.AddObject("oldlace",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15136253])),e.FColorLookup.AddObject("olive",t.TTMSFNCGraphicsColorObject.$create("Create$1",[32896])),e.FColorLookup.AddObject("olivedrab",t.TTMSFNCGraphicsColorObject.$create("Create$1",[2330219])),e.FColorLookup.AddObject("orange",t.TTMSFNCGraphicsColorObject.$create("Create$1",[42495])),e.FColorLookup.AddObject("orangered",t.TTMSFNCGraphicsColorObject.$create("Create$1",[17919])),e.FColorLookup.AddObject("orchid",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14053594])),e.FColorLookup.AddObject("palegoldenrod",t.TTMSFNCGraphicsColorObject.$create("Create$1",[11200750])),e.FColorLookup.AddObject("palegreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[10025880])),e.FColorLookup.AddObject("paleturquoise",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15658671])),e.FColorLookup.AddObject("palevioletred",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9662683])),e.FColorLookup.AddObject("papayawhip",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14020607])),e.FColorLookup.AddObject("peachpuff",t.TTMSFNCGraphicsColorObject.$create("Create$1",[12180223])),e.FColorLookup.AddObject("peru",t.TTMSFNCGraphicsColorObject.$create("Create$1",[4163021])),e.FColorLookup.AddObject("pink",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13353215])),e.FColorLookup.AddObject("plum",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14524637])),e.FColorLookup.AddObject("powderblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15130800])),e.FColorLookup.AddObject("purple",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8388736])),e.FColorLookup.AddObject("red",t.TTMSFNCGraphicsColorObject.$create("Create$1",[255])),e.FColorLookup.AddObject("rosybrown",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9408444])),e.FColorLookup.AddObject("royalblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14772545])),e.FColorLookup.AddObject("saddlebrown",t.TTMSFNCGraphicsColorObject.$create("Create$1",[1262987])),e.FColorLookup.AddObject("salmon",t.TTMSFNCGraphicsColorObject.$create("Create$1",[7504122])),e.FColorLookup.AddObject("sandybrown",t.TTMSFNCGraphicsColorObject.$create("Create$1",[6333684])),e.FColorLookup.AddObject("seagreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[5737262])),e.FColorLookup.AddObject("seashell",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15660543])),e.FColorLookup.AddObject("sienna",t.TTMSFNCGraphicsColorObject.$create("Create$1",[2970272])),e.FColorLookup.AddObject("skyblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15453831])),e.FColorLookup.AddObject("slateblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13458026])),e.FColorLookup.AddObject("slategray",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9470064])),e.FColorLookup.AddObject("slategrey",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9470064])),e.FColorLookup.AddObject("snow",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16448255])),e.FColorLookup.AddObject("springgreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8388352])),e.FColorLookup.AddObject("steelblue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[11829830])),e.FColorLookup.AddObject("violet",t.TTMSFNCGraphicsColorObject.$create("Create$1",[15631086])),e.FColorLookup.AddObject("thistle",t.TTMSFNCGraphicsColorObject.$create("Create$1",[14204888])),e.FColorLookup.AddObject("tan",t.TTMSFNCGraphicsColorObject.$create("Create$1",[9221330])),e.FColorLookup.AddObject("tomato",t.TTMSFNCGraphicsColorObject.$create("Create$1",[4678655])),e.FColorLookup.AddObject("turquoise",t.TTMSFNCGraphicsColorObject.$create("Create$1",[13688896])),e.FColorLookup.AddObject("wheat",t.TTMSFNCGraphicsColorObject.$create("Create$1",[11788021])),e.FColorLookup.AddObject("whitesmoke",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16119285])),e.FColorLookup.AddObject("yellowgreen",t.TTMSFNCGraphicsColorObject.$create("Create$1",[3329434])),e.FColorLookup.AddObject("red",t.TTMSFNCGraphicsColorObject.$create("Create$1",[255])),e.FColorLookup.AddObject("black",t.TTMSFNCGraphicsColorObject.$create("Create$1",[0])),e.FColorLookup.AddObject("blue",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16711680])),e.FColorLookup.AddObject("green",t.TTMSFNCGraphicsColorObject.$create("Create$1",[32768])),e.FColorLookup.AddObject("aqua",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16776960])),e.FColorLookup.AddObject("yellow",t.TTMSFNCGraphicsColorObject.$create("Create$1",[65535])),e.FColorLookup.AddObject("fuchsia",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16711935])),e.FColorLookup.AddObject("white",t.TTMSFNCGraphicsColorObject.$create("Create$1",[16777215])),e.FColorLookup.AddObject("lime",t.TTMSFNCGraphicsColorObject.$create("Create$1",[65280])),e.FColorLookup.AddObject("silver",t.TTMSFNCGraphicsColorObject.$create("Create$1",[12632256])),e.FColorLookup.AddObject("gray",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8421504])),e.FColorLookup.AddObject("olive",t.TTMSFNCGraphicsColorObject.$create("Create$1",[32896])),e.FColorLookup.AddObject("navy",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8388608])),e.FColorLookup.AddObject("purple",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8388736])),e.FColorLookup.AddObject("teal",t.TTMSFNCGraphicsColorObject.$create("Create$1",[8421376])),e.FColorLookup.AddObject("orange",t.TTMSFNCGraphicsColorObject.$create("Create$1",[42495])),e.FColorLookup.AddObject("maroon",t.TTMSFNCGraphicsColorObject.$create("Create$1",[128])),e.FColorLookup.Sort()}}),["WEBLib.TMSFNCUtils","SysUtils","Math"]),rtl.module("WEBLib.TMSFNCHTMLEngine",["System","Classes","WEBLib.TMSFNCGraphics","Types","WEBLib.Graphics","WEBLib.TMSFNCTypes","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCGraphicsTypes"],(function(){"use strict";var t=this,e=t.$impl;this.TMSFNCHTMLENGINE_ATTR_DELIM='"';this.HTMLDrawEx$1=function(i,s,n,o,r,a,l,h,F,p,c,u,T,C,S,d,m,f,g,y,b,N,M,B,E,L,D,A,$,I,P,v,G,w,O,W,R,x,k,V,H,U){var z,j,K,J=!1,Y="",X=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),q=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),Q=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),_=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),Z=0,tt=0,et=0,it=0,st=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),nt=0,ot=0,rt=null,at=0,lt=null,ht=0,Ft=null,pt=0,ct=0,ut=null,Tt=0,Ct=0,St=0,dt=null,mt=0,ft=!1,gt=!1,yt=!1,bt=!1,Nt=!1,Mt=!1,Bt=0,Et=0,Lt=0,Dt=0,At=0,$t="",It="",Pt="",vt=pas.Types.TPoint.$new(),Gt=!1,wt=!1,Ot=!1,Wt=!1,Rt=0,xt=0,kt=0,Vt=0,Ht=0,Ut=0,zt=!1,jt=!1,Kt=0,Jt={},Yt=0,Xt=0,qt=0,Qt=0,_t=0,Zt=0,te=0,ee=!1,ie=pas.Types.TRect.$new(),se=pas.Types.TPoint.$new(),ne=0,oe=0,re=0;function ae(i,s,o,r,p,c,D,O,W,x,z,j,K,J,Y,X,q,Z,tt){var et="",st="",nt="",ot="",lt="",ht="",Ft=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),pt=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),ut={},Tt=!1,dt=!1,mt=!1,ft=0,gt=0,bt=0,It=0,Rt=0,xt=0,kt=0,Vt=0,Ht=0,jt=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),qt=0,te=0,ie=0,ne=0,oe=null,ae=!1,le=0,he=0,Fe=0,pe=0,ce=0,ue="",Te=!1,Ce=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),Se=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),de="",me="",fe="",ge="",ye="",be="",Ne="";for("","",ce=0,o.Bottom=o.Bottom-D.get(),p.set(0),kt=0,Tt=!1,dt=!1,mt=!1,J.set(!1),Y.set(!1),Ft.$assign(o),st="",r||(Ft.Left=Ft.Left+X),Ot&&!r&&(Et=i.FStroke.FColor,i.FStroke.SetColor(i.FFill.FColor),i.FFill.SetKind(0),i.FStroke.SetKind(1),i.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(n.Left,o.Top,n.Right,o.Top+c.get())),2));s.get().length>0&&!Tt&&!dt;){for(qt=pas.System.Pos("<",s.get()),te=S?pas.System.Pos(" ",s.get()):0,pe=(et=qt>0&&(te>qt||0===te)?pas.System.Copy(s.get(),1,qt-1):te>0?pas.System.Copy(s.get(),1,te):s.get()).length;pas.System.Pos("&nbsp;",et)>0;)pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.TagReplaceString("&nbsp;"," ",{get:function(){return et},set:function(t){et=t}});for(;pas.System.Pos("&lt;",et)>0;)pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.TagReplaceString("&lt;","<",{get:function(){return et},set:function(t){et=t}});for(;pas.System.Pos("&gt;",et)>0;)pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.TagReplaceString("&gt;",">",{get:function(){return et},set:function(t){et=t}});if(pe>0&&(jt.$assign(i.CalculateText(et,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),!1,!1)),Vt=jt.Bottom-jt.Top,wt&&D.get()<Vt/4&&D.set(Vt/4),Gt&&O.get()<Vt/4&&O.set(Vt/4),Vt>c.get()&&c.set(Vt),B.set(B.get()+et),zt&&pas.System.Delete(s,1,pe),!zt)){if(r)Ft.$assign(o),jt.$assign(i.CalculateText(et,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),!1,!1)),Ft.Right=Ft.Left+(jt.Right-jt.Left),K>Ft.Top&&K<Ft.Bottom&&j>p.get()&&((Kt=0)===pe?pe:Kt),ce=Ft.Right-Ft.Left,p.set(p.get()+ce),j-Ft.Left>=p.get()-ce&&j-Ft.Left<=p.get()&&yt&&(J.set(!0),K>Ft.Top&&(M.set($t),Nt=!0));else{if(Gt&&(Ft.Bottom=Ft.Bottom-O.get()),wt&&(Ft.Bottom=Ft.Bottom+D.get()),Ft.Bottom=Ft.Bottom-W.get(),jt.$assign(i.CalculateText(et,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),!1,!1)),Ht=jt.Right-jt.Left,-1!==Ct&&(i.FFill.SetColor(Ct),i.FStroke.SetColor(Ct),i.FFill.SetKind(1),i.FStroke.SetKind(1),jt.$assign(i.CalculateText$1("gh")),i.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(Ft.Left,Ft.Top,Ft.Left+Ht,Ft.Top+(jt.Bottom-jt.Top))),2)),Ct=-1,Wt&&(pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(Ft,h,h),i.FFont.SetColor(N),i.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(Ft),et,!1,1,0,0,0,-1,-1,!1,!1,-1,-1),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(Ft,-h,-h),i.FFont.SetColor(at)),ht=""!==et&&" "===et.charAt(et.length-1)&&yt?et+"\0":et,i.FFont.SetColor(ct),i.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(Ft),ht,!1,1,0,0,0,-1,-1,!1,!1,-1,-1),Ft.Right=Ft.Left+Ht,yt&&A.get()-1===a&&E.set($t),Mt)for(i.FStroke.SetColor(255),i.FStroke.SetKind(1),i.FStroke.SetWidth(1),ie=(ne=Math.round(Ft.Left/2*2))%4==0?2:0;ne<Ft.Right;)Ce.$assign(pas["WEBLib.TMSFNCTypes"].PointF(ne,o.Bottom+ie-1)),ie=2===ie?0:2,Se.$assign(pas["WEBLib.TMSFNCTypes"].PointF(ne+2,o.Bottom+ie-1)),i.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(Ce),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(Se),2,2),ne+=2;Ft.Left=Ft.Right,Ft.Right=o.Right,Ft.Bottom=o.Bottom,Ft.Top=o.Top}Te=p.get()<o.Right-o.Left-Zt+1||o.Right-o.Left-Zt<=ce,et,Te||!S?(st+=pas.System.Copy(s.get(),1,pe),pas.System.Delete(s,1,pe),et.length>=pe&&" "===pas.System.Copy(et,pe,1)?(jt.$assign(i.CalculateText$1(" ")),kt=jt.Right-jt.Left):kt=0):(Tt=!0,p.set(p.get()-ce))}if(1===(qt=pas.System.Pos("<",s.get()))&&s.get().length<=2&&s.set(""),!Tt&&1===qt&&s.get().length>2){if("/"===s.get().charAt(1)&&s.get().length>3){var Me=pas.System.upcase(s.get().charAt(2));"A"===Me?(C&&l!==A.get()||r||(i.FFont.SetStyle(rtl.diffSet(i.FFont.FStyle,rtl.createSet(3))),-1!==y&&(Ct=y),-1!==b&&(ct=b)),u||(ct=at),yt=!1,Nt&&(Q.Bottom=o.Bottom,Q.Right=o.Left+p.get(),o.Top!==Q.Top&&(Q.Left=o.Left,Q.Top=o.Top),I.$assign(Q),$.set(A.get()),Nt=!1),a===A.get()-1&&(_.Right=Ft.Left,_.Bottom=Ft.Bottom-W.get(),jt.$assign(i.CalculateText$1("gh")),_.Top=_.Bottom-(jt.Bottom-jt.Top),pas["WEBLib.TMSFNCTypes"].InflateRectEx(_,1,0))):"E"===Me?r||(Mt=!1):"B"===Me?">"!==s.get().charAt(3)?ct=at:i.FFont.SetStyle(rtl.diffSet(i.FFont.FStyle,rtl.createSet(0))):"S"===Me?"U"===(ue=pas.System.upcase(s.get().charAt(3)))?(Gt=!1,wt=!1):"H"===ue?Wt=!1:i.FFont.SetStyle(rtl.diffSet(i.FFont.FStyle,rtl.createSet(2))):"F"===Me?(i.FFont.SetName(rt.FName),i.FFont.SetSize(rt.FSize),r||u||(ct=at,i.FFill.SetColor(St))):"H"===Me?r||(ct=Dt,Ct=At,i.FFont.SetStyle(rtl.refSet(Jt)),i.FFill.SetColor(At)):"I"===Me?i.FFont.SetStyle(rtl.diffSet(i.FFont.FStyle,rtl.createSet(1))):"L"===Me?Tt=!0:"O"===Me?q.set(0):"P"===Me?(Tt=!0,r||(i.FFill.SetColor(Bt),Ot=!1)):"U"===Me?">"!==s.get().charAt(3)&&Ut>0?Ut-=1:i.FFont.SetStyle(rtl.diffSet(i.FFont.FStyle,rtl.createSet(3))):"R"===Me||"Z"===Me&&(zt=!1)}else{var Be=pas.System.upcase(s.get().charAt(1));if("A"===Be)a!==A.get()||r||(_.Left=Ft.Left,_.Top=Ft.Top),A.set(A.get()+1),C&&l!==A.get()||r||(k&&i.FFont.SetStyle(rtl.unionSet(i.FFont.FStyle,rtl.createSet(3))),-1===y||r||(Ct=y),-1!==b&&(ct=b)),u||-1!==b&&l===A.get()&&C||(at=ct,ct=g),nt=pas.System.Copy(s.get(),3,pas.System.Pos(">",s.get())-1),ot=pas.System.Copy(nt,pas.System.Pos('"',nt)+1,nt.length),ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1),$t=ot,yt=!0,Q.Left=p.get(),Q.Top=o.Top;else if("B"===Be){var Ee=ue=pas.System.upcase(s.get().charAt(2));if(">"===Ee)i.FFont.SetStyle(rtl.unionSet(i.FFont.FStyle,rtl.createSet(0)));else if("R"===Ee)Tt=!0,B.set(B.get()+"\r");else if("L"===Ee)T||(ct=Lt);else if("O"===Ee&&(bt=0,st+=pas.System.Copy(s.get(),1,pas.System.Pos(">",s.get())),!r&&!u)){if(nt=pas.SysUtils.UpperCase(pas.System.Copy(s.get(),6,pas.System.Pos(">",s.get())-1)),pas.System.Pos("BACKGROUND",nt)>0&&(ot=pas.System.Copy(nt,pas.System.Pos("BACKGROUND",nt)+10,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1),pas.System.Pos("IDX:",pas.SysUtils.UpperCase(ot))>0&&pas.System.Delete({get:function(){return ot},set:function(t){ot=t}},1,4),oe=null,ae=!1,0===pas.System.Pos(":",ot)&&null!=R&&(oe=R.FindBitmap$1(ot)),pas.System.Pos("URL://",pas.SysUtils.UpperCase(ot))>0&&(pas.System.Delete({get:function(){return ot},set:function(t){ot=t}},1,6),oe=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromURL(ot),ae=!0),null!=oe)){if(!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(oe)&&oe.GetWidth()>0&&oe.GetHeight()>0)for(;bt<n.Bottom-n.Top;){for(gt=0;gt<n.Right-n.Left;)i.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(n.Left+gt),Math.round(n.Top+bt),Math.round(n.Left+gt)+oe.GetWidth(),Math.round(n.Top+bt)+oe.GetHeight())),oe,!0,!1,!0,!1),gt+=oe.GetWidth();bt+=oe.GetHeight()}ae&&(oe=rtl.freeLoc(oe))}pas.System.Pos("BGTOPLEFT",nt)>0&&(ot=pas.System.Copy(nt,pas.System.Pos("BGTOPLEFT",nt)+10,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1),oe=null,0===pas.System.Pos(":",ot)&&null!=R&&(oe=R.FindBitmap$1(ot)),null!=oe&&!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(oe)&&oe.GetWidth()>0&&oe.GetHeight()>0&&i.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(n.Left),Math.round(n.Top+bt),Math.round(n.Left)+oe.GetWidth(),Math.round(n.Top)+oe.GetHeight())),oe,!0,!1,!0,!1)),pas.System.Pos("BGTOPRIGHT",nt)>0&&(ot=pas.System.Copy(nt,pas.System.Pos("BGTOPRIGHT",nt)+10,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1),oe=null,0===pas.System.Pos(":",ot)&&null!=R&&(oe=R.FindBitmap$1(ot)),null!=oe&&!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(oe)&&oe.GetWidth()>0&&oe.GetHeight()>0&&i.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(n.Right)-oe.GetWidth(),Math.round(n.Top+bt),Math.round(n.Right),Math.round(n.Top)+oe.GetHeight())),oe,!0,!1,!0,!1)),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("BGCOLOR",nt,{get:function(){return qt},set:function(t){qt=t}})>0&&(ot=pas.System.Copy(nt,qt+5,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),le=-1,(ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1)).length>0&&(le="#"===ot.charAt(0)?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor(ot):pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.TextToColor(pas.SysUtils.LowerCase(ot))),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("BGCOLORTO",nt,{get:function(){return qt},set:function(t){qt=t}})>0?(ot=pas.System.Copy(nt,qt+5,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1),ot="H",pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("DIR",nt,{get:function(){return qt},set:function(t){qt=t}})>0&&(ot=pas.System.Copy(nt,qt+3,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1)),i.FStroke.SetColor(le)):(St=i.FFill.FColor,i.FFill.SetColor(le),Et=i.FStroke.FColor,i.FStroke.SetColor(le),i.FFill.SetKind(1),i.FStroke.SetKind(1),i.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(n.Left-2,n.Top,n.Right,n.Bottom)),2),i.FStroke.SetColor(Et)))}}else if("E"===Be)r||(Mt=!0);else if("C"===Be)nt=pas.System.Copy(s.get(),9,pas.System.Pos(">",s.get())-1),de="",ge="",ye="",me="",fe="",be="",Ne="",t.ParseControl(nt,{get:function(){return de},set:function(t){de=t}},{get:function(){return ge},set:function(t){ge=t}},{get:function(){return ye},set:function(t){ye=t}},{get:function(){return me},set:function(t){me=t}},{get:function(){return fe},set:function(t){fe=t}},{get:function(){return be},set:function(t){be=t}},{get:function(){return Ne},set:function(t){Ne=t}}),it=25,""!==fe&&(pas.System.val$8(fe,{get:function(){return it},set:function(t){it=t}},{get:function(){return xt},set:function(t){xt=t}}),0!==xt&&(it=25)),""===me&&"CHECK"!==de&&"RADIO"!==de||(pas.System.val$6(me,{get:function(){return ft},set:function(t){ft=t}},{get:function(){return xt},set:function(t){xt=t}}),0===xt&&(vt.x=ft,vt.y=Math.round(i.CalculateTextHeight$1("gh"))+10),"CHECK"===de||"RADIO"===de?c.set(16):c.set(23),it>25&&c.set(it-2),r||("CHECK"===de&&(vt.x=Math.round(16*f)+2,vt.y=vt.x,ft=vt.x,pt.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Ft.Left+1,Ft.Top+(Ft.Bottom-Ft.Top-(vt.y-2))/2,Ft.Left+vt.x-1,Ft.Top+(Ft.Bottom-Ft.Top-(vt.y-2))/2+(vt.y-2))),pt.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(pt.Left),Math.round(pt.Top),Math.round(pt.Right),Math.round(pt.Bottom))),i.DrawCheckBox(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pt),"TRUE"===pas.SysUtils.UpperCase(ye),d&&m===ge,!0,1)),"RADIO"===de&&(vt.x=Math.round(16*f)+2,vt.y=vt.x,ft=vt.x,pt.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Ft.Left+1,Ft.Top+(Ft.Bottom-Ft.Top-(vt.y-2))/2,Ft.Left+vt.x-1,Ft.Top+(Ft.Bottom-Ft.Top-(vt.y-2))/2+(vt.y-2))),pt.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(pt.Left),Math.round(pt.Top),Math.round(pt.Right),Math.round(pt.Bottom))),i.DrawRadioButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pt),"TRUE"===pas.SysUtils.UpperCase(ye),d&&m===ge,!0,1)),"BUTTON"===de&&(vt.y=22,pt.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Ft.Left+2,Ft.Top+(Ft.Bottom-Ft.Top-vt.y)/2,Ft.Left+ft-2,Ft.Top+(Ft.Bottom-Ft.Top-vt.y)/2+vt.y)),ee=pas["WEBLib.TMSFNCTypes"].PtInRectEx(pt,pas["WEBLib.TMSFNCTypes"].PointF(j,K)),pt.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(pt.Left),Math.round(pt.Top),Math.round(pt.Right),Math.round(pt.Bottom))),i.DrawButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pt),d&&m===ge,ee,!0,!0,1),pas["WEBLib.TMSFNCTypes"].InflateRectEx(pt,-2,-2),i.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pt),ye,!1,0,0,0,0,-1,-1,!0,!1,-1,-1))),"BUTTON"===de&&(vt.y=22),"COMBO"===de&&(vt.y=25),"CHECK"!==de&&"RADIO"!==de||(vt.x=Math.round(16*f)+2,vt.y=vt.x),(j-o.Left>p.get()&&j-o.Left<p.get()+vt.x&&K>Ft.Top&&K<Ft.Top+vt.y||F&&v.get()===ge)&&(Y.set(!0),M.set("ctrl"),Yt=Xt,pt.Left=o.Left+p.get(),pt.Right=pt.Left+vt.x,pt.Top=Ft.Top,pt.Bottom=Ft.Top+vt.y,P.$assign(pt),G.set(ye),v.set(ge),w.set(de)),p.get()+vt.x>o.Right-o.Left&&vt.x<o.Right-o.Left?dt=!0:(p.set(p.get()+vt.x),Ft.Left=Ft.Left+vt.x,vt.y>c.get()&&c.set(vt.y)));else if("H"===Be){var Le=pas.System.upcase(s.get().charAt(2));"R"===Le?(Tt=!0,r||(nt=pas.System.Copy(s.get(),4,pas.System.Pos(">",s.get())-1),le=0,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("COLOR",pas.SysUtils.UpperCase(nt),{get:function(){return qt},set:function(t){qt=t}})>0&&(ot=pas.System.Copy(nt,qt+5,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),(ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1)).length>0&&(le="#"===ot.charAt(0)?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor(ot):pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.TextToColor(pas.SysUtils.LowerCase(ot)))),i.FStroke.SetKind(1),Et=i.FStroke.FColor,i.FStroke.SetColor(le),Ce.$assign(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,Ft.Bottom+1)),Se.$assign(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,Ft.Bottom+1)),i.FStroke.SetKind(1),i.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(Ce),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(Se),2,2),i.FStroke.SetColor(Et))):"I"===Le&&(r||(Dt=ct,At=Ct,Jt=rtl.refSet(i.FFont.FStyle),Ct=V,ct=H),i.FFont.SetStyle(rtl.refSet(U)))}else if("I"===Be)">"===(ue=pas.System.upcase(s.get().charAt(2)))?i.FFont.SetStyle(rtl.unionSet(i.FFont.FStyle,rtl.createSet(1))):"N"===ue?(nt=pas.System.Copy(s.get(),3,pas.System.Pos(">",s.get())-1),ot=pas.System.Copy(nt,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IPos("x",nt)+2,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1),pas.System.val$6(ot,{get:function(){return ft},set:function(t){ft=t}},{get:function(){return xt},set:function(t){xt=t}}),0===xt&&ft>p.get()&&(p.set(ft),Ft.Left=n.Left+ft)):"M"===ue&&(0,0,re=0,Math.round(i.CalculateTextHeight$1("gh")),Xt+=1,pt.$assign(Ft),nt=pas.System.Copy(s.get(),3,pas.System.Pos(">",s.get())-1),ot=pas.System.Copy(nt,pas.System.Pos("SRC",pas.SysUtils.UpperCase(nt))+4,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1),nt=pas.SysUtils.UpperCase(nt),pas.System.Pos("ALT",nt)>0&&Yt===Xt&&(ot=pas.System.Copy(nt,pas.System.Pos("ALT",nt)+4,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1)),he=0,Fe=0,pas.System.Pos("WIDTH",nt)>0&&(lt=pas.System.Copy(nt,pas.System.Pos("WIDTH",nt)+6,nt.length),lt=pas.System.Copy(lt,pas.System.Pos('"',lt)+1,lt.length),lt=pas.System.Copy(lt,1,pas.System.Pos('"',lt)-1),pas.System.val$6(lt,{get:function(){return he},set:function(t){he=t}},{get:function(){return xt},set:function(t){xt=t}})),pas.System.Pos("HEIGHT",nt)>0&&(lt=pas.System.Copy(nt,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IPos("HEIGHT",nt)+7,nt.length),lt=pas.System.Copy(lt,pas.System.Pos('"',lt)+1,lt.length),lt=pas.System.Copy(lt,1,pas.System.Pos('"',lt)-1),pas.System.val$6(lt,{get:function(){return Fe},set:function(t){Fe=t}},{get:function(){return xt},set:function(t){xt=t}})),pas.System.Pos("ALIGN",nt)>0&&(lt=pas.System.Copy(nt,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IPos("ALIGN",nt)+6,nt.length),lt=pas.System.Copy(lt,pas.System.Pos('"',lt)+1,lt.length),"MIDDLE"===(lt=pas.System.Copy(lt,1,pas.System.Pos('"',lt)-1))&&1,"TOP"===lt&&2),pas.System.Pos("FLOAT",nt)>0&&(lt=pas.System.Copy(nt,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IPos("FLOAT",nt)+6,nt.length),lt=pas.System.Copy(lt,pas.System.Pos('"',lt)+1,lt.length),"LEFT"===(lt=pas.System.Copy(lt,1,pas.System.Pos('"',lt)-1))&&(re=1,pt.Left=n.Left),"RIGHT"===lt&&(re=2)),vt.x=0,vt.y=0,pas.System.Pos("IDX:",pas.SysUtils.UpperCase(ot))>0&&pas.System.Delete({get:function(){return ot},set:function(t){ot=t}},1,4),oe=null,ae=!1,0===pas.System.Pos(":",ot)&&null!=R&&(oe=R.FindBitmap$1(ot)),pas.System.Pos("URL://",pas.SysUtils.UpperCase(ot))>0&&(pas.System.Delete({get:function(){return ot},set:function(t){ot=t}},1,6),oe=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromURL(ot),ae=!0),pas.System.Pos("DATA:",pas.SysUtils.UpperCase(ot))>0&&pas.System.Pos("BASE64,",pas.SysUtils.UpperCase(ot))>0&&(pas.System.Delete({get:function(){return ot},set:function(t){ot=t}},1,pas.System.Pos("BASE64,",pas.SysUtils.UpperCase(ot))+6),oe=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.LoadBitmapFromBase64(ot,oe,!1),ae=!0),It=0,Rt=0,null!=oe&&(pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(oe)||(he>0&&Fe>0&&(It=he,Rt=Fe),he>0&&0===Fe&&(It=he,Rt=Math.round(he/oe.GetWidth()*oe.GetHeight())),0===he&&Fe>0&&(It=Math.round(Fe/oe.GetHeight()*oe.GetWidth()),Rt=Fe),0===he&&0===Fe&&(It=oe.GetWidth(),Rt=oe.GetHeight()),2===re&&(pt.Left=o.Right-It),r||(he>0||Fe>0?i.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(pt.Left),Math.round(pt.Top),Math.round(pt.Left)+It,Math.round(pt.Top)+Rt)),oe,!0,!1,!0,!1):he>0&&0===Fe?i.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(pt.Left),Math.round(pt.Top),Math.round(pt.Left)+he,Math.round(pt.Top)+Fe)),oe,!0,!1,!0,!1):i.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(pt.Left),Math.round(pt.Top),Math.round(pt.Left)+oe.GetWidth(),Math.round(pt.Top)+oe.GetHeight())),oe,!0,!1,!0,!1)),he>0||Fe>0?(vt.x=It,vt.y=Rt):(vt.x=oe.GetWidth(),vt.y=oe.GetHeight())),ae&&(oe=rtl.freeLoc(oe))),j-o.Left>p.get()&&j-o.Left<p.get()+vt.x&&K>Ft.Top&&K<Ft.Top+vt.y&&yt&&(Y.set(!0),M.set($t),Yt=Xt),p.get()+vt.x>o.Right-o.Left&&vt.x<o.Right-o.Left?dt=!0:(p.set(p.get()+vt.x+2),Ft.Left=Ft.Left+vt.x+2,vt.y>c.get()&&c.set(vt.y)),pas.System.Pos("ALIGN",nt)>0&&(pas.System.Pos('"TOP',nt)>0?(jt.$assign(i.CalculateText$1("gh")),W.set(c.get()-(jt.Bottom-jt.Top))):pas.System.Pos('"MIDDLE',nt)>0&&(jt.$assign(i.CalculateText$1("gh")),W.set((c.get()-(jt.Bottom-jt.Top))/2))),pas.System.Pos("WRAP",nt)>0&&(jt.$assign(i.CalculateText$1("gh")),c.set(jt.Bottom-jt.Top),W.set(0)),1===re&&(jt.$assign(i.CalculateText$1("gh")),W.set(c.get()-(jt.Bottom-jt.Top)),Z.Left=It,Z.Bottom=Rt,r||(jt.$assign(i.CalculateText$1("gh")),c.set(jt.Bottom-jt.Top))),2===re&&(jt.$assign(i.CalculateText$1("gh")),W.set(c.get()-(jt.Bottom-jt.Top)),Z.Right=It,Z.Bottom=Rt,r||(jt.$assign(i.CalculateText$1("gh")),c.set(jt.Bottom-jt.Top)),p.set(n.Right)));else if("L"===Be)le=-1,Pt="",pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos(">",s.get(),{get:function(){return qt},set:function(t){qt=t}})>0&&(nt=pas.SysUtils.UpperCase(pas.System.Copy(s.get(),3,qt-1)),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("TYPE",nt,{get:function(){return qt},set:function(t){qt=t}})>0&&(ot=pas.System.Copy(nt,qt+4,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1),Pt=ot),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("COLOR",nt,{get:function(){return qt},set:function(t){qt=t}})>0&&(ot=pas.System.Copy(nt,qt+5,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),(ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1)).length>0&&(le="#"===ot.charAt(0)?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor(ot):pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.TextToColor(ot)))),p.set(p.get()+12*Ut),mt?dt=!0:mt=!0,Ft.Left=Ft.Left+12*(Ut-1),r||zt||(""===Pt?(-1!==le&&(Qt=i.FFont.FColor,ct=le),ot=i.FFont.FName,ut=rtl.refSet(i.FFont.FStyle),i.FFont.SetStyle({}),pas.System.Odd(Ut)?i.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(Ft),"•",!1,1,0,0,0,-1,-1,!1,!1,-1,-1):i.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(Ft),"o",!1,1,0,0,0,-1,-1,!1,!1,-1,-1),i.FFont.SetName(ot),i.FFont.SetStyle(rtl.refSet(ut)),-1!==le&&(ct=Qt)):(_t=-1,"SQUARE"===Pt&&(_t=i.FFill.FColor,i.FStroke.SetColor(le),i.FFill.SetColor(le),i.FFill.SetKind(1),i.FStroke.SetKind(1),i.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(Ft.Left,Ft.Top+2,Ft.Left+8,Ft.Top+10)),2),i.FFill.SetColor(_t)),"CIRCLE"===Pt&&(_t=i.FFill.FColor,i.FStroke.SetColor(le),i.FFill.SetColor(le),i.FFill.SetKind(1),i.FStroke.SetKind(1),i.DrawEllipse$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(Ft.Left,Ft.Top+2,Ft.Left+8,Ft.Top+10)),2),i.FFill.SetColor(_t)))),Ft.Left=Ft.Left+12;else if("U"===Be)">"!==s.get().charAt(2)?(Ut+=1,Tt=!0):i.FFont.SetStyle(rtl.unionSet(i.FFont.FStyle,rtl.createSet(3)));else if("O"===Be)"F"===(ue=pas.System.upcase(s.get().charAt(2)))&&(nt=pas.System.Copy(s.get(),3,pas.System.Pos(">",s.get())-1),ot=pas.System.Copy(nt,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IPos("x",nt)+2,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1),pas.System.val$6(ot,q,{get:function(){return xt},set:function(t){xt=t}}),Ft.Left=q.get(),p.set(q.get()));else if("P"===Be)pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos(">",s.get(),{get:function(){return qt},set:function(t){qt=t}})>0&&(nt=pas.SysUtils.UpperCase(pas.System.Copy(s.get(),3,qt-1)),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("ALIGN",nt,{get:function(){return qt},set:function(t){qt=t}})>0&&(ot=pas.System.Copy(nt,qt+5,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1),pas.System.Pos("RIGHT",ot)>0&&x.set(1),pas.System.Pos("LEFT",ot)>0&&x.set(0),pas.System.Pos("CENTER",ot)>0&&x.set(2)),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("INDENT",nt,{get:function(){return qt},set:function(t){qt=t}})>0&&(ot=pas.System.Copy(nt,qt+6,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1),z.set(e.IStrToInt(ot))),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("FLOAT",nt,{get:function(){return qt},set:function(t){qt=t}})>0&&(ot=pas.System.Copy(nt,qt+5,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),"LEFT"===(ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1))&&tt.set(1),"RIGHT"===ot&&tt.set(2),se.$assign(pas.Types.Point(Math.round(o.Left),Math.round(o.Top)))),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("BGCOLOR",nt,{get:function(){return qt},set:function(t){qt=t}})>0&&(ot=pas.System.Copy(nt,qt+5,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),le=-1,(ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1)).length>0&&(le="#"===ot.charAt(0)?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor(ot):pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.TextToColor(ot)),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("BGCOLORTO",nt,{get:function(){return qt},set:function(t){qt=t}})>0?(ot=pas.System.Copy(nt,qt+5,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1),r||(Ot=!0,i.FStroke.SetColor(le))):r||(Ot=!0,Bt=i.FFill.FColor,i.FFill.SetColor(le),Et=i.FStroke.FColor,i.FStroke.SetColor(le),i.FFill.SetKind(1),i.FStroke.SetKind(1),i.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(n.Left,o.Top,n.Right,o.Bottom)),2))));else if("F"===Be){if(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos(">",s.get(),{get:function(){return qt},set:function(t){qt=t}})>0)if(nt=pas.SysUtils.UpperCase(pas.System.Copy(s.get(),6,qt-6)),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("FACE",nt,{get:function(){return qt},set:function(t){qt=t}})>0&&(ot=pas.System.Copy(nt,qt+4,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1),i.FFont.SetName(ot)),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos(" COLOR",nt,{get:function(){return qt},set:function(t){qt=t}})>0&&!u&&(ot=pas.System.Copy(nt,qt+6,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1),at=-1!==i.FFill.FColor?i.FFont.FColor:0,ot.length>0&&(ct="#"===ot.charAt(0)?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor(ot):pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.TextToColor(ot))),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("BGCOLOR",nt,{get:function(){return qt},set:function(t){qt=t}})>0&&!r&&!u&&(ot=pas.System.Copy(nt,qt+7,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),(ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1)).length>0&&(Ct="#"===ot.charAt(0)?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor(ot):pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.TextToColor(ot))),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("STYLE",nt,{get:function(){return qt},set:function(t){qt=t}})>0)ot=pas.System.Copy(nt,qt+5,nt.length),ot=pas.System.Copy(ot,pas.System.Pos("=",ot)+1,ot.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),pas.System.Pos("FONT-SIZE:",pas.SysUtils.UpperCase(ot))>0&&(pas.System.Delete({get:function(){return ot},set:function(t){ot=t}},1,10),pas.System.Pos("PT",pas.SysUtils.UpperCase(ot))>0&&(ot=pas.SysUtils.Trim(pas.System.Copy(ot,1,pas.System.Pos("PT",pas.SysUtils.UpperCase(ot))-1)),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(i.FFont,e.IStrToInt(ot),1)));else if(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos("SIZE",nt,{get:function(){return qt},set:function(t){qt=t}})>0){ot=pas.System.Copy(nt,qt+4,nt.length),ot=pas.System.Copy(ot,pas.System.Pos("=",ot)+1,ot.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1);var De=e.IStrToInt(ot);1===De?pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(i.FFont,8,1):2===De?pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(i.FFont,10,1):3===De?pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(i.FFont,12,1):4===De?pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(i.FFont,14,1):5===De?pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(i.FFont,16,1):pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(i.FFont,e.IStrToInt(ot),1)}}else"S"===Be?">"===(ue=pas.System.upcase(s.get().charAt(2)))?i.FFont.SetStyle(rtl.unionSet(i.FFont.FStyle,rtl.createSet(2))):"H"===ue?Wt=!0:1===pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IPos("<SUB>",s.get())?wt=!0:1===pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IPos("<SUP>",s.get())&&(Gt=!0):"R"===Be?(nt=pas.System.Copy(s.get(),3,pas.System.Pos(">",s.get())-1),ot=pas.System.Copy(nt,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IPos("a",nt)+2,nt.length),ot=pas.System.Copy(ot,pas.System.Pos('"',ot)+1,ot.length),ot=pas.System.Copy(ot,1,pas.System.Pos('"',ot)-1)):"Z"===Be&&(zt=!0)}pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos(">",s.get(),{get:function(){return qt},set:function(t){qt=t}})>0&&!dt?(st+=pas.System.Copy(s.get(),1,qt),pas.System.Delete(s,1,qt)):dt||pas.System.Delete(s,1,s.get().length)}}return p.set(p.get()-kt),p.get()>L.get()&&L.set(p.get()+2),a===A.get()-1&&yt&&!r&&(_.Right=Ft.Left,_.Bottom=Ft.Bottom,pas["WEBLib.TMSFNCTypes"].InflateRectEx(_,1,0),_.Left=o.Left+1,_.Top=_.Bottom),st}if(yt=!1,Mt=!1,(rt=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2")).AssignSource(i.FFont),at=i.FFont.FColor,(Ft=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2")).AssignSource(i.FFont),pt=i.FFont.FColor,(lt=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2")).AssignSource(i.FFont),ht=i.FFont.FColor,(dt=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2")).AssignSource(i.FFont),mt=i.FFont.FColor,(ut=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2")).AssignSource(i.FFont),Tt=i.FFont.FColor,Lt=i.FFill.FColor,z=i.FStroke.FColor,K=i.FFill.FKind,j=i.FStroke.FKind,St=-1,Ct=-1,Bt=-1,Ot=!1,Wt=!1,zt=!1,P.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),G.set(""),w.set(""),F||v.set(""),Zt=0,te=0,ne=0,ie.$assign(pas.Types.Rect(0,0,0,0)),J=!1,X.$assign(n),nt=0,ot=0,L.set(0),D.set(0),A.set(0),Rt=0,Ut=0,xt=0,B.set(""),E.set(""),$.set(-1),Nt=!1,Xt=0,Yt=-1,pas.System.Pos("&",s)>0){s=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.UnFixMarkup(s,!0,!0);do{jt=!1,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.TagReplaceString("&amp;","&",{get:function(){return s},set:function(t){s=t}})&&(jt=!0)}while(jt)}for(s=e.DBTagStrip(s),s=e.UnicodeTagStrip(s),s=e.CRLFStrip(s,!0),0,O.set(0);s.length>0;){rt.AssignSource(ut),at=Tt,i.FFont.AssignSource(lt),ct=ht,bt=yt,It=$t,Ht=0,Vt=0,kt=0,Gt=!1,wt=!1,ft=!1,gt=!1,Z=0,st.$assign(i.CalculateText$1("gh")),et=tt=st.Bottom-st.Top,qt=Xt,s=pas.SysUtils.Trim(s),oe=ne,Y=ae(i,{get:function(){return s},set:function(t){s=t}},pas["WEBLib.TMSFNCTypes"].TRectF.$clone(X),!0,{get:function(){return Z},set:function(t){Z=t}},{get:function(){return tt},set:function(t){tt=t}},{get:function(){return Vt},set:function(t){Vt=t}},{get:function(){return Ht},set:function(t){Ht=t}},{get:function(){return kt},set:function(t){kt=t}},{get:function(){return nt},set:function(t){nt=t}},{get:function(){return ot},set:function(t){ot=t}},o,r,{get:function(){return ft},set:function(t){ft=t}},{get:function(){return gt},set:function(t){gt=t}},Zt,{get:function(){return te},set:function(t){te=t}},ie,{get:function(){return ne},set:function(t){ne=t}}),O.set(O.get()+1),yt=bt,$t=It,lt.AssignSource(i.FFont),ht=i.FFont.FColor,ut.AssignSource(rt),Tt=at,tt+=W,q.$assign(X);var le=nt;2===le?X.Right-X.Left-Z>0&&(q.Left=X.Left+(X.Right-X.Left-Z)/2):1===le&&X.Right-Z>X.Left&&(q.Left=X.Right-Z),q.Left=q.Left+ot,q.Right=q.Right+ot,q.Bottom=q.Top+tt+Vt+Ht,p||(rt.AssignSource(dt),at=mt,i.FFont.AssignSource(Ft),ct=pt,A.set(Rt),Ut=xt,Xt=qt,ae(i,{get:function(){return Y},set:function(t){Y=t}},pas["WEBLib.TMSFNCTypes"].TRectF.$clone(q),F,{get:function(){return Z},set:function(t){Z=t}},{get:function(){return tt},set:function(t){tt=t}},{get:function(){return Vt},set:function(t){Vt=t}},{get:function(){return Ht},set:function(t){Ht=t}},{get:function(){return kt},set:function(t){kt=t}},{get:function(){return nt},set:function(t){nt=t}},{get:function(){return ot},set:function(t){ot=t}},o,r,{get:function(){return ft},set:function(t){ft=t}},{get:function(){return gt},set:function(t){gt=t}},Zt,{get:function(){return te},set:function(t){te=t}},ie,{get:function(){return ne},set:function(t){ne=t}}),Rt=A.get(),xt=Ut,X.Left=n.Left+ie.Left,X.Right=n.Right-ie.Right,q.Top>ie.Bottom&&(ie.Left=0,ie.Right=0,X.Left=n.Left),st.$assign(i.CalculateText$1("gh")),(ft&&r>q.Bottom-kt-(st.Bottom-st.Top)&&r<q.Bottom-kt||gt)&&(J=!0),Zt=te,Ft.AssignSource(i.FFont),pt=ct,dt.AssignSource(rt),mt=at),0!==ne&&ne!==oe?(X.Left=se.x,X.Top=se.y,ne=0):(X.Top=X.Top+tt+Vt+Ht,D.set(D.get()+tt+Vt+Ht)),X.Top+et>X.Bottom+1&&!p&&(s="")}return 0===D.get()&&(st.$assign(i.CalculateText$1("gh")),D.set(st.Bottom-st.Top)),1,i.FStroke.SetKind(j),i.FFill.SetKind(K),i.FStroke.SetColor(z),i.FFill.SetColor(Lt),i.FFont.AssignSource(rt),rt=rtl.freeLoc(rt),Ft=rtl.freeLoc(Ft),lt=rtl.freeLoc(lt),dt=rtl.freeLoc(dt),ut=rtl.freeLoc(ut),J},this.ParseControl=function(i,s,n,o,r,a,l,h){var F="",p=0;s.set(""),r.set(""),a.set(""),o.set(""),n.set(""),l.set(""),h.set(""),p=0,e.VarIPos("TYPE=",i,{get:function(){return p},set:function(t){p=t}})>0&&(F=pas.System.Copy(i,p+1,i.length),F=pas.System.Copy(F,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)+1,F.length),F=pas.System.Copy(F,1,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)-1),s.set(pas.SysUtils.UpperCase(F))),e.VarIPos("WIDTH=",i,{get:function(){return p},set:function(t){p=t}})>0&&(F=pas.System.Copy(i,p+1,i.length),F=pas.System.Copy(F,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)+1,F.length),F=pas.System.Copy(F,1,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)-1),r.set(F)),e.VarIPos("HEIGHT=",i,{get:function(){return p},set:function(t){p=t}})>0&&(F=pas.System.Copy(i,p+1,i.length),F=pas.System.Copy(F,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)+1,F.length),F=pas.System.Copy(F,1,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)-1),a.set(F)),e.VarIPos("ID=",i,{get:function(){return p},set:function(t){p=t}})>0&&(F=pas.System.Copy(i,p+1,i.length),F=pas.System.Copy(F,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)+1,F.length),F=pas.System.Copy(F,1,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)-1),n.set(F)),e.VarIPos("VALUE=",i,{get:function(){return p},set:function(t){p=t}})>0&&(F=pas.System.Copy(i,p+1,i.length),F=pas.System.Copy(F,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)+1,F.length),F=pas.System.Copy(F,1,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)-1),o.set(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.UnFixMarkup(F,!0,!1))),e.VarIPos("PROP=",i,{get:function(){return p},set:function(t){p=t}})>0&&(F=pas.System.Copy(i,p+1,i.length),F=pas.System.Copy(F,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)+1,F.length),F=pas.System.Copy(F,1,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)-1),l.set(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.UnFixMarkup(F,!0,!1))),e.VarIPos("MAXLEN=",i,{get:function(){return p},set:function(t){p=t}})>0&&(F=pas.System.Copy(i,p+1,i.length),F=pas.System.Copy(F,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)+1,F.length),F=pas.System.Copy(F,1,pas.System.Pos(t.TMSFNCHTMLENGINE_ATTR_DELIM,F)-1),h.set(F))},t.$implcode=function(){e.VarIPos=function(t,e,i){return i.set(pas.System.Pos(t,pas.SysUtils.UpperCase(e))),i.get()},e.IStrToInt=function(t){var e=0,i=0;return pas.System.val$6(t,{get:function(){return i},set:function(t){i=t}},{get:function(){return e},set:function(t){e=t}}),i},e.DBTagStrip=function(t){var e,i="",s=0;return(e=pas.System.Pos("<#",t))>0?(i=pas.System.Copy(t,1,e-1),pas.System.Delete({get:function(){return t},set:function(e){t=e}},1,e),(s=pas.System.Pos(">",t))>0&&pas.System.Delete({get:function(){return t},set:function(e){t=e}},s,1),i+=t):i=t,i},e.HexVal=function(t){return t.length<2?0:((t.charAt(0)>="A"?t.charCodeAt(0)-65+10:t.charCodeAt(0)-48)<<4)+(t.charAt(1)>="A"?t.charCodeAt(1)-65+10:t.charCodeAt(1)-48)},e.UnicodeTagStrip=function(t){var i=0,s=0,n=0,o=0,r="",a="",l=0,h=!1;function F(t,e){var i=0,s=0,n=0;i=n=e?4:3;for(var o=n,r=t.length;o<=r;o++){if(s=o,!(t.charAt(s-1)>="0"&&t.charAt(s-1)<="9")){i=s;break}if(e&&!(t.charAt(s-1)>="A"&&t.charAt(s-1)<="F")&&e&&!(t.charAt(s-1)>="a"&&t.charAt(s-1)<="f")){i=s;break}}return i}a="";do{if(i=pas.System.Pos("&#",t),(n=pas.System.Pos("&&#",t))===i-1&&0!==n&&(i=0),i>0)if(a+=pas.System.Copy(t,1,i-1),pas.System.Delete({get:function(){return t},set:function(e){t=e}},1,i-1),h=1===pas.System.Pos("&#x",t),(s=pas.System.Pos(";",t))>7&&(s=F(t,h)),s>0){if(h){r=pas.System.Copy(t,4,s-4);try{l=e.HexVal(r),o=0}catch(t){l=0}}else r=pas.System.Copy(t,3,s-3),pas.System.val$6(r,{get:function(){return l},set:function(t){l=t}},{get:function(){return o},set:function(t){o=t}});r.length>0&&r.length<=6&&0===o&&(a+=String.fromCharCode(l),pas.System.Delete({get:function(){return t},set:function(e){t=e}},1,s))}else a+="&#",pas.System.Delete({get:function(){return t},set:function(e){t=e}},1,2);else a+=t}while(!(i<=0));return a},e.CRLFStrip=function(t,e){var i="",s=0;i="";for(var n=1,o=t.length;n<=o;n++)s=n,"\r"!==t.charAt(s-1)&&"\n"!==t.charAt(s-1)?i+=t.charAt(s-1):"\r"===t.charAt(s-1)&&e&&(i+="<BR>");return i}}}),["SysUtils","WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCGraphics.General",["System","Classes","WEBLib.TMSFNCGraphicsTypes","Types","WEBLib.Graphics","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCTypes"],(function(){"use strict";rtl.createClass(this,"TTMSFNCGraphicsContextGeneral",pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphicsContext,(function(){this.$init=function(){pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphicsContext.$init.call(this),this.FShowAcceleratorChar=!1,this.FOldPenStyle=0,this.FOldPenWidth=0},this.DrawRotatedText=function(t,e,i,s,n,o){var r,a=0,l=0,h=pas["WEBLib.Graphics"].TCanvasRectF.$new();r=i,e.Left,e.Top,t.TextWidth(r),t.TextHeight(r);1===n?a=0:0===n?a=2:2===n&&(a=1);0===o?l=2:1===o?l=0:2===o&&(l=1),h.$assign(pas["WEBLib.Graphics"].CreateCanvasRectF(e.Left,e.Top,e.Right,e.Bottom)),t.TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(h),r,!1,!1,a,l)},this.Destroy=function(){pas.System.TObject.Destroy.call(this)},this.GetFillColor=function(){return this.GetCanvas().FBrush.FColor},this.CalculateText=function(t,e,i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.Graphics"].TCanvasRectF.$new();return n.$assign(pas["WEBLib.Graphics"].CreateCanvasRectF(e.Left,e.Top,e.Right,e.Bottom)),n.$assign(this.GetCanvas().TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(n),t,i,!0,0,0)),s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(n.Left,n.Top,n.Right,n.Bottom)),s},this.SetTextAngle=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0,n=pas["WEBLib.TMSFNCTypes"].TPointF.$new();return i.$assign(t),0!==e&&(s=pas.Math.DegToRad(e),n.X=i.Left+(i.Right-i.Left)/2,n.Y=i.Top+(i.Bottom-i.Top)/2,this.GetCanvas().Transform(Math.cos(s),Math.sin(s),-Math.sin(s),Math.cos(s),n.X,n.Y),i.Right-i.Left<i.Bottom-i.Top?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(-(i.Bottom-i.Top)/2,-(i.Right-i.Left)/2,(i.Bottom-i.Top)/2,(i.Right-i.Left)/2)):i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(-(i.Right-i.Left)/2,-(i.Bottom-i.Top)/2,(i.Right-i.Left)/2,(i.Bottom-i.Top)/2))),i},this.CreatePath=function(){return null,null},this.Render=function(){},this.PathOpen=function(t){},this.PathMoveTo=function(t,e){this.GetCanvas().PathMoveTo$1(e.X,e.Y)},this.PathLineTo=function(t,e){this.GetCanvas().PathLineTo$1(e.X,e.Y)},this.PathClose=function(t){this.GetCanvas().PathClose()},this.SetTextQuality=function(t){},this.SetAntiAliasing=function(t){},this.SetShowAcceleratorChar=function(t){this.FShowAcceleratorChar=t},this.SetSize=function(t,e){},this.ResetTextAngle=function(t){0!==t&&this.GetCanvas().SetTransform(1,0,0,1,0,0)},this.BeginScene=function(){null!=this.GetCanvas()&&(this.GetCanvas().BeginScene(),this.GetCanvas().Clear())},this.EndScene=function(){this.GetCanvas().EndScene()},this.StartSpecialPen=function(){this.FOldPenStyle=this.GetCanvas().FPen.FStyle,this.FOldPenWidth=this.GetCanvas().FPen.FWidth,this.GetCanvas().FPen.FStyle=2,this.GetCanvas().FPen.FWidth=1},this.StopSpecialPen=function(){this.GetCanvas().FPen.FStyle=this.FOldPenStyle,this.GetCanvas().FPen.FWidth=this.FOldPenWidth},this.RestoreState=function(t){null!=t&&(t.FSaveDC=0),this.GetCanvas().Restore(),this.GetCanvas().Refresh()},this.SaveState=function(t){this.GetCanvas().Refresh(),this.GetCanvas().Save()},this.SetFont=function(t){this.GetCanvas().FFont.Assign(t)},this.SetFill=function(t){this.GetCanvas().FBrush.FColor=t.FColor,this.GetCanvas().FBrush.FGradient=0,this.GetCanvas().FBrush.ClearGradient();var e=t.FKind;if(1===e)this.GetCanvas().FBrush.FStyle=0;else if(2===e){this.GetCanvas().FBrush.ClearGradient(),-1!==t.FColorMirror&&-1!==t.FColorMirrorTo?(this.GetCanvas().FBrush.AddGradientColor(t.FColor,0),this.GetCanvas().FBrush.AddGradientColor(t.FColorTo,.5),this.GetCanvas().FBrush.AddGradientColor(t.FColorMirror,.5),this.GetCanvas().FBrush.AddGradientColor(t.FColorMirrorTo,1)):(this.GetCanvas().FBrush.AddGradientColor(t.FColor,0),this.GetCanvas().FBrush.AddGradientColor(t.FColorTo,1));var i=t.FOrientation;0===i?this.GetCanvas().FBrush.FGradient=2:1===i&&(this.GetCanvas().FBrush.FGradient=1)}else 0===e&&(this.GetCanvas().FBrush.FStyle=1)},this.SetFillColor=function(t){this.GetCanvas().FBrush.FColor=t},this.SetStroke=function(t){this.GetCanvas().FPen.SetColor(t.FColor),this.GetCanvas().FPen.FWidth=Math.round(t.FWidth);var e=t.FKind;1===e?this.GetCanvas().FPen.FStyle=0:0===e?this.GetCanvas().FPen.FStyle=5:2===e?this.GetCanvas().FPen.FStyle=1:3===e?this.GetCanvas().FPen.FStyle=2:4===e?this.GetCanvas().FPen.FStyle=3:5===e&&(this.GetCanvas().FPen.FStyle=4)},this.DrawLine=function(t,e,i,s,n){this.GetCanvas().MoveTo$1(e.X,e.Y),this.GetCanvas().LineTo$1(i.X,i.Y)},this.DrawPolygon=function(t,e){var i,s,n=[],o=0;n=rtl.arraySetLength(n,pas["WEBLib.Graphics"].TCanvasPointF,rtl.length(e));for(var r=0,a=rtl.length(e)-1;r<=a;r++)n[o=r].$assign(pas["WEBLib.Graphics"].CreateCanvasPointF(e[o].X,e[o].Y));s=this.GetCanvas().FBrush.FColor,i=this.GetCanvas().FBrush.FStyle,this.GetCanvas().FBrush.FStyle=1,this.GetCanvas().Polygon$1(n),this.GetCanvas().FBrush.FStyle=i,this.GetCanvas().FBrush.FColor=s},this.FillPolygon=function(t,e){var i,s=[],n=0;s=rtl.arraySetLength(s,pas["WEBLib.Graphics"].TCanvasPointF,rtl.length(e));for(var o=0,r=rtl.length(e)-1;o<=r;o++)s[n=o].$assign(pas["WEBLib.Graphics"].CreateCanvasPointF(e[n].X,e[n].Y));i=this.GetCanvas().FPen.FStyle,this.GetCanvas().FPen.FStyle=5,this.GetCanvas().Polygon$1(s),this.GetCanvas().FPen.FStyle=i},this.DrawPolyline=function(t,e){var i,s,n=0,o=[];o=rtl.arraySetLength(o,pas["WEBLib.Graphics"].TCanvasPointF,rtl.length(e));for(var r=0,a=rtl.length(e)-1;r<=a;r++)o[n=r].$assign(pas["WEBLib.Graphics"].CreateCanvasPointF(e[n].X,e[n].Y));s=this.GetCanvas().FBrush.FColor,i=this.GetCanvas().FBrush.FStyle,this.GetCanvas().FBrush.FStyle=1,this.GetCanvas().Polyline$1(o),this.GetCanvas().FBrush.FStyle=i,this.GetCanvas().FBrush.FColor=s},this.FillPolyline=function(t,e){var i,s=[],n=0;s=rtl.arraySetLength(s,pas["WEBLib.Graphics"].TCanvasPointF,rtl.length(e));for(var o=0,r=rtl.length(e)-1;o<=r;o++)s[n=o].$assign(pas["WEBLib.Graphics"].CreateCanvasPointF(e[n].X,e[n].Y));i=this.GetCanvas().FPen.FStyle,this.GetCanvas().FPen.FStyle=5,this.GetCanvas().Polyline$1(s),this.GetCanvas().FPen.FStyle=i},this.FillArc=function(t,e,i,s,n){var o;o=this.GetCanvas().FPen.FStyle,this.GetCanvas().FPen.FStyle=5,this.GetCanvas().AngleArc$1(e.X,e.Y,i.X,pas.Math.DegToRad(s),pas.Math.DegToRad(n)),this.GetCanvas().FPen.FStyle=o},this.DrawArc=function(t,e,i,s,n){var o,r;r=this.GetCanvas().FBrush.FColor,o=this.GetCanvas().FBrush.FStyle,this.GetCanvas().FBrush.FStyle=1,this.GetCanvas().AngleArc$1(e.X,e.Y,i.X,pas.Math.DegToRad(s),pas.Math.DegToRad(n)),this.GetCanvas().FBrush.FStyle=o,this.GetCanvas().FBrush.FColor=r},this.FillRect=function(t,e,i){var s,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=0,r=0;if(e.$assign(pas["WEBLib.TMSFNCGraphicsTypes"].ModifyRect(e,i)),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top,e.Right,e.Bottom)),o=-1,r=1,2===t.FKind){if(-1!==t.FColor&&-1!==t.FColorTo)if(-1!==t.FColorMirror&&-1!==t.FColorMirrorTo){var a=t.FOrientation;0===a?(pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColor,t.FColorTo,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(n.Left,n.Top,n.Left+(n.Right-n.Left)/2,n.Bottom)),0,{},!0),pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColorMirror,t.FColorMirrorTo,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(n.Left+(n.Right-n.Left)/2,n.Top,n.Right,n.Bottom)),0,{},!0)):1===a&&(pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColor,t.FColorTo,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(n.Left,n.Top,n.Right,n.Top+(n.Bottom-n.Top)/2)),0,{},!1),pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColorMirror,t.FColorMirrorTo,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(n.Left,n.Top+(n.Bottom-n.Top)/2,n.Right,n.Bottom)),0,{},!1))}else pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColor,t.FColorTo,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),0,{},0===t.FOrientation);o=this.GetCanvas().FBrush.FColor,r=this.GetCanvas().FBrush.FStyle,this.GetCanvas().FBrush.FStyle=1}s=this.GetCanvas().FPen.FStyle,this.GetCanvas().FPen.FStyle=5,-1!==t.FColor&&1===t.FKind&&this.GetCanvas().Rectangle$3(pas["WEBLib.Graphics"].CreateCanvasRectF(n.Left,n.Top,n.Right,n.Bottom)),this.GetCanvas().FPen.FStyle=s,2===t.FKind&&(this.GetCanvas().FBrush.FColor=o,this.GetCanvas().FBrush.FStyle=r)},this.DrawRect=function(t,e,i,s){var n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(pas["WEBLib.TMSFNCGraphicsTypes"].ModifyRect(e,s)),n.$assign(e),1 in i&&this.DrawLine(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Top)),2,2),0 in i&&this.DrawLine(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Bottom)),2,2),3 in i&&this.DrawLine(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Bottom)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Bottom)),2,2),2 in i&&this.DrawLine(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Bottom)),2,2)},this.FillRoundRect=function(t,e,i,s,n){var o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a={};if(e.$assign(pas["WEBLib.TMSFNCGraphicsTypes"].ModifyRect(e,n)),o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top,e.Right,e.Bottom)),r.$assign(o),r.Bottom=r.Bottom-1,r.Right=r.Right-1,2===t.FKind){if(-1!==t.FColor&&-1!==t.FColorTo)if(-1!==t.FColorMirror&&-1!==t.FColorMirrorTo){var l=t.FOrientation;0===l?(a={},0 in s&&(a=rtl.unionSet(a,rtl.createSet(0))),2 in s&&(a=rtl.unionSet(a,rtl.createSet(2))),pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColor,t.FColorTo,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(r.Left,r.Top,r.Left+(r.Right-r.Left)/2,o.Bottom)),i,rtl.refSet(a),!0),a={},1 in s&&(a=rtl.unionSet(a,rtl.createSet(1))),3 in s&&(a=rtl.unionSet(a,rtl.createSet(3))),pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColorMirror,t.FColorMirrorTo,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(r.Left+(r.Right-o.Left)/2,r.Top,r.Right,r.Bottom)),i,rtl.refSet(a),!0)):1===l&&(a={},0 in s&&(a=rtl.unionSet(a,rtl.createSet(0))),1 in s&&(a=rtl.unionSet(a,rtl.createSet(1))),pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColor,t.FColorTo,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(r.Left,r.Top,r.Right,r.Top+(r.Bottom-r.Top)/2)),i,rtl.refSet(a),!1),a={},2 in s&&(a=rtl.unionSet(a,rtl.createSet(2))),3 in s&&(a=rtl.unionSet(a,rtl.createSet(3))),pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColorMirror,t.FColorMirrorTo,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(r.Left,r.Top+(r.Bottom-r.Top)/2,r.Right,r.Bottom)),i,rtl.refSet(a),!1))}else pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColor,t.FColorTo,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),i,rtl.refSet(s),0===t.FOrientation)}else-1!==t.FColor&&1===t.FKind&&pas["WEBLib.TMSFNCGraphicsTypes"].DrawGradient(this.GetCanvas(),t.FColor,t.FColor,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),i,rtl.refSet(s),0===t.FOrientation)},this.DrawRoundRect=function(t,e,i,s,n){var o,r,a,l=pas["WEBLib.Graphics"].TCanvasRectF.$new(),h=pas["WEBLib.Graphics"].TCanvasRectF.$new();function F(t,e,i,s,n){t.AngleArc$1(e.X,e.Y,i.X,pas.Math.DegToRad(s),pas.Math.DegToRad(n))}e.$assign(pas["WEBLib.TMSFNCGraphicsTypes"].ModifyRect(e,n)),l.$assign(pas["WEBLib.Graphics"].CreateCanvasRectF(e.Left,e.Top,e.Right,e.Bottom)),h.$assign(l),h.Bottom=h.Bottom-1,h.Right=h.Right-1,r=this.GetCanvas().FBrush.FColor,a=this.GetCanvas().FBrush.FStyle,this.GetCanvas().FBrush.FStyle=1,o=Math.round(i),rtl.eqSet(s,rtl.createSet(0,1,2,3))?this.GetCanvas().RoundRect$3(l,2*o,2*o):rtl.eqSet(s,{})?this.GetCanvas().Rectangle$3(l):(2 in s?(this.GetCanvas().MoveTo$1(l.Left+o,l.Bottom),F(this.GetCanvas(),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(l.Left+o,l.Bottom-o)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o,o)),-270,90),this.GetCanvas().MoveTo$1(l.Left,l.Bottom-o)):this.GetCanvas().MoveTo$1(l.Left,l.Bottom),0 in s?(this.GetCanvas().LineTo$1(l.Left,l.Top+o),F(this.GetCanvas(),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(l.Left+o,l.Top+o)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o,o)),-180,90),this.GetCanvas().MoveTo$1(l.Left+o,l.Top)):this.GetCanvas().LineTo$1(l.Left,l.Top),1 in s?(this.GetCanvas().LineTo$1(l.Right-o,l.Top),F(this.GetCanvas(),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(l.Right-o,l.Top+o)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o,o)),-90,90),this.GetCanvas().MoveTo$1(l.Right,l.Top+o)):this.GetCanvas().LineTo$1(l.Right,l.Top),3 in s?(this.GetCanvas().LineTo$1(l.Right,l.Bottom-o),F(this.GetCanvas(),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(l.Right-o,l.Bottom-o)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o,o)),0,90),this.GetCanvas().MoveTo$1(l.Right-o,l.Bottom)):this.GetCanvas().LineTo$1(l.Right,l.Bottom),2 in s?this.GetCanvas().LineTo$1(l.Left+o,l.Bottom):this.GetCanvas().LineTo$1(l.Left,l.Bottom)),this.GetCanvas().FBrush.FColor=r,this.GetCanvas().FBrush.FStyle=a},this.FillEllipse=function(t,e,i){var s,n=pas["WEBLib.Graphics"].TCanvasRectF.$new();e.$assign(pas["WEBLib.TMSFNCGraphicsTypes"].ModifyRect(e,i)),n.$assign(pas["WEBLib.Graphics"].CreateCanvasRectF(e.Left,e.Top,e.Right,e.Bottom)),s=this.GetCanvas().FPen.FStyle,this.GetCanvas().FPen.FStyle=5,this.GetCanvas().Ellipse$3(n),this.GetCanvas().FPen.FStyle=s},this.DrawEllipse=function(t,e,i){var s,n,o=pas["WEBLib.Graphics"].TCanvasRectF.$new();e.$assign(pas["WEBLib.TMSFNCGraphicsTypes"].ModifyRect(e,i)),o.$assign(pas["WEBLib.Graphics"].CreateCanvasRectF(e.Left,e.Top,e.Right,e.Bottom)),n=this.GetCanvas().FBrush.FColor,s=this.GetCanvas().FBrush.FStyle,this.GetCanvas().FBrush.FStyle=1,this.GetCanvas().Ellipse$3(o),this.GetCanvas().FBrush.FStyle=s,this.GetCanvas().FBrush.FColor=n},this.DrawBitmap=function(t,e,i,s){this.GetCanvas().StretchDraw$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(pas["WEBLib.Graphics"].CreateCanvasRectF(i.Left,i.Top,i.Right,i.Bottom)),t)},this.ClipRect=function(t){this.GetCanvas().SetClipRect(pas["WEBLib.Graphics"].CreateCanvasRectF(t.Left,t.Top,t.Right,t.Bottom))},this.DrawFocusRectangle=function(t,e,i,s){var n,o,r=pas["WEBLib.Graphics"].TCanvasRectF.$new();e.$assign(pas["WEBLib.TMSFNCGraphicsTypes"].ModifyRect(e,s)),r.$assign(pas["WEBLib.Graphics"].CreateCanvasRectF(e.Left,e.Top,e.Right,e.Bottom)),n=this.GetCanvas().FBrush.FColor,o=this.GetCanvas().FBrush.FStyle,this.GetCanvas().FBrush.FStyle=1,this.GetCanvas().FPen.SetColor(i),this.StartSpecialPen(),this.GetCanvas().Rectangle$3(r),this.StopSpecialPen(),this.GetCanvas().FBrush.FColor=n,this.GetCanvas().FBrush.FStyle=o},this.DrawText=function(t,e,i,s,n,o,r){var a,l,h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=0,p=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),c=null;if(a=this.GetCanvas().FBrush.FColor,l=this.GetCanvas().FBrush.FStyle,this.GetCanvas().FBrush.FStyle=1,p.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top,e.Right,e.Bottom)),i){var u=n;0===u?(h.$assign(this.CalculateText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)),F=Math.round(h.Bottom-h.Top),p.Top=p.Top+Math.max(0,(p.Bottom-p.Top-F)/2),p.Bottom=Math.max(0,Math.min(Math.round(e.Bottom),p.Top+F))):2===u&&(h.$assign(this.CalculateText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)),F=Math.round(h.Bottom-h.Top),p.Top=p.Bottom-F,p.Bottom=p.Top+F)}if(0!==r)this.DrawRotatedText(this.GetCanvas(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(p),t,r,s,n);else{c=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsSaveState.$create("Create$1");try{this.SaveState(c),this.ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(p));var T=s;if(1===T){var C=n;1===C?this.GetCanvas().TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(pas["WEBLib.Graphics"].CreateCanvasRectF(p.Left,p.Top,p.Right,p.Bottom)),t,i,!1,0,0):0===C?this.GetCanvas().TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(pas["WEBLib.Graphics"].CreateCanvasRectF(p.Left,p.Top,p.Right,p.Bottom)),t,i,!1,0,2):2===C&&this.GetCanvas().TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(pas["WEBLib.Graphics"].CreateCanvasRectF(p.Left,p.Top,p.Right,p.Bottom)),t,i,!1,0,1)}else if(0===T){var S=n;1===S?this.GetCanvas().TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(pas["WEBLib.Graphics"].CreateCanvasRectF(p.Left,p.Top,p.Right,p.Bottom)),t,i,!1,2,0):0===S?this.GetCanvas().TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(pas["WEBLib.Graphics"].CreateCanvasRectF(p.Left,p.Top,p.Right,p.Bottom)),t,i,!1,2,2):2===S&&this.GetCanvas().TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(pas["WEBLib.Graphics"].CreateCanvasRectF(p.Left,p.Top,p.Right,p.Bottom)),t,i,!1,2,1)}else if(2===T){var d=n;1===d?this.GetCanvas().TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(pas["WEBLib.Graphics"].CreateCanvasRectF(p.Left,p.Top,p.Right,p.Bottom)),t,i,!1,1,0):0===d?this.GetCanvas().TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(pas["WEBLib.Graphics"].CreateCanvasRectF(p.Left,p.Top,p.Right,p.Bottom)),t,i,!1,1,2):2===d&&this.GetCanvas().TextRect$1(pas["WEBLib.Graphics"].TCanvasRectF.$clone(pas["WEBLib.Graphics"].CreateCanvasRectF(p.Left,p.Top,p.Right,p.Bottom)),t,i,!1,1,1)}}finally{this.RestoreState(c)}}this.GetCanvas().FBrush.FColor=a,this.GetCanvas().FBrush.FStyle=l},this.DrawPath=function(t,e,i){var s=[];if(null!=e)if(2===i)this.GetCanvas().PathBegin(),this.ConvertToPath(e,.25),this.GetCanvas().PathStroke();else{s=rtl.arraySetLength(s,pas["WEBLib.TMSFNCTypes"].TPointF,0),e.FlattenToPolygon({get:function(){return s},set:function(t){s=t}},.25);var n=i;0===n?this.DrawPolygon(t,rtl.arrayRef(s)):1===n&&this.DrawPolyline(t,rtl.arrayRef(s))}},this.FillPath=function(t,e,i){var s=[];if(null!=e)if(2===i)this.GetCanvas().PathBegin(),this.ConvertToPath(e,.25),this.GetCanvas().PathFill();else{s=rtl.arraySetLength(s,pas["WEBLib.TMSFNCTypes"].TPointF,0),e.FlattenToPolygon({get:function(){return s},set:function(t){s=t}},.25);var n=i;0===n?this.FillPolygon(t,rtl.arrayRef(s)):1!==n&&2!==n||this.FillPolyline(t,rtl.arrayRef(s))}}}))}),["Math"]),rtl.module("WEBLib.TMSFNCGraphics.WEB",["System","Classes","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCUtils","Types","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphics","WEBLib.Graphics"],(function(){"use strict";var t=this;rtl.createClass(this,"TTMSFNCGraphicsContextWEB",pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphicsContext,(function(){this.$init=function(){pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphicsContext.$init.call(this),this.FActivePath=null,this.FScale=0,this.FNeedsRendering=!1,this.FFont=null,this.FFill=null,this.FStroke=null,this.FContextSize=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),this.FNCanvas=null,this.FBitmap=null},this.$final=function(){this.FActivePath=void 0,this.FFont=void 0,this.FFill=void 0,this.FStroke=void 0,this.FContextSize=void 0,this.FBitmap=void 0,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphicsContext.$final.call(this)},this.DestroyResources=function(){null!=this.FNCanvas&&(this.RestoreContext(),this.FNCanvas=null),null!=this.FBitmap&&(rtl.free(this,"FBitmap"),this.FBitmap=null)},this.DrawTextInternal=function(t,e,i,s,n){var o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=0,a="",l="",h=0,F=0,p=!1,c=0,u=0,T=0,C=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),S=0;function d(t,e){var i,s="",n=0;if(s="",i=t.length,e.get()>i)return s;for(n=e.get();;){if("\n"===t.charAt(n-1)&&"\r"===t.charAt(n-1-1)||"\r"===t.charAt(n-1)&&"\n"===t.charAt(n-1-1)||" "===t.charAt(n-1)){s=" "===t.charAt(n-1)?pas.System.Copy(t,e.get(),n-(e.get()-1)):pas.System.Copy(t,e.get(),n-e.get());break}if("\n"===t.charAt(n-1)||"\r"===t.charAt(n-1)||" "===t.charAt(n-1)){s=pas.System.Copy(t,e.get(),n-(e.get()-1));break}if(n>=i){s=pas.System.Copy(t,e.get(),n-(e.get()-1));break}n+=1}return e.set(n+1),s}if(i){for(C.$assign(e),F=0,r=1,.5*this.FFont.FSize,T=0,S=0,u=0,F+=0,(a=d(t,{get:function(){return r},set:function(t){r=t}})).length>0&&" "===a.charAt(a.length-1)&&(F+=S);r<=t.length&&((h=a.length)>=2&&("\n"===a.charAt(h-1)&&"\r"===a.charAt(h-1-1)||"\r"===a.charAt(h-1)&&"\n"===a.charAt(h-1-1))?(a=pas.System.Copy(a,1,h-2),p=!0):h>=1&&("\n"===a.charAt(h-1)||"\r"===a.charAt(h-1))?(a=pas.System.Copy(a,1,h-1),p=!0):p=!1,l=d(t,{get:function(){return r},set:function(t){r=t}}),!((e.Left+F+0>e.Right||p)&&(""!==a&&(c=a.length,pas.System.Copy(a,1,c),T+=1,F>u&&(u=F),F=0),a="",e.Top=e.Top+0,pas.System.Trunc(e.Top)>pas.System.Trunc(e.Bottom-0)&&!n)));)F+=0,l.length>0&&" "===l.charAt(l.length-1)&&(F+=S),a+=l;""!==a&&(c=a.length,pas.System.Copy(a,1,c),T+=1,F>u&&(u=F)),o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(C.Left,C.Top,C.Left+u,C.Top+0*T))}else;return o},this.DrawLinearGradient=function(t){if(null!=this.FNCanvas){this.FFill.FOrientation;-1!==this.FFill.FColorTo&&-1!==this.FFill.FColorMirror||this.FFill.FColorTo}},this.FontChanged=function(t){},this.FillChanged=function(t){null!=this.FNCanvas&&this.ApplyFill()},this.StrokeChanged=function(t){null!=this.FNCanvas&&this.ApplyStroke()},this.RestoreContext=function(){this.FNCanvas},this.SaveContext=function(){this.FNCanvas},this.ApplyStroke=function(){this.FNCanvas},this.ApplyFill=function(){if(null!=this.FNCanvas)this.FFill.FKind},this.Create$1=function(t){return pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphicsContext.Create$1.apply(this,arguments),this.FScale=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(null,-1),this.FNeedsRendering=!0,this.FContextSize.cx=0,this.FContextSize.cy=0,this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this},this.Destroy=function(){this.Render(),null!=this.FFont&&(rtl.free(this,"FFont"),this.FFont=null),null!=this.FFill&&(rtl.free(this,"FFill"),this.FFill=null),null!=this.FStroke&&(rtl.free(this,"FStroke"),this.FStroke=null),this.DestroyResources(),pas.System.TObject.Destroy.call(this)},this.GetFillColor=function(){return this.GetGraphics().FFill.FColor},this.CalculateText=function(t,e,i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),null==this.FNCanvas||(this.SaveContext(),s.$assign(this.DrawTextInternal(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,1,!0)),this.RestoreContext()),s},this.SetTextAngle=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TPointF.$new();return i.$assign(t),null==this.FNCanvas||0!==e&&(pas.Math.DegToRad(e),s.X=i.Left+(i.Right-i.Left)/2,s.Y=i.Top+(i.Bottom-i.Top)/2,this.SaveContext(),i.Right-i.Left<i.Bottom-i.Top?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(-(i.Bottom-i.Top)/2,-(i.Right-i.Left)/2,(i.Bottom-i.Top)/2,(i.Right-i.Left)/2)):i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(-(i.Right-i.Left)/2,-(i.Bottom-i.Top)/2,(i.Right-i.Left)/2,(i.Bottom-i.Top)/2))),i},this.CreatePath=function(){return null},this.Render=function(){this.FNeedsRendering&&(this.FNeedsRendering=!1,this.DestroyResources())},this.PathOpen=function(t){},this.PathMoveTo=function(t,e){},this.PathLineTo=function(t,e){},this.PathClose=function(t){},this.ScaleTransform=function(t,e){this.FNCanvas},this.SetTextQuality=function(t){},this.SetAntiAliasing=function(t){this.FNCanvas},this.SetShowAcceleratorChar=function(t){},this.SetSize=function(t,e){this.FContextSize.cx=t,this.FContextSize.cy=e,this.DestroyResources(),this.FBitmap=pas["WEBLib.Graphics"].TBitmap.$create("Create$3"),this.ScaleTransform(this.FScale,this.FScale),this.SaveContext()},this.ResetTextAngle=function(t){null!=this.FNCanvas&&0!==t&&this.RestoreContext()},this.BeginScene=function(){this.FNCanvas},this.EndScene=function(){null!=this.FNCanvas&&this.Render()},this.StartSpecialPen=function(){this.FNCanvas},this.StopSpecialPen=function(){this.FNCanvas},this.RestoreState=function(t){null!=this.FNCanvas&&this.RestoreContext()},this.SaveState=function(t){null!=this.FNCanvas&&this.SaveContext()},this.SetFont=function(t){null!=this.FNCanvas&&this.FFont.AssignSource(t)},this.SetFill=function(t){null!=this.FNCanvas&&this.FFill.Assign(t)},this.SetFillColor=function(t){null!=this.FNCanvas&&this.FFill.SetColor(t)},this.SetStroke=function(t){null!=this.FNCanvas&&this.FStroke.Assign(t)},this.DrawLine=function(t,e,i,s,n){null!=this.FNCanvas&&(this.SaveContext(),this.RestoreContext())},this.DrawPolygon=function(t,e){null!=this.FNCanvas&&0!==rtl.length(e)&&(this.SaveContext(),this.ApplyStroke(),this.RestoreContext())},this.FillPolygon=function(t,e){if(null!=this.FNCanvas&&0!==rtl.length(e)){this.SaveContext();var i=t.FKind;1===i?this.ApplyFill():2===i&&null!=this.FActivePath&&this.DrawLinearGradient(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.FActivePath.GetBounds())),this.RestoreContext()}},this.DrawPolyline=function(t,e){null!=this.FNCanvas&&0!==rtl.length(e)&&(this.SaveContext(),this.ApplyStroke(),this.RestoreContext())},this.FillPolyline=function(t,e){if(null!=this.FNCanvas&&0!==rtl.length(e)){this.SaveContext();var i=t.FKind;1===i?this.ApplyFill():2===i&&null!=this.FActivePath&&this.DrawLinearGradient(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.FActivePath.GetBounds())),this.RestoreContext()}},this.FillArc=function(t,e,i,s,n){if(null!=this.FNCanvas){this.SaveContext();var o=t.FKind;1===o?this.ApplyFill():2===o&&this.DrawLinearGradient(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(e.X-i.X,e.Y-i.Y,e.X+i.X,e.Y+i.Y))),this.RestoreContext()}},this.DrawArc=function(t,e,i,s,n){null!=this.FNCanvas&&(this.SaveContext(),this.ApplyStroke(),this.RestoreContext())},this.FillRect=function(t,e,i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(null!=this.FNCanvas){s.$assign(e),this.SaveContext();var n=t.FKind;1===n?this.ApplyFill():2===n&&this.DrawLinearGradient(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s)),this.RestoreContext()}},this.DrawRect=function(t,e,i,s){var n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();null!=this.FNCanvas&&(n.$assign(e),1 in i&&this.DrawLine(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Top)),2,2),0 in i&&this.DrawLine(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Bottom)),2,2),3 in i&&this.DrawLine(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Bottom)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Bottom)),2,2),2 in i&&this.DrawLine(t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Bottom)),2,2))},this.FillRoundRect=function(t,e,i,s,n){var o,r=null,a=pas["WEBLib.TMSFNCTypes"].TRectF.$new();a.$assign(e),o=i,r=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{2 in s?(r.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+o,a.Bottom)),r.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+o,a.Bottom-o),pas["WEBLib.TMSFNCTypes"].PointF(o,o),-270,90),r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Bottom-o))):r.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Bottom)),0 in s?(r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Top+o)),r.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+o,a.Top+o),pas["WEBLib.TMSFNCTypes"].PointF(o,o),-180,90),r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+o,a.Top))):r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Top)),1 in s?(r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-o,a.Top)),r.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-o,a.Top+o),pas["WEBLib.TMSFNCTypes"].PointF(o,o),-90,90),r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Top+o))):r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Top)),3 in s?(r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Bottom-o)),r.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-o,a.Bottom-o),pas["WEBLib.TMSFNCTypes"].PointF(o,o),0,90),r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-o,a.Bottom))):r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Bottom)),2 in s?r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+o,a.Bottom)):r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Bottom)),r.ClosePath(),this.FillPath(this.FFill,r,0)}finally{r=rtl.freeLoc(r)}},this.DrawRoundRect=function(t,e,i,s,n){var o,r=null,a=pas["WEBLib.TMSFNCTypes"].TRectF.$new();a.$assign(e),o=i,r=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{2 in s?(r.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+o,a.Bottom)),r.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+o,a.Bottom-o),pas["WEBLib.TMSFNCTypes"].PointF(o,o),-270,90),r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Bottom-o))):r.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Bottom)),0 in s?(r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Top+o)),r.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+o,a.Top+o),pas["WEBLib.TMSFNCTypes"].PointF(o,o),-180,90),r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+o,a.Top))):r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Top)),1 in s?(r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-o,a.Top)),r.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-o,a.Top+o),pas["WEBLib.TMSFNCTypes"].PointF(o,o),-90,90),r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Top+o))):r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Top)),3 in s?(r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Bottom-o)),r.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-o,a.Bottom-o),pas["WEBLib.TMSFNCTypes"].PointF(o,o),0,90),r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-o,a.Bottom))):r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Bottom)),2 in s?r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+o,a.Bottom)):r.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Bottom)),r.ClosePath(),this.DrawPath(this.FStroke,r,0)}finally{r=rtl.freeLoc(r)}},this.FillEllipse=function(t,e,i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(null!=this.FNCanvas){s.$assign(e),this.SaveContext();var n=t.FKind;1===n?this.ApplyFill():2===n&&this.DrawLinearGradient(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s)),this.RestoreContext()}},this.DrawEllipse=function(t,e,i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();null!=this.FNCanvas&&(s.$assign(e),this.SaveContext(),this.ApplyStroke(),this.RestoreContext())},this.DrawBitmap=function(t,e,i,s){var n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();null!=t&&null!=this.FNCanvas&&(this.SaveContext(),n.$assign(i),this.RestoreContext())},this.ClipRect=function(t){null!=this.FNCanvas&&this.SaveContext()},this.DrawFocusRectangle=function(t,e,i,s){this.FNCanvas},this.DrawText=function(t,e,i,s,n,o,r){var a=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(null!=this.FNCanvas){this.SaveContext(),a.$assign(this.DrawTextInternal(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,!0));var l=n;0===l?this.DrawTextInternal(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+(e.Bottom-e.Top-(a.Bottom-a.Top))/2,e.Right,e.Top+(e.Bottom-e.Top-(a.Bottom-a.Top))/2+(a.Bottom-a.Top))),i,s,!1):1===l?this.DrawTextInternal(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top,e.Right,e.Top+(a.Bottom-a.Top))),i,s,!1):2===l&&this.DrawTextInternal(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Bottom-(a.Bottom-a.Top),e.Right,e.Bottom)),i,s,!1),this.RestoreContext()}},this.DrawPath=function(t,e,i){var s=[];if(null!=e){this.FActivePath=e,s=rtl.arraySetLength(s,pas["WEBLib.TMSFNCTypes"].TPointF,0),e.FlattenToPolygon({get:function(){return s},set:function(t){s=t}},.25);var n=i;0===n?this.DrawPolygon(t,rtl.arrayRef(s)):1===n&&this.DrawPolyline(t,rtl.arrayRef(s)),this.FActivePath=null}},this.FillPath=function(t,e,i){var s=[];if(null!=e){this.FActivePath=e,s=rtl.arraySetLength(s,pas["WEBLib.TMSFNCTypes"].TPointF,0),e.FlattenToPolygon({get:function(){return s},set:function(t){s=t}},.25);var n=i;0===n?this.FillPolygon(t,rtl.arrayRef(s)):1===n&&this.FillPolyline(t,rtl.arrayRef(s)),this.FActivePath=null}}})),this.GetNativeContextClass=function(){return t.TTMSFNCGraphicsContextWEB}}),["SysUtils","Math"]),rtl.module("WEBLib.TMSFNCGraphics",["System","Classes","WEBLib.TMSFNCGraphicsTypes","WEBLib.Graphics","JS","WEBLib.TMSFNCBitmapContainer","Types","WEBLib.TMSFNCTypes"],(function(){"use strict";var t=this;this.$rtti.$Class("TTMSFNCGraphics"),rtl.createClass(this,"TTMSFNCGraphicsContext",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FGraphics=null},this.$final=function(){this.FGraphics=void 0,pas.System.TObject.$final.call(this)},this.GetCanvas=function(){var t=null;return t=null,null!=this.GetGraphics()&&(t=this.GetGraphics().GetCanvas()),t},this.GetGraphics=function(){return this.FGraphics},this.Create$1=function(t){return this.FGraphics=t,this},this.ConvertToPath=function(t,e){var i,s=0,n=0,o=[],r=rtl.arraySetLength(null,pas["WEBLib.TMSFNCTypes"].TPointF,4),a=0,l=0,h=0,F=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),p=pas["WEBLib.TMSFNCTypes"].TPointF.$new();if(i=this.CreatePath(),t.GetCount()>0)for(a=Math.max(e,.05),s=0;s<t.GetCount();){var c=t.GetPoint(s).Kind;if(0===c)this.PathOpen(i),this.PathMoveTo(i,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(t.GetPoint(s).Point)),F.$assign(t.GetPoint(s).Point);else if(1===c)this.PathLineTo(i,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(t.GetPoint(s).Point)),F.$assign(t.GetPoint(s).Point);else if(2===c){r[0].$assign(F),r[1].$assign(t.GetPoint(s).Point),s+=1,r[2].$assign(t.GetPoint(s).Point),s+=1,r[3].$assign(t.GetPoint(s).Point),o=t.CreateBezier(r,6),l=0;for(var u=0,T=rtl.length(o)-1-1;u<=T;u++)n=u,p.X=o[n].X-o[n+1].X,p.Y=o[n].Y-o[n+1].Y,l+=pas["WEBLib.TMSFNCTypes"].GetPointLength(p);if((h=Math.round(l/a))<2)this.PathLineTo(i,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(r[3]));else{o=t.CreateBezier(r,h);for(var C=0,S=rtl.length(o)-1;C<=S;C++)n=C,this.PathLineTo(i,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(o[n]));F.$assign(t.GetPoint(s).Point)}}else 3===c&&this.PathClose(i);s+=1}return i}})),rtl.createClass(this,"TTMSFNCGraphics",pas.System.TObject,(function(){this.DefaultSelectionFillColor=0,this.DefaultTextFontColor=0,this.DefaultPopupFillColor=0,this.DefaultPopupStrokeColor=0,this.DefaultButtonStrokeColorFocused=0,this.DefaultButtonFillColorFocused=0,this.DefaultButtonStrokeColorDisabled=0,this.DefaultButtonFillColorDisabled=0,this.DefaultButtonStrokeColor=0,this.DefaultButtonFillColor=0,this.$init=function(){pas.System.TObject.$init.call(this),this.FActiveCanvas=null,this.FBlockUpdate=0,this.FNative=!1,this.FContextNative=null,this.FContextGeneral=null,this.FBitmap=null,this.FFill=null,this.FStroke=null,this.FFont=null,this.FHighlightColor=0,this.FOptimizedHTMLDrawing=!1,this.FHighlightTextColor=0,this.FHighlightFontStyles={},this.FURLUnderline=!1,this.FURLColor=0,this.FBitmapContainer=null},this.$final=function(){this.FActiveCanvas=void 0,this.FContextNative=void 0,this.FContextGeneral=void 0,this.FBitmap=void 0,this.FFill=void 0,this.FStroke=void 0,this.FFont=void 0,this.FHighlightFontStyles=void 0,this.FBitmapContainer=void 0,pas.System.TObject.$final.call(this)},this.GetCanvas=function(){return this.FActiveCanvas},this.GetContext=function(){return this.FNative?this.FContextNative:this.FContextGeneral},this.FontChanged=function(t){this.SetFont(rtl.as(t,pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont))},this.FillChanged=function(t){this.SetFill(rtl.as(t,pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill))},this.StrokeChanged=function(t){this.SetStroke(rtl.as(t,pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke))},this.InitializeDefaultAppearance=function(){this.FURLColor=16711680,this.FURLUnderline=!0,this.SetFill(this.FFill),this.SetStroke(this.FStroke),this.SetFont(this.FFont)},this.InternalCalculateText=function(t,e,i,s){var n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o="",r="",a="",l=0,h=0,F=0,p=0,c=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),u=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),T=0,C="",S="",d="";return n.$assign(e),Math.round(n.Right-n.Left)<=0?(n.Bottom=n.Top,n):(""!==t?s&&(pas.System.Pos("</",t)>0||pas.System.Pos("/>",t)>0||pas.System.Pos("<BR>",pas.SysUtils.UpperCase(t))>0)?(c.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),l=0,h=0,F=-1,p=-1,a="",r="",o="",T=0,u.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),C="",d="",S="",pas["WEBLib.TMSFNCHTMLEngine"].HTMLDrawEx$1(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),0,0,-1,-1,0,!1,!0,!1,!1,!1,!1,i,!1,"",1,this.FURLColor,-1,-1,-1,{get:function(){return o},set:function(t){o=t}},{get:function(){return r},set:function(t){r=t}},{get:function(){return a},set:function(t){a=t}},{get:function(){return l},set:function(t){l=t}},{get:function(){return h},set:function(t){h=t}},{get:function(){return F},set:function(t){F=t}},{get:function(){return p},set:function(t){p=t}},c,u,{get:function(){return C},set:function(t){C=t}},{get:function(){return d},set:function(t){d=t}},{get:function(){return S},set:function(t){S=t}},{get:function(){return T},set:function(t){T=t}},0,this.FBitmapContainer,1,this.FURLUnderline,this.FHighlightColor,this.FHighlightTextColor,rtl.refSet(this.FHighlightFontStyles)),h+=1,n.Right=n.Left+l,n.Bottom=n.Top+h):(n.$assign(this.GetContext().CalculateText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)),n.Bottom=n.Bottom+1):(n.Right=n.Left,n.Bottom=n.Top),n)},this.InternalDrawText=function(t,e,i,s,n,o,r,a,l,h,F,p,c,u,T,C){var S,d="",m="",f="",g="",y=0,b=0,N=0,M=0,B=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),E=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),L=0,D=0,A=0,$=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),I=!1,P=null;if(S=this.GetContext().GetFillColor(),this.GetContext().SetFillColor(this.FFont.FColor),p>-1&&t.Bottom-t.Top<p&&(t.Bottom=t.Top+p),F>-1&&t.Right-t.Left<F&&(t.Right=t.Left+F),t.$assign(this.GetContext().SetTextAngle(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),h)),d="",(pas.System.Pos("</",e)>0||pas.System.Pos("/>",e)>0||pas.System.Pos("<BR>",pas.SysUtils.UpperCase(e))>0)&&c){if(B.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),y=0,b=0,N=-1,M=-1,g="",f="",m="",A=0,E.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),i.set(""),s.set(""),n.set(""),pas["WEBLib.TMSFNCHTMLEngine"].HTMLDrawEx$1(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),0,0,-1,-1,0,!1,!0,!1,!1,!1,!1,o,!1,"",1,this.FURLColor,-1,-1,-1,{get:function(){return m},set:function(t){m=t}},{get:function(){return f},set:function(t){f=t}},{get:function(){return g},set:function(t){g=t}},{get:function(){return y},set:function(t){y=t}},{get:function(){return b},set:function(t){b=t}},{get:function(){return N},set:function(t){N=t}},{get:function(){return M},set:function(t){M=t}},B,E,i,s,n,{get:function(){return A},set:function(t){A=t}},0,this.FBitmapContainer,1,this.FURLUnderline,this.FHighlightColor,this.FHighlightTextColor,rtl.refSet(this.FHighlightFontStyles)),b+=1,y+=1,o&&A<=1||!o){L=t.Left,D=t.Top;var v=r;0===v?L+=(t.Right-t.Left-y)/2:2===v&&(L=t.Left+(t.Right-t.Left)-y);var G=a;0===G?D+=(t.Bottom-t.Top-b)/2:2===G&&(D=D+(t.Bottom-t.Top)-b),$.$assign(pas["WEBLib.TMSFNCTypes"].RectF(L,D,L+y,D+b))}else $.$assign(t);P=this.SaveState(!0),this.ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t)),I=pas["WEBLib.TMSFNCHTMLEngine"].HTMLDrawEx$1(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone($),Math.round(T),Math.round(C),-1,-1,0,u,!1,!1,!1,!1,!1,o,!1,"",1,this.FURLColor,-1,-1,-1,{get:function(){return m},set:function(t){m=t}},{get:function(){return f},set:function(t){f=t}},{get:function(){return g},set:function(t){g=t}},{get:function(){return y},set:function(t){y=t}},{get:function(){return b},set:function(t){b=t}},{get:function(){return N},set:function(t){N=t}},{get:function(){return M},set:function(t){M=t}},B,E,i,s,n,{get:function(){return A},set:function(t){A=t}},0,this.FBitmapContainer,1,this.FURLUnderline,this.FHighlightColor,this.FHighlightTextColor,rtl.refSet(this.FHighlightFontStyles)),this.RestoreState(P,!0),I&&(d=m)}else u||this.GetContext().DrawText(e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),o,r,a,l,h);return this.GetContext().ResetTextAngle(h),this.GetContext().SetFillColor(S),d},this.DrawTexture=function(t,e,i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=0,a=0;if(!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(e)){s.$assign(t);var l=i;if(0===l)n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left,t.Top,t.Left+e.GetWidth(),t.Top+e.GetHeight())),pas["WEBLib.TMSFNCTypes"].IntersectRectEx$1(o,s,n),this.DrawBitmapPart$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,o.Right-o.Left,o.Bottom-o.Top)),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(n.Left,n.Top,n.Left+(o.Right-o.Left),n.Top+(o.Bottom-o.Top))),e,!1,!1,!1,!1);else if(1===l)n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,e.GetWidth(),e.GetHeight())),n.$assign(pas["WEBLib.TMSFNCTypes"].RectSnapToPixelEx(pas["WEBLib.TMSFNCTypes"].RectFitIntoEx$1(n,t),1,!1)),this.DrawBitmapPart$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,e.GetWidth(),e.GetHeight())),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),e,!1,!0,!1,!1);else if(2===l)this.DrawBitmapPart$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,e.GetWidth(),e.GetHeight())),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),e,!1,!0,!1,!1);else if(4===l)for(var h=0,F=pas.System.Trunc((s.Right-s.Left)/e.GetWidth())+1;h<=F;h++){r=h;for(var p=0,c=pas.System.Trunc((s.Bottom-s.Top)/e.GetHeight())+1;p<=c;p++)a=p,n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left,s.Top,s.Left+e.GetWidth(),s.Top+e.GetHeight())),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(n,r*e.GetWidth(),a*e.GetHeight()),pas["WEBLib.TMSFNCTypes"].IntersectRectEx$1(o,s,n),pas["WEBLib.TMSFNCTypes"].IntersectRectEx(o,n)&&this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(n.Left,n.Top,n.Left+(o.Right-o.Left),n.Top+(o.Bottom-o.Top))),e,!1,!1,!1,!1)}else 3===l&&(n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,e.GetWidth(),e.GetHeight())),n.$assign(pas["WEBLib.TMSFNCTypes"].RectSnapToPixelEx(pas["WEBLib.TMSFNCTypes"].RectCenterAtEx(n,t),1,!1)),this.DrawBitmapPart$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,e.GetWidth(),e.GetHeight())),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),e,!0,!1,!0,!1))}},this.DrawSVG=function(t,e){return!1,!1},this.Create$1=function(t,e){return this.FNative=e,this.FActiveCanvas=t,e?(this.FContextNative=pas["WEBLib.TMSFNCGraphics.WEB"].GetNativeContextClass().$create("Create$1",[this]),this.FContextNative.SetSize(1,1)):(this.FContextGeneral=pas["WEBLib.TMSFNCGraphics.General"].TTMSFNCGraphicsContextGeneral.$create("Create$1",[this]),this.FContextGeneral.SetSize(1,1)),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FHighlightColor=16711680,this.FHighlightTextColor=16777215,this.FHighlightFontStyles={},this.InitializeDefaultAppearance(),this},this.CreateBitmapCanvas=function(t,e,i,s){return this.FNative=i,this.FBitmap=pas["WEBLib.Graphics"].TBitmap.$create("Create$3"),this.FBitmap.SetWidth(t),this.FBitmap.SetHeight(e),this.FActiveCanvas=this.FBitmap.GetCanvas(),i?(this.FContextNative=pas["WEBLib.TMSFNCGraphics.WEB"].GetNativeContextClass().$create("Create$1",[this]),this.FContextNative.SetSize(t,e)):(this.FContextGeneral=pas["WEBLib.TMSFNCGraphics.General"].TTMSFNCGraphicsContextGeneral.$create("Create$1",[this]),this.FContextGeneral.SetSize(t,e)),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.InitializeDefaultAppearance(),this},this.Destroy=function(){null!=this.FContextNative&&(rtl.free(this,"FContextNative"),this.FContextNative=null),null!=this.FContextGeneral&&(rtl.free(this,"FContextGeneral"),this.FContextGeneral=null),null!=this.FFont&&(rtl.free(this,"FFont"),this.FFont=null),null!=this.FFill&&(this.FFill.FOnChanged=null,rtl.free(this,"FFill"),this.FFill=null),null!=this.FStroke&&(this.FStroke.FOnChanged=null,rtl.free(this,"FStroke"),this.FStroke=null),this.FBitmapContainer=null,null!=this.FBitmap&&(rtl.free(this,"FBitmap"),this.FBitmap=null),pas.System.TObject.Destroy.call(this)},this.StartSpecialPen=function(){this.GetContext().StartSpecialPen()},this.StopSpecialPen=function(){this.GetContext().StopSpecialPen()},this.BeginScene=function(){this.GetContext().BeginScene()},this.EndScene=function(){this.GetContext().EndScene()},this.SetFill=function(t){this.FBlockUpdate>0||(this.FBlockUpdate+=1,this.GetContext().SetFill(t),this.FFill.Assign(t),this.FBlockUpdate-=1)},this.SetStroke=function(t){this.FBlockUpdate>0||(this.FBlockUpdate+=1,this.GetContext().SetStroke(t),this.FStroke.Assign(t),this.FBlockUpdate-=1)},this.RestoreState=function(t,e){e||(this.SetFill(t.FFill),this.SetStroke(t.FStroke),this.SetFont(t.FFont)),this.GetContext().RestoreState(t),t=rtl.freeLoc(t)},this.SetFont=function(t){this.FBlockUpdate>0||(this.FBlockUpdate+=1,this.GetContext().SetFont(t),this.FFont.AssignSource(t),this.FBlockUpdate-=1)},this.DrawLine$1=function(t,e,i,s){-1!==this.FStroke.FColor&&0!==this.FStroke.FKind&&this.GetContext().DrawLine(this.FStroke,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(t),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(e),i,s)},this.DrawFocusRectangle$2=function(t,e,i,s,n,o){var r=pas["WEBLib.TMSFNCTypes"].TRectF.$new();r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t,e,i,s)),this.GetContext().DrawFocusRectangle(this.FStroke,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),n,o)},this.DrawFocusRectangle$3=function(t,e,i){this.DrawFocusRectangle$2(t.Left,t.Top,t.Right,t.Bottom,e,i)},this.DrawPath=function(t,e){(-1!==this.FFill.FColor&&0!==this.FFill.FKind||3===this.FFill.FKind)&&(3===this.FFill.FKind?this.DrawTexture(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t.GetBounds()),this.FFill.FTexture,this.FFill.FTextureMode):this.GetContext().FillPath(this.FFill,t,e));-1!==this.FStroke.FColor&&0!==this.FStroke.FKind&&this.GetContext().DrawPath(this.FStroke,t,e)},this.DrawArc=function(t,e,i,s){var n=null;if(-1!==this.FFill.FColor&&0!==this.FFill.FKind)if(3===this.FFill.FKind){n=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{n.AddArc(t,e,i,s),this.DrawTexture(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n.GetBounds()),this.FFill.FTexture,this.FFill.FTextureMode)}finally{n=rtl.freeLoc(n)}}else this.GetContext().FillArc(this.FFill,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(t),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(e),i,s);-1!==this.FStroke.FColor&&0!==this.FStroke.FKind&&this.GetContext().DrawArc(this.FStroke,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(t),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(e),i,s)},this.DrawRectangle=function(t,e,i,s,n){this.DrawRectangle$1(t,e,i,s,pas["WEBLib.TMSFNCGraphicsTypes"].AllSides,n)},this.DrawRectangle$1=function(t,e,i,s,n,o){var r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=null;if(r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t,e,i,s)),-1!==this.FFill.FColor&&0!==this.FFill.FKind||3===this.FFill.FKind)if(3===this.FFill.FKind){a=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{a.AddRectangle(r,0,0),this.DrawTexture(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),this.FFill.FTexture,this.FFill.FTextureMode)}finally{a=rtl.freeLoc(a)}}else this.GetContext().FillRect(this.FFill,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),o);-1!==this.FStroke.FColor&&0!==this.FStroke.FKind&&this.GetContext().DrawRect(this.FStroke,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),rtl.refSet(n),o)},this.DrawEllipse=function(t,e,i,s,n){var o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=null;if(o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t,e,i,s)),-1!==this.FFill.FColor&&0!==this.FFill.FKind||3===this.FFill.FKind)if(3===this.FFill.FKind){r=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{r.AddEllipse(o),this.DrawTexture(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),this.FFill.FTexture,this.FFill.FTextureMode)}finally{r=rtl.freeLoc(r)}}else this.GetContext().FillEllipse(this.FFill,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),n);-1!==this.FStroke.FColor&&0!==this.FStroke.FKind&&this.GetContext().DrawEllipse(this.FStroke,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),n)},this.DrawRectangle$2=function(t,e){this.DrawRectangle(t.Left,t.Top,t.Right,t.Bottom,e)},this.DrawRectangle$3=function(t,e,i){this.DrawRectangle$1(t.Left,t.Top,t.Right,t.Bottom,rtl.refSet(e),i)},this.DrawRoundRectangle=function(t,e,i,s,n,o,r){var a=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),l=0,h=null;if(a.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t,e,i,s)),-1!==this.FFill.FColor&&0!==this.FFill.FKind||3===this.FFill.FKind)if(3===this.FFill.FKind){h=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{l=n,2 in o?(h.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+l,a.Bottom)),h.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+l,a.Bottom-l),pas["WEBLib.TMSFNCTypes"].PointF(l,l),-270,90),h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Bottom-l))):h.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Bottom)),0 in o?(h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Top+l)),h.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+l,a.Top+l),pas["WEBLib.TMSFNCTypes"].PointF(l,l),-180,90),h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+l,a.Top))):h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Top)),1 in o?(h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-l,a.Top)),h.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-l,a.Top+l),pas["WEBLib.TMSFNCTypes"].PointF(l,l),-90,90),h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Top+l))):h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Top)),3 in o?(h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Bottom-l)),h.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-l,a.Bottom-l),pas["WEBLib.TMSFNCTypes"].PointF(l,l),0,90),h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right-l,a.Bottom))):h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Right,a.Bottom)),2 in o?h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left+l,a.Bottom)):h.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(a.Left,a.Bottom)),h.ClosePath(),this.DrawTexture(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),this.FFill.FTexture,this.FFill.FTextureMode)}finally{h=rtl.freeLoc(h)}}else this.GetContext().FillRoundRect(this.FFill,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),n,rtl.refSet(o),r);-1!==this.FStroke.FColor&&0!==this.FStroke.FKind&&this.GetContext().DrawRoundRect(this.FStroke,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),n,rtl.refSet(o),r)},this.DrawRoundRectangle$1=function(t,e,i,s){this.DrawRoundRectangle(t.Left,t.Top,t.Right,t.Bottom,e,rtl.refSet(i),s)},this.DrawEllipse$2=function(t,e){this.DrawEllipse(t.Left,t.Top,t.Right,t.Bottom,e)},this.DrawBitmapPart=function(e,i,s,n,o,r,a,l,h,F,p,c,u){var T=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),C=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),S=null,d=null;if(T.$assign(pas["WEBLib.TMSFNCTypes"].RectF(o,r,a,l)),C.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e,i,s,n)),!pas["WEBLib.TMSFNCTypes"].RectIsEmpty(T)&&!pas["WEBLib.TMSFNCTypes"].RectIsEmpty(C)&&!this.DrawSVG(h,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(T))){S=t.TTMSFNCGraphics.$create("CreateBitmapCanvas",[Math.round(s-e),Math.round(n-i),this.FNative,!0]);try{S.BeginScene(),S.DrawBitmap(-e,-i,-e+S.FBitmap.GetWidth(),-i+S.FBitmap.GetHeight(),h,!1,!1,!1,!1),S.EndScene(),d=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3");try{d.Assign(S.FBitmap),this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(T),d,F,p,c,u)}finally{d=rtl.freeLoc(d)}}finally{S=rtl.freeLoc(S)}}},this.DrawBitmapPart$1=function(t,e,i,s,n,o,r){this.DrawBitmapPart(t.Left,t.Top,t.Right,t.Bottom,e.Left,e.Top,e.Right,e.Bottom,i,s,n,o,r)},this.DrawBitmap=function(t,e,i,s,n,o,r,a,l){var h=pas["WEBLib.TMSFNCTypes"].TRectF.$new();null!=n&&(h.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t,e,i,s)),h.$assign(this.GetBitmapDrawRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),n,o,r,a,l)),this.DrawSVG(n,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h))||this.GetContext().DrawBitmap(pas["WEBLib.TMSFNCTypes"].BitmapToDrawBitmap(n),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,n.GetWidth(),n.GetHeight())),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),1))},this.DrawBitmap$1=function(t,e,i,s,n,o){this.DrawBitmap(t.Left,t.Top,t.Right,t.Bottom,e,i,s,n,o)},this.DrawBitmap$5=function(t,e,i){this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(t,e,t+i.GetWidth(),e+i.GetHeight())),i,!0,!1,!0,!1)},this.DrawCheckBox=function(t,e,i,s,n){var o=0,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new();r.$assign(t),pas["WEBLib.TMSFNCTypes"].InflateRectEx(r,-1,-1),o=s?i?11829830:0:11119017,this.FFill.SetKind(1),s?this.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(13882323,85)):this.FFill.SetColor(13882323),this.FStroke.SetWidth(1),this.FStroke.SetKind(1),this.FStroke.SetColor(o),this.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),2),pas["WEBLib.TMSFNCTypes"].InflateRectEx(r,-(r.Right-r.Left)/5,-(r.Bottom-r.Top)/5),this.FStroke.SetWidth(2),this.FStroke.SetColor(o),e&&(this.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(r.Left,r.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(r.Right-1,r.Bottom-1)),2,2),this.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(r.Right-1,r.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(r.Left,r.Bottom-1)),2,2))},this.DrawButton=function(e,i,s,n,o,r){var a=pas["WEBLib.TMSFNCTypes"].TRectF.$new();a.$assign(e),this.FStroke.SetKind(1),this.FStroke.SetWidth(1),this.FFill.SetKind(1),o?n?s?(this.FStroke.SetColor(t.TTMSFNCGraphics.DefaultButtonStrokeColorFocused),this.FFill.SetColor(t.TTMSFNCGraphics.DefaultButtonFillColorFocused)):(this.FStroke.SetColor(t.TTMSFNCGraphics.DefaultButtonStrokeColor),this.FFill.SetColor(t.TTMSFNCGraphics.DefaultButtonFillColor)):(this.FStroke.SetColor(t.TTMSFNCGraphics.DefaultButtonStrokeColorDisabled),this.FFill.SetColor(t.TTMSFNCGraphics.DefaultButtonFillColorDisabled)):n?s?(this.FStroke.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177)),this.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251))):(this.FStroke.SetColor(11119017),this.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(225,225,225))):(this.FStroke.SetColor(11119017),this.FFill.SetColor(13882323)),this.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),2),pas["WEBLib.TMSFNCTypes"].InflateRectEx(a,-1,-1),this.FFill.SetKind(0),i?this.FStroke.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(this.FStroke.FColor,40)):this.FStroke.SetColor(this.FFill.FColor),this.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),2)},this.DrawCloseButton=function(e,i,s,n,o,r){var a=null,l=null,h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=null;if(this.DrawButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n,o,r),o){(l=pas["WEBLib.Graphics"].TBitmap.$create("Create$3")).SetSize(Math.round(16*r),Math.round(16*r)),F=t.TTMSFNCGraphics.$create("Create$1",[l.GetCanvas(),!1]);try{F.BeginScene(),F.FStroke.SetKind(1),F.FStroke.SetColor(t.TTMSFNCGraphics.DefaultSelectionFillColor),F.FStroke.SetWidth(2),F.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(3*r,3*r)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(12*r,12*r)),2,2),F.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(3*r,12*r)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(12*r,3*r)),2,2)}finally{F.EndScene(),F=rtl.freeLoc(F)}try{h.$assign(e),a=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3");try{a.Assign(l),this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),a,!0,!1,!0,!1)}finally{a=rtl.freeLoc(a)}}finally{l=rtl.freeLoc(l)}}else{a=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSCLOSESVG);try{h.$assign(e),pas["WEBLib.TMSFNCTypes"].InflateRectEx(h,-6*r,-6*r),this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),a,!0,!1,!0,!1)}finally{a=rtl.freeLoc(a)}}},this.DrawExpanderButton=function(e,i,s,n,o,r,a){var l=null,h=null,F=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),p=null;if(this.DrawButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),s,n,o,r,a),r){(l=pas["WEBLib.Graphics"].TBitmap.$create("Create$3")).SetSize(Math.round(16*a),Math.round(16*a)),p=t.TTMSFNCGraphics.$create("Create$1",[l.GetCanvas(),!1]);try{p.BeginScene(),p.FStroke.SetKind(1),p.FStroke.SetWidth(2),p.FStroke.SetColor(t.TTMSFNCGraphics.DefaultSelectionFillColor);var c=i;0===c?(p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(5*a,6*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(8*a,9*a)),2,2),p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(8*a,9*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(11*a,6*a)),2,2)):1===c&&(p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(5*a,9*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(8*a,6*a)),2,2),p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(8*a,6*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(11*a,9*a)),2,2))}finally{p.EndScene(),p=rtl.freeLoc(p)}if(null!=l)try{F.$assign(e),h=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3");try{h.Assign(l),this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),h,!0,!1,!0,!1)}finally{h=rtl.freeLoc(h)}}finally{l=rtl.freeLoc(l)}}else{var u=i;if(null!=(h=0===u?pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSDOWNSVG):1===u?pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSUPSVG):null))try{F.$assign(e),pas["WEBLib.TMSFNCTypes"].InflateRectEx(F,-4*a,-4*a),this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),h,!0,!1,!0,!1)}finally{h=rtl.freeLoc(h)}}},this.DrawCompactButton=function(e,i,s,n,o,r,a){var l=null,h=null,F=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),p=null;if(this.DrawButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),s,n,o,r,a),r){(l=pas["WEBLib.Graphics"].TBitmap.$create("Create$3")).SetSize(Math.round(16*a),Math.round(16*a)),p=t.TTMSFNCGraphics.$create("Create$1",[l.GetCanvas(),!1]);try{p.BeginScene(),p.FStroke.SetKind(1),p.FStroke.SetWidth(2),p.FStroke.SetColor(t.TTMSFNCGraphics.DefaultSelectionFillColor);var c=i;0===c?(p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(6*a,5*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(9*a,8*a)),2,2),p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(9*a,8*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(6*a,11*a)),2,2)):1===c&&(p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(9*a,5*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(6*a,8*a)),2,2),p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(6*a,8*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(9*a,11*a)),2,2))}finally{p.EndScene(),p=rtl.freeLoc(p)}if(null!=l)try{F.$assign(e),h=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3");try{h.Assign(l),this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),h,!0,!1,!0,!1)}finally{h=rtl.freeLoc(h)}}finally{l=rtl.freeLoc(l)}}else{var u=i;if(null!=(h=0===u?pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSRIGHTSVG):1===u?pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSLEFTSVG):null))try{F.$assign(e),pas["WEBLib.TMSFNCTypes"].InflateRectEx(F,-4*a,-4*a),this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),h,!0,!1,!0,!1)}finally{h=rtl.freeLoc(h)}}},this.DrawDropDownButton=function(e,i,s,n,o,r,a){var l=null,h=null,F=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),p=null;if(this.DrawButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n,r,1),r){(h=pas["WEBLib.Graphics"].TBitmap.$create("Create$3")).SetSize(Math.round(7*a),Math.round(7*a)),p=t.TTMSFNCGraphics.$create("Create$1",[h.GetCanvas(),!1]);try{p.BeginScene(),p.FStroke.SetKind(1),p.FStroke.SetColor(t.TTMSFNCGraphics.DefaultSelectionFillColor),p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(0,1*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(6*a,1*a)),2,2),p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(0,2*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(6*a,2*a)),2,2),p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(1*a,3*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(5*a,3*a)),2,2),p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(2*a,4*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(4*a,4*a)),2,2),p.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(3*a,5*a)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(3*a,5*a)),2,2)}finally{p.EndScene(),p=rtl.freeLoc(p)}try{e.Right-h.GetWidth()-10*a>e.Left&&!o?F.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Right-h.GetWidth()-10*a,e.Top,e.Right,e.Bottom)):F.$assign(e),l=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3");try{l.Assign(h),this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),l,!0,!1,!0,!1)}finally{l=rtl.freeLoc(l)}}finally{h=rtl.freeLoc(h)}}else{(l=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3")).LoadFromResource(t.TMSFNCGRAPHICSEXPANDSVG);try{o?(F.$assign(e),pas["WEBLib.TMSFNCTypes"].InflateRectEx(F,-4*a,-4*a)):(F.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Right-16*a,e.Top,e.Right-2*a,e.Bottom)),pas["WEBLib.TMSFNCTypes"].InflateRectEx(F,-2*a,-2*a)),this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),l,!0,!1,!0,!1)}finally{l=rtl.freeLoc(l)}}},this.DrawRadioButton=function(t,e,i,s,n){var o=0,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new();r.$assign(t),pas["WEBLib.TMSFNCTypes"].InflateRectEx(r,-1,-1),o=s?i?11829830:0:11119017,this.FFill.SetKind(1),s?this.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(13882323,85)):this.FFill.SetColor(13882323),this.FStroke.SetKind(1),this.FStroke.SetWidth(1),this.FStroke.SetColor(o),this.DrawEllipse$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),2),pas["WEBLib.TMSFNCTypes"].InflateRectEx(r,-(r.Right-r.Left)/5,-(r.Bottom-r.Top)/5),this.FFill.SetKind(1),this.FFill.SetColor(o),e&&this.DrawEllipse$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),2)},this.DrawProgressBar=function(t,e,i,s,n,o,r,a,l){var h,F,p=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),c=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),u=0;p.$assign(t),c.$assign(p),F=this.FFill.FColor,a?this.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(13882323,75)):this.FFill.SetColor(13882323),this.FFill.SetKind(1),this.FStroke.SetKind(1),this.FStroke.SetColor(11119017),this.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(p),2),(h=Math.max(0,Math.min(e,s)))>=0&&h<=s&&s>0&&(pas["WEBLib.TMSFNCTypes"].InflateRectEx(c,-1,-1),c.Right=c.Left+(c.Right-p.Left)*h/s,this.FFill.SetColor(n),this.FStroke.SetColor(this.FFill.FColor),this.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(c),2),r&&(u=this.FFont.FColor,this.FFont.SetColor(o),this.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(p),pas.SysUtils.Format(i,pas.System.VarRecs(3,h/s*100)),!1,0,0,0,0,-1,-1,!0,!1,-1,-1),this.FFont.SetColor(u))),this.FFill.SetColor(F)},this.DrawBitmapWithName$1=function(t,e,i,s,n,o,r,a){var l;null!=(l=this.$class.GetBitmapFromBitmapContainer(this.FBitmapContainer,e,i,s))&&this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),l,n,o,r,a)},this.DrawScaledBitmap=function(t,e,i,s,n,o,r){var a=null,l=null;null!=e&&null!=(a=i>0?e.GetItemByScale(i):e.GetItemByScale(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(null,-1)))&&(null==a.FBitmap||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(a.FBitmap)?null==(l=this.$class.GetBitmapFromBitmapContainer(this.FBitmapContainer,a.FBitmapName,!0,i))||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(l)?this.DrawBitmapWithName$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),a.FBitmapName,!1,a.FScale,s,n,o,r):this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),l,s,n,o,r):this.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),a.FBitmap,s,n,o,r))},this.GetBitmapDrawRectangle=function(t,e,i,s,n,o,r,a,l){var h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=null,p=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),c=0,u=0,T=0,C=0;return h.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),null!=(F=n)&&(T=0,C=0,c=0,u=0,this.$class.GetAspectSize({get:function(){return c},set:function(t){c=t}},{get:function(){return u},set:function(t){u=t}},F.GetWidth(),F.GetHeight(),i-t,s-e,o,r,l),(a||l)&&(T=Math.round((i-t-c)/2),C=Math.round((s-e-u)/2)),p.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t+T,e+C,t+T+c,e+C+u)),h.$assign(p)),h},this.GetBitmapDrawRectangle$1=function(t,e,i,s,n,o){var r=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return r.$assign(this.GetBitmapDrawRectangle(t.Left,t.Top,t.Right,t.Bottom,e,i,s,n,o)),r},this.ClipRect=function(t){this.GetContext().ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t))},this.CalculateTextSize=function(t,e,i,s){var n=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return o.$assign(this.CalculateText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)),n.cx=o.Right-o.Left,n.cy=o.Bottom-o.Top,n},this.CalculateTextWidth=function(t,e,i,s){var n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return n.$assign(this.CalculateText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)),n.Right-n.Left},this.CalculateTextHeight=function(t,e,i,s){var n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return n.$assign(this.CalculateText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)),n.Bottom-n.Top};var e=["<BR>","<BR/>"];this.CalculateText=function(t,i,s,n){var o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=null,a=0,l=0,h=0,F=!1,p=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),c=0;if(o.$assign(i),F=this.FOptimizedHTMLDrawing&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IsHTML(t)){for(a=0;a<=1;a++)h=pas.System.Pos(e[a],pas.SysUtils.UpperCase(t)),l=e[a].length;if(h>0&&l>0){r=pas.Classes.TStringList.$create("Create$1");try{r.SetLineBreak(pas.System.Copy(t,h,l)),r.SetTextStr(t),c=0;for(var u=0,T=r.GetCount()-1;u<=T;u++)a=u,p.$assign(this.InternalCalculateText(r.Get(a),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,n)),c+=p.Bottom-p.Top;o.Bottom=o.Top+c}finally{r=rtl.freeLoc(r)}}else F=!1}return F||o.$assign(this.InternalCalculateText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,n)),o},this.CalculateTextSize$1=function(t){var e=pas["WEBLib.TMSFNCTypes"].TSizeF.$new();return e.$assign(this.CalculateTextSize(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),!1,!0)),e},this.CalculateTextWidth$1=function(t){return this.CalculateTextWidth(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),!1,!0)},this.CalculateTextHeight$1=function(t){return this.CalculateTextHeight(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),!1,!0)},this.CalculateText$1=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(this.CalculateText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),!1,!0)),e},this.DrawText$1=function(t,e,i,s,n,o,r,a,l,h,F,p,c){var u="",T="",C="";return u="",T="",C="",this.DrawText$5(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),e,{get:function(){return u},set:function(t){u=t}},{get:function(){return T},set:function(t){T=t}},{get:function(){return C},set:function(t){C=t}},i,s,n,o,r,a,l,h,F,p,c)};var i=["<BR>","<BR/>"];this.DrawText$5=function(t,e,s,n,o,r,a,l,h,F,p,c,u,T,C,S){var d="",m=null,f=0,g=0,y=0,b=!1,N=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),M=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(M.$assign(t),b=(b=!T&&this.FOptimizedHTMLDrawing)&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IsHTML(e)){for(f=0;f<=1;f++)y=pas.System.Pos(i[f],pas.SysUtils.UpperCase(e)),g=i[f].length;if(y>0&&g>0){m=pas.Classes.TStringList.$create("Create$1");try{m.SetLineBreak(pas.System.Copy(e,y,g)),m.SetTextStr(e);for(var B=0,E=m.GetCount()-1;B<=E;B++)f=B,N.$assign(this.CalculateText(m.Get(f),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(M),r,u)),this.InternalDrawText(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(N.Left,N.Top,N.Right+1,N.Bottom)),m.Get(f),s,n,o,r,a,l,h,F,p,c,u,T,C,S),M.Top=M.Top+(N.Bottom-N.Top),M.Bottom=M.Bottom+(N.Bottom-N.Top)}finally{m=rtl.freeLoc(m)}}else b=!1}return b||(d=this.InternalDrawText(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),e,s,n,o,r,a,l,h,F,p,c,u,T,C,S)),d},this.SaveState=function(t){var e=null;return e=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsSaveState.$create("Create$1"),t||(e.FFill.Assign(this.FFill),e.FStroke.Assign(this.FStroke),e.FFont.AssignSource(this.FFont)),this.GetContext().SaveState(e),e},this.GetBitmapFromBitmapContainer=function(t,e,i,s){var n=null;return n=null,null!=t&&""!==e&&(i&&(n=s>0?t.FindBitmap$1(e+"_"+pas.SysUtils.FloatToStr(s)):t.FindBitmap$1(e+"_"+pas.SysUtils.FloatToStr(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(null,-1)))),null==n&&(n=t.FindBitmap$1(e))),n},this.GetScaledBitmap=function(t,e,i){var s=null,n=null,o=null;return s=null,null!=t&&null!=(n=e>0?t.GetItemByScale(e):t.GetItemByScale(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(null,-1)))&&(null==n.FBitmap||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(n.FBitmap)?(null==(o=this.GetBitmapFromBitmapContainer(i,n.FBitmapName,!0,e))||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(o))&&(null==(o=this.GetBitmapFromBitmapContainer(i,n.FBitmapName,!1,0))||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(o))||(s=o):s=n.FBitmap),s},this.GetAspectSize=function(t,e,i,s,n,o,r,a,l){var h=0,F=0;r?i>0&&s>0&&n>0&&o>0?i<n&&s<o&&!a?(t.set(i),e.set(s)):i/s<n/o?(e.set(o),t.set(o*i/s)):(t.set(n),e.set(n*s/i)):(t.set(0),e.set(0)):a?(t.set(n),e.set(o)):(t.set(i),e.set(s),l&&(t.get()>=e.get()&&t.get()>0?(e.set(i/t.get()*e.get()),t.set(i)):e.get()>=t.get()&&e.get()>0&&(t.set(s/e.get()*t.get()),e.set(s)),h=0===s?1:i/s,(F=0===e.get()?1:t.get()/e.get())<1||h>F?(e.set(i/F),t.set(i)):(t.set(F*s),e.set(s))))},this.SetDefaultGraphicColors=function(){t.TTMSFNCGraphics.DefaultPopupFillColor=16777215,t.TTMSFNCGraphics.DefaultPopupStrokeColor=12632256,t.TTMSFNCGraphics.DefaultButtonFillColor=pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(225,225,225),t.TTMSFNCGraphics.DefaultButtonStrokeColor=11119017,t.TTMSFNCGraphics.DefaultTextFontColor=0,t.TTMSFNCGraphics.DefaultSelectionFillColor=0,t.TTMSFNCGraphics.DefaultButtonFillColorFocused=pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251),t.TTMSFNCGraphics.DefaultButtonStrokeColorFocused=pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177),t.TTMSFNCGraphics.DefaultButtonStrokeColorDisabled=11119017,t.TTMSFNCGraphics.DefaultButtonFillColorDisabled=13882323},this.PointInPath=function(t,e){return e.IsPointVisible(t)},this.PointInRect=function(t,e){return pas["WEBLib.TMSFNCTypes"].PtInRectEx(e,t)},this.GetColorRed=function(t){return t=pas["WEBLib.Graphics"].ColorToRGB(t),pas["WEBLib.Graphics"].GetRValue(t)},this.GetColorGreen=function(t){return t=pas["WEBLib.Graphics"].ColorToRGB(t),pas["WEBLib.Graphics"].GetGValue(t)},this.GetColorBlue=function(t){return t=pas["WEBLib.Graphics"].ColorToRGB(t),pas["WEBLib.Graphics"].GetBValue(t)},this.HTMLToColor=function(t){var e=0,i=0,s=0,n=0;return e=-1,""===t?e:(4===t.length?(i=pas.SysUtils.StrToInt("$"+pas.System.Copy(t,2,1)+pas.System.Copy(t,2,1)),s=pas.SysUtils.StrToInt("$"+pas.System.Copy(t,3,1)+pas.System.Copy(t,3,1)),n=pas.SysUtils.StrToInt("$"+pas.System.Copy(t,4,1)+pas.System.Copy(t,4,1))):(i=pas.SysUtils.StrToInt("$"+pas.System.Copy(t,2,2)),s=pas.SysUtils.StrToInt("$"+pas.System.Copy(t,4,2)),n=pas.SysUtils.StrToInt("$"+pas.System.Copy(t,6,2))),e=pas["WEBLib.Graphics"].RGB(i,s,n))},this.TextToColor=function(t){var e=0,i=0,s="",n=null;return s=t,s=pas.SysUtils.LowerCase(s),1===pas.System.Pos("cl",s)&&pas.System.Delete({get:function(){return s},set:function(t){s=t}},1,2),1===pas.System.Pos("cla",s)&&pas.System.Delete({get:function(){return s},set:function(t){s=t}},1,3),1===pas.System.Pos("gc",s)&&pas.System.Delete({get:function(){return s},set:function(t){s=t}},1,2),e=0,null!=(n=pas["WEBLib.TMSFNCGraphicsTypes"].ColorLookup())&&(i=n.IndexOf(pas.SysUtils.LowerCase(s)))>=0&&i<=n.GetCount()-1&&(e=n.GetObject(i).FColor),e}})),this.TMSFNCGRAPHICSCLOSE="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuOWwzfk4AAABVSURBVDhPYxh+QBSI/0OYWAFIThjCxA5ACmAYHeCTQwHYFGITwwuQNSBjkgBFmkGAIgNAGv5BaZINQdYMA0Qbgk0zDBBlCCiR4FMAkhOCMIcJYGAAAHvVMBv6PIFYAAAAAElFTkSuQmCC",this.TMSFNCGRAPHICSDOWN="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAGdJREFUOI3tzjsOwjAURNGDUqSgTxU5K2AVrJtswjUsgHSR0qdxAZZFPrS+3ZvRzBsqf9MUtBtazJk+oMe0VTriiZCFX8nbpENMgfARjsn74vKj5IFruhfc8d6zIF9S/Hyk5HS4spMVeFcOjszaOwMAAAAASUVORK5CYII=",this.TMSFNCGRAPHICSDOWN2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAAAdElEQVQ4T6XMsQ2AMBBD0UxBBwyA2L9jCWpY5bCLSJfgSFgUr+AHX4mIX2R0yOiQ0SGjQ8Ud5q7RClvX5IEDLlhS4/gGvuV/5YEJTuCAR+qYjW/N/81Hko8Mx/QKST0yHJOMCYfDMcnokNEho0NGh4zfRXkAxSYKjdpwcIUAAAAASUVORK5CYII=",this.TMSFNCGRAPHICSUP="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAEZJREFUOI3tjLEJACAMwLLo5EM+rTjpXV7g0oI4tYKbgYwJfJ6Txet4iu6Jxk10TTSuQACidzKAIrGik24ZpCPeJ8ky+DhZ1JENPrPndiwAAAAASUVORK5CYII=",this.TMSFNCGRAPHICSUP2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAAAcklEQVQ4T6XMMQ6AMAiF4S46eSEvremk5/IC+GggKfE1ER2+gZ9AEZFfaMygMYPGDBozaOyshu0aGo0eXmb4hEbw42qGTx4B/HiHCWYYPgmDOWEDPfbmT46uNWEwC/THTp/oLvQwfEFjBo0ZNGbQ+J6UG5Y9CmuVGrAsAAAAAElFTkSuQmCC",this.TMSFNCGRAPHICSPIN="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAABKklEQVQ4T2PAB0JDQ5mjoqIEgUxGiAiRIDo6WiY8PHwdEGvW19czQYUJA6AGhbCwsO9Aek1ISIiZvb09C1QKPwBqaAbi/1DNJ4HYiqDNIE1ADZ9AGqGa/wLp6xERESZAaVQ/AyUUgDgIiOdCbQFrQsL/gPgxUM4OFACSQMYdIP4FFPwNxH+gpqNoAortAYayHNSfjAwgNwMFvaCaMTQA8W+g+M7IyEgNiLuQAMgUoNsDgYruoWkCOe1gcHCwHlQpJgA6wwCo6DySJhD+BDQwCaoEEwA1SQAVzQLiq0BcBMRXgBhk25PAwEBJqDJUkJaWxgr0QzoQbwYqdABGNCeQrQPSDKTv44w3oFPEgYqmAmk9UNqECjMCxWSBeAeUjx1ANWAkZCSD0AADAwDRpKHlJfOjAwAAAABJRU5ErkJggg==",this.TMSFNCGRAPHICSPIN2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAAA/UlEQVQ4T33Su2oCQRTGcddLYWmlQhTLCBIsQgoLSW2nj2Bj7yv4DGkCeYOQxiaBNJapbCI2ooU+gY3gbf1/w47MjosHfsvM7DlzY1JhGN6TQQGBM2bEOgke8IU60tGY4SYlqWGHT7wgC/PPT/SNoFDxH1owKyclWyrawsYJczwj8JO1tR4+oFX8OGONtpLLWGCPA47Q7H78ogqd06yoPXeg4qQCTfaDR1x3ZxuapYsl3NDWJnjCtUjcThNTuKHL6cPNM2yjhHfMMMQ/tNoGuoNYkeiTwwBjvCKPBlS8QuzFWPoU8QadQ29TY3qbFXxH/Ru2oYKbhww7kSdMXQD8wIToOQZE/AAAAABJRU5ErkJggg==",this.TMSFNCGRAPHICSRIGHT="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAFNJREFUOI3tzzsSQFAQRNFDqSezHUuwYBJLsBuhEomE4/ll3HBq+nY1PxENRrS5xzK4L1jPSiISesxPJcORJJqwU9xthjrX/ko4mpBQocN0tf1rbDeZDIfcSud0AAAAAElFTkSuQmCC",this.TMSFNCGRAPHICSLEFT="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAEpJREFUOI3lzKENgEAQAMEJBkkIDdDTSxp6gqMyCkB8IQgMFdwZAutn+U19Bi84MUbxhZrBawSXB+8RDDMaDkyvmQyZyYYuOvh6N24uDUKEV//MAAAAAElFTkSuQmCC",this.TMSFNCGRAPHICSEXPAND="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAYAAADEUlfTAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOvwAADr8BOAVTJAAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4zjOaXUAAAACVJREFUGFdj+P//P07MEBYW9h8Xxi8JAjglYACnBAzglMAEDAwARZ1DA4NRF38AAAAASUVORK5CYII=",this.TMSFNCGRAPHICSEXPANDSVG="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSI+CjxnIGlkPSJzdXJmYWNlMSI+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoMCUsMCUsMCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSAxMS44Mzk4NDQgMi44ODY3MTkgQyAxMS42Mjg5MDYgMi42NzU3ODEgMTEuMjgxMjUgMi42NzU3ODEgMTEuMDcwMzEyIDIuODg2NzE5IEwgNiA3Ljk1NzAzMSBMIDAuOTI5Njg4IDIuODg2NzE5IEMgMC43MTg3NSAyLjY3NTc4MSAwLjM3MTA5NCAyLjY3NTc4MSAwLjE2MDE1NiAyLjg4NjcxOSBDIC0wLjA1NDY4NzUgMy4xMDE1NjIgLTAuMDU0Njg3NSAzLjQ0NTMxMiAwLjE2MDE1NiAzLjY2MDE1NiBMIDUuNjEzMjgxIDkuMTEzMjgxIEMgNS43MTQ4NDQgOS4yMTQ4NDQgNS44NTU0NjkgOS4yNzM0MzggNiA5LjI3MzQzOCBDIDYuMTQ0NTMxIDkuMjczNDM4IDYuMjg1MTU2IDkuMjE0ODQ0IDYuMzg2NzE5IDkuMTEzMjgxIEwgMTEuODM5ODQ0IDMuNjYwMTU2IEMgMTIuMDU0Njg4IDMuNDQ1MzEyIDEyLjA1NDY4OCAzLjEwMTU2MiAxMS44Mzk4NDQgMi44ODY3MTkgWiBNIDExLjgzOTg0NCAyLjg4NjcxOSAiLz4KPC9nPgo8L3N2Zz4K",this.TMSFNCGRAPHICSDOWNSVG="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSI+CjxnIGlkPSJzdXJmYWNlMSI+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoMCUsMCUsMCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSAxMS44Mzk4NDQgMi44ODY3MTkgQyAxMS42Mjg5MDYgMi42NzU3ODEgMTEuMjgxMjUgMi42NzU3ODEgMTEuMDcwMzEyIDIuODg2NzE5IEwgNiA3Ljk1NzAzMSBMIDAuOTI5Njg4IDIuODg2NzE5IEMgMC43MTg3NSAyLjY3NTc4MSAwLjM3MTA5NCAyLjY3NTc4MSAwLjE2MDE1NiAyLjg4NjcxOSBDIC0wLjA1NDY4NzUgMy4xMDE1NjIgLTAuMDU0Njg3NSAzLjQ0NTMxMiAwLjE2MDE1NiAzLjY2MDE1NiBMIDUuNjEzMjgxIDkuMTEzMjgxIEMgNS43MTQ4NDQgOS4yMTQ4NDQgNS44NTU0NjkgOS4yNzM0MzggNiA5LjI3MzQzOCBDIDYuMTQ0NTMxIDkuMjczNDM4IDYuMjg1MTU2IDkuMjE0ODQ0IDYuMzg2NzE5IDkuMTEzMjgxIEwgMTEuODM5ODQ0IDMuNjYwMTU2IEMgMTIuMDU0Njg4IDMuNDQ1MzEyIDEyLjA1NDY4OCAzLjEwMTU2MiAxMS44Mzk4NDQgMi44ODY3MTkgWiBNIDExLjgzOTg0NCAyLjg4NjcxOSAiLz4KPC9nPgo8L3N2Zz4K",this.TMSFNCGRAPHICSUPSVG="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSI+CjxnIGlkPSJzdXJmYWNlMSI+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoMCUsMCUsMCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSAxMS44Mzk4NDQgOC4zMzk4NDQgTCA2LjM4NjcxOSAyLjg4NjcxOSBDIDYuMjg1MTU2IDIuNzg1MTU2IDYuMTQ0NTMxIDIuNzI2NTYyIDYgMi43MjY1NjIgQyA1Ljg1NTQ2OSAyLjcyNjU2MiA1LjcxNDg0NCAyLjc4NTE1NiA1LjYxMzI4MSAyLjg4NjcxOSBMIDAuMTYwMTU2IDguMzM5ODQ0IEMgLTAuMDU0Njg3NSA4LjU1NDY4OCAtMC4wNTQ2ODc1IDguODk4NDM4IDAuMTYwMTU2IDkuMTEzMjgxIEMgMC4zNzEwOTQgOS4zMjQyMTkgMC43MTg3NSA5LjMyNDIxOSAwLjkyOTY4OCA5LjExMzI4MSBMIDYgNC4wNDI5NjkgTCAxMS4wNzAzMTIgOS4xMTMyODEgQyAxMS4xNzU3ODEgOS4yMTg3NSAxMS4zMTY0MDYgOS4yNzM0MzggMTEuNDUzMTI1IDkuMjczNDM4IEMgMTEuNTkzNzUgOS4yNzM0MzggMTEuNzM0Mzc1IDkuMjE4NzUgMTEuODM5ODQ0IDkuMTEzMjgxIEMgMTIuMDU0Njg4IDguODk4NDM4IDEyLjA1NDY4OCA4LjU1NDY4OCAxMS44Mzk4NDQgOC4zMzk4NDQgWiBNIDExLjgzOTg0NCA4LjMzOTg0NCAiLz4KPC9nPgo8L3N2Zz4K",this.TMSFNCGRAPHICSRIGHTSVG="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSI+CjxnIGlkPSJzdXJmYWNlMSI+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoMCUsMCUsMCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSA5LjExMzI4MSA1LjYxMzI4MSBMIDMuNjYwMTU2IDAuMTYwMTU2IEMgMy40NDUzMTIgLTAuMDU0Njg3NSAzLjEwMTU2MiAtMC4wNTQ2ODc1IDIuODg2NzE5IDAuMTYwMTU2IEMgMi42NzU3ODEgMC4zNzEwOTQgMi42NzU3ODEgMC43MTg3NSAyLjg4NjcxOSAwLjkyOTY4OCBMIDcuOTU3MDMxIDYgTCAyLjg4NjcxOSAxMS4wNzAzMTIgQyAyLjY3NTc4MSAxMS4yODEyNSAyLjY3NTc4MSAxMS42Mjg5MDYgMi44ODY3MTkgMTEuODM5ODQ0IEMgMi45OTIxODggMTEuOTQ1MzEyIDMuMTMyODEyIDEyIDMuMjczNDM4IDEyIEMgMy40MTQwNjIgMTIgMy41NTA3ODEgMTEuOTQ1MzEyIDMuNjYwMTU2IDExLjgzOTg0NCBMIDkuMTEzMjgxIDYuMzg2NzE5IEMgOS4yMTQ4NDQgNi4yODUxNTYgOS4yNzM0MzggNi4xNDQ1MzEgOS4yNzM0MzggNiBDIDkuMjczNDM4IDUuODU1NDY5IDkuMjE0ODQ0IDUuNzE0ODQ0IDkuMTEzMjgxIDUuNjEzMjgxIFogTSA5LjExMzI4MSA1LjYxMzI4MSAiLz4KPC9nPgo8L3N2Zz4K",this.TMSFNCGRAPHICSLEFTSVG="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSI+CjxnIGlkPSJzdXJmYWNlMSI+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoMCUsMCUsMCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSA0LjA0Mjk2OSA2IEwgOS4xMTMyODEgMC45Mjk2ODggQyA5LjMyNDIxOSAwLjcxODc1IDkuMzI0MjE5IDAuMzcxMDk0IDkuMTEzMjgxIDAuMTYwMTU2IEMgOC44OTg0MzggLTAuMDU0Njg3NSA4LjU1NDY4OCAtMC4wNTQ2ODc1IDguMzM5ODQ0IDAuMTYwMTU2IEwgMi44ODY3MTkgNS42MTMyODEgQyAyLjc4NTE1NiA1LjcxNDg0NCAyLjcyNjU2MiA1Ljg1NTQ2OSAyLjcyNjU2MiA2IEMgMi43MjY1NjIgNi4xNDQ1MzEgMi43ODUxNTYgNi4yODUxNTYgMi44ODY3MTkgNi4zODY3MTkgTCA4LjMzOTg0NCAxMS44Mzk4NDQgQyA4LjQ0OTIxOSAxMS45NDUzMTIgOC41ODU5MzggMTIgOC43MjY1NjIgMTIgQyA4Ljg2NzE4OCAxMiA5LjAwNzgxMiAxMS45NDUzMTIgOS4xMTMyODEgMTEuODM5ODQ0IEMgOS4zMjQyMTkgMTEuNjI4OTA2IDkuMzI0MjE5IDExLjI4MTI1IDkuMTEzMjgxIDExLjA3MDMxMiBaIE0gNC4wNDI5NjkgNiAiLz4KPC9nPgo8L3N2Zz4K",this.TMSFNCGRAPHICSCLOSESVG="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSI+CjxnIGlkPSJzdXJmYWNlMSI+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoMCUsMCUsMCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSA3LjA2MjUgNiBMIDExLjc4MTI1IDEuMjgxMjUgQyAxMi4wNzQyMTkgMC45ODgyODEgMTIuMDc0MjE5IDAuNTExNzE5IDExLjc4MTI1IDAuMjE4NzUgQyAxMS40ODgyODEgLTAuMDc0MjE4OCAxMS4wMTE3MTkgLTAuMDc0MjE4OCAxMC43MTg3NSAwLjIxODc1IEwgNiA0LjkzNzUgTCAxLjI4MTI1IDAuMjE4NzUgQyAwLjk4ODI4MSAtMC4wNzQyMTg4IDAuNTExNzE5IC0wLjA3NDIxODggMC4yMTg3NSAwLjIxODc1IEMgLTAuMDc0MjE4OCAwLjUxMTcxOSAtMC4wNzQyMTg4IDAuOTg4MjgxIDAuMjE4NzUgMS4yODEyNSBMIDQuOTM3NSA2IEwgMC4yMTg3NSAxMC43MTg3NSBDIC0wLjA3NDIxODggMTEuMDExNzE5IC0wLjA3NDIxODggMTEuNDg4MjgxIDAuMjE4NzUgMTEuNzgxMjUgQyAwLjM2NzE4OCAxMS45MjU3ODEgMC41NTg1OTQgMTIgMC43NSAxMiBDIDAuOTQxNDA2IDEyIDEuMTMyODEyIDExLjkyNTc4MSAxLjI4MTI1IDExLjc4MTI1IEwgNiA3LjA2MjUgTCAxMC43MTg3NSAxMS43ODEyNSBDIDEwLjg2NzE4OCAxMS45MjU3ODEgMTEuMDU4NTk0IDEyIDExLjI1IDEyIEMgMTEuNDQxNDA2IDEyIDExLjYzMjgxMiAxMS45MjU3ODEgMTEuNzgxMjUgMTEuNzgxMjUgQyAxMi4wNzQyMTkgMTEuNDg4MjgxIDEyLjA3NDIxOSAxMS4wMTE3MTkgMTEuNzgxMjUgMTAuNzE4NzUgWiBNIDcuMDYyNSA2ICIvPgo8L2c+Cjwvc3ZnPgo=",t.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSCLOSE),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSDOWN),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSRIGHT),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSLEFT),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSEXPAND),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSPIN),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSPIN2),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSDOWN),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSDOWN2),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSUP),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSUP2),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSEXPANDSVG),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSUPSVG),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSRIGHTSVG),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSLEFTSVG),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSDOWNSVG),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCGRAPHICSCLOSESVG)}}),["SysUtils","Math","WEBLib.TMSFNCUtils","WEBLib.TMSFNCHTMLEngine","WEBLib.TMSFNCGraphics.General","WEBLib.TMSFNCGraphics.WEB"]),rtl.module("WEBLib.DesignIntf",["System","Classes","Web","JS","TypInfo","WEBLib.Forms","WEBLib.Menus"],(function(){"use strict";var t=this.$impl;rtl.createClass(this,"TRegisteredComponent",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FIcon=""}})),this.GetRegisteredComponent=function(e){var i=null,s=null;if(i=null,""===e)return i;s=null;var n=Object.keys(t.RegisteredComponentList).map((function(e){return[t.RegisteredComponentList[e]]}));for(let t of n)if(t[0].FClass.$classname.toLowerCase()==e.toLowerCase()){s=t[0];break}return i=s},this.$implcode=function(){t.RegisteredComponentList=null,t.RegisteredSelectionEditorList=null,t.RegisteredPropertyEditorList=null,t.RegisteredIgnoredPropertyList=null,t.RegisteredLibraryRequirementsEditorList=null,t.RegisteredComponentEditorList=null,t.RegisteredIdentToIntList=null},this.$init=function(){t.RegisteredComponentList=Object.create(null),t.RegisteredSelectionEditorList=Object.create(null),t.RegisteredPropertyEditorList=Object.create(null),t.RegisteredIgnoredPropertyList=Object.create(null),t.RegisteredLibraryRequirementsEditorList=Object.create(null),t.RegisteredComponentEditorList=Object.create(null),t.RegisteredIdentToIntList=Object.create(null)}}),["SysUtils","Generics.Collections"]),rtl.module("WEBLib.TMSFNCCustomComponent",["System","Classes","WEBLib.Controls","WEBLib.TMSFNCTypes","WEBLib.TMSFNCPersistence","TypInfo"],(function(){"use strict";var t=this;this.$rtti.$MethodVar("TTMSFNCCustomComponentCanSavePropertyEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AObject",pas.System.$rtti.TObject],["APropertyName",rtl.string],["APropertyType",pas.System.$rtti.TTypeKind],["ACanSave",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomComponentCanLoadPropertyEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AObject",pas.System.$rtti.TObject],["APropertyName",rtl.string],["APropertyType",pas.System.$rtti.TTypeKind],["ACanLoad",rtl.boolean,1]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomComponent",pas["WEBLib.Controls"].TCustomControl,(function(){this.FBlockPersistenceInterface=!1,this.$init=function(){pas["WEBLib.Controls"].TCustomControl.$init.call(this),this.FStored=!1,this.FDesigntimeFormPixelsPerInch=0,this.FAppearancePersisting=!1,this.FAdaptToStyle=!1,this.FOnCanSaveProperty=null,this.FOnCanLoadProperty=null},this.$final=function(){this.FOnCanSaveProperty=void 0,this.FOnCanLoadProperty=void 0,pas["WEBLib.Controls"].TCustomControl.$final.call(this)},this.GetVersionNumber=function(t,e,i,s){return"",""},this.DoCanSaveProperty=function(t,e,i,s){null!=this.FOnCanSaveProperty&&this.FOnCanSaveProperty(this,t,e,i,s)},this.DoCanLoadProperty=function(t,e,i,s){null!=this.FOnCanLoadProperty&&this.FOnCanLoadProperty(this,t,e,i,s)},this.IsAppearanceProperty=function(t,e,i){return!1,!1},this.CanSaveProperty=function(t,e,i){var s=!1;return s=!(t===this&&!this.FBlockPersistenceInterface)||-1===pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IndexOfTextInArray(e,pas["WEBLib.TMSFNCPersistence"].ExcludePropertyList),this.FAppearancePersisting&&(s=s&&this.IsAppearanceProperty(t,e,i)),this.DoCanSaveProperty(t,e,i,{get:function(){return s},set:function(t){s=t}}),s},this.CanLoadProperty=function(t,e,i){var s=!1;return s=!(t===this&&!this.FBlockPersistenceInterface)||-1===pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IndexOfTextInArray(e,pas["WEBLib.TMSFNCPersistence"].ExcludePropertyList),this.DoCanLoadProperty(t,e,i,{get:function(){return s},set:function(t){s=t}}),s},this.SetAdaptToStyle=function(t){this.FAdaptToStyle=t},this.Paint=function(){var t=null,e=null,i=null,s=null;pas["WEBLib.Controls"].TCustomControl.Paint.call(this),i=null,t=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("Create$1",[this.GetCanvas(),!1]);try{e.FStroke.SetKind(1),e.FStroke.SetColor(0),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.GetWidth(),this.GetHeight())),2),null!=(s=pas["WEBLib.DesignIntf"].GetRegisteredComponent(this.$classname))&&t.LoadFromResource(s.FIcon),e.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(2,2,this.GetWidth()-2,this.GetHeight()-2)),t,!0,!0,!0,!1)}finally{null!=i&&(i=rtl.freeLoc(i)),t=rtl.freeLoc(t),e=rtl.freeLoc(e)}},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),4 in this.FComponentState||this.SetVisible(!1)},this.RegisterRuntimeClasses=function(){},this.Create$1=function(t){var e=0;return pas["WEBLib.Controls"].TControl.Create$1.apply(this,arguments),e=96,this.FDesigntimeFormPixelsPerInch=e,this.SetWidth(26),this.SetHeight(26),this.IsDesigning()||this.RegisterRuntimeClasses(),this},this.SetBounds=function(t,e,i,s){var n;n=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(this,-1),pas["WEBLib.Controls"].TControl.SetBounds.call(this,t,e,Math.round(26*n),Math.round(26*n))},this.BeginUpdate=function(){pas["WEBLib.Controls"].TControl.BeginUpdate.call(this)},this.EndUpdate=function(){pas["WEBLib.Controls"].TCustomControl.EndUpdate.call(this)},this.IsDesignTime=function(){var t=!1;return t=!1,null!=this.FOwner&&(t=this.IsDesigning()&&!(1 in this.FOwner.FComponentState||0 in this.FOwner.FComponentState)),t},this.IsDesigning=function(){return 4 in this.FComponentState||null!=pas["WEBLib.Forms"].VSIDE},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth"),e.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight"),e.addProperty("OnCanSaveProperty",0,t.$rtti.TTMSFNCCustomComponentCanSavePropertyEvent,"FOnCanSaveProperty","FOnCanSaveProperty"),e.addProperty("OnCanLoadProperty",0,t.$rtti.TTMSFNCCustomComponentCanLoadPropertyEvent,"FOnCanLoadProperty","FOnCanLoadProperty")}))}),["WEBLib.TMSFNCUtils","WEBLib.Forms","SysUtils","WEBLib.TMSFNCGraphics","WEBLib.Graphics","WEBLib.TMSFNCGraphicsTypes","Types","WEBLib.DesignIntf"]),rtl.module("WEBLib.TMSFNCBitmapContainer",["System","Classes","WEBLib.TMSFNCTypes","WEBLib.TMSFNCCustomComponent","WEBLib.Controls"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=0,this.BLD_VER=0,this.$rtti.$Class("TTMSFNCBitmapContainer"),rtl.createInterface(this,"ITMSFNCBitmapContainer","{ED26710D-395F-4971-8AC9-A31083BF2A3C}",["GetBitmapContainer"],pas.System.IUnknown),rtl.createClass(this,"TTMSFNCBitmapItem",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FBitmap=null,this.FTag=0,this.FName=""},this.$final=function(){this.FBitmap=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetBitmap=function(t){this.FBitmap.Assign(t)},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FBitmap.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),this.FName="Item"+pas.SysUtils.IntToStr(this.FCollection.GetCount()),this},this.Destroy=function(){rtl.free(this,"FBitmap"),pas.Classes.TCollectionItem.Destroy.call(this)},this.DoBitmapChanged=function(e){t.TTMSFNCBitmapCollection.isPrototypeOf(this.FCollection)&&null!=rtl.as(this.FCollection,t.TTMSFNCBitmapCollection).FOwner$1&&rtl.as(this.FCollection,t.TTMSFNCBitmapCollection).FOwner$1.DoBitmapChanged(this)},this.Assign=function(e){this.FName=rtl.as(e,t.TTMSFNCBitmapItem).FName,this.FTag=rtl.as(e,t.TTMSFNCBitmapItem).FTag,this.FBitmap.Assign(rtl.as(e,t.TTMSFNCBitmapItem).FBitmap)};var e=this.$rtti;e.addProperty("Bitmap",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FBitmap","SetBitmap"),e.addProperty("Name",0,rtl.string,"FName","FName"),e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag")})),rtl.createClass(this,"TTMSFNCBitmapCollection",pas.Classes.TOwnedCollection,(function(){this.$init=function(){pas.Classes.TOwnedCollection.$init.call(this),this.FOwner$1=null},this.$final=function(){this.FOwner$1=void 0,pas.Classes.TOwnedCollection.$final.call(this)},this.GetItemEx=function(t){return this.GetItem(t)},this.GetBitmapItemClass=function(){return t.TTMSFNCBitmapItem},this.Create$3=function(t){return pas.Classes.TOwnedCollection.Create$2.call(this,t,this.GetBitmapItemClass()),this.FOwner$1=t,this}})),rtl.createClass(this,"TControlList",pas.Classes.TList,(function(){})),rtl.createClass(this,"TTMSFNCBitmapContainer",pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.$init.call(this),this.FControls$1=null,this.FItems=null,this.FOnBitmapChanged=null},this.$final=function(){this.FControls$1=void 0,this.FItems=void 0,this.FOnBitmapChanged=void 0,pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.$final.call(this)},this.SetItems=function(t){this.FItems.Assign(t)},this.GetBitmapName=function(t){var e="";return e="",t>=0&&t<=this.GetItems().GetCount()-1&&(e=this.GetItems().GetItemEx(t).FName),e},this.GetBitmap=function(t){var e=null;return e=null,t>=0&&t<=this.GetItems().GetCount()-1&&(e=this.GetItems().GetItemEx(t).FBitmap),e},this.GetItems=function(){return this.FItems},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,0,0)},this.CreateItems=function(){return t.TTMSFNCBitmapCollection.$create("Create$3",[this])},this.RegisterRuntimeClasses=function(){pas.Classes.RegisterClass(t.TTMSFNCBitmapContainer)},this.Notification=function(t,e){var i=0;if(pas.Classes.TComponent.Notification.apply(this,arguments),1===e&&null!=this.FControls$1)for(var s=this.FControls$1.GetCount()-1;s>=0;s--)i=s,this.FControls$1.Get(i)==t&&this.FControls$1.Delete(i)},this.DoBitmapChanged=function(t){var e=null,i=0;if(null!=(e=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetParentForm(this)))for(var s=0,n=e.GetControlsCount()-1;s<=n;s++)i=s,pas["WEBLib.Controls"].TWinControl.isPrototypeOf(e.GetControls(i))&&this.InvalidateMembers(rtl.as(e.GetControls(i),pas["WEBLib.Controls"].TWinControl));null!=this.FOnBitmapChanged&&this.FOnBitmapChanged(this)},this.InvalidateMembers=function(t){var e=0;if(null!=t){null!=pas.TypInfo.GetPropInfo$2(t,"BitmapContainer")&&t.Invalidate();for(var i=0,s=t.GetControlsCount()-1;i<=s;i++)e=i,pas["WEBLib.Controls"].TWinControl.isPrototypeOf(t.GetControls(e))&&this.InvalidateMembers(rtl.as(t.GetControls(e),pas["WEBLib.Controls"].TWinControl))}},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.Create$1.apply(this,arguments),this.FItems=this.CreateItems(),this.FControls$1=t.TControlList.$create("Create$1"),this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FControls$1},set:function(t){this.p.FControls$1=t}}),rtl.free(this,"FItems"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCBitmapContainer.isPrototypeOf(e)?this.FItems.Assign(rtl.as(e,t.TTMSFNCBitmapContainer).GetItems()):pas["WEBLib.Controls"].TControl.Assign.apply(this,arguments)},this.FindBitmap$1=function(t){var e=null,i=0;for(e=null,t=pas.SysUtils.UpperCase(t),i=1;i<=this.GetItems().GetCount();){if(pas.SysUtils.UpperCase(this.GetItems().GetItemEx(i-1).FName)===t){e=this.GetItems().GetItemEx(i-1).FBitmap;break}i+=1}return e},this.ItemCount=function(){return this.GetItems().GetCount()},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Items",3,t.$rtti.TTMSFNCBitmapCollection,"GetItems","SetItems"),e.addProperty("Version",1,rtl.string,"GetVersion",""),e.addProperty("OnBitmapChanged",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnBitmapChanged","FOnBitmapChanged"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["TypInfo","WEBLib.Forms","SysUtils","WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCStyles",["System","Classes","WEBLib.Graphics","WEBLib.Controls","WEBLib.Forms","WEBLib.TMSFNCTypes","WEBLib.TMSFNCCustomComponent","WEBLib.TMSFNCGraphicsTypes","JS","WEBLib.JSON"],(function(){"use strict";var t=this;rtl.createInterface(this,"ITMSFNCAdaptToStyle","{3EFF288D-3927-4E86-8E9D-EF684B501C9E}",["SetAdaptToStyle"],pas.System.IUnknown),rtl.createClass(this,"TTMSFNCStyles",pas.System.TObject,(function(){this.ExtractColor=function(t){var e=0,i="",s="",n=null,o=0,r=0;function a(t){return pas.SysUtils.StrToInt(pas.SysUtils.Trim(pas.SysUtils.StringReplace(t,"rgb(","",rtl.createSet(0))))}if(e=-1,""!==t)if(i=pas.SysUtils.LowerCase(pas.SysUtils.StringReplace(t," ","",rtl.createSet(0))),1===pas.System.Pos("linear-gradient",i))0===(o=pas.System.Pos("rgb",i))&&(o=pas.System.Pos("#",i)),r=pas.System.Pos$1(")",i,o),s=pas.System.Copy(i,o,r-o+1),0===(o=pas.System.Pos$1("rgb",i,r))&&(o=pas.System.Pos("#",i)),r=pas.System.Pos$1(")",i,o),pas.System.Copy(i,o,r-o+1),e=this.ExtractColor(s);else if(1===pas.System.Pos("rgb",i)){n=pas.Classes.TStringList.$create("Create$1");try{n.SetDelimiter(","),n.SetDelimitedText(i),e=pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(a(n.Get(0)),a(n.Get(1)),a(n.Get(2)))}finally{n=rtl.freeLoc(n)}}else 1===pas.System.Pos("#",i)&&(e=pas["WEBLib.Graphics"].HexToColor(i));return e},this.ExtractColorTo=function(t){var e=0,i="",s="",n=null,o=0,r=0;function a(t){return pas.SysUtils.StrToInt(pas.SysUtils.Trim(pas.SysUtils.StringReplace(t,"rgb(","",rtl.createSet(0))))}if(e=-1,""!==t)if(i=pas.SysUtils.LowerCase(pas.SysUtils.StringReplace(t," ","",rtl.createSet(0))),1===pas.System.Pos("linear-gradient",i))0===(o=pas.System.Pos("rgb",i))&&(o=pas.System.Pos("#",i)),r=pas.System.Pos$1(")",i,o),pas.System.Copy(i,o,r-o+1),0===(o=pas.System.Pos$1("rgb",i,r))&&(o=pas.System.Pos("#",i)),r=pas.System.Pos$1(")",i,o),s=pas.System.Copy(i,o,r-o+1),e=this.ExtractColor(s);else if(1===pas.System.Pos("rgb",i)){n=pas.Classes.TStringList.$create("Create$1");try{n.SetDelimiter(","),n.SetDelimitedText(i),e=pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(a(n.Get(0)),a(n.Get(1)),a(n.Get(2)))}finally{n=rtl.freeLoc(n)}}else 1===pas.System.Pos("#",i)&&(e=pas["WEBLib.Graphics"].HexToColor(i));return e},this.GetStyleBackgroundFill=function(){return this.FindCSSStyleProperty(".TMSFNCGridStyle","background")},this.GetStyleBackgroundStroke=function(){return this.FindCSSStyleProperty(".TMSFNCGridStyle","border-color")},this.GetStyleDefaultButtonFill=function(){return this.FindCSSStyleProperty(".TMSFNCButtonStyle","background")},this.GetStyleDefaultButtonStroke=function(){return this.FindCSSStyleProperty(".TMSFNCButtonStyle","border-color")},this.GetStyleEditTextColor=function(){return this.FindCSSStyleProperty(".TMSFNCEditStyle","--foreground")},this.GetStyleHeaderFill=function(){return this.FindCSSStyleProperty(".TMSFNCHeaderItemStyle","background")},this.GetStyleSelectionFill=function(){return this.FindCSSStyleProperty(".TMSFNCGridStyle","--selection")},this.GetStyleAlternativeBackgroundFill=function(){return this.FindCSSStyleProperty(".TMSFNCMemoStyle","background")},this.GetStyleLineFill=function(){return this.FindCSSStyleProperty(".TMSFNCGridStyle","--linefill")},this.GetStyleTextColor=function(){return this.FindCSSStyleProperty(".TMSFNCHeaderItemStyle","color")},this.FindCSSStyleRule=function(e){var i,s;i=e,s=t.CSSStyleFileName;for(var n=0;n<document.styleSheets.length;n++){var o=document.styleSheets[n].href;if(null!=o&&s==o.substring(o.lastIndexOf("/")+1))for(var r=document.styleSheets[n].rules||document.styleSheets[n].cssRules,a=0;a<r.length;a++)if(r[a].selectorText.startsWith(i))return r[a]}return null},this.FindCSSStyleProperty=function(t,e){var i="",s=null,n="";return i="",null!=(s=this.FindCSSStyleRule(t))&&(n=e,i=s.style.getPropertyValue(n)),i},this.StyleServicesEnabled=function(){return!0,!0},this.GetStyleLineFillColor=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleLineFill())&&(s=this.ExtractColor(i),t.set(s),e=-1!==s),e},this.GetStyleBackgroundFillColor=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleBackgroundFill())&&(s=this.ExtractColor(i),t.set(s),e=-1!==s),e},this.GetStyleAlternativeBackgroundFillColor=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleAlternativeBackgroundFill())&&(s=this.ExtractColor(i),t.set(s),e=-1!==s),e},this.GetStyleBackgroundStrokeColor=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleBackgroundStroke())&&(s=this.ExtractColor(i),t.set(s),e=-1!==s),e},this.GetStyleHeaderFillColor=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleHeaderFill())&&(s=this.ExtractColor(i),t.set(s),e=-1!==s),e},this.GetStyleHeaderFillColorTo=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleHeaderFill())&&(s=this.ExtractColorTo(i),t.set(s),e=-1!==s),e},this.GetStyleSelectionFillColor=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleSelectionFill())&&(s=this.ExtractColor(i),t.set(s),e=-1!==s),e},this.GetStyleSelectionFillColorTo=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleSelectionFill())&&(s=this.ExtractColorTo(i),t.set(s),e=-1!==s),e},this.GetStyleTextFontColor=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleTextColor())&&(s=this.ExtractColor(i),t.set(s),e=-1!==s),e},this.GetStyleAlternativeTextFontColor=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleEditTextColor())&&(s=this.ExtractColor(i),t.set(s),e=-1!==s),e},this.GetStyleDefaultButtonFillColor=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleDefaultButtonFill())&&(s=this.ExtractColor(i),t.set(s),e=-1!==s),e},this.GetStyleDefaultButtonStrokeColor=function(t){var e=!1,i="",s=0;return e=!1,this.StyleServicesEnabled()&&""!==(i=this.GetStyleDefaultButtonStroke())&&(s=this.ExtractColor(i),t.set(s),e=-1!==s),e}})),this.CSSStyleFileName=""}),["WEBLib.TMSFNCUtils","SysUtils","WEBLib.TMSFNCPersistence","WEBLib.TMSFNCGraphics"]),rtl.module("WEBLib.TMSFNCUndo",["System","Classes","WEBLib.TMSFNCTypes"],(function(){"use strict";rtl.createClass(this,"TTMSFNCUndoManager",pas.Classes.TCollection,(function(){}))}),["SysUtils","WEBLib.TMSFNCPersistence"]),rtl.module("WEBLib.TMSFNCCustomControl",["System","Classes","WEBLib.Controls","WEBLib.TMSFNCGraphics","WEBLib.Graphics","WEBLib.TMSFNCStyles","WEBLib.TMSFNCPersistence","WEBLib.TMSFNCUndo","Types","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCTypes","TypInfo","WEBLib.Forms","WEBLib.Menus"],(function(){"use strict";var t=this;rtl.createClass(this,"TTMSFNCCustomDesignerForm",pas["WEBLib.Forms"].TForm,(function(){rtl.addIntf(this,pas.System.IUnknown)})),this.TTMSFNCControlAlignment={0:"caNone",caNone:0,1:"caTop",caTop:1,2:"caBottom",caBottom:2,3:"caLeft",caLeft:3,4:"caRight",caRight:4,5:"caClient",caClient:5},this.$rtti.$Enum("TTMSFNCControlAlignment",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TTMSFNCControlAlignment}),rtl.createClass(this,"TTMSFNCCustomControlBaseCommon",pas["WEBLib.Menus"].TWebCustomControl,(function(){this.$init=function(){pas["WEBLib.Menus"].TWebCustomControl.$init.call(this),this.FResourceScaleFactor=0,this.FPaintScaleFactor=0,this.FDesigntimeFormPixelsPerInch=0,this.FAllowFocus=!1,this.FAdaptToStyle=!1,this.FAdaptedToStyle=!1,this.FTransparent=!1,this.FBufferedPainting=!1,this.FNativeCanvas=!1,this.FAntiAliasing=!1,this.FOptimizedHTMLDrawing=!1,this.FShowAcceleratorChar=!1,this.FTextQuality=0,this.FOnInternalDblClick=null,this.FOnInternalMouseDown=null,this.FOnInternalMouseMove=null,this.FOnInternalMouseUp=null},this.$final=function(){this.FOnInternalDblClick=void 0,this.FOnInternalMouseDown=void 0,this.FOnInternalMouseMove=void 0,this.FOnInternalMouseUp=void 0,pas["WEBLib.Menus"].TWebCustomControl.$final.call(this)},this.GetAllowFocus=function(){return this.FAllowFocus},this.GetControlAlignment=function(){var t=0;t=0;var e=this.FAlign;return 0===e?t=0:1===e?t=1:2===e?t=2:3===e?t=3:4===e?t=4:5===e&&(t=5),t},this.SetAllowFocus=function(t){this.FAllowFocus=t},this.SetControlAlignment=function(t){var e=t;0===e?this.SetAlign(0):1===e?this.SetAlign(1):2===e?this.SetAlign(2):3===e?this.SetAlign(3):4===e?this.SetAlign(4):5===e&&this.SetAlign(5)},this.SetOptimizedHTMLDrawing=function(t){this.FOptimizedHTMLDrawing!==t&&(this.FOptimizedHTMLDrawing=t,this.Invalidate())},this.SetShowAcceleratorChar=function(t){this.FShowAcceleratorChar!==t&&(this.FShowAcceleratorChar=t,this.Invalidate())},this.ConvertScreenToClient=function(t){var e=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),i=pas.Types.TPoint.$new();return i.$assign(this.ScreenToClient(pas.Types.Point(Math.round(t.X),Math.round(t.Y)))),e.$assign(pas["WEBLib.TMSFNCTypes"].PointF(i.x,i.y)),e},this.GetAdaptToStyle=function(){return this.FAdaptToStyle},this.SetEnabled=function(t){pas["WEBLib.Controls"].TControl.SetEnabled.apply(this,arguments),this.Invalidate()},this.SetDefaultGraphicColors=function(){var t=0;t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultPopupFillColor=t:pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultPopupFillColor=16777215,t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundStrokeColor({get:function(){return t},set:function(e){t=e}})?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultPopupStrokeColor=t:pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultPopupStrokeColor=12632256,t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleDefaultButtonFillColor({get:function(){return t},set:function(e){t=e}})?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonFillColor=t:pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonFillColor=pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(225,225,225),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleLineFillColor({get:function(){return t},set:function(e){t=e}})?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonStrokeColor=t:pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonStrokeColor=11119017,t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultTextFontColor=t:pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultTextFontColor=0,t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleSelectionFillColor({get:function(){return t},set:function(e){t=e}})?(pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultSelectionFillColor=t,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonFillColorFocused=pas["WEBLib.TMSFNCGraphicsTypes"].Blend(t,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonFillColor,25),pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonStrokeColorFocused=pas["WEBLib.TMSFNCGraphicsTypes"].Blend(t,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonStrokeColor,30)):(pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultSelectionFillColor=0,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonFillColorFocused=pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251),pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonStrokeColorFocused=pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177)),pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonStrokeColorDisabled=11119017,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonFillColorDisabled=13882323},this.SetAdaptToStyle=function(t){this.FAdaptToStyle=t,this.InitializeStyle()},this.CancelHint=function(){},this.BeginDrag$1=function(){},this.InitializeStyle=function(){this.SetDefaultGraphicColors(),this.DestroyGraphicElements(),this.GetAdaptToStyle()?(this.FAdaptedToStyle=!0,this.ApplyStyle()):this.FAdaptedToStyle&&(this.ResetToDefaultStyle(),this.FAdaptedToStyle=!1),this.Invalidate()},this.ApplyStyle=function(){},this.ResetToDefaultStyle=function(){},this.HandleMouseLeave=function(){},this.HandleMouseEnter=function(){},this.HandleMouseDown=function(t,e,i,s){},this.HandleMouseMove=function(t,e,i){},this.HandleDblClick=function(t,e){},this.HandleMouseUp=function(t,e,i,s){},this.HandleKeyPress=function(t){},this.HandleKeyDown=function(t,e){},this.HandleDialogKey=function(t,e){},this.HandleKeyUp=function(t,e){},this.HandleMouseWheel=function(t,e,i){},this.HandleDragOver=function(t,e,i){},this.HandleDragDrop=function(t,e){},this.Create$1=function(t){var e=0;return pas["WEBLib.Controls"].TControl.Create$1.apply(this,arguments),e=96,this.FDesigntimeFormPixelsPerInch=e,this.FPaintScaleFactor=1,this.FResourceScaleFactor=1,this.SetDefaultGraphicColors(),this.FAdaptToStyle=!1,this.FAdaptedToStyle=!1,this.FTransparent=!1,this.FNativeCanvas=!1,this.FBufferedPainting=!1,this.FAntiAliasing=!0,this.FOptimizedHTMLDrawing=!0,this.FShowAcceleratorChar=!0,this.FTextQuality=1,this.FAllowFocus=!0,this},this.Destroy=function(){pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.SetControlMargins=function(t,e,i,s){this.SetAlignWithMargins(!0),this.FMargins.SetLeft(Math.round(t)),this.FMargins.SetTop(Math.round(e)),this.FMargins.SetRight(Math.round(i)),this.FMargins.SetBottom(Math.round(s))},this.GetControlMargins=function(t,e,i,s){this.FAlignWithMargins&&(t.set(this.FMargins.FLeft),e.set(this.FMargins.FTop),i.set(this.FMargins.FRight),s.set(this.FMargins.FBottom))},this.ScalePaintValue=function(t){return pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.MulDivInt(t,Math.round(100*this.FPaintScaleFactor),100)},this.ScalePaintValue$1=function(t){return t*this.FPaintScaleFactor},rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCCustomControlBase",this.TTMSFNCCustomControlBaseCommon,(function(){this.$init=function(){t.TTMSFNCCustomControlBaseCommon.$init.call(this),this.FStored=!1,this.FHitTest=!1},this.MouseWheel=function(t,e,i){pas["WEBLib.Controls"].TControl.MouseWheel.apply(this,arguments),this.HandleMouseWheel(rtl.refSet(t),e,i)},this.DoMouseLeave=function(){pas["WEBLib.Controls"].TControl.DoMouseLeave.call(this),this.HandleMouseLeave()},this.DoMouseEnter=function(){pas["WEBLib.Controls"].TControl.DoMouseEnter.call(this),this.HandleMouseEnter()},this.GetLocalRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.GetWidth(),this.GetHeight())),t},this.MouseDown=function(t,e,i,s){pas["WEBLib.Controls"].TControl.MouseDown.apply(this,arguments),this.HandleMouseDown(t,rtl.refSet(e),i,s),null!=this.FOnInternalMouseDown&&this.FOnInternalMouseDown(this)},this.MouseMove=function(t,e,i){pas["WEBLib.Controls"].TControl.MouseMove.apply(this,arguments),this.HandleMouseMove(rtl.refSet(t),e,i),null!=this.FOnInternalMouseMove&&this.FOnInternalMouseMove(this)},this.MouseUp=function(t,e,i,s){pas["WEBLib.Controls"].TControl.MouseUp.apply(this,arguments),this.HandleMouseUp(t,rtl.refSet(e),i,s),null!=this.FOnInternalMouseUp&&this.FOnInternalMouseUp(this)},this.DragOver=function(t,e,i,s,n){pas["WEBLib.Controls"].TControl.DragOver.apply(this,arguments),this.HandleDragOver(t,pas["WEBLib.TMSFNCTypes"].PointF(e,i),n)},this.KeyDown=function(t,e){pas["WEBLib.Controls"].TControl.KeyDown.apply(this,arguments),this.HandleDialogKey(t,rtl.refSet(e)),this.HandleKeyDown(t,rtl.refSet(e)),t.get()},this.KeyPress=function(t){pas["WEBLib.Controls"].TControl.KeyPress.apply(this,arguments),this.HandleKeyPress(t)},this.KeyUp=function(t,e){pas["WEBLib.Controls"].TControl.KeyUp.apply(this,arguments),this.HandleKeyUp(t,rtl.refSet(e))},this.DblClick=function(){var t=pas["WEBLib.TMSFNCTypes"].TPointF.$new();pas["WEBLib.Controls"].TControl.DblClick.call(this),t.$assign(this.ConvertScreenToClient(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetMousePos()))),this.HandleDblClick(t.X,t.Y),null!=this.FOnInternalDblClick&&this.FOnInternalDblClick(this)},this.Create$1=function(e){return t.TTMSFNCCustomControlBaseCommon.Create$1.apply(this,arguments),this.FHitTest=!0,this.FStored=!0,this.FControlStyle=rtl.unionSet(this.FControlStyle,rtl.createSet(0)),this},this.BeginUpdate=function(){pas["WEBLib.Controls"].TControl.BeginUpdate.call(this)},this.EndUpdate=function(){pas["WEBLib.Controls"].TCustomControl.EndUpdate.call(this)},this.DragDrop=function(t,e,i){pas["WEBLib.Controls"].TControl.DragDrop.apply(this,arguments),this.HandleDragDrop(t,pas["WEBLib.TMSFNCTypes"].PointF(e,i))},this.CanFocus=function(){return pas["WEBLib.Controls"].TControl.CanFocus.call(this)&&this.GetAllowFocus()},rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),this.$rtti.$MethodVar("TTMSFNCCustomControlBeforeDrawEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomControlAfterDrawEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomControlCanSavePropertyEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AObject",pas.System.$rtti.TObject],["APropertyName",rtl.string],["APropertyType",pas.System.$rtti.TTypeKind],["ACanSave",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomControlCanLoadPropertyEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AObject",pas.System.$rtti.TObject],["APropertyName",rtl.string],["APropertyType",pas.System.$rtti.TTypeKind],["ACanLoad",rtl.boolean,1]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomControl",this.TTMSFNCCustomControlBase,(function(){this.FBlockPersistenceInterface=!1,this.$init=function(){t.TTMSFNCCustomControlBase.$init.call(this),this.FBlockInvalidate=!1,this.FAppearancePersisting=!1,this.FExporting=!1,this.FExportRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),this.FOnBeforeDraw=null,this.FOnAfterDraw=null,this.FOnCanSaveProperty=null,this.FOnCanLoadProperty=null,this.FCheckedChk=null,this.FUnCheckedChk=null,this.FCheckedFocusChk=null,this.FUnCheckedFocusChk=null,this.FCheckedDisabledChk=null,this.FUnCheckedDisabledChk=null,this.FCheckedRd=null,this.FUnCheckedRd=null,this.FCheckedFocusRd=null,this.FUnCheckedFocusRd=null,this.FCheckedDisabledRd=null,this.FUnCheckedDisabledRd=null,this.FDownBtn=null,this.FNormalBtn=null,this.FDownFocusBtn=null,this.FNormalFocusBtn=null,this.FNormalDisabledBtn=null,this.FFill=null,this.FStroke=null,this.FDataString="",this.FUndoManager=null},this.$final=function(){this.FExportRect=void 0,this.FOnBeforeDraw=void 0,this.FOnAfterDraw=void 0,this.FOnCanSaveProperty=void 0,this.FOnCanLoadProperty=void 0,this.FCheckedChk=void 0,this.FUnCheckedChk=void 0,this.FCheckedFocusChk=void 0,this.FUnCheckedFocusChk=void 0,this.FCheckedDisabledChk=void 0,this.FUnCheckedDisabledChk=void 0,this.FCheckedRd=void 0,this.FUnCheckedRd=void 0,this.FCheckedFocusRd=void 0,this.FUnCheckedFocusRd=void 0,this.FCheckedDisabledRd=void 0,this.FUnCheckedDisabledRd=void 0,this.FDownBtn=void 0,this.FNormalBtn=void 0,this.FDownFocusBtn=void 0,this.FNormalFocusBtn=void 0,this.FNormalDisabledBtn=void 0,this.FFill=void 0,this.FStroke=void 0,this.FUndoManager=void 0,t.TTMSFNCCustomControlBase.$final.call(this)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.GetVersionNumber=function(t,e,i,s){return"",""},this.IsAppearanceProperty=function(t,e,i){var s,n=!1,o="",r="";return n=!1,null!=(s=pas.TypInfo.GetPropInfo$2(t,e))&&(o=pas["WEBLib.TMSFNCPersistence"].TTMSFNCPersistence.GetPropInfoName(s),n=(n="TAlphaColor"===(r=pas["WEBLib.TMSFNCPersistence"].TTMSFNCPersistence.GetPropInfoTypeName(s))||"TColor"===r||"TGraphicsColor"===r||"TTMSFNCGraphicsFill"===r||"TTMSFNCGraphicsStroke"===r||pas.System.Pos("Appearance",o)>0)||"Fill"===e||"Stroke"===e||"Font"===e),n},this.CanSaveProperty=function(t,e,i){var s=!1;return s=!(t===this&&!this.FBlockPersistenceInterface)||-1===pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IndexOfTextInArray(e,pas["WEBLib.TMSFNCPersistence"].ExcludePropertyList),this.FAppearancePersisting&&(s=s&&this.IsAppearanceProperty(t,e,i)),this.DoCanSaveProperty(t,e,i,{get:function(){return s},set:function(t){s=t}}),s},this.CanLoadProperty=function(t,e,i){var s=!1;return s=!(t===this&&!this.FBlockPersistenceInterface)||-1===pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IndexOfTextInArray(e,pas["WEBLib.TMSFNCPersistence"].ExcludePropertyList),this.DoCanLoadProperty(t,e,i,{get:function(){return s},set:function(t){s=t}}),s},this.LocalToScreenEx=function(t){var e=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),i=pas.Types.TPoint.$new();return i.$assign(this.ClientToScreen(pas.Types.Point(Math.round(t.X),Math.round(t.Y)))),e.$assign(pas["WEBLib.TMSFNCTypes"].PointF(i.x,i.y)),e},this.GetContentRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(this.GetControlRect()),t},this.GetControlRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return this.IsExporting()?t.$assign(this.FExportRect):t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.GetWidth(),this.GetHeight())),t},this.GetLocalRect=function(){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return this.IsExporting()?e.$assign(this.FExportRect):e.$assign(t.TTMSFNCCustomControlBase.GetLocalRect.call(this)),e},this.IsExporting=function(){return this.FExporting},this.SetColor=function(t){pas["WEBLib.Controls"].TControl.SetColor.apply(this,arguments),null!=this.FFill&&this.FFill.SetColor(t),this.Invalidate()},this.RegisterRuntimeClasses=function(){},this.ApplyStyle=function(){var e=0;t.TTMSFNCCustomControlBaseCommon.ApplyStyle.call(this),e=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return e},set:function(t){e=t}})&&this.FFill.SetColor(e),e=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleLineFillColor({get:function(){return e},set:function(t){e=t}})&&this.FStroke.SetColor(e)},this.ResetToDefaultStyle=function(){t.TTMSFNCCustomControlBaseCommon.ResetToDefaultStyle.call(this),this.FFill.SetColor(16777215),this.FStroke.SetColor(12632256)},this.DestroyGraphicElements=function(){null!=this.FDownBtn&&(rtl.free(this,"FDownBtn"),this.FDownBtn=null),null!=this.FNormalBtn&&(rtl.free(this,"FNormalBtn"),this.FNormalBtn=null),null!=this.FDownFocusBtn&&(rtl.free(this,"FDownFocusBtn"),this.FDownFocusBtn=null),null!=this.FNormalFocusBtn&&(rtl.free(this,"FNormalFocusBtn"),this.FNormalFocusBtn=null),null!=this.FNormalDisabledBtn&&(rtl.free(this,"FNormalDisabledBtn"),this.FNormalDisabledBtn=null),null!=this.FCheckedChk&&(rtl.free(this,"FCheckedChk"),this.FCheckedChk=null),null!=this.FCheckedFocusChk&&(rtl.free(this,"FCheckedFocusChk"),this.FCheckedFocusChk=null),null!=this.FUnCheckedDisabledChk&&(rtl.free(this,"FUnCheckedDisabledChk"),this.FUnCheckedDisabledChk=null),null!=this.FCheckedDisabledChk&&(rtl.free(this,"FCheckedDisabledChk"),this.FCheckedDisabledChk=null),null!=this.FUnCheckedChk&&(rtl.free(this,"FUnCheckedChk"),this.FUnCheckedChk=null),null!=this.FUnCheckedFocusChk&&(rtl.free(this,"FUnCheckedFocusChk"),this.FUnCheckedFocusChk=null),null!=this.FCheckedRd&&(rtl.free(this,"FCheckedRd"),this.FCheckedRd=null),null!=this.FCheckedFocusRd&&(rtl.free(this,"FCheckedFocusRd"),this.FCheckedFocusRd=null),null!=this.FUnCheckedRd&&(rtl.free(this,"FUnCheckedRd"),this.FUnCheckedRd=null),null!=this.FUnCheckedFocusRd&&(rtl.free(this,"FUnCheckedFocusRd"),this.FUnCheckedFocusRd=null),null!=this.FUnCheckedDisabledRd&&(rtl.free(this,"FUnCheckedDisabledRd"),this.FUnCheckedDisabledRd=null),null!=this.FCheckedDisabledRd&&(rtl.free(this,"FCheckedDisabledRd"),this.FCheckedDisabledRd=null)},this.UpdateControlAfterResize=function(){},this.CreateCheckBoxBitmaps=function(){var t,e=null,i=null;t=this.FResourceScaleFactor,null!=this.FCheckedFocusChk&&(rtl.free(this,"FCheckedFocusChk"),this.FCheckedFocusChk=null),null!=this.FUnCheckedChk&&(rtl.free(this,"FUnCheckedChk"),this.FUnCheckedChk=null),null!=this.FCheckedChk&&(rtl.free(this,"FCheckedChk"),this.FCheckedChk=null),null!=this.FUnCheckedFocusChk&&(rtl.free(this,"FUnCheckedFocusChk"),this.FUnCheckedFocusChk=null),null!=this.FUnCheckedDisabledChk&&(rtl.free(this,"FUnCheckedDisabledChk"),this.FUnCheckedDisabledChk=null),null!=this.FCheckedDisabledChk&&(rtl.free(this,"FCheckedDisabledChk"),this.FCheckedDisabledChk=null),i=pas["WEBLib.Graphics"].TBitmap.$create("Create$3"),e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("Create$1",[i.GetCanvas(),!1]);try{i.SetSize(Math.round(16*t),Math.round(16*t)),this.FUnCheckedChk=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FUnCheckedChk.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawCheckBox(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!1,!1,!0,1),this.FUnCheckedChk.Assign(i),this.FCheckedChk=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FCheckedChk.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawCheckBox(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!0,!1,!0,1),this.FCheckedChk.Assign(i),this.FUnCheckedFocusChk=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FUnCheckedFocusChk.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawCheckBox(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!1,!0,!0,1),this.FUnCheckedFocusChk.Assign(i),this.FCheckedFocusChk=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FCheckedFocusChk.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawCheckBox(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!0,!0,!0,1),this.FCheckedFocusChk.Assign(i),this.FUnCheckedDisabledChk=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FUnCheckedDisabledChk.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawCheckBox(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!1,!1,!1,1),this.FUnCheckedDisabledChk.Assign(i),this.FCheckedDisabledChk=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FCheckedDisabledChk.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawCheckBox(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!0,!1,!1,1),this.FCheckedDisabledChk.Assign(i)}finally{e=rtl.freeLoc(e),i=rtl.freeLoc(i)}},this.CreateRadioButtonBitmaps=function(){var t,e=null,i=null;t=this.FResourceScaleFactor,null!=this.FCheckedFocusRd&&(rtl.free(this,"FCheckedFocusRd"),this.FCheckedFocusRd=null),null!=this.FUnCheckedRd&&(rtl.free(this,"FUnCheckedRd"),this.FUnCheckedRd=null),null!=this.FCheckedRd&&(rtl.free(this,"FCheckedRd"),this.FCheckedRd=null),null!=this.FUnCheckedFocusRd&&(rtl.free(this,"FUnCheckedFocusRd"),this.FUnCheckedFocusRd=null),null!=this.FUnCheckedDisabledRd&&(rtl.free(this,"FUnCheckedDisabledRd"),this.FUnCheckedDisabledRd=null),null!=this.FCheckedDisabledRd&&(rtl.free(this,"FCheckedDisabledRd"),this.FCheckedDisabledRd=null),i=pas["WEBLib.Graphics"].TBitmap.$create("Create$3"),e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("Create$1",[i.GetCanvas(),!1]);try{i.SetSize(Math.round(16*t),Math.round(16*t)),this.FUnCheckedRd=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FUnCheckedRd.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawRadioButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!1,!1,!0,1),this.FUnCheckedRd.Assign(i),this.FCheckedRd=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FCheckedRd.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawRadioButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!0,!1,!0,1),this.FCheckedRd.Assign(i),this.FUnCheckedFocusRd=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FUnCheckedFocusRd.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawRadioButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!1,!0,!0,1),this.FUnCheckedFocusRd.Assign(i),this.FCheckedFocusRd=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FCheckedFocusRd.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawRadioButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!0,!0,!0,1),this.FCheckedFocusRd.Assign(i),this.FUnCheckedDisabledRd=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FUnCheckedDisabledRd.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawRadioButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!1,!1,!1,1),this.FUnCheckedDisabledRd.Assign(i),this.FCheckedDisabledRd=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FCheckedDisabledRd.FOnChange=rtl.createCallback(this,"DoBitmapChanged"),e.FFill.SetKind(1),e.FFill.SetColor(16777215),e.FStroke.SetKind(1),e.FStroke.SetColor(16777215),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),2),e.DrawRadioButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,i.GetWidth(),i.GetHeight())),!0,!1,!1,1),this.FCheckedDisabledRd.Assign(i)}finally{e=rtl.freeLoc(e),i=rtl.freeLoc(i)}},this.DoBeforeDraw=function(t,e,i){null!=this.FOnBeforeDraw&&this.FOnBeforeDraw(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoAfterDraw=function(t,e){null!=this.FOnAfterDraw&&this.FOnAfterDraw(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},this.DoCanSaveProperty=function(t,e,i,s){null!=this.FOnCanSaveProperty&&this.FOnCanSaveProperty(this,t,e,i,s)},this.DoCanLoadProperty=function(t,e,i,s){null!=this.FOnCanLoadProperty&&this.FOnCanLoadProperty(this,t,e,i,s)},this.DrawBackground=function(t,e){t.FFill.Assign(this.FFill),t.FFill.SetColor(this.FColor),t.FStroke.Assign(this.FStroke),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),2)},this.StrokeChanged=function(t){this.Invalidate()},this.FillChanged=function(t){0!==this.FFill.FKind&&3!==this.FFill.FKind&&-1!==this.FFill.FColor?this.SetColor(this.FFill.FColor):this.SetColor(-1),this.Invalidate()},this.Draw=function(t,e){},this.DrawControl=function(){var t=null,e=null,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=!1,n=null;this.FBufferedPainting?(t=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[this.GetWidth(),this.GetHeight(),this.FNativeCanvas,!0])).BeginScene():t=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("Create$1",[this.GetCanvas(),this.FNativeCanvas]),t.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing,t.GetContext().SetSize(this.GetWidth(),this.GetHeight()),t.GetContext().SetAntiAliasing(this.FAntiAliasing),t.GetContext().SetShowAcceleratorChar(this.FShowAcceleratorChar),t.GetContext().SetTextQuality(this.FTextQuality);try{if(i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.GetWidth(),this.GetHeight())),s=!0,this.DoBeforeDraw(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),{get:function(){return s},set:function(t){s=t}}),s&&(this.DrawBackground(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i)),this.Draw(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i)),this.DoAfterDraw(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))),this.FBufferedPainting&&t.EndScene(),t.GetContext().Render(),this.FBufferedPainting){n=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3");try{n.Assign(t.FBitmap),e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("Create$1",[this.GetCanvas(),!1]);try{e.GetContext().SetSize(this.GetWidth(),this.GetHeight()),e.GetContext().SetAntiAliasing(this.FAntiAliasing),e.GetContext().SetShowAcceleratorChar(this.FShowAcceleratorChar),e.GetContext().SetTextQuality(this.FTextQuality),e.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),n,!0,!1,!0,!1)}finally{e=rtl.freeLoc(e)}}finally{n=rtl.freeLoc(n)}}}finally{t=rtl.freeLoc(t)}},this.DoBitmapChanged=function(t){this.FBlockInvalidate||(this.FBlockInvalidate=!0,this.Invalidate(),this.FBlockInvalidate=!1)},this.CaptureEx=function(){this.Capture()},this.ReleaseCaptureEx=function(){this.ReleaseCapture()},this.Assign=function(e){t.TTMSFNCCustomControl.isPrototypeOf(e)?(this.FFill.Assign(rtl.as(e,t.TTMSFNCCustomControl).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCCustomControl).FStroke)):pas["WEBLib.Controls"].TControl.Assign.apply(this,arguments)},this.Create$1=function(e){return t.TTMSFNCCustomControlBase.Create$1.apply(this,arguments),this.SetColor(16777215),this.FLinkTouchEvents=!0,this.FAllowTouch=!1,this.SetTabStop(!0),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.IsDesignerForm()||this.RegisterRuntimeClasses(),this},this.Destroy=function(){null!=this.FUndoManager&&(rtl.free(this,"FUndoManager"),this.FUndoManager=null),null!=this.FDownBtn&&(rtl.free(this,"FDownBtn"),this.FDownBtn=null),null!=this.FNormalBtn&&(rtl.free(this,"FNormalBtn"),this.FNormalBtn=null),null!=this.FDownFocusBtn&&(rtl.free(this,"FDownFocusBtn"),this.FDownFocusBtn=null),null!=this.FNormalFocusBtn&&(rtl.free(this,"FNormalFocusBtn"),this.FNormalFocusBtn=null),null!=this.FNormalDisabledBtn&&(rtl.free(this,"FNormalDisabledBtn"),this.FNormalDisabledBtn=null),null!=this.FCheckedChk&&(rtl.free(this,"FCheckedChk"),this.FCheckedChk=null),null!=this.FCheckedFocusChk&&(rtl.free(this,"FCheckedFocusChk"),this.FCheckedFocusChk=null),null!=this.FUnCheckedDisabledChk&&(rtl.free(this,"FUnCheckedDisabledChk"),this.FUnCheckedDisabledChk=null),null!=this.FCheckedDisabledChk&&(rtl.free(this,"FCheckedDisabledChk"),this.FCheckedDisabledChk=null),null!=this.FUnCheckedChk&&(rtl.free(this,"FUnCheckedChk"),this.FUnCheckedChk=null),null!=this.FUnCheckedFocusChk&&(rtl.free(this,"FUnCheckedFocusChk"),this.FUnCheckedFocusChk=null),null!=this.FCheckedRd&&(rtl.free(this,"FCheckedRd"),this.FCheckedRd=null),null!=this.FCheckedFocusRd&&(rtl.free(this,"FCheckedFocusRd"),this.FCheckedFocusRd=null),null!=this.FUnCheckedRd&&(rtl.free(this,"FUnCheckedRd"),this.FUnCheckedRd=null),null!=this.FUnCheckedFocusRd&&(rtl.free(this,"FUnCheckedFocusRd"),this.FUnCheckedFocusRd=null),null!=this.FUnCheckedDisabledRd&&(rtl.free(this,"FUnCheckedDisabledRd"),this.FUnCheckedDisabledRd=null),null!=this.FCheckedDisabledRd&&(rtl.free(this,"FCheckedDisabledRd"),this.FCheckedDisabledRd=null),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),t.TTMSFNCCustomControlBaseCommon.Destroy.call(this)},this.GetCheckBoxBitmap=function(t,e,i){return null!=this.FCheckedChk&&null!=this.FCheckedFocusChk&&null!=this.FUnCheckedChk&&null!=this.FUnCheckedFocusChk&&null!=this.FCheckedDisabledChk&&null!=this.FUnCheckedDisabledChk||this.CreateCheckBoxBitmaps(),t?i?e?this.FCheckedFocusChk:this.FCheckedChk:this.FCheckedDisabledChk:i?e?this.FUnCheckedFocusChk:this.FUnCheckedChk:this.FUnCheckedDisabledChk},this.GetRadioButtonBitmap=function(t,e,i){return null!=this.FCheckedRd&&null!=this.FCheckedFocusRd&&null!=this.FUnCheckedRd&&null!=this.FUnCheckedFocusRd&&null!=this.FCheckedDisabledRd&&null!=this.FUnCheckedDisabledRd||this.CreateRadioButtonBitmaps(),t?i?e?this.FCheckedFocusRd:this.FCheckedRd:this.FCheckedDisabledRd:i?e?this.FUnCheckedFocusRd:this.FUnCheckedRd:this.FUnCheckedDisabledRd},this.IsDesignTime=function(){var t=!1;return t=!1,null!=this.FOwner&&(t=this.IsDesigning()&&!(1 in this.FOwner.FComponentState||0 in this.FOwner.FComponentState)),t},this.IsLoading=function(){var t=!1;return t=!1,null!=this.FOwner&&(t=0 in this.FOwner.FComponentState),t},this.IsReading=function(){var t=!1;return t=!1,null!=this.FOwner&&(t=1 in this.FOwner.FComponentState),t},this.IsDesigning=function(){return 4 in this.FComponentState||null!=pas["WEBLib.Forms"].VSIDE},this.IsDesignerForm=function(){var e,i=!1;return e=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetOwnerForm(this),i=this.IsDesigning(),null!=e&&(i=i||t.TTMSFNCCustomDesignerForm.isPrototypeOf(e)),i},this.IsDestroying=function(){return 3 in this.FComponentState},this.DisableBackground=function(){this.FFill.SetKind(0),this.FStroke.SetKind(0),this.SetColor(-1)},this.Resize=function(){pas["WEBLib.Controls"].TCustomControl.Resize.call(this),this.UpdateControlAfterResize()},this.Paint=function(){pas["WEBLib.Controls"].TCustomControl.Paint.call(this),this.FBlockInvalidate||this.DrawControl()},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("AdaptToStyle",3,rtl.boolean,"GetAdaptToStyle","SetAdaptToStyle",{Default:!1}),e.addProperty("AllowFocus",3,rtl.boolean,"GetAllowFocus","SetAllowFocus",{Default:!0}),e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),e.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default:!1}),e.addProperty("DoubleBuffered",0,rtl.boolean,"FDoubleBuffered","FDoubleBuffered",{Default:!1}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),e.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti.TMargins,"FMargins","SetMargins"),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),e.addProperty("ParentDoubleBuffered",0,rtl.boolean,"FParentDoubleBuffered","FParentDoubleBuffered",{Default:!0}),e.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),e.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),e.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),e.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),e.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),e.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),e.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),e.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),e.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),e.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),e.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),e.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),e.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),e.addProperty("OnMouseWheel",0,pas["WEBLib.Controls"].$rtti.TMouseWheelEvent,"FOnMouseWheel","FOnMouseWheel"),e.addProperty("OnMouseWheelUp",0,pas["WEBLib.Controls"].$rtti.TMouseWheelUpDownEvent,"FOnMouseWheelUp","FOnMouseWheelUp"),e.addProperty("OnMouseWheelDown",0,pas["WEBLib.Controls"].$rtti.TMouseWheelUpDownEvent,"FOnMouseWheelDown","FOnMouseWheelDown"),e.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti.TDragOverEvent,"FOnDragOver","FOnDragOver"),e.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti.TDragDropEvent,"FOnDragDrop","FOnDragDrop"),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("ShowAcceleratorChar",2,rtl.boolean,"FShowAcceleratorChar","SetShowAcceleratorChar",{Default:!0}),e.addProperty("OnBeforeDraw",0,t.$rtti.TTMSFNCCustomControlBeforeDrawEvent,"FOnBeforeDraw","FOnBeforeDraw"),e.addProperty("OnAfterDraw",0,t.$rtti.TTMSFNCCustomControlAfterDrawEvent,"FOnAfterDraw","FOnAfterDraw"),e.addProperty("OnCanSaveProperty",0,t.$rtti.TTMSFNCCustomControlCanSavePropertyEvent,"FOnCanSaveProperty","FOnCanSaveProperty"),e.addProperty("OnCanLoadProperty",0,t.$rtti.TTMSFNCCustomControlCanLoadPropertyEvent,"FOnCanLoadProperty","FOnCanLoadProperty")}))}),["WEBLib.TMSFNCUtils","SysUtils","WEBLib.StdCtrls"]),rtl.module("WEBLib.TMSFNCScrollBar",["System","Classes","WEBLib.TMSFNCCustomControl","WEBLib.ExtCtrls","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphics","WEBLib.Controls","WEBLib.TMSFNCGraphicsTypes"],(function(){"use strict";var t=this;rtl.createClass(this,"TTMSFNCScrollBarAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FScrollButtonSize=0,this.FThumbButtonSize=0,this.FOnChange=null,this.FFixedThumb=!1,this.FArrowColor=0,this.FThumbStroke=null,this.FThumbButtonRightDownStroke=null,this.FThumbFill=null,this.FThumbButtonLeftFill=null,this.FScrollButtonLeftHoverFill=null,this.FScrollButtonLeftStroke=null,this.FScrollButtonRightFill=null,this.FThumbButtonLeftHoverFill=null,this.FThumbButtonLeftStroke=null,this.FScrollButtonLeftHoverStroke=null,this.FThumbButtonRightFill=null,this.FScrollButtonRightHoverFill=null,this.FScrollButtonRightStroke=null,this.FThumbButtonLeftHoverStroke=null,this.FScrollButtonLeftDownFill=null,this.FThumbButtonRightHoverFill=null,this.FThumbButtonRightStroke=null,this.FScrollButtonRightHoverStroke=null,this.FThumbButtonLeftDownFill=null,this.FScrollButtonLeftDownStroke=null,this.FThumbButtonRightHoverStroke=null,this.FScrollButtonRightDownFill=null,this.FThumbButtonLeftDownStroke=null,this.FThumbButtonRightDownFill=null,this.FScrollButtonRightDownStroke=null,this.FScrollButtonLeftFill=null},this.$final=function(){this.FOwner=void 0,this.FOnChange=void 0,this.FThumbStroke=void 0,this.FThumbButtonRightDownStroke=void 0,this.FThumbFill=void 0,this.FThumbButtonLeftFill=void 0,this.FScrollButtonLeftHoverFill=void 0,this.FScrollButtonLeftStroke=void 0,this.FScrollButtonRightFill=void 0,this.FThumbButtonLeftHoverFill=void 0,this.FThumbButtonLeftStroke=void 0,this.FScrollButtonLeftHoverStroke=void 0,this.FThumbButtonRightFill=void 0,this.FScrollButtonRightHoverFill=void 0,this.FScrollButtonRightStroke=void 0,this.FThumbButtonLeftHoverStroke=void 0,this.FScrollButtonLeftDownFill=void 0,this.FThumbButtonRightHoverFill=void 0,this.FThumbButtonRightStroke=void 0,this.FScrollButtonRightHoverStroke=void 0,this.FThumbButtonLeftDownFill=void 0,this.FScrollButtonLeftDownStroke=void 0,this.FThumbButtonRightHoverStroke=void 0,this.FScrollButtonRightDownFill=void 0,this.FThumbButtonLeftDownStroke=void 0,this.FThumbButtonRightDownFill=void 0,this.FScrollButtonRightDownStroke=void 0,this.FScrollButtonLeftFill=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetThumbButtonSize=function(t){this.FThumbButtonSize!==t&&(this.FThumbButtonSize=t,this.Changed())},this.SetFixedThumb=function(t){this.FFixedThumb!==t&&(this.FFixedThumb=t,this.Changed())},this.SetArrowColor=function(t){this.FArrowColor!==t&&(this.FArrowColor=t,this.Changed())},this.SetScrollButtonLeftDownFill=function(t){this.FScrollButtonLeftDownFill.Assign(t)},this.SetScrollButtonLeftDownStroke=function(t){this.FScrollButtonLeftDownStroke.Assign(t)},this.SetScrollButtonLeftFill=function(t){this.FScrollButtonLeftFill.Assign(t)},this.SetScrollButtonLeftHoverFill=function(t){this.FScrollButtonLeftHoverFill.Assign(t)},this.SetScrollButtonLeftHoverStroke=function(t){this.FScrollButtonLeftHoverStroke.Assign(t)},this.SetScrollButtonLeftStroke=function(t){this.FScrollButtonLeftStroke.Assign(t)},this.SetScrollButtonRightDownFill=function(t){this.FScrollButtonRightDownFill.Assign(t)},this.SetScrollButtonRightDownStroke=function(t){this.FScrollButtonRightDownStroke.Assign(t)},this.SetScrollButtonRightFill=function(t){this.FScrollButtonRightFill.Assign(t)},this.SetScrollButtonRightHoverFill=function(t){this.FScrollButtonRightHoverFill.Assign(t)},this.SetScrollButtonRightHoverStroke=function(t){this.FScrollButtonRightHoverStroke.Assign(t)},this.SetScrollButtonRightStroke=function(t){this.FScrollButtonRightStroke.Assign(t)},this.SetScrollButtonSize=function(t){this.FScrollButtonSize!==t&&(this.FScrollButtonSize=t,this.Changed())},this.SetThumbButtonLeftDownFill=function(t){this.FThumbButtonLeftDownFill.Assign(t)},this.SetThumbButtonLeftDownStroke=function(t){this.FThumbButtonLeftDownStroke.Assign(t)},this.SetThumbButtonLeftFill=function(t){this.FThumbButtonLeftFill.Assign(t)},this.SetThumbButtonLeftHoverFill=function(t){this.FThumbButtonLeftHoverFill.Assign(t)},this.SetThumbButtonLeftHoverStroke=function(t){this.FThumbButtonLeftHoverStroke.Assign(t)},this.SetThumbButtonLeftStroke=function(t){this.FThumbButtonLeftStroke.Assign(t)},this.SetThumbButtonRightDownFill=function(t){this.FThumbButtonRightDownFill.Assign(t)},this.SetThumbButtonRightDownStroke=function(t){this.FThumbButtonRightDownStroke.Assign(t)},this.SetThumbButtonRightFill=function(t){this.FThumbButtonRightFill.Assign(t)},this.SetThumbButtonRightHoverFill=function(t){this.FThumbButtonRightHoverFill.Assign(t)},this.SetThumbButtonRightHoverStroke=function(t){this.FThumbButtonRightHoverStroke.Assign(t)},this.SetThumbButtonRightStroke=function(t){this.FThumbButtonRightStroke.Assign(t)},this.SetThumbFill=function(t){this.FThumbFill.Assign(t)},this.SetThumbStroke=function(t){this.FThumbStroke.Assign(t)},this.IsScrollButtonSizeStored=function(){return 18!==this.FScrollButtonSize},this.IsThumbButtonSizeStored=function(){return 18!==this.FThumbButtonSize},this.Changed=function(){this.FOwner.Changed()},this.FillChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.Create$1=function(t){return this.FOwner=t,this.FThumbFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(225,225,225),8421504,-1,-1]),this.FThumbFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FThumbButtonLeftFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(225,225,225),8421504,-1,-1]),this.FThumbButtonLeftFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FThumbButtonRightFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(225,225,225),8421504,-1,-1]),this.FThumbButtonRightFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FThumbButtonLeftHoverFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251),8421504,-1,-1]),this.FThumbButtonLeftHoverFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FThumbButtonRightHoverFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251),8421504,-1,-1]),this.FThumbButtonRightHoverFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FThumbButtonLeftDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].Darker(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251),40),8421504,-1,-1]),this.FThumbButtonLeftDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FThumbButtonRightDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].Darker(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251),40),8421504,-1,-1]),this.FThumbButtonRightDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FScrollButtonLeftFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(225,225,225),8421504,-1,-1]),this.FScrollButtonLeftFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FScrollButtonRightFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(225,225,225),8421504,-1,-1]),this.FScrollButtonRightFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FScrollButtonLeftHoverFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251),8421504,-1,-1]),this.FScrollButtonLeftHoverFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FScrollButtonRightHoverFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251),8421504,-1,-1]),this.FScrollButtonRightHoverFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FScrollButtonLeftDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].Darker(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251),40),8421504,-1,-1]),this.FScrollButtonLeftDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FScrollButtonRightDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].Darker(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,241,251),40),8421504,-1,-1]),this.FScrollButtonRightDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FThumbStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].Darker(11119017,40)]),this.FThumbStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FThumbButtonLeftStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].Darker(11119017,40)]),this.FThumbButtonLeftStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FThumbButtonRightStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].Darker(11119017,40)]),this.FThumbButtonRightStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FThumbButtonLeftHoverStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177)]),this.FThumbButtonLeftHoverStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FThumbButtonRightHoverStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177)]),this.FThumbButtonRightHoverStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FThumbButtonLeftDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177)]),this.FThumbButtonLeftDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FThumbButtonRightDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177)]),this.FThumbButtonRightDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FScrollButtonLeftStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].Darker(11119017,40)]),this.FScrollButtonLeftStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FScrollButtonRightStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].Darker(11119017,40)]),this.FScrollButtonRightStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FScrollButtonLeftHoverStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177)]),this.FScrollButtonLeftHoverStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FScrollButtonRightHoverStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177)]),this.FScrollButtonRightHoverStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FScrollButtonLeftDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177)]),this.FScrollButtonLeftDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FScrollButtonRightDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(60,127,177)]),this.FScrollButtonRightDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FArrowColor=0,this.FFixedThumb=!1,this.FThumbButtonSize=18,this.FScrollButtonSize=18,this},this.Destroy=function(){rtl.free(this,"FThumbFill"),rtl.free(this,"FScrollButtonLeftFill"),rtl.free(this,"FScrollButtonRightFill"),rtl.free(this,"FScrollButtonLeftHoverFill"),rtl.free(this,"FScrollButtonRightHoverFill"),rtl.free(this,"FScrollButtonLeftDownFill"),rtl.free(this,"FScrollButtonRightDownFill"),rtl.free(this,"FThumbButtonLeftFill"),rtl.free(this,"FThumbButtonRightFill"),rtl.free(this,"FThumbButtonLeftHoverFill"),rtl.free(this,"FThumbButtonRightHoverFill"),rtl.free(this,"FThumbButtonLeftDownFill"),rtl.free(this,"FThumbButtonRightDownFill"),rtl.free(this,"FThumbStroke"),rtl.free(this,"FScrollButtonLeftStroke"),rtl.free(this,"FScrollButtonRightStroke"),rtl.free(this,"FScrollButtonLeftHoverStroke"),rtl.free(this,"FScrollButtonRightHoverStroke"),rtl.free(this,"FScrollButtonLeftDownStroke"),rtl.free(this,"FScrollButtonRightDownStroke"),rtl.free(this,"FThumbButtonLeftStroke"),rtl.free(this,"FThumbButtonRightStroke"),rtl.free(this,"FThumbButtonLeftHoverStroke"),rtl.free(this,"FThumbButtonRightHoverStroke"),rtl.free(this,"FThumbButtonLeftDownStroke"),rtl.free(this,"FThumbButtonRightDownStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCScrollBarAppearance.isPrototypeOf(e)&&(this.FThumbFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbFill),this.FScrollButtonSize=rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonSize,this.FThumbButtonSize=rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonSize,this.FThumbButtonLeftFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonLeftFill),this.FThumbButtonLeftHoverFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonLeftHoverFill),this.FThumbButtonLeftDownFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonLeftDownFill),this.FThumbButtonRightFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonRightFill),this.FThumbButtonRightDownFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonRightDownFill),this.FThumbButtonRightHoverFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonRightHoverFill),this.FScrollButtonLeftFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonLeftFill),this.FScrollButtonLeftHoverFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonLeftHoverFill),this.FScrollButtonLeftDownFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonLeftDownFill),this.FScrollButtonRightFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonRightFill),this.FScrollButtonRightDownFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonRightDownFill),this.FScrollButtonRightHoverFill.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonRightHoverFill),this.FThumbButtonLeftStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonLeftStroke),this.FThumbButtonLeftHoverStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonLeftHoverStroke),this.FThumbButtonLeftDownStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonLeftDownStroke),this.FThumbButtonRightStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonRightStroke),this.FThumbButtonRightDownStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonRightDownStroke),this.FThumbButtonRightHoverStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FThumbButtonRightHoverStroke),this.FScrollButtonLeftStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonLeftStroke),this.FScrollButtonLeftHoverStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonLeftHoverStroke),this.FScrollButtonLeftDownStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonLeftDownStroke),this.FScrollButtonRightStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonRightStroke),this.FScrollButtonRightDownStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonRightDownStroke),this.FScrollButtonRightHoverStroke.Assign(rtl.as(e,t.TTMSFNCScrollBarAppearance).FScrollButtonRightHoverStroke),this.Changed())},this.GetThumbButtonSize=function(){return this.FFixedThumb?0:this.FThumbButtonSize};var e=this.$rtti;e.addProperty("ThumbFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FThumbFill","SetThumbFill"),e.addProperty("ScrollButtonLeftFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FScrollButtonLeftFill","SetScrollButtonLeftFill"),e.addProperty("ScrollButtonRightFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FScrollButtonRightFill","SetScrollButtonRightFill"),e.addProperty("ScrollButtonLeftHoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FScrollButtonLeftHoverFill","SetScrollButtonLeftHoverFill"),e.addProperty("ScrollButtonRightHoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FScrollButtonRightHoverFill","SetScrollButtonRightHoverFill"),e.addProperty("ScrollButtonLeftDownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FScrollButtonLeftDownFill","SetScrollButtonLeftDownFill"),e.addProperty("ScrollButtonRightDownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FScrollButtonRightDownFill","SetScrollButtonRightDownFill"),e.addProperty("ThumbButtonLeftFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FThumbButtonLeftFill","SetThumbButtonLeftFill"),e.addProperty("ThumbButtonRightFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FThumbButtonRightFill","SetThumbButtonRightFill"),e.addProperty("ThumbButtonLeftHoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FThumbButtonLeftHoverFill","SetThumbButtonLeftHoverFill"),e.addProperty("ThumbButtonRightHoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FThumbButtonRightHoverFill","SetThumbButtonRightHoverFill"),e.addProperty("ThumbButtonLeftDownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FThumbButtonLeftDownFill","SetThumbButtonLeftDownFill"),e.addProperty("ThumbButtonRightDownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FThumbButtonRightDownFill","SetThumbButtonRightDownFill"),e.addProperty("ThumbStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FThumbStroke","SetThumbStroke"),e.addProperty("ScrollButtonLeftStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FScrollButtonLeftStroke","SetScrollButtonLeftStroke"),e.addProperty("ScrollButtonRightStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FScrollButtonRightStroke","SetScrollButtonRightStroke"),e.addProperty("ScrollButtonLeftHoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FScrollButtonLeftHoverStroke","SetScrollButtonLeftHoverStroke"),e.addProperty("ScrollButtonRightHoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FScrollButtonRightHoverStroke","SetScrollButtonRightHoverStroke"),e.addProperty("ScrollButtonLeftDownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FScrollButtonLeftDownStroke","SetScrollButtonLeftDownStroke"),e.addProperty("ScrollButtonRightDownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FScrollButtonRightDownStroke","SetScrollButtonRightDownStroke"),e.addProperty("ThumbButtonLeftStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FThumbButtonLeftStroke","SetThumbButtonLeftStroke"),e.addProperty("ThumbButtonRightStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FThumbButtonRightStroke","SetThumbButtonRightStroke"),e.addProperty("ThumbButtonLeftHoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FThumbButtonLeftHoverStroke","SetThumbButtonLeftHoverStroke"),e.addProperty("ThumbButtonRightHoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FThumbButtonRightHoverStroke","SetThumbButtonRightHoverStroke"),e.addProperty("ThumbButtonLeftDownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FThumbButtonLeftDownStroke","SetThumbButtonLeftDownStroke"),e.addProperty("ThumbButtonRightDownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FThumbButtonRightDownStroke","SetThumbButtonRightDownStroke"),e.addProperty("ThumbButtonSize",14,rtl.double,"FThumbButtonSize","SetThumbButtonSize",{stored:"IsThumbButtonSizeStored"}),e.addProperty("ScrollButtonSize",14,rtl.double,"FScrollButtonSize","SetScrollButtonSize",{stored:"IsScrollButtonSizeStored"}),e.addProperty("FixedThumb",2,rtl.boolean,"FFixedThumb","SetFixedThumb",{Default:!1}),e.addProperty("ArrowColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FArrowColor","SetArrowColor",{Default:0}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange")})),this.TTMSFNCScrollBarMode={0:"sbmNone",sbmNone:0,1:"sbmScroll",sbmScroll:1,2:"sbmChangePageSize",sbmChangePageSize:2},this.TTMSFNCScrollBarHoveredButton={0:"shbNone",shbNone:0,1:"shbScrollMin",shbScrollMin:1,2:"shbScrollMax",shbScrollMax:2,3:"shbThumbMin",shbThumbMin:3,4:"shbThumbMax",shbThumbMax:4},this.TTMSFNCScrollBarDownButton={0:"sdbNone",sdbNone:0,1:"sdbScrollMin",sdbScrollMin:1,2:"sdbScrollMax",sdbScrollMax:2,3:"sdbThumbMin",sdbThumbMin:3,4:"sdbThumbMax",sdbThumbMax:4},this.TTMSFNCScrollButtonChange={0:"sbcNone",sbcNone:0,1:"sbcSmallSubstract",sbcSmallSubstract:1,2:"sbcSmallAdd",sbcSmallAdd:2,3:"sbcLargeSubstract",sbcLargeSubstract:3,4:"sbcLargeAdd",sbcLargeAdd:4},this.$rtti.$MethodVar("TTMSFNCScrollBarValueChanged",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Value",rtl.double]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCScrollBarPageSizeChanged",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["PageSize",rtl.double]]),methodkind:0}),this.TTMSFNCScrollBarKind={0:"sbkHorizontal",sbkHorizontal:0,1:"sbkVertical",sbkVertical:1},this.$rtti.$Enum("TTMSFNCScrollBarKind",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCScrollBarKind}),rtl.createClass(this,"TTMSFNCCustomScrollBar",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FNeedsChange=!1,this.FSavedPageSize=0,this.FDesignTime=!1,this.FMinThumb=!1,this.FMaxThumb=!1,this.FMx=0,this.FMy=0,this.FCx=0,this.FCy=0,this.FTimer=null,this.FTime=0,this.FScrollBarMode=0,this.FScrollButtonChange=0,this.FHoveredButton=0,this.FDownButton=0,this.FKind=0,this.FValue=0,this.FTempValue=0,this.FMin=0,this.FMax=0,this.FPageSize=0,this.FSmallChange=0,this.FLargeChange=0,this.FAppearance=null,this.FOnValueChange=null,this.FOnPageSizeChanged=null,this.FTracking=!1},this.$final=function(){this.FTimer=void 0,this.FAppearance=void 0,this.FOnValueChange=void 0,this.FOnPageSizeChanged=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetAppearance=function(t){this.FAppearance!==t&&(this.FAppearance.Assign(t),this.Changed())},this.SetKind=function(t){this.FKind!==t&&(this.FKind=t,0 in this.FComponentState?this.FNeedsChange=!0:this.SetBounds(this.GetLeft(),this.GetTop(),this.GetHeight(),this.GetWidth()),this.Changed())},this.SetMax=function(t){this.FMax!==t&&(this.FMax=t,this.Changed())},this.SetMin=function(t){this.FMin!==t&&(this.FMin=t,this.Changed())},this.SetValue=function(t){this.FValue!==t&&(this.FValue=Math.max(this.FMin,Math.min(this.FMax,t)),this.FTempValue=this.FValue,null!=this.FOnValueChange&&this.FOnValueChange(this,t),this.Changed())},this.SetPageSize=function(t){this.FPageSize!==t&&(this.FPageSize=Math.min(this.GetRange(),Math.max(0,t)),null!=this.FOnPageSizeChanged&&this.FOnPageSizeChanged(this,this.FPageSize),this.Changed())},this.IsLargeChangeStored=function(){return 20!==this.FLargeChange},this.IsMaxStored=function(){return 100!==this.FMax},this.IsMinStored=function(){return 0!==this.FMin},this.IsPageSizeStored=function(){return 20!==this.FPageSize},this.IsSmallChangeStored=function(){return 1!==this.FSmallChange},this.IsValueStored=function(){return 0!==this.FValue},this.SetTracking=function(t){this.FTracking!==t&&(this.FTracking=t,this.Changed())},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FThumbFill.SetColor(t),this.FAppearance.FThumbButtonLeftFill.SetColor(t),this.FAppearance.FThumbButtonRightFill.SetColor(t),this.FAppearance.FScrollButtonLeftFill.SetColor(t),this.FAppearance.FScrollButtonRightFill.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleLineFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FThumbStroke.SetColor(t),this.FAppearance.FThumbButtonLeftStroke.SetColor(t),this.FAppearance.FThumbButtonRightStroke.SetColor(t),this.FAppearance.FScrollButtonLeftStroke.SetColor(t),this.FAppearance.FScrollButtonRightStroke.SetColor(t),this.FAppearance.FThumbButtonLeftHoverStroke.SetColor(t),this.FAppearance.FThumbButtonRightHoverStroke.SetColor(t),this.FAppearance.FScrollButtonLeftHoverStroke.SetColor(t),this.FAppearance.FScrollButtonRightHoverStroke.SetColor(t),this.FAppearance.FThumbButtonLeftDownStroke.SetColor(t),this.FAppearance.FThumbButtonRightDownStroke.SetColor(t),this.FAppearance.FScrollButtonLeftDownStroke.SetColor(t),this.FAppearance.FScrollButtonRightDownStroke.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleSelectionFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FThumbButtonLeftHoverFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(this.FFill.FColor,t,70)),this.FAppearance.FThumbButtonRightHoverFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(this.FFill.FColor,t,70)),this.FAppearance.FScrollButtonLeftHoverFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(this.FFill.FColor,t,70)),this.FAppearance.FScrollButtonRightHoverFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(this.FFill.FColor,t,70)),this.FAppearance.FThumbButtonLeftDownFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(this.FFill.FColor,t,50)),this.FAppearance.FThumbButtonRightDownFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(this.FFill.FColor,t,50)),this.FAppearance.FScrollButtonLeftDownFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(this.FFill.FColor,t,50)),this.FAppearance.FScrollButtonRightDownFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(this.FFill.FColor,t,50)),this.FAppearance.SetArrowColor(t))},this.ResetToDefaultStyle=function(){var e=null;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),e=t.TTMSFNCScrollBarAppearance.$create("Create$1",[null]);try{this.FAppearance.Assign(e)}finally{e=rtl.freeLoc(e)}},this.HandleKeyDown=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyDown.apply(this,arguments);var i=t.get();38===i||37===i?this.SetValue(this.FValue-this.FSmallChange):40===i||39===i?this.SetValue(this.FValue+this.FSmallChange):36===i?this.SetValue(this.FMin):35===i?this.SetValue(this.FMax):33===i?this.SetValue(this.FValue-this.FLargeChange):34===i&&this.SetValue(this.FValue+this.FLargeChange)},this.HandleMouseDown=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.CaptureEx(),this.FCx=Math.abs(i-this.GetThumbRectangle().Left+this.GetScrollRectangle().Left),this.FCy=Math.abs(s-this.GetThumbRectangle().Top+this.GetScrollRectangle().Top),this.FMx=i,this.FMy=s,this.FSavedPageSize=this.FPageSize,this.FTime=0,this.FTimer.SetEnabled(!0),this.MouseOnThumbButtons(i,s)?(this.FScrollBarMode=2,this.FMinThumb=pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMinThumbButton(),pas["WEBLib.TMSFNCTypes"].PointF(i,s)),this.FMaxThumb=pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMaxThumbButton(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))):this.MouseOnThumb(i,s)?this.FScrollBarMode=1:pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMinScrollButton(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))?this.FScrollButtonChange=1:pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMaxScrollButton(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))?this.FScrollButtonChange=2:pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetScrollAreaMin(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))?this.FScrollButtonChange=3:pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetScrollAreaMax(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))&&(this.FScrollButtonChange=4),pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMinThumbButton(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))&&3!==this.FDownButton?(this.FDownButton=3,this.Changed()):pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMaxThumbButton(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))&&4!==this.FDownButton?(this.FDownButton=4,this.Changed()):pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMinScrollButton(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))&&1!==this.FDownButton?(this.FDownButton=1,this.Changed()):pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMaxScrollButton(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))&&2!==this.FDownButton&&(this.FDownButton=2,this.Changed())},this.HandleMouseMove=function(t,e,i){var s=0,n=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),2===this.FScrollBarMode){var o=this.FKind;0===o?this.SetControlCursor(9):1===o&&this.SetControlCursor(7);var r=this.FKind;s=0===r?this.GetRange()/(this.GetScrollRectangle().Right-this.GetScrollRectangle().Left)*(e-this.FMx):1===r?this.GetRange()/(this.GetScrollRectangle().Bottom-this.GetScrollRectangle().Top)*(i-this.FMy):0,this.FMinThumb?this.FValue-this.FMin>0?this.SetPageSize(this.FSavedPageSize-s*(this.GetRange()/(this.FValue-this.FMin))):this.SetPageSize(this.FSavedPageSize-s):this.FMaxThumb&&(this.FValue-this.FMin<this.GetRange()?this.SetPageSize(this.FSavedPageSize+s*(this.GetRange()/(this.FMax-this.FValue))):this.SetPageSize(this.FSavedPageSize+s))}else if(1===this.FScrollBarMode){var a=this.FKind;s=0===a?e-this.FCx:1===a?i-this.FCy:0,n=this.GetValue$1(s),this.FTracking?this.SetValue(n):(this.FTempValue=n,this.Changed())}else if(this.MouseOnThumbButtons(e,i)){var l=this.FKind;0===l?this.SetControlCursor(9):1===l&&this.SetControlCursor(7)}else this.SetControlCursor(0);pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMinThumbButton(),pas["WEBLib.TMSFNCTypes"].PointF(e,i))&&3!==this.FHoveredButton?(this.FHoveredButton=3,this.Changed()):pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMaxThumbButton(),pas["WEBLib.TMSFNCTypes"].PointF(e,i))&&4!==this.FHoveredButton?(this.FHoveredButton=4,this.Changed()):pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMinScrollButton(),pas["WEBLib.TMSFNCTypes"].PointF(e,i))&&1!==this.FHoveredButton?(this.FHoveredButton=1,this.Changed()):pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMaxScrollButton(),pas["WEBLib.TMSFNCTypes"].PointF(e,i))&&2!==this.FHoveredButton?(this.FHoveredButton=2,this.Changed()):pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMaxThumbButton(),pas["WEBLib.TMSFNCTypes"].PointF(e,i))||pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMinThumbButton(),pas["WEBLib.TMSFNCTypes"].PointF(e,i))||pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMaxScrollButton(),pas["WEBLib.TMSFNCTypes"].PointF(e,i))||pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMinScrollButton(),pas["WEBLib.TMSFNCTypes"].PointF(e,i))||0===this.FHoveredButton||(this.FHoveredButton=0,this.Changed())},this.HandleMouseUp=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),this.ReleaseCaptureEx(),1!==this.FScrollBarMode||this.FTracking||this.SetValue(this.FTempValue),0===this.FScrollBarMode&&(pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMinScrollButton(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))?this.SetValue(this.FValue-this.FSmallChange):pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMaxScrollButton(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))?this.SetValue(this.FValue+this.FSmallChange):pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetScrollAreaMin(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))?this.SetValue(this.FValue-this.FLargeChange):pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetScrollAreaMax(),pas["WEBLib.TMSFNCTypes"].PointF(i,s))&&this.SetValue(this.FValue+this.FLargeChange)),this.FDownButton=0,this.FMinThumb=!1,this.FMaxThumb=!1,this.FTimer.SetEnabled(!1),this.FTime=0,this.FScrollBarMode=0,this.SetControlCursor(0),this.FScrollButtonChange=0,this.Changed()},this.HandleMouseLeave=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),this.FTimer.SetEnabled(!1),this.FTime=0,this.FScrollBarMode=0,this.FScrollButtonChange=0,this.FMinThumb=!1,this.FMaxThumb=!1,this.FDownButton=0,this.FHoveredButton=0,this.Changed()},this.HandleMouseEnter=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseEnter.call(this)},this.HandleMouseWheel=function(t,e,i){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseWheel.apply(this,arguments),e<0?this.SetValue(this.FValue+this.FLargeChange):this.SetValue(this.FValue-this.FLargeChange)},this.Changed=function(){this.Invalidate()},this.AppearanceChanged=function(t){this.Changed()},this.TimerChanged=function(t){this.FTime+=1,this.FTime>=4&&(1===this.FScrollButtonChange?(this.SetValue(this.FValue-this.FSmallChange),this.Changed()):2===this.FScrollButtonChange?(this.SetValue(this.FValue+this.FSmallChange),this.Changed()):3===this.FScrollButtonChange?(this.SetValue(this.FValue-this.FLargeChange),this.Changed()):4===this.FScrollButtonChange&&(this.SetValue(this.FValue+this.FLargeChange),this.Changed()))},this.GetMinScrollButton=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(this.GetLocalRect());var i=this.FKind;return 0===i?t.$assign(pas["WEBLib.TMSFNCTypes"].MakeRectF(e.Left,e.Top,this.FAppearance.FScrollButtonSize,e.Bottom-e.Top)):1===i&&t.$assign(pas["WEBLib.TMSFNCTypes"].MakeRectF(e.Left,e.Top,e.Right-e.Left,this.FAppearance.FScrollButtonSize)),t},this.GetMaxScrollButton=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(this.GetLocalRect());var i=this.FKind;return 0===i?t.$assign(pas["WEBLib.TMSFNCTypes"].MakeRectF(e.Right-this.FAppearance.FScrollButtonSize,e.Top,this.FAppearance.FScrollButtonSize,e.Bottom-e.Top)):1===i&&t.$assign(pas["WEBLib.TMSFNCTypes"].MakeRectF(e.Left,e.Bottom-this.FAppearance.FScrollButtonSize,e.Right-e.Left,this.FAppearance.FScrollButtonSize)),t},this.GetMinThumbButton=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(this.GetThumbRectangle());var i=this.FKind;return 0===i?t.$assign(pas["WEBLib.TMSFNCTypes"].MakeRectF(e.Left,e.Top,this.FAppearance.GetThumbButtonSize(),e.Bottom-e.Top)):1===i&&t.$assign(pas["WEBLib.TMSFNCTypes"].MakeRectF(e.Left,e.Top,e.Right-e.Left,this.FAppearance.GetThumbButtonSize())),t},this.GetMaxThumbButton=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(this.GetThumbRectangle());var i=this.FKind;return 0===i?t.$assign(pas["WEBLib.TMSFNCTypes"].MakeRectF(e.Left+(e.Right-e.Left)-this.FAppearance.GetThumbButtonSize(),e.Top,this.FAppearance.GetThumbButtonSize(),e.Bottom-e.Top)):1===i&&t.$assign(pas["WEBLib.TMSFNCTypes"].MakeRectF(e.Left,e.Top+(e.Bottom-e.Top)-this.FAppearance.GetThumbButtonSize(),e.Right-e.Left,this.FAppearance.GetThumbButtonSize())),t},this.GetScrollRectangle=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=this.FKind;return 0===e?(t.Left=this.GetMinScrollButton().Left+(this.GetMinScrollButton().Right-this.GetMinScrollButton().Left),t.Top=this.GetMinScrollButton().Top,t.Bottom=t.Top+(this.GetMinScrollButton().Bottom-this.GetMinScrollButton().Top),t.Right=t.Left+this.GetMaxScrollButton().Left-(this.GetMinScrollButton().Right-this.GetMinScrollButton().Left)):1===e&&(t.Left=this.GetMinScrollButton().Left,t.Top=this.GetMinScrollButton().Top+(this.GetMinScrollButton().Bottom-this.GetMinScrollButton().Top),t.Bottom=t.Top+this.GetMaxScrollButton().Top-(this.GetMinScrollButton().Bottom-this.GetMinScrollButton().Top),t.Right=t.Left+(this.GetMinScrollButton().Right-this.GetMinScrollButton().Left)),t},this.GetScrollAreaMin=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(this.GetScrollRectangle()),i.$assign(this.GetThumbRectangle());var s=this.FKind;return 0===s?(t.Left=e.Left,t.Top=e.Top,t.Right=t.Left+(i.Left-e.Left),t.Bottom=t.Top+(e.Bottom-e.Top)):1===s&&(t.Left=e.Left,t.Top=e.Top,t.Right=t.Left+(e.Right-e.Left),t.Bottom=t.Top+(i.Top-e.Top)),t},this.GetScrollAreaMax=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(this.GetScrollRectangle()),i.$assign(this.GetThumbRectangle());var s=this.FKind;return 0===s?(t.Left=i.Left+(i.Right-i.Left),t.Top=e.Top,t.Right=t.Left+(e.Right-e.Left)-(i.Right-i.Left)-i.Left+e.Left,t.Bottom=t.Top+(e.Bottom-e.Top)):1===s&&(t.Left=e.Left,t.Top=i.Top+(i.Bottom-i.Top),t.Right=t.Left+(e.Right-e.Left),t.Bottom=t.Top+(e.Bottom-e.Top)-(i.Bottom-i.Top)-i.Top+e.Top),t},this.GetThumbRectangle=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=0;e.$assign(this.GetScrollRectangle());var s=this.FKind;return 0===s?(i=(e.Right-e.Left)/this.GetRange()*this.FPageSize,t.Left=e.Left+this.GetValue(),t.Top=e.Top,t.Right=t.Left+Math.max(2*this.FAppearance.GetThumbButtonSize()+this.ScalePaintValue(10),i),t.Bottom=t.Top+(e.Bottom-e.Top)):1===s&&(i=(e.Bottom-e.Top)/this.GetRange()*this.FPageSize,t.Left=e.Left,t.Top=e.Top+this.GetValue(),t.Right=t.Left+(e.Right-e.Left),t.Bottom=t.Top+Math.max(2*this.FAppearance.GetThumbButtonSize()+this.ScalePaintValue(10),i)),t},this.GetValue=function(){var t=0,e=0,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();t=0,i.$assign(this.GetScrollRectangle());var s=this.FKind;return(e=0===s?i.Right-i.Left-Math.max(2*this.FAppearance.GetThumbButtonSize()+10,(i.Right-i.Left)/this.GetRange()*this.FPageSize):1===s?i.Bottom-i.Top-Math.max(2*this.FAppearance.GetThumbButtonSize()+10,(i.Bottom-i.Top)/this.GetRange()*this.FPageSize):0)<=0?t:t=this.FMax-this.FMin>0?this.FTracking?Math.min((this.FValue-this.FMin)/(this.FMax-this.FMin)*e,e):Math.min((this.FTempValue-this.FMin)/(this.FMax-this.FMin)*e,e):this.FMin},this.GetValue$1=function(t){var e=0,i=0,s=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();n.$assign(this.GetScrollRectangle());var o=this.FKind;return s=0===o?n.Right-n.Left-Math.max(2*this.FAppearance.GetThumbButtonSize()+10,(n.Right-n.Left)/this.GetRange()*this.FPageSize):1===o?n.Bottom-n.Top-Math.max(2*this.FAppearance.GetThumbButtonSize()+10,(n.Bottom-n.Top)/this.GetRange()*this.FPageSize):0,this.FMax-this.FMin>0&&s>0?(i=t/s*(this.FMax-this.FMin)+this.FMin,e=Math.max(Math.min(i,this.FMax),this.FMin)):e=0,e},this.GetRange=function(){return Math.max(2,this.FMax-this.FMin)},this.MouseOnThumbButtons=function(t,e){return(pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMinThumbButton(),pas["WEBLib.TMSFNCTypes"].PointF(t,e))||pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetMaxThumbButton(),pas["WEBLib.TMSFNCTypes"].PointF(t,e)))&&!this.FAppearance.FFixedThumb},this.MouseOnThumb=function(t,e){return pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetThumbRectangle(),pas["WEBLib.TMSFNCTypes"].PointF(t,e))},this.DrawScrollButtons=function(t){var e=null,i=null,s=null,n=null;this.FAppearance.FScrollButtonSize<=0||(e=this.FAppearance.FScrollButtonLeftFill,i=this.FAppearance.FScrollButtonRightFill,s=this.FAppearance.FScrollButtonLeftStroke,n=this.FAppearance.FScrollButtonRightStroke,1===this.FDownButton?(e=this.FAppearance.FScrollButtonLeftDownFill,s=this.FAppearance.FScrollButtonLeftDownStroke):1===this.FHoveredButton&&(e=this.FAppearance.FScrollButtonLeftHoverFill,s=this.FAppearance.FScrollButtonLeftHoverStroke),t.FFill.Assign(e),t.FStroke.Assign(s),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetMinScrollButton()),2),2===this.FDownButton?(i=this.FAppearance.FScrollButtonRightDownFill,n=this.FAppearance.FScrollButtonRightDownStroke):2===this.FHoveredButton&&(i=this.FAppearance.FScrollButtonRightHoverFill,n=this.FAppearance.FScrollButtonRightHoverStroke),t.FFill.Assign(i),t.FStroke.Assign(n),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetMaxScrollButton()),2),this.DrawArrow(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetMinScrollButton()),!0),this.DrawArrow(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetMaxScrollButton()),!1))},this.DrawThumb=function(t){t.FFill.Assign(this.FAppearance.FThumbFill),t.FStroke.Assign(this.FAppearance.FThumbStroke),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetThumbRectangle()),2),this.FAppearance.FFixedThumb||this.DrawThumbButtons(t)},this.DrawThumbButtons=function(t){var e=null,i=null,s=null,n=null;this.FAppearance.FThumbButtonSize<=0||(e=this.FAppearance.FThumbButtonLeftFill,i=this.FAppearance.FThumbButtonRightFill,s=this.FAppearance.FThumbButtonLeftStroke,n=this.FAppearance.FThumbButtonRightStroke,3===this.FDownButton?(e=this.FAppearance.FThumbButtonLeftDownFill,s=this.FAppearance.FThumbButtonLeftDownStroke):3===this.FHoveredButton&&(e=this.FAppearance.FThumbButtonLeftHoverFill,s=this.FAppearance.FThumbButtonLeftHoverStroke),t.FFill.Assign(e),t.FStroke.Assign(s),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetMinThumbButton()),2),4===this.FDownButton?(i=this.FAppearance.FThumbButtonRightDownFill,n=this.FAppearance.FThumbButtonRightDownStroke):4===this.FHoveredButton&&(i=this.FAppearance.FThumbButtonRightHoverFill,n=this.FAppearance.FThumbButtonRightHoverStroke),t.FFill.Assign(i),t.FStroke.Assign(n),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetMaxThumbButton()),2),this.DrawArrow(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetMinThumbButton()),!0),this.DrawArrow(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetMaxThumbButton()),!1))},this.DrawArrow=function(t,e,i){t.FStroke.SetColor(this.FAppearance.FArrowColor),1===this.FKind?(pas["WEBLib.TMSFNCTypes"].InflateRectEx(e,0,-4),i?(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/2,e.Top+(e.Bottom-e.Top)/3)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3,e.Top+(e.Bottom-e.Top)/3*2)),2,2),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/2,e.Top+(e.Bottom-e.Top)/3)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3*2,e.Top+(e.Bottom-e.Top)/3*2)),2,2)):(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/2,e.Top+(e.Bottom-e.Top)/3*2)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3,e.Top+(e.Bottom-e.Top)/3)),2,2),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/2,e.Top+(e.Bottom-e.Top)/3*2)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3*2,e.Top+(e.Bottom-e.Top)/3)),2,2))):(pas["WEBLib.TMSFNCTypes"].InflateRectEx(e,-4,0),i?(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3*2,e.Top+(e.Bottom-e.Top)/3)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3,e.Top+(e.Bottom-e.Top)/2)),2,2),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3*2,e.Top+(e.Bottom-e.Top)/3*2)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3,e.Top+(e.Bottom-e.Top)/2)),2,2)):(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3,e.Top+(e.Bottom-e.Top)/3)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3*2,e.Top+(e.Bottom-e.Top)/2)),2,2),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3,e.Top+(e.Bottom-e.Top)/3*2)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/3*2,e.Top+(e.Bottom-e.Top)/2)),2,2)))},this.Draw=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),this.DrawThumb(t),this.DrawScrollButtons(t)},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FTracking=!0,this.FDesignTime=this.IsDesignTime(),this.FDesignTime&&(this.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(225,225,225),40)),this.FStroke.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Darker(11119017,40))),this.SetHeight(121),this.SetWidth(18),this.FKind=1,this.FValue=0,this.FMin=0,this.FMax=100,this.FSmallChange=1,this.FLargeChange=20,this.FAppearance=t.TTMSFNCScrollBarAppearance.$create("Create$1",[this]),this.FAppearance.FOnChange=rtl.createCallback(this,"AppearanceChanged"),this.FPageSize=20,this.FTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[null]),this.FTimer.FOnTimer=rtl.createCallback(this,"TimerChanged"),this.FTimer.SetInterval(100),this},this.Destroy=function(){rtl.free(this,"FAppearance"),rtl.free(this,"FTimer"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCScrollBar.isPrototypeOf(e)&&(this.FKind=rtl.as(e,t.TTMSFNCScrollBar).FKind,this.FValue=rtl.as(e,t.TTMSFNCScrollBar).FValue,this.FMin=rtl.as(e,t.TTMSFNCScrollBar).FMin,this.FMax=rtl.as(e,t.TTMSFNCScrollBar).FMax,this.FPageSize=rtl.as(e,t.TTMSFNCScrollBar).FPageSize,this.FSmallChange=rtl.as(e,t.TTMSFNCScrollBar).FSmallChange,this.FLargeChange=rtl.as(e,t.TTMSFNCScrollBar).FLargeChange,this.FAppearance.Assign(rtl.as(e,t.TTMSFNCScrollBar).FAppearance),this.FTracking=rtl.as(e,t.TTMSFNCScrollBar).FTracking,this.Changed())},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCScrollBar",this.TTMSFNCCustomScrollBar,(function(){this.RegisterRuntimeClasses=function(){pas.Classes.RegisterClass(t.TTMSFNCScrollBar)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("Appearance",2,t.$rtti.TTMSFNCScrollBarAppearance,"FAppearance","SetAppearance"),e.addProperty("Kind",2,t.$rtti.TTMSFNCScrollBarKind,"FKind","SetKind",{Default:t.TTMSFNCScrollBarKind.sbkVertical}),e.addProperty("LargeChange",12,rtl.double,"FLargeChange","FLargeChange",{stored:"IsLargeChangeStored"}),e.addProperty("Max",14,rtl.double,"FMax","SetMax",{stored:"IsMaxStored"}),e.addProperty("Tracking",2,rtl.boolean,"FTracking","SetTracking",{Default:!0}),e.addProperty("Min",14,rtl.double,"FMin","SetMin",{stored:"IsMinStored"}),e.addProperty("PageSize",14,rtl.double,"FPageSize","SetPageSize",{stored:"IsPageSizeStored"}),e.addProperty("Value",14,rtl.double,"FValue","SetValue",{stored:"IsValueStored"}),e.addProperty("SmallChange",12,rtl.double,"FSmallChange","FSmallChange",{stored:"IsSmallChangeStored"}),e.addProperty("OnValueChanged",0,t.$rtti.TTMSFNCScrollBarValueChanged,"FOnValueChange","FOnValueChange"),e.addProperty("OnPageSizeChanged",0,t.$rtti.TTMSFNCScrollBarPageSizeChanged,"FOnPageSizeChanged","FOnPageSizeChanged"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["Math","WEBLib.TMSFNCStyles","WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCTreeViewBase",["System","Classes","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCScrollBar","WEBLib.StdCtrls","WEBLib.Controls","WEBLib.TMSFNCTypes"],(function(){"use strict";var t=this;this.SWIPECOUNT=300,rtl.createClass(this,"TTMSFNCTreeViewDoubleListItem",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FOwner=null,this.FValue=0,this.FCellVal=0},this.$final=function(){this.FOwner=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetCellData=function(t){this.FValue=t},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FOwner=rtl.as(this.FCollection,t.TTMSFNCTreeViewDoubleList).FOwner$1),this};var e=this.$rtti;e.addProperty("Value",2,rtl.double,"FValue","SetCellData"),e.addProperty("CellVal",0,rtl.longint,"FCellVal","FCellVal")})),rtl.createClass(this,"TTMSFNCTreeViewDoubleList",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FOwner$1=null},this.$final=function(){this.FOwner$1=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.IndexOf=function(t){var e=0,i=0;e=-1;for(var s=0,n=this.GetCount()-1;s<=n;s++)if(i=s,this.GetItem$1(i).FCellVal===t)return e=i;return e},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TTMSFNCTreeViewDoubleListItem),this.FOwner$1=e,this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)}})),this.TTMSFNCTreeViewScrollMode={0:"smPixelScrolling",smPixelScrolling:0,1:"smNodeScrolling",smNodeScrolling:1},this.TTMSFNCTreeViewScrollUpdate={0:"suContinuous",suContinuous:0,1:"suOnce",suOnce:1},rtl.createClass(this,"TTMSFNCTreeViewBase",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FSaveHScrollPos=0,this.FSaveVScrollPos=0,this.FTotalRowHeight=0,this.FNodeListBuild=!1,this.FTotalColumnWidth=0,this.FStartOffset=0,this.FStartCol=0,this.FStopCol=0,this.FStartRow=0,this.FStopRow=0,this.FStartX=0,this.FStopX=0,this.FStartY=0,this.FStopY=0,this.FBlockScrollingUpdate=!1,this.FUpdateCount$1=0,this.FVerticalScrollBar=null,this.FHorizontalScrollBar=null,this.FCustomVerticalScrollBar=null,this.FCustomHorizontalScrollBar=null,this.FRowCount=0,this.FColumnCount=0,this.FColumnW=null,this.FColumnP=null,this.FDefaultRowHeight=0,this.FDefaultColumnWidth=0,this.FVerticalScrollBarVisible=!1,this.FHorizontalScrollBarVisible=!1,this.FScrollMode=0,this.FIsMouseDown=!1,this.FDelayedLoading=!1,this.FStretchScrollBars=!1,this.FBlockUpdateNodeList=!1,this.FBlockUpdateNode=!1,this.FBlockRemoveNode=0,this.FBlockUserInput=!1,this.FBlockMouseClick=!1,this.FCustomScrollBars=!1,this.FScrollUpdate=0},this.$final=function(){this.FVerticalScrollBar=void 0,this.FHorizontalScrollBar=void 0,this.FCustomVerticalScrollBar=void 0,this.FCustomHorizontalScrollBar=void 0,this.FColumnW=void 0,this.FColumnP=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetColumnCount=function(t){this.FColumnCount!==t&&(this.FColumnCount=t)},this.SetRowCount=function(t){this.FRowCount!==t&&(this.FRowCount=t)},this.SetDefaultRowHeight=function(t){this.FDefaultRowHeight!==t&&(this.FDefaultRowHeight=t)},this.SetHorizontalScrollBarVisible=function(t){this.FHorizontalScrollBarVisible!==t&&(this.FHorizontalScrollBarVisible=t,this.UpdateTreeViewCache())},this.SetVerticalScrollBarVisible=function(t){this.FVerticalScrollBarVisible!==t&&(this.FVerticalScrollBarVisible=t,this.UpdateTreeViewCache())},this.SetColWidths=function(t,e){var i,s=null;(i=this.FColumnW.IndexOf(t))>=0&&i<=this.FColumnW.GetCount()-1?e===this.FDefaultColumnWidth?this.FColumnW.Delete(i):(this.FColumnW.GetItem$1(i).SetCellData(Math.max(0,e)),this.FColumnW.GetItem$1(i).FCellVal=t):e!==this.FDefaultColumnWidth&&((s=this.FColumnW.Add$1()).SetCellData(Math.max(0,e)),s.FCellVal=t)},this.GetColWidths=function(t){var e;return-1!==(e=this.FColumnW.IndexOf(t))?this.FColumnW.GetItem$1(e).FValue:this.FDefaultColumnWidth},this.GetColPos=function(t){var e;return-1!==(e=this.FColumnP.IndexOf(t))?this.FColumnP.GetItem$1(e).FValue:-1},this.SetColPos=function(t,e){var i,s=null;(i=this.FColumnP.IndexOf(t))>=0&&i<=this.FColumnP.GetCount()-1?-1===e?this.FColumnP.Delete(i):(this.FColumnP.GetItem$1(i).SetCellData(Math.max(0,e)),this.FColumnP.GetItem$1(i).FCellVal=t):-1!==e&&((s=this.FColumnP.Add$1()).SetCellData(Math.max(0,e)),s.FCellVal=t)},this.SetStretchScrollBars=function(t){this.FStretchScrollBars!==t&&(this.FStretchScrollBars=t,this.UpdateTreeViewDisplay())},this.UpdateTreeView=function(){this.SaveScrollPosition(),this.UpdateNodesCache(!0,!0),this.RestoreScrollPosition(),this.UpdateGroupsCache(),this.UpdateColumnsCache()},this.UpdateVisualRange=function(){var t,e,i,s,n,o=0,r=0,a=0,l=0,h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=0;s=this.GetHorizontalScrollPosition(),i=this.GetVerticalScrollPosition(),h.$assign(this.GetContentRect()),a=-s,l=-i,t=h.Right-h.Left,e=h.Bottom-h.Top,(n=this.GetVScrollValue()>this.VerticalScrollBar().FMax/2)&&(l+=this.GetTotalRowHeight()),this.FStartCol=-1,this.FStartRow=-1,this.FStopCol=-1,this.FStopRow=-1,this.FStartX=h.Left,this.FStopX=h.Left,this.FStartY=h.Top,this.FStopY=h.Top,this.FStartOffset=0;for(var p=0,c=this.FColumnCount-1;p<=c&&(o=p,(a+=this.GetColWidths(o))>0&&-1===this.FStartCol&&(this.FStartCol=o,this.FStartX=this.FStartX+pas.System.Int(a-this.GetColWidths(o))),a>=t&&-1===this.FStopCol&&(this.FStopCol=o,this.FStopX=this.FStopX+pas.System.Int(a)),!(this.FStartCol>-1&&this.FStopCol>-1));p++);if(n)for(var u=this.FRowCount-1;u>=0&&(r=u,(l-=F=this.GetRowHeight(r))<=0&&-1===this.FStartRow&&(this.FStartRow=r,this.FStartOffset=l,this.FStartY=this.FStartY+pas.System.Int(this.FStartOffset-F)),l<e&&-1===this.FStopRow&&(this.FStopRow=r,this.FStopY=this.FStopY+pas.System.Int(l)),!(this.FStartRow>-1&&this.FStopRow>-1));u--);else for(var T=0,C=this.FRowCount-1;T<=C&&(r=T,(l+=F=this.GetRowHeight(r))>0&&-1===this.FStartRow&&(this.FStartRow=r,this.FStartOffset=l-F,this.FStartY=this.FStartY+pas.System.Int(this.FStartOffset)),l>=e&&-1===this.FStopRow&&(this.FStopRow=r,this.FStopY=this.FStopY+pas.System.Int(l)),!(this.FStartRow>-1&&this.FStopRow>-1));T++);this.FStartRow>-1&&-1===this.FStopRow&&(this.FStopRow=this.FRowCount-1),this.FStartCol>-1&&-1===this.FStopCol&&(this.FStopCol=this.FColumnCount-1)},this.StretchColumn=function(t,e,i){var s,n=0,o=0,r=0,a=0,l=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(s=this.HorizontalScrollBar(),null!=this.VerticalScrollBar()&&null!=s){-1===i?(l.$assign(this.GetContentRect()),r=l.Right-l.Left):r=i,a=0;for(var h=0,F=this.FColumnCount-1;h<=F;h++)n=h,this.IsColumnVisible(n)&&(a+=1);if(-1===e&&(e=this.FColumnCount-1),0!==a&&(!(e>=this.FColumnCount)||t||this.IsLoading()))if(1!==this.FColumnCount)if(o=0,t){if(a>0){o=r/a;for(var p=0,c=this.FColumnCount-1;p<=c;p++)n=p,this.IsColumnVisible(n)&&this.SetColWidths(n,o)}}else{for(var u=0,T=this.FColumnCount-1;u<=T;u++)(n=u)!==e&&this.IsColumnVisible(n)&&(o+=this.GetColWidths(n));this.SetColWidths(e,r-o)}else this.SetColWidths(0,r)}},this.Scroll=function(t,e){this.FBlockScrollingUpdate=!0,this.SetHScrollValue(t),this.SetVScrollValue(e),this.FBlockScrollingUpdate=!1,this.UpdateDisplay()},this.UpdateDisplay=function(){},this.VScrollChanged=function(t){this.FBlockScrollingUpdate||(this.FIsMouseDown||this.StopAnimationTimer(),this.VerticalScrollPositionChanged())},this.HScrollChanged=function(t){this.FBlockScrollingUpdate||(this.FIsMouseDown||this.StopAnimationTimer(),this.HorizontalScrollPositionChanged())},this.HCustomScrollChanged=function(t,e){!this.FBlockScrollingUpdate&&this.FCustomScrollBars&&(this.FIsMouseDown||this.StopAnimationTimer(),this.HorizontalScrollPositionChanged(),this.SetHScrollValue(this.GetHScrollValue()))},this.VCustomScrollChanged=function(t,e){!this.FBlockScrollingUpdate&&this.FCustomScrollBars&&(this.FIsMouseDown||this.StopAnimationTimer(),this.VerticalScrollPositionChanged(),this.SetVScrollValue(this.GetVScrollValue()))},this.UpdateScrollBars=function(t,e){var i=null,s=null,n=null,o=null,r=0,a=0,l=0,h=0,F=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),p=null,c=null;this.FUpdateCount$1>0||3 in this.FComponentState||(this.FBlockScrollingUpdate=!0,e&&(this.UpdateAutoSizing(),this.UpdateColumnRowCalculations(!0)),i=this.VerticalScrollBar(),s=this.HorizontalScrollBar(),n=this.CustomVerticalScrollBar(),o=this.CustomHorizontalScrollBar(),null!=i&&null!=s&&null!=n&&null!=o&&(t?F.$assign(this.GetCalculationRect()):F.$assign(this.GetContentRect()),l=F.Right-F.Left,h=F.Bottom-F.Top,r=this.GetTotalColumnWidth(),a=this.GetTotalRowHeight(),s.SetVisible(r>0&&1===pas["WEBLib.TMSFNCTypes"].CompareValueEx(r,l,0)&&this.FHorizontalScrollBarVisible&&!this.ColumnStretchingActive()&&!this.FCustomScrollBars),i.SetVisible(a>0&&1===pas["WEBLib.TMSFNCTypes"].CompareValueEx(a,h,0)&&this.FVerticalScrollBarVisible&&!this.FCustomScrollBars),o.SetVisible(r>0&&1===pas["WEBLib.TMSFNCTypes"].CompareValueEx(r,l,0)&&this.FHorizontalScrollBarVisible&&!this.ColumnStretchingActive()&&this.FCustomScrollBars),n.SetVisible(a>0&&1===pas["WEBLib.TMSFNCTypes"].CompareValueEx(a,h,0)&&this.FVerticalScrollBarVisible&&this.FCustomScrollBars),n.FVisible&&this.FCustomScrollBars?n.SetParent(this):n.SetParent(null),o.FVisible&&this.FCustomScrollBars?o.SetParent(this):o.SetParent(null),i.FVisible&&!this.FCustomScrollBars?i.SetParent(this):i.SetParent(null),s.FVisible&&!this.FCustomScrollBars?s.SetParent(this):s.SetParent(null),p=pas["WEBLib.TMSFNCTypes"].TTMSFNCMargins.$create("Create$1"),c=pas["WEBLib.TMSFNCTypes"].TTMSFNCMargins.$create("Create$1"),this.FCustomScrollBars?n.FVisible&&this.FStretchScrollBars?c.SetRight(n.GetWidth()+1):c.SetRight(1):i.FVisible&&this.FStretchScrollBars?c.SetRight(i.GetWidth()+1):c.SetRight(1),p.SetTop(1),p.SetRight(1),c.SetBottom(1),c.SetLeft(1),this.FCustomScrollBars?o.FVisible?p.SetBottom(o.GetHeight()+1):p.SetBottom(1):s.FVisible?p.SetBottom(s.GetHeight()+1):p.SetBottom(1),this.FStretchScrollBars||(F.$assign(this.GetCalculationRect()),c.SetLeft(c.FLeft+F.Left),c.SetRight(c.FRight+(this.GetWidth()-F.Right)),p.SetTop(p.FTop+F.Top),p.SetBottom(p.FBottom+(this.GetHeight()-F.Bottom))),s.SetLeft(Math.round(c.FLeft)),s.SetTop(Math.round(this.GetHeight()-c.FBottom-s.GetHeight())),i.SetLeft(Math.round(this.GetWidth()-p.FRight-i.GetWidth())),i.SetTop(Math.round(p.FTop)),s.SetWidth(Math.round(Math.max(0,this.GetWidth()-c.FRight-c.FLeft))),i.SetHeight(Math.round(Math.max(0,this.GetHeight()-p.FBottom-p.FTop))),i.SetHeight(Math.round(Math.max(0,this.GetHeight()-p.FBottom-p.FTop))),o.SetLeft(Math.round(c.FLeft)),o.SetTop(Math.round(this.GetHeight()-c.FBottom-o.GetHeight())),n.SetLeft(Math.round(this.GetWidth()-p.FRight-n.GetWidth())),n.SetTop(Math.round(p.FTop)),o.SetWidth(Math.round(Math.max(0,this.GetWidth()-c.FRight-c.FLeft))),n.SetHeight(Math.round(Math.max(0,this.GetHeight()-p.FBottom-p.FTop))),c=rtl.freeLoc(c),p=rtl.freeLoc(p),F.$assign(this.GetContentRect()),l=F.Right-F.Left,h=F.Bottom-F.Top,1===this.FScrollMode?(i.SetPageSize(Math.round(Math.max(0,this.GetRowViewPortSize()))),i.SetMax(Math.max(i.GetPageSize(),this.FRowCount))):(i.SetPageSize(Math.round(Math.max(0,Math.min(a,h)))),i.SetMax(Math.round(Math.max(i.GetPageSize(),a))),i.FSmallChange=Math.round(this.FDefaultRowHeight),i.FLargeChange=Math.max(1,i.GetPageSize()),i.SetPosition(Math.min(i.GetPosition(),i.FMax))),1===this.FScrollMode?(s.SetPageSize(Math.round(Math.max(0,this.GetColumnViewPortSize()))),s.SetMax(Math.max(s.GetPageSize(),this.FColumnCount))):(s.SetPageSize(Math.round(Math.max(0,Math.min(r,l)))),s.SetMax(Math.round(Math.max(s.GetPageSize(),r))),s.SetPosition(Math.min(s.GetPosition(),s.FMax))),1===this.FScrollMode?(n.SetPageSize(this.GetRowViewPortSize()),n.SetMax(this.FRowCount-n.FPageSize)):(n.SetPageSize(Math.min(a,h)),n.SetMax(a-n.FPageSize),n.FSmallChange=Math.round(this.FDefaultRowHeight),n.SetValue(Math.min(n.FValue,n.FMax))),1===this.FScrollMode?(o.SetPageSize(this.GetColumnViewPortSize()),o.SetMax(this.FColumnCount-o.FPageSize)):(o.SetPageSize(Math.min(r,l)),o.SetMax(r-o.FPageSize),o.SetValue(Math.min(o.FValue,o.FMax)))),this.FBlockScrollingUpdate=!1,t&&this.UpdateScrollBars(!1,!1))},this.UpdateTreeViewCache=function(){this.FUpdateCount$1>0||this.FBlockUpdateNode||3 in this.FComponentState||0 in this.FComponentState||(this.ResetNodes(!0),this.UpdateCalculations(),this.UpdateColumns(),this.UpdateScrollBars(!0,!0),this.UpdateNodesCache(!0,!0),this.UpdateGroupsCache(),this.UpdateColumnsCache())},this.UpdateTreeViewDisplay=function(){this.UpdateScrollBars(!0,!0),this.UpdateDisplay()},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.UpdateTreeViewCache()},this.SetHScrollValue=function(t){this.FCustomScrollBars?this.CustomHorizontalScrollBar().SetValue(t):this.HorizontalScrollBar().SetPosition(Math.round(Math.min(this.HorizontalScrollBar().FMax-this.HorizontalScrollBar().GetPageSize(),Math.max(0,t))))},this.SetVScrollValue=function(t){this.FCustomScrollBars?this.CustomVerticalScrollBar().SetValue(t):this.VerticalScrollBar().SetPosition(Math.round(Math.min(this.VerticalScrollBar().FMax-this.VerticalScrollBar().GetPageSize(),Math.max(0,t))))},this.UpdateControlAfterResize=function(){this.FUpdateCount$1>0||3 in this.FComponentState||0 in this.FComponentState||(this.ResetNodes(!0),this.SaveScrollPosition(),this.UpdateNodesCache(!0,!0),this.UpdateGroupsCache(),this.UpdateColumnsCache(),this.RestoreScrollPosition())},this.CanScrollDown=function(){return this.GetVerticalScrollPosition()<this.GetTotalRowHeight()-this.GetVViewPortSize()},this.CanScrollUp=function(){return this.GetVerticalScrollPosition()>0},this.ScrollLimitation=function(){return!1,!1},this.IsColumnVisible=function(t){return!0,!0},this.GetRowHeight=function(t){return 0,0},this.GetCalculationRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(this.GetLocalRect()),t},this.GetContentRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.GetContentRect.call(this)),this.FCustomScrollBars?(this.CustomHorizontalScrollBar().FVisible&&(t.Bottom=t.Bottom-this.CustomHorizontalScrollBar().GetHeight()-1),this.CustomVerticalScrollBar().FVisible&&(t.Right=t.Right-this.CustomVerticalScrollBar().GetWidth()-1)):(this.HorizontalScrollBar().FVisible&&(t.Bottom=t.Bottom-this.HorizontalScrollBar().GetHeight()-1),this.VerticalScrollBar().FVisible&&(t.Right=t.Right-this.VerticalScrollBar().GetWidth()-1)),t},this.GetContentClipRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(this.GetContentRect()),t},this.GetHScrollValue=function(){return this.FCustomScrollBars?this.CustomHorizontalScrollBar().FValue:Math.round(Math.min(this.HorizontalScrollBar().FMax-this.HorizontalScrollBar().GetPageSize(),Math.max(0,this.HorizontalScrollBar().GetPosition())))},this.GetVScrollValue=function(){return this.FCustomScrollBars?this.CustomVerticalScrollBar().FValue:Math.round(Math.min(this.VerticalScrollBar().FMax-this.VerticalScrollBar().GetPageSize(),Math.max(0,this.VerticalScrollBar().GetPosition())))},this.GetVViewPortSize=function(){return this.FCustomScrollBars?this.CustomVerticalScrollBar().FPageSize:this.VerticalScrollBar().GetPageSize()},this.GetHViewPortSize=function(){return this.FCustomScrollBars?this.CustomHorizontalScrollBar().FPageSize:this.HorizontalScrollBar().GetPageSize()},this.GetColumnViewPortSize=function(){var t,e=0,i=0,s=0,n=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();o.$assign(this.GetContentRect()),t=o.Right-o.Left,e=0,n=0,s=0;for(var r=this.FColumnCount-1;r>=0;r--){if(i=r,(n+=this.GetColWidths(i))>t){e=Math.max(1,s);break}s+=1}return e},this.GetRowViewPortSize=function(){var t,e=0,i=0,s=0,n=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();o.$assign(this.GetContentRect()),t=o.Bottom-o.Top,e=0,n=0,s=0;for(var r=this.FRowCount-1;r>=0;r--){if(i=r,(n+=this.GetRowHeight(i))>t){e=Math.max(1,s);break}s+=1}return e},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FDelayedLoading=!1,this.FStretchScrollBars=!0,this.FScrollUpdate=0,this.FCustomVerticalScrollBar=pas["WEBLib.TMSFNCScrollBar"].TTMSFNCScrollBar.$create("Create$1",[this]),this.FCustomVerticalScrollBar.SetParent(this),this.FCustomHorizontalScrollBar=pas["WEBLib.TMSFNCScrollBar"].TTMSFNCScrollBar.$create("Create$1",[this]),this.FCustomHorizontalScrollBar.SetParent(this),this.FVerticalScrollBar=pas["WEBLib.StdCtrls"].TScrollBar.$create("Create$1",[this]),this.FVerticalScrollBar.SetParent(this),this.FHorizontalScrollBar=pas["WEBLib.StdCtrls"].TScrollBar.$create("Create$1",[this]),this.FHorizontalScrollBar.SetParent(this),this.FCustomVerticalScrollBar.FAppearance.SetThumbButtonSize(0),this.FCustomHorizontalScrollBar.FAppearance.SetThumbButtonSize(0),this.FCustomHorizontalScrollBar.SetKind(0),this.FVerticalScrollBar.FDoubleBuffered=!1,this.FHorizontalScrollBar.FDoubleBuffered=!1,this.FVerticalScrollBar.SetKind(1),this.FVerticalScrollBar.SetVisible(!0),this.FHorizontalScrollBar.SetVisible(!0),this.FCustomVerticalScrollBar.SetVisible(!1),this.FCustomHorizontalScrollBar.SetVisible(!1),this.FVerticalScrollBar.FOnChange=rtl.createCallback(this,"VScrollChanged"),this.FHorizontalScrollBar.FOnChange=rtl.createCallback(this,"HScrollChanged"),this.FCustomHorizontalScrollBar.FOnValueChange=rtl.createCallback(this,"HCustomScrollChanged"),this.FCustomVerticalScrollBar.FOnValueChange=rtl.createCallback(this,"VCustomScrollChanged"),this.FVerticalScrollBarVisible=!0,this.FHorizontalScrollBarVisible=!0,this.FScrollMode=0,this.FColumnW=t.TTMSFNCTreeViewDoubleList.$create("Create$3",[this]),this.FColumnP=t.TTMSFNCTreeViewDoubleList.$create("Create$3",[this]),this.FDefaultRowHeight=25,this.FDefaultColumnWidth=75,this.FColumnCount=0,this.FRowCount=0,this.FVerticalScrollBarVisible=!0,this.FHorizontalScrollBarVisible=!0,this},this.Destroy=function(){rtl.free(this,"FColumnP"),rtl.free(this,"FColumnW"),rtl.free(this,"FCustomVerticalScrollBar"),rtl.free(this,"FCustomHorizontalScrollBar"),rtl.free(this,"FVerticalScrollBar"),rtl.free(this,"FHorizontalScrollBar"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Assign=function(e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments),t.TTMSFNCTreeViewBase.isPrototypeOf(e)&&(this.FScrollMode=rtl.as(e,t.TTMSFNCTreeViewBase).FScrollMode,this.FStretchScrollBars=rtl.as(e,t.TTMSFNCTreeViewBase).FStretchScrollBars)},this.Resize=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Resize.call(this),this.UpdateControlAfterResize()},this.BeginUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.BeginUpdate.call(this),this.FUpdateCount$1+=1},this.EndUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.EndUpdate.call(this),this.FUpdateCount$1-=1,0===this.FUpdateCount$1&&this.UpdateTreeViewCache()},this.SaveScrollPosition=function(){this.FSaveHScrollPos=this.GetHScrollValue(),this.FSaveVScrollPos=this.GetVScrollValue()},this.RestoreScrollPosition=function(){this.Scroll(this.FSaveHScrollPos,this.FSaveVScrollPos)},this.AutoSizeColumn=function(t){this.AutoSizeColumnInternal(t,!0,!0)},this.GetVerticalScrollPosition=function(){var t;return t=this.GetVScrollValue(),this.FScrollMode,t},this.GetHorizontalScrollPosition=function(){var t=0;return t=this.GetHScrollValue(),1===this.FScrollMode&&(t=this.GetColPos(Math.round(t))),t},this.HorizontalScrollBar=function(){return this.FHorizontalScrollBar},this.VerticalScrollBar=function(){return this.FVerticalScrollBar},this.CustomHorizontalScrollBar=function(){return this.FCustomHorizontalScrollBar},this.CustomVerticalScrollBar=function(){return this.FCustomVerticalScrollBar},this.StartRow=function(){return this.FStartRow},this.StartOffset=function(){return this.FStartOffset},this.StopRow=function(){return this.FStopRow},this.GetColumnWidth=function(t){return this.GetColWidths(t)},this.GetColumnPosition=function(t){return this.GetColPos(t)},this.GetTotalColumnNodeWidth=function(){return this.FTotalColumnWidth},this.GetTotalColumnWidth=function(){return this.FTotalColumnWidth},this.GetTotalRowHeight=function(){return this.FTotalRowHeight},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)}))}),["Math","WEBLib.TMSFNCUtils","SysUtils","WEBLib.Forms"]),rtl.module("WEBLib.TMSFNCTreeViewData",["System","Classes","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCTreeViewBase","contnrs"],(function(){"use strict";var t=this;this.MAXLEVELDEPTH=100,this.MAXNODECOUNT=2e6,this.$rtti.$Class("TTMSFNCTreeViewColumn"),this.$rtti.$Class("TTMSFNCTreeViewNode"),this.TTMSFNCTreeViewNodeScrollPosition={0:"tvnspTop",tvnspTop:0,1:"tvnspBottom",tvnspBottom:1,2:"tvnspMiddle",tvnspMiddle:2},rtl.recNewT(this,"TTMSFNCTreeViewVirtualNodeRemoveData",(function(){this.RowIndex=0,this.Count=0,this.ParentNode=0,this.$eq=function(t){return this.RowIndex===t.RowIndex&&this.Count===t.Count&&this.ParentNode===t.ParentNode},this.$assign=function(t){return this.RowIndex=t.RowIndex,this.Count=t.Count,this.ParentNode=t.ParentNode,this}})),rtl.createClass(this,"TTMSFNCTreeViewVirtualNode",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FTreeView=null,this.FLevel=0,this.FAddedToVisibleList=!1,this.FChildren=0,this.FParentNode=0,this.FExpanded=!1,this.FTotalChildren=0,this.FIndex=0,this.FRow=0,this.FHeight=0,this.FCalculated=!1,this.FCache=null,this.FTextRects=[],this.FBitmapRects=[],this.FExpandRects=[],this.FCheckRects=[],this.FCheckStates=[],this.FNode=null,this.FExtended=!1,this.FExtraRects=[],this.FTitleRects=[],this.FTitleHeight=0,this.FTitleExtraRects=[]},this.$final=function(){this.FTreeView=void 0,this.FCache=void 0,this.FTextRects=void 0,this.FBitmapRects=void 0,this.FExpandRects=void 0,this.FCheckRects=void 0,this.FCheckStates=void 0,this.FNode=void 0,this.FExtraRects=void 0,this.FTitleRects=void 0,this.FTitleExtraRects=void 0,pas.System.TObject.$final.call(this)},this.GetText=function(t){var e="";return e="",null!=this.FTreeView&&(e=this.FTreeView.GetVirtualNodeText(this,t)),e},this.GetTitle=function(t){var e="";return e="",null!=this.FTreeView&&(e=this.FTreeView.GetVirtualNodeTitle(this,t)),e},this.GetTitleExpanded=function(t){var e=!1;return e=!0,null!=this.FTreeView&&(e=this.FTreeView.GetVirtualNodeTitleExpanded(this,t)),e},this.GetParent=function(){var t=null;return t=null,null!=this.FTreeView&&(t=this.FTreeView.GetParentVirtualNode(this)),t},this.GetNext=function(){var t=null;return t=null,null!=this.FTreeView&&(t=this.FTreeView.GetNextVirtualNode(this)),t},this.GetNextSibling=function(){var t=null;return t=null,null!=this.FTreeView&&(t=this.FTreeView.GetNextSiblingVirtualNode(this)),t},this.Expand=function(t){null!=this.FTreeView&&this.FTreeView.ExpandVirtualNode(this,t)},this.CopyFrom=function(e){null!=e&&(this.FChildren=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FChildren,this.FTotalChildren=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FTotalChildren,this.FExpanded=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FExpanded,this.FExtended=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FExtended,this.FLevel=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FLevel,this.FRow=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FRow,this.FCalculated=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FCalculated,this.FHeight=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FHeight,this.FParentNode=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FParentNode,this.FIndex=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FIndex,this.FTextRects=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FTextRects,this.FExtraRects=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FExtraRects,this.FBitmapRects=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FBitmapRects,this.FCheckRects=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FCheckRects,this.FExpandRects=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FExpandRects,this.FCheckStates=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FCheckStates,this.FNode=rtl.as(e,t.TTMSFNCTreeViewVirtualNode).FNode)},this.Create$1=function(t){return this.FTreeView=t,this},this.Destroy=function(){this.FCache=null,this.FNode=null,pas.System.TObject.Destroy.call(this)}})),this.TTMSFNCTreeViewCacheItemKind={0:"ikNode",ikNode:0,1:"ikColumnTop",ikColumnTop:1,2:"ikColumnBottom",ikColumnBottom:2,3:"ikGroupTop",ikGroupTop:3,4:"ikGroupBottom",ikGroupBottom:4},this.$rtti.$Enum("TTMSFNCTreeViewCacheItemKind",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TTMSFNCTreeViewCacheItemKind}),rtl.createClass(this,"TTMSFNCTreeViewCacheItem",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),this.FDrawRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),this.FKind=0,this.FGroup=0,this.FColumn=0,this.FNode=null,this.FStartColumn=0,this.FEndColumn=0},this.$final=function(){this.FRect=void 0,this.FDrawRect=void 0,this.FNode=void 0,pas.System.TObject.$final.call(this)},this.CreateNode=function(e,i){var s=null;return(s=t.TTMSFNCTreeViewCacheItem.$create("Create")).FKind=0,s.FRect.$assign(e),s.FNode=i,s},this.CreateColumnTop=function(e,i){var s=null;return(s=t.TTMSFNCTreeViewCacheItem.$create("Create")).FKind=1,s.FColumn=i,s.FRect.$assign(e),s},this.CreateGroupTop=function(e,i,s,n){var o=null;return(o=t.TTMSFNCTreeViewCacheItem.$create("Create")).FKind=3,o.FGroup=i,o.FStartColumn=s,o.FEndColumn=n,o.FRect.$assign(e),o},this.CreateColumnBottom=function(e,i){var s=null;return(s=t.TTMSFNCTreeViewCacheItem.$create("Create")).FKind=2,s.FColumn=i,s.FRect.$assign(e),s},this.CreateGroupBottom=function(e,i,s,n){var o=null;return(o=t.TTMSFNCTreeViewCacheItem.$create("Create")).FKind=4,o.FGroup=i,o.FStartColumn=s,o.FEndColumn=n,o.FRect.$assign(e),o},this.Destroy=function(){this.FNode=null,pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TTMSFNCTreeViewIntegerList",pas.Classes.TList,(function(){})),this.TTMSFNCTreeViewColumnEditorType={0:"tcetEdit",tcetEdit:0,1:"tcetComboBox",tcetComboBox:1,2:"tcetMemo",tcetMemo:2,3:"tcetNone",tcetNone:3},this.$rtti.$Enum("TTMSFNCTreeViewColumnEditorType",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCTreeViewColumnEditorType}),this.TTMSFNCTreeViewNodesSortMode={0:"nsmAscending",nsmAscending:0,1:"nsmDescending",nsmDescending:1},this.$rtti.$Enum("TTMSFNCTreeViewNodesSortMode",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTreeViewNodesSortMode}),this.TTMSFNCTreeViewNodesSortKind={0:"nskNone",nskNone:0,1:"nskAscending",nskAscending:1,2:"nskDescending",nskDescending:2},this.$rtti.$Enum("TTMSFNCTreeViewNodesSortKind",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTreeViewNodesSortKind}),this.TTMSFNCTreeViewColumnSorting={0:"tcsNone",tcsNone:0,1:"tcsNormal",tcsNormal:1,2:"tcsRecursive",tcsRecursive:2,3:"tcsNormalCaseSensitive",tcsNormalCaseSensitive:3,4:"tcsRecursiveCaseSensitive",tcsRecursiveCaseSensitive:4},this.$rtti.$Enum("TTMSFNCTreeViewColumnSorting",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TTMSFNCTreeViewColumnSorting}),rtl.createClass(this,"TTMSFNCTreeViewColumnFiltering",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FColumn=null,this.FEnabled=!1,this.FMultiColumn=!1,this.FDropDownHeight=0,this.FDropDownWidth=0,this.FButtonSize=0},this.$final=function(){this.FColumn=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t,null!=this.FColumn&&this.FColumn.UpdateColumn())},this.IsButtonSizeStored=function(){return 15!==this.FButtonSize},this.SetButtonSize=function(t){this.FButtonSize!==t&&(this.FButtonSize=t,null!=this.FColumn&&this.FColumn.UpdateColumn())},this.Create$1=function(t){return this.FColumn=t,this.FEnabled=!1,this.FDropDownWidth=100,this.FDropDownHeight=120,this.FMultiColumn=!1,this.FButtonSize=15,this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCTreeViewColumnFiltering.isPrototypeOf(e)&&(this.FEnabled=rtl.as(e,t.TTMSFNCTreeViewColumnFiltering).FEnabled,this.FDropDownWidth=rtl.as(e,t.TTMSFNCTreeViewColumnFiltering).FDropDownWidth,this.FDropDownHeight=rtl.as(e,t.TTMSFNCTreeViewColumnFiltering).FDropDownHeight,this.FMultiColumn=rtl.as(e,t.TTMSFNCTreeViewColumnFiltering).FMultiColumn,this.FButtonSize=rtl.as(e,t.TTMSFNCTreeViewColumnFiltering).FButtonSize)};var e=this.$rtti;e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!1}),e.addProperty("DropDownWidth",0,rtl.longint,"FDropDownWidth","FDropDownWidth",{Default:100}),e.addProperty("DropDownHeight",0,rtl.longint,"FDropDownHeight","FDropDownHeight",{Default:120}),e.addProperty("MultiColumn",0,rtl.boolean,"FMultiColumn","FMultiColumn",{Default:!1}),e.addProperty("ButtonSize",14,rtl.double,"FButtonSize","SetButtonSize",{stored:"IsButtonSizeStored"})})),this.TTMSFNCTreeViewFilterOperation={0:"tfoSHORT",tfoSHORT:0,1:"tfoNONE",tfoNONE:1,2:"tfoAND",tfoAND:2,3:"tfoXOR",tfoXOR:3,4:"tfoOR",tfoOR:4},this.$rtti.$Enum("TTMSFNCTreeViewFilterOperation",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TTMSFNCTreeViewFilterOperation}),rtl.createClass(this,"TTMSFNCTreeViewFilterData",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FColumn=0,this.FCondition="",this.FCaseSensitive=!1,this.FSuffix="",this.FPrefix="",this.FOperation=0},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FCaseSensitive=!0,this},this.Assign=function(e){var i;null!=(i=rtl.as(e,t.TTMSFNCTreeViewFilterData))&&(this.FColumn=i.FColumn,this.FCondition=i.FCondition,this.FCaseSensitive=i.FCaseSensitive,this.FPrefix=i.FPrefix,this.FSuffix=i.FSuffix,this.FOperation=i.FOperation)};var e=this.$rtti;e.addProperty("Column",0,rtl.smallint,"FColumn","FColumn"),e.addProperty("Condition",0,rtl.string,"FCondition","FCondition"),e.addProperty("CaseSensitive",0,rtl.boolean,"FCaseSensitive","FCaseSensitive",{Default:!0}),e.addProperty("Prefix",0,rtl.string,"FPrefix","FPrefix"),e.addProperty("Suffix",0,rtl.string,"FSuffix","FSuffix"),e.addProperty("Operation",0,t.$rtti.TTMSFNCTreeViewFilterOperation,"FOperation","FOperation")})),rtl.createClass(this,"TTMSFNCTreeViewFilter",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FOwner$1=null},this.$final=function(){this.FOwner$1=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return pas.Classes.TCollection.GetItem.call(this,t)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TTMSFNCTreeViewFilterData),this.FOwner$1=e,this},this.Add$1=function(){var t=null;return t=pas.Classes.TCollection.Add.call(this),1===this.GetCount()?t.FOperation=1:t.FOperation=2,t}})),rtl.createClass(this,"TTMSFNCTreeViewColumn",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FSortKind=0,this.FTag=0,this.FTreeView=null,this.FText="",this.FName="",this.FWordWrapping=!1,this.FVerticalTextAlign=0,this.FTrimming=0,this.FHorizontalTextAlign=0,this.FWidth=0,this.FVisible=!1,this.FUseDefaultAppearance=!1,this.FBottomFill=null,this.FBottomStroke=null,this.FTopFill=null,this.FTopStroke=null,this.FTopFont=null,this.FBottomFont=null,this.FFont=null,this.FFill=null,this.FStroke=null,this.FEditorType=0,this.FDisabledFontColor=0,this.FSelectedFontColor=0,this.FEditorItems=null,this.FCustomEditor=!1,this.FSorting=0,this.FSortIndex=0,this.FFiltering=null,this.FTitleTrimming=0,this.FTitleHorizontalTextAlign=0,this.FTitleWordWrapping=!1,this.FTitleVerticalTextAlign=0,this.FDisabledTitleFontColor=0,this.FSelectedTitleFontColor=0,this.FTitleFont=null,this.FExpanded=!1,this.FExpandable=!1,this.FExpandingButtonSize=0,this.FHTMLTemplate=""},this.$final=function(){this.FTreeView=void 0,this.FBottomFill=void 0,this.FBottomStroke=void 0,this.FTopFill=void 0,this.FTopStroke=void 0,this.FTopFont=void 0,this.FBottomFont=void 0,this.FFont=void 0,this.FFill=void 0,this.FStroke=void 0,this.FEditorItems=void 0,this.FFiltering=void 0,this.FTitleFont=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.UpdateColumn())},this.SetName=function(t){this.FName!==t&&(this.FName=t)},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t,this.UpdateColumn())},this.SetTrimming=function(t){this.FTrimming!==t&&(this.FTrimming=t,this.UpdateColumn())},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,this.UpdateColumn())},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,this.UpdateColumn())},this.SetWidth=function(t){this.FWidth!==t&&(this.FWidth=t,this.UpdateColumn())},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,this.UpdateColumn())},this.SetUseDefaultAppearance=function(t){this.FUseDefaultAppearance!==t&&(this.FUseDefaultAppearance=t,this.UpdateColumn())},this.SetBottomFill=function(t){this.FBottomFill!==t&&this.FBottomFill.Assign(t)},this.SetBottomStroke=function(t){this.FBottomStroke!==t&&this.FBottomStroke.Assign(t)},this.SetTopFill=function(t){this.FTopFill!==t&&this.FTopFill.Assign(t)},this.SetTopStroke=function(t){this.FTopStroke!==t&&this.FTopStroke.Assign(t)},this.SetBottomFont=function(t){this.FBottomFont!==t&&this.FBottomFont.Assign(t)},this.SetTopFont=function(t){this.FTopFont!==t&&this.FTopFont.Assign(t)},this.SetFill=function(t){this.FFill!==t&&this.FFill.Assign(t)},this.SetFont=function(t){this.FFont!==t&&this.FFont.Assign(t)},this.SetStroke=function(t){this.FStroke!==t&&this.FStroke.Assign(t)},this.SetEditorType=function(t){this.FEditorType!==t&&(this.FEditorType=t)},this.SetDisabledFontColor=function(t){this.FDisabledFontColor!==t&&(this.FDisabledFontColor=t,this.Changed$1(this))},this.SetSelectedFontColor=function(t){this.FSelectedFontColor!==t&&(this.FSelectedFontColor=t,this.Changed$1(this))},this.SetEditorItems=function(t){this.FEditorItems.Assign(t)},this.SetSorting=function(t){this.FSorting!==t&&(this.FSorting=t,this.Changed$1(this))},this.SetSortKind=function(t){this.FSortKind!==t&&(this.FSortKind=t,this.Changed$1(this))},this.SetFiltering=function(t){this.FFiltering!==t&&this.FFiltering.Assign(t)},this.SetHTMLTemplate=function(t){this.FHTMLTemplate!==t&&(this.FHTMLTemplate=t,null!=this.FTreeView&&this.FTreeView.UpdateTreeView())},this.UpdateColumn=function(){var t=null;null!=(t=this.TreeView())&&(t.UpdateColumns(),t.UpdateTreeViewCache())},this.Changed$1=function(t){this.UpdateColumn()},this.TreeView=function(){return this.FTreeView},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FTreeView=rtl.as(this.FCollection,t.TTMSFNCTreeViewColumns).TreeView()),this.FSorting=0,this.FExpandingButtonSize=15,this.FExpanded=!0,this.FSortIndex=-1,this.FSortKind=0,this.FFiltering=t.TTMSFNCTreeViewColumnFiltering.$create("Create$1",[this]),this.FEditorType=3,this.FWordWrapping=!1,this.FTrimming=0,this.FCustomEditor=!1,this.FHorizontalTextAlign=1,this.FVerticalTextAlign=0,this.FTitleWordWrapping=!1,this.FTitleTrimming=0,this.FTitleHorizontalTextAlign=1,this.FTitleVerticalTextAlign=0,this.FEditorItems=pas.Classes.TStringList.$create("Create$1"),null!=this.FCollection&&(this.FText=t.TranslateTextEx(rtl.getResStr(t,"sTMSFNCTreeViewColumn"))+" "+pas.SysUtils.IntToStr(this.FCollection.GetCount()-1)),this.FName=pas.SysUtils.StringReplace(this.FText," ","",rtl.createSet(0)),this.FWidth=100,this.FVisible=!0,this.FUseDefaultAppearance=!0,this.FBottomFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[0,16777215,8421504,-1,-1]),this.FBottomStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FTopFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[0,16777215,8421504,-1,-1]),this.FTopStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,-1,8421504,-1,-1]),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FSelectedFontColor=16777215,this.FDisabledFontColor=12632256,this.FSelectedTitleFontColor=16777215,this.FDisabledTitleFontColor=12632256,this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FTitleFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FTopFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FBottomFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FBottomFill.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FTopFill.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FBottomStroke.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FTopStroke.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FStroke.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FFill.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FFont.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FTitleFont.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FTopFont.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FBottomFont.FOnChanged=rtl.createCallback(this,"Changed$1"),this.UpdateColumn(),this},this.Destroy=function(){rtl.free(this,"FFiltering"),rtl.free(this,"FEditorItems"),rtl.free(this,"FTopFill"),rtl.free(this,"FTopStroke"),rtl.free(this,"FTopFont"),rtl.free(this,"FBottomFill"),rtl.free(this,"FBottomStroke"),rtl.free(this,"FBottomFont"),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FFont"),rtl.free(this,"FTitleFont"),pas.Classes.TCollectionItem.Destroy.call(this),this.UpdateColumn()},this.Assign=function(e){t.TTMSFNCTreeViewColumn.isPrototypeOf(e)&&(this.FTag=rtl.as(e,t.TTMSFNCTreeViewColumn).FTag,this.FText=rtl.as(e,t.TTMSFNCTreeViewColumn).FText,this.FName=rtl.as(e,t.TTMSFNCTreeViewColumn).FName,this.FTrimming=rtl.as(e,t.TTMSFNCTreeViewColumn).FTrimming,this.FWordWrapping=rtl.as(e,t.TTMSFNCTreeViewColumn).FWordWrapping,this.FHorizontalTextAlign=rtl.as(e,t.TTMSFNCTreeViewColumn).FHorizontalTextAlign,this.FVerticalTextAlign=rtl.as(e,t.TTMSFNCTreeViewColumn).FVerticalTextAlign,this.FTitleTrimming=rtl.as(e,t.TTMSFNCTreeViewColumn).FTitleTrimming,this.FTitleWordWrapping=rtl.as(e,t.TTMSFNCTreeViewColumn).FTitleWordWrapping,this.FTitleHorizontalTextAlign=rtl.as(e,t.TTMSFNCTreeViewColumn).FTitleHorizontalTextAlign,this.FTitleVerticalTextAlign=rtl.as(e,t.TTMSFNCTreeViewColumn).FTitleVerticalTextAlign,this.FWidth=rtl.as(e,t.TTMSFNCTreeViewColumn).FWidth,this.FVisible=rtl.as(e,t.TTMSFNCTreeViewColumn).FVisible,this.FUseDefaultAppearance=rtl.as(e,t.TTMSFNCTreeViewColumn).FUseDefaultAppearance,this.FFill.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FFill),this.FDisabledFontColor=rtl.as(e,t.TTMSFNCTreeViewColumn).FDisabledFontColor,this.FSelectedFontColor=rtl.as(e,t.TTMSFNCTreeViewColumn).FSelectedFontColor,this.FDisabledTitleFontColor=rtl.as(e,t.TTMSFNCTreeViewColumn).FDisabledTitleFontColor,this.FSelectedTitleFontColor=rtl.as(e,t.TTMSFNCTreeViewColumn).FSelectedTitleFontColor,this.FTitleFont.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FTitleFont),this.FFont.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FFont),this.FStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FStroke),this.FBottomFill.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FBottomFill),this.FBottomFont.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FBottomFont),this.FBottomStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FBottomStroke),this.FTopFill.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FTopFill),this.FTopStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FTopStroke),this.FTopFont.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FTopFont),this.FEditorType=rtl.as(e,t.TTMSFNCTreeViewColumn).FEditorType,this.FEditorItems.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FEditorItems),this.FCustomEditor=rtl.as(e,t.TTMSFNCTreeViewColumn).FCustomEditor,this.FSorting=rtl.as(e,t.TTMSFNCTreeViewColumn).FSorting,this.FFiltering.Assign(rtl.as(e,t.TTMSFNCTreeViewColumn).FFiltering),this.FExpandingButtonSize=rtl.as(e,t.TTMSFNCTreeViewColumn).FExpandingButtonSize,this.FHTMLTemplate=rtl.as(e,t.TTMSFNCTreeViewColumn).FHTMLTemplate)},this.UpdateWidth=function(t){this.FWidth=t},this.Sort=function(t,e,i){var s=null;null!=(s=this.TreeView())&&s.FNodes.Sort$1(this.GetIndex(),t,e,i,!0)};var e=this.$rtti;e.addProperty("EditorType",2,t.$rtti.TTMSFNCTreeViewColumnEditorType,"FEditorType","SetEditorType",{Default:t.TTMSFNCTreeViewColumnEditorType.tcetNone}),e.addProperty("EditorItems",2,pas.Classes.$rtti.TStringList,"FEditorItems","SetEditorItems"),e.addProperty("CustomEditor",0,rtl.boolean,"FCustomEditor","FCustomEditor",{Default:!1}),e.addProperty("Name",2,rtl.string,"FName","SetName"),e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag",{Default:0}),e.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaLeading}),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!1}),e.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttNone}),e.addProperty("Width",2,rtl.double,"FWidth","SetWidth"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("UseDefaultAppearance",2,rtl.boolean,"FUseDefaultAppearance","SetUseDefaultAppearance",{Default:!0}),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("SelectedFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FSelectedFontColor","SetSelectedFontColor",{Default:16777215}),e.addProperty("DisabledFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDisabledFontColor","SetDisabledFontColor",{Default:12632256}),e.addProperty("TopFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FTopFill","SetTopFill"),e.addProperty("TopStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FTopStroke","SetTopStroke"),e.addProperty("TopFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FTopFont","SetTopFont"),e.addProperty("BottomFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FBottomFill","SetBottomFill"),e.addProperty("BottomStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FBottomStroke","SetBottomStroke"),e.addProperty("BottomFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FBottomFont","SetBottomFont"),e.addProperty("Sorting",2,t.$rtti.TTMSFNCTreeViewColumnSorting,"FSorting","SetSorting",{Default:t.TTMSFNCTreeViewColumnSorting.tcsNone}),e.addProperty("Filtering",2,t.$rtti.TTMSFNCTreeViewColumnFiltering,"FFiltering","SetFiltering"),e.addProperty("HTMLTemplate",2,rtl.string,"FHTMLTemplate","SetHTMLTemplate")})),rtl.createClass(this,"TTMSFNCTreeViewColumns",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FTreeView=null},this.$final=function(){this.FTreeView=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.GetItemClass=function(){return t.TTMSFNCTreeViewColumn},this.TreeView=function(){return this.FTreeView},this.Create$3=function(t){return pas.Classes.TOwnedCollection.Create$2.call(this,t,this.GetItemClass()),this.FTreeView=t,this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)}})),this.$rtti.$Class("TTMSFNCTreeViewNodes"),this.TTMSFNCTreeViewNodeCheckType={0:"tvntNone",tvntNone:0,1:"tvntCheckBox",tvntCheckBox:1,2:"tvntRadioButton",tvntRadioButton:2},this.$rtti.$Enum("TTMSFNCTreeViewNodeCheckType",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTreeViewNodeCheckType}),rtl.createClass(this,"TTMSFNCTreeViewNodeValue",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FTag=0,this.FDataString="",this.FDataObject=null,this.FDataInteger=0,this.FTreeView=null,this.FNode=null,this.FText="",this.FDBKey="",this.FDataBoolean=!1,this.FCheckType=0,this.FChecked=!1,this.FCollapsedIcon=null,this.FCollapsedIconLarge=null,this.FExpandedIcon=null,this.FExpandedIconLarge=null,this.FCollapsedIconName="",this.FCollapsedIconLargeName="",this.FExpandedIconName="",this.FExpandedIconLargeName="",this.FDataPointer=null,this.FTitle="",this.FTitleExpanded=!1,this.FHTMLTemplateItems=null},this.$final=function(){this.FDataObject=void 0,this.FTreeView=void 0,this.FNode=void 0,this.FCollapsedIcon=void 0,this.FCollapsedIconLarge=void 0,this.FExpandedIcon=void 0,this.FExpandedIconLarge=void 0,this.FHTMLTemplateItems=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.UpdateNodeValue())},this.UpdateNodeValue=function(){var t,e=null;e=this.TreeView(),t=this.Node(),null!=e&&null!=t&&e.UpdateNode(t.FVirtualNode)},this.SetChecked=function(t){var e=[],i=0,s=!1,n=null,o=null;if(this.FChecked!==t){if(this.FChecked=t,n=this.TreeView(),o=this.Node(),null!=n&&null!=o&&null!=o.FVirtualNode){e=rtl.arraySetLength(e,!1,0);for(var r=0,a=n.FColumnCount-1;r<=a;r++)i=r,s=!1,this.TreeView().DoIsNodeChecked(this.Node().FVirtualNode,i,{get:function(){return s},set:function(t){s=t}}),(e=rtl.arraySetLength(e,!1,rtl.length(e)+1))[rtl.length(e)-1]=s;this.TreeView().UpdateNodeCheckStates(this.Node().FVirtualNode,rtl.arrayRef(e))}this.UpdateNodeValue()}},this.SetCheckType=function(t){this.FCheckType!==t&&(this.FCheckType=t,this.UpdateNodeValue())},this.SetCollapsedIconLarge=function(t){this.FCollapsedIconLarge!==t&&(this.FCollapsedIconLarge.Assign(t),this.UpdateNodeValue())},this.SetCollapsedIcon=function(t){this.FCollapsedIcon!==t&&(this.FCollapsedIcon.Assign(t),this.UpdateNodeValue())},this.SetExpandedIconLarge=function(t){this.FExpandedIconLarge!==t&&(this.FExpandedIconLarge.Assign(t),this.UpdateNodeValue())},this.SetExpandedIcon=function(t){this.FExpandedIcon!==t&&(this.FExpandedIcon.Assign(t),this.UpdateNodeValue())},this.SetCollapsedIconLargeName=function(t){this.FCollapsedIconLargeName!==t&&(this.FCollapsedIconLargeName=t,this.UpdateNodeValue())},this.SetCollapsedIconName=function(t){this.FCollapsedIconName!==t&&(this.FCollapsedIconName=t,this.UpdateNodeValue())},this.SetExpandedIconLargeName=function(t){this.FExpandedIconLargeName!==t&&(this.FExpandedIconLargeName=t,this.UpdateNodeValue())},this.SetExpandedIconName=function(t){this.FExpandedIconName!==t&&(this.FExpandedIconName=t,this.UpdateNodeValue())},this.SetHTMLTemplateItems=function(t){this.FHTMLTemplateItems!==t&&(this.FHTMLTemplateItems.Assign(t),this.UpdateNodeValue())},this.BitmapChanged=function(t){this.UpdateNodeValue()},this.TemplateItemsChanged=function(t){this.UpdateNodeValue()},this.TreeView=function(){return this.FTreeView},this.Node=function(){return this.FNode},this.GetText=function(){var t="",e="";return e=this.FText,null!=this.FTreeView&&(t=this.FTreeView.GetHTMLTemplate(this.GetIndex()),this.FTreeView.DoGetHTMLTemplate(this,this.GetIndex(),{get:function(){return t},set:function(e){t=e}}),""!==t&&(e=this.FTreeView.HTMLReplace(t,this))),e},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FTreeView=rtl.as(this.FCollection,t.TTMSFNCTreeViewNodeValues).TreeView(),this.FNode=rtl.as(this.FCollection,t.TTMSFNCTreeViewNodeValues).Node()),this.FChecked=!1,this.FTitleExpanded=!0,this.FCheckType=0,this.FCollapsedIcon=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FCollapsedIcon.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FExpandedIcon=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FExpandedIcon.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FCollapsedIconLarge=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FCollapsedIconLarge.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FExpandedIconLarge=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FExpandedIconLarge.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FHTMLTemplateItems=pas.Classes.TStringList.$create("Create$1"),this.FHTMLTemplateItems.FOnChange=rtl.createCallback(this,"TemplateItemsChanged"),this.UpdateNodeValue(),this},this.Destroy=function(){rtl.free(this,"FHTMLTemplateItems"),rtl.free(this,"FCollapsedIcon"),rtl.free(this,"FCollapsedIconLarge"),rtl.free(this,"FExpandedIcon"),rtl.free(this,"FExpandedIconLarge"),pas.Classes.TCollectionItem.Destroy.call(this),this.UpdateNodeValue()},this.Assign=function(e){t.TTMSFNCTreeViewNodeValue.isPrototypeOf(e)&&(this.FTag=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FTag,this.FText=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FText,this.FTitleExpanded=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FTitleExpanded,this.FTitle=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FTitle,this.FCheckType=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FCheckType,this.FChecked=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FChecked,this.FCollapsedIcon.Assign(rtl.as(e,t.TTMSFNCTreeViewNodeValue).FCollapsedIcon),this.FCollapsedIconLarge.Assign(rtl.as(e,t.TTMSFNCTreeViewNodeValue).FCollapsedIconLarge),this.FExpandedIcon.Assign(rtl.as(e,t.TTMSFNCTreeViewNodeValue).FExpandedIcon),this.FExpandedIconLarge.Assign(rtl.as(e,t.TTMSFNCTreeViewNodeValue).FExpandedIconLarge),this.FCollapsedIconName=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FCollapsedIconName,this.FCollapsedIconLargeName=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FCollapsedIconLargeName,this.FExpandedIconName=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FExpandedIconName,this.FExpandedIconLargeName=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FExpandedIconLargeName,this.FHTMLTemplateItems.Assign(rtl.as(e,t.TTMSFNCTreeViewNodeValue).FHTMLTemplateItems),this.AssignData(e))},this.AssignData=function(e){t.TTMSFNCTreeViewNodeValue.isPrototypeOf(e)&&(this.FDataString=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FDataString,this.FDataPointer=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FDataPointer,this.FDataBoolean=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FDataBoolean,this.FDataObject=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FDataObject,this.FDataInteger=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FDataInteger,this.FDBKey=rtl.as(e,t.TTMSFNCTreeViewNodeValue).FDBKey)};var e=this.$rtti;e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag",{Default:0}),e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("CollapsedIconName",2,rtl.string,"FCollapsedIconName","SetCollapsedIconName"),e.addProperty("CollapsedIconLargeName",2,rtl.string,"FCollapsedIconLargeName","SetCollapsedIconLargeName"),e.addProperty("ExpandedIconName",2,rtl.string,"FExpandedIconName","SetExpandedIconName"),e.addProperty("ExpandedIconLargeName",2,rtl.string,"FExpandedIconLargeName","SetExpandedIconLargeName"),e.addProperty("CollapsedIcon",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FCollapsedIcon","SetCollapsedIcon"),e.addProperty("CollapsedIconLarge",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FCollapsedIconLarge","SetCollapsedIconLarge"),e.addProperty("ExpandedIcon",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FExpandedIcon","SetExpandedIcon"),e.addProperty("ExpandedIconLarge",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FExpandedIconLarge","SetExpandedIconLarge"),e.addProperty("Checked",2,rtl.boolean,"FChecked","SetChecked",{Default:!1}),e.addProperty("CheckType",2,t.$rtti.TTMSFNCTreeViewNodeCheckType,"FCheckType","SetCheckType",{Default:t.TTMSFNCTreeViewNodeCheckType.tvntNone}),e.addProperty("HTMLTemplateItems",2,pas.Classes.$rtti.TStringList,"FHTMLTemplateItems","SetHTMLTemplateItems")})),rtl.createClass(this,"TTMSFNCTreeViewNodeValues",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FTreeView=null,this.FNode=null},this.$final=function(){this.FTreeView=void 0,this.FNode=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.GetItemClass=function(){return t.TTMSFNCTreeViewNodeValue},this.TreeView=function(){return this.FTreeView},this.Node=function(){return this.FNode},this.UpdateChecked=function(t,e){null!=this.FTreeView&&(this.FTreeView.FUpdateCount$1=this.FTreeView.FUpdateCount$1+1),this.GetItem$1(t).SetChecked(e),null!=this.FTreeView&&(this.FTreeView.FUpdateCount$1=this.FTreeView.FUpdateCount$1-1)},this.Create$3=function(t,e){return pas.Classes.TOwnedCollection.Create$2.call(this,t,this.GetItemClass()),this.FTreeView=t,this.FNode=e,this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)}})),rtl.createClass(this,"TTMSFNCTreeViewNode",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FTag=0,this.FDataString="",this.FDataObject=null,this.FDataInteger=0,this.FTreeView=null,this.FValues=null,this.FDBKey="",this.FDataBoolean=!1,this.FNodes=null,this.FVirtualNode=null,this.FExpanded=!1,this.FEnabled=!1,this.FExtended=!1,this.FDataPointer=null},this.$final=function(){this.FDataObject=void 0,this.FTreeView=void 0,this.FValues=void 0,this.FNodes=void 0,this.FVirtualNode=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetValues=function(t){this.FValues!==t&&(this.FValues.Assign(t),this.UpdateNode())},this.SetNodes=function(t){this.FNodes!==t&&(this.FNodes.Assign(t),this.UpdateNode())},this.SetExpanded=function(t){this.FExpanded!==t&&(this.FExpanded=t,null!=this.FTreeView&&this.FTreeView.ToggleNode(this))},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t,this.UpdateNode())},this.SetExtended=function(t){this.FExtended!==t&&(this.FExtended=t,this.UpdateNode())},this.GetChecked=function(t){var e,i=!1;return i=!1,null!=(e=this.GetValueForColumn(t))&&(i=e.FChecked),i},this.SetChecked=function(t,e){var i=null;null!=(i=this.GetValueForColumn(t))&&i.SetChecked(e)},this.GetCheckType=function(t){var e,i=0;return i=0,null!=(e=this.GetValueForColumn(t))&&(i=e.FCheckType),i},this.GetCollapsedIcon=function(t,e){var i,s=null;return s=null,null!=(i=this.GetValueForColumn(t))&&(s=e?i.FCollapsedIconLarge:i.FCollapsedIcon),s},this.GetCollapsedIconName=function(t,e){var i,s="";return s="",null!=(i=this.GetValueForColumn(t))&&(s=e?i.FCollapsedIconLargeName:i.FCollapsedIconName),s},this.GetExpandedIcon=function(t,e){var i,s=null;return s=null,null!=(i=this.GetValueForColumn(t))&&(s=e?i.FExpandedIconLarge:i.FExpandedIcon),s},this.GetExpandedIconName=function(t,e){var i,s="";return s="",null!=(i=this.GetValueForColumn(t))&&(s=e?i.FExpandedIconLargeName:i.FExpandedIconName),s},this.GetText=function(t){var e,i="";return i="",null!=(e=this.GetValueForColumn(t))&&(i=e.FText),i},this.SetCheckType=function(t,e){var i=null;null!=(i=this.GetValueForColumn(t))&&i.SetCheckType(e)},this.SetCollapsedIconName=function(t,e,i){var s=null;null!=(s=this.GetValueForColumn(t))&&(e?s.SetCollapsedIconLargeName(i):s.SetCollapsedIconName(i))},this.SetExpandedIconName=function(t,e,i){var s=null;null!=(s=this.GetValueForColumn(t))&&(e?s.SetExpandedIconLargeName(i):s.SetExpandedIconName(i))},this.SetText=function(t,e){var i=null;null!=(i=this.GetValueForColumn(t))&&i.SetText(e)},this.GetStrippedHTMLText=function(t){return pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(this.GetText(t))},this.UpdateNode=function(){var t=null;null!=(t=this.TreeView())&&(this.FTreeView.FNodeListBuild?t.UpdateNode(this.FVirtualNode):t.UpdateTreeViewCache())},this.GetValueForColumn=function(t){var e=null;if(e=null,t>=0&&t<=this.FValues.GetCount()-1)return e=this.FValues.GetItem$1(t);this.FTreeView.FBlockUpdateNode=!0;for(var i=0,s=t;i<=s;i++)i>this.FValues.GetCount()-1&&(e=this.FValues.Add$1());return this.FTreeView.FBlockUpdateNode=!1,e},this.CreateNodes=function(){return t.TTMSFNCTreeViewNodes.$create("Create$3",[this.FTreeView,this])},this.CreateNodeValues=function(){return t.TTMSFNCTreeViewNodeValues.$create("Create$3",[this.FTreeView,this])},this.SetIndex=function(t){var e=this;function i(t){for(var s=0,n=0,o=t.GetCount()-1;n<=o;n++)s=n,e.FTreeView.InsertItemInternal(t.GetItem$1(s)),i(t.GetItem$1(s).FNodes)}pas.Classes.TCollectionItem.SetIndex.apply(this,arguments),null!=this.FTreeView&&(this.FTreeView.FNodeListBuild?(this.FTreeView.RemoveItemInternal(e,!0),this.FTreeView.InsertItemInternal(e),i(this.FNodes)):this.FTreeView.UpdateTreeViewCache())},this.TreeView=function(){return this.FTreeView},this.GetParent=function(){var t=null;return t=null,null!=this.FTreeView&&(t=this.FTreeView.GetParentNode(this)),t};this.SaveToString=function(t){var e="",i=0;if(null==this.FTreeView)return e;e="";for(var s=0,n=this.FVirtualNode.FLevel-1;s<=n;s++)i=s,e+="\t";for(var o=0,r=this.FTreeView.FColumnCount-1;o<=r;o++)i=o,t?i===this.FTreeView.FColumnCount-1?e+=this.GetStrippedHTMLText(i):e=e+this.GetStrippedHTMLText(i)+"{1}":i===this.FTreeView.FColumnCount-1?e+=this.GetText(i):e=e+this.GetText(i)+"{1}";t||(e+="{0}");for(var a=0,l=this.FTreeView.FColumnCount-1;a<=l;a++)i=a,t||(e=(e=(e=(e=(e=(e=(e=(e=(e=e+pas.SysUtils.IntToStr(this.GetCheckType(i))+";")+pas.SysUtils.BoolToStr(this.GetChecked(i),!1)+";")+this.GetExpandedIconName(i,!1)+";")+this.GetExpandedIconName(i,!0)+";")+this.GetCollapsedIconName(i,!1)+";")+this.GetCollapsedIconName(i,!0)+";")+pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SaveBitmapToHexStr(this.GetExpandedIcon(i,!1))+";")+pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SaveBitmapToHexStr(this.GetExpandedIcon(i,!0))+";")+pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SaveBitmapToHexStr(this.GetCollapsedIcon(i,!1))+";",i===this.FValues.GetCount()-1?e+=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SaveBitmapToHexStr(this.GetCollapsedIcon(i,!0)):e=e+pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SaveBitmapToHexStr(this.GetCollapsedIcon(i,!0))+"|");return t||(e=(e+="{0}")+pas.SysUtils.BoolToStr(this.FExtended,!1)+"{0}",e+=pas.SysUtils.BoolToStr(this.FEnabled,!1)),e},this.LoadFromString=function(t){var e=0,i=0,s=null,n=null,o=null,r=0,a="",l=0,h="";s=pas.Classes.TStringList.$create("Create$1");try{for(a=t;""!==a;){if(0===(l=pas.System.Pos("{0}",a))){s.Add(a);break}h=pas.System.Copy(a,1,l-1),s.Add(h),pas.System.Delete({get:function(){return a},set:function(t){a=t}},1,l-1+"{0}".length)}for(var F=0,p=s.GetCount()-1;F<=p;F++)if(e=F,""!==s.Get(e))if(0===e){n=pas.Classes.TStringList.$create("Create$1");try{for(a=s.Get(e);""!==a;){if(0===(l=pas.System.Pos("{1}",a))){n.Add(a);break}h=pas.System.Copy(a,1,l-1),n.Add(h),pas.System.Delete({get:function(){return a},set:function(t){a=t}},1,l-1+"{0}".length)}for(var c=0,u=n.GetCount()-1;c<=u;c++)i=c,""!==n.Get(i)&&this.SetText(i,n.Get(i))}finally{n=rtl.freeLoc(n)}}else if(1===e){n=pas.Classes.TStringList.$create("Create$1");try{pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.Split("|",s.Get(e),n,!1);for(var T=0,C=n.GetCount()-1;T<=C;T++){i=T,o=pas.Classes.TStringList.$create("Create$1");try{pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.Split(";",n.Get(i),o,!1);for(var S=0,d=o.GetCount()-1;S<=d;S++)r=S,""!==o.Get(r)&&(0===r?this.SetCheckType(i,pas.SysUtils.StrToInt(o.Get(r))):1===r?this.SetChecked(i,pas.SysUtils.StrToBool(o.Get(r))):2===r?this.SetExpandedIconName(i,!1,o.Get(r)):3===r?this.SetExpandedIconName(i,!0,o.Get(r)):4===r?this.SetCollapsedIconName(i,!1,o.Get(r)):5===r?this.SetCollapsedIconName(i,!0,o.Get(r)):6!==r&&7!==r&&8!==r&&9!==r||(6===r?pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.LoadBitmapFromHexStr(o.Get(r),this.GetExpandedIcon(i,!1)):7===r?pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.LoadBitmapFromHexStr(o.Get(r),this.GetExpandedIcon(i,!0)):8===r?pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.LoadBitmapFromHexStr(o.Get(r),this.GetCollapsedIcon(i,!1)):pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.LoadBitmapFromHexStr(o.Get(r),this.GetCollapsedIcon(i,!0))))}finally{o=rtl.freeLoc(o)}}}finally{n=rtl.freeLoc(n)}}else 2===e?this.SetExtended(pas.SysUtils.StrToBool(s.Get(e))):3===e&&this.SetEnabled(pas.SysUtils.StrToBool(s.Get(e)))}finally{s=rtl.freeLoc(s)}},this.Expand=function(t){null!=this.FTreeView&&this.FTreeView.ExpandNode(this,t)},this.MoveTo=function(t,e){null!=this.FTreeView&&this.FTreeView.MoveNode(this,t,e)},this.CopyTo=function(t,e){null!=this.FTreeView&&this.FTreeView.CopyNode(this,t,e)},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FTreeView=rtl.as(this.FCollection,t.TTMSFNCTreeViewNodes).TreeView()),this.FValues=this.CreateNodeValues(),this.FExpanded=!1,this.FExtended=!1,this.FEnabled=!0,this.FNodes=this.CreateNodes(),null!=this.FTreeView&&(this.FTreeView.FNodeListBuild?this.FTreeView.InsertItemInternal(this):this.FTreeView.UpdateTreeViewCache()),this},this.Destroy=function(){var e=t.TTMSFNCTreeViewVirtualNodeRemoveData.$new();e.RowIndex=-1,e.Count=0,e.ParentNode=-1,null!=this.FTreeView&&(!this.FTreeView.FNodeListBuild||this.FTreeView.FBlockRemoveNode>0||e.$assign(this.FTreeView.RemoveItemInternal(this,!1))),this.FVirtualNode=null,null!=this.FTreeView&&(this.FTreeView.FBlockRemoveNode=this.FTreeView.FBlockRemoveNode+1),rtl.free(this,"FNodes"),null!=this.FTreeView&&(this.FTreeView.FBlockRemoveNode=this.FTreeView.FBlockRemoveNode-1),rtl.free(this,"FValues"),pas.Classes.TCollectionItem.Destroy.call(this),-1!==e.RowIndex&&this.FTreeView.UpdateNodesInternal(t.TTMSFNCTreeViewVirtualNodeRemoveData.$clone(e)),null!=this.FTreeView&&this.FTreeView.UpdateTreeViewCache()},this.Assign=function(e){t.TTMSFNCTreeViewNode.isPrototypeOf(e)&&(this.FTag=rtl.as(e,t.TTMSFNCTreeViewNode).FTag,this.FValues.Assign(rtl.as(e,t.TTMSFNCTreeViewNode).FValues),this.FExpanded=rtl.as(e,t.TTMSFNCTreeViewNode).FExpanded,this.FExtended=rtl.as(e,t.TTMSFNCTreeViewNode).FExtended,this.FEnabled=rtl.as(e,t.TTMSFNCTreeViewNode).FEnabled,this.FNodes.Assign(rtl.as(e,t.TTMSFNCTreeViewNode).FNodes),this.AssignData(e),null!=this.FTreeView&&(this.FExpanded?this.FTreeView.ExpandNode(this,!1):this.FTreeView.CollapseNode(this,!1)))},this.AssignData=function(e){t.TTMSFNCTreeViewNode.isPrototypeOf(e)&&(this.FDataString=rtl.as(e,t.TTMSFNCTreeViewNode).FDataString,this.FDataBoolean=rtl.as(e,t.TTMSFNCTreeViewNode).FDataBoolean,this.FDataObject=rtl.as(e,t.TTMSFNCTreeViewNode).FDataObject,this.FDataInteger=rtl.as(e,t.TTMSFNCTreeViewNode).FDataInteger,this.FDataPointer=rtl.as(e,t.TTMSFNCTreeViewNode).FDataPointer,this.FDBKey=rtl.as(e,t.TTMSFNCTreeViewNode).FDBKey)};var e=this.$rtti;e.addProperty("Values",2,t.$rtti.TTMSFNCTreeViewNodeValues,"FValues","SetValues"),e.addProperty("Expanded",2,rtl.boolean,"FExpanded","SetExpanded",{Default:!1}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Extended",2,rtl.boolean,"FExtended","SetExtended",{Default:!1}),e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag"),e.addProperty("Nodes",2,t.$rtti.TTMSFNCTreeViewNodes,"FNodes","SetNodes")})),rtl.createClass(this,"TTMSFNCTreeViewNodes",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FTreeView=null,this.FNode=null},this.$final=function(){this.FTreeView=void 0,this.FNode=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.GetItemClass=function(){return t.TTMSFNCTreeViewNode},this.Compare=function(t,e,i,s,n){var o=0,r=null;return o=0,null==(r=this.TreeView())||(o=s?pas.SysUtils.AnsiCompareStr(t.GetStrippedHTMLText(i),e.GetStrippedHTMLText(i)):pas.SysUtils.AnsiCompareStr(pas.SysUtils.UpperCase(t.GetStrippedHTMLText(i)),pas.SysUtils.UpperCase(e.GetStrippedHTMLText(i))),1===n&&(o*=-1),r.DoNodeCompare(t,e,i,{get:function(){return o},set:function(t){o=t}})),o},this.QuickSort=function(t,e,i,s,n){var o,r,a,l=0,h=0,F=0,p=null;p=this.FItems;do{l=t,h=e,F=t+e>>>1;do{for(;this.Compare(this.GetItem$1(l),this.GetItem$1(F),i,s,n)<0;)l+=1;for(;this.Compare(this.GetItem$1(h),this.GetItem$1(F),i,s,n)>0;)h-=1;l<=h&&(o=l,r=h,a=void 0,a=p.Get(o),p.Put(o,p.Get(r)),p.Put(r,a),F===l?F=h:F===h&&(F=l),l+=1,h-=1)}while(!(l>h));t<h&&this.QuickSort(t,h,i,s,n),t=l}while(!(l>=e))},this.TreeView=function(){return this.FTreeView},this.Node=function(){return this.FNode},this.Create$3=function(t,e){return pas.Classes.TOwnedCollection.Create$2.call(this,t,this.GetItemClass()),this.FTreeView=t,this.FNode=e,this},this.Destroy=function(){this.FNode=null,pas.Classes.TCollection.Destroy.call(this)},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)},this.Sort$1=function(t,e,i,s,n){var o=null,r=0;if(null!=(o=this.TreeView())){if(o.FSortMode=s,o.BeginUpdate(),n&&o.ClearNodeList(),this.BeginUpdate(),this.GetCount()>0&&(this.QuickSort(0,this.GetCount()-1,t,i,s),e))for(var a=0,l=this.GetCount()-1;a<=l;a++)r=a,this.GetItem$1(r).FNodes.Sort$1(t,e,i,s,n);this.EndUpdate(),o.EndUpdate()}}})),rtl.createClass(this,"TTMSFNCTreeViewGroup",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FTag=0,this.FTreeView=null,this.FText="",this.FStartColumn=0,this.FEndColumn=0,this.FName="",this.FBottomFill=null,this.FBottomStroke=null,this.FTopFill=null,this.FTopStroke=null,this.FTopFont=null,this.FBottomFont=null,this.FUseDefaultAppearance=!1},this.$final=function(){this.FTreeView=void 0,this.FBottomFill=void 0,this.FBottomStroke=void 0,this.FTopFill=void 0,this.FTopStroke=void 0,this.FTopFont=void 0,this.FBottomFont=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.UpdateGroup())},this.SetStartColumn=function(t){this.FStartColumn!==t&&(this.FStartColumn=t,this.UpdateGroup())},this.SetEndColumn=function(t){this.FEndColumn!==t&&(this.FEndColumn=t,this.UpdateGroup())},this.SetName=function(t){this.FName!==t&&(this.FName=t)},this.SetBottomFill=function(t){this.FBottomFill!==t&&this.FBottomFill.Assign(t)},this.SetBottomStroke=function(t){this.FBottomStroke!==t&&this.FBottomStroke.Assign(t)},this.SetTopFill=function(t){this.FTopFill!==t&&this.FTopFill.Assign(t)},this.SetTopStroke=function(t){this.FTopStroke!==t&&this.FTopStroke.Assign(t)},this.SetBottomFont=function(t){this.FBottomFont!==t&&this.FBottomFont.Assign(t)},this.SetTopFont=function(t){this.FTopFont!==t&&this.FTopFont.Assign(t)},this.SetUseDefaultAppearance=function(t){this.FUseDefaultAppearance!==t&&(this.FUseDefaultAppearance=t,this.Changed$1(this))},this.UpdateGroup=function(){var t=null;null!=(t=this.TreeView())&&(t.UpdateColumns(),t.UpdateTreeViewCache())},this.Changed$1=function(t){this.UpdateGroup()},this.TreeView=function(){return this.FTreeView},this.Create$1=function(e){var i=null;return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FTreeView=rtl.as(this.FCollection,t.TTMSFNCTreeViewGroups).TreeView(),this.FText=t.TranslateTextEx(rtl.getResStr(t,"sTMSFNCTreeViewGroup"))+" "+pas.SysUtils.IntToStr(this.FTreeView.FGroups.GetCount()-1),this.FTreeView.FGroups.GetCount()<2?(this.FStartColumn=0,this.FEndColumn=0):(i=this.FTreeView.FGroups.GetItem$1(this.FTreeView.FGroups.GetCount()-2),this.FStartColumn=i.FStartColumn+1,this.FEndColumn=this.FStartColumn)),this.FUseDefaultAppearance=!0,this.FBottomFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[0,16777215,8421504,-1,-1]),this.FBottomStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FTopFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[0,16777215,8421504,-1,-1]),this.FTopStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,8421504]),this.FTopFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FBottomFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FBottomFill.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FTopFill.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FBottomStroke.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FTopStroke.FOnChanged=rtl.createCallback(this,"Changed$1"),this.FTopFont.FOnChange=rtl.createCallback(this,"Changed$1"),this.FBottomFont.FOnChange=rtl.createCallback(this,"Changed$1"),this.UpdateGroup(),this},this.Destroy=function(){rtl.free(this,"FTopFill"),rtl.free(this,"FTopStroke"),rtl.free(this,"FTopFont"),rtl.free(this,"FBottomFill"),rtl.free(this,"FBottomStroke"),rtl.free(this,"FBottomFont"),pas.Classes.TCollectionItem.Destroy.call(this),this.UpdateGroup()},this.Assign=function(e){t.TTMSFNCTreeViewGroup.isPrototypeOf(e)&&(this.FTag=rtl.as(e,t.TTMSFNCTreeViewGroup).FTag,this.FText=rtl.as(e,t.TTMSFNCTreeViewGroup).FText,this.FStartColumn=rtl.as(e,t.TTMSFNCTreeViewGroup).FStartColumn,this.FEndColumn=rtl.as(e,t.TTMSFNCTreeViewGroup).FEndColumn,this.FUseDefaultAppearance=rtl.as(e,t.TTMSFNCTreeViewGroup).FUseDefaultAppearance,this.FBottomFill.Assign(rtl.as(e,t.TTMSFNCTreeViewGroup).FBottomFill),this.FBottomFont.Assign(rtl.as(e,t.TTMSFNCTreeViewGroup).FBottomFont),this.FBottomStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewGroup).FBottomStroke),this.FTopFill.Assign(rtl.as(e,t.TTMSFNCTreeViewGroup).FTopFill),this.FTopStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewGroup).FTopStroke),this.FTopFont.Assign(rtl.as(e,t.TTMSFNCTreeViewGroup).FTopFont))},this.GetText=function(){var e="";return""===(e=this.FText)&&""===(e=this.FName)&&(e=t.TranslateTextEx(rtl.getResStr(t,"sTMSFNCTreeViewGroup"))+" "+pas.SysUtils.IntToStr(this.GetIndex())),e};var e=this.$rtti;e.addProperty("Name",2,rtl.string,"FName","SetName"),e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("StartColumn",2,rtl.longint,"FStartColumn","SetStartColumn",{Default:0}),e.addProperty("EndColumn",2,rtl.longint,"FEndColumn","SetEndColumn",{Default:0}),e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag",{Default:0}),e.addProperty("UseDefaultAppearance",2,rtl.boolean,"FUseDefaultAppearance","SetUseDefaultAppearance",{Default:!0}),e.addProperty("TopFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FTopFill","SetTopFill"),e.addProperty("TopStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FTopStroke","SetTopStroke"),e.addProperty("TopFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FTopFont","SetTopFont"),e.addProperty("BottomFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FBottomFill","SetBottomFill"),e.addProperty("BottomStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FBottomStroke","SetBottomStroke"),e.addProperty("BottomFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FBottomFont","SetBottomFont")})),rtl.createClass(this,"TTMSFNCTreeViewGroups",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FTreeView=null},this.$final=function(){this.FTreeView=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.GetItemClass=function(){return t.TTMSFNCTreeViewGroup},this.TreeView=function(){return this.FTreeView},this.Create$3=function(t){return pas.Classes.TOwnedCollection.Create$2.call(this,t,this.GetItemClass()),this.FTreeView=t,this}})),this.TTMSFNCTreeViewNodeTextMode={0:"tntmDrawing",tntmDrawing:0,1:"tntmEditing",tntmEditing:1},this.$rtti.$Enum("TTMSFNCTreeViewNodeTextMode",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTreeViewNodeTextMode}),rtl.createClass(this,"TTMSFNCTreeViewNodeStructure",pas.contnrs.TObjectList,(function(){this.GetItem$1=function(t){return this.GetItem(t)}})),rtl.createClass(this,"TTMSFNCTreeViewVisibleNodes",pas.Classes.TList,(function(){this.GetItem=function(t){return rtl.getObject(this.Get(t))}})),rtl.recNewT(this,"TTMSFNCTreeViewDisplayGroup",(function(){this.StartColumn=0,this.EndColumn=0,this.$eq=function(t){return this.StartColumn===t.StartColumn&&this.EndColumn===t.EndColumn},this.$assign=function(t){return this.StartColumn=t.StartColumn,this.EndColumn=t.EndColumn,this}})),rtl.createClass(this,"TTMSFNCTreeViewDisplayGroups",pas.Classes.TList,(function(){this.GetItem=function(e){var i=t.TTMSFNCTreeViewDisplayGroup.$new();return i.$assign(rtl.getObject(this.Get(e))),i}})),rtl.createClass(this,"TTMSFNCTreeViewData",pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase,(function(){this.$init=function(){pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.$init.call(this),this.FFilterApplied=!1,this.FBlockUpdate=!1,this.FNodeStructure=null,this.FVisibleNodes=null,this.FColumns=null,this.FGroups=null,this.FNodes=null,this.FBitmapContainer=null,this.FDisplayGroups=null,this.FFilter=null,this.FSortMode=0},this.$final=function(){this.FNodeStructure=void 0,this.FVisibleNodes=void 0,this.FColumns=void 0,this.FGroups=void 0,this.FNodes=void 0,this.FBitmapContainer=void 0,this.FDisplayGroups=void 0,this.FFilter=void 0,pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.$final.call(this)},this.SetColumns=function(t){this.FColumns.Assign(t)},this.SetGroups=function(t){this.FGroups.Assign(t)},this.SetNodes=function(t){this.FNodes.Assign(t)},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,this.Invalidate()},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),t===this.FBitmapContainer&&1===e&&(this.FBitmapContainer=null)},this.CreateColumns=function(){return t.TTMSFNCTreeViewColumns.$create("Create$3",[this])},this.CreateGroups=function(){return t.TTMSFNCTreeViewGroups.$create("Create$3",[this])},this.CreateNodes=function(){return t.TTMSFNCTreeViewNodes.$create("Create$3",[this,null])},this.GetInsertPosition=function(t,e,i){var s=0,n=null,o=0,r=0,a=null;if(s=-1,null==t)return s;if(0===t.FRow)return s=0;if(n=i?this.GetNodeFromNodeStructure(t.FRow-1):this.GetNodeFromNodeStructure(t.FRow),e)for(;null!=n&&n.FParentNode>=0&&n.FParentNode<=this.FNodeStructure.GetCount()-1&&(a=this.GetNodeFromNodeStructure(n.FParentNode))!==n;)n=a;if(null!=n)for(var l=0,h=this.FVisibleNodes.GetCount()-1;l<=h;l++)if(o=l,r=i?t.FRow+1:t.FRow,this.FVisibleNodes.GetItem(o).FRow===r){s=o;break}return s},this.GetNodeFromNodeStructure=function(t){var e=null;return e=null,t>=0&&t<=this.FNodeStructure.GetCount()-1&&(e=this.FNodeStructure.GetItem$1(t)),e},this.MatchFilter=function(t){var e=!1,i=0,s="",n=!1;e=!0;for(var o=1,r=this.FFilter.GetCount();o<=r;o++){i=o;var a=this.FFilter.GetItem$1(i-1);s="",this.DoGetNodeText(t,a.FColumn,0,{get:function(){return s},set:function(t){s=t}}),s=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(s),s=pas.SysUtils.Trim(s),""!==a.FPrefix&&1===pas.System.Pos(a.FPrefix,s)&&pas.System.Delete({get:function(){return s},set:function(t){s=t}},1,this.FFilter.GetItem$1(i-1).FPrefix.length),""!==a.FSuffix&&pas.System.Pos(a.FSuffix,s)===1+s.length-a.FSuffix.length&&pas.System.Delete({get:function(){return s},set:function(t){s=t}},1+s.length-a.FSuffix.length,s.length);try{n=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.MatchStrEx(a.FCondition,s,a.FCaseSensitive)}catch(t){n=!1}var l=this.FFilter.GetItem$1(i-1).FOperation;if(0===l){if(!(e=n))break}else 1===l?e=n:2===l?e=e&&n:4===l?e=e||n:3===l&&(e^=n)}return e},this.BuildNodeList=function(){var e,i=0;this.FNodeListBuild||(this.FNodeStructure.Clear(),this.FVisibleNodes.Clear(),e=t.TTMSFNCTreeViewVirtualNode.$create("Create$1",[this]),this.FTotalRowHeight=1,this.SetRowCount(0),i=0,this.BuildInternalNodeList(e,"ROOT",-1,-1,-1,!0,{get:function(){return i},set:function(t){i=t}}),this.SetRowCount(this.FVisibleNodes.GetCount()),this.FNodeListBuild=this.FNodeStructure.GetCount()>0)},this.UpdateColumns=function(){var e=0,i=null,s=null,n=t.TTMSFNCTreeViewDisplayGroup.$new();if(!(this.FUpdateCount$1>0||3 in this.FComponentState)){this.FDisplayGroups.Clear();for(var o=0,r=this.FGroups.GetCount()-1;o<=r;o++)e=o,s=this.FGroups.GetItem$1(e),n.StartColumn=Math.max(0,Math.min(s.FStartColumn,this.FColumns.GetCount()-1)),n.EndColumn=Math.max(0,Math.min(s.FEndColumn,this.FColumns.GetCount()-1)),this.FDisplayGroups.Add(t.TTMSFNCTreeViewDisplayGroup.$clone(n));for(var a=0,l=this.FColumns.GetCount()-1;a<=l;a++)e=a,(i=this.FColumns.GetItem$1(e)).FVisible?this.SetColWidths(e,i.FWidth):this.SetColWidths(e,0)}},this.BuildInternalNodeList=function(e,i,s,n,o,r,a){var l=0,h=0,F=!1,p=null,c=!1,u=0,T=!1,C=!1,S=[],d=null,m=[];if(e.FRow=this.FNodeStructure.GetCount(),e.FParentNode=s,e.FIndex=n,e.FLevel=o,"ROOT"!==i&&this.GetNodeForNodeData(e),h=0,o<100&&this.DoGetNumberOfNodes(e,{get:function(){return h},set:function(t){h=t}}),e.FChildren=h,e.FCalculated=!1,e.FHeight=this.FDefaultRowHeight,c=!1,"ROOT"!==i&&this.DoIsNodeExpanded(e,{get:function(){return c},set:function(t){c=t}}),e.FExpanded=c,C=!1,this.DoIsNodeExtended(e,{get:function(){return C},set:function(t){C=t}}),this.UpdateNodeExtended(e,C),S=rtl.arraySetLength(S,!1,0),"ROOT"!==i){for(var f=0,g=this.FColumnCount-1;f<=g;f++)l=f,T=!1,this.DoIsNodeChecked(e,l,{get:function(){return T},set:function(t){T=t}}),(S=rtl.arraySetLength(S,!1,rtl.length(S)+1))[rtl.length(S)-1]=T;e.FCheckStates=rtl.arrayRef(S)}if(F=!this.FFilterApplied||this.MatchFilter(e),"ROOT"!==i&&this.DoIsNodeVisible(e,{get:function(){return F},set:function(t){F=t}}),u=h,"ROOT"!==i&&(this.FNodeStructure.Add$1(e),(r||0===e.FLevel)&&F)){if(this.FFilterApplied){for(d=e.GetParent(),m=[];null!=d;)d.FAddedToVisibleList||((m=rtl.arraySetLength(m,null,rtl.length(m)+1))[rtl.length(m)-1]=d),d=d.GetParent();for(var y=rtl.length(m)-1;y>=0;y--)l=y,this.FVisibleNodes.Add(m[l]),m[l].FAddedToVisibleList=!0}this.FVisibleNodes.Add(e),e.FAddedToVisibleList=!0}for(var b=0,N=h-1;b<=N&&(l=b,2e6!==this.FNodeStructure.GetCount());b++)p=t.TTMSFNCTreeViewVirtualNode.$create("Create$1",[this]),"ROOT"===i?this.BuildInternalNodeList(p,"",s,l,0,c,{get:function(){return u},set:function(t){u=t}}):this.BuildInternalNodeList(p,"",e.FRow,l,e.FLevel+1,c,{get:function(){return u},set:function(t){u=t}});a.set(a.get()+u),"ROOT"!==i?e.FTotalChildren=u:e=rtl.freeLoc(e)},this.GetNodeForNodeData=function(t){var e=null,i=null,s=null;null!=t&&null!=(e=null!=(i=this.GetNodeFromNodeStructure(t.FParentNode))&&null!=i.FNode?i.FNode.FNodes:this.FNodes)&&t.FIndex>=0&&t.FIndex<=e.GetCount()-1&&(s=e.GetItem$1(t.FIndex),t.FNode=s,s.FVirtualNode=t)},this.DoGetNumberOfNodes=function(t,e){null!=t.FNode?e.set(t.FNode.FNodes.GetCount()):e.set(this.FNodes.GetCount())},this.DoGetColumnTrimming=function(t,e,i){},this.DoGetColumnWordWrapping=function(t,e,i){},this.DoGetNodeSides=function(t,e){},this.DoGetNodeText=function(t,e,i,s){var n=null;null!=(n=t.FNode)&&e>=0&&e<=n.FValues.GetCount()-1&&s.set(n.FValues.GetItem$1(e).GetText())},this.DoGetNodeData=function(t){},this.DoGetNodeTitle=function(t,e,i,s){var n=null;null!=(n=t.FNode)&&e>=0&&e<=n.FValues.GetCount()-1&&s.set(n.FValues.GetItem$1(e).FTitle)},this.DoGetNodeTitleExpanded=function(t,e,i){var s=null;null!=(s=t.FNode)&&e>=0&&e<=s.FValues.GetCount()-1&&i.set(s.FValues.GetItem$1(e).FTitleExpanded)},this.DoGetNodeTrimming=function(t,e,i){},this.DoGetNodeHorizontalTextAlign=function(t,e,i){},this.DoGetNodeWordWrapping=function(t,e,i){},this.DoGetNodeTitleTrimming=function(t,e,i){},this.DoGetNodeTitleHorizontalTextAlign=function(t,e,i){},this.DoGetNodeTitleVerticalTextAlign=function(t,e,i){},this.DoGetNodeTitleWordWrapping=function(t,e,i){},this.DoGetNodeExtraSize=function(t,e,i){},this.DoGetNodeTitleExtraSize=function(t,e,i){},this.DoGetNodeCheckType=function(t,e,i){var s=null;null!=(s=t.FNode)&&e>=0&&e<=s.FValues.GetCount()-1&&i.set(s.FValues.GetItem$1(e).FCheckType)},this.DoGetNodeIcon=function(t,e,i,s){var n=null,o=null;null!=(n=t.FNode)&&e>=0&&e<=n.FValues.GetCount()-1&&(o=n.FValues.GetItem$1(e),t.FExpanded?i?(null!=this.GetBitmapContainer()&&""!==o.FExpandedIconLargeName&&s.set(this.GetBitmapContainer().FindBitmap$1(o.FExpandedIconLargeName)),null==s.get()&&s.set(o.FExpandedIconLarge)):(null!=this.GetBitmapContainer()&&""!==o.FExpandedIconName&&s.set(this.GetBitmapContainer().FindBitmap$1(o.FExpandedIconName)),null==s.get()&&s.set(o.FExpandedIcon)):i?(null!=this.GetBitmapContainer()&&""!==o.FCollapsedIconLargeName&&s.set(this.GetBitmapContainer().FindBitmap$1(o.FCollapsedIconLargeName)),null==s.get()&&s.set(o.FCollapsedIconLarge)):(null!=this.GetBitmapContainer()&&""!==o.FCollapsedIconName&&s.set(this.GetBitmapContainer().FindBitmap$1(o.FCollapsedIconName)),null==s.get()&&s.set(o.FCollapsedIcon)))},this.DoGetNodeIconSize=function(t,e,i,s,n,o){},this.DoGetNodeSelectedColor=function(t,e){},this.DoGetNodeDisabledColor=function(t,e){},this.DoGetNodeColor=function(t,e){},this.DoGetNodeSelectedTextColor=function(t,e,i){},this.DoGetNodeDisabledTextColor=function(t,e,i){},this.DoGetNodeSelectedTitleColor=function(t,e,i){},this.DoGetNodeDisabledTitleColor=function(t,e,i){},this.DoGetNodeTextColor=function(t,e,i){},this.DoGetNodeTitleColor=function(t,e,i){},this.DoIsNodeExpanded=function(t,e){var i;null!=(i=t.FNode)&&e.set(i.FExpanded)},this.DoIsNodeExtended=function(t,e){var i;null!=(i=t.FNode)&&e.set(i.FExtended)},this.DoIsNodeChecked=function(t,e,i){var s=null;null!=(s=t.FNode)&&e>=0&&e<=s.FValues.GetCount()-1&&i.set(s.FValues.GetItem$1(e).FChecked)},this.DoIsNodeVisible=function(t,e){},this.DoIsNodeEnabled=function(t,e){var i;null!=(i=t.FNode)&&e.set(i.FEnabled)},this.DoNodeCompare=function(t,e,i,s){},this.DoGetHTMLTemplateValue=function(t,e,i){},this.DoGetHTMLTemplate=function(t,e,i){},this.ToggleCheckNodeInternal=function(t,e,i){!(3 in this.FComponentState)&&null!=t&&this.FNodeListBuild&&e>=0&&e<=rtl.length(t.FCheckStates)-1&&(t.FCheckStates[e]?this.UnCheckNodeInternal(t,e,i):this.CheckNodeInternal(t,e,i))},this.CheckNodeInternal=function(t,e,i){var s=0,n=null,o=null,r=0,a=0,l=0,h=null;if(null!=t){if(e>=0&&e<=rtl.length(t.FCheckStates)-1&&(t.FCheckStates[e]=!0,this.UpdateCheckState(t,e,t.FCheckStates[e])),null!=t.FNode&&e>=0&&e<=t.FNode.FValues.GetCount()-1&&t.FNode.FValues.UpdateChecked(e,!0),s=0,this.DoGetNodeCheckType(t,e,{get:function(){return s},set:function(t){s=t}}),2===s)for(null!=(n=this.GetNodeFromNodeStructure(t.FParentNode))?a=(r=n.FRow+1)+n.FTotalChildren:(r=0,a=this.FNodeStructure.GetCount());r<a&&null!=(o=this.GetNodeFromNodeStructure(r));)o!==t&&(s=0,this.DoGetNodeCheckType(o,e,{get:function(){return s},set:function(t){s=t}}),2===s&&(e>=0&&e<=rtl.length(o.FCheckStates)-1&&(o.FCheckStates[e]=!1,this.UpdateCheckState(o,e,o.FCheckStates[e])),null!=o.FNode&&e>=0&&e<=o.FNode.FValues.GetCount()-1&&o.FNode.FValues.UpdateChecked(e,!1))),r=r+o.FTotalChildren+1;if(i)for(var F=t.FRow+1,p=t.FRow+t.FTotalChildren;F<=p;F++)l=F,null!=(h=this.GetNodeFromNodeStructure(l))&&this.CheckNodeInternal(h,e,i);this.Invalidate()}},this.UpdateCheckState=function(t,e,i){},this.UnCheckNodeInternal=function(t,e,i){var s=0,n=0,o=null;if(!(3 in this.FComponentState)&&null!=t&&this.FNodeListBuild){if(s=0,this.DoGetNodeCheckType(t,e,{get:function(){return s},set:function(t){s=t}}),1===s&&(e>=0&&e<=rtl.length(t.FCheckStates)-1&&(t.FCheckStates[e]=!1,this.UpdateCheckState(t,e,t.FCheckStates[e])),null!=t.FNode&&e>=0&&e<=t.FNode.FValues.GetCount()-1&&t.FNode.FValues.UpdateChecked(e,!1)),i)for(var r=t.FRow+1,a=t.FRow+t.FTotalChildren;r<=a;r++)n=r,null!=(o=this.GetNodeFromNodeStructure(n))&&this.UnCheckNodeInternal(o,e,i);this.Invalidate()}},this.ExpandNodeInternal=function(t,e){var i=0,s=null;if(!(3 in this.FComponentState)&&null!=t&&!t.FExpanded){if(null!=t&&(t.FExpanded=!0),this.UpdateNodeExpanded(t,!0),e)for(var n=t.FRow+1,o=t.FRow+t.FTotalChildren;n<=o;n++)i=n,null!=(s=this.GetNodeFromNodeStructure(i))&&this.UpdateNodeExpanded(s,!0);this.UpdateVisibleNodes(t),this.FBlockUpdate||(this.ResetNodes(!1),this.UpdateTreeView(),this.Invalidate())}},this.CollapseNodeInternal=function(t,e){var i=0,s=null;if(null!=t&&t.FExpanded&&this.FNodeListBuild&&!(3 in this.FComponentState)){if(this.UpdateNodeExpanded(t,!1),e)for(var n=t.FRow+1,o=t.FRow+t.FTotalChildren;n<=o;n++)i=n,null!=(s=this.GetNodeFromNodeStructure(i))&&this.UpdateNodeExpanded(s,!1);this.ResetNodes(!1),this.UpdateVisibleNodes(t),this.UpdateTreeView(),this.Invalidate()}},this.RemoveNodeInternal=function(e,i){var s=t.TTMSFNCTreeViewVirtualNodeRemoveData.$new(),n=0,o=0,r=0,a=null,l=null,h=null,F=0,p=!1,c=!1,u=[],T=0,C=!1;if(3 in this.FComponentState||!this.FNodeListBuild||null==e)return s;for(F=this.FNodeStructure.GetCount(),l=this.GetNodeFromNodeStructure(e.FParentNode);null!=l;)this.UpdateNodeTotalChildren(l,l.FTotalChildren-1-e.FTotalChildren),l.FRow===e.FParentNode&&this.UpdateNodeChildren(l,l.FChildren-1),r=l.FParentNode,l=this.GetNodeFromNodeStructure(r);for(var S=e.FTotalChildren-1;S>=0;S--)o=(n=S)+e.FRow+1,null!=(a=this.GetNodeFromNodeStructure(o))&&(this.FVisibleNodes.IndexOf(a)>-1&&(this.FVisibleNodes.Remove(a),this.FTotalRowHeight=this.FTotalRowHeight-a.FHeight,this.SetRowCount(this.FRowCount-1)),this.FNodeStructure.Remove$1(a),this.RemoveNodeFromSelection(a));if(o=e.FRow,r=e.FParentNode,this.FVisibleNodes.IndexOf(e)>-1&&(this.FVisibleNodes.Remove(e),this.FTotalRowHeight=this.FTotalRowHeight-e.FHeight,this.SetRowCount(this.FRowCount-1)),this.UpdateNodeChildren(e,e.FChildren-1),this.UpdateNodeTotalChildren(e,e.FTotalChildren-1),this.ClearFocusedNode(e),this.FNodeStructure.Remove$1(e),this.RemoveNodeFromSelection(e),F-=this.FNodeStructure.GetCount(),s.Count=F,s.RowIndex=o,s.ParentNode=r,i){for(var d=o,m=this.FNodeStructure.GetCount()-1;d<=m;d++)if(n=d,null!=(h=this.GetNodeFromNodeStructure(n))){this.UpdateNodeRow(h,h.FRow-F),h.FParentNode>r&&this.UpdateNodeParentNode(h,h.FParentNode-F),h.FParentNode===r&&this.UpdateNodeIndex(h,h.FIndex-1),this.GetNodeForNodeData(h),p=!1,this.DoIsNodeExpanded(h,{get:function(){return p},set:function(t){p=t}}),this.UpdateNodeExpanded(h,p),c=!1,this.DoIsNodeExtended(h,{get:function(){return c},set:function(t){c=t}}),this.UpdateNodeExtended(h,c),u=rtl.arraySetLength(u,!1,0);for(var f=0,g=this.FColumnCount-1;f<=g;f++)T=f,C=!1,this.DoIsNodeChecked(h,T,{get:function(){return C},set:function(t){C=t}}),(u=rtl.arraySetLength(u,!1,rtl.length(u)+1))[rtl.length(u)-1]=C;this.UpdateNodeCheckStates(h,rtl.arrayRef(u))}this.FBlockUpdate||(this.ResetNodes(!1),this.UpdateTreeView(),this.Invalidate())}return s},this.UpdateNodesInternal=function(t){var e,i,s=0,n=null,o=!1,r=!1,a=[],l=0,h=!1;e=t.Count,i=t.ParentNode;for(var F=t.RowIndex,p=this.FNodeStructure.GetCount()-1;F<=p;F++)if(s=F,null!=(n=this.GetNodeFromNodeStructure(s))){this.UpdateNodeRow(n,n.FRow-e),n.FParentNode>i&&this.UpdateNodeParentNode(n,n.FParentNode-e),n.FParentNode===i&&this.UpdateNodeIndex(n,n.FIndex-1),this.GetNodeForNodeData(n),r=!1,this.DoIsNodeExpanded(n,{get:function(){return r},set:function(t){r=t}}),this.UpdateNodeExpanded(n,r),o=!1,this.DoIsNodeExtended(n,{get:function(){return o},set:function(t){o=t}}),this.UpdateNodeExtended(n,o),a=rtl.arraySetLength(a,!1,0);for(var c=0,u=this.FColumnCount-1;c<=u;c++)l=c,h=!1,this.DoIsNodeChecked(n,l,{get:function(){return h},set:function(t){h=t}}),(a=rtl.arraySetLength(a,!1,rtl.length(a)+1))[rtl.length(a)-1]=h;this.UpdateNodeCheckStates(n,rtl.arrayRef(a))}this.FBlockUpdate||(this.ResetNodes(!1),this.UpdateTreeView(),this.Invalidate())},this.InsertNodeInternal=function(t,e,i,s){var n=0,o=0,r=null,a=null,l=0,h=!1,F=!1,p=[],c=0,u=!1,T=!1,C=0;if(this.FNodeListBuild&&!(3 in this.FComponentState))if(null!=s){if(l=this.FNodeStructure.GetCount(),null!=t&&(o=t.FRow)>=0&&o<=this.FNodeStructure.GetCount()-1)for(r=this.GetNodeFromNodeStructure(o);null!=r;)this.UpdateNodeTotalChildren(r,r.FTotalChildren+1),r.FRow===t.FRow&&this.UpdateNodeChildren(r,r.FChildren+1),o=r.FParentNode,r=this.GetNodeFromNodeStructure(o);this.UpdateNodeIndex(s,e),this.UpdateNodeRow(s,i),null!=t?(this.UpdateNodeParentNode(s,t.FRow),this.UpdateNodeLevel(s,t.FLevel+1)):(this.UpdateNodeParentNode(s,-1),this.UpdateNodeLevel(s,0)),this.UpdateNodeHeight(s,this.FDefaultRowHeight),this.GetNodeForNodeData(s),u=!1,this.DoIsNodeExpanded(s,{get:function(){return u},set:function(t){u=t}}),this.UpdateNodeExpanded(s,u),T=!1,this.DoIsNodeExtended(s,{get:function(){return T},set:function(t){T=t}}),this.UpdateNodeExtended(s,T),p=rtl.arraySetLength(p,!1,0);for(var S=0,d=this.FColumnCount-1;S<=d;S++)n=S,F=!1,this.DoIsNodeChecked(s,n,{get:function(){return F},set:function(t){F=t}}),(p=rtl.arraySetLength(p,!1,rtl.length(p)+1))[rtl.length(p)-1]=F;this.UpdateNodeCheckStates(s,rtl.arrayRef(p)),s.FRow>=0&&s.FRow<this.FNodeStructure.GetCount()?this.FNodeStructure.Insert$1(s.FRow,s):this.FNodeStructure.Add$1(s),h=!0,null!=t&&this.DoIsNodeVisible(t,{get:function(){return h},set:function(t){h=t}}),l-=this.FNodeStructure.GetCount();for(var m=s.FRow+1,f=this.FNodeStructure.GetCount()-1;m<=f;m++)if(n=m,null!=(a=this.GetNodeFromNodeStructure(n))){this.UpdateNodeRow(a,a.FRow-l),a.FParentNode>s.FParentNode&&this.UpdateNodeParentNode(a,a.FParentNode-l),a.FParentNode===s.FParentNode&&this.UpdateNodeIndex(a,a.FIndex+1),this.GetNodeForNodeData(a),u=!1,this.DoIsNodeExpanded(a,{get:function(){return u},set:function(t){u=t}}),this.UpdateNodeExpanded(a,u),T=!1,this.DoIsNodeExtended(a,{get:function(){return T},set:function(t){T=t}}),this.UpdateNodeExtended(a,T),p=rtl.arraySetLength(p,!1,0);for(var g=0,y=this.FColumnCount-1;g<=y;g++)C=g,F=!1,this.DoIsNodeChecked(a,C,{get:function(){return F},set:function(t){F=t}}),(p=rtl.arraySetLength(p,!1,rtl.length(p)+1))[rtl.length(p)-1]=F;this.UpdateNodeCheckStates(a,rtl.arrayRef(p))}(null==t||null!=t&&t.FExpanded&&h)&&(null==t?(this.SetRowCount(this.FRowCount+1),this.FTotalRowHeight=this.FTotalRowHeight+this.FDefaultRowHeight,(c=this.GetInsertPosition(s,!0,!0))>=0&&c<this.FVisibleNodes.GetCount()?this.FVisibleNodes.Insert(c,s):this.FVisibleNodes.Add(s)):(this.UpdateNodeExpanded(t,!1),this.UpdateVisibleNodes(t),this.UpdateNodeExpanded(t,!0),this.UpdateVisibleNodes(t))),this.ResetNodes(!1),this.UpdateTreeView(),this.Invalidate()}else s=rtl.freeLoc(s)},this.UpdateVisibleNodes=function(t){var e=0,i=0,s=0,n=0,o=null,r=!1,a=!1,l=!1;if(t.FExpanded){if(n=this.GetInsertPosition(t,-1===t.FParentNode,!1),r=!0,this.DoIsNodeEnabled(t,{get:function(){return r},set:function(t){r=t}}),a=!0,this.DoIsNodeVisible(t,{get:function(){return a},set:function(t){a=t}}),-1!==n&&a&&r)for(i=0,s=n+1;i<t.FTotalChildren;)e=i+t.FRow+1,null!=(o=this.GetNodeFromNodeStructure(e))&&((this.MatchFilter(o)||o.FAddedToVisibleList)&&this.FFilterApplied||!this.FFilterApplied)&&(l=!0,this.DoIsNodeVisible(o,{get:function(){return l},set:function(t){l=t}}),l&&(s>=0&&s<this.FVisibleNodes.GetCount()?this.FVisibleNodes.Insert(s,o):this.FVisibleNodes.Add(o),0===o.FChildren&&(o.FExpanded=!0),this.FTotalRowHeight=this.FTotalRowHeight+o.FHeight,this.SetRowCount(this.FRowCount+1),s+=1),o.FExpanded&&l||(i+=o.FTotalChildren)),i+=1}else for(var h=0,F=t.FTotalChildren-1;h<=F;h++)e=(i=h)+t.FRow+1,null!=(o=this.GetNodeFromNodeStructure(e))&&(this.UpdateNodeCalculated(o,!1),this.FVisibleNodes.IndexOf(o)>-1&&(this.FVisibleNodes.Remove(o),0===o.FChildren&&(o.FExpanded=!1),this.FTotalRowHeight=this.FTotalRowHeight-o.FHeight,this.SetRowCount(this.FRowCount-1)))},this.ToggleNodeInternal=function(t,e){!(3 in this.FComponentState)&&null!=t&&this.FNodeListBuild&&(t.FExpanded?this.CollapseNodeInternal(t,e):this.ExpandNodeInternal(t,e))},this.InsertItemInternal=function(t){var e;!(3 in this.FComponentState)&&null!=t&&this.FNodeListBuild&&(null!=(e=t.FCollection.Node())?this.InsertVirtualNode(t.GetIndex(),e.FVirtualNode):this.InsertVirtualNode(t.GetIndex(),null))},this.RemoveItemInternal=function(e,i){var s=t.TTMSFNCTreeViewVirtualNodeRemoveData.$new();return s.RowIndex=-1,s.Count=0,s.ParentNode=-1,3 in this.FComponentState||null==e||!this.FNodeListBuild||s.$assign(this.RemoveNodeInternal(e.FVirtualNode,i)),s},this.GetVisibleNodeForIndex=function(t){var e=null;return e=null,t>=0&&t<=this.FVisibleNodes.GetCount()-1&&(e=this.FVisibleNodes.GetItem(t)),e},this.ToggleNode=function(t){null!=t&&this.ToggleVirtualNode(t.FVirtualNode,!1)},this.UpdateNodeCalculated=function(t,e){t.FCalculated=e},this.UpdateNodeHeight=function(t,e){t.FHeight=e},this.UpdateNodeTitleHeight=function(t,e){t.FTitleHeight=e},this.UpdateNodeCheckStates=function(t,e){t.FCheckStates=rtl.arrayRef(e)},this.UpdateNodeBitmapRects=function(t,e){t.FBitmapRects=rtl.arrayRef(e)},this.UpdateNodeCheckRects=function(t,e){t.FCheckRects=rtl.arrayRef(e)},this.UpdateNodeExpandRects=function(t,e){t.FExpandRects=rtl.arrayRef(e)},this.UpdateNodeTextRects=function(t,e){t.FTextRects=rtl.arrayRef(e)},this.UpdateNodeTitleRects=function(t,e){t.FTitleRects=rtl.arrayRef(e)},this.UpdateNodeExtraRects=function(t,e){t.FExtraRects=rtl.arrayRef(e)},this.UpdateNodeTitleExtraRects=function(t,e){t.FTitleExtraRects=rtl.arrayRef(e)},this.UpdateNodeCacheReference=function(t,e){t.FCache=e},this.UpdateNodeExpanded=function(t,e){t.FExpanded=e,null!=t.FNode&&(t.FNode.FExpanded=e)},this.UpdateNodeExtended=function(t,e){t.FExtended=e},this.UpdateNodeTotalChildren=function(t,e){t.FTotalChildren=e},this.UpdateNodeChildren=function(t,e){t.FChildren=e},this.UpdateNodeIndex=function(t,e){t.FIndex=e},this.UpdateNodeRow=function(t,e){t.FRow=e},this.UpdateNodeLevel=function(t,e){t.FLevel=e},this.UpdateNodeParentNode=function(t,e){t.FParentNode=e},this.UpdateNode=function(t){null!=t&&!(3 in this.FComponentState)&&this.FNodeListBuild&&(this.FBlockUpdateNode||(t.FCalculated=!1,this.FUpdateCount$1>0||(this.UpdateNodesCache(!0,!1),this.Invalidate())))},this.CustomizeScrollPosition=function(t,e,i){},this.HTMLReplace=function(t,e){var i="",s="",n="",o="",r="",a=0,l=0;if(i="",null==e)return i;for(s="";pas.System.Pos("<#",t)>0&&pas.System.Pos(">",t)>0;)a=pas.System.Pos("<#",t),s+=pas.System.Copy(t,1,a-1),n=pas.System.Copy(t,a,t.length),l=pas.System.Pos(">",n),o=pas.System.Copy(n,1,l-1),pas.System.Delete({get:function(){return o},set:function(t){o=t}},1,2),pas.System.Delete({get:function(){return t},set:function(e){t=e}},1,a+l-1),r=e.FHTMLTemplateItems.GetValue(o),this.DoGetHTMLTemplateValue(e,o,{get:function(){return r},set:function(t){r=t}}),s+=r;return i=s+t},this.GetHTMLTemplate=function(t){return"",""},this.Assign=function(e){pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.Assign.apply(this,arguments),t.TTMSFNCTreeViewData.isPrototypeOf(e)&&(this.FColumns.Assign(rtl.as(e,t.TTMSFNCTreeViewData).FColumns),this.FGroups.Assign(rtl.as(e,t.TTMSFNCTreeViewData).FGroups),this.FNodes.Assign(rtl.as(e,t.TTMSFNCTreeViewData).FNodes))},this.Create$1=function(e){return pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.Create$1.apply(this,arguments),this.FFilter=t.TTMSFNCTreeViewFilter.$create("Create$3",[this]),this.FNodeStructure=t.TTMSFNCTreeViewNodeStructure.$create("Create$2"),this.FVisibleNodes=t.TTMSFNCTreeViewVisibleNodes.$create("Create$1"),this.FDisplayGroups=t.TTMSFNCTreeViewDisplayGroups.$create("Create$1"),this.FNodes=this.CreateNodes(),this.FColumns=this.CreateColumns(),this.FGroups=this.CreateGroups(),this},this.Destroy=function(){rtl.free(this,"FFilter"),rtl.free(this,"FDisplayGroups"),rtl.free(this,"FNodeStructure"),rtl.free(this,"FVisibleNodes"),rtl.free(this,"FNodes"),rtl.free(this,"FGroups"),rtl.free(this,"FColumns"),pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.Destroy.call(this)},this.IsColumnVisible=function(t){var e=!1;return e=pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.IsColumnVisible.call(this,t),t>=0&&t<=this.FColumns.GetCount()-1&&(e=this.FColumns.GetItem$1(t).FVisible),e},this.ClearColumns=function(){this.BeginUpdate(),this.FColumns.Clear(),this.EndUpdate()},this.ClearNodes=function(){this.BeginUpdate(),this.FNodeListBuild=!1,this.FNodes.Clear(),this.ClearFocusedNode(null),this.EndUpdate()},this.ClearNodeList=function(){this.BeginUpdate(),this.FNodeListBuild=!1,this.ClearFocusedNode(null),this.EndUpdate()},this.RemoveVirtualNode=function(t){this.RemoveNodeInternal(t,!0)},this.RemoveNode=function(t){null!=t&&(t=rtl.freeLoc(t))},this.ExpandNode=function(t,e){null!=t&&this.ExpandVirtualNode(t.FVirtualNode,e)},this.MoveNode=function(e,i,s){var n=null,o=null;if(null!=i&&null!=e&&i!==e){for(o=i.GetParent();null!=o;){if(o===e)return;o=o.GetParent()}this.BeginUpdate(),n=t.TTMSFNCTreeViewNode.$create("Create$1",[null]),null!=i?e.SetCollection(i.FNodes):e.SetCollection(this.FNodes),null!=i?s>=0&&s<=i.FNodes.GetCount()-1?e.SetIndex(s):e.SetIndex(i.FNodes.GetCount()-1):s>=0&&s<=this.FNodes.GetCount()-1?e.SetIndex(s):e.SetIndex(this.FNodes.GetCount()-1),n=rtl.freeLoc(n),this.EndUpdate()}},this.CopyNode=function(e,i,s){var n=null,o=null;i!==e&&(this.BeginUpdate(),(n=t.TTMSFNCTreeViewNode.$create("Create$1",[null])).Assign(e),(o=null!=i?i.FNodes.Add$1():this.FNodes.Add$1()).Assign(n),n=rtl.freeLoc(n),null!=i?s>=0&&s<=i.FNodes.GetCount()-1&&o.SetIndex(s):s>=0&&s<=this.FNodes.GetCount()-1&&o.SetIndex(s),this.EndUpdate())},this.ExpandAll=function(){!function t(e){for(var i=0,s=0,n=e.GetCount()-1;s<=n;s++)i=s,e.GetItem$1(i).FExpanded=!0,t(e.GetItem$1(i).FNodes)}(this.FNodes),this.ExpandAllVirtual()},this.ExpandAllVirtual=function(){var t=0,e=null;this.FVisibleNodes.Clear(),this.FTotalRowHeight=1,this.SetRowCount(0);for(var i=0,s=this.FNodeStructure.GetCount()-1;i<=s;i++)t=i,null!=(e=this.GetNodeFromNodeStructure(t))&&((this.MatchFilter(e)||e.FAddedToVisibleList)&&this.FFilterApplied||!this.FFilterApplied)&&(this.UpdateNodeExpanded(e,!0),this.FVisibleNodes.Add(e),this.FTotalRowHeight=this.FTotalRowHeight+e.FHeight,this.SetRowCount(this.FRowCount+1));this.ResetNodes(!0),this.UpdateTreeView(),this.Invalidate()},this.ApplyFilter=function(){this.FFilterApplied=!0,this.ClearNodeList()},this.RemoveFilter=function(){this.FFilterApplied=!1,this.ClearNodeList()},this.RemoveFilters=function(){this.FFilter.Clear(),this.FFilterApplied=!1,this.ClearNodeList()},this.CollapseNode=function(t,e){null!=t&&this.CollapseVirtualNode(t.FVirtualNode,e)},this.ToggleVirtualNode=function(t,e){this.ToggleNodeInternal(t,e)},this.ExpandVirtualNode=function(t,e){this.ExpandNodeInternal(t,e)},this.CollapseVirtualNode=function(t,e){this.CollapseNodeInternal(t,e)},this.CheckVirtualNode=function(t,e,i){this.CheckNodeInternal(t,e,i)},this.UnCheckVirtualNode=function(t,e,i){this.UnCheckNodeInternal(t,e,i)},this.ScrollToNode=function(t,e,i,s){null!=t&&this.ScrollToVirtualNode(t.FVirtualNode,e,i,s)},this.ScrollToVirtualNode=function(t,e,i,s){var n=0;if(null!=t){if(this.IsVariableNodeHeight())for(n=-1;!t.FCalculated&&n!==this.GetVerticalScrollPosition()&&(t.FExpanded||0===t.FChildren);)this.ScrollToVirtualNodeInternal(t,e,i,s),n=this.GetVerticalScrollPosition();this.ScrollToVirtualNodeInternal(t,e,i,s)}},this.ScrollToVirtualNodeInternal=function(t,e,i,s){var n=0,o=0,r=0,a=0,l=null;if(r=0,o=0,null!=t){for(var h=0,F=this.FVisibleNodes.GetCount()-1;h<=F;h++)if(n=h,null!=(l=this.FVisibleNodes.GetItem(n))){if(l.FRow===t.FRow)break;l.FCalculated?r+=l.FHeight:o+=1}r+=this.FDefaultRowHeight*o,a=r;var p=i;1===p?r=r-this.GetVViewPortSize()+t.FHeight:2===p&&(r=r-this.GetVViewPortSize()/2+t.FHeight/2),this.CustomizeScrollPosition(t,{get:function(){return r},set:function(t){r=t}},{get:function(){return a},set:function(t){a=t}}),e?(a<Math.abs(this.GetVScrollValue())||a+t.FHeight>Math.abs(this.GetVScrollValue())+this.GetVViewPortSize()||s)&&this.Scroll(this.GetHScrollValue(),r):this.Scroll(this.GetHScrollValue(),r)}},this.GetNodeForRow=function(t){var e=null;return e=null,t>=0&&t<=this.FNodeStructure.GetCount()-1&&(e=this.FNodeStructure.GetItem$1(t)),e},this.AddNode=function(t){return null!=t?t.FNodes.Add$1():this.FNodes.Add$1()},this.GetParentVirtualNode=function(t){var e=null;return e=null,null!=t&&(e=this.GetNodeFromNodeStructure(t.FParentNode)),e},this.GetParentNode=function(t){var e=null,i=null;return e=null,null!=t&&null!=(i=this.GetParentVirtualNode(t.FVirtualNode))&&(e=i.FNode),e},this.GetTotalVirtualNodeCount=function(){var t=0,e=null;for(t=0,e=this.GetFirstRootVirtualNode();null!=e;)t=t+e.FTotalChildren+1,e=e.GetNextSibling();return t},this.GetVirtualNodeText=function(t,e){var i="";return i="",null!=t&&(i="",this.DoGetNodeText(t,e,0,{get:function(){return i},set:function(t){i=t}})),i},this.GetVirtualNodeTitle=function(t,e){var i="";return i="",null!=t&&(i="",this.DoGetNodeTitle(t,e,0,{get:function(){return i},set:function(t){i=t}})),i},this.GetVirtualNodeTitleExpanded=function(t,e){var i=!1;return i=!0,null!=t&&(i=!0,this.DoGetNodeTitleExpanded(t,e,{get:function(){return i},set:function(t){i=t}})),i},this.GetPreviousVirtualNode=function(t){var e=null;return e=null,null!=t&&(e=this.GetNodeFromNodeStructure(t.FRow-1)),e},this.GetNextVirtualNode=function(t){var e=null;return e=null,null!=t&&(e=this.GetNodeFromNodeStructure(t.FRow+1)),e},this.GetNextSiblingVirtualNode=function(t){var e=null,i=null;i=t;do{e=i=this.GetNextVirtualNode(i)}while(null!==e&&(null==e||e.FParentNode!==t.FParentNode));return e},this.GetFirstRootVirtualNode=function(){var t=null;return t=null,this.FNodeStructure.GetCount()>0&&(t=this.FNodeStructure.GetItem$1(0)),t},this.GetLastVirtualNode=function(){var t=null;return t=null,this.FNodeStructure.GetCount()>0&&(t=this.FNodeStructure.GetItem$1(this.FNodeStructure.GetCount()-1)),t},this.InsertVirtualNode=function(e,i){var s,n=null,o=null,r=null,a=null,l=0,h=0;if(n=null,3 in this.FComponentState||!this.FNodeListBuild)return n;if(s=t.TTMSFNCTreeViewVirtualNode.$create("Create$1",[this]),null!=i){for(h=-1,l=i.FRow+1;l<=i.FRow+i.FTotalChildren&&null!=(r=this.GetNodeFromNodeStructure(l));){if(r.FIndex===e&&r.FParentNode===i.FRow){h=r.FRow;break}l=l+r.FChildren+1}-1===h?this.InsertNodeInternal(i,e,i.FRow+i.FTotalChildren+1,s):this.InsertNodeInternal(i,e,h,s)}else{if(o=null,this.FNodeStructure.GetCount()>0)for(o=this.GetNodeFromNodeStructure(this.FNodeStructure.GetCount()-1);null!=o&&o.FParentNode>=0&&o.FParentNode<=this.FNodeStructure.GetCount()-1;)o=this.GetNodeFromNodeStructure(o.FParentNode);if(null!=o)if(e>o.FIndex)this.InsertNodeInternal(null,e,o.FRow+o.FTotalChildren+1,s);else{for(r=null,l=0;null==r&&null!=(a=this.GetNodeFromNodeStructure(l));){if(a.FIndex===e){r=a;break}l=l+a.FTotalChildren+1}null!=r&&this.InsertNodeInternal(null,e,r.FRow,s)}else this.InsertNodeInternal(null,0,0,s)}return n=s},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),this.TranslateTextEx=function(t){return t},t.$resourcestrings={sTMSFNCTreeViewGroup:{org:"Group"},sTMSFNCTreeViewColumn:{org:"Column"}}}),["SysUtils","Math","WEBLib.TMSFNCUtils","WEBLib.Graphics"]),rtl.module("WEBLib.TMSFNCPopup",["System","Classes","WEBLib.Controls","WEBLib.TMSFNCCustomComponent","WEBLib.TMSFNCGraphics","WEBLib.Graphics","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphicsTypes","WEBLib.Forms","WEBLib.ExtCtrls","Types"],(function(){"use strict";var t=this,e=t.$impl;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=0,this.BLD_VER=4,this.TTMSFNCPopupPlacement={0:"ppBottom",ppBottom:0,1:"ppTop",ppTop:1,2:"ppLeft",ppLeft:2,3:"ppRight",ppRight:3,4:"ppCenter",ppCenter:4,5:"ppBottomCenter",ppBottomCenter:5,6:"ppTopCenter",ppTopCenter:6,7:"ppLeftCenter",ppLeftCenter:7,8:"ppRightCenter",ppRightCenter:8,9:"ppAbsolute",ppAbsolute:9,10:"ppMouse",ppMouse:10,11:"ppMouseCenter",ppMouseCenter:11,12:"ppAboveMouse",ppAboveMouse:12,13:"ppAboveMouseCenter",ppAboveMouseCenter:13},this.$rtti.$Enum("TTMSFNCPopupPlacement",{minvalue:0,maxvalue:13,ordtype:1,enumtype:this.TTMSFNCPopupPlacement}),this.$rtti.$MethodVar("TTMSFNCPopupPaint",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomPopupForm",pas["WEBLib.Forms"].TCustomForm,(function(){this.$init=function(){pas["WEBLib.Forms"].TCustomForm.$init.call(this),this.FPreferedDisplayIndex=0,this.FHintWindow=!1,this.FTimer=null,this.FFirstShow=!1,this.FOwner$1=null,this.FShowModal=!1,this.FPlacement=0,this.FRealPlacement=0,this.FPlacementControl=null,this.FOffset=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),this.FSize=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),this.FPlacementRectangle=null,this.FScreenPlacementRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),this.FPlacementChanged=!1,this.FDragWithParent=!1,this.FOnBeforeClose=null,this.FOnBeforeShow=null,this.FScreenContentRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),this.FContentPadding=null,this.FContentControl=null,this.FOnRealPlacementChanged=null,this.FOnPopupPaint=null},this.$final=function(){this.FTimer=void 0,this.FOwner$1=void 0,this.FPlacementControl=void 0,this.FOffset=void 0,this.FSize=void 0,this.FPlacementRectangle=void 0,this.FScreenPlacementRect=void 0,this.FOnBeforeClose=void 0,this.FOnBeforeShow=void 0,this.FScreenContentRect=void 0,this.FContentPadding=void 0,this.FContentControl=void 0,this.FOnRealPlacementChanged=void 0,this.FOnPopupPaint=void 0,pas["WEBLib.Forms"].TCustomForm.$final.call(this)},this.SetOffset=function(t){this.FOffset.X===t.X&&this.FOffset.Y===t.Y||(this.FOffset.$assign(t),this.ApplyPlacement())},this.SetSize=function(t){this.FSize.cx===t.cx&&this.FSize.cy===t.cy||(this.FSize.$assign(t),this.ApplyPlacement())},this.TimerProc=function(t){(this.FVisible||this.FHintWindow)&&(this.FFirstShow||this.FDragWithParent)&&this.ApplyPlacement(),(this.FVisible||this.FHintWindow)&&this.FFirstShow&&(this.FFirstShow=!1)},this.SetPlacementRectangle=function(t){this.FPlacementRectangle.Assign(t)},this.SetPlacement=function(t){this.FPlacement!==t&&(this.FPlacement=t,this.ApplyPlacement())},this.SetPlacementControl=function(t){this.FPlacementControl!==t&&(null!==this.FPlacementControl&&this.FPlacementControl.RemoveFreeNotification(this),this.FPlacementControl=t,null!==this.FPlacementControl&&this.FPlacementControl.FreeNotification(this))},this.SetDragWithParent=function(t){this.FDragWithParent=t},this.SetContentControl=function(t){if(this.FContentControl!==t&&(null!==this.FContentControl&&this.FContentControl.RemoveFreeNotification(this),this.FContentControl=t,null!==this.FContentControl)){this.FContentControl.FreeNotification(this);try{this.FContentControl.SetParent(this),this.FContentControl.SetAlign(0),this.FContentControl.SetVisible(!0)}finally{}}},this.DoBeforeShow=function(){this.FHintWindow=!1,null!=this.FOnBeforeShow&&this.FOnBeforeShow(this),this.FFirstShow=!0,null==this.FTimer&&(this.FTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this])),this.FTimer.SetInterval(20),this.FTimer.FOnTimer=rtl.createCallback(this,"TimerProc"),this.FTimer.SetEnabled(!0)},this.DoBeforeClose=function(){null!=this.FOnBeforeClose&&this.FOnBeforeClose(this)},this.UpdateBounds=function(t){this.SetBounds(Math.round(t.Left),Math.round(t.Top),Math.round(t.Right-t.Left),Math.round(t.Bottom-t.Top))},this.DoClose=function(t){t.set(2),pas["WEBLib.Forms"].TCustomForm.DoClose.apply(this,arguments),0!==t.get()&&null!=this.FTimer&&this.FTimer.SetEnabled(!1)},this.DoApplyPlacement=function(){var t,e,i,s,n,o,r,a=this,l=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),h=pas.Types.TPoint.$new(),F=pas.Types.TPoint.$new(),p=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),c=0,u=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),T=0,C=!1,S=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),d=!1;this.FPlacementChanged=!1,u.$assign(this.FOffset),c=this.FPlacement,T=0;do{p.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FPlacementRectangle.FLeft,this.FPlacementRectangle.FTop,this.FPlacementRectangle.FRight,this.FPlacementRectangle.FBottom)),null!==this.FPlacementControl&&this.FPlacementRectangle.Empty()&&p.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.FPlacementControl.GetWidth(),this.FPlacementControl.GetHeight())),null===this.FPlacementControl&&this.FPlacementRectangle.Empty()&&rtl.createSet(9,10,11,12,13),this.FScreenPlacementRect.$assign(p),c in rtl.createSet(1,6)?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,0,this.FContentPadding.FBottom-u.Y):pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,0,u.Y-this.FContentPadding.FTop),c in rtl.createSet(2,7)?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,this.FContentPadding.FRight-u.X,0):pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,u.X-this.FContentPadding.FLeft,0),d=!(c in rtl.createSet(9,10,11,12,13)),S.$assign(this.FSize);var m=c;0===m?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,0,p.Bottom-p.Top):1===m?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,0,-S.cy):2===m?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,-S.cx,0):3===m?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,p.Right-p.Top,0):4===m?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,(p.Right-p.Top-S.cx)/2,(p.Bottom-p.Top-S.cy)/2):5===m?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,(p.Right-p.Top-S.cx)/2,p.Bottom-p.Top):6===m?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,(p.Right-p.Top-S.cx)/2,-S.cy):7===m?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,-S.cx,(p.Bottom-p.Top-S.cy)/2):8===m?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,p.Right-p.Top,(p.Bottom-p.Top-S.cy)/2):9===m?this.FPlacementRectangle.Empty()?p.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FPlacementRectangle.Rect().Left,this.FPlacementRectangle.Rect().Top,this.FPlacementRectangle.Rect().Left+S.cx,this.FPlacementRectangle.Rect().Top+S.cy)):p.$assign(this.FPlacementRectangle.Rect()):10!==m&&11!==m&&12!==m&&13!==m||(l.$assign(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetMousePos()),p.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l.X,l.Y,l.X+S.cx,l.Y+S.cy)),11===c&&pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,-S.cx/2,-S.cy/2),13===c&&pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,-S.cx/2,-S.cy-5),12===c&&pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(p,0,-S.cy-5)),d&&(F.$assign(pas.Types.Point(Math.round(p.Left),Math.round(p.Top))),null!==this.FPlacementControl&&(F.$assign(this.FPlacementControl.ClientToScreen(F)),h.$assign(pas.Types.Point(Math.round(this.FScreenPlacementRect.Left),Math.round(this.FScreenPlacementRect.Top))),h.$assign(this.FPlacementControl.ClientToScreen(h)),this.FScreenPlacementRect.Left=h.x,this.FScreenPlacementRect.Top=h.y,h.$assign(pas.Types.Point(Math.round(this.FScreenPlacementRect.Right),Math.round(this.FScreenPlacementRect.Bottom))),h.$assign(this.FPlacementControl.ClientToScreen(h)),this.FScreenPlacementRect.Right=h.x,this.FScreenPlacementRect.Bottom=h.y),p.$assign(pas["WEBLib.TMSFNCTypes"].RectF(F.x,F.y,F.x+this.FSize.cx,F.y+this.FSize.cy))),t=p,e=rtl.refSet(this.FComponentState),i=void 0,s=void 0,n=void 0,o=void 0,r=void 0,i=!1,s=pas.Types.TRect.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=0,r=0,i=!0,t.Left=Math.round(t.Left),t.Top=Math.round(t.Top),t.Right=Math.round(t.Right),t.Bottom=Math.round(t.Bottom),s.Left=0,s.Top=0,s.Right=pas["WEBLib.Forms"].WinWidth(),s.Bottom=pas["WEBLib.Forms"].WinHeight(),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left-a.FContentPadding.FLeft,s.Top-a.FContentPadding.FTop,s.Right+a.FContentPadding.FRight,s.Bottom+a.FContentPadding.FBottom)),4 in e||(o=t.Right-t.Left,r=t.Bottom-t.Top,t.Left>n.Left?t.Left>n.Right-o&&(t.Left=n.Right-o,3===c&&(c=2,i=!1),8===c&&(c=7,i=!1)):(t.Left=n.Left,2===c&&(c=3,i=!1),7===c&&(c=8,i=!1)),t.Top>n.Top?t.Top>n.Bottom-r&&(t.Top=n.Bottom-r,0===c&&(c=1,i=!1),5===c&&(c=6,i=!1)):(t.Top=n.Top,1===c&&(c=0,i=!1),6===c&&(c=5,i=!1)),t.Right=t.Left+o,t.Bottom=t.Top+r),C=i,T+=1}while(!(C||T>1));this.FScreenContentRect.$assign(p),this.FScreenContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FScreenContentRect.Left+this.FContentPadding.FLeft,this.FScreenContentRect.Top+this.FContentPadding.FTop,this.FScreenContentRect.Right-this.FContentPadding.FRight,this.FScreenContentRect.Bottom-this.FContentPadding.FBottom)),this.FRealPlacement=c,this.UpdateBounds(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(p))},this.Loaded=function(){pas["WEBLib.Forms"].TCustomForm.Loaded.call(this),this.FPlacementChanged&&this.ApplyPlacement()},this.Notification=function(t,e){pas.Classes.TComponent.Notification.apply(this,arguments),1===e&&(t===this.FPlacementControl&&(this.FPlacementControl=null,this.ApplyPlacement()),t===this.FContentControl&&(this.FContentControl=null))},this.DoRealPlacementChanged=function(){null!=this.FOnRealPlacementChanged&&this.FOnRealPlacementChanged(this)},this.CreateNew=function(t,e){function i(e){var i="",s=0;for(s=0,i=e;null!==pas["WEBLib.Controls"].FindGlobalComponent(i)||null!==t&&null!==t.FindComponent(i);)s+=1,i=pas.SysUtils.Format("%s_%d",pas.System.VarRecs(18,e,0,s));return i}this.SetName(i("CustomPopupForm")),pas["WEBLib.Forms"].TCustomForm.CreateNew.apply(this,arguments),this.FPreferedDisplayIndex=-1,this.FOwner$1=t,this.FDragWithParent=!0,this.FPlacementRectangle=pas["WEBLib.TMSFNCTypes"].TTMSFNCMargins.$create("Create$1"),this.FContentPadding=pas["WEBLib.TMSFNCTypes"].TTMSFNCMargins.$create("Create$1"),this.FSize.cx=320,this.FSize.cy=200,this.FPlacement=0,this.FRealPlacement=this.FPlacement,this.SetVisible(!1);try{this.SetBorder(0),this.SetPosition(0)}finally{}return this},this.Create$7=function(t,e){this.CreateNew(t,0);try{null!==e&&(this.FPlacementControl=e),null!==this.FPlacementControl&&this.FPlacementControl.FreeNotification(this)}finally{}return this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FTimer},set:function(t){this.p.FTimer=t}}),null!==this.FPlacementControl&&(this.FPlacementControl.RemoveFreeNotification(this),this.FPlacementControl=null),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FContentPadding},set:function(t){this.p.FContentPadding=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FPlacementRectangle},set:function(t){this.p.FPlacementRectangle=t}}),pas["WEBLib.Forms"].TCustomForm.Destroy.call(this)},this.ApplyPlacement=function(){var t,e=pas.Types.TRect.$new(),i=pas.Types.TRect.$new();e.$assign(pas.Types.Rect(this.GetLeft(),this.GetTop(),this.GetLeft()+this.GetWidth(),this.GetTop()+this.GetHeight())),t=this.FRealPlacement,this.DoApplyPlacement(),i.$assign(pas.Types.Rect(this.GetLeft(),this.GetTop(),this.GetLeft()+this.GetWidth(),this.GetTop()+this.GetHeight())),i.Left===e.Left&&i.Top===e.Top&&i.Bottom===e.Bottom&&i.Right===e.Right&&t===this.FRealPlacement||this.DoRealPlacementChanged()},this.KeyDown=function(t,e){if(pas["WEBLib.Controls"].TControl.KeyDown.apply(this,arguments),!rtl.neSet(e,{})){var i=t.get();27!==i&&115!==i||this.Close()}},this.CloseQuery=function(){var t;return(t=pas["WEBLib.Forms"].TCustomForm.CloseQuery.call(this))&&!(3 in this.FComponentState)&&this.DoBeforeClose(),t},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCCustomPopup",pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.$init.call(this),this.FCloseTime=0,this.FCheckTime=!1,this.FDestroyingPopup=!1,this.FOwner$1=null,this.FPlacementControl=null,this.FPopupForm=null,this.FStaysOpen=!1,this.FPlacement=0,this.FPlacementRectangle=null,this.FHorizontalOffset=0,this.FVerticalOffset=0,this.FDragWithParent=!1,this.FModalResult=0,this.FModal=!1,this.FOnClosePopup=null,this.FOnPopup=null,this.FPopupFormSize=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),this.FContentControl=null,this.FDropDownHeight=0,this.FDropDownWidth=0,this.FFocusable=!1,this.FFocusedControl=null,this.FOnPopupPaint=null,this.FOnPopupShown=null,this.FIsOpen=!1,this.FFillColor=0,this.FStrokeColor=0},this.$final=function(){this.FOwner$1=void 0,this.FPlacementControl=void 0,this.FPopupForm=void 0,this.FPlacementRectangle=void 0,this.FOnClosePopup=void 0,this.FOnPopup=void 0,this.FPopupFormSize=void 0,this.FContentControl=void 0,this.FFocusedControl=void 0,this.FOnPopupPaint=void 0,this.FOnPopupShown=void 0,pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.$final.call(this)},this.SetIsOpen=function(t){if(this.FIsOpen!==t){if(!1,!(null!=pas["WEBLib.Forms"].VSIDE)&&4 in this.FComponentState)return void(this.FIsOpen=!1);t?this.DoCreatePopup(!1):this.HasPopupForm()?this.FPopupForm.Close():this.FIsOpen=t}},this.SetPlacementRectangle=function(t){this.FPlacementRectangle.Assign(t)},this.SetModalResult=function(t){this.FModalResult=t,null!=this.FPopupForm&&this.FPopupForm.SetModalResult(this.FModalResult)},this.SetPlacementControl=function(t){this.FPlacementControl!==t&&(null!==this.FPlacementControl&&this.FPlacementControl.RemoveFreeNotification(this),this.FPlacementControl=t,this.HasPopupForm()&&this.FPopupForm.SetPlacementControl(this.FPlacementControl),null!==this.FPlacementControl&&this.FPlacementControl.FreeNotification(this))},this.SetPlacement=function(t){this.FPlacement!==t&&(this.FPlacement=t,this.HasPopupForm()&&this.FPopupForm.SetPlacement(this.FPlacement))},this.SetDragWithParent=function(t){this.FDragWithParent!==t&&(this.FDragWithParent=t,this.HasPopupForm()&&this.FPopupForm.SetDragWithParent(this.FDragWithParent))},this.BeforeShowProc=function(t){this.FIsOpen=!0,this.DoPopup()},this.BeforeCloseProc=function(t){this.FIsOpen=!1},this.CloseProc=function(t,e){this.ClosePopup()},this.ShowProc=function(t){null!=this.FPopupForm&&this.FPopupForm.FShowModal&&this.HandleFocusedControl(),this.DoPopupShown()},this.DeactivateProc=function(t){3 in this.FComponentState||null==this.FPopupForm||this.FPopupForm.FShowModal||this.FStaysOpen||(this.FPopupForm.SetVisible(!1),this.FPopupForm.Close(),this.FCloseTime=e.GetTickCountX(),this.FCheckTime=!0)},this.UpdatePopupSize=function(){var t=pas["WEBLib.TMSFNCTypes"].TSizeF.$new();null!==this.FPopupForm&&(this.FPopupFormSize.cx>0?t.cx=this.FPopupFormSize.cx:t.cx=this.FDropDownWidth,this.FPopupFormSize.cy>0?t.cy=this.FPopupFormSize.cy:t.cy=this.FDropDownHeight,this.FPopupForm.SetSize(t))},this.SetContentControl=function(t){null===t&&null!=this.FContentControl&&this.FContentControl.SetVisible(!0),this.FContentControl=t,null!=this.FContentControl&&(this.FContentControl.SetVisible(!1),this.SetDropDownWidth(this.FContentControl.GetWidth()),this.SetDropDownHeight(this.FContentControl.GetHeight()))},this.SetDropDownHeight=function(t){this.FDropDownHeight!==t&&(this.FDropDownHeight=t,null!=this.FPopupForm&&this.FPopupForm.SetHeight(Math.round(t)))},this.SetDropDownWidth=function(t){this.FDropDownWidth!==t&&(this.FDropDownWidth=t,null!=this.FPopupForm&&this.FPopupForm.SetWidth(Math.round(t)))},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,0,4)},this.SetAdaptToStyle=function(t){var e=null,i=rtl.createIntfRefs();try{pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.SetAdaptToStyle.apply(this,arguments),null!=this.FContentControl&&pas.SysUtils.Supports$1(i.ref(1,rtl.queryIntfT(this.FContentControl,pas.System.IUnknown)),rtl.getIntfGUIDR(pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),{get:function(){return e},set:function(t){e=t}})&&e.SetAdaptToStyle(this.FAdaptToStyle)}finally{i.free(),rtl._Release(e)}},this.ShowPopup=function(t){t?this.FModalResult=this.FPopupForm.ShowModal():(this.FPopupForm.Show$1(),this.HandleFocusedControl())},this.HandleFocusedControl=function(){var t=null;null!=this.FPopupForm&&null!=this.FFocusedControl&&(this.FPopupForm.FShowModal||null!=(t=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetParentForm(this.FFocusedControl))&&t!==this.FPopupForm&&t.SetFocus(),pas["WEBLib.Controls"].TControl.isPrototypeOf(this.FFocusedControl)&&rtl.as(this.FFocusedControl,pas["WEBLib.Controls"].TControl).CanFocus()&&rtl.as(this.FFocusedControl,pas["WEBLib.Controls"].TControl).SetFocus())},this.FormPaint=function(t){var e=null,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(null!=this.FPopupForm){(e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("Create$1",[this.FPopupForm.GetCanvas(),!1])).BeginScene();try{e.FFill.SetKind(1),e.FStroke.SetKind(1),-1!==this.FFillColor&&-1!==this.FStrokeColor?(e.FFill.SetColor(this.FFillColor),e.FStroke.SetColor(this.FStrokeColor)):(e.FFill.SetColor(pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultPopupFillColor),e.FStroke.SetColor(pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultPopupStrokeColor)),i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.FPopupForm.GetWidth(),this.FPopupForm.GetHeight())),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),2),null!=this.FOnPopupPaint&&this.FOnPopupPaint(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))}finally{e.EndScene(),e=rtl.freeLoc(e)}}},this.DoPopupPaint=function(t,e,i){null!=this.FOnPopupPaint&&this.FOnPopupPaint(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))},this.Notification=function(t,e){pas.Classes.TComponent.Notification.apply(this,arguments),1===e&&(t===this.FContentControl&&(this.FContentControl=null),t===this.FFocusedControl&&(this.FFocusedControl=null),t===this.FPopupForm&&(this.FPopupForm=null),t===this.FPlacementControl&&(this.FPlacementControl=null,this.HasPopupForm()&&this.FPopupForm.SetPlacementControl(null)))},this.MarginsChanged=function(t){null!==this.FPopupForm&&this.FPopupForm.SetPlacementRectangle(this.FPlacementRectangle)},this.DoClosePopup=function(){null!=this.FOnClosePopup&&this.FOnClosePopup(this)},this.DoPopup=function(){null!=this.FOnPopup&&this.FOnPopup(this)},this.DoPopupShown=function(){null!=this.FOnPopupShown&&this.FOnPopupShown(this)},this.ClosePopup=function(){var e=null;this.HasPopupForm()&&!this.FDestroyingPopup&&(this.FDestroyingPopup=!0,this.FModal&&0===this.FModalResult?this.SetModalResult(2):(this.FIsOpen=!1,null!=this.FContentControl&&(e=this.GetParent(),this.FContentControl.SetVisible(!1),null!=e&&pas["WEBLib.Controls"].TWinControl.isPrototypeOf(e)?this.FContentControl.SetParent(rtl.as(e,pas["WEBLib.Controls"].TWinControl)):this.FContentControl.SetParent(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetParentForm(this))),3 in this.FComponentState||this.HasPopupForm()&&(t.TTMSFNCNonFocusablePopup.isPrototypeOf(this)&&rtl.free(this,"FPopupForm"),this.DoClosePopup(),this.FPopupForm=null),this.FDestroyingPopup=!1))},this.DoCreatePopup=function(t){var i=null,s=rtl.createIntfRefs();try{if(e.GetTickCountX()-this.FCloseTime<200&&this.FCheckTime)return void(this.FCheckTime=!1);if(this.FIsOpen)return;this.HasPopupForm()&&this.FPopupForm.Close(),this.FPopupForm=this.CreatePopupForm();try{try{this.FPopupForm.SetFormStyle(1),this.FPopupForm.FOnPaint=rtl.createCallback(this,"FormPaint"),this.FPopupForm.FOnPopupPaint=rtl.createCallback(this,"DoPopupPaint"),this.FPopupForm.FreeNotification(this),this.FPopupForm.SetPlacement(this.FPlacement),this.FPopupForm.SetOffset(pas["WEBLib.TMSFNCTypes"].PointF(this.FHorizontalOffset,this.FVerticalOffset)),this.FPopupForm.SetPlacementRectangle(this.FPlacementRectangle),this.FPopupForm.SetDragWithParent(this.FDragWithParent),this.UpdatePopupSize(),this.FPopupForm.FOnDeactivate=rtl.createCallback(this,"DeactivateProc"),this.FPopupForm.FOnBeforeShow=rtl.createCallback(this,"BeforeShowProc"),this.FPopupForm.FOnBeforeClose=rtl.createCallback(this,"BeforeCloseProc"),this.FPopupForm.FOnClose=rtl.createCallback(this,"CloseProc"),this.FPopupForm.FOnShow=rtl.createCallback(this,"ShowProc"),this.FPopupForm.FShowModal=t,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.ScaleForCurrentDPI(this.FPopupForm),this.FPopupForm.SetContentControl(this.FContentControl),pas.SysUtils.Supports$1(s.ref(1,rtl.queryIntfT(this.FContentControl,pas.System.IUnknown)),rtl.getIntfGUIDR(pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),{get:function(){return i},set:function(t){i=t}})&&i.SetAdaptToStyle(this.FAdaptToStyle),null!=this.FContentControl&&this.FContentControl.SetAlign(5)}finally{}}catch(t){throw pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FPopupForm},set:function(t){this.p.FPopupForm=t}}),t}3 in this.FComponentState||this.FPopupForm.DoBeforeShow(),this.ShowPopup(t)}finally{s.free(),rtl._Release(i)}},this.GetPopupFormClass=function(){return t.TTMSFNCCustomPopupForm},this.GetParent=function(){var t=null;return null==(t=this.FPlacementControl)&&pas["WEBLib.Controls"].TControl.isPrototypeOf(this.FOwner$1)&&(t=rtl.as(this.FOwner$1,pas["WEBLib.Controls"].TControl)),t},this.CreatePopupForm=function(){var t=null,e=null;t=null;try{e=this.GetPopupFormClass(),t=e.$create("Create$7",[this,this.FPlacementControl])}catch(e){throw pas.SysUtils.FreeAndNil({get:function(){return t},set:function(e){t=e}}),e}return t},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.Create$1.call(this,t),this.FOwner$1=t,this.FPlacement=0,this.FFocusable=!0,this.FStaysOpen=!1,this.FPlacementRectangle=pas["WEBLib.TMSFNCTypes"].TTMSFNCMargins.$create("Create$1"),this.FPlacementRectangle.FOnChange=rtl.createCallback(this,"MarginsChanged"),this.FFillColor=-1,this.FStrokeColor=-1,this},this.Assign=function(e){t.TTMSFNCCustomPopup.isPrototypeOf(e)&&(this.FModalResult=rtl.as(e,t.TTMSFNCCustomPopup).FModalResult,this.FPopupFormSize.$assign(rtl.as(e,t.TTMSFNCCustomPopup).FPopupFormSize),this.FDragWithParent=rtl.as(e,t.TTMSFNCCustomPopup).FDragWithParent,this.FStaysOpen=rtl.as(e,t.TTMSFNCCustomPopup).FStaysOpen,this.FDropDownHeight=rtl.as(e,t.TTMSFNCCustomPopup).FDropDownHeight,this.FDropDownWidth=rtl.as(e,t.TTMSFNCCustomPopup).FDropDownWidth,this.FHorizontalOffset=rtl.as(e,t.TTMSFNCCustomPopup).FHorizontalOffset,this.FPlacementControl=rtl.as(e,t.TTMSFNCCustomPopup).FPlacementControl,this.FPlacement=rtl.as(e,t.TTMSFNCCustomPopup).FPlacement,this.FPlacementRectangle.Assign(rtl.as(e,t.TTMSFNCCustomPopup).FPlacementRectangle),this.FVerticalOffset=rtl.as(e,t.TTMSFNCCustomPopup).FVerticalOffset,this.FFocusedControl=rtl.as(e,t.TTMSFNCCustomPopup).FFocusedControl,this.FContentControl=rtl.as(e,t.TTMSFNCCustomPopup).FContentControl)},this.Destroy=function(){this.FContentControl=null,this.ClosePopup(),this.HasPopupForm()&&pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FPopupForm},set:function(t){this.p.FPopupForm=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FPlacementRectangle},set:function(t){this.p.FPlacementRectangle=t}}),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.HasPopupForm=function(){return null!==this.FPopupForm},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCPopup",this.TTMSFNCCustomPopup,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCPopup)},this.Popup=function(t){this.DoCreatePopup(t)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("StaysOpen",0,rtl.boolean,"FStaysOpen","FStaysOpen",{Default:!1}),e.addProperty("DropDownHeight",2,rtl.double,"FDropDownHeight","SetDropDownHeight"),e.addProperty("DropDownWidth",2,rtl.double,"FDropDownWidth","SetDropDownWidth"),e.addProperty("HorizontalOffset",0,rtl.double,"FHorizontalOffset","FHorizontalOffset"),e.addProperty("Placement",2,t.$rtti.TTMSFNCPopupPlacement,"FPlacement","SetPlacement",{Default:t.TTMSFNCPopupPlacement.ppBottom}),e.addProperty("PlacementRectangle",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCMargins,"FPlacementRectangle","SetPlacementRectangle"),e.addProperty("PlacementControl",2,pas["WEBLib.Controls"].$rtti.TControl,"FPlacementControl","SetPlacementControl"),e.addProperty("VerticalOffset",0,rtl.double,"FVerticalOffset","FVerticalOffset"),e.addProperty("FocusedControl",0,pas["WEBLib.Controls"].$rtti.TControl,"FFocusedControl","FFocusedControl"),e.addProperty("ContentControl",2,pas["WEBLib.Controls"].$rtti.TControl,"FContentControl","SetContentControl"),e.addProperty("OnClosePopup",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClosePopup","FOnClosePopup"),e.addProperty("OnPopupPaint",0,t.$rtti.TTMSFNCPopupPaint,"FOnPopupPaint","FOnPopupPaint"),e.addProperty("OnPopup",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnPopup","FOnPopup"),e.addProperty("OnPopupShown",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnPopupShown","FOnPopupShown"),e.addProperty("Version",1,rtl.string,"GetVersion",""),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),rtl.createClass(this,"TTMSFNCCustomNonFocusablePopupForm",this.TTMSFNCCustomPopupForm,(function(){this.UpdateBounds=function(e){t.TTMSFNCCustomPopupForm.UpdateBounds.apply(this,arguments)},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCCustomNonFocusablePopup",this.TTMSFNCCustomPopup,(function(){this.ShowPopup=function(e){t.TTMSFNCCustomPopup.ShowPopup.apply(this,arguments),this.FIsOpen=!0},this.GetPopupFormClass=function(){return t.TTMSFNCCustomNonFocusablePopupForm},this.Create$1=function(e){return t.TTMSFNCCustomPopup.Create$1.apply(this,arguments),this.FStaysOpen=!0,this},this.Destroy=function(){t.TTMSFNCCustomPopup.Destroy.call(this)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCNonFocusablePopup",this.TTMSFNCCustomNonFocusablePopup,(function(){this.Deactivate=function(){this.ClosePopup()},this.Activate=function(){this.DoCreatePopup(!1)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("ContentControl",2,pas["WEBLib.Controls"].$rtti.TControl,"FContentControl","SetContentControl"),e.addProperty("Placement",2,t.$rtti.TTMSFNCPopupPlacement,"FPlacement","SetPlacement",{Default:t.TTMSFNCPopupPlacement.ppBottom}),e.addProperty("PlacementRectangle",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCMargins,"FPlacementRectangle","SetPlacementRectangle"),e.addProperty("PlacementControl",2,pas["WEBLib.Controls"].$rtti.TControl,"FPlacementControl","SetPlacementControl")})),t.$implcode=function(){e.GetTickCountX=function(){var t=0,e=0,i=0,s=0;return pas.SysUtils.DecodeTime(pas.SysUtils.Now(),{get:function(){return t},set:function(e){t=e}},{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),s+1e3*i+60*e*1e3+60*t*60*1e3}}}),["SysUtils","WEBLib.TMSFNCUtils","Math","WEBLib.TMSFNCStyles","Web"]),rtl.module("WEBLib.TMSFNCImage",["System","Classes","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=0,this.BLD_VER=1,rtl.createClass(this,"TTMSFNCCustomImage",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FBitmap=null,this.FBitmapContainer=null,this.FStretch=!1,this.FBitmaps=null,this.FCropping=!1,this.FCenter=!1,this.FAutoSize=!1,this.FAspectRatio=!1,this.FOnBitmapChanged=null,this.FBitmapMargins=null},this.$final=function(){this.FBitmap=void 0,this.FBitmapContainer=void 0,this.FBitmaps=void 0,this.FOnBitmapChanged=void 0,this.FBitmapMargins=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,this.ApplyAutoSize(),this.Invalidate()},this.SetBitmaps=function(t){this.FBitmaps.Assign(t),this.Invalidate()},this.SetBitmap=function(t){this.FBitmap.Assign(t),this.Invalidate()},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetBitmapMargins=function(t){this.FBitmapMargins.Assign(t)},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,0,1)},this.ApplyAutoSize=function(){var t=null;null!=(t=this.GetBitmap())&&this.FAutoSize&&!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(t)&&(this.SetWidth(Math.round(t.GetWidth()+this.FBitmapMargins.FLeft+this.FBitmapMargins.FRight)),this.SetHeight(Math.round(t.GetHeight()+this.FBitmapMargins.FTop+this.FBitmapMargins.FBottom)))},this.BitmapMarginsChanged=function(t){this.ApplyAutoSize(),this.Invalidate()},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null)},this.BitmapChanged=function(t){null!=this.FOnBitmapChanged&&this.FOnBitmapChanged(this),this.ApplyAutoSize(),this.Invalidate()},this.SetStretch=function(t){this.FStretch=t,this.Invalidate()},this.SetCropping=function(t){this.FCropping=t,this.Invalidate()},this.SetCenter=function(t){this.FCenter=t,this.Invalidate()},this.SetAS=function(t){this.FAutoSize=t,this.ApplyAutoSize(),this.Invalidate()},this.SetAspectRatio=function(t){this.FAspectRatio=t,this.Invalidate()},this.GetBitmap=function(){return pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FBitmap)?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FBitmaps,0,this.FBitmapContainer):this.FBitmap},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.IsDesignTime()&&this.DisableBackground(),this.FBitmapMargins=pas["WEBLib.TMSFNCTypes"].TTMSFNCMargins.$create("Create$1"),this.FBitmapMargins.FOnChange=rtl.createCallback(this,"BitmapMarginsChanged"),this.FCenter=!0,this.FStretch=!1,this.FAspectRatio=!0,this.FCropping=!1,this.FBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FBitmaps.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FBitmap.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.SetWidth(100),this.SetHeight(100),this},this.Destroy=function(){rtl.free(this,"FBitmap"),rtl.free(this,"FBitmaps"),rtl.free(this,"FBitmapMargins"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Draw=function(t,e){var i=null;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),4 in this.FComponentState&&(t.FStroke.SetKind(3),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),2)),null!=(i=this.GetBitmap())&&(e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+this.FBitmapMargins.FLeft,e.Top+this.FBitmapMargins.FTop,e.Right-this.FBitmapMargins.FRight,e.Bottom-this.FBitmapMargins.FBottom)),t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,this.FAspectRatio,this.FStretch,this.FCenter,this.FCropping))},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCImage",this.TTMSFNCCustomImage,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCImage)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("AspectRatio",2,rtl.boolean,"FAspectRatio","SetAspectRatio",{Default:!0}),e.addProperty("Bitmap",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FBitmap","SetBitmap"),e.addProperty("BitmapMargins",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCMargins,"FBitmapMargins","SetBitmapMargins"),e.addProperty("Version",1,rtl.string,"GetVersion",""),e.addProperty("Bitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FBitmaps","SetBitmaps"),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("Stretch",2,rtl.boolean,"FStretch","SetStretch",{Default:!1}),e.addProperty("Cropping",2,rtl.boolean,"FCropping","SetCropping",{Default:!1}),e.addProperty("Center",2,rtl.boolean,"FCenter","SetCenter",{Default:!0}),e.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAS",{Default:!1}),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["WEBLib.Controls","WEBLib.Graphics","WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCCustomTreeView",["System","Classes","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCCustomComponent","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCPopup","WEBLib.TMSFNCImage","Types","WEBLib.TMSFNCTypes","WEBLib.Controls","WEBLib.ExtCtrls","WEBLib.StdCtrls","WEBLib.TMSFNCGraphicsTypes","contnrs","Web","WEBLib.JSON"],(function(){"use strict";var t=this,e=t.$impl;this.MAJ_VER=1,this.MIN_VER=1,this.REL_VER=9,this.BLD_VER=1,this.CLP_FMT="#TREEVIEW#",this.ENDOFLINE="\r\n",this.DRAGMARGIN=10,this.SCROLLINGDELAY=0,this.TTMSFNCTreeViewColorExtended=16053492,this.TTMSFNCTreeViewColorSelection=16297243,rtl.createClass(this,"TTMSFNCTreeViewCache",pas.contnrs.TObjectList,(function(){this.GetItem$1=function(t){return this.GetItem(t)}})),rtl.createClass(this,"TTMSFNCTreeViewNodeCache",this.TTMSFNCTreeViewCache,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewColumnsCache",this.TTMSFNCTreeViewCache,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewColumnsTopCache",this.TTMSFNCTreeViewColumnsCache,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewColumnsBottomCache",this.TTMSFNCTreeViewColumnsCache,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewGroupsCache",this.TTMSFNCTreeViewCache,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewGroupsTopCache",this.TTMSFNCTreeViewGroupsCache,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewGroupsBottomCache",this.TTMSFNCTreeViewGroupsCache,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewDisplayList",pas.Classes.TList,(function(){this.GetItem=function(t){return rtl.getObject(this.Get(t))}})),rtl.createClass(this,"TTMSFNCTreeViewNodeDisplayList",this.TTMSFNCTreeViewDisplayList,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewColumnsDisplayList",this.TTMSFNCTreeViewDisplayList,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewColumnsTopDisplayList",this.TTMSFNCTreeViewColumnsDisplayList,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewColumnsBottomDisplayList",this.TTMSFNCTreeViewColumnsDisplayList,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewGroupsDisplayList",this.TTMSFNCTreeViewDisplayList,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewGroupsTopDisplayList",this.TTMSFNCTreeViewGroupsDisplayList,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewGroupsBottomDisplayList",this.TTMSFNCTreeViewGroupsDisplayList,(function(){})),this.TTMSFNCTreeViewColumnsLayout={0:"tclTop",tclTop:0,1:"tclBottom",tclBottom:1},this.$rtti.$Enum("TTMSFNCTreeViewColumnsLayout",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTreeViewColumnsLayout}),this.$rtti.$Set("TTMSFNCTreeViewColumnsLayouts",{comptype:this.$rtti.TTMSFNCTreeViewColumnsLayout}),this.TTMSFNCTreeViewGroupLayout={0:"tglTop",tglTop:0,1:"tglBottom",tglBottom:1},this.$rtti.$Enum("TTMSFNCTreeViewGroupLayout",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTreeViewGroupLayout}),this.$rtti.$Set("TTMSFNCTreeViewGroupsLayouts",{comptype:this.$rtti.TTMSFNCTreeViewGroupLayout}),this.TTMSFNCTreeViewNodeHeightMode={0:"tnhmFixed",tnhmFixed:0,1:"tnhmVariable",tnhmVariable:1},this.$rtti.$Enum("TTMSFNCTreeViewNodeHeightMode",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTreeViewNodeHeightMode}),this.TTMSFNCTreeViewSelectionArea={0:"tsaDefault",tsaDefault:0,1:"tsaFull",tsaFull:1,2:"tsaFromLevel",tsaFromLevel:2,3:"tsaFromText",tsaFromText:3},this.$rtti.$Enum("TTMSFNCTreeViewSelectionArea",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCTreeViewSelectionArea}),rtl.createClass(this,"TTMSFNCTreeViewNodesAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTreeView=null,this.FFill=null,this.FStroke=null,this.FFont=null,this.FDisabledFill=null,this.FSelectedFill=null,this.FDisabledStroke=null,this.FSelectedStroke=null,this.FSelectionArea=0,this.FExpandColumn=0,this.FExpandWidth=0,this.FExpandHeight=0,this.FLevelIndent=0,this.FHeightMode=0,this.FFixedHeight=0,this.FVariableMinimumHeight=0,this.FSelectedFontColor=0,this.FDisabledFontColor=0,this.FExtendedFontColor=0,this.FExtendedSelectedFontColor=0,this.FExtendedDisabledFontColor=0,this.FExtendedDisabledFill=null,this.FExtendedFont=null,this.FExtendedSelectedFill=null,this.FExtendedDisabledStroke=null,this.FExtendedSelectedStroke=null,this.FExtendedFill=null,this.FExtendedStroke=null,this.FShowLines=!1,this.FExpandNodeIcon=null,this.FCollapseNodeIcon=null,this.FExpandNodeIconLarge=null,this.FCollapseNodeIconLarge=null,this.FColumnStroke=null,this.FLineStroke=null,this.FShowFocus=!1,this.FSpacing=0,this.FDisabledTitleFontColor=0,this.FSelectedTitleFontColor=0,this.FTitleFont=null},this.$final=function(){this.FTreeView=void 0,this.FFill=void 0,this.FStroke=void 0,this.FFont=void 0,this.FDisabledFill=void 0,this.FSelectedFill=void 0,this.FDisabledStroke=void 0,this.FSelectedStroke=void 0,this.FExtendedDisabledFill=void 0,this.FExtendedFont=void 0,this.FExtendedSelectedFill=void 0,this.FExtendedDisabledStroke=void 0,this.FExtendedSelectedStroke=void 0,this.FExtendedFill=void 0,this.FExtendedStroke=void 0,this.FExpandNodeIcon=void 0,this.FCollapseNodeIcon=void 0,this.FExpandNodeIconLarge=void 0,this.FCollapseNodeIconLarge=void 0,this.FColumnStroke=void 0,this.FLineStroke=void 0,this.FTitleFont=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill!==t&&this.FFill.Assign(t)},this.SetStroke=function(t){this.FStroke!==t&&this.FStroke.Assign(t)},this.SetFont=function(t){this.FFont!==t&&this.FFont.Assign(t)},this.SetDisabledFill=function(t){this.FDisabledFill!==t&&this.FDisabledFill.Assign(t)},this.SetDisabledStroke=function(t){this.FDisabledStroke!==t&&this.FDisabledStroke.Assign(t)},this.SetSelectedFill=function(t){this.FSelectedFill!==t&&this.FSelectedFill.Assign(t)},this.SetSelectedStroke=function(t){this.FSelectedStroke!==t&&this.FSelectedStroke.Assign(t)},this.SetSelectionArea=function(t){this.FSelectionArea!==t&&(this.FSelectionArea=t,this.FTreeView.Invalidate())},this.SetExtendedFill=function(t){this.FExtendedFill!==t&&this.FExtendedFill.Assign(t)},this.SetExtendedStroke=function(t){this.FExtendedStroke!==t&&this.FExtendedStroke.Assign(t)},this.SetExtendedFont=function(t){this.FExtendedFont!==t&&this.FExtendedFont.Assign(t)},this.SetExtendedDisabledFill=function(t){this.FExtendedDisabledFill!==t&&this.FExtendedDisabledFill.Assign(t)},this.SetExtendedDisabledStroke=function(t){this.FExtendedDisabledStroke!==t&&this.FExtendedDisabledStroke.Assign(t)},this.SetExtendedSelectedFill=function(t){this.FExtendedSelectedFill!==t&&this.FExtendedSelectedFill.Assign(t)},this.SetExtendedSelectedStroke=function(t){this.FExtendedSelectedStroke!==t&&this.FExtendedSelectedStroke.Assign(t)},this.SetExpandColumn=function(t){this.FExpandColumn!==t&&(this.FExpandColumn=t,this.Changed(this))},this.SetExpandWidth=function(t){this.FExpandWidth!==t&&(this.FExpandWidth=t,this.Changed(this))},this.SetExpandHeight=function(t){this.FExpandHeight!==t&&(this.FExpandHeight=t,this.Changed(this))},this.SetLevelIndent=function(t){this.FLevelIndent!==t&&(this.FLevelIndent=t,this.Changed(this))},this.SetFixedHeight=function(t){this.FFixedHeight!==t&&(this.FFixedHeight=t,this.Changed(this))},this.SetVariableMinimumHeight=function(t){this.FVariableMinimumHeight!==t&&(this.FVariableMinimumHeight=t,this.Changed(this))},this.SetSelectedFontColor=function(t){this.FSelectedFontColor!==t&&(this.FSelectedFontColor=t,this.Changed(this))},this.SetDisabledFontColor=function(t){this.FDisabledFontColor!==t&&(this.FDisabledFontColor=t,this.Changed(this))},this.SetExtendedFontColor=function(t){this.FExtendedFontColor!==t&&(this.FExtendedFontColor=t,this.Changed(this))},this.SetExtendedSelectedFontColor=function(t){this.FExtendedSelectedFontColor!==t&&(this.FExtendedSelectedFontColor=t,this.Changed(this))},this.SetExtendedDisabledFontColor=function(t){this.FExtendedDisabledFontColor!==t&&(this.FExtendedDisabledFontColor=t,this.Changed(this))},this.SetHeightMode=function(t){this.FHeightMode!==t&&(this.FHeightMode=t,this.Changed(this))},this.SetShowLines=function(t){this.FShowLines!==t&&(this.FShowLines=t,this.Changed(this))},this.SetCollapseNodeIcon=function(t){this.FCollapseNodeIcon!==t&&(this.FCollapseNodeIcon.Assign(t),this.Changed(this))},this.SetExpandNodeIcon=function(t){this.FExpandNodeIcon!==t&&(this.FExpandNodeIcon.Assign(t),this.Changed(this))},this.SetCollapseNodeIconLarge=function(t){this.FCollapseNodeIconLarge!==t&&(this.FCollapseNodeIconLarge.Assign(t),this.Changed(this))},this.SetExpandNodeIconLarge=function(t){this.FExpandNodeIconLarge!==t&&(this.FExpandNodeIconLarge.Assign(t),this.Changed(this))},this.SetColumnStroke=function(t){this.FColumnStroke!==t&&this.FColumnStroke.Assign(t)},this.SetLineStroke=function(t){this.FLineStroke!==t&&this.FLineStroke.Assign(t)},this.SetShowFocus=function(t){this.FShowFocus!==t&&(this.FShowFocus=t,this.FTreeView.Invalidate())},this.IsSpacingStored=function(){return 0!==this.FSpacing},this.SetSpacing=function(t){this.FSpacing!==t&&(this.FSpacing=t,this.Changed(this))},this.SetDisabledTitleFontColor=function(t){this.FDisabledTitleFontColor!==t&&(this.FDisabledTitleFontColor=t,this.FTreeView.Invalidate())},this.SetSelectedTitleFontColor=function(t){this.FSelectedTitleFontColor!==t&&(this.FSelectedTitleFontColor=t,this.FTreeView.Invalidate())},this.SetTitleFont=function(t){this.FTitleFont!==t&&this.FTitleFont.Assign(t)},this.Changed=function(t){this.FTreeView.UpdateTreeViewCache()},this.BitmapChanged=function(t){this.FTreeView.UpdateTreeViewCache()},this.Create$1=function(e){return this.FTreeView=e,this.FShowFocus=!0,this.FSelectionArea=3,this.FExpandColumn=0,this.FExpandWidth=15,this.FExpandHeight=15,this.FFixedHeight=25,this.FVariableMinimumHeight=25,this.FShowLines=!0,this.FHeightMode=0,this.FLevelIndent=20,this.FSpacing=0,this.FSelectedFontColor=16777215,this.FDisabledFontColor=12632256,this.FSelectedTitleFontColor=16777215,this.FDisabledTitleFontColor=12632256,this.FExtendedFontColor=0,this.FExtendedSelectedFontColor=16777215,this.FExtendedDisabledFontColor=12632256,this.FColumnStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,-1]),this.FLineStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[3,11119017]),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,-1,8421504,-1,-1]),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[0,11119017]),this.FSelectedFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16297243,8421504,-1,-1]),this.FSelectedStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,16297243]),this.FDisabledFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,11119017,8421504,-1,-1]),this.FDisabledStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[0,11119017]),this.FExtendedFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16053492,8421504,-1,-1]),this.FExtendedStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FExtendedSelectedFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16297243,8421504,-1,-1]),this.FExtendedSelectedStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[0,11119017]),this.FExtendedDisabledFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,11119017,8421504,-1,-1]),this.FExtendedDisabledStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[0,11119017]),this.FExpandNodeIcon=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TTMSFNCTREEVIEWEXPAND,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FExpandNodeIcon.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FCollapseNodeIcon=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TTMSFNCTREEVIEWCOLLAPSE,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FExpandNodeIcon.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FExpandNodeIconLarge=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TTMSFNCTREEVIEWEXPANDLARGE,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FExpandNodeIconLarge.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FCollapseNodeIconLarge=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TTMSFNCTREEVIEWCOLLAPSELARGE,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FCollapseNodeIconLarge.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),null!=this.FTreeView&&this.FTreeView.IsDesignTime()&&this.FFont.SetColor(0),this.FTitleFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),null!=this.FTreeView&&this.FTreeView.IsDesignTime()&&this.FTitleFont.SetColor(0),this.FFill.FOnChanged=rtl.createCallback(this,"Changed"),this.FStroke.FOnChanged=rtl.createCallback(this,"Changed"),this.FSelectedFill.FOnChanged=rtl.createCallback(this,"Changed"),this.FSelectedStroke.FOnChanged=rtl.createCallback(this,"Changed"),this.FDisabledFill.FOnChanged=rtl.createCallback(this,"Changed"),this.FDisabledStroke.FOnChanged=rtl.createCallback(this,"Changed"),this.FExtendedFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FExtendedFill.FOnChanged=rtl.createCallback(this,"Changed"),this.FExtendedStroke.FOnChanged=rtl.createCallback(this,"Changed"),this.FExtendedSelectedFill.FOnChanged=rtl.createCallback(this,"Changed"),this.FExtendedSelectedStroke.FOnChanged=rtl.createCallback(this,"Changed"),this.FExtendedDisabledFill.FOnChanged=rtl.createCallback(this,"Changed"),this.FExtendedDisabledStroke.FOnChanged=rtl.createCallback(this,"Changed"),this.FFont.FOnChanged=rtl.createCallback(this,"Changed"),this.FExtendedFont.FOnChanged=rtl.createCallback(this,"Changed"),this},this.Assign=function(e){t.TTMSFNCTreeViewNodesAppearance.isPrototypeOf(e)&&(this.FFill.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FStroke),this.FFont.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FFont),this.FTitleFont.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FTitleFont),this.FSelectedFill.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FSelectedFill),this.FSelectedStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FSelectedStroke),this.FDisabledFill.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FDisabledFill),this.FDisabledStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FDisabledStroke),this.FExtendedFill.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExtendedFill),this.FExtendedStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExtendedStroke),this.FExtendedFont.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExtendedFont),this.FExtendedSelectedFill.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExtendedSelectedFill),this.FExtendedSelectedStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExtendedSelectedStroke),this.FExtendedDisabledFill.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExtendedDisabledFill),this.FExtendedDisabledStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExtendedDisabledStroke),this.FExpandColumn=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExpandColumn,this.FExpandWidth=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExpandWidth,this.FExpandHeight=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExpandHeight,this.FFixedHeight=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FFixedHeight,this.FVariableMinimumHeight=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FVariableMinimumHeight,this.FSelectedFontColor=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FSelectedFontColor,this.FDisabledFontColor=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FDisabledFontColor,this.FSelectedTitleFontColor=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FSelectedTitleFontColor,this.FDisabledTitleFontColor=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FDisabledTitleFontColor,this.FExtendedFontColor=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExtendedFontColor,this.FExtendedSelectedFontColor=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExtendedSelectedFontColor,this.FExtendedDisabledFontColor=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FExtendedDisabledFontColor,this.FLevelIndent=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FLevelIndent,this.FSpacing=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FSpacing,this.FHeightMode=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FHeightMode,this.FShowLines=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FShowLines,this.FShowFocus=rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FShowFocus,this.FColumnStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FColumnStroke),this.FLineStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewNodesAppearance).FLineStroke))},this.Destroy=function(){rtl.free(this,"FLineStroke"),rtl.free(this,"FColumnStroke"),rtl.free(this,"FExpandNodeIconLarge"),rtl.free(this,"FCollapseNodeIconLarge"),rtl.free(this,"FExpandNodeIcon"),rtl.free(this,"FCollapseNodeIcon"),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FFont"),rtl.free(this,"FTitleFont"),rtl.free(this,"FSelectedFill"),rtl.free(this,"FSelectedStroke"),rtl.free(this,"FDisabledFill"),rtl.free(this,"FDisabledStroke"),rtl.free(this,"FExtendedFill"),rtl.free(this,"FExtendedStroke"),rtl.free(this,"FExtendedFont"),rtl.free(this,"FExtendedSelectedFill"),rtl.free(this,"FExtendedSelectedStroke"),rtl.free(this,"FExtendedDisabledFill"),rtl.free(this,"FExtendedDisabledStroke"),pas.System.TObject.Destroy.call(this)};var e=this.$rtti;e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!0}),e.addProperty("ExpandColumn",2,rtl.longint,"FExpandColumn","SetExpandColumn",{Default:0}),e.addProperty("ExpandWidth",2,rtl.double,"FExpandWidth","SetExpandWidth"),e.addProperty("ExpandHeight",2,rtl.double,"FExpandHeight","SetExpandHeight"),e.addProperty("LevelIndent",2,rtl.double,"FLevelIndent","SetLevelIndent"),e.addProperty("Spacing",14,rtl.double,"FSpacing","SetSpacing",{stored:"IsSpacingStored"}),e.addProperty("FixedHeight",2,rtl.double,"FFixedHeight","SetFixedHeight"),e.addProperty("VariableMinimumHeight",2,rtl.double,"FVariableMinimumHeight","SetVariableMinimumHeight"),e.addProperty("HeightMode",2,t.$rtti.TTMSFNCTreeViewNodeHeightMode,"FHeightMode","SetHeightMode",{Default:t.TTMSFNCTreeViewNodeHeightMode.tnhmFixed}),e.addProperty("ShowLines",2,rtl.boolean,"FShowLines","SetShowLines",{Default:!0}),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("ColumnStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FColumnStroke","SetColumnStroke"),e.addProperty("LineStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FLineStroke","SetLineStroke"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("TitleFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FTitleFont","SetTitleFont"),e.addProperty("SelectedFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FSelectedFontColor","SetSelectedFontColor",{Default:16777215}),e.addProperty("DisabledFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDisabledFontColor","SetDisabledFontColor",{Default:12632256}),e.addProperty("SelectedTitleFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FSelectedTitleFontColor","SetSelectedTitleFontColor",{Default:16777215}),e.addProperty("DisabledTitleFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDisabledTitleFontColor","SetDisabledTitleFontColor",{Default:12632256}),e.addProperty("ExtendedFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FExtendedFontColor","SetExtendedFontColor",{Default:0}),e.addProperty("ExtendedSelectedFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FExtendedSelectedFontColor","SetExtendedSelectedFontColor",{Default:16777215}),e.addProperty("ExtendedDisabledFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FExtendedDisabledFontColor","SetExtendedDisabledFontColor",{Default:12632256}),e.addProperty("SelectedFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FSelectedFill","SetSelectedFill"),e.addProperty("SelectedStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FSelectedStroke","SetSelectedStroke"),e.addProperty("SelectionArea",2,t.$rtti.TTMSFNCTreeViewSelectionArea,"FSelectionArea","SetSelectionArea",{Default:t.TTMSFNCTreeViewSelectionArea.tsaFromText}),e.addProperty("DisabledFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDisabledFill","SetDisabledFill"),e.addProperty("DisabledStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDisabledStroke","SetDisabledStroke"),e.addProperty("ExtendedFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FExtendedFill","SetExtendedFill"),e.addProperty("ExtendedStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FExtendedStroke","SetExtendedStroke"),e.addProperty("ExtendedFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FExtendedFont","SetExtendedFont"),e.addProperty("ExtendedSelectedFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FExtendedSelectedFill","SetExtendedSelectedFill"),e.addProperty("ExtendedSelectedStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FExtendedSelectedStroke","SetExtendedSelectedStroke"),e.addProperty("ExtendedDisabledFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FExtendedDisabledFill","SetExtendedDisabledFill"),e.addProperty("ExtendedDisabledStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FExtendedDisabledStroke","SetExtendedDisabledStroke"),e.addProperty("ExpandNodeIcon",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FExpandNodeIcon","SetExpandNodeIcon"),e.addProperty("CollapseNodeIcon",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FCollapseNodeIcon","SetCollapseNodeIcon"),e.addProperty("ExpandNodeIconLarge",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FExpandNodeIconLarge","SetExpandNodeIconLarge"),e.addProperty("CollapseNodeIconLarge",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FCollapseNodeIconLarge","SetCollapseNodeIconLarge")})),rtl.createClass(this,"TTMSFNCTreeViewColumnsAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTreeView=null,this.FLayouts={},this.FStretch=!1,this.FStretchColumn=0,this.FStretchAll=!1,this.FBottomSize=0,this.FTopSize=0,this.FBottomFill=null,this.FBottomStroke=null,this.FTopFill=null,this.FTopStroke=null,this.FTopFont=null,this.FBottomFont=null,this.FTopVerticalTextAlign=0,this.FTopHorizontalTextAlign=0,this.FBottomHorizontalTextAlign=0,this.FBottomVerticalTextAlign=0,this.FTopVerticalText=!1,this.FBottomVerticalText=!1,this.FFillEmptySpaces=!1,this.FSortIndicatorColor=0,this.FOptimizedColumnDisplay=!1},this.$final=function(){this.FTreeView=void 0,this.FLayouts=void 0,this.FBottomFill=void 0,this.FBottomStroke=void 0,this.FTopFill=void 0,this.FTopStroke=void 0,this.FTopFont=void 0,this.FBottomFont=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetLayouts=function(t){rtl.neSet(this.FLayouts,t)&&(this.FLayouts=rtl.refSet(t),this.FTreeView.UpdateTreeViewCache())},this.SetStretch=function(t){this.FStretch!==t&&(this.FStretch=t,this.FTreeView.UpdateColumns(),this.FTreeView.UpdateTreeViewCache())},this.SetStretchAll=function(t){this.FStretchAll!==t&&(this.FStretchAll=t,this.FTreeView.UpdateColumns(),this.FTreeView.UpdateTreeViewCache())},this.SetStretchColumn=function(t){this.FStretchColumn!==t&&(this.FStretchColumn=t,this.FTreeView.UpdateColumns(),this.FTreeView.UpdateTreeViewCache())},this.SetBottomSize=function(t){this.FBottomSize!==t&&(this.FBottomSize=t,this.FTreeView.UpdateTreeViewCache())},this.SetTopSize=function(t){this.FTopSize!==t&&(this.FTopSize=t,this.Changed(this))},this.SetBottomFill=function(t){this.FBottomFill!==t&&this.FBottomFill.Assign(t)},this.SetBottomStroke=function(t){this.FBottomStroke!==t&&this.FBottomStroke.Assign(t)},this.SetTopFill=function(t){this.FTopFill!==t&&this.FTopFill.Assign(t)},this.SetTopStroke=function(t){this.FTopStroke!==t&&this.FTopStroke.Assign(t)},this.SetBottomFont=function(t){this.FBottomFont!==t&&this.FBottomFont.Assign(t)},this.SetTopFont=function(t){this.FTopFont!==t&&this.FTopFont.Assign(t)},this.SetTopVerticalText=function(t){this.FTopVerticalText!==t&&(this.FTopVerticalText=t,this.Changed(this))},this.SetBottomVerticalText=function(t){this.FBottomVerticalText!==t&&(this.FBottomVerticalText=t,this.Changed(this))},this.SetFillEmptySpaces=function(t){this.FFillEmptySpaces!==t&&(this.FFillEmptySpaces=t,this.FTreeView.Invalidate())},this.SetSortIndicatorColor=function(t){this.FSortIndicatorColor!==t&&(this.FSortIndicatorColor=t,this.FTreeView.Invalidate())},this.SetOptimizedColumnDisplay=function(t){this.FOptimizedColumnDisplay!==t&&(this.FOptimizedColumnDisplay=t,this.FTreeView.UpdateColumns(),this.FTreeView.UpdateTreeViewCache())},this.Changed=function(t){this.FTreeView.UpdateTreeViewCache()},this.Create$1=function(t){return this.FTreeView=t,this.FSortIndicatorColor=11829830,this.FLayouts=rtl.createSet(0),this.FFillEmptySpaces=!0,this.FOptimizedColumnDisplay=!0,this.FStretch=!0,this.FStretchAll=!0,this.FStretchColumn=-1,this.FBottomSize=25,this.FTopVerticalText=!1,this.FStretchAll=!0,this.FBottomVerticalText=!1,this.FTopSize=25,this.FTopHorizontalTextAlign=0,this.FTopVerticalTextAlign=0,this.FBottomHorizontalTextAlign=0,this.FBottomVerticalTextAlign=0,this.FBottomFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FBottomStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FTopFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FTopStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FTopFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FTopFont.SetColor(0),this.FBottomFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FBottomFont.SetColor(0),this.FBottomFill.FOnChanged=rtl.createCallback(this,"Changed"),this.FTopFill.FOnChanged=rtl.createCallback(this,"Changed"),this.FBottomStroke.FOnChanged=rtl.createCallback(this,"Changed"),this.FTopStroke.FOnChanged=rtl.createCallback(this,"Changed"),this.FTopFont.FOnChanged=rtl.createCallback(this,"Changed"),this.FBottomFont.FOnChanged=rtl.createCallback(this,"Changed"),this},this.Destroy=function(){rtl.free(this,"FTopFont"),rtl.free(this,"FBottomFont"),rtl.free(this,"FBottomFill"),rtl.free(this,"FTopFill"),rtl.free(this,"FBottomStroke"),rtl.free(this,"FTopStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCTreeViewColumnsAppearance.isPrototypeOf(e)&&(this.FSortIndicatorColor=rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FSortIndicatorColor,this.FLayouts=rtl.refSet(rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FLayouts),this.FTopSize=rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FTopSize,this.FBottomSize=rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FBottomSize,this.FBottomFill.Assign(rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FBottomFill),this.FBottomFont.Assign(rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FBottomFont),this.FBottomStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FBottomStroke),this.FTopFill.Assign(rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FTopFill),this.FTopStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FTopStroke),this.FTopFont.Assign(rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FTopFont),this.FStretch=rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FStretch,this.FOptimizedColumnDisplay=rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FOptimizedColumnDisplay,this.FStretchColumn=rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FStretchColumn,this.FStretchAll=rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FStretchAll,this.FTopVerticalText=rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FTopVerticalText,this.FBottomVerticalText=rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FBottomVerticalText,this.FFillEmptySpaces=rtl.as(e,t.TTMSFNCTreeViewColumnsAppearance).FFillEmptySpaces)};var e=this.$rtti;e.addProperty("Layouts",2,t.$rtti.TTMSFNCTreeViewColumnsLayouts,"FLayouts","SetLayouts",{Default:rtl.createSet(0)}),e.addProperty("Stretch",2,rtl.boolean,"FStretch","SetStretch",{Default:!0}),e.addProperty("StretchColumn",2,rtl.longint,"FStretchColumn","SetStretchColumn",{Default:-1}),e.addProperty("StretchAll",2,rtl.boolean,"FStretchAll","SetStretchAll",{Default:!0}),e.addProperty("TopSize",2,rtl.double,"FTopSize","SetTopSize"),e.addProperty("BottomSize",2,rtl.double,"FBottomSize","SetBottomSize"),e.addProperty("TopFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FTopFont","SetTopFont"),e.addProperty("BottomFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FBottomFont","SetBottomFont"),e.addProperty("TopFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FTopFill","SetTopFill"),e.addProperty("BottomFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FBottomFill","SetBottomFill"),e.addProperty("TopStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FTopStroke","SetTopStroke"),e.addProperty("BottomStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FBottomStroke","SetBottomStroke"),e.addProperty("TopVerticalText",2,rtl.boolean,"FTopVerticalText","SetTopVerticalText",{Default:!1}),e.addProperty("BottomVerticalText",2,rtl.boolean,"FBottomVerticalText","SetBottomVerticalText",{Default:!1}),e.addProperty("FillEmptySpaces",2,rtl.boolean,"FFillEmptySpaces","SetFillEmptySpaces",{Default:!0}),e.addProperty("SortIndicatorColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FSortIndicatorColor","SetSortIndicatorColor",{Default:11829830}),e.addProperty("OptimizedColumnDisplay",2,rtl.boolean,"FOptimizedColumnDisplay","SetOptimizedColumnDisplay",{Default:!0})})),this.TTMSFNCTreeViewColumnEmptySpace={0:"tcesTopLeft",tcesTopLeft:0,1:"tcesTopRight",tcesTopRight:1,2:"tcesBottomLeft",tcesBottomLeft:2,3:"tcesBottomRight",tcesBottomRight:3},this.$rtti.$Enum("TTMSFNCTreeViewColumnEmptySpace",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCTreeViewColumnEmptySpace}),this.TTMSFNCTreeViewGroupEmptySpace={0:"tgesTopLeft",tgesTopLeft:0,1:"tgesTopRight",tgesTopRight:1,2:"tgesBottomLeft",tgesBottomLeft:2,3:"tgesBottomRight",tgesBottomRight:3},this.$rtti.$Enum("TTMSFNCTreeViewGroupEmptySpace",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCTreeViewGroupEmptySpace}),rtl.createClass(this,"TTMSFNCTreeViewGroupsAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTreeView=null,this.FLayouts={},this.FBottomSize=0,this.FTopSize=0,this.FBottomFill=null,this.FBottomStroke=null,this.FTopFill=null,this.FTopStroke=null,this.FTopFont=null,this.FBottomFont=null,this.FBottomHorizontalTextAlign=0,this.FTopVerticalTextAlign=0,this.FTopHorizontalTextAlign=0,this.FBottomVerticalTextAlign=0,this.FTopVerticalText=!1,this.FBottomVerticalText=!1,this.FFillEmptySpaces=!1},this.$final=function(){this.FTreeView=void 0,this.FLayouts=void 0,this.FBottomFill=void 0,this.FBottomStroke=void 0,this.FTopFill=void 0,this.FTopStroke=void 0,this.FTopFont=void 0,this.FBottomFont=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetLayouts=function(t){rtl.neSet(this.FLayouts,t)&&(this.FLayouts=rtl.refSet(t),this.FTreeView.UpdateTreeViewCache())},this.SetBottomSize=function(t){this.FBottomSize!==t&&(this.FBottomSize=t,this.FTreeView.UpdateTreeViewCache())},this.SetTopSize=function(t){this.FTopSize!==t&&(this.FTopSize=t,this.FTreeView.UpdateTreeViewCache())},this.SetBottomFill=function(t){this.FBottomFill!==t&&this.FBottomFill.Assign(t)},this.SetBottomStroke=function(t){this.FBottomStroke!==t&&this.FBottomStroke.Assign(t)},this.SetTopFill=function(t){this.FTopFill!==t&&this.FTopFill.Assign(t)},this.SetTopStroke=function(t){this.FTopStroke!==t&&this.FTopStroke.Assign(t)},this.SetBottomFont=function(t){this.FBottomFont!==t&&this.FBottomFont.Assign(t)},this.SetTopFont=function(t){this.FTopFont!==t&&this.FTopFont.Assign(t)},this.SetBottomHorizontalTextAlign=function(t){this.FBottomHorizontalTextAlign!==t&&(this.FBottomHorizontalTextAlign=t,this.Changed(this))},this.SetBottomVerticalTextAlign=function(t){this.FBottomVerticalTextAlign!==t&&(this.FBottomVerticalTextAlign=t,this.Changed(this))},this.SetTopHorizontalTextAlign=function(t){this.FTopHorizontalTextAlign!==t&&(this.FTopHorizontalTextAlign=t,this.Changed(this))},this.SetTopVerticalTextAlign=function(t){this.FTopVerticalTextAlign!==t&&(this.FTopVerticalTextAlign=t,this.Changed(this))},this.SetTopVerticalText=function(t){this.FTopVerticalText!==t&&(this.FTopVerticalText=t,this.Changed(this))},this.SetBottomVerticalText=function(t){this.FBottomVerticalText!==t&&(this.FBottomVerticalText=t,this.Changed(this))},this.SetFillEmptySpaces=function(t){this.FFillEmptySpaces!==t&&(this.FFillEmptySpaces=t,this.FTreeView.Invalidate())},this.Changed=function(t){this.FTreeView.UpdateTreeViewCache()},this.Create$1=function(t){return this.FTreeView=t,this.FLayouts=rtl.createSet(0),this.FFillEmptySpaces=!0,this.FTopSize=50,this.FBottomSize=50,this.FTopVerticalText=!1,this.FBottomVerticalText=!1,this.FTopHorizontalTextAlign=0,this.FTopVerticalTextAlign=0,this.FBottomHorizontalTextAlign=0,this.FBottomVerticalTextAlign=0,this.FBottomFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FBottomStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FTopFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FTopStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FTopFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FTopFont.SetColor(0),this.FBottomFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FBottomFont.SetColor(0),this.FBottomFill.FOnChanged=rtl.createCallback(this,"Changed"),this.FTopFill.FOnChanged=rtl.createCallback(this,"Changed"),this.FBottomStroke.FOnChanged=rtl.createCallback(this,"Changed"),this.FTopStroke.FOnChanged=rtl.createCallback(this,"Changed"),this.FTopFont.FOnChanged=rtl.createCallback(this,"Changed"),this.FBottomFont.FOnChanged=rtl.createCallback(this,"Changed"),this},this.Destroy=function(){rtl.free(this,"FBottomFont"),rtl.free(this,"FTopFont"),rtl.free(this,"FBottomFill"),rtl.free(this,"FBottomStroke"),rtl.free(this,"FTopFill"),rtl.free(this,"FTopStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCTreeViewGroupsAppearance.isPrototypeOf(e)&&(this.FLayouts=rtl.refSet(rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FLayouts),this.FTopSize=rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FTopSize,this.FBottomSize=rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FBottomSize,this.FBottomFill.Assign(rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FBottomFill),this.FBottomFont.Assign(rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FBottomFont),this.FBottomStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FBottomStroke),this.FTopFill.Assign(rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FTopFill),this.FTopStroke.Assign(rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FTopStroke),this.FTopFont.Assign(rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FTopFont),this.FTopHorizontalTextAlign=rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FTopHorizontalTextAlign,this.FTopVerticalTextAlign=rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FTopVerticalTextAlign,this.FBottomHorizontalTextAlign=rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FBottomHorizontalTextAlign,this.FBottomVerticalTextAlign=rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FBottomVerticalTextAlign,this.FTopVerticalText=rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FTopVerticalText,this.FBottomVerticalText=rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FBottomVerticalText,this.FFillEmptySpaces=rtl.as(e,t.TTMSFNCTreeViewGroupsAppearance).FFillEmptySpaces)};var e=this.$rtti;e.addProperty("Layouts",2,t.$rtti.TTMSFNCTreeViewGroupsLayouts,"FLayouts","SetLayouts",{Default:rtl.createSet(0)}),e.addProperty("TopSize",2,rtl.double,"FTopSize","SetTopSize"),e.addProperty("BottomSize",2,rtl.double,"FBottomSize","SetBottomSize"),e.addProperty("TopFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FTopFill","SetTopFill"),e.addProperty("BottomFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FBottomFill","SetBottomFill"),e.addProperty("TopFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FTopFont","SetTopFont"),e.addProperty("BottomFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FBottomFont","SetBottomFont"),e.addProperty("TopStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FTopStroke","SetTopStroke"),e.addProperty("BottomStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FBottomStroke","SetBottomStroke"),e.addProperty("TopHorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FTopHorizontalTextAlign","SetTopHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("TopVerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FTopVerticalTextAlign","SetTopVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("BottomHorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FBottomHorizontalTextAlign","SetBottomHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("BottomVerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FBottomVerticalTextAlign","SetBottomVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("TopVerticalText",2,rtl.boolean,"FTopVerticalText","SetTopVerticalText",{Default:!1}),e.addProperty("BottomVerticalText",2,rtl.boolean,"FBottomVerticalText","SetBottomVerticalText",{Default:!1}),e.addProperty("FillEmptySpaces",2,rtl.boolean,"FFillEmptySpaces","SetFillEmptySpaces",{Default:!0})})),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawSortIndicatorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["ASortIndex",rtl.longint],["ASortKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNodesSortKind],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawSortIndicatorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["ASortIndex",rtl.longint],["ASortKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNodesSortKind]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewNodeCompareEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Node1",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNode],["Node2",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNode],["AColumn",rtl.longint],["ACompareResult",rtl.longint,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeSizeColumnEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColumn",rtl.longint],["AColumnSize",rtl.double],["ANewColumnSize",rtl.double,1],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterSizeColumnEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColumn",rtl.longint],["AColumnSize",rtl.double]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawColumnEmptySpaceEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ASpace",this.$rtti.TTMSFNCTreeViewColumnEmptySpace],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawColumnEmptySpaceEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ASpace",this.$rtti.TTMSFNCTreeViewColumnEmptySpace]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawGroupEmptySpaceEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ASpace",this.$rtti.TTMSFNCTreeViewGroupEmptySpace],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawGroupEmptySpaceEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ASpace",this.$rtti.TTMSFNCTreeViewGroupEmptySpace]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewNeedFilterDropDownDataEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColumn",rtl.longint],["AValues",pas.Classes.$rtti.TStrings]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawColumnEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawColumnEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawColumnHeaderEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawColumnHeaderEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawGroupEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AGroup",rtl.longint],["AStartColumn",rtl.longint],["AEndColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawGroupEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AGroup",rtl.longint],["AStartColumn",rtl.longint],["AEndColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNumberOfNodesEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["ANumberOfNodes",rtl.longint,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetColumnTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AText",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawColumnTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AText",rtl.string],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawColumnTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AText",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetGroupTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGroup",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AText",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawGroupTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AGroup",rtl.longint],["AStartColumn",rtl.longint],["AEndColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AText",rtl.string],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawGroupTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AGroup",rtl.longint],["AStartColumn",rtl.longint],["AEndColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AText",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewNodeAnchorClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AAnchor",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewNodeChangedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AMode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNodeTextMode],["AText",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeDataEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeSidesEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["ASides",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsSides,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeTrimmingEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["ATrimming",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeHorizontalTextAlignEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AHorizontalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeVerticalTextAlignEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AVerticalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeWordWrappingEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AWordWrapping",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetColumnTrimmingEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["ATrimming",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetColumnHorizontalTextAlignEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AHorizontalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetColumnVerticalTextAlignEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AVerticalTextAlign",pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetColumnWordWrappingEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColumn",rtl.longint],["AKind",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewCacheItemKind],["AWordWrapping",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeIconEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["ALarge",rtl.boolean],["AIcon",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeIconSizeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["ALarge",rtl.boolean],["AIcon",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap],["AIconWidth",rtl.double,1],["AIconHeight",rtl.double,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewFocusedNodeChangedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeHeightEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AHeight",rtl.double,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawNodeTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AText",rtl.string],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawNodeTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AText",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawNodeExpandEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AExpand",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawNodeExpandEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AExpand",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawNodeIconEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AIcon",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawNodeIconEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AIcon",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDrawNodeCheckEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["ACheck",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDrawNodeCheckEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AColumn",rtl.longint],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["ACheck",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeColorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColor",pas["WEBLib.Graphics"].$rtti.TColor,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeCheckTypeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["ACheckType",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNodeCheckType,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetNodeTextColorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["ATextColor",pas["WEBLib.Graphics"].$rtti.TColor,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewIsNodeExtendedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AExtended",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewColumnAnchorClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColumn",rtl.longint],["AAnchor",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewIsNodeCheckedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AChecked",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewIsNodeExpandedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AExpanded",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewIsNodeEnabledEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AEnabled",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeUpdateNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AText",rtl.string,1],["ACanUpdate",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterUpdateNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeCollapseNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["ACanCollapse",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterCollapseNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeExpandNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["ACanExpand",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterExpandNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeCheckNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["ACanCheck",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterCheckNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeUnCheckNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["ACanUnCheck",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterUnCheckNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeSelectAllNodesEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACanSelect",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterSelectAllNodesEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeSelectNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["ACanSelect",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterSelectNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeUnSelectNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["ACanUnSelect",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterUnSelectNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewNodeClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewNodeMouseEnterEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewNodeMouseLeaveEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewScrollEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["APosition",rtl.double]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeAddJSONNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AJSONValue",pas["WEBLib.JSON"].$rtti.TJSONValue],["AAddNode",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterAddJSONNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNode],["AJSONValue",pas["WEBLib.JSON"].$rtti.TJSONValue]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetHTMLTemplateValueEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANodeValue",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNodeValue],["AName",rtl.string],["AValue",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetHTMLTemplateEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANodeValue",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNodeValue],["AColumnIndex",rtl.longint],["AHTMLTemplate",rtl.string,1]]),methodkind:0}),this.$rtti.$ClassRef("TTMSFNCTreeViewInplaceEditorClass",{instancetype:pas["WEBLib.Controls"].$rtti.TWinControl}),this.$rtti.$MethodVar("TTMSFNCTreeViewCustomizeInplaceEditorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AInplaceEditor",pas["WEBLib.Controls"].$rtti.TWinControl]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetInplaceEditorRectEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AInplaceEditor",pas["WEBLib.Controls"].$rtti.TWinControl],["AInplaceEditorRect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewGetInplaceEditorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AInplaceEditorClass",this.$rtti.TTMSFNCTreeViewInplaceEditorClass,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeOpenInplaceEditorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["ACanOpen",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterOpenInplaceEditorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AInplaceEditor",pas["WEBLib.Controls"].$rtti.TWinControl],["AInplaceEditorRect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewCloseInplaceEditorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AColumn",rtl.longint],["AInplaceEditor",pas["WEBLib.Controls"].$rtti.TWinControl],["ACancelled",rtl.boolean],["ACanClose",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeReorderNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AFromNode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AToNode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["ACanReorder",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterReorderNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AFromNode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AToNode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeSortNodesEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ASortColumn",rtl.longint],["ASortMode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNodesSortMode],["ACanSort",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterSortNodesEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ASortColumn",rtl.longint],["ASortMode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNodesSortMode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeDropNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AFromNode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AToNode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["ACanDrop",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterDropNodeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AFromNode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode],["AToNode",pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewVirtualNode]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeCopyToClipboardEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACanCopy",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforeCutToClipboardEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACanCut",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewBeforePasteFromClipboardEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACanPaste",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterCopyToClipboardEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterCutToClipboardEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewAfterPasteFromClipboardEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTreeViewFilterSelectEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AColumn",rtl.longint],["ACondition",rtl.string,1]]),methodkind:0}),this.TTMSFNCTreeViewMouseEditMode={0:"tmemDoubleClick",tmemDoubleClick:0,1:"tmemSingleClick",tmemSingleClick:1,2:"tmemSingleClickOnSelectedNode",tmemSingleClickOnSelectedNode:2},this.$rtti.$Enum("TTMSFNCTreeViewMouseEditMode",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTreeViewMouseEditMode}),this.TTMSFNCTreeViewClipboardMode={0:"tcmNone",tcmNone:0,1:"tcmTextOnly",tcmTextOnly:1,2:"tcmFull",tcmFull:2},this.$rtti.$Enum("TTMSFNCTreeViewClipboardMode",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTreeViewClipboardMode}),this.TTMSFNCTreeViewDragDropMode={0:"tdmNone",tdmNone:0,1:"tdmMove",tdmMove:1,2:"tdmCopy",tdmCopy:2},this.$rtti.$Enum("TTMSFNCTreeViewDragDropMode",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTreeViewDragDropMode}),this.TMultiSelectStyles={0:"msControlSelect",msControlSelect:0,1:"msShiftSelect",msShiftSelect:1,2:"msVisibleOnly",msVisibleOnly:2,3:"msSiblingOnly",msSiblingOnly:3},this.$rtti.$Enum("TMultiSelectStyles",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TMultiSelectStyles}),this.$rtti.$Set("TMultiSelectStyle",{comptype:this.$rtti.TMultiSelectStyles}),this.$rtti.$Class("TTMSFNCTreeViewInteraction"),rtl.createClass(this,"TTMSFNCTreeViewLookup",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FEnabled=!1,this.FCaseSensitive=!1,this.FIncremental=!1,this.FColumn=0,this.FAutoSelect=!1,this.FRootNodesOnly=!1,this.FAutoExpand=!1,this.FVisibleNodesOnly=!1},this.$final=function(){this.FOwner=void 0,pas.Classes.TPersistent.$final.call(this)},this.Create$1=function(t){return this.FOwner=t,this.FEnabled=!0,this.FCaseSensitive=!1,this.FIncremental=!0,this.FColumn=-1,this.FAutoSelect=!0,this.FAutoExpand=!1,this.FRootNodesOnly=!1,this.FVisibleNodesOnly=!1,this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCTreeViewLookup.isPrototypeOf(e)&&(this.FEnabled=rtl.as(e,t.TTMSFNCTreeViewLookup).FEnabled,this.FCaseSensitive=rtl.as(e,t.TTMSFNCTreeViewLookup).FCaseSensitive,this.FIncremental=rtl.as(e,t.TTMSFNCTreeViewLookup).FIncremental,this.FColumn=rtl.as(e,t.TTMSFNCTreeViewLookup).FColumn,this.FAutoSelect=rtl.as(e,t.TTMSFNCTreeViewLookup).FAutoSelect,this.FAutoExpand=rtl.as(e,t.TTMSFNCTreeViewLookup).FAutoExpand,this.FRootNodesOnly=rtl.as(e,t.TTMSFNCTreeViewLookup).FRootNodesOnly,this.FVisibleNodesOnly=rtl.as(e,t.TTMSFNCTreeViewLookup).FVisibleNodesOnly)};var e=this.$rtti;e.addProperty("CaseSensitive",0,rtl.boolean,"FCaseSensitive","FCaseSensitive",{Default:!1}),e.addProperty("Enabled",0,rtl.boolean,"FEnabled","FEnabled",{Default:!0}),e.addProperty("Incremental",0,rtl.boolean,"FIncremental","FIncremental",{Default:!0}),e.addProperty("Column",0,rtl.longint,"FColumn","FColumn",{Default:-1}),e.addProperty("RootNodesOnly",0,rtl.boolean,"FRootNodesOnly","FRootNodesOnly",{Default:!1}),e.addProperty("VisibleNodesOnly",0,rtl.boolean,"FVisibleNodesOnly","FVisibleNodesOnly",{Default:!1}),e.addProperty("AutoExpand",0,rtl.boolean,"FAutoExpand","FAutoExpand",{Default:!1}),e.addProperty("AutoSelect",0,rtl.boolean,"FAutoSelect","FAutoSelect",{Default:!0})})),rtl.createClass(this,"TTMSFNCTreeViewInteraction",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTreeView=null,this.FMultiSelect=!1,this.FTouchScrolling=!1,this.FReadOnly=!1,this.FColumnSizing=!1,this.FColumnAutoSizeOnDblClick=!1,this.FExtendedSelectable=!1,this.FSelectionFollowsFocus=!1,this.FKeyboardEdit=!1,this.FMouseEditMode=0,this.FExtendedEditable=!1,this.FClipboardMode=0,this.FReorder=!1,this.FDragDropMode=0,this.FLookup=null,this.FExpandCollapseOnDblClick=!1,this.FAutoOpenURL=!1,this.FURLDetectionOnMouseMove=!1,this.FMouseWheelDelta=0,this.FAnimationFactor=0,this.FMultiSelectStyle={}},this.$final=function(){this.FTreeView=void 0,this.FLookup=void 0,this.FMultiSelectStyle=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetMultiSelect=function(t){this.FMultiSelect!==t&&(this.FMultiSelect=t)},this.SetTouchScrolling=function(t){this.FTouchScrolling!==t&&(this.FTouchScrolling=t)},this.SetReadOnly=function(t){this.FReadOnly!==t&&(this.FReadOnly=t)},this.SetColumnSizing=function(t){this.FColumnSizing!==t&&(this.FColumnSizing=t,null!=this.FTreeView&&this.FColumnSizing&&this.FTreeView.FColumnsAppearance.SetStretchAll(!1))},this.SetColumnAutoSizeOnDblClick=function(t){this.FColumnAutoSizeOnDblClick!==t&&(this.FColumnAutoSizeOnDblClick=t)},this.SetExtendedSelectable=function(t){this.FExtendedSelectable!==t&&(this.FExtendedSelectable=t)},this.SetMouseEditMode=function(t){this.FMouseEditMode!==t&&(this.FMouseEditMode=t)},this.SetExtendedEditable=function(t){this.FExtendedEditable!==t&&(this.FExtendedEditable=t)},this.SetDragDropMode=function(t){this.FDragDropMode!==t&&(this.FDragDropMode=t)},this.SetReorder=function(t){this.FReorder!==t&&(this.FReorder=t)},this.SetLookup=function(t){this.FLookup!==t&&this.FLookup.Assign(t)},this.SetExpandCollapseOnDblClick=function(t){this.FExpandCollapseOnDblClick!==t&&(this.FExpandCollapseOnDblClick=t)},this.SetURLDetectionOnMouseMove=function(t){this.FURLDetectionOnMouseMove!==t&&(this.FURLDetectionOnMouseMove=t)},this.IsMouseWheelDeltaStored=function(){return 1!==this.FMouseWheelDelta},this.SetMouseWheelDelta=function(t){this.FMouseWheelDelta=t},this.IsAnimationFactorStored=function(){return 2.5!==this.FAnimationFactor},this.SetMultiSelectStyle=function(t){rtl.neSet(t,this.FMultiSelectStyle)&&(this.FMultiSelectStyle=rtl.refSet(t))},this.Create$1=function(e){return this.FTreeView=e,this.FAutoOpenURL=!0,this.FAnimationFactor=2.5,this.FMouseWheelDelta=1,this.FClipboardMode=0,this.FExpandCollapseOnDblClick=!0,this.FReorder=!1,this.FDragDropMode=0,this.FReadOnly=!1,this.FURLDetectionOnMouseMove=!0,this.FSelectionFollowsFocus=!0,this.FTouchScrolling=!0,this.FKeyboardEdit=!0,this.FExtendedSelectable=!1,this.FMultiSelect=!1,this.FColumnSizing=!1,this.FExtendedEditable=!1,this.FColumnAutoSizeOnDblClick=!1,this.FMouseEditMode=2,this.FLookup=t.TTMSFNCTreeViewLookup.$create("Create$1",[this]),this.FMultiSelectStyle=rtl.createSet(0,1),this},this.Destroy=function(){rtl.free(this,"FLookup"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCTreeViewInteraction.isPrototypeOf(e)&&(this.FMultiSelect=rtl.as(e,t.TTMSFNCTreeViewInteraction).FMultiSelect,this.FTouchScrolling=rtl.as(e,t.TTMSFNCTreeViewInteraction).FTouchScrolling,this.FReadOnly=rtl.as(e,t.TTMSFNCTreeViewInteraction).FReadOnly,this.FColumnSizing=rtl.as(e,t.TTMSFNCTreeViewInteraction).FColumnSizing,this.FColumnAutoSizeOnDblClick=rtl.as(e,t.TTMSFNCTreeViewInteraction).FColumnAutoSizeOnDblClick,this.FExtendedSelectable=rtl.as(e,t.TTMSFNCTreeViewInteraction).FExtendedSelectable,this.FSelectionFollowsFocus=rtl.as(e,t.TTMSFNCTreeViewInteraction).FSelectionFollowsFocus,this.FKeyboardEdit=rtl.as(e,t.TTMSFNCTreeViewInteraction).FKeyboardEdit,this.FMouseEditMode=rtl.as(e,t.TTMSFNCTreeViewInteraction).FMouseEditMode,this.FExtendedEditable=rtl.as(e,t.TTMSFNCTreeViewInteraction).FExtendedEditable,this.FClipboardMode=rtl.as(e,t.TTMSFNCTreeViewInteraction).FClipboardMode,this.FReorder=rtl.as(e,t.TTMSFNCTreeViewInteraction).FReorder,this.FDragDropMode=rtl.as(e,t.TTMSFNCTreeViewInteraction).FDragDropMode,this.FLookup.Assign(rtl.as(e,t.TTMSFNCTreeViewInteraction).FLookup),this.FExpandCollapseOnDblClick=rtl.as(e,t.TTMSFNCTreeViewInteraction).FExpandCollapseOnDblClick,this.FAutoOpenURL=rtl.as(e,t.TTMSFNCTreeViewInteraction).FAutoOpenURL,this.FURLDetectionOnMouseMove=rtl.as(e,t.TTMSFNCTreeViewInteraction).FURLDetectionOnMouseMove,this.FMouseWheelDelta=rtl.as(e,t.TTMSFNCTreeViewInteraction).FMouseWheelDelta,this.FAnimationFactor=rtl.as(e,t.TTMSFNCTreeViewInteraction).FAnimationFactor)};var e=this.$rtti;e.addProperty("AnimationFactor",12,rtl.double,"FAnimationFactor","FAnimationFactor",{stored:"IsAnimationFactorStored"}),e.addProperty("AutoOpenURL",0,rtl.boolean,"FAutoOpenURL","FAutoOpenURL",{Default:!0}),e.addProperty("MultiSelect",2,rtl.boolean,"FMultiSelect","SetMultiSelect",{Default:!1}),e.addProperty("MultiSelectStyle",2,t.$rtti.TMultiSelectStyle,"FMultiSelectStyle","SetMultiSelectStyle",{Default:rtl.createSet(0,1)}),e.addProperty("ExtendedSelectable",2,rtl.boolean,"FExtendedSelectable","SetExtendedSelectable",{Default:!1}),e.addProperty("ExtendedEditable",2,rtl.boolean,"FExtendedEditable","SetExtendedEditable",{Default:!1}),e.addProperty("MouseEditMode",2,t.$rtti.TTMSFNCTreeViewMouseEditMode,"FMouseEditMode","SetMouseEditMode",{Default:t.TTMSFNCTreeViewMouseEditMode.tmemSingleClickOnSelectedNode}),e.addProperty("MouseWheelDelta",14,rtl.double,"FMouseWheelDelta","SetMouseWheelDelta",{stored:"IsMouseWheelDeltaStored"}),e.addProperty("TouchScrolling",2,rtl.boolean,"FTouchScrolling","SetTouchScrolling",{Default:!0}),e.addProperty("KeyboardEdit",0,rtl.boolean,"FKeyboardEdit","FKeyboardEdit",{Default:!0}),e.addProperty("ReadOnly",2,rtl.boolean,"FReadOnly","SetReadOnly",{Default:!1}),e.addProperty("ExpandCollapseOnDblClick",2,rtl.boolean,"FExpandCollapseOnDblClick","SetExpandCollapseOnDblClick",{Default:!0}),e.addProperty("ColumnSizing",2,rtl.boolean,"FColumnSizing","SetColumnSizing",{Default:!1}),e.addProperty("ColumnAutoSizeOnDblClick",2,rtl.boolean,"FColumnAutoSizeOnDblClick","SetColumnAutoSizeOnDblClick",{Default:!1}),e.addProperty("ClipboardMode",0,t.$rtti.TTMSFNCTreeViewClipboardMode,"FClipboardMode","FClipboardMode",{Default:t.TTMSFNCTreeViewClipboardMode.tcmNone}),e.addProperty("Reorder",2,rtl.boolean,"FReorder","SetReorder",{Default:!1}),e.addProperty("DragDropMode",2,t.$rtti.TTMSFNCTreeViewDragDropMode,"FDragDropMode","SetDragDropMode",{Default:t.TTMSFNCTreeViewDragDropMode.tdmNone}),e.addProperty("Lookup",2,t.$rtti.TTMSFNCTreeViewLookup,"FLookup","SetLookup"),e.addProperty("URLDetectionOnMouseMove",2,rtl.boolean,"FURLDetectionOnMouseMove","SetURLDetectionOnMouseMove",{Default:!0})})),rtl.createClass(this,"TTMSFNCTreeViewSelectedNodes",pas.Classes.TList,(function(){this.GetItem=function(t){return rtl.getObject(this.Get(t))}})),rtl.recNewT(this,"TTMSFNCTreeViewNodeCheck",(function(){this.AColumn=0,this.ANode=null,this.$eq=function(t){return this.AColumn===t.AColumn&&this.ANode===t.ANode},this.$assign=function(t){return this.AColumn=t.AColumn,this.ANode=t.ANode,this}})),rtl.recNewT(this,"TTMSFNCTreeViewNodeAnchor",(function(){this.AAnchor="",this.AColumn=0,this.$eq=function(t){return this.AAnchor===t.AAnchor&&this.AColumn===t.AColumn},this.$assign=function(t){return this.AAnchor=t.AAnchor,this.AColumn=t.AColumn,this}})),rtl.createClass(this,"TTMSFNCTreeViewComboBox",pas["WEBLib.StdCtrls"].TComboBox,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCTreeViewMemo",pas["WEBLib.StdCtrls"].TMemo,(function(){this.$init=function(){pas["WEBLib.StdCtrls"].TMemo.$init.call(this),this.FTreeView=null},this.$final=function(){this.FTreeView=void 0,pas["WEBLib.StdCtrls"].TMemo.$final.call(this)},this.KeyDown=function(t,e){if(pas["WEBLib.Controls"].TControl.KeyDown.apply(this,arguments),null!=this.FTreeView&&this.FTreeView.FInplaceEditorActive){var i=t.get();27===i?(this.FTreeView.CloseInplaceEditor(!0,!0),t.set(0)):113===i&&(this.FTreeView.CloseInplaceEditor(!1,!0),t.set(0))}},this.DoExit=function(){pas["WEBLib.Controls"].TControl.DoExit.call(this),null!=this.FTreeView&&this.FTreeView.FInplaceEditorActive&&this.FTreeView.CloseInplaceEditor(!1,!1)},this.Create$1=function(e){return pas["WEBLib.Controls"].TControl.Create$1.apply(this,arguments),t.TTMSFNCCustomTreeView.isPrototypeOf(e)&&(this.FTreeView=rtl.as(e,t.TTMSFNCCustomTreeView)),this},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCTreeViewEdit",pas["WEBLib.StdCtrls"].TEdit,(function(){this.$init=function(){pas["WEBLib.StdCtrls"].TEdit.$init.call(this),this.FTreeView=null},this.$final=function(){this.FTreeView=void 0,pas["WEBLib.StdCtrls"].TEdit.$final.call(this)},this.KeyDown=function(t,e){if(pas["WEBLib.Controls"].TControl.KeyDown.apply(this,arguments),null!=this.FTreeView&&this.FTreeView.FInplaceEditorActive){var i=t.get();27===i?(this.FTreeView.CloseInplaceEditor(!0,!0),t.set(0)):113!==i&&13!==i||(this.FTreeView.CloseInplaceEditor(!1,!0),t.set(0))}},this.DoExit=function(){pas["WEBLib.Controls"].TControl.DoExit.call(this),null!=this.FTreeView&&this.FTreeView.FInplaceEditorActive&&this.FTreeView.CloseInplaceEditor(!1,!1)},this.Create$1=function(e){return pas["WEBLib.Controls"].TControl.Create$1.apply(this,arguments),t.TTMSFNCCustomTreeView.isPrototypeOf(e)&&(this.FTreeView=rtl.as(e,t.TTMSFNCCustomTreeView)),this},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCTreeViewCopyNodes",pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewNodes,(function(){})),rtl.createClass(this,"TTMSFNCTreeViewAdapter",pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.$init.call(this),this.FBlockAdd=!1,this.FTreeView=null,this.FActive=!1},this.$final=function(){this.FTreeView=void 0,pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.$final.call(this)},this.SetActive=function(t){this.FActive=t,null!=this.FTreeView&&this.Initialize()},this.SetTreeView=function(t){if(this.FTreeView!==t){if(this.FTreeView=t,this.FBlockAdd)return;this.FBlockAdd=!0,null!=this.FTreeView&&(this.FTreeView.SetAdapter(this),this.Initialize()),this.FBlockAdd=!1}},this.GetNumberOfNodes=function(t,e){},this.Notification=function(t,e){pas.Classes.TComponent.Notification.apply(this,arguments),1===e&&t===this.FTreeView&&(this.FTreeView=null)},this.UpdateBounds=function(){},this.Initialize=function(){},this.ScrollTreeView=function(t){},this.SelectNode=function(t){},this.GetNodeText=function(t,e,i){},this.GetColumnDisplayName=function(t){return"",""},this.Create$1=function(e){var i=0;if(pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.Create$1.apply(this,arguments),this.FActive=!1,this.IsDesignTime()&&null!=e&&pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(e))for(var s=0,n=e.GetComponentCount()-1;s<=n;s++)if(i=s,t.TTMSFNCCustomTreeView.isPrototypeOf(e.GetComponent(i))){this.SetTreeView(rtl.as(e.GetComponent(i),t.TTMSFNCCustomTreeView));break}return this},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Active",2,rtl.boolean,"FActive","SetActive",{Default:!1}),e.addProperty("TreeView",2,t.$rtti.TTMSFNCCustomTreeView,"FTreeView","SetTreeView")})),rtl.createClass(this,"TTMSFNCTreeViewViewJSONOptions",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FValueHTMLTemplate="",this.FExpandNodes=!1,this.FNameHTMLTemplate="",this.FStretchColumn=0,this.FArrayItemPrefix="",this.FArrayItemSuffix=""},this.Create$1=function(){return this.FExpandNodes=!0,this.FStretchColumn=1,this.FNameHTMLTemplate="<#NAME>",this.FValueHTMLTemplate="<#VALUE>",this.FArrayItemPrefix="",this.FArrayItemSuffix="",this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCTreeViewViewJSONOptions.isPrototypeOf(e)?(this.FExpandNodes=rtl.as(e,t.TTMSFNCTreeViewViewJSONOptions).FExpandNodes,this.FStretchColumn=rtl.as(e,t.TTMSFNCTreeViewViewJSONOptions).FStretchColumn,this.FNameHTMLTemplate=rtl.as(e,t.TTMSFNCTreeViewViewJSONOptions).FNameHTMLTemplate,this.FValueHTMLTemplate=rtl.as(e,t.TTMSFNCTreeViewViewJSONOptions).FValueHTMLTemplate,this.FArrayItemPrefix=rtl.as(e,t.TTMSFNCTreeViewViewJSONOptions).FArrayItemPrefix,this.FArrayItemSuffix=rtl.as(e,t.TTMSFNCTreeViewViewJSONOptions).FArrayItemSuffix):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("ExpandNodes",0,rtl.boolean,"FExpandNodes","FExpandNodes",{Default:!0}),e.addProperty("StretchColumn",0,rtl.longint,"FStretchColumn","FStretchColumn",{Default:1}),e.addProperty("NameHTMLTemplate",0,rtl.string,"FNameHTMLTemplate","FNameHTMLTemplate"),e.addProperty("ValueHTMLTemplate",0,rtl.string,"FValueHTMLTemplate","FValueHTMLTemplate"),e.addProperty("ArrayItemPrefix",0,rtl.string,"FArrayItemPrefix","FArrayItemPrefix"),e.addProperty("ArrayItemSuffix",0,rtl.string,"FArrayItemSuffix","FArrayItemSuffix")})),rtl.createClass(this,"TTMSFNCCustomTreeView",pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData,(function(){this.$init=function(){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.$init.call(this),this.FPrevDSP=null,this.FOldTopRow=0,this.FCompactMode=!1,this.FVerticalOffset=0,this.FVerticalOffsetTo=0,this.FAccepted=!1,this.FLookupString="",this.FY=0,this.FDragY=0,this.FSaveDragY=0,this.FX=0,this.FDragBitmap=null,this.FReorderMode=!1,this.FDragMode$1=!1,this.FDragModeStarted=!1,this.FSortColumn=0,this.FClosing=!1,this.FInplaceEditorClosed=!1,this.FColumnSize=0,this.FCloseWithDialogKey=!1,this.FFilterPopup=null,this.FFilterListBox=null,this.FFilterTimer=null,this.FInplaceEditorClass=null,this.FInplaceEditor=null,this.FOldInplaceEditor=null,this.FInplaceEditorActive=!1,this.FSizeColumn=0,this.FDownColumn=0,this.FDownColumnFilter=0,this.FDownColumnExpand=0,this.FUpdateNodeColumn=0,this.FUpdateNode=null,this.FCopyNodes=null,this.FDoubleSelection=!1,this.FDragTimer=null,this.FDragRow=0,this.FDownNode=null,this.FFocusedNode=null,this.FDragNode=null,this.FDblClicked=!1,this.FDoNodeAnchor=t.TTMSFNCTreeViewNodeAnchor.$new(),this.FDoNodeTitleAnchor=t.TTMSFNCTreeViewNodeAnchor.$new(),this.FDoNodeCheck=t.TTMSFNCTreeViewNodeCheck.$new(),this.FDoNodeExpand=!1,this.FDoNodeExtra=!1,this.FDoNodeTitleExtra=!1,this.FScrolling=!1,this.FMouseUp=!1,this.FAnimateVerticalPos=!1,this.FAnimateHorizontalPos=!1,this.FAnimateVerticalOffset=!1,this.FAnimating=!1,this.FSpX=0,this.FSpY=0,this.FScrollX=0,this.FScrollY=0,this.FDownX=0,this.FDownY=0,this.FMouseX=0,this.FMouseY=0,this.FSizeX=0,this.FScrollVTo=0,this.FScrollHTo=0,this.FTimeStart=0,this.FTimeStop=0,this.FAnimateTimer=null,this.FNodeCache=null,this.FColumnsTopCache=null,this.FColumnsBottomCache=null,this.FGroupsTopCache=null,this.FGroupsBottomCache=null,this.FNodeDisplay=null,this.FColumnsTopDisplay=null,this.FColumnsBottomDisplay=null,this.FGroupsTopDisplay=null,this.FGroupsBottomDisplay=null,this.FNodesAppearance=null,this.FColumnsCaching=!1,this.FGroupsCaching=!1,this.FGroupsAppearance=null,this.FColumnsAppearance=null,this.FOnAfterDrawGroup=null,this.FOnNodeCompare=null,this.FOnBeforeSizeColumn=null,this.FOnAfterSizeColumn=null,this.FOnBeforeDrawColumn=null,this.FOnBeforeDrawColumnHeader=null,this.FOnAfterDrawColumnHeader=null,this.FOnBeforeDrawNode=null,this.FOnAfterDrawColumn=null,this.FOnBeforeDrawGroup=null,this.FOnAfterDrawNode=null,this.FOnBeforeDrawNodeText=null,this.FOnBeforeDrawNodeTitle=null,this.FOnGetNodeHeight=null,this.FOnAfterDrawColumnText=null,this.FOnBeforeDrawGroupText=null,this.FOnAfterDrawNodeText=null,this.FOnAfterDrawNodeTitle=null,this.FOnAfterDrawGroupText=null,this.FOnBeforeDrawColumnText=null,this.FInteraction=null,this.FOnAfterUpdateNode=null,this.FOnBeforeUpdateNode=null,this.FOnAfterUnCheckNode=null,this.FOnBeforeUnCheckNode=null,this.FOnAfterCheckNode=null,this.FOnBeforeCheckNode=null,this.FOnAfterExpandNode=null,this.FOnBeforeExpandNode=null,this.FOnAfterCollapseNode=null,this.FOnBeforeCollapseNode=null,this.FOnBeforeSelectNode=null,this.FOnAfterSelectNode=null,this.FOnBeforeSelectAllNodes=null,this.FOnAfterSelectAllNodes=null,this.FOnNodeClick=null,this.FOnNodeDblClick=null,this.FOnGetNodeText=null,this.FOnGetNodeTitle=null,this.FOnGetColumnText=null,this.FOnGetGroupText=null,this.FOnNodeAnchorClick=null,this.FOnVScroll=null,this.FOnHScroll=null,this.FOnBeforeDrawColumnEmptySpace=null,this.FOnAfterDrawColumnEmptySpace=null,this.FOnBeforeDrawGroupEmptySpace=null,this.FOnAfterDrawGroupEmptySpace=null,this.FOnGetNumberOfNodes=null,this.FOnIsNodeExpanded=null,this.FOnIsNodeEnabled=null,this.FOnIsNodeVisible=null,this.FSelectedNodes=null,this.FOnGetNodeDisabledColor=null,this.FOnGetNodeTextColor=null,this.FOnGetNodeTitleColor=null,this.FOnGetNodeSelectedColor=null,this.FOnGetNodeColor=null,this.FOnGetNodeDisabledTextColor=null,this.FOnGetNodeSelectedTextColor=null,this.FOnGetNodeDisabledTitleColor=null,this.FOnGetNodeSelectedTitleColor=null,this.FOnIsNodeExtended=null,this.FOnGetNodeIcon=null,this.FOnGetColumnWordWrapping=null,this.FOnGetColumnVerticalTextAlign=null,this.FOnGetColumnTrimming=null,this.FOnGetColumnHorizontalTextAlign=null,this.FOnGetNodeWordWrapping=null,this.FOnGetNodeVerticalTextAlign=null,this.FOnGetNodeTrimming=null,this.FOnGetNodeHorizontalTextAlign=null,this.FOnIsNodeChecked=null,this.FOnBeforeDrawNodeIcon=null,this.FOnBeforeDrawNodeExpand=null,this.FOnAfterDrawNodeIcon=null,this.FOnAfterDrawNodeExpand=null,this.FOnGetNodeCheckType=null,this.FOnAfterDrawNodeCheck=null,this.FOnBeforeDrawNodeCheck=null,this.FColumnStroke=null,this.FOnAfterDrawNodeColumn=null,this.FOnBeforeDrawNodeColumn=null,this.FOnBeforeUnSelectNode=null,this.FOnAfterUnSelectNode=null,this.FOnAfterOpenInplaceEditor=null,this.FOnGetInplaceEditor=null,this.FOnCloseInplaceEditor=null,this.FOnBeforeOpenInplaceEditor=null,this.FOnNodeChanged=null,this.FOnCustomizeInplaceEditor=null,this.FOnGetInplaceEditorRect=null,this.FOnBeforeReorderNode=null,this.FOnAfterReorderNode=null,this.FOnAfterDropNode=null,this.FOnBeforeDropNode=null,this.FOnAfterCutToClipboard=null,this.FOnBeforePasteFromClipboard=null,this.FOnBeforeCopyToClipboard=null,this.FOnAfterPasteFromClipboard=null,this.FOnBeforeCutToClipboard=null,this.FOnAfterCopyToClipboard=null,this.FOnNeedFilterDropDownData=null,this.FOnFilterSelect=null,this.FOnCustomReorder=null,this.FOnCustomDragDrop=null,this.FOnCustomDragOver=null,this.FOnCustomCopyToClipboard=null,this.FOnCustomCutToClipboard=null,this.FOnCustomPasteFromClipboard=null,this.FOnCustomColumnSort=null,this.FOnCustomLookup=null,this.FOnBeforeDrawSortIndicator=null,this.FOnAfterDrawSortIndicator=null,this.FAdapter=null,this.FOnGetNodeSides=null,this.FOnGetNodeExtraSize=null,this.FOnGetNodeTitleExtraSize=null,this.FOnAfterDrawNodeExtra=null,this.FOnBeforeDrawNodeExtra=null,this.FOnDrawNodeExtra=null,this.FOnGetNodeTitleTrimming=null,this.FOnGetNodeTitleHorizontalTextAlign=null,this.FOnGetNodeTitleWordWrapping=null,this.FOnGetNodeTitleVerticalTextAlign=null,this.FOnNodeTitleAnchorClick=null,this.FOnGetNodeExpanded=null,this.FOnBeforeDrawNodeTitleExtra=null,this.FOnAfterDrawNodeTitleExtra=null,this.FOnDrawNodeTitleExtra=null,this.FOnNodeMouseEnter=null,this.FOnNodeMouseLeave=null,this.FOnGetNodeIconSize=null,this.FOnColumnAnchorClick=null,this.FOnFocusedNodeChanged=null,this.FOnGetNodeData=null,this.FOnAfterSortNodes=null,this.FOnBeforeSortNodes=null,this.FGlobalFont=null,this.FOnGetNodeRounding=null,this.FOnGetNodeDisabledStrokeColor=null,this.FOnGetNodeSelectedStrokeColor=null,this.FOnGetNodeStrokeColor=null,this.FOnGetHTMLTemplateValue=null,this.FOnGetHTMLTemplate=null,this.FDefaultViewJSONOptions=null,this.FOnAfterAddJSONNode=null,this.FOnBeforeAddJSONNode=null,this.FCheckStartSize=0},this.$final=function(){this.FPrevDSP=void 0,this.FDragBitmap=void 0,this.FFilterPopup=void 0,this.FFilterListBox=void 0,this.FFilterTimer=void 0,this.FInplaceEditorClass=void 0,this.FInplaceEditor=void 0,this.FOldInplaceEditor=void 0,this.FUpdateNode=void 0,this.FCopyNodes=void 0,this.FDragTimer=void 0,this.FDownNode=void 0,this.FFocusedNode=void 0,this.FDragNode=void 0,this.FDoNodeAnchor=void 0,this.FDoNodeTitleAnchor=void 0,this.FDoNodeCheck=void 0,this.FAnimateTimer=void 0,this.FNodeCache=void 0,this.FColumnsTopCache=void 0,this.FColumnsBottomCache=void 0,this.FGroupsTopCache=void 0,this.FGroupsBottomCache=void 0,this.FNodeDisplay=void 0,this.FColumnsTopDisplay=void 0,this.FColumnsBottomDisplay=void 0,this.FGroupsTopDisplay=void 0,this.FGroupsBottomDisplay=void 0,this.FNodesAppearance=void 0,this.FGroupsAppearance=void 0,this.FColumnsAppearance=void 0,this.FOnAfterDrawGroup=void 0,this.FOnNodeCompare=void 0,this.FOnBeforeSizeColumn=void 0,this.FOnAfterSizeColumn=void 0,this.FOnBeforeDrawColumn=void 0,this.FOnBeforeDrawColumnHeader=void 0,this.FOnAfterDrawColumnHeader=void 0,this.FOnBeforeDrawNode=void 0,this.FOnAfterDrawColumn=void 0,this.FOnBeforeDrawGroup=void 0,this.FOnAfterDrawNode=void 0,this.FOnBeforeDrawNodeText=void 0,this.FOnBeforeDrawNodeTitle=void 0,this.FOnGetNodeHeight=void 0,this.FOnAfterDrawColumnText=void 0,this.FOnBeforeDrawGroupText=void 0,this.FOnAfterDrawNodeText=void 0,this.FOnAfterDrawNodeTitle=void 0,this.FOnAfterDrawGroupText=void 0,this.FOnBeforeDrawColumnText=void 0,this.FInteraction=void 0,this.FOnAfterUpdateNode=void 0,this.FOnBeforeUpdateNode=void 0,this.FOnAfterUnCheckNode=void 0,this.FOnBeforeUnCheckNode=void 0,this.FOnAfterCheckNode=void 0,this.FOnBeforeCheckNode=void 0,this.FOnAfterExpandNode=void 0,this.FOnBeforeExpandNode=void 0,this.FOnAfterCollapseNode=void 0,this.FOnBeforeCollapseNode=void 0,this.FOnBeforeSelectNode=void 0,this.FOnAfterSelectNode=void 0,this.FOnBeforeSelectAllNodes=void 0,this.FOnAfterSelectAllNodes=void 0,this.FOnNodeClick=void 0,this.FOnNodeDblClick=void 0,this.FOnGetNodeText=void 0,this.FOnGetNodeTitle=void 0,this.FOnGetColumnText=void 0,this.FOnGetGroupText=void 0,this.FOnNodeAnchorClick=void 0,this.FOnVScroll=void 0,this.FOnHScroll=void 0,this.FOnBeforeDrawColumnEmptySpace=void 0,this.FOnAfterDrawColumnEmptySpace=void 0,this.FOnBeforeDrawGroupEmptySpace=void 0,this.FOnAfterDrawGroupEmptySpace=void 0,this.FOnGetNumberOfNodes=void 0,this.FOnIsNodeExpanded=void 0,this.FOnIsNodeEnabled=void 0,this.FOnIsNodeVisible=void 0,this.FSelectedNodes=void 0,this.FOnGetNodeDisabledColor=void 0,this.FOnGetNodeTextColor=void 0,this.FOnGetNodeTitleColor=void 0,this.FOnGetNodeSelectedColor=void 0,this.FOnGetNodeColor=void 0,this.FOnGetNodeDisabledTextColor=void 0,this.FOnGetNodeSelectedTextColor=void 0,this.FOnGetNodeDisabledTitleColor=void 0,this.FOnGetNodeSelectedTitleColor=void 0,this.FOnIsNodeExtended=void 0,this.FOnGetNodeIcon=void 0,this.FOnGetColumnWordWrapping=void 0,this.FOnGetColumnVerticalTextAlign=void 0,this.FOnGetColumnTrimming=void 0,this.FOnGetColumnHorizontalTextAlign=void 0,this.FOnGetNodeWordWrapping=void 0,this.FOnGetNodeVerticalTextAlign=void 0,this.FOnGetNodeTrimming=void 0,this.FOnGetNodeHorizontalTextAlign=void 0,this.FOnIsNodeChecked=void 0,this.FOnBeforeDrawNodeIcon=void 0,this.FOnBeforeDrawNodeExpand=void 0,this.FOnAfterDrawNodeIcon=void 0,this.FOnAfterDrawNodeExpand=void 0,this.FOnGetNodeCheckType=void 0,this.FOnAfterDrawNodeCheck=void 0,this.FOnBeforeDrawNodeCheck=void 0,this.FColumnStroke=void 0,this.FOnAfterDrawNodeColumn=void 0,this.FOnBeforeDrawNodeColumn=void 0,this.FOnBeforeUnSelectNode=void 0,this.FOnAfterUnSelectNode=void 0,this.FOnAfterOpenInplaceEditor=void 0,this.FOnGetInplaceEditor=void 0,this.FOnCloseInplaceEditor=void 0,this.FOnBeforeOpenInplaceEditor=void 0,this.FOnNodeChanged=void 0,this.FOnCustomizeInplaceEditor=void 0,this.FOnGetInplaceEditorRect=void 0,this.FOnBeforeReorderNode=void 0,this.FOnAfterReorderNode=void 0,this.FOnAfterDropNode=void 0,this.FOnBeforeDropNode=void 0,this.FOnAfterCutToClipboard=void 0,this.FOnBeforePasteFromClipboard=void 0,this.FOnBeforeCopyToClipboard=void 0,this.FOnAfterPasteFromClipboard=void 0,this.FOnBeforeCutToClipboard=void 0,this.FOnAfterCopyToClipboard=void 0,this.FOnNeedFilterDropDownData=void 0,this.FOnFilterSelect=void 0,this.FOnCustomReorder=void 0,this.FOnCustomDragDrop=void 0,this.FOnCustomDragOver=void 0,this.FOnCustomCopyToClipboard=void 0,this.FOnCustomCutToClipboard=void 0,this.FOnCustomPasteFromClipboard=void 0,this.FOnCustomColumnSort=void 0,this.FOnCustomLookup=void 0,this.FOnBeforeDrawSortIndicator=void 0,this.FOnAfterDrawSortIndicator=void 0,this.FAdapter=void 0,this.FOnGetNodeSides=void 0,this.FOnGetNodeExtraSize=void 0,this.FOnGetNodeTitleExtraSize=void 0,this.FOnAfterDrawNodeExtra=void 0,this.FOnBeforeDrawNodeExtra=void 0,this.FOnDrawNodeExtra=void 0,this.FOnGetNodeTitleTrimming=void 0,this.FOnGetNodeTitleHorizontalTextAlign=void 0,this.FOnGetNodeTitleWordWrapping=void 0,this.FOnGetNodeTitleVerticalTextAlign=void 0,this.FOnNodeTitleAnchorClick=void 0,this.FOnGetNodeExpanded=void 0,this.FOnBeforeDrawNodeTitleExtra=void 0,this.FOnAfterDrawNodeTitleExtra=void 0,this.FOnDrawNodeTitleExtra=void 0,this.FOnNodeMouseEnter=void 0,this.FOnNodeMouseLeave=void 0,this.FOnGetNodeIconSize=void 0,this.FOnColumnAnchorClick=void 0,this.FOnFocusedNodeChanged=void 0,this.FOnGetNodeData=void 0,this.FOnAfterSortNodes=void 0,this.FOnBeforeSortNodes=void 0,this.FGlobalFont=void 0,this.FOnGetNodeRounding=void 0,this.FOnGetNodeDisabledStrokeColor=void 0,this.FOnGetNodeSelectedStrokeColor=void 0,this.FOnGetNodeStrokeColor=void 0,this.FOnGetHTMLTemplateValue=void 0,this.FOnGetHTMLTemplate=void 0,this.FDefaultViewJSONOptions=void 0,this.FOnAfterAddJSONNode=void 0,this.FOnBeforeAddJSONNode=void 0,pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.$final.call(this)},this.SetNodesAppearance=function(t){this.FNodesAppearance!==t&&this.FNodesAppearance.Assign(t)},this.SetGroupsAppearance=function(t){this.FGroupsAppearance!==t&&this.FGroupsAppearance.Assign(t)},this.SetColumnsAppearance=function(t){this.FColumnsAppearance!==t&&this.FColumnsAppearance.Assign(t)},this.SetInteraction=function(t){this.FInteraction!==t&&this.FInteraction.Assign(t)},this.GetFocusedNode=function(){var t,e=null;return e=null,null!=(t=this.FFocusedNode)&&(e=t.FNode),e},this.GetFocusedVirtualNode=function(){return this.FFocusedNode},this.GetSelNode=function(t){var e,i=null;return i=null,null!=(e=this.GetSelVirtualNode(t))&&(i=e.FNode),i},this.GetSelVirtualNode=function(t){var e=null;return e=null,t>=0&&t<=this.SelectedVirtualNodeCount()-1&&(e=this.FSelectedNodes.GetItem(t)),e},this.SetColumnStroke=function(t){this.FColumnStroke!==t&&this.FColumnStroke.Assign(t)},this.HandleFilterTimer=function(e){var i=null,s="",n=0,o=0;if(null!=this.FFilterListBox&&(o=this.FFilterListBox.FTag$1)>=0&&o<=this.FColumns.GetCount()-1){if(this.FColumns.GetItem$1(o).FFiltering.FMultiColumn)for(var r=this.FFilter.GetCount()-1;r>=0;r--)n=r,this.FFilter.GetItem$1(n).FColumn===o&&this.FFilter.Delete(n);else this.FFilter.Clear();(i=this.FFilter.Add$1()).FColumn=o,s="",this.FFilterListBox.GetItemIndex()>=0&&this.FFilterListBox.GetItemIndex()<=this.FFilterListBox.FItems.GetCount()-1&&(s=this.FFilterListBox.FItems.Get(this.FFilterListBox.GetItemIndex())),pas.System.Pos(" ",s)>0&&(s='"'+s+'"'),this.FFilterPopup.SetIsOpen(!1),s===rtl.getResStr(t,"sTMSFNCTreeViewFilterAll")?this.RemoveFilters():(this.DoFilterSelect(i.FColumn,{get:function(){return s},set:function(t){s=t}}),i.FCondition=s,this.ApplyFilter())}this.FFilterTimer.SetEnabled(!1)},this.SetAdapter=function(t){null!=t&&t.SetTreeView(this),this.FAdapter=t},this.GetSelectedVirtualNodeRow=function(){var t,e=0;return e=-1,null!=(t=this.GetFocusedVirtualNode())&&(e=t.FRow),e},this.SetGlobalFont=function(t){this.FGlobalFont.Assign(t)},this.SetDefaultViewJSONOptions=function(t){this.FDefaultViewJSONOptions=t},this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCCustomTreeView)},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&this.FFill.SetColor(t),pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleLineFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FStroke.SetColor(t),this.FColumnsAppearance.FTopStroke.SetColor(t),this.FColumnsAppearance.FBottomStroke.SetColor(t),this.FGroupsAppearance.FTopStroke.SetColor(t),this.FGroupsAppearance.FBottomStroke.SetColor(t),this.FNodesAppearance.FExtendedFill.SetColor(t),this.FNodesAppearance.FExtendedStroke.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FColumnsAppearance.FTopFill.SetColor(t),this.FColumnsAppearance.FTopFill.SetKind(1),this.FColumnsAppearance.FBottomFill.SetColor(t),this.FColumnsAppearance.FBottomFill.SetKind(1),this.FGroupsAppearance.FTopFill.SetColor(t),this.FGroupsAppearance.FTopFill.SetKind(1),this.FGroupsAppearance.FBottomFill.SetColor(t),this.FGroupsAppearance.FBottomFill.SetKind(1)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColorTo({get:function(){return t},set:function(e){t=e}})&&(this.FColumnsAppearance.FTopFill.SetColorTo(t),this.FColumnsAppearance.FTopFill.SetKind(2),this.FColumnsAppearance.FBottomFill.SetColorTo(t),this.FColumnsAppearance.FBottomFill.SetKind(2),this.FGroupsAppearance.FTopFill.SetColorTo(t),this.FGroupsAppearance.FTopFill.SetKind(2),this.FGroupsAppearance.FBottomFill.SetColorTo(t),this.FGroupsAppearance.FBottomFill.SetKind(2)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleSelectionFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FNodesAppearance.FSelectedFill.SetColor(t),this.FNodesAppearance.FSelectedStroke.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&(this.FNodesAppearance.FFont.SetColor(t),this.FNodesAppearance.SetExtendedFontColor(t),this.FColumnsAppearance.FTopFont.SetColor(t),this.FColumnsAppearance.FBottomFont.SetColor(t),this.FGroupsAppearance.FTopFont.SetColor(t),this.FGroupsAppearance.FBottomFont.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleAlternativeTextFontColor({get:function(){return t},set:function(e){t=e}})&&(this.FNodesAppearance.SetSelectedFontColor(t),this.FNodesAppearance.SetSelectedTitleFontColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&this.FFill.SetColor(t)},this.DoEnter=function(){pas["WEBLib.Controls"].TControl.DoEnter.call(this),this.Invalidate()},this.DoExit=function(){pas["WEBLib.Controls"].TControl.DoExit.call(this),this.Invalidate()},this.UpdateControlAfterResize=function(){pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.UpdateControlAfterResize.call(this),null!=this.FAdapter&&this.FAdapter.UpdateBounds()},this.ResetToDefaultStyle=function(){this.BeginUpdate(),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(this.FColumnsAppearance.FTopFont,14,1),this.FColumnsAppearance.FTopFont.SetStyle(rtl.createSet(0)),this.FColumnsAppearance.FTopFill.SetColor(16380654),this.FColumnsAppearance.FTopFont.SetColor(4539717),this.FNodesAppearance.FSelectedFill.SetColor(16578806),this.FNodesAppearance.FSelectedStroke.SetColor(15702829),this.FNodesAppearance.FFont.SetColor(8026746),this.FNodesAppearance.SetSelectedFontColor(4539717),this.FNodesAppearance.FSelectedStroke.SetColor(15702829),this.FNodesAppearance.SetShowFocus(!1),this.FNodesAppearance.SetExpandWidth(this.ScalePaintValue(18)),this.FNodesAppearance.SetExpandHeight(this.ScalePaintValue(18)),this.FNodesAppearance.SetShowFocus(!1),this.FNodesAppearance.FSelectedStroke.SetWidth(pas.System.Trunc(this.ScalePaintValue$1(2))),this.FColumnsAppearance.SetTopSize(this.ScalePaintValue(36)),this.FColumnsAppearance.FTopStroke.SetKind(0),this.FFill.SetKind(1),this.FStroke.SetKind(1),this.FFill.SetColor(16777215),this.FStroke.SetColor(11119017),this.FNodesAppearance.FExtendedFill.SetColor(16053492),this.FColumnsAppearance.FBottomFill.SetColor(this.FColumnsAppearance.FTopFill.FColor),this.FColumnsAppearance.FTopStroke.SetColor(11119017),this.FColumnsAppearance.FBottomStroke.SetColor(11119017),this.FColumnsAppearance.FBottomFont.SetColor(this.FColumnsAppearance.FTopFont.FColor),this.FGroupsAppearance.FTopFill.SetColor(16777215),this.FGroupsAppearance.FBottomFill.SetColor(16777215),this.FGroupsAppearance.FTopStroke.SetColor(11119017),this.FGroupsAppearance.FBottomStroke.SetColor(11119017),this.FGroupsAppearance.FTopFont.SetColor(0),this.FGroupsAppearance.FBottomFont.SetColor(0),this.FColumnsAppearance.FTopFill.SetKind(1),this.FColumnsAppearance.FBottomFill.SetKind(0),this.FColumnsAppearance.FBottomStroke.SetKind(1),this.FGroupsAppearance.FTopFill.SetKind(0),this.FGroupsAppearance.FBottomFill.SetKind(0),this.FGroupsAppearance.FTopStroke.SetKind(1),this.FGroupsAppearance.FBottomStroke.SetKind(1),this.FNodesAppearance.SetExtendedFontColor(this.FColumnsAppearance.FTopFont.FColor),this.FColumnsAppearance.FBottomFont.SetColor(this.FColumnsAppearance.FTopFont.FColor),this.FGroupsAppearance.FTopFont.SetColor(this.FColumnsAppearance.FTopFont.FColor),this.FGroupsAppearance.FBottomFont.SetColor(this.FColumnsAppearance.FTopFont.FColor),this.EndUpdate()},this.Notification=function(t,e){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.Notification.apply(this,arguments),t===this.FAdapter&&1===e&&(this.FAdapter=null)},this.InitializeColumnSorting=function(t,e){var i=0;this.FUpdateCount$1=this.FUpdateCount$1+1,this.FSortColumn=t;for(var s=0,n=this.FColumns.GetCount()-1;s<=n;s++){i=s;var o=e;0===o?this.FColumns.GetItem$1(i).SetSortKind(1):1===o&&this.FColumns.GetItem$1(i).SetSortKind(2)}this.FUpdateCount$1=this.FUpdateCount$1-1},this.AutoSizeColumnInternal=function(t,e,i){var s=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=null,r=null,a="",l="",h=!1,F=!1,p=0,c=!1,u=0,T=!1,C=null,S=0;if(!(3 in this.FComponentState)&&t>=0&&t<=this.FColumnCount-1&&!this.FColumnsAppearance.FStretch&&this.FNodeListBuild){S=this.GetHorizontalScrollPosition(),p=0,u=this.GetColPos(t),(r=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),r.FBitmapContainer=this.GetBitmapContainer(),r.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing;try{T=!0,C=null,t>=0&&t<=this.FColumns.GetCount()-1&&((C=this.FColumns.GetItem$1(t)).FUseDefaultAppearance||(T=!1)),0 in this.FColumnsAppearance.FLayouts&&(a=this.GetColumnText(t),this.DoGetColumnText(t,1,{get:function(){return a},set:function(t){a=t}}),T?r.FFont.Assign(this.FColumnsAppearance.FTopFont):r.FFont.Assign(C.FTopFont),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),n.$assign(r.CalculateText(a,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),!1,!0)),n.Right=n.Right+this.ScalePaintValue(4),n.Right-n.Left>p&&(p=n.Right-n.Left)),1 in this.FColumnsAppearance.FLayouts&&(a=this.GetColumnText(t),this.DoGetColumnText(t,2,{get:function(){return a},set:function(t){a=t}}),T?r.FFont.Assign(this.FColumnsAppearance.FBottomFont):r.FFont.Assign(C.FBottomFont),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),n.$assign(r.CalculateText(a,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),!1,!0)),n.Right=n.Right+this.ScalePaintValue(4),n.Right-n.Left>p&&(p=n.Right-n.Left));for(var d=this.StartRow(),m=this.StopRow();d<=m;d++)s=d,null!=(o=this.GetVisibleNodeForIndex(s))&&(a="",this.DoGetNodeText(o,t,0,{get:function(){return a},set:function(t){a=t}}),h=!1,t>=0&&t<=this.FColumns.GetCount()-1&&(h=this.FColumns.GetItem$1(t).FWordWrapping),this.DoGetNodeWordWrapping(o,t,{get:function(){return h},set:function(t){h=t}}),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),n.$assign(r.CalculateText(a,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),!1,!0)),n.Right=n.Right+this.ScalePaintValue(4),t<=rtl.length(o.FBitmapRects)-1&&(n.Right=n.Right+o.FBitmapRects[t].Right+S-u+this.ScalePaintValue(3)),n.Right-n.Left>p&&(p=n.Right-n.Left),l="",this.DoGetNodeTitle(o,t,0,{get:function(){return l},set:function(t){l=t}}),F=!1,t>=0&&t<=this.FColumns.GetCount()-1&&(F=this.FColumns.GetItem$1(t).FTitleWordWrapping),this.DoGetNodeTitleWordWrapping(o,t,{get:function(){return F},set:function(t){F=t}}),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),n.$assign(r.CalculateText(l,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),!1,!0)),n.Right=n.Right+this.ScalePaintValue(4),t<=rtl.length(o.FBitmapRects)-1&&(n.Right=n.Right+o.FBitmapRects[t].Right+S-u+this.ScalePaintValue(3)),n.Right-n.Left>p&&(p=n.Right-n.Left))}finally{r.EndScene(),r=rtl.freeLoc(r)}p=pas.System.Int(p),c=!0,i&&this.DoBeforeSizeColumn(t,this.GetColWidths(t),{get:function(){return p},set:function(t){p=t}},{get:function(){return c},set:function(t){c=t}}),c&&(this.SetColWidths(t,p),i&&this.DoAfterSizeColumn(t,p),e&&(this.UpdateTreeView(),this.Invalidate()))}},this.DoNodeCompare=function(t,e,i,s){null!=this.FOnNodeCompare&&this.FOnNodeCompare(this,t,e,i,s)},this.SetFonts=function(t){this.BeginUpdate(),this.FGlobalFont.ApplyChange(this.FNodesAppearance.FFont,t),this.FGlobalFont.ApplyChange(this.FNodesAppearance.FExtendedFont,t),this.FGlobalFont.ApplyChange(this.FNodesAppearance.FTitleFont,t),this.FGlobalFont.ApplyChange(this.FColumnsAppearance.FTopFont,t),this.FGlobalFont.ApplyChange(this.FColumnsAppearance.FBottomFont,t),this.FGlobalFont.ApplyChange(this.FGroupsAppearance.FTopFont,t),this.FGlobalFont.ApplyChange(this.FGroupsAppearance.FBottomFont,t),1===t&&(this.FNodesAppearance.SetSelectedFontColor(this.FGlobalFont.FColor),this.FNodesAppearance.SetExtendedFontColor(this.FGlobalFont.FColor),this.FNodesAppearance.SetSelectedTitleFontColor(this.FGlobalFont.FColor)),this.EndUpdate()},this.DoBeforeSortNodes=function(t,e,i){null!=this.FOnBeforeSortNodes&&this.FOnBeforeSortNodes(this,t,e,i)},this.DoAfterSortNodes=function(t,e){null!=this.FOnAfterSortNodes&&this.FOnAfterSortNodes(this,t,e)},this.DoBeforeDrawSortIndicator=function(t,e,i,s,n,o){null!=this.FOnBeforeDrawSortIndicator&&this.FOnBeforeDrawSortIndicator(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n,o)},this.DoAfterDrawSortIndicator=function(t,e,i,s,n){null!=this.FOnAfterDrawSortIndicator&&this.FOnAfterDrawSortIndicator(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoBeforeCutToClipboard=function(t){null!=this.FOnBeforeCutToClipboard&&this.FOnBeforeCutToClipboard(this,t)},this.DoBeforeCopyToClipboard=function(t){null!=this.FOnBeforeCopyToClipboard&&this.FOnBeforeCopyToClipboard(this,t)},this.DoBeforePasteFromClipboard=function(t){null!=this.FOnBeforePasteFromClipboard&&this.FOnBeforePasteFromClipboard(this,t)},this.DoAfterCutToClipboard=function(){null!=this.FOnAfterCutToClipboard&&this.FOnAfterCutToClipboard(this)},this.DoAfterCopyToClipboard=function(){null!=this.FOnAfterCopyToClipboard&&this.FOnAfterCopyToClipboard(this)},this.DoAfterPasteFromClipboard=function(){null!=this.FOnAfterPasteFromClipboard&&this.FOnAfterPasteFromClipboard(this)},this.DoBeforeReorderNode=function(t,e,i){null!=this.FOnBeforeReorderNode&&this.FOnBeforeReorderNode(this,t,e,i)},this.DoAfterReorderNode=function(t,e){null!=this.FOnAfterReorderNode&&this.FOnAfterReorderNode(this,t,e)},this.DoBeforeDropNode=function(t,e,i){null!=this.FOnBeforeDropNode&&this.FOnBeforeDropNode(this,t,e,i)},this.DoAfterDropNode=function(t,e){null!=this.FOnAfterDropNode&&this.FOnAfterDropNode(this,t,e)},this.DoBeforeDrawColumnEmptySpace=function(t,e,i,s,n){null!=this.FOnBeforeDrawColumnEmptySpace&&this.FOnBeforeDrawColumnEmptySpace(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoAfterDrawColumnEmptySpace=function(t,e,i){null!=this.FOnAfterDrawColumnEmptySpace&&this.FOnAfterDrawColumnEmptySpace(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoBeforeDrawGroupEmptySpace=function(t,e,i,s,n){null!=this.FOnBeforeDrawGroupEmptySpace&&this.FOnBeforeDrawGroupEmptySpace(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoAfterDrawGroupEmptySpace=function(t,e,i){null!=this.FOnAfterDrawGroupEmptySpace&&this.FOnAfterDrawGroupEmptySpace(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoBeforeDrawColumnHeader=function(t,e,i,s,n,o){null!=this.FOnBeforeDrawColumnHeader&&this.FOnBeforeDrawColumnHeader(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n,o)},this.DoAfterDrawColumnHeader=function(t,e,i,s){null!=this.FOnAfterDrawColumnHeader&&this.FOnAfterDrawColumnHeader(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoBeforeDrawColumn=function(t,e,i,s,n){null!=this.FOnBeforeDrawColumn&&this.FOnBeforeDrawColumn(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoAfterDrawColumn=function(t,e,i){null!=this.FOnAfterDrawColumn&&this.FOnAfterDrawColumn(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoBeforeDrawNodeColumn=function(t,e,i,s,n){null!=this.FOnBeforeDrawNodeColumn&&this.FOnBeforeDrawNodeColumn(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoAfterDrawNodeColumn=function(t,e,i){null!=this.FOnAfterDrawNodeColumn&&this.FOnAfterDrawNodeColumn(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoBeforeDrawGroup=function(t,e,i,s,n,o,r,a){null!=this.FOnBeforeDrawGroup&&this.FOnBeforeDrawGroup(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n,o,r,a)},this.DoAfterDrawGroup=function(t,e,i,s,n,o){null!=this.FOnAfterDrawGroup&&this.FOnAfterDrawGroup(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n,o)},this.DoBeforeDrawNode=function(t,e,i,s,n){null!=this.FOnBeforeDrawNode&&this.FOnBeforeDrawNode(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoAfterDrawNode=function(t,e,i){null!=this.FOnAfterDrawNode&&this.FOnAfterDrawNode(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoGetColumnText=function(t,e,i){null!=this.FOnGetColumnText&&this.FOnGetColumnText(this,t,e,i)},this.DoBeforeDrawColumnText=function(t,e,i,s,n,o){null!=this.FOnBeforeDrawColumnText&&this.FOnBeforeDrawColumnText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n,o)},this.DoAfterDrawColumnText=function(t,e,i,s,n){null!=this.FOnAfterDrawColumnText&&this.FOnAfterDrawColumnText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoGetGroupText=function(t,e,i){null!=this.FOnGetGroupText&&this.FOnGetGroupText(this,t,e,i)},this.DoBeforeDrawGroupText=function(t,e,i,s,n,o,r,a){null!=this.FOnBeforeDrawGroupText&&this.FOnBeforeDrawGroupText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n,o,r,a)},this.DoAfterDrawGroupText=function(t,e,i,s,n,o,r){null!=this.FOnAfterDrawGroupText&&this.FOnAfterDrawGroupText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n,o,r)},this.DoNodeClick=function(t){null!=this.FOnNodeClick&&this.FOnNodeClick(this,t)},this.DoNodeMouseLeave=function(t){null!=this.FOnNodeMouseLeave&&this.FOnNodeMouseLeave(this,t)},this.DoNodeMouseEnter=function(t){null!=this.FOnNodeMouseEnter&&this.FOnNodeMouseEnter(this,t)},this.DoNodeDblClick=function(t){null!=this.FOnNodeDblClick&&this.FOnNodeDblClick(this,t)},this.DoGetNumberOfNodes=function(t,e){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNumberOfNodes.apply(this,arguments),null!=this.FAdapter&&this.FAdapter.GetNumberOfNodes(t,e),null!=this.FOnGetNumberOfNodes&&(this.FUpdateCount$1=this.FUpdateCount$1+1,this.FNodeListBuild=!1,this.FNodes.Clear(),this.FUpdateCount$1=this.FUpdateCount$1-1,this.FOnGetNumberOfNodes(this,t,e))},this.DoGetNodeText=function(t,e,i,s){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeText.apply(this,arguments),null!=this.FAdapter&&this.FAdapter.GetNodeText(e,t,s),null!=this.FOnGetNodeText&&this.FOnGetNodeText(this,t,e,i,s)},this.DoGetNodeData=function(t){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeData.apply(this,arguments),null!=this.FOnGetNodeData&&this.FOnGetNodeData(this,t)},this.DoGetNodeTitle=function(t,e,i,s){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeTitle.apply(this,arguments),null!=this.FOnGetNodeTitle&&this.FOnGetNodeTitle(this,t,e,i,s)},this.DoGetNodeTitleExpanded=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeTitleExpanded.apply(this,arguments),null!=this.FOnGetNodeExpanded&&this.FOnGetNodeExpanded(this,t,e,i)},this.DoGetNodeTrimming=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeTrimming.apply(this,arguments),null!=this.FOnGetNodeTrimming&&this.FOnGetNodeTrimming(this,t,e,i)},this.DoGetNodeHorizontalTextAlign=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeHorizontalTextAlign.apply(this,arguments),null!=this.FOnGetNodeHorizontalTextAlign&&this.FOnGetNodeHorizontalTextAlign(this,t,e,i)},this.DoGetNodeVerticalTextAlign=function(t,e,i){null!=this.FOnGetNodeVerticalTextAlign&&this.FOnGetNodeVerticalTextAlign(this,t,e,i)},this.DoGetNodeWordWrapping=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeWordWrapping.apply(this,arguments),null!=this.FOnGetNodeWordWrapping&&this.FOnGetNodeWordWrapping(this,t,e,i)},this.DoGetNodeTitleTrimming=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeTitleTrimming.apply(this,arguments),null!=this.FOnGetNodeTitleTrimming&&this.FOnGetNodeTitleTrimming(this,t,e,i)},this.DoGetNodeTitleHorizontalTextAlign=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeTitleHorizontalTextAlign.apply(this,arguments),null!=this.FOnGetNodeTitleHorizontalTextAlign&&this.FOnGetNodeTitleHorizontalTextAlign(this,t,e,i)},this.DoGetNodeTitleVerticalTextAlign=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeTitleVerticalTextAlign.apply(this,arguments),null!=this.FOnGetNodeTitleVerticalTextAlign&&this.FOnGetNodeTitleVerticalTextAlign(this,t,e,i)},this.DoGetNodeTitleWordWrapping=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeTitleWordWrapping.apply(this,arguments),null!=this.FOnGetNodeTitleWordWrapping&&this.FOnGetNodeTitleWordWrapping(this,t,e,i)},this.DoGetNodeExtraSize=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeExtraSize.apply(this,arguments),null!=this.FOnGetNodeExtraSize&&this.FOnGetNodeExtraSize(this,t,e,i)},this.DoGetNodeTitleExtraSize=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeTitleExtraSize.apply(this,arguments),null!=this.FOnGetNodeTitleExtraSize&&this.FOnGetNodeTitleExtraSize(this,t,e,i)},this.DoGetColumnTrimming=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetColumnTrimming.apply(this,arguments),null!=this.FOnGetColumnTrimming&&this.FOnGetColumnTrimming(this,t,e,i)},this.DoGetColumnHorizontalTextAlign=function(t,e,i){null!=this.FOnGetColumnHorizontalTextAlign&&this.FOnGetColumnHorizontalTextAlign(this,t,e,i)},this.DoGetColumnVerticalTextAlign=function(t,e,i){null!=this.FOnGetColumnVerticalTextAlign&&this.FOnGetColumnVerticalTextAlign(this,t,e,i)},this.DoGetColumnWordWrapping=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetColumnWordWrapping.apply(this,arguments),null!=this.FOnGetColumnWordWrapping&&this.FOnGetColumnWordWrapping(this,t,e,i)},this.DoGetNodeCheckType=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeCheckType.apply(this,arguments),null!=this.FOnGetNodeCheckType&&this.FOnGetNodeCheckType(this,t,e,i)},this.DoGetNodeHeight=function(t,e,i){null!=this.FOnGetNodeHeight&&this.FOnGetNodeHeight(this,t,e,i)},this.DoGetNodeIcon=function(t,e,i,s){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeIcon.apply(this,arguments),null!=this.FOnGetNodeIcon&&this.FOnGetNodeIcon(this,t,e,i,s)},this.DoGetNodeIconSize=function(t,e,i,s,n,o){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeIconSize.apply(this,arguments),null!=this.FOnGetNodeIconSize&&this.FOnGetNodeIconSize(this,t,e,i,s,n,o)},this.DoGetNodeSelectedColor=function(t,e){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeSelectedColor.apply(this,arguments),null!=this.FOnGetNodeSelectedStrokeColor&&this.FOnGetNodeSelectedStrokeColor(this,t,e)},this.DoGetNodeSelectedStrokeColor=function(t,e){null!=this.FOnGetNodeSelectedColor&&this.FOnGetNodeSelectedStrokeColor(this,t,e)},this.DoGetNodeSides=function(t,e){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeSides.apply(this,arguments),null!=this.FOnGetNodeSides&&this.FOnGetNodeSides(this,t,e)},this.DoGetNodeRounding=function(t,e,i){null!=this.FOnGetNodeRounding&&this.FOnGetNodeRounding(this,t,e,i)},this.DoGetNodeDisabledColor=function(t,e){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeDisabledColor.apply(this,arguments),null!=this.FOnGetNodeDisabledColor&&this.FOnGetNodeDisabledColor(this,t,e)},this.DoGetNodeDisabledStrokeColor=function(t,e){null!=this.FOnGetNodeDisabledStrokeColor&&this.FOnGetNodeDisabledStrokeColor(this,t,e)},this.DoGetNodeColor=function(t,e){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeColor.apply(this,arguments),null!=this.FOnGetNodeColor&&this.FOnGetNodeColor(this,t,e)},this.DoGetNodeStrokeColor=function(t,e){null!=this.FOnGetNodeStrokeColor&&this.FOnGetNodeStrokeColor(this,t,e)},this.DoGetNodeSelectedTextColor=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeSelectedTextColor.apply(this,arguments),null!=this.FOnGetNodeSelectedTextColor&&this.FOnGetNodeSelectedTextColor(this,t,e,i)},this.DoGetNodeDisabledTextColor=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeDisabledTextColor.apply(this,arguments),null!=this.FOnGetNodeDisabledTextColor&&this.FOnGetNodeDisabledTextColor(this,t,e,i)},this.DoGetNodeTextColor=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeTextColor.apply(this,arguments),null!=this.FOnGetNodeTextColor&&this.FOnGetNodeTextColor(this,t,e,i)},this.DoGetNodeSelectedTitleColor=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeSelectedTitleColor.apply(this,arguments),null!=this.FOnGetNodeSelectedTitleColor&&this.FOnGetNodeSelectedTitleColor(this,t,e,i)},this.DoGetNodeDisabledTitleColor=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeDisabledTitleColor.apply(this,arguments),null!=this.FOnGetNodeDisabledTitleColor&&this.FOnGetNodeDisabledTitleColor(this,t,e,i)},this.DoGetNodeTitleColor=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoGetNodeTitleColor.apply(this,arguments),null!=this.FOnGetNodeTitleColor&&this.FOnGetNodeTitleColor(this,t,e,i)},this.DoIsNodeExpanded=function(t,e){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoIsNodeExpanded.apply(this,arguments),null!=this.FOnIsNodeExpanded&&this.FOnIsNodeExpanded(this,t,e)},this.DoIsNodeExtended=function(t,e){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoIsNodeExtended.apply(this,arguments),null!=this.FOnIsNodeExtended&&this.FOnIsNodeExtended(this,t,e)},this.DoIsNodeChecked=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoIsNodeChecked.apply(this,arguments),null!=this.FOnIsNodeChecked&&this.FOnIsNodeChecked(this,t,e,i)},this.DoIsNodeVisible=function(t,e){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoIsNodeVisible.apply(this,arguments),null!=this.FOnIsNodeVisible&&this.FOnIsNodeVisible(t,t,e)},this.DoIsNodeEnabled=function(t,e){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.DoIsNodeEnabled.apply(this,arguments),null!=this.FOnIsNodeEnabled&&this.FOnIsNodeEnabled(this,t,e)},this.DoBeforeDrawNodeText=function(t,e,i,s,n,o){null!=this.FOnBeforeDrawNodeText&&this.FOnBeforeDrawNodeText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n,o)},this.DoAfterDrawNodeText=function(t,e,i,s,n){null!=this.FOnAfterDrawNodeText&&this.FOnAfterDrawNodeText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoBeforeDrawNodeTitle=function(t,e,i,s,n,o){null!=this.FOnBeforeDrawNodeTitle&&this.FOnBeforeDrawNodeTitle(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n,o)},this.DoAfterDrawNodeTitle=function(t,e,i,s,n){null!=this.FOnAfterDrawNodeTitle&&this.FOnAfterDrawNodeTitle(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoBeforeDrawNodeIcon=function(t,e,i,s,n,o){null!=this.FOnBeforeDrawNodeIcon&&this.FOnBeforeDrawNodeIcon(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n,o)},this.DoAfterDrawNodeIcon=function(t,e,i,s,n){null!=this.FOnAfterDrawNodeIcon&&this.FOnAfterDrawNodeIcon(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoBeforeDrawNodeExtra=function(t,e,i,s,n){null!=this.FOnBeforeDrawNodeExtra&&this.FOnBeforeDrawNodeExtra(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoDrawNodeExtra=function(t,e,i,s){null!=this.FOnDrawNodeExtra&&this.FOnDrawNodeExtra(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoAfterDrawNodeExtra=function(t,e,i,s){null!=this.FOnAfterDrawNodeExtra&&this.FOnAfterDrawNodeExtra(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoBeforeDrawNodeTitleExtra=function(t,e,i,s,n){null!=this.FOnBeforeDrawNodeTitleExtra&&this.FOnBeforeDrawNodeTitleExtra(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoDrawNodeTitleExtra=function(t,e,i,s){null!=this.FOnDrawNodeTitleExtra&&this.FOnDrawNodeTitleExtra(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoAfterDrawNodeTitleExtra=function(t,e,i,s){null!=this.FOnAfterDrawNodeTitleExtra&&this.FOnAfterDrawNodeTitleExtra(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoBeforeDrawNodeCheck=function(t,e,i,s,n,o){null!=this.FOnBeforeDrawNodeCheck&&this.FOnBeforeDrawNodeCheck(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n,o)},this.DoAfterDrawNodeCheck=function(t,e,i,s,n){null!=this.FOnAfterDrawNodeCheck&&this.FOnAfterDrawNodeCheck(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoBeforeDrawNodeExpand=function(t,e,i,s,n,o){null!=this.FOnBeforeDrawNodeExpand&&this.FOnBeforeDrawNodeExpand(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n,o)},this.DoAfterDrawNodeExpand=function(t,e,i,s,n){null!=this.FOnAfterDrawNodeExpand&&this.FOnAfterDrawNodeExpand(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoBeforeSelectNode=function(t,e){null!=this.FOnBeforeSelectNode&&this.FOnBeforeSelectNode(this,t,e)},this.DoBeforeSelectAllNodes=function(t){null!=this.FOnBeforeSelectAllNodes&&this.FOnBeforeSelectAllNodes(this,t)},this.DoBeforeUnSelectNode=function(t,e){null!=this.FOnBeforeUnSelectNode&&this.FOnBeforeUnSelectNode(this,t,e)},this.DoCustomizeInplaceEditor=function(t,e,i){null!=this.FOnCustomizeInplaceEditor&&this.FOnCustomizeInplaceEditor(this,t,e,i)},this.DoBeforeSizeColumn=function(t,e,i,s){null!=this.FOnBeforeSizeColumn&&this.FOnBeforeSizeColumn(this,t,e,i,s)},this.DoAfterSizeColumn=function(t,e){null!=this.FOnAfterSizeColumn&&this.FOnAfterSizeColumn(this,t,e)},this.DoBeforeUpdateNode=function(t,e,i,s){null!=this.FOnBeforeUpdateNode&&this.FOnBeforeUpdateNode(this,t,e,i,s)},this.DoNodeChanged=function(t){null!=this.FOnNodeChanged&&this.FOnNodeChanged(this,t)},this.DoAfterUpdateNode=function(t,e){null!=this.FOnAfterUpdateNode&&this.FOnAfterUpdateNode(this,t,e)},this.DoUpdateNodeText=function(t,e,i){},this.DoBeforeExpandNode=function(t,e){null!=this.FOnBeforeExpandNode&&this.FOnBeforeExpandNode(this,t,e)},this.DoAfterExpandNode=function(t){null!=this.FOnAfterExpandNode&&this.FOnAfterExpandNode(this,t)},this.DoBeforeCollapseNode=function(t,e){null!=this.FOnBeforeCollapseNode&&this.FOnBeforeCollapseNode(this,t,e)},this.DoAfterCollapseNode=function(t){null!=this.FOnAfterCollapseNode&&this.FOnAfterCollapseNode(this,t)},this.DoBeforeCheckNode=function(t,e,i){null!=this.FOnBeforeCheckNode&&this.FOnBeforeCheckNode(this,t,e,i)},this.DoAfterCheckNode=function(t,e){null!=this.FOnAfterCheckNode&&this.FOnAfterCheckNode(this,t,e)},this.DoBeforeUnCheckNode=function(t,e,i){null!=this.FOnBeforeUnCheckNode&&this.FOnBeforeUnCheckNode(this,t,e,i)},this.DoAfterUnCheckNode=function(t,e){null!=this.FOnAfterUnCheckNode&&this.FOnAfterUnCheckNode(this,t,e)},this.DoNodeAnchorClick=function(t,e,i){null!=this.FOnNodeAnchorClick?this.FOnNodeAnchorClick(this,t,e,i):this.FInteraction.FAutoOpenURL&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(i)},this.DoNodeTitleAnchorClick=function(t,e,i){null!=this.FOnNodeTitleAnchorClick?this.FOnNodeTitleAnchorClick(this,t,e,i):this.FInteraction.FAutoOpenURL&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(i)},this.DoColumnAnchorClick=function(t,e){null!=this.FOnColumnAnchorClick?this.FOnColumnAnchorClick(this,t,e):this.FInteraction.FAutoOpenURL&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(e)},this.DoGetHTMLTemplateValue=function(t,e,i){null!=this.FOnGetHTMLTemplateValue&&this.FOnGetHTMLTemplateValue(this,t,e,i)},this.DoGetHTMLTemplate=function(t,e,i){null!=this.FOnGetHTMLTemplate&&this.FOnGetHTMLTemplate(this,t,e,i)},this.DoBeforeAddJSONNode=function(t,e){null!=this.FOnBeforeAddJSONNode&&this.FOnBeforeAddJSONNode(this,t,e)},this.DoAfterAddJSONNode=function(t,e){null!=this.FOnAfterAddJSONNode&&this.FOnAfterAddJSONNode(this,t,e)},this.DoBeforeOpenInplaceEditor=function(t,e,i){null!=this.FOnBeforeOpenInplaceEditor&&this.FOnBeforeOpenInplaceEditor(this,t,e,i)},this.DoAfterOpenInplaceEditor=function(t,e,i,s){null!=this.FOnAfterOpenInplaceEditor&&this.FOnAfterOpenInplaceEditor(this,t,e,i,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s))},this.DoCloseInplaceEditor=function(t,e,i,s,n){null!=this.FOnCloseInplaceEditor&&this.FOnCloseInplaceEditor(this,t,e,i,s,n)},this.UpdateInplaceEditorPosition=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas.Types.TRect.$new();this.FUpdateCount$1>0||3 in this.FComponentState||null!=this.FUpdateNode&&-1!==this.FUpdateNodeColumn&&null!=this.FInplaceEditor&&this.FInplaceEditorActive&&(this.FUpdateNode.FRow>=this.StartRow()&&this.FUpdateNode.FRow<=this.StopRow()?(t.$assign(this.GetInplaceEditorRect(this.FUpdateNode,this.FUpdateNodeColumn)),this.FInplaceEditor.SetParent(this),this.FInplaceEditor.SetVisible(!1),null!=this.FInplaceEditor&&(e.$assign(pas.Types.Rect(Math.round(t.Left),Math.round(t.Top),Math.round(t.Right),Math.round(t.Bottom))),this.FInplaceEditor.SetBoundsRect(e),this.FInplaceEditor.SetBoundsRect(pas.Types.Rect(e.Left,e.Top+rtl.trunc((e.Bottom-e.Top-this.FInplaceEditor.GetHeight())/2),e.Right,e.Top+rtl.trunc((e.Bottom-e.Top-this.FInplaceEditor.GetHeight())/2)+this.FInplaceEditor.GetHeight())),this.FInplaceEditor.SetVisible(!0))):this.FInplaceEditor.SetParent(null))},this.DoGetInplaceEditor=function(t,e,i){null!=this.FOnGetInplaceEditor&&this.FOnGetInplaceEditor(this,t,e,i)},this.CloseInplaceEditor=function(t,e){var i="",s=!1,n=!1,o="";if(this.FClosing)e&&(this.FInplaceEditorClosed=!0);else{if(this.FClosing=!0,null!=this.FUpdateNode&&-1!==this.FUpdateNodeColumn&&null!=this.FInplaceEditor){if(!t)try{o="",pas["WEBLib.StdCtrls"].TEdit.isPrototypeOf(this.FInplaceEditor)?i=rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TEdit).GetText():pas["WEBLib.StdCtrls"].TComboBox.isPrototypeOf(this.FInplaceEditor)?i=rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TComboBox).GetText():pas["WEBLib.StdCtrls"].TMemo.isPrototypeOf(this.FInplaceEditor)&&(i=rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TMemo).GetText()),o=i}finally{}n=!0,this.DoCloseInplaceEditor(this.FUpdateNode,this.FUpdateNodeColumn,this.FInplaceEditor,t,{get:function(){return n},set:function(t){n=t}}),n&&(s=!0,this.DoBeforeUpdateNode(this.FUpdateNode,this.FUpdateNodeColumn,{get:function(){return o},set:function(t){o=t}},{get:function(){return s},set:function(t){s=t}}),s&&!t&&(this.FUpdateCount$1=this.FUpdateCount$1+1,null!=this.FUpdateNode.FNode&&this.FUpdateNode.FNode.SetText(this.FUpdateNodeColumn,o),this.DoUpdateNodeText(this.FUpdateNode,this.FUpdateNodeColumn,o),this.FUpdateCount$1=this.FUpdateCount$1-1,this.DoAfterUpdateNode(this.FUpdateNode,this.FUpdateNodeColumn),this.DoNodeChanged(this.FUpdateNode)),this.FInplaceEditor.SetParent(null),null!=this.FOldInplaceEditor&&rtl.free(this,"FOldInplaceEditor"),this.FOldInplaceEditor=this.FInplaceEditor,this.FInplaceEditor=null,this.FInplaceEditorActive=!1),this.ResetNodes(!1),this.UpdateTreeView(),this.Invalidate(),this.CanFocus()&&this.SetFocus()}this.FClosing=!1,e&&(this.FInplaceEditorClosed=!0)}},this.DoFocusedNodeChanged=function(t){null!=this.FOnFocusedNodeChanged&&this.FOnFocusedNodeChanged(this,t)},this.DoAfterSelectNode=function(t){null!=this.FAdapter&&this.FAdapter.SelectNode(t),null!=this.FOnAfterSelectNode&&this.FOnAfterSelectNode(this,t)},this.DoAfterSelectAllNodes=function(){null!=this.FOnAfterSelectAllNodes&&this.FOnAfterSelectAllNodes(this)},this.DoAfterUnSelectNode=function(t){null!=this.FOnAfterUnSelectNode&&this.FOnAfterUnSelectNode(this,t)},this.DoHScroll=function(t){null!=this.FOnHScroll&&this.FOnHScroll(this,t)},this.DoVScroll=function(t){null!=this.FAdapter&&this.FAdapter.ScrollTreeView(this.GetFirstVisibleVirtualNodeRow()-this.FOldTopRow),null!=this.FOnVScroll&&this.FOnVScroll(this,t)},this.ResetNodes=function(t){var e=0,i=null,s=0,n=0;if(null!=this.FVisibleNodes){t?(s=0,n=this.FRowCount-1):(s=this.StartRow(),n=this.StopRow());for(var o=s,r=n;o<=r;o++)e=o,null!=(i=this.GetVisibleNodeForIndex(e))&&(this.FTotalRowHeight=this.FTotalRowHeight-i.FHeight+this.FDefaultRowHeight,this.UpdateNodeHeight(i,this.FDefaultRowHeight),this.UpdateNodeCalculated(i,!1))}},this.CreateDragBitmap=function(){var t=null,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i="";if(null!=this.FDragNode){this.DestroyDragBitmap(),e.$assign(this.FDragNode.FCache.FDrawRect),this.FDragBitmap=pas["WEBLib.TMSFNCImage"].TTMSFNCImage.$create("Create$1",[this]),this.FDragBitmap.SetWidth(Math.round((e.Right-e.Left)/this.FResourceScaleFactor)),this.FDragBitmap.SetHeight(Math.round((e.Bottom-e.Top)/this.FResourceScaleFactor)),this.FDragBitmap.SetLeft(Math.round(e.Left/this.FResourceScaleFactor)),this.FDragBitmap.SetTop(Math.round(e.Top/this.FResourceScaleFactor)),(t=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[Math.round(this.FDragBitmap.GetWidth()*this.FResourceScaleFactor),Math.round(this.FDragBitmap.GetHeight()*this.FResourceScaleFactor),!1,!0])).FBitmapContainer=this.GetBitmapContainer(),t.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing;try{t.BeginScene(),this.DrawNode(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,e.Right-e.Left,e.Bottom-e.Top)),this.FDragNode,!1,-e.Left,-e.Top),t.EndScene(),i=t.FBitmap.GetBase64Image(),this.FDragBitmap.FBitmaps.AddBitmapFromResource(i,1)}finally{t=rtl.freeLoc(t)}this.FDragBitmap.SetParent(this)}},this.DestroyDragBitmap=function(){null!=this.FDragBitmap&&(this.FDragBitmap.SetParent(null),rtl.free(this,"FDragBitmap"),this.FDragBitmap=null)},this.HandleSelectNode=function(t,e,i,s){var n=0,o=null,r=!1;if(!s)for(var a=this.FSelectedNodes.GetCount()-1;a>=0;a--)n=a,(o=this.FSelectedNodes.GetItem(n))!==t&&(r=!0,e&&this.DoBeforeUnSelectNode(o,{get:function(){return r},set:function(t){r=t}}),r&&(this.FSelectedNodes.IndexOf(o)>-1&&this.FSelectedNodes.Remove(o),e&&this.DoAfterUnSelectNode(o)));null!=t&&(this.FSelectedNodes.IndexOf(t)>-1||null!=this.FDownNode&&this.FDownNode.FParentNode!==t.FParentNode&&3 in this.FInteraction.FMultiSelectStyle&&s?(r=!0,e&&this.DoBeforeUnSelectNode(t,{get:function(){return r},set:function(t){r=t}}),r&&(this.FSelectedNodes.IndexOf(t)>-1&&this.FSelectedNodes.Remove(t),e&&this.DoAfterUnSelectNode(t))):(null==this.FDownNode||this.FDownNode.FParentNode!==t.FParentNode&&s)&&3 in this.FInteraction.FMultiSelectStyle||(this.FVisibleNodes.IndexOf(t)>-1||!(2 in this.FInteraction.FMultiSelectStyle))&&(r=!0,e&&this.DoBeforeSelectNode(t,{get:function(){return r},set:function(t){r=t}}),r&&(this.FSelectedNodes.Add(t),e&&(this.DoAfterSelectNode(t),i||this.DoNodeClick(t)))))},this.Animate=function(t){var i=0,s=0,n=0,o=0,r=0,a=0,l=!1,h=!1,F=!1;o=this.GetVScrollValue(),n=this.GetHScrollValue(),a=this.FVerticalOffset,h=!1,l=!1,F=!1,this.FInteraction.FAnimationFactor>0&&(i=Math.abs(this.FScrollHTo-n)/Math.max(1,Math.abs(this.FSpX)*this.FInteraction.FAnimationFactor),s=Math.abs(this.FScrollVTo-o)/Math.max(1,Math.abs(this.FSpY)*this.FInteraction.FAnimationFactor),r=Math.abs(this.FVerticalOffsetTo-a)/this.FInteraction.FAnimationFactor,this.FAnimateVerticalPos&&(h=e.AnimateDouble({get:function(){return o},set:function(t){o=t}},{p:this,get:function(){return this.p.FScrollVTo},set:function(t){this.p.FScrollVTo=t}},s,.01)),this.FAnimateHorizontalPos&&(l=e.AnimateDouble({get:function(){return n},set:function(t){n=t}},{p:this,get:function(){return this.p.FScrollHTo},set:function(t){this.p.FScrollHTo=t}},i,.01)),this.FAnimateVerticalOffset&&(F=e.AnimateDouble({get:function(){return a},set:function(t){a=t}},{p:this,get:function(){return this.p.FVerticalOffsetTo},set:function(t){this.p.FVerticalOffsetTo=t}},r,.01))),this.FAnimating=h||l,this.FAnimating?this.Scroll(n,o):F?(this.FVerticalOffset=a,this.UpdateDisplay()):(this.FVerticalOffset=this.FVerticalOffsetTo,this.UpdateDisplay(),this.FAnimateVerticalPos=!1,this.FAnimateTimer.SetEnabled(!1),this.FAnimateHorizontalPos=!1)},this.ColumnStrokeChanged=function(t){this.Invalidate()},this.DragTime=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();(this.FReorderMode||this.FDragMode$1&&this.FDragModeStarted&&this.AlternativeDragDrop())&&(e.$assign(this.GetNodesRect()),this.FY>=e.Bottom?(this.FDragRow=this.FDragRow+1,this.ScrollToVirtualNode(this.GetNodeForRow(this.FDragRow),!1,0,!1)):this.FY<=e.Top&&(this.FDragRow=this.FDragRow-1,this.ScrollToVirtualNode(this.GetNodeForRow(this.FDragRow),!1,0,!1)))},this.StopAnimationTimer=function(){this.FAnimateTimer.SetEnabled(!1),this.FAnimating=!1},this.HandleNodeToggle=function(t){var e=!1;null!=t&&t.FChildren>0&&(t.FExpanded?(e=!0,this.FBlockUpdateNode=!0,this.DoBeforeCollapseNode(t,{get:function(){return e},set:function(t){e=t}}),this.FBlockUpdateNode=!1,e&&(this.ToggleNodeInternal(t,!1),this.DoAfterCollapseNode(t))):(e=!0,this.FBlockUpdateNode=!0,this.DoBeforeExpandNode(t,{get:function(){return e},set:function(t){e=t}}),this.FBlockUpdateNode=!1,e&&(this.ToggleNodeInternal(t,!1),this.DoAfterExpandNode(t))))},this.HandleNodeExtra=function(t){},this.HandleNodeTitleExtra=function(t){},this.HandleNodeToggleCheck=function(t,e){var i=!1,s=0;null!=t&&e>=0&&e<=rtl.length(t.FCheckStates)-1&&(t.FCheckStates[e]?(s=0,this.DoGetNodeCheckType(t,e,{get:function(){return s},set:function(t){s=t}}),1===s&&(i=!0,this.DoBeforeUnCheckNode(t,e,{get:function(){return i},set:function(t){i=t}}),i&&(this.ToggleCheckNodeInternal(t,e,!1),this.DoAfterUnCheckNode(t,e)))):(i=!0,this.DoBeforeCheckNode(t,e,{get:function(){return i},set:function(t){i=t}}),i&&(this.ToggleCheckNodeInternal(t,e,!1),this.DoAfterCheckNode(t,e))))},this.HandleNodeExpand=function(t,e){var i=!1;null!=t&&!t.FExpanded&&t.FChildren>0&&(i=!0,this.FBlockUpdateNode=!0,this.DoBeforeExpandNode(t,{get:function(){return i},set:function(t){i=t}}),this.FBlockUpdateNode=!1,i&&(this.ToggleNodeInternal(t,e),this.DoAfterExpandNode(t)))},this.HandleNodeCollapse=function(t,e){var i=!1;null!=t&&t.FExpanded&&t.FChildren>0&&(i=!0,this.FBlockUpdateNode=!0,this.DoBeforeCollapseNode(t,{get:function(){return i},set:function(t){i=t}}),this.FBlockUpdateNode=!1,i&&(this.ToggleNodeInternal(t,e),this.DoAfterCollapseNode(t)))},this.HandleCustomKeys=function(t){},this.OffsetNodeRects=function(t,e,i,s){var n=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=pas["WEBLib.TMSFNCTypes"].TRectF.$new();r.$assign(this.GetNodesRect()),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(s,e+r.Left,i+r.Top);for(var a=0,l=this.FColumnCount-1;a<=l;a++)(n=a)>=0&&n<=rtl.length(t.FTitleRects)-1&&(o.$assign(t.FTitleRects[n]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(o,e+r.Left,i+r.Top),t.FTitleRects[n].$assign(o)),n>=0&&n<=rtl.length(t.FTextRects)-1&&(o.$assign(t.FTextRects[n]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(o,e+r.Left,i+r.Top),t.FTextRects[n].$assign(o)),n>=0&&n<=rtl.length(t.FExtraRects)-1&&(o.$assign(t.FExtraRects[n]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(o,e+r.Left,i+r.Top),t.FExtraRects[n].$assign(o)),n>=0&&n<=rtl.length(t.FTitleExtraRects)-1&&(o.$assign(t.FTitleExtraRects[n]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(o,e+r.Left,i+r.Top),t.FTitleExtraRects[n].$assign(o)),n>=0&&n<=rtl.length(t.FBitmapRects)-1&&(o.$assign(t.FBitmapRects[n]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(o,e+r.Left,i+r.Top),t.FBitmapRects[n].$assign(o)),n>=0&&n<=rtl.length(t.FExpandRects)-1&&(o.$assign(t.FExpandRects[n]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(o,e+r.Left,i+r.Top),t.FExpandRects[n].$assign(o)),n>=0&&n<=rtl.length(t.FCheckRects)-1&&(o.$assign(t.FCheckRects[n]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(o,e+r.Left,i+r.Top),t.FCheckRects[n].$assign(o))},this.BuildDisplay=function(t,e){var i,s=0,n=0,o=null,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),l=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),p=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),c=null;if(!(this.FUpdateCount$1>0||3 in this.FComponentState||null==t||null==e)){e.Clear(),i=-this.GetHorizontalScrollPosition(),s=-this.GetVerticalScrollPosition(),this.CanApplyVerticalOffset()&&(s+=this.FVerticalOffset),r.$assign(this.GetNodesRect()),F.$assign(this.GetGroupsTopRect()),p.$assign(this.GetGroupsBottomRect()),a.$assign(this.GetColumnsTopRect()),l.$assign(this.GetColumnsBottomRect());for(var u=0,T=t.GetCount()-1;u<=T;u++){n=u,o=t.GetItem$1(n),h.$assign(o.FRect);var C=o.FKind;0===C?null!=(c=o.FNode)&&this.OffsetNodeRects(c,pas.System.Int(i),pas.System.Int(s),h):3===C?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(h,pas.System.Int(i)+F.Left,F.Top):4===C?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(h,pas.System.Int(i)+p.Left,p.Top-1):1===C?pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(h,pas.System.Int(i)+a.Left,a.Top):2===C&&pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(h,pas.System.Int(i)+l.Left,l.Top-1),o.FDrawRect.$assign(h);var S=o.FKind;0===S?pas["WEBLib.TMSFNCTypes"].RectIntersectsWithEx(h,r)&&e.Add(o):1===S?pas["WEBLib.TMSFNCTypes"].RectIntersectsWithEx(h,a)&&e.Add(o):2===S?pas["WEBLib.TMSFNCTypes"].RectIntersectsWithEx(h,l)&&e.Add(o):3===S?pas["WEBLib.TMSFNCTypes"].RectIntersectsWithEx(h,F)&&e.Add(o):4===S&&pas["WEBLib.TMSFNCTypes"].RectIntersectsWithEx(h,p)&&e.Add(o)}}},this.UpdateCalculations=function(){this.FUpdateCount$1>0||3 in this.FComponentState||0 in this.FComponentState||(this.FOldTopRow=this.GetFirstVisibleVirtualNodeRow(),this.SetColumnCount(this.FColumns.GetCount()),0===this.FNodesAppearance.FHeightMode?this.SetDefaultRowHeight(this.FNodesAppearance.FFixedHeight):this.SetDefaultRowHeight(this.FNodesAppearance.FVariableMinimumHeight),0!==this.FUpdateCount$1||this.FBlockUpdateNodeList||3 in this.FComponentState||1 in this.FComponentState||0 in this.FComponentState||this.BuildNodeList())},this.UpdateAutoSizing=function(){this.FColumnsAppearance.FStretch&&this.StretchColumn(this.FColumnsAppearance.FStretchAll,this.FColumnsAppearance.FStretchColumn,-1)},this.UpdateColumnRowCalculations=function(t){var e=0,i=0,s=0,n=0,o=0,r=0,a=0;this.FColumnP.Clear(),s=0,this.SetColPos(0,s);for(var l=0,h=this.FColumnCount-1;l<=h;l++)e=l,s+=this.GetColWidths(e),this.SetColPos(e+1,s);this.FTotalColumnWidth=s,t&&(n=0,o=0,r=0,a=0,this.GetNodeMargins({get:function(){return n},set:function(t){n=t}},{get:function(){return o},set:function(t){o=t}},{get:function(){return r},set:function(t){r=t}},{get:function(){return a},set:function(t){a=t}}),i=this.FRowCount*this.FDefaultRowHeight,this.FTotalRowHeight=i+1+o+a)},this.UpdateColumnsCache=function(){this.UpdateColumnCache(this.FColumnsTopCache),this.UpdateColumnCache(this.FColumnsBottomCache),this.UpdateColumnsDisplay()},this.UpdateColumnCache=function(e){var i,s,n,o=0,r=0,a=0,l=0,h=0,F=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),p=0,c=0,u=0,T=0,C=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(!(this.FUpdateCount$1>0||3 in this.FComponentState||null==e||(e.Clear(),t.TTMSFNCTreeViewColumnsTopCache.isPrototypeOf(e)&&(!(0 in this.FColumnsAppearance.FLayouts)||this.FColumnsAppearance.FTopSize<=0)||t.TTMSFNCTreeViewColumnsBottomCache.isPrototypeOf(e)&&(!(1 in this.FColumnsAppearance.FLayouts)||this.FColumnsAppearance.FBottomSize<=0))))for(i=this.GetTotalColumnWidth(),o=t.TTMSFNCTreeViewColumnsTopCache.isPrototypeOf(e)?this.GetColumnsTopSize()+1:this.GetColumnsBottomSize()+1,s=this.GetColumnsExtraSize(),u=0,r=0,a=0,T=0,p=0,c=0,n=this.FColumnCount-1;r<i;){for(l=i;a<o;){h=o,F.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,l,h)),c=F.Left+u;for(var S=T,d=n;S<=d&&(p=S,C.Top=pas.System.Int(F.Top)+.5,C.Bottom=pas.System.Int(F.Bottom)-.5,C.Left=pas.System.Int(c)+.5,c=c+this.GetColWidths(p)+s,C.Right=p===n?pas.System.Int(c)-.5:pas.System.Int(c)+.5,pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(C,r,a),t.TTMSFNCTreeViewColumnsTopCache.isPrototypeOf(e)?e.Add$1(pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewCacheItem.CreateColumnTop(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(C),p)):e.Add$1(pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewCacheItem.CreateColumnBottom(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(C),p)),!(c>F.Right-F.Left));S++);a+=h}r+=l,a=0,T=p,u=-this.GetColWidths(p)-(l-c)}},this.UpdateGroupsCache=function(){this.UpdateGroupCache(this.FGroupsTopCache),this.UpdateGroupCache(this.FGroupsBottomCache),this.UpdateGroupsDisplay()},this.UpdateGroupCache=function(e){var i=0,s=0,n=pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewDisplayGroup.$new(),o=0,r=0,a=0,l=0,h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),p=null;if(!(this.FUpdateCount$1>0||3 in this.FComponentState||0===this.FColumnCount||0===this.FDisplayGroups.GetCount()||null==e||(e.Clear(),t.TTMSFNCTreeViewGroupsTopCache.isPrototypeOf(e)&&(!(0 in this.FGroupsAppearance.FLayouts)||this.FGroupsAppearance.FTopSize<=0)||t.TTMSFNCTreeViewGroupsBottomCache.isPrototypeOf(e)&&(!(1 in this.FGroupsAppearance.FLayouts)||this.FGroupsAppearance.FBottomSize<=0)))){i=t.TTMSFNCTreeViewGroupsTopCache.isPrototypeOf(e)?this.GetGroupsTopSize()+1:this.GetGroupsBottomSize()+1;for(var c=0,u=this.FDisplayGroups.GetCount()-1;c<=u;c++)s=c,n.$assign(this.FDisplayGroups.GetItem(s)),r=0,o=pas.System.Int(this.GetColPos(n.StartColumn)),l=i,(a=pas.System.Int(this.GetColPos(n.EndColumn+1)-o))<=0||l<=0||(h.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,a,l)),F.Top=pas.System.Int(h.Top)+.5,F.Bottom=pas.System.Int(h.Bottom)-.5,F.Left=pas.System.Int(h.Left)+.5,F.Right=pas.System.Int(h.Right)+.5,pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(F,o,r),p=t.TTMSFNCTreeViewGroupsTopCache.isPrototypeOf(e)?pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewCacheItem.CreateGroupTop(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),s,n.StartColumn,n.EndColumn):pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewCacheItem.CreateGroupBottom(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),s,n.StartColumn,n.EndColumn),e.Add$1(p))}},this.UpdateNodesCache=function(t,e){this.FBlockUpdateNode||(this.UpdateScrollBars(!0,!1),this.UpdateVisualRange(),this.UpdateNodeCache(),this.UpdateScrollBars(!0,!1),t?(e&&this.ResetNodes(!1),this.UpdateAutoSizing(),this.UpdateColumnRowCalculations(!1),this.UpdateNodesCache(!1,!1),this.UpdateVisualRange()):(this.UpdateNodeDisplay(),this.UpdateInplaceEditorPosition()))},this.UpdateNodeCache=function(){var t=null,e=0,i=0,s=0,n=null;if(!(this.FUpdateCount$1>0||3 in this.FComponentState||null==this.FNodeCache)&&(this.FNodeCache.Clear(),this.FColumnCount>0)){(t=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),t.FBitmapContainer=this.GetBitmapContainer(),t.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing;try{e=this.GetVerticalScrollPosition(),i=e+this.StartOffset();for(var o=this.StartRow(),r=this.StopRow();o<=r&&(s=o,null==(n=this.GetVisibleNodeForIndex(s))||!this.ConfigureNode(t,s,n,{get:function(){return i},set:function(t){i=t}}));o++);this.CustomizeNodeCache(t,i)}finally{t.EndScene(),t=rtl.freeLoc(t)}}},this.CustomizeNodeCache=function(t,e){},this.UpdateDisplay=function(){pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.UpdateDisplay.call(this),this.UpdateNodesCache(!1,!1),this.UpdateGroupsDisplay(),this.UpdateColumnsDisplay(),this.Invalidate()},this.UpdateTreeViewCache=function(){this.FUpdateCount$1>0||this.IsDestroying()||(pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.UpdateTreeViewCache.call(this),this.Invalidate())},this.UpdateColumnsDisplay=function(){this.BuildDisplay(this.FColumnsTopCache,this.FColumnsTopDisplay),this.BuildDisplay(this.FColumnsBottomCache,this.FColumnsBottomDisplay)},this.UpdateGroupsDisplay=function(){this.BuildDisplay(this.FGroupsTopCache,this.FGroupsTopDisplay),this.BuildDisplay(this.FGroupsBottomCache,this.FGroupsBottomDisplay)},this.UpdateNodeDisplay=function(){this.BuildDisplay(this.FNodeCache,this.FNodeDisplay)},this.VerticalScrollPositionChanged=function(){this.FBlockScrollingUpdate=!0,this.UpdateDisplay(),this.FBlockScrollingUpdate=!1,this.DoVScroll(this.GetVScrollValue())},this.Scroll=function(t,e){var i=0,s=0;i=this.GetHorizontalScrollPosition(),s=this.GetVerticalScrollPosition(),pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.Scroll.apply(this,arguments),i!==t&&this.DoHScroll(t),s!==e&&this.DoVScroll(e)},this.HorizontalScrollPositionChanged=function(){this.FBlockScrollingUpdate=!0,this.UpdateDisplay(),this.FBlockScrollingUpdate=!1,this.DoHScroll(this.GetHScrollValue())},this.DrawNode=function(t,e,i,s,n,o){},this.DrawGroup=function(t,e,i,s,n,o){},this.DrawColumn=function(t,e,i,s){},this.DrawNodes=function(t){this.DrawDisplay(t,this.FNodeDisplay)},this.DrawColumns=function(t){this.DrawDisplay(t,this.FColumnsTopDisplay),this.DrawDisplay(t,this.FColumnsBottomDisplay)},this.DrawNodeColumns=function(t){},this.DrawGroups=function(t){this.DrawDisplay(t,this.FGroupsTopDisplay),this.DrawDisplay(t,this.FGroupsBottomDisplay)},this.DrawBorders=function(t){},this.DrawEmptySpaces=function(t){},this.DrawDisplay=function(e,i){var s,n=0,o=null,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(0!==i.GetCount()){s=e.SaveState(!1),t.TTMSFNCTreeViewNodeDisplayList.isPrototypeOf(i)?(r.$assign(this.GetContentClipRect()),r.Right=r.Right+1):t.TTMSFNCTreeViewGroupsTopDisplayList.isPrototypeOf(i)?(r.$assign(this.GetGroupsTopRect()),r.Bottom=r.Bottom+1):t.TTMSFNCTreeViewGroupsBottomDisplayList.isPrototypeOf(i)?(r.$assign(this.GetGroupsBottomRect()),r.Top=r.Top-1):t.TTMSFNCTreeViewColumnsTopDisplayList.isPrototypeOf(i)?(r.$assign(this.GetColumnsTopRect()),r.Bottom=r.Bottom+1):t.TTMSFNCTreeViewColumnsBottomDisplayList.isPrototypeOf(i)&&(r.$assign(this.GetColumnsBottomRect()),r.Top=r.Top-1),e.ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r));for(var a=0,l=i.GetCount()-1;a<=l;a++)n=a,o=i.GetItem(n),t.TTMSFNCTreeViewNodeDisplayList.isPrototypeOf(i)?null!=o.FNode&&this.DrawNode(e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o.FDrawRect),o.FNode,!1,0,0):t.TTMSFNCTreeViewColumnsDisplayList.isPrototypeOf(i)?this.DrawColumn(e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o.FDrawRect),o.FColumn,o.FKind):t.TTMSFNCTreeViewGroupsDisplayList.isPrototypeOf(i)&&this.DrawGroup(e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o.FDrawRect),o.FGroup,o.FStartColumn,o.FEndColumn,o.FKind);e.RestoreState(s,!1)}},this.HandleDragStart=function(t,e){},this.HandleDragOver=function(e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleDragOver.apply(this,arguments),this.FBlockUserInput||null!=this.FOnDragOver||(this.AlternativeDragDrop()||(this.FDragMode$1=!1,this.FDragModeStarted=!1,this.FIsMouseDown=!1),null!=this.FOnCustomDragOver?this.FOnCustomDragOver(this,e,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(i),s):(s.set(0!==this.FInteraction.FDragDropMode&&t.TTMSFNCCustomTreeView.isPrototypeOf(e)&&null!=rtl.as(e,t.TTMSFNCCustomTreeView).FDragNode),s.set(s.get()&&pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetNodesRect(),i))),this.FAccepted=s.get())},this.HandleDragDrop=function(e,i){var s=null,n=null,o=!1;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleDragDrop.apply(this,arguments),!this.FBlockUserInput&&null==this.FOnDragDrop)if(null!=this.FOnCustomDragDrop)this.FOnCustomDragDrop(this,e,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(i));else if(this.FAccepted&&null!=e&&t.TTMSFNCCustomTreeView.isPrototypeOf(e)&&0!==rtl.as(e,t.TTMSFNCCustomTreeView).FInteraction.FDragDropMode&&null!=(n=rtl.as(e,t.TTMSFNCCustomTreeView).FDragNode)&&(s=this.XYToNode(i.X,i.Y,0))!==n&&null!=n.FNode&&pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetNodesRect(),i)&&(o=!0,this.DoBeforeDropNode(n,s,{get:function(){return o},set:function(t){o=t}}),o)){if(this.BeginUpdate(),rtl.as(e,t.TTMSFNCCustomTreeView).BeginUpdate(),null!=s&&null!=s.FNode){var r=rtl.as(e,t.TTMSFNCCustomTreeView).FInteraction.FDragDropMode;1===r?n.FNode.MoveTo(s.FNode,s.FNode.GetIndex()):2===r&&n.FNode.CopyTo(s.FNode,s.FNode.GetIndex())}else{this.FNodes.Add$1().Assign(n.FNode);var a=rtl.as(e,t.TTMSFNCCustomTreeView).FInteraction.FDragDropMode;1===a&&n.FNode.TreeView().RemoveNode(n.FNode)}rtl.as(e,t.TTMSFNCCustomTreeView).FDragNode=null,rtl.as(e,t.TTMSFNCCustomTreeView).EndUpdate(),this.EndUpdate(),this.DoAfterDropNode(n,s)}},this.HandleMouseDown=function(t,i,s,n){var o=null;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),1===t||this.FBlockUserInput||this.FBlockMouseClick||(this.FDblClicked||this.CaptureEx(),this.FDragMode$1=!1,this.FDragModeStarted=!1,this.FReorderMode=!1,this.FDragNode=null,this.FDblClicked||(this.CanFocus()&&this.SetFocus(),this.FInplaceEditorActive&&this.CloseInplaceEditor(!1,!1)),o=this.XYToCacheItem(s,n,0),this.FDownNode=null,null!=o&&(this.FDownNode=o.FNode,this.FSelectedNodes.IndexOf(this.FDownNode)>-1&&(this.FDragNode=this.FDownNode,this.FDragMode$1=!(null==this.FDownNode||0===this.FInteraction.FDragDropMode||this.FDblClicked||this.XYToNodeExpand(this.FDownNode,s,n)||this.XYToNodeExtra(this.FDownNode,s,n)||this.XYToNodeTitleExtra(this.FDownNode,s,n)||null!=this.XYToNodeCheck(this.FDownNode,s,n).ANode),this.FReorderMode=null!=this.FDownNode&&this.FInteraction.FReorder&&!this.FDragMode$1&&!this.FDblClicked&&!this.XYToNodeExpand(this.FDownNode,s,n)&&!this.XYToNodeExtra(this.FDownNode,s,n)&&!this.XYToNodeTitleExtra(this.FDownNode,s,n)&&!(null!=this.XYToNodeCheck(this.FDownNode,s,n).ANode),this.FReorderMode&&(this.CreateDragBitmap(),this.FSaveDragY=this.FDragBitmap.GetTop()))),this.FDragMode$1?(this.CanStartDragFromMouseDown()&&(this.FDragModeStarted=!0,this.HandleDragStart(s,n),this.BeginDrag$1()),this.FIsMouseDown=!this.FDblClicked):(null!=this.FDownNode&&(this.FDoNodeExpand=this.XYToNodeExpand(this.FDownNode,s,n),this.FDoNodeCheck.$assign(this.XYToNodeCheck(this.FDownNode,s,n)),this.FDoNodeAnchor.$assign(this.XYToNodeAnchor(this.FDownNode,s,n)),this.FDoNodeTitleAnchor.$assign(this.XYToNodeTitleAnchor(this.FDownNode,s,n)),this.FDoNodeExtra=this.XYToNodeExtra(this.FDownNode,s,n),this.FDoNodeTitleExtra=this.XYToNodeTitleExtra(this.FDownNode,s,n)),this.FSizeColumn=-1,this.FInteraction.FColumnSizing&&(this.FSizeColumn=this.XYToColumnSize(s,n),this.FSizeColumn>=0&&this.FSizeColumn<=this.FColumnCount-1&&(this.FColumnSize=this.GetColWidths(this.FSizeColumn))),this.FDownColumn=this.XYToColumn(s,n,!1),this.FDownColumnFilter=this.XYToColumnFilter(s,n),this.FDownColumnExpand=this.XYToColumnExpand(s,n),this.FIsMouseDown=!this.FDblClicked,this.FTimeStart=e.GetTickCountX(),this.FTimeStop=this.FTimeStart,this.FScrollVTo=this.GetVScrollValue(),this.FScrollHTo=this.GetHScrollValue(),this.FScrollX=s,this.FScrollY=n,this.FDownX=s,this.FDownY=n,this.FMouseX=s,this.FMouseY=n,this.FSizeX=s,this.FDragY=n,this.FVerticalOffset=0,this.FVerticalOffsetTo=0,this.FMouseUp=!1,this.FDoubleSelection=!this.FAnimateTimer.FEnabled,this.FScrolling=!1),this.FDblClicked=!1)},this.HandleMouseMove=function(t,e,i){var s=0,n=null,o=null,r=0,a=!1,l=0,h=0,F=0,p=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),c=null,u=!1,T=!1,C=0,S=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),!(this.FBlockUserInput||this.FAnimating&&!this.FIsMouseDown)){if(this.FY=i,this.FX=e,this.FIsMouseDown&&this.FDragMode$1&&this.CanStartDragFromMouseMove()&&(Math.abs(this.FY-this.FDownY)>10||Math.abs(this.FX-this.FDownX)>10))return this.FDragModeStarted||this.HandleDragStart(e,i),this.FDragModeStarted=!0,void(this.AlternativeDragDrop()?this.HandleAlternativeDragOver(e,i):this.BeginDrag$1());if(this.FReorderMode&&null!=this.FDragBitmap&&this.FInteraction.FReorder)return p.$assign(this.GetContentClipRect()),(F=this.FSaveDragY+(this.FY-this.FDragY))<=p.Top+(p.Bottom-p.Top)-this.FDragBitmap.GetHeight()&&F>=p.Top?(this.FDragBitmap.SetTop(Math.round(Math.max(p.Top,Math.min(p.Top+(p.Bottom-p.Top)-this.FDragBitmap.GetHeight(),F)))),this.FSaveDragY=this.FDragBitmap.GetTop(),this.FDragTimer.SetEnabled(!1),F>p.Top&&F<p.Top+(p.Right-p.Left)&&null!=(c=this.XYToNode((p.Right-p.Left)/2,F,0))&&(this.FDragRow=c.FRow)):F>p.Top+(p.Bottom-p.Top)-this.FDragBitmap.GetHeight()?(this.FDragBitmap.SetTop(Math.round(p.Top+(p.Bottom-p.Top)-this.FDragBitmap.GetHeight())),this.FSaveDragY=F,this.FDragTimer.SetEnabled(!0)):F<p.Top&&(this.FDragBitmap.SetTop(Math.round(p.Top)),this.FSaveDragY=F,this.FDragTimer.SetEnabled(!0)),void(this.FDragY=this.FY);if(this.FSizeColumn>=0&&this.FSizeColumn<=this.FColumnCount-1)return a=!0,l=this.FColumnSize,this.FColumnSize=l+(e-this.FSizeX),h=Math.max(0,this.FColumnSize),this.FSizeX=e,this.DoBeforeSizeColumn(this.FSizeColumn,l,{get:function(){return h},set:function(t){h=t}},{get:function(){return a},set:function(t){a=t}}),void(a&&(this.SetColWidths(this.FSizeColumn,h),this.FSizeColumn>=0&&this.FSizeColumn<=this.FColumns.GetCount()-1&&this.FColumns.GetItem$1(this.FSizeColumn).UpdateWidth(h),this.DoAfterSizeColumn(this.FSizeColumn,h),this.ResetNodes(!0),this.UpdateTreeView(),this.Invalidate()));if(this.FIsMouseDown&&""===this.FDoNodeAnchor.AAnchor&&""===this.FDoNodeTitleAnchor.AAnchor){if(!(this.FDoNodeExpand||null!=this.FDoNodeCheck.ANode)){s=1;var d=this.FScrollMode;1===d&&(s=.1),a=!0,this.ScrollLimitation()&&Math.abs(i-this.FMouseY)<15&&(a=Math.abs(e-this.FMouseX)<5),(this.FScrolling||Math.abs(this.FMouseX-e)>3||Math.abs(this.FMouseY-i)>3)&&this.FInteraction.FTouchScrolling&&a&&(this.FDragTimer.SetEnabled(!1),(Math.abs(e-this.FDownX)>0||Math.abs(i-this.FDownY)>0)&&(this.FScrolling=!0,this.FDoubleSelection=!1,this.FIsMouseDown&&!this.FMouseUp&&(u=this.CanScrollUp(),T=this.CanScrollDown(),u&&i-this.FDownY>0||T&&i-this.FDownY<0&&0===this.FVerticalOffset?(this.FVerticalOffset=0,this.Scroll(this.GetHScrollValue()-(e-this.FDownX)*s,this.GetVScrollValue()-(i-this.FDownY)*s)):this.CanApplyVerticalOffset()?(this.FVerticalOffset=Math.min(75,Math.max(-75,this.FVerticalOffset+(i-this.FDownY))),this.UpdateDisplay()):this.Scroll(this.GetHScrollValue()-(e-this.FDownX)*s,this.GetVScrollValue()),this.FDownY=i,this.FDownX=e)))}}else n=null,null!=(o=this.XYToCacheItem(e,i,0))&&(n=o.FNode),C=0,null!=n&&null!=o?!this.FInteraction.FURLDetectionOnMouseMove||""===this.XYToNodeAnchor(n,e,i).AAnchor&&""===this.XYToNodeTitleAnchor(n,e,i).AAnchor||(C=21):this.FInteraction.FColumnSizing&&(r=this.XYToColumnSize(e,i))>=0&&r<=this.FColumnCount-1&&(C=9),S=-1,""!==this.XYToColumnAnchor(e,i,{get:function(){return S},set:function(t){S=t}})&&(C=21),C!==this.FCursor&&this.SetControlCursor(C),this.FPrevDSP!==o&&(null!=this.FPrevDSP&&null!=this.FPrevDSP.FNode&&this.DoNodeMouseLeave(this.FPrevDSP.FNode),null!=o&&null!=o.FNode&&this.DoNodeMouseEnter(o.FNode)),this.FPrevDSP=o}},this.HandleDblClick=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),s=null,n=0,o=!1,r=!1,a=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleDblClick.apply(this,arguments),this.FBlockUserInput||(this.FDblClicked=!0,i.$assign(pas["WEBLib.TMSFNCTypes"].PointF(t,e)),this.FDownNode=null,null!=(s=this.XYToNode(i.X,i.Y,0))?this.XYToNodeExpand(s,i.X,i.Y)||null!=this.XYToNodeCheck(s,i.X,i.Y).ANode||(this.FDownNode=s,null!=this.FDownNode&&(o=!0,this.DoIsNodeEnabled(this.FDownNode,{get:function(){return o},set:function(t){o=t}}),o&&(r=!1,this.DoIsNodeExtended(this.FDownNode,{get:function(){return r},set:function(t){r=t}}),this.FCompactMode||!(r&&this.FInteraction.FExtendedSelectable&&this.FInteraction.FExtendedEditable)&&r||0!==this.FInteraction.FMouseEditMode||this.FInteraction.FReadOnly?this.FInteraction.FExpandCollapseOnDblClick&&this.HandleNodeToggle(this.FDownNode):-1!==(a=this.XYToNodeTextColumn(this.FDownNode,i.X,i.Y))&&this.HandleNodeEditing(this.FDownNode,a)),this.DoNodeDblClick(this.FDownNode))):(n=this.XYToColumnSize(i.X,i.Y),this.FInteraction.FColumnAutoSizeOnDblClick&&this.AutoSizeColumn(n)),this.FIsMouseDown=!1,this.FMouseUp=!0,this.FScrolling=!1,this.FDoNodeExpand=!1,this.FDoNodeExtra=!1,this.FDoNodeTitleExtra=!1,this.FDoNodeAnchor.AAnchor="",this.FDoNodeAnchor.AColumn=-1,this.FDoNodeTitleAnchor.AAnchor="",this.FDoNodeTitleAnchor.AColumn=-1,this.FDownColumn=-1,this.FDownColumnFilter=-1,this.FDownColumnExpand=-1,this.FReorderMode=!1,this.FDragMode$1=!1,this.FDragModeStarted=!1)},this.DoNeedFilterDropDownData=function(t,e){null!=this.FOnNeedFilterDropDownData&&this.FOnNeedFilterDropDownData(this,t,e)},this.DoFilterSelect=function(t,e){null!=this.FOnFilterSelect&&this.FOnFilterSelect(this,t,e)},this.HandleFilter=function(e){var i=null,s=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),n=null,o="",r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),l=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),h=0,F=0,p=0;if(e>=0&&e<=this.FColumns.GetCount()-1&&this.FColumns.GetItem$1(e).FFiltering.FEnabled&&(F=this.GetColWidths(e))>=0){p=this.GetColPos(e),i=pas.Classes.TStringList.$create("Create$1");try{for(i.FDuplicates=0,i.SetSorted(!0),i.Add(rtl.getResStr(t,"sTMSFNCTreeViewFilterAll")),n=this.GetFirstRootVirtualNode();null!=n;)o="",this.DoGetNodeText(n,e,0,{get:function(){return o},set:function(t){o=t}}),""!==(o=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(o))&&i.Add(o),n=n.GetNext();this.DoNeedFilterDropDownData(e,i),this.FFilterListBox.SetParent(this),this.FFilterListBox.FItems.Assign(i),this.FFilterListBox.SetItemIndex(-1),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(this.FFilterListBox.FFont,16,1),this.FFilterListBox.SetParent(null),this.FFilterListBox.FTag$1=e}finally{i=rtl.freeLoc(i)}this.FFilterPopup.SetPlacementControl(this),r.$assign(this.GetColumnsTopRect()),r.Left=r.Left-this.GetHorizontalScrollPosition(),a.$assign(pas["WEBLib.TMSFNCTypes"].RectF(r.Left+p,r.Top,r.Left+p+F,r.Bottom)),h=this.FColumns.GetItem$1(e).FFiltering.FButtonSize,l.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(a.Right-h-this.ScalePaintValue(4)),Math.round(a.Top+(a.Bottom-a.Top-h)/2),Math.round(a.Right-this.ScalePaintValue(4)),Math.round(a.Top+(a.Bottom-a.Top-h)/2+h))),s.$assign(this.LocalToScreenEx(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(l.Left+(l.Right-l.Left)-h-this.ScalePaintValue(2),l.Top+(l.Bottom-l.Top+h)/2)))),this.FFilterPopup.FPlacementRectangle.SetLeft(s.X),this.FFilterPopup.FPlacementRectangle.SetTop(s.Y),this.FFilterListBox.SetWidth(this.FColumns.GetItem$1(e).FFiltering.FDropDownWidth),this.FFilterListBox.SetHeight(this.FColumns.GetItem$1(e).FFiltering.FDropDownHeight),this.FFilterPopup.SetDropDownHeight(this.FColumns.GetItem$1(e).FFiltering.FDropDownHeight),this.FFilterPopup.SetDropDownWidth(this.FColumns.GetItem$1(e).FFiltering.FDropDownWidth),this.FFilterPopup.FPlacementRectangle.SetRight(s.X+this.FFilterPopup.FDropDownWidth),this.FFilterPopup.FPlacementRectangle.SetBottom(s.Y+this.FFilterPopup.FDropDownHeight),this.FFilterPopup.SetContentControl(this.FFilterListBox),this.FFilterPopup.FFocusedControl=this.FFilterListBox,this.FFilterPopup.Popup(!1)}},this.HandleExpand=function(t){},this.HandleMouseUp=function(i,s,n,o){var r=0,a=t.TTMSFNCTreeViewNodeAnchor.$new(),l=0,h="",F=!1,p=!1,c=!1,u=!1,T=0,C=0,S=null,d=null,m=!1,f=0,g=!1,y=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),1!==i&&!this.FBlockUserInput&&(this.ReleaseCaptureEx(),this.FDragMode$1&&this.FDragModeStarted&&this.AlternativeDragDrop()&&(this.HandleAlternativeDragDrop(n,o),this.DestroyDragBitmap(),this.SetControlCursor(0)),f=this.FSizeColumn,this.FSizeColumn=-1,this.FDragTimer.SetEnabled(!1),this.FIsMouseDown)){this.FReorderMode&&this.FInteraction.FReorder&&(S=this.XYToNode(n,o,0),null!=this.FOnCustomReorder?this.FOnCustomReorder(this,this.FDragNode,S):null!=S&&S!==this.FDragNode&&null!=S.FNode&&null!=this.FDragNode.FNode&&(m=!0,this.DoBeforeReorderNode(this.FDragNode,S,{get:function(){return m},set:function(t){m=t}}),m&&(this.FDragNode.FLevel===S.FLevel&&(null===S.FNode.GetParent()?this.FDragNode.FNode.SetIndex(S.FNode.GetIndex()):this.FDragNode.FNode.MoveTo(S.FNode.GetParent(),S.FNode.GetIndex())),this.DoAfterReorderNode(this.FDragNode,S))),this.DestroyDragBitmap(),this.FDragNode=null),r=1;var b=this.FScrollMode;if(1===b&&(r=.1),this.FIsMouseDown=!1,this.FMouseUp=!0,this.FScrolling=!1,-1!==this.FDownColumnFilter)this.HandleFilter(this.FDownColumnFilter);else if(-1!==this.FDownColumnExpand)this.HandleExpand(this.FDownColumnExpand);else if(-1!==this.FDownColumn&&-1===f){if(this.FDownColumn>=0&&this.FDownColumn<=this.FColumnCount-1){if(0!==this.FColumns.GetItem$1(this.FDownColumn).FSorting){var N=this.FColumns.GetItem$1(this.FDownColumn).FSortKind;0===N||1===N?(this.InitializeColumnSorting(this.FDownColumn,1),null!=this.FOnCustomColumnSort?this.FOnCustomColumnSort(this,this.FDownColumn,1):(this.DoBeforeSortNodes(this.FDownColumn,1,{get:function(){return g},set:function(t){g=t}}),g&&(this.FNodes.Sort$1(this.FDownColumn,this.FColumns.GetItem$1(this.FDownColumn).FSorting in rtl.createSet(2,4),this.FColumns.GetItem$1(this.FDownColumn).FSorting in rtl.createSet(3,4),1,!0),this.DoAfterSortNodes(this.FDownColumn,1)))):2===N&&(this.InitializeColumnSorting(this.FDownColumn,0),null!=this.FOnCustomColumnSort?this.FOnCustomColumnSort(this,this.FDownColumn,0):(this.DoBeforeSortNodes(this.FDownColumn,0,{get:function(){return g},set:function(t){g=t}}),g&&(this.FNodes.Sort$1(this.FDownColumn,this.FColumns.GetItem$1(this.FDownColumn).FSorting in rtl.createSet(2,4),this.FColumns.GetItem$1(this.FDownColumn).FSorting in rtl.createSet(3,4),0,!0),this.DoAfterSortNodes(this.FDownColumn,0))))}l=-1,""!==(h=this.XYToColumnAnchor(n,o,{get:function(){return l},set:function(t){l=t}}))&&this.DoColumnAnchorClick(this.FDownColumn,h)}}else if(!this.FReorderMode&&!this.FDragModeStarted)if(this.FDoNodeExpand||this.FDoNodeExtra||this.FDoNodeTitleExtra||null!=this.FDoNodeCheck.ANode||""!==this.FDoNodeAnchor.AAnchor||""!==this.FDoNodeTitleAnchor.AAnchor)this.FCompactMode||(this.FDoNodeExpand?this.HandleNodeToggle(this.FDownNode):this.FDoNodeExtra?this.HandleNodeExtra(this.FDownNode):this.FDoNodeTitleExtra?this.HandleNodeTitleExtra(this.FDownNode):null==this.FDoNodeCheck.ANode||this.FInteraction.FReadOnly?(a.$assign(this.XYToNodeAnchor(this.FDownNode,n,o)),""!==a.AAnchor&&this.DoNodeAnchorClick(this.FDownNode,a.AColumn,a.AAnchor),a.$assign(this.XYToNodeTitleAnchor(this.FDownNode,n,o)),""!==a.AAnchor&&this.DoNodeTitleAnchorClick(this.FDownNode,a.AColumn,a.AAnchor)):this.HandleNodeToggleCheck(this.FDownNode,this.FDoNodeCheck.AColumn));else if(!this.FDoubleSelection&&this.FInteraction.FTouchScrolling)this.FTimeStop=e.GetTickCountX(),0===this.FVerticalOffset&&this.FTimeStop-this.FTimeStart<300&&this.FTimeStop-this.FTimeStart>0?(this.FSpY=Math.abs(o-this.FScrollY)/(this.FTimeStop-this.FTimeStart),this.FSpY>0&&(o-this.FScrollY>0?this.FScrollVTo=Math.max(0,Math.min(this.VerticalScrollBar().FMax-this.GetVViewPortSize(),this.FScrollVTo-Math.round(Math.abs(o-this.FScrollY)*this.FSpY*r*3))):this.FScrollVTo=Math.max(0,Math.min(this.VerticalScrollBar().FMax-this.GetVViewPortSize(),this.FScrollVTo+Math.round(Math.abs(o-this.FScrollY)*this.FSpY*r*3))),this.FAnimateVerticalPos=!0,this.FAnimateTimer.SetEnabled(!0)),this.FSpX=Math.abs(n-this.FScrollX)/(this.FTimeStop-this.FTimeStart),this.FSpX>0&&(n-this.FScrollX>0?this.FScrollHTo=Math.max(0,Math.min(this.HorizontalScrollBar().FMax-this.GetHViewPortSize(),this.FScrollHTo-Math.round(Math.abs(n-this.FScrollX)*this.FSpX*r*3))):this.FScrollHTo=Math.max(0,Math.min(this.HorizontalScrollBar().FMax-this.GetHViewPortSize(),this.FScrollHTo+Math.round(Math.abs(n-this.FScrollX)*this.FSpX*r*3))),this.FAnimateHorizontalPos=!0,this.FAnimateTimer.SetEnabled(!0))):this.CanApplyVerticalOffset()&&(this.NeedsReload(this.FVerticalOffset)&&this.StartReload(),this.StartVerticalOffsetAnimation());else if(null!=this.FDownNode&&!this.FBlockMouseClick){if(F=this.IsVirtualNodeSelectable(this.FDownNode),d=this.FFocusedNode,c=F,F)if(0 in s&&1 in this.FInteraction.FMultiSelectStyle){if(null!=this.FFocusedNode)if(y=3 in this.FInteraction.FMultiSelectStyle&&this.FFocusedNode.FParentNode!==this.FDownNode.FParentNode?0:1,this.FFocusedNode.FRow<=this.FDownNode.FRow)for(var M=this.FFocusedNode.FRow+y,B=this.FDownNode.FRow;M<=B;M++)T=M,this.HandleSelectNode(this.GetNodeFromNodeStructure(T),!0,!1,0 in s&&this.FInteraction.FMultiSelect);else for(var E=this.FFocusedNode.FRow-y,L=this.FDownNode.FRow;E>=L;E--)T=E,this.HandleSelectNode(this.GetNodeFromNodeStructure(T),!0,!1,0 in s&&this.FInteraction.FMultiSelect)}else 3 in this.FInteraction.FMultiSelectStyle&&null!=this.FFocusedNode&&this.FDownNode.FParentNode!==this.FFocusedNode.FParentNode&&this.FSelectedNodes.GetCount()>0?this.FSelectedNodes.Clear():(!(2 in s)&&!(pas.Classes.TShiftState$a.ssCtrl in s)||!(0 in this.FInteraction.FMultiSelectStyle))&&this.FSelectedNodes.GetCount()>0&&this.UnSelectVirtualNode(this.FDownNode),this.HandleSelectNode(this.FDownNode,!0,!1,(2 in s||pas.Classes.TShiftState$a.ssCtrl in s)&&0 in this.FInteraction.FMultiSelectStyle&&this.FInteraction.FMultiSelect);c&&this.FFocusedNode!==this.FDownNode&&(this.FFocusedNode=this.FDownNode,this.DoFocusedNodeChanged(this.FFocusedNode)),this.FCompactMode||1!==this.FInteraction.FMouseEditMode&&(2!==this.FInteraction.FMouseEditMode||this.FDownNode!==d)||this.FInteraction.FReadOnly||null!=this.FDownNode&&(u=!1,this.DoIsNodeExtended(this.FDownNode,{get:function(){return u},set:function(t){u=t}}),p=!0,this.DoIsNodeEnabled(this.FDownNode,{get:function(){return p},set:function(t){p=t}}),a.$assign(this.XYToNodeTitleAnchor(this.FDownNode,n,o)),""!==a.AAnchor&&this.DoNodeTitleAnchorClick(this.FDownNode,a.AColumn,a.AAnchor),a.$assign(this.XYToNodeAnchor(this.FDownNode,n,o)),p&&""!==a.AAnchor?this.DoNodeAnchorClick(this.FDownNode,a.AColumn,a.AAnchor):(u&&this.FInteraction.FExtendedSelectable&&this.FInteraction.FExtendedEditable||!u)&&p&&-1!==(C=this.XYToNodeTextColumn(this.FDownNode,n,o))&&this.FDownNode.GetTitleExpanded(C)&&this.HandleNodeEditing(this.FDownNode,C)),this.Invalidate()}this.FDoNodeExpand=!1,this.FDoNodeExtra=!1,this.FDoNodeTitleExtra=!1,this.FDoNodeAnchor.AAnchor="",this.FDoNodeAnchor.AColumn=-1,this.FDoNodeTitleAnchor.AAnchor="",this.FDoNodeTitleAnchor.AColumn=-1,this.FDownColumn=-1,this.FDownColumnFilter=-1,this.FDownColumnExpand=-1,this.FReorderMode=!1,this.FDragMode$1=!1,this.FDragModeStarted=!1}},this.StartVerticalOffsetAnimation=function(){this.FAnimateVerticalOffset=!0,this.FAnimateTimer.SetEnabled(!0)},this.ClearFocusedNode=function(t){t!==this.FFocusedNode&&null!==t||(this.FFocusedNode=null)},this.HandleKeyPress=function(t){var e=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyPress.apply(this,arguments),this.FBlockUserInput||(e=t.get().charCodeAt(),this.FInteraction.FLookup.FEnabled&&(e in rtl.createSet(27,45,46,38,40,37,39,36,35,33,34,9,0)?this.FLookupString="":(this.FInteraction.FLookup.FIncremental?this.FLookupString=this.FLookupString+t.get():this.FLookupString=t.get(),null!=this.FOnCustomLookup?this.FOnCustomLookup(this,this.FLookupString):this.LookupNode(this.FLookupString,this.FInteraction.FLookup.FRootNodesOnly,this.FInteraction.FLookup.FColumn,this.FInteraction.FLookup.FCaseSensitive,this.FInteraction.FLookup.FAutoSelect,this.FInteraction.FLookup.FAutoExpand))))},this.HandleKeyDown=function(t,e){var i=null,s=null,n=null,o=!1,r=!1,a=!1,l=!1,h=0,F=0,p=!1,c=!1,u=null;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyDown.apply(this,arguments),!this.FInplaceEditorClosed&&!this.FBlockUserInput){if(t.get()in rtl.createSet(27,45,46,38,40,37,39,36,35,33,34,9,106,109,107,111)&&(this.FLookupString=""),2 in e||pas.Classes.TShiftState$a.ssCtrl in e){var T=t.get();if(65===T)return void(this.FInteraction.FMultiSelect&&(this.DoBeforeSelectAllNodes({get:function(){return o},set:function(t){o=t}}),o&&(this.SelectAllNodes(),this.DoAfterSelectAllNodes())));if(88===T)return void(0!==this.FInteraction.FClipboardMode&&(p=!0,this.DoBeforeCutToClipboard({get:function(){return p},set:function(t){p=t}}),p&&(this.CutToClipboard(1===this.FInteraction.FClipboardMode),this.DoAfterCutToClipboard())));if(67===T)return void(0!==this.FInteraction.FClipboardMode&&(p=!0,this.DoBeforeCopyToClipboard({get:function(){return p},set:function(t){p=t}}),p&&(this.CopyToClipboard(1===this.FInteraction.FClipboardMode),this.DoAfterCopyToClipboard())));if(86===T)return void(0!==this.FInteraction.FClipboardMode&&(p=!0,this.DoBeforePasteFromClipboard({get:function(){return p},set:function(t){p=t}}),p&&(this.PasteFromClipboard(),this.DoAfterPasteFromClipboard())))}i=this.GetFocusedVirtualNode(),a=!1,l=!1;var C=t.get();18===C||17===C||16===C?i=null:33===C?(l=!0,null!=i&&(h=i.FRow-(this.StopRow()-this.StartRow()),null!=(i=this.GetNodeFromNodeStructure(h))&&(this.IsVirtualNodeSelectable(i)||(i=this.GetPreviousFocusableNode(i))),null==i&&(i=this.GetNextFocusableNode(null)))):34===C?(a=!0,null!=i&&(h=i.FRow+(this.StopRow()-this.StartRow()),null!=(i=this.GetNodeFromNodeStructure(h))&&(this.IsVirtualNodeSelectable(i)||(i=this.GetNextFocusableNode(i))),null==i&&(i=this.GetPreviousFocusableNode(null)))):36===C?(i=this.GetNextFocusableNode(null),l=!0):35===C?(i=this.GetPreviousFocusableNode(null),l=!0):40===C?this.FInteraction.FMultiSelect&&(!this.FInteraction.FMultiSelect||3 in this.FInteraction.FMultiSelectStyle&&2 in e)||(i=this.GetNextFocusableNode(i),a=!0):38===C?3 in this.FInteraction.FMultiSelectStyle&&this.FInteraction.FMultiSelect&&2 in e||(i=this.GetPreviousFocusableNode(i),l=!0):37===C||109===C||111===C?this.HandleNodeCollapse(i,111===t.get()):39===C||107===C||106===C?this.HandleNodeExpand(i,106===t.get()):32===C&&this.DoNodeClick(i);var S=t.get();if(37!==S&&39!==S||this.HandleCustomKeys(t.get()),r=!1,32===t.get()&&(r=!0),null!=i){if(this.FInteraction.FSelectionFollowsFocus&&(a||l)||r&&(2 in e||pas.Classes.TShiftState$a.ssCtrl in e)){if(0 in e){if(this.FSelectedNodes.GetCount()>1&&(s=this.FSelectedNodes.GetItem(this.FSelectedNodes.GetCount()-1),n=this.FSelectedNodes.GetItem(0),l&&i.FRow<s.FRow&&i.FRow>=n.FRow||a&&i.FRow>s.FRow&&i.FRow<=n.FRow))if(s.FRow<=i.FRow)for(var d=s.FRow,m=i.FRow;d<=m;d++)F=d,null!=(u=this.GetNodeFromNodeStructure(F))&&(u!==i?(c=!0,this.DoBeforeUnSelectNode(u,{get:function(){return c},set:function(t){c=t}}),c&&(this.UnSelectVirtualNode(u),this.DoAfterUnSelectNode(u))):this.UnSelectVirtualNode(u));else for(var f=s.FRow,g=i.FRow;f>=g;f--)F=f,null!=(u=this.GetNodeFromNodeStructure(F))&&(u!==i?(c=!0,this.DoBeforeUnSelectNode(u,{get:function(){return c},set:function(t){c=t}}),c&&(this.UnSelectVirtualNode(u),this.DoAfterUnSelectNode(u))):this.UnSelectVirtualNode(u))}else!(2 in e)&&!(pas.Classes.TShiftState$a.ssCtrl in e)&&(a||l)&&this.FSelectedNodes.GetCount()>0&&(c=!0,this.DoBeforeUnSelectNode(i,{get:function(){return c},set:function(t){c=t}}),c&&(this.UnSelectVirtualNode(i),this.DoAfterUnSelectNode(i)));if(0 in e){if(null!=this.FFocusedNode)if(this.FFocusedNode.FRow<=i.FRow)for(var y=this.FFocusedNode.FRow+1,b=i.FRow;y<=b;y++)F=y,this.HandleSelectNode(this.GetNodeFromNodeStructure(F),!0,!0,0 in e&&this.FInteraction.FMultiSelect);else for(var N=this.FFocusedNode.FRow-1,M=i.FRow;N>=M;N--)F=N,this.HandleSelectNode(this.GetNodeFromNodeStructure(F),!0,!0,0 in e&&this.FInteraction.FMultiSelect)}else this.HandleSelectNode(i,!0,!0,(2 in e||pas.Classes.TShiftState$a.ssCtrl in e)&&this.FInteraction.FMultiSelect)}else r&&this.HandleNodeToggleCheck(i,0);this.FFocusedNode!==i&&(this.FFocusedNode=i,this.DoFocusedNodeChanged(this.FFocusedNode)),a?this.ScrollToVirtualNode(this.FFocusedNode,!0,1,!1):this.ScrollToVirtualNode(this.FFocusedNode,!0,0,!1),this.Invalidate()}}},this.HandleDialogKey=function(t,e){var i=null,s=0,n=!1;this.FInplaceEditorClosed||this.FBlockUserInput||(null!=this.FInplaceEditor&&this.FInplaceEditorActive&&(27===t.get()||9===t.get()||113===t.get()||pas["WEBLib.StdCtrls"].TEdit.isPrototypeOf(this.FInplaceEditor)&&13===t.get())||pas["WEBLib.StdCtrls"].TMemo.isPrototypeOf(this.FInplaceEditor)&&13===t.get()&&!(2 in e))&&(this.FCloseWithDialogKey=!0,this.CloseInplaceEditor(27===t.get(),!1),9===t.get()&&null!=this.FFocusedNode&&(0 in e?(n=!1,this.DoIsNodeExtended(this.FFocusedNode,{get:function(){return n},set:function(t){n=t}}),this.FUpdateNodeColumn>this.GetFirstEditableColumn()&&!n?(this.HandleNodeEditing(this.FFocusedNode,this.GetPreviousEditableColumn(this.FUpdateNodeColumn)),this.Invalidate(),t.set(0)):null!=(i=this.GetPreviousFocusableNode(this.FFocusedNode))&&(n=!1,this.DoIsNodeExtended(i,{get:function(){return n},set:function(t){n=t}}),(n&&this.FInteraction.FExtendedEditable||!n)&&(s=n?0:this.GetLastEditableColumn(),this.FFocusedNode!==i&&(this.FFocusedNode=i,this.DoFocusedNodeChanged(this.FFocusedNode)),this.SelectVirtualNode(i),this.ScrollToVirtualNode(i,!0,0,!1),this.HandleNodeEditing(i,s),this.Invalidate(),t.set(0)))):(n=!1,this.DoIsNodeExtended(this.FFocusedNode,{get:function(){return n},set:function(t){n=t}}),this.FUpdateNodeColumn<this.GetLastEditableColumn()&&!n?(this.EditVirtualNode(this.FFocusedNode,this.GetNextEditableColumn(this.FUpdateNodeColumn)),t.set(0)):null!=(i=this.GetNextFocusableNode(this.FFocusedNode))&&(n=!1,this.DoIsNodeExtended(i,{get:function(){return n},set:function(t){n=t}}),(n&&this.FInteraction.FExtendedEditable||!n)&&(s=this.GetFirstEditableColumn(),this.FFocusedNode!==i&&(this.FFocusedNode=i,this.DoFocusedNodeChanged(this.FFocusedNode)),this.SelectVirtualNode(i),this.ScrollToVirtualNode(i,!0,1,!1),this.HandleNodeEditing(i,s),this.Invalidate(),t.set(0)))))),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleDialogKey.apply(this,arguments)},this.HandleFilterListClick=function(t){this.FFilterTimer.SetEnabled(!0)},this.HandleKeyUp=function(t,e){var i=!1,s=!1,n=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyUp.apply(this,arguments),!this.FBlockUserInput)if(this.FInplaceEditorClosed)this.FInplaceEditorClosed=!1;else if(this.FCloseWithDialogKey)this.FCloseWithDialogKey=!1;else if(null!=this.FFocusedNode&&!this.FCompactMode&&this.FInteraction.FKeyboardEdit&&!this.FInteraction.FReadOnly&&rtl.eqSet(e,{})){var o=t.get();113!==o&&13!==o||(i=!0,this.DoIsNodeEnabled(this.FFocusedNode,{get:function(){return i},set:function(t){i=t}}),i&&(s=!1,this.DoIsNodeExtended(this.FFocusedNode,{get:function(){return s},set:function(t){s=t}}),(s&&this.FInteraction.FExtendedSelectable&&this.FInteraction.FExtendedEditable||!s)&&-1!==(n=this.GetFirstEditableColumn())&&this.FFocusedNode.GetTitleExpanded(n)&&this.HandleNodeEditing(this.FFocusedNode,n)))}},this.HandleMouseWheel=function(t,e,i){var s=0,n=0,o=0,r=0,a=null;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseWheel.apply(this,arguments),this.FBlockUserInput||(s=this.GetVScrollValue(),n=this.GetHScrollValue(),r=e>0?this.StartRow()-1:this.StartRow(),null!=(a=this.GetVisibleNodeForIndex(r))?e>0?(o=a.FHeight*this.FInteraction.FMouseWheelDelta,this.Scroll(n,s-o)):(o=a.FHeight*this.FInteraction.FMouseWheelDelta,this.Scroll(n,s+o)):this.Scroll(n,0),i.set(!0))},this.HandleNodeEditing=function(e,i){var s=null,n=!1,o="",r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=pas.Types.TRect.$new();function l(t,e){var i=pas.Types.TPoint.$new();return i.x=t,i.y=e,i}if(null!=e&&i>=0&&i<=this.FColumns.GetCount()-1){if(s=this.FColumns.GetItem$1(i),this.FInplaceEditorClass=null,!s.FCustomEditor){var h=s.FEditorType;if(0===h)this.FInplaceEditorClass=t.TTMSFNCTreeViewEdit;else if(1===h)this.FInplaceEditorClass=t.TTMSFNCTreeViewComboBox;else if(2===h)this.FInplaceEditorClass=t.TTMSFNCTreeViewMemo;else if(3===h)return}if(n=!0,this.DoBeforeOpenInplaceEditor(e,i,{get:function(){return n},set:function(t){n=t}}),n){if(this.DoGetInplaceEditor(e,i,{p:this,get:function(){return this.p.FInplaceEditorClass},set:function(t){this.p.FInplaceEditorClass=t}}),null!=this.FInplaceEditor&&(null!=this.FOldInplaceEditor&&rtl.free(this,"FOldInplaceEditor"),this.FOldInplaceEditor=this.FInplaceEditor,this.FInplaceEditor=null),null!=this.FInplaceEditorClass?this.FInplaceEditor=this.FInplaceEditorClass.$create("Create$1",[this]):this.FInplaceEditor=pas["WEBLib.StdCtrls"].TEdit.$create("Create$1",[this]),r.$assign(this.GetInplaceEditorRect(e,i)),null!=this.FInplaceEditor){this.FUpdateNode=e,this.FUpdateNodeColumn=i,this.FInplaceEditor.SetShowFocus(!1),this.FInplaceEditor.SetParent(this),this.FInplaceEditor.SetVisible(!1),a.$assign(pas.Types.Rect(Math.round(r.Left),Math.round(r.Top),Math.round(r.Right),Math.round(r.Bottom))),this.FInplaceEditor.SetBoundsRect(a),this.FInplaceEditor.SetBoundsRect(pas.Types.Rect(a.Left,a.Top+rtl.trunc((a.Bottom-a.Top-this.FInplaceEditor.GetHeight())/2),a.Right,a.Top+rtl.trunc((a.Bottom-a.Top-this.FInplaceEditor.GetHeight())/2)+this.FInplaceEditor.GetHeight())),this.FInplaceEditor.SetVisible(!0),1===s.FEditorType&&!s.FCustomEditor&&pas["WEBLib.StdCtrls"].TComboBox.isPrototypeOf(this.FInplaceEditor)&&(rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TComboBox).FItems.Assign(s.FEditorItems),rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TComboBox).SetStyle(0)),this.CustomizeInplaceEditor(this.FInplaceEditor,e,s);try{o="",this.DoGetNodeText(e,i,1,{get:function(){return o},set:function(t){o=t}}),pas["WEBLib.StdCtrls"].TComboBox.isPrototypeOf(this.FInplaceEditor)&&rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TComboBox).SetItemIndex(rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TComboBox).FItems.IndexOf(o)),pas["WEBLib.StdCtrls"].TEdit.isPrototypeOf(this.FInplaceEditor)&&rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TEdit).SetText(o),pas["WEBLib.StdCtrls"].TMemo.isPrototypeOf(this.FInplaceEditor)&&rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TMemo).SetText(o)}finally{}this.FInplaceEditor.CanFocus()&&this.FInplaceEditor.SetFocus(),pas["WEBLib.StdCtrls"].TEdit.isPrototypeOf(this.FInplaceEditor)&&rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TEdit).SetSelStart(rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TEdit).GetText().length),pas["WEBLib.StdCtrls"].TMemo.isPrototypeOf(this.FInplaceEditor)&&(rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TMemo).SetSelLength(0),rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TMemo).FLines.GetCount()>0?rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TMemo).FCaretPosition.$assign(l(rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TMemo).FLines.GetCount()-1,rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TMemo).FLines.Get(rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TMemo).FLines.GetCount()-1).length)):rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TMemo).FCaretPosition.$assign(l(0,0))),this.FInplaceEditorActive=!0,this.Invalidate()}this.DoAfterOpenInplaceEditor(e,i,this.FInplaceEditor,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r))}}},this.CustomizeInplaceEditor=function(t,e,i){null!=e&&null!=i&&null!=t&&this.DoCustomizeInplaceEditor(e,i.GetIndex(),this.FInplaceEditor)},this.StartReload=function(){this.FVerticalOffsetTo=this.GetReloadOffset(),this.StartVerticalOffsetAnimation()},this.ConfigureNodeRect=function(t,e,i){},this.GetNodeOffset=function(t,e,i,s,n){},this.GetNodeMargins=function(t,e,i,s){},this.HandleAlternativeDragOver=function(t,e){},this.HandleAlternativeDragDrop=function(t,e){},this.InternalSelectVirtualNode=function(t){},this.CanStartDragFromMouseDown=function(){return!0,!0},this.CanStartDragFromMouseMove=function(){return!1,!1},this.AlternativeDragDrop=function(){return!1,!1},this.GetNodesSpacing=function(){return this.FNodesAppearance.FSpacing},this.IsAnimating=function(){return!0===this.FAnimateTimer.FEnabled&&this.FAnimating},this.GetNodesRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(this.GetContentRect()),t},this.CanApplyVerticalOffset=function(){return!1,!1},this.GetReloadOffset=function(){return 0,0},this.NeedsReload=function(t){return!1,!1},this.IsVariableNodeHeight=function(){return 1===this.FNodesAppearance.FHeightMode},this.ColumnStretchingActive=function(){return this.FColumnsAppearance.FStretch&&this.FColumnsAppearance.FStretchAll},this.GetBufStart=function(t,e){var i=0;for(i=1,e.set(0);pas["WEBLib.TMSFNCTypes"].CharInArray(t.charAt(i-1),[" ","\t"]);)i+=1,e.set(e.get()+1);return pas.System.Copy(t,i,t.length-i+1)},this.GetFirstEditableColumn=function(){var t=0,e=0;t=-1;for(var i=0,s=this.FColumns.GetCount()-1;i<=s;i++)if(e=i,3!==this.FColumns.GetItem$1(e).FEditorType||this.FColumns.GetItem$1(e).FCustomEditor){t=e;break}return t},this.GetLastEditableColumn=function(){var t=0,e=0;t=-1;for(var i=this.FColumns.GetCount()-1;i>=0;i--)if(e=i,3!==this.FColumns.GetItem$1(e).FEditorType||this.FColumns.GetItem$1(e).FCustomEditor){t=e;break}return t},this.GetPreviousEditableColumn=function(t){var e=0,i=0;if(e=-1,t>0&&t<=this.FColumns.GetCount()-1)for(var s=t-1;s>=0;s--)if(i=s,3!==this.FColumns.GetItem$1(i).FEditorType||this.FColumns.GetItem$1(i).FCustomEditor){e=i;break}return e},this.GetNextEditableColumn=function(t){var e=0,i=0;if(e=-1,t>=0&&t<this.FColumns.GetCount()-1)for(var s=t+1,n=this.FColumns.GetCount()-1;s<=n;s++)if(i=s,3!==this.FColumns.GetItem$1(i).FEditorType||this.FColumns.GetItem$1(i).FCustomEditor){e=i;break}return e},this.GetInplaceEditorRect=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),null==t||e>=0&&e<=rtl.length(t.FTextRects)-1&&(n.$assign(t.FTextRects[e]),s.$assign(this.GetContentClipRect()),n.Top=Math.max(n.Top,s.Top),n.Bottom=Math.min(n.Bottom,s.Bottom),n.Left=Math.max(n.Left,s.Left),n.Right=Math.min(n.Right,s.Right),i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.Math.Floor(n.Left),pas.Math.Floor(n.Top),Math.round(n.Right),Math.round(n.Bottom))),null!=this.FOnGetInplaceEditorRect&&this.FOnGetInplaceEditorRect(this,t,e,this.FInplaceEditor,i)),i},this.GetNextFocusableNode=function(t){var e=null,i=!1;for(e=null!=t?this.GetNextVirtualNode(t):this.GetFirstRootVirtualNode(),i=this.IsVirtualNodeSelectable(e);null!=e&&!i;)e=this.GetNextVirtualNode(e),i=this.IsVirtualNodeSelectable(e);return e},this.GetPreviousFocusableNode=function(t){var e=null,i=!1;for(e=null!=t?this.GetPreviousVirtualNode(t):this.GetLastVirtualNode(),i=this.IsVirtualNodeSelectable(e);null!=e&&!i;)e=this.GetPreviousVirtualNode(e),i=this.IsVirtualNodeSelectable(e);return e},this.GetVersion=function(){return this.$class.GetVersionNumber(1,1,9,1)},this.GetFirstVisibleColumn=function(){var t=0,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=0;if(t=0,!this.FColumnsAppearance.FOptimizedColumnDisplay)return t;e.$assign(this.GetNodesRect());for(var s=0,n=this.FColumns.GetCount()-1;s<=n;s++)if(i=s,this.GetColPos(i)+this.GetColWidths(i)>=e.Left+this.GetHorizontalScrollPosition()){t=i;break}return t},this.GetLastVisibleColumn=function(){var t=0,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=0;if(t=this.FColumns.GetCount()-1,!this.FColumnsAppearance.FOptimizedColumnDisplay)return t;e.$assign(this.GetNodesRect());for(var s=t;s>=0;s--)if(i=s,this.GetColPos(i)<=e.Right+this.GetHorizontalScrollPosition()){t=i;break}return t},this.ConfigureNode=function(t,e,i,s){var n,o,r,a=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),l=0,h=0,F=0,p=0,c=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),u=0,T=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),C=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),S=null,d=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),m=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),f=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),g="",y="",b=!1,N=0,M=0,B=0,E=0,L=0,D=null,A=0,$=0,I=0,P=0,v=!1,G=!1,w=0,O=0,W=!1,R=0,x=null,k=[],V=[],H=[],U=[],z=[],j=[],K=[],J=0,Y=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),X=0,q=0,Q=0,_=0,Z=0,tt=0,et=0,it=0,st=0,nt=0,ot=0;if(this.DoGetNodeData(i),_=0,Z=0,tt=0,et=0,this.GetNodeOffset(i,{get:function(){return _},set:function(t){_=t}},{get:function(){return Z},set:function(t){Z=t}},{get:function(){return tt},set:function(t){tt=t}},{get:function(){return et},set:function(t){et=t}}),it=0,st=0,nt=0,ot=0,this.GetNodeMargins({get:function(){return it},set:function(t){it=t}},{get:function(){return st},set:function(t){st=t}},{get:function(){return nt},set:function(t){nt=t}},{get:function(){return ot},set:function(t){ot=t}}),o=this.GetVerticalScrollPosition(),T.$assign(this.GetNodesRect()),S=i,l=this.GetTotalColumnNodeWidth()-nt-it,r=this.FNodesAppearance.FLevelIndent*S.FLevel,this.FNodesAppearance.FExpandColumn===this.GetFirstVisibleColumn()?(F=r,l-=r):F=0,B=0,p=s.get(),h=0,F+=it,p+=st,a.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(F),pas.System.Int(p),pas.System.Int(F+l),pas.System.Int(p+h))),this.HorizontalScrollBar().FVisible||this.FColumnsAppearance.FStretch?0===e?c.$assign(pas["WEBLib.TMSFNCTypes"].RectF(a.Left+1.5,a.Top+1.5,a.Right-1.5,a.Bottom+.5)):(this.FRowCount,c.$assign(pas["WEBLib.TMSFNCTypes"].RectF(a.Left+1.5,a.Top+.5,a.Right-1.5,a.Bottom+.5))):0===e?c.$assign(pas["WEBLib.TMSFNCTypes"].RectF(a.Left+1.5,a.Top+1.5,a.Right-.5,a.Bottom+.5)):(this.FRowCount,c.$assign(pas["WEBLib.TMSFNCTypes"].RectF(a.Left+1.5,a.Top+.5,a.Right-.5,a.Bottom+.5))),this.ConfigureNodeRect(e,i,c),S.FCalculated)h=S.FHeight;else if(this.UpdateNodeCalculated(S,!0),1===this.FNodesAppearance.FHeightMode){E=this.GetFirstVisibleColumn(),L=this.GetLastVisibleColumn(),W=!1,this.DoIsNodeExtended(S,{get:function(){return W},set:function(t){W=t}}),W&&(L=Math.min(E,L));for(var rt=E,at=L;rt<=at;rt++)u=rt,((w=this.GetColWidths(u))>0||W)&&(g="",this.DoGetNodeText(S,u,0,{get:function(){return g},set:function(t){g=t}}),y="",this.DoGetNodeTitle(S,u,0,{get:function(){return y},set:function(t){y=t}}),b=!0,this.DoGetNodeTitleExpanded(S,u,{get:function(){return b},set:function(t){b=t}}),this.FCompactMode&&(y="",g="",b=!1),N=this.GetColPos(u),u===E&&(N+=c.Left),M=W?N+l:N+this.GetColWidths(u),u===E&&(M-=c.Left),this.FNodesAppearance.FExpandColumn===u&&u>E&&(N+=r),M=M-_-tt-nt-it,u===this.FNodesAppearance.FExpandColumn&&(N+=I=this.FNodesAppearance.FExpandWidth+this.ScalePaintValue(4),(P=this.FNodesAppearance.FExpandHeight+this.ScalePaintValue(4))>B&&(B=P)),O=0,this.DoGetNodeCheckType(S,u,{get:function(){return O},set:function(t){O=t}}),0!==O&&(R=this.ScalePaintValue(this.FCheckStartSize),N+=Math.max(0,R+4),R>B&&(B=R)),D=null,this.DoGetNodeIcon(S,u,!1,{get:function(){return D},set:function(t){D=t}}),null==D&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IsHighDPIScale(null,-1)&&this.DoGetNodeIcon(S,u,!0,{get:function(){return D},set:function(t){D=t}}),null!=D&&D.GetWidth()>0&&D.GetHeight()>0&&(A=D.GetWidth()+this.ScalePaintValue(4),$=D.GetHeight()+this.ScalePaintValue(4),this.DoGetNodeIconSize(S,u,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IsHighDPIScale(null,-1),D,{get:function(){return A},set:function(t){A=t}},{get:function(){return $},set:function(t){$=t}}),N+=A,$>B&&(B=$)),v=!1,G=!1,u>=0&&u<=this.FColumns.GetCount()-1&&(v=this.FColumns.GetItem$1(u).FWordWrapping,G=this.FColumns.GetItem$1(u).FTitleWordWrapping),this.DoGetNodeWordWrapping(S,u,{get:function(){return v},set:function(t){v=t}}),this.DoGetNodeTitleWordWrapping(S,u,{get:function(){return G},set:function(t){G=t}}),X=0,this.DoGetNodeExtraSize(S,u,{get:function(){return X},set:function(t){X=t}}),q=0,this.DoGetNodeTitleExtraSize(S,u,{get:function(){return q},set:function(t){q=t}}),d.$assign(pas["WEBLib.TMSFNCTypes"].RectF(N,0,M-X,1e4)),pas["WEBLib.TMSFNCTypes"].InflateRectEx(d,this.ScalePaintValue(-2),0),m.$assign(pas["WEBLib.TMSFNCTypes"].RectF(N,0,M-q,1e4)),pas["WEBLib.TMSFNCTypes"].InflateRectEx(m,this.ScalePaintValue(-2),0),x=null,u>=0&&u<=this.FColumnCount-1&&(x=this.FColumns.GetItem$1(u)),null==x||x.FUseDefaultAppearance||W?W?t.FFont.Assign(this.FNodesAppearance.FExtendedFont):t.FFont.Assign(this.FNodesAppearance.FFont):t.FFont.Assign(x.FFont),b?(d.$assign(t.CalculateText(g,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(d),v,!0)),d.Bottom=d.Bottom+this.ScalePaintValue(4),J=d.Bottom-d.Top):J=0,""!==y?(null==x||x.FUseDefaultAppearance?t.FFont.Assign(this.FNodesAppearance.FTitleFont):t.FFont.Assign(x.FTitleFont),f.$assign(t.CalculateText(y,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(m),G,!0)),f.Bottom=f.Bottom+this.ScalePaintValue(4),Q=f.Bottom-f.Top):Q=0,this.UpdateNodeTitleHeight(S,Math.max(q,Q)),J+=S.FTitleHeight,this.DoGetNodeHeight(S,u,{get:function(){return J},set:function(t){J=t}}),J>B&&(B=J));h=(h=Math.max(this.FDefaultRowHeight,B))+this.GetNodesSpacing()+Z+et,this.UpdateNodeHeight(S,pas.System.Int(h)),this.FTotalRowHeight=this.FTotalRowHeight-this.FDefaultRowHeight+S.FHeight}else h=(h=this.FDefaultRowHeight)+this.GetNodesSpacing()+Z+et,this.UpdateNodeHeight(S,h);s.set(s.get()+pas.System.Int(h)),c.Bottom=c.Bottom+pas.System.Int(h),c.Bottom=c.Bottom-this.GetNodesSpacing(),C.$assign(c),C.Left=C.Left+_,C.Top=C.Top+Z,C.Right=C.Right+tt,C.Bottom=C.Bottom+et,j=rtl.arraySetLength(j,pas["WEBLib.TMSFNCTypes"].TRectF,0),K=rtl.arraySetLength(K,pas["WEBLib.TMSFNCTypes"].TRectF,0),H=rtl.arraySetLength(H,pas["WEBLib.TMSFNCTypes"].TRectF,0),U=rtl.arraySetLength(U,pas["WEBLib.TMSFNCTypes"].TRectF,0),V=rtl.arraySetLength(V,pas["WEBLib.TMSFNCTypes"].TRectF,0),k=rtl.arraySetLength(k,pas["WEBLib.TMSFNCTypes"].TRectF,0),z=rtl.arraySetLength(z,pas["WEBLib.TMSFNCTypes"].TRectF,0),E=this.GetFirstVisibleColumn(),L=this.GetLastVisibleColumn(),W=!1,this.DoIsNodeExtended(S,{get:function(){return W},set:function(t){W=t}}),W&&(L=Math.min(E,L));for(var lt=E,ht=L;lt<=ht;lt++)u=lt,w=this.GetColumnWidth(u),N=this.GetColumnPosition(u),u===E&&(N+=C.Left),M=W?N+l:N+w,u===E&&(M-=C.Left),this.FNodesAppearance.FExpandColumn===u&&u>E&&(N+=r),W&&(M+=r),M=M-nt-tt,I=0,P=0,u===this.FNodesAppearance.FExpandColumn&&(I=this.FNodesAppearance.FExpandWidth+this.ScalePaintValue(4),P=this.FNodesAppearance.FExpandHeight+this.ScalePaintValue(4)),(k=rtl.arraySetLength(k,pas["WEBLib.TMSFNCTypes"].TRectF,rtl.length(k)+1))[rtl.length(k)-1].$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(N+this.ScalePaintValue(2)),pas.System.Int(C.Top+(C.Bottom-C.Top-P)/2+this.ScalePaintValue(2)),pas.System.Int(N+I-this.ScalePaintValue(2)),pas.System.Int(C.Top+(C.Bottom-C.Top-P)/2+P-this.ScalePaintValue(2)))),N+=I,O=0,R=0,this.DoGetNodeCheckType(S,u,{get:function(){return O},set:function(t){O=t}}),0!==O&&(R=this.ScalePaintValue(this.FCheckStartSize)),(z=rtl.arraySetLength(z,pas["WEBLib.TMSFNCTypes"].TRectF,rtl.length(z)+1))[rtl.length(z)-1].$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(N+this.ScalePaintValue(4)),pas.System.Int(C.Top+(C.Bottom-C.Top-R)/2+this.ScalePaintValue(2)),pas.System.Int(N+R),pas.System.Int(C.Top+(C.Bottom-C.Top-R)/2+R-this.ScalePaintValue(2)))),N+=Math.max(0,R+4),D=null,this.DoGetNodeIcon(S,u,!1,{get:function(){return D},set:function(t){D=t}}),null==D&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IsHighDPIScale(null,-1)&&this.DoGetNodeIcon(S,u,!0,{get:function(){return D},set:function(t){D=t}}),A=0,$=0,null!=D&&D.GetWidth()>0&&D.GetHeight()>0&&(A=D.GetWidth()+this.ScalePaintValue(4),$=D.GetHeight()+this.ScalePaintValue(4),this.DoGetNodeIconSize(S,u,pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IsHighDPIScale(null,-1),D,{get:function(){return A},set:function(t){A=t}},{get:function(){return $},set:function(t){$=t}})),(V=rtl.arraySetLength(V,pas["WEBLib.TMSFNCTypes"].TRectF,rtl.length(V)+1))[rtl.length(V)-1].$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(N+this.ScalePaintValue(2)),pas.System.Int(C.Top+(C.Bottom-C.Top-$)/2+this.ScalePaintValue(2)),pas.System.Int(N+A-this.ScalePaintValue(2)),pas.System.Int(C.Top+(C.Bottom-C.Top-$)/2+$-this.ScalePaintValue(2)))),N+=A,X=0,this.DoGetNodeExtraSize(S,u,{get:function(){return X},set:function(t){X=t}}),q=0,this.DoGetNodeTitleExtraSize(S,u,{get:function(){return q},set:function(t){q=t}}),(""!==S.GetTitle(u)||S.FTitleHeight>0)&&""!==S.GetText(u)&&S.GetTitleExpanded(u)?(Y.$assign(pas["WEBLib.TMSFNCTypes"].RectF(N,C.Top,M-q,C.Top+S.FTitleHeight)),(U=rtl.arraySetLength(U,pas["WEBLib.TMSFNCTypes"].TRectF,rtl.length(U)+1))[rtl.length(U)-1].$assign(Y),(K=rtl.arraySetLength(K,pas["WEBLib.TMSFNCTypes"].TRectF,rtl.length(K)+1))[rtl.length(K)-1].$assign(pas["WEBLib.TMSFNCTypes"].RectF(Y.Right,C.Top,Y.Right+q,C.Top+q)),Y.$assign(pas["WEBLib.TMSFNCTypes"].RectF(N,Y.Bottom,M-X,C.Bottom)),(H=rtl.arraySetLength(H,pas["WEBLib.TMSFNCTypes"].TRectF,rtl.length(H)+1))[rtl.length(H)-1].$assign(Y)):(Y.$assign(pas["WEBLib.TMSFNCTypes"].RectF(N,C.Top+(C.Bottom-C.Top-(c.Bottom-c.Top))/2,M-q,C.Top+(C.Bottom-C.Top-(c.Bottom-c.Top))/2+(c.Bottom-c.Top))),(U=rtl.arraySetLength(U,pas["WEBLib.TMSFNCTypes"].TRectF,rtl.length(U)+1))[rtl.length(U)-1].$assign(Y),(K=rtl.arraySetLength(K,pas["WEBLib.TMSFNCTypes"].TRectF,rtl.length(K)+1))[rtl.length(K)-1].$assign(pas["WEBLib.TMSFNCTypes"].RectF(Y.Right,C.Top,Y.Right+q,C.Top+q)),Y.$assign(pas["WEBLib.TMSFNCTypes"].RectF(N,C.Top+(C.Bottom-C.Top-(c.Bottom-c.Top))/2,M-X,C.Top+(C.Bottom-C.Top-(c.Bottom-c.Top))/2+(c.Bottom-c.Top))),(H=rtl.arraySetLength(H,pas["WEBLib.TMSFNCTypes"].TRectF,rtl.length(H)+1))[rtl.length(H)-1].$assign(Y)),(j=rtl.arraySetLength(j,pas["WEBLib.TMSFNCTypes"].TRectF,rtl.length(j)+1))[rtl.length(j)-1].$assign(pas["WEBLib.TMSFNCTypes"].RectF(Y.Right,Y.Top,Y.Right+X,Y.Bottom));return this.UpdateNodeExtraRects(S,rtl.arrayRef(j)),this.UpdateNodeTitleExtraRects(S,rtl.arrayRef(K)),this.UpdateNodeTextRects(S,rtl.arrayRef(H)),this.UpdateNodeTitleRects(S,rtl.arrayRef(U)),this.UpdateNodeBitmapRects(S,rtl.arrayRef(V)),this.UpdateNodeExpandRects(S,rtl.arrayRef(k)),this.UpdateNodeCheckRects(S,rtl.arrayRef(z)),n=pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewCacheItem.CreateNode(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(c),S),this.FNodeCache.Add$1(n),this.UpdateNodeCacheReference(S,n),p-o>T.Bottom-T.Top},this.XYToColumnAnchorCache=function(t,e,i,s){var n="",o=0,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a="",l=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),h="",F=null,p=null,c=null,u=!1,T=0,C=0,S=0,d=!1,m=0;n="",s.set(-1),(F=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene();try{F.FBitmapContainer=this.GetBitmapContainer();for(var f=0,g=i.GetCount()-1;f<=g;f++){if(o=f,p=i.GetItem$1(o),c=null,u=!1,p.FColumn>=0&&p.FColumn<=this.FColumns.GetCount()-1&&(c=this.FColumns.GetItem$1(p.FColumn)),l.$assign(p.FDrawRect),m=0,null!=c&&(c.FFiltering.FEnabled&&(m=m+c.FFiltering.FButtonSize+this.ScalePaintValue(4)),c.FExpandable&&(m=m+c.FExpandingButtonSize+this.ScalePaintValue(6)),0!==c.FSortKind&&this.FSortColumn===p.FColumn&&(m=m+this.ScalePaintValue(8)+this.ScalePaintValue(6))),u){var y=p.FKind;1===y?F.FFont.Assign(this.FColumnsAppearance.FTopFont):2===y&&F.FFont.Assign(this.FColumnsAppearance.FBottomFont)}else if(null!=c){var b=p.FKind;1===b?F.FFont.Assign(c.FTopFont):2===b&&F.FFont.Assign(c.FBottomFont)}if(h=this.GetColumnText(p.FColumn),this.DoGetColumnText(p.FColumn,p.FKind,{get:function(){return h},set:function(t){h=t}}),C=1,S=0,d=!1,T=0,null!=c&&(C=c.FHorizontalTextAlign,S=c.FVerticalTextAlign,d=c.FWordWrapping,T=c.FTrimming),this.DoGetColumnTrimming(p.FColumn,p.FKind,{get:function(){return T},set:function(t){T=t}}),this.DoGetColumnWordWrapping(p.FColumn,p.FKind,{get:function(){return d},set:function(t){d=t}}),this.DoGetColumnHorizontalTextAlign(p.FColumn,p.FKind,{get:function(){return C},set:function(t){C=t}}),this.DoGetColumnVerticalTextAlign(p.FColumn,p.FKind,{get:function(){return S},set:function(t){S=t}}),r.$assign(l),pas["WEBLib.TMSFNCTypes"].InflateRectEx(r,this.ScalePaintValue(-2),this.ScalePaintValue(-2)),r.Right=Math.max(r.Left,r.Right-m),pas["WEBLib.TMSFNCTypes"].PtInRectEx(r,pas["WEBLib.TMSFNCTypes"].PointF(t,e))){var N=p.FKind;if(1===N?(null!=c?F.FFont.Assign(c.FTopFont):F.FFont.Assign(this.FColumnsAppearance.FTopFont),a=this.FColumnsAppearance.FTopVerticalText?F.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),h,d,C,S,T,-90,-1,-1,!0,!0,t,e):F.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),h,d,C,S,T,0,-1,-1,!0,!0,t,e)):2===N&&(null!=c?F.FFont.Assign(c.FBottomFont):F.FFont.Assign(this.FColumnsAppearance.FBottomFont),a=this.FColumnsAppearance.FBottomVerticalText?F.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),h,d,C,S,T,90,-1,-1,!0,!0,t,e):F.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),h,d,C,S,T,0,-1,-1,!0,!0,t,e)),""!==a){n=a,s.set(p.FColumn);break}}}}finally{F.EndScene(),F=rtl.freeLoc(F)}return n},this.GetRowHeight=function(t){var e,i=0;return i=this.FDefaultRowHeight,null!=(e=this.GetVisibleNodeForIndex(t))&&e.FCalculated&&(i=e.FHeight),i},this.GetColumnText=function(t){var e="";return e=pas["WEBLib.TMSFNCTreeViewData"].TranslateTextEx(rtl.getResStr(pas["WEBLib.TMSFNCTreeViewData"],"sTMSFNCTreeViewColumn"))+" "+pas.SysUtils.IntToStr(t),t>=0&&t<=this.FColumnCount-1&&(t>=0&&t<=this.FColumns.GetCount()-1&&""===(e=this.FColumns.GetItem$1(t).FText)&&(e=this.FColumns.GetItem$1(t).FName),""===e&&(e=pas["WEBLib.TMSFNCTreeViewData"].TranslateTextEx(rtl.getResStr(pas["WEBLib.TMSFNCTreeViewData"],"sTMSFNCTreeViewColumn"))+" "+pas.SysUtils.IntToStr(t))),null!=this.FAdapter&&(e=this.FAdapter.GetColumnDisplayName(t)),e},this.GetGroupText=function(t){var e="";return e=pas["WEBLib.TMSFNCTreeViewData"].TranslateTextEx(rtl.getResStr(pas["WEBLib.TMSFNCTreeViewData"],"sTMSFNCTreeViewGroup"))+" "+pas.SysUtils.IntToStr(t),t>=0&&t<=this.FGroups.GetCount()-1&&(e=this.FGroups.GetItem$1(t).GetText()),e},this.GetColumnsTopSize=function(){var t=0;return t=0,0 in this.FColumnsAppearance.FLayouts&&this.FColumnCount>0&&(t=this.FColumnsAppearance.FTopSize),t},this.GetColumnsExtraSize=function(){return 0,0},this.GetColumnsBottomSize=function(){var t=0;return t=0,1 in this.FColumnsAppearance.FLayouts&&this.FColumnCount>0&&(t=this.FColumnsAppearance.FBottomSize),t},this.GetGroupsTopSize=function(){var t=0;return t=0,0 in this.FGroupsAppearance.FLayouts&&this.FDisplayGroups.GetCount()>0&&this.FColumnCount>0&&(t=this.FGroupsAppearance.FTopSize),t},this.GetGroupsBottomSize=function(){var t=0;return t=0,1 in this.FGroupsAppearance.FLayouts&&this.FDisplayGroups.GetCount()>0&&this.FColumnCount>0&&(t=this.FGroupsAppearance.FBottomSize),t},this.GetContentClipRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.GetContentClipRect.call(this)),t.Bottom=t.Top+Math.min(this.GetTotalRowHeight(),t.Bottom-t.Top),t.Right=t.Left+Math.min(this.GetTotalColumnWidth(),t.Right-t.Left),t.Left=t.Left+1,t.Right=t.Right-1,t},this.GetContentRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.GetContentRect.call(this)),t.Top=t.Top+this.GetColumnsTopSize()+this.GetGroupsTopSize(),t.Bottom=t.Bottom-this.GetColumnsBottomSize()-this.GetGroupsBottomSize(),t},this.GetCalculationRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.GetCalculationRect.call(this)),t.Top=t.Top+this.GetColumnsTopSize()+this.GetGroupsTopSize(),t.Bottom=t.Bottom-this.GetColumnsBottomSize()-this.GetGroupsBottomSize(),t.Right=t.Left+Math.max(0,t.Right-t.Left),t.Bottom=t.Top+Math.max(0,t.Bottom-t.Top),t},this.GetGroupsTopRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(this.GetColumnsTopRect()),t.Bottom=t.Top,t.Top=t.Top-this.GetGroupsTopSize(),t},this.GetGroupsBottomRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(this.GetColumnsBottomRect()),t.Top=t.Bottom,t.Bottom=t.Top+this.GetGroupsBottomSize(),t},this.GetColumnsTopRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.GetContentRect.call(this)),t.Left=e.Left,t.Top=e.Top+this.GetGroupsTopSize(),t.Right=e.Right+this.GetColumnsExtraSize(),t.Bottom=e.Top+this.GetGroupsTopSize()+this.GetColumnsTopSize(),t},this.GetColumnBottomRightEmptyRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(this.GetColumnsBottomRect()),i.$assign(this.GetLocalRect()),t.Top=e.Top,t.Left=e.Right,t.Right=i.Right-1,t.Bottom=e.Bottom,t},this.GetColumnTopRightEmptyRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(this.GetColumnsTopRect()),i.$assign(this.GetLocalRect()),t.Top=e.Top,t.Left=e.Right,t.Right=i.Right-1,t.Bottom=e.Bottom,t},this.GetGroupBottomRightEmptyRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(this.GetGroupsBottomRect()),i.$assign(this.GetLocalRect()),t.Top=e.Top,t.Left=e.Right,t.Right=i.Right,t.Bottom=e.Bottom,t},this.GetGroupTopRightEmptyRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(this.GetGroupsTopRect()),i.$assign(this.GetLocalRect()),t.Top=e.Top,t.Left=e.Right,t.Right=i.Right,t.Bottom=e.Bottom,t},this.GetColumnsBottomRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.GetContentRect.call(this)),t.Left=e.Left,t.Top=e.Bottom-this.GetGroupsBottomSize()-this.GetColumnsBottomSize(),t.Right=e.Right+this.GetColumnsExtraSize(),t.Bottom=e.Bottom-this.GetGroupsBottomSize(),t},this.XYToCacheItem=function(t,e,i){var s=null,n=0,o=null,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(s=null,null==this.FNodeDisplay)return s;if(!pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetContentClipRect(),pas["WEBLib.TMSFNCTypes"].PointF(t,e)))return s;for(var a=0,l=this.FNodeDisplay.GetCount()-1;a<=l;a++)if(n=a,o=this.FNodeDisplay.GetItem(n),r.$assign(o.FDrawRect),r.Left=r.Left+i,r.Right=r.Right+i,pas["WEBLib.TMSFNCTypes"].PtInRectEx(r,pas["WEBLib.TMSFNCTypes"].PointF(t,e))){s=o;break}return s},this.GetHTMLTemplate=function(t){return t>=0&&t<this.FColumns.GetCount()?this.FColumns.GetItem$1(t).FHTMLTemplate:""},this.Create$1=function(e){var i=0;return pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.Create$1.apply(this,arguments),this.FColumnStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,-1]),this.FColumnStroke.FOnChanged=rtl.createCallback(this,"ColumnStrokeChanged"),this.FSizeColumn=-1,this.FGroupsCaching=!1,this.FColumnsCaching=!1,this.FSelectedNodes=t.TTMSFNCTreeViewSelectedNodes.$create("Create$1"),this.FNodeCache=t.TTMSFNCTreeViewNodeCache.$create("Create$2"),this.FColumnsTopCache=t.TTMSFNCTreeViewColumnsTopCache.$create("Create$2"),this.FGroupsTopCache=t.TTMSFNCTreeViewGroupsTopCache.$create("Create$2"),this.FColumnsBottomCache=t.TTMSFNCTreeViewColumnsBottomCache.$create("Create$2"),this.FGroupsBottomCache=t.TTMSFNCTreeViewGroupsBottomCache.$create("Create$2"),this.FNodeDisplay=t.TTMSFNCTreeViewNodeDisplayList.$create("Create$1"),this.FColumnsTopDisplay=t.TTMSFNCTreeViewColumnsTopDisplayList.$create("Create$1"),this.FGroupsTopDisplay=t.TTMSFNCTreeViewGroupsTopDisplayList.$create("Create$1"),this.FColumnsBottomDisplay=t.TTMSFNCTreeViewColumnsBottomDisplayList.$create("Create$1"),this.FGroupsBottomDisplay=t.TTMSFNCTreeViewGroupsBottomDisplayList.$create("Create$1"),this.FNodesAppearance=t.TTMSFNCTreeViewNodesAppearance.$create("Create$1",[this]),this.FColumnsAppearance=t.TTMSFNCTreeViewColumnsAppearance.$create("Create$1",[this]),this.FGroupsAppearance=t.TTMSFNCTreeViewGroupsAppearance.$create("Create$1",[this]),this.FInteraction=t.TTMSFNCTreeViewInteraction.$create("Create$1",[this]),this.FDragTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FDragTimer.SetInterval(10),this.FDragTimer.SetEnabled(!1),this.FDragTimer.FOnTimer=rtl.createCallback(this,"DragTime"),this.FAnimateTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FAnimateTimer.SetInterval(1),this.FAnimateTimer.SetEnabled(!1),this.FAnimateTimer.FOnTimer=rtl.createCallback(this,"Animate"),this.FCopyNodes=t.TTMSFNCTreeViewCopyNodes.$create("Create$3",[null,null]),this.FFilterListBox=pas["WEBLib.StdCtrls"].TListBox.$create("Create$1",[this]),this.FFilterListBox.FTag$1=-1,this.FFilterListBox.FOnClick=rtl.createCallback(this,"HandleFilterListClick"),this.FGlobalFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCAppearanceGlobalFont.$create("Create$1",[this]),this.FFilterTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FFilterTimer.FOnTimer=rtl.createCallback(this,"HandleFilterTimer"),this.FFilterTimer.SetInterval(100),this.FFilterTimer.SetEnabled(!1),this.FFilterPopup=pas["WEBLib.TMSFNCPopup"].TTMSFNCPopup.$create("Create$1",[this]),this.FFilterPopup.SetPlacement(9),this.SetWidth(300),this.SetHeight(280),this.FDefaultViewJSONOptions=t.TTMSFNCTreeViewViewJSONOptions.$create("Create$1"),i=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(this,96),this.FCheckStartSize=1===i?19:1.25===i||1.75===i?16:17,this.IsDesignTime()&&this.InitSample(),this},this.Destroy=function(){null!=this.FOldInplaceEditor&&rtl.free(this,"FOldInplaceEditor"),rtl.free(this,"FDefaultViewJSONOptions"),rtl.free(this,"FGlobalFont"),rtl.free(this,"FCopyNodes"),rtl.free(this,"FFilterTimer"),rtl.free(this,"FFilterListBox"),rtl.free(this,"FFilterPopup"),null!=this.FDragBitmap&&(rtl.free(this,"FDragBitmap"),this.FDragBitmap=null),rtl.free(this,"FColumnStroke"),rtl.free(this,"FAnimateTimer"),rtl.free(this,"FNodesAppearance"),rtl.free(this,"FGroupsAppearance"),rtl.free(this,"FInteraction"),rtl.free(this,"FColumnsAppearance"),rtl.free(this,"FGroupsTopDisplay"),rtl.free(this,"FColumnsTopDisplay"),rtl.free(this,"FGroupsBottomDisplay"),rtl.free(this,"FColumnsBottomDisplay"),rtl.free(this,"FSelectedNodes"),rtl.free(this,"FNodeDisplay"),rtl.free(this,"FNodeCache"),rtl.free(this,"FGroupsTopCache"),rtl.free(this,"FColumnsTopCache"),rtl.free(this,"FGroupsBottomCache"),rtl.free(this,"FColumnsBottomCache"),pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.Destroy.call(this)},this.Assign=function(e){this.BeginUpdate(),pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.Assign.apply(this,arguments),t.TTMSFNCCustomTreeView.isPrototypeOf(e)&&(this.FNodesAppearance.Assign(rtl.as(e,t.TTMSFNCCustomTreeView).FNodesAppearance),this.FColumnsAppearance.Assign(rtl.as(e,t.TTMSFNCCustomTreeView).FColumnsAppearance),this.FGroupsAppearance.Assign(rtl.as(e,t.TTMSFNCCustomTreeView).FGroupsAppearance),this.FInteraction.Assign(rtl.as(e,t.TTMSFNCCustomTreeView).FInteraction)),this.EndUpdate()},this.Draw=function(t,e){var i=null;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),this.FUpdateCount$1>0||(t.FBitmapContainer=this.GetBitmapContainer(),this.DrawEmptySpaces(t),i=t.SaveState(!1),t.ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetContentClipRect())),this.DrawNodeColumns(t),t.RestoreState(i,!1),this.DrawNodes(t),this.DrawColumns(t),this.DrawGroups(t),this.DrawBorders(t))},this.InitSample=function(){var t=null,e=null,i=null,s=null,n=null,o=0,r="";for(this.BeginUpdate(),this.SetWidth(this.ScalePaintValue(350)),this.ClearNodeList(),this.FColumns.Clear(),this.FNodes.Clear(),this.ResetToDefaultStyle(),this.FNodesAppearance.SetExpandWidth(this.ScalePaintValue(18)),this.FNodesAppearance.SetExpandHeight(this.ScalePaintValue(18)),this.FColumnsAppearance.SetTopSize(this.ScalePaintValue(36)),this.FColumnsAppearance.FTopStroke.SetKind(0),this.FNodesAppearance.FSelectedStroke.SetWidth(pas.System.Trunc(this.ScalePaintValue$1(2))),(n=this.FColumns.Add$1()).SetText("Name"),n.SetHorizontalTextAlign(1),(n=this.FColumns.Add$1()).SetText("Unit"),n.SetHorizontalTextAlign(2),n.SetWidth(this.ScalePaintValue(90)),(n=this.FColumns.Add$1()).SetText("Status"),n.SetHorizontalTextAlign(0),n.SetWidth(this.ScalePaintValue(80)),(t=this.AddNode(null)).SetText(0,"Managers"),(e=this.AddNode(null)).SetText(0,"Specialists"),(i=this.AddNode(null)).SetText(0,"Assistants"),o=0;o<=7;o++){s=o<3?this.AddNode(t):o<5?this.AddNode(e):this.AddNode(i);var a=pas.System.Random(125)%7;r=0===a?"Liam":1===a?"Fatma":2===a?"Yusuf":3===a?"Marie":4===a?"Isabella":5===a?"Omar":"Arthur";var l=pas.System.Random(125)%7;r+=0===l?" Andersson":1===l?" Wang":2===l?" Smith":3===l?" Peeters":4===l?" Gonzales":5===l?" Moyo":" Ali",s.SetText(0,r);var h=pas.System.Random(120)%7;1===h?s.SetText(1,"Research"):2===h?s.SetText(1,"Finance"):3===h?s.SetText(1,"Manufactering"):4===h?s.SetText(1,"Sales"):5===h?s.SetText(1,"HR"):6===h?s.SetText(1,"Marketing"):s.SetText(1,"Customers");var F=pas.System.Random(120)%5;0===F?s.SetText(2,"Flight"):1===F?s.SetText(2,"On Leave"):2===F?s.SetText(2,"Abroad"):s.SetText(2,"Office")}t.SetExpanded(!0),e.SetExpanded(!0),this.FGlobalFont.SetName("Segoe UI"),this.FColumnsAppearance.SetStretchAll(!1),this.FColumnsAppearance.SetStretch(!0),this.FColumnsAppearance.SetStretchColumn(0),this.EndUpdate()},this.CutToClipboard=function(t){var e=0,i=null,s=null;if(null!=this.FOnCustomCutToClipboard)this.FOnCustomCutToClipboard(this);else{this.BeginUpdate(),this.CopyToClipboard(t);for(var n=this.SelectedNodeCount()-1;n>=0;n--)e=n,null!=(i=this.GetSelNode(e))?this.RemoveNode(i):(s=this.GetSelVirtualNode(e),this.RemoveVirtualNode(s));this.EndUpdate()}},this.CopyToClipboard=function(e){var i="",s=0,n=0,o=null,r=null,a=null;if(null!=this.FOnCustomCopyToClipboard)this.FOnCustomCopyToClipboard(this);else{a=pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewIntegerList.$create("Create$1");try{i="";for(var l=0,h=this.SelectedVirtualNodeCount()-1;l<=h;l++)if(s=l,null!=(o=this.GetSelVirtualNode(s))&&-1===a.IndexOf(o.FRow)&&(null!=o.FNode&&(i=i+o.FNode.SaveToString(e)+t.ENDOFLINE),a.Add(o.FRow)),null!=o)for(var F=o.FRow+1,p=o.FRow+o.FTotalChildren;F<=p;F++)n=F,null!=(r=this.GetNodeFromNodeStructure(n))&&null!=r.FNode&&-1===a.IndexOf(r.FRow)&&(i=i+r.FNode.SaveToString(e)+t.ENDOFLINE,a.Add(r.FRow));""!==i&&pas["WEBLib.TMSFNCUtils"].TTMSFNCClipBoard.SetText(t.CLP_FMT+i)}finally{a=rtl.freeLoc(a)}}},this.PasteFromClipboard=function(){var e="",i=null,s=null,n=null,o=0,r=0,a=0,l="";if(null!=this.FOnCustomPasteFromClipboard)this.FOnCustomPasteFromClipboard(this);else if(pas["WEBLib.TMSFNCUtils"].TTMSFNCClipBoard.HasFormat(0)&&(e=pas["WEBLib.TMSFNCUtils"].TTMSFNCClipBoard.GetText(),pas.System.Pos(t.CLP_FMT,e)>0)){i=pas.Classes.TStringList.$create("Create$1");try{e=pas.SysUtils.StringReplace(e,t.CLP_FMT,"",rtl.createSet(0)),i.SetTextStr(e);try{s=null,a=0;for(var h=0,F=i.GetCount()-1;h<=F;h++){if(r=h,o=-1,l=this.GetBufStart(i.Get(r),{get:function(){return o},set:function(t){o=t}}),null===s)s=this.AddNode(this.GetFocusedNode()),a=o,null!=this.GetFocusedNode()&&(a-=this.GetFocusedNode().FVirtualNode.FLevel);else if(null!=s.FVirtualNode&&s.FVirtualNode.FLevel===o-a)s=this.AddNode(s.GetParent());else if(null!=s.FVirtualNode&&s.FVirtualNode.FLevel===o-1-a)s=this.AddNode(s);else if(null!=s.FVirtualNode&&s.FVirtualNode.FLevel>o-a){for(n=s.GetParent();null!=n&&null!=n.FVirtualNode&&n.FVirtualNode.FLevel>o-a;)n=n.GetParent();s=this.AddNode(n.GetParent())}null!=s&&s.LoadFromString(l)}}finally{}}finally{i=rtl.freeLoc(i)}}},this.ViewJSONFromText=function(t,e){var i=this,s=null,n=null,o=0,r=0;function a(t,s,n,a,l){0===t.FValues.GetCount()&&t.FValues.Add$1();var h=n;0===h?(t.SetText(o,s),t.FValues.GetItem$1(o).FHTMLTemplateItems.Add("NAME="+s),t.SetText(r,l),t.FValues.GetItem$1(r).FHTMLTemplateItems.Add("VALUE="+l),t.FTag=1):1===h?(t.SetText(o,s+" ["+l+"]"),t.FValues.GetItem$1(o).FHTMLTemplateItems.Add("NAME="+s+" ["+l+"]"),t.FTag=2):2===h?(t.SetText(o,s+" {"+l+"}"),t.FValues.GetItem$1(o).FHTMLTemplateItems.Add("NAME="+s+" {"+l+"}"),t.FTag=3):3===h&&(t.SetText(o,e.FArrayItemPrefix+s+e.FArrayItemSuffix),t.FValues.GetItem$1(o).FHTMLTemplateItems.Add("NAME="+e.FArrayItemPrefix+s+e.FArrayItemSuffix),t.FTag=4),i.DoAfterAddJSONNode(t,a)}if(o=0,r=1,this.BeginUpdate(),null===e&&(e=this.FDefaultViewJSONOptions),this.FNodes.Clear(),this.FColumns.Clear(),(n=this.FColumns.Add$1()).SetText("Object"),n.SetTrimming(1),n.FFont.SetStyle(rtl.createSet(0)),(n=this.FColumns.Add$1()).SetText("Value"),this.FColumns.GetItem$1(o).SetHTMLTemplate(e.FNameHTMLTemplate),this.FColumns.GetItem$1(r).SetHTMLTemplate(e.FValueHTMLTemplate),null!=(s=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.ParseJSON(t)))try{!function t(e,s){var n=0,o=0,r=0,l=null,h=null,F=null,p=null,c=null,u=null,T=null,C="",S=!1;if(pas["WEBLib.JSON"].TJSONArray.isPrototypeOf(e)){if(S=!0,i.DoBeforeAddJSONNode(e,{get:function(){return S},set:function(t){S=t}}),S){p=null!=s?s.FNodes.Add$1():i.FNodes.Add$1(),u=rtl.as(e,pas["WEBLib.JSON"].TJSONArray),r=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetJSONArraySize(u),a(p,C,1,e,pas.SysUtils.IntToStr(r));for(var d=0,m=r-1;d<=m;d++)o=d,h=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetJSONArrayItem(u,o),pas["WEBLib.JSON"].TJSONObject.isPrototypeOf(h)?(a(c=p.FNodes.Add$1(),pas.SysUtils.IntToStr(o),3,e,""),c.SetText(0,pas.SysUtils.IntToStr(o)),t(h,c)):a(p.FNodes.Add$1(),pas.SysUtils.IntToStr(o),0,h,h.GetStrValue())}}else if(pas["WEBLib.JSON"].TJSONObject.isPrototypeOf(e)){for(var f=0,g=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetJSONObjectSize(rtl.as(e,pas["WEBLib.JSON"].TJSONObject))-1;f<=g;f++)if(n=f,C="",C=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetJSONObjectName(rtl.as(e,pas["WEBLib.JSON"].TJSONObject),n),l=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetJSONObjectItem(rtl.as(e,pas["WEBLib.JSON"].TJSONObject),n),S=!0,i.DoBeforeAddJSONNode(l,{get:function(){return S},set:function(t){S=t}}),S&&(p=null!=s?s.FNodes.Add$1():i.FNodes.Add$1(),null!=l))if(pas["WEBLib.JSON"].TJSONArray.isPrototypeOf(l)){T=rtl.as(l,pas["WEBLib.JSON"].TJSONArray),r=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetJSONArraySize(T),a(p,C,1,l,pas.SysUtils.IntToStr(r));for(var y=0,b=r-1;y<=b;y++)o=y,F=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetJSONArrayItem(T,o),pas["WEBLib.JSON"].TJSONObject.isPrototypeOf(F)?(a(c=p.FNodes.Add$1(),pas.SysUtils.IntToStr(o),3,l,""),t(F,c)):a(p.FNodes.Add$1(),pas.SysUtils.IntToStr(o),0,F,F.GetStrValue())}else pas["WEBLib.JSON"].TJSONObject.isPrototypeOf(l)?(a(p,C,2,l,pas.SysUtils.IntToStr(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetJSONObjectSize(rtl.as(l,pas["WEBLib.JSON"].TJSONObject)))),t(l,p)):a(p,C,0,l,l.GetStrValue())}else a(null!=s?s:i.FNodes.Add$1(),C,0,e,e.GetStrValue())}(s,null)}finally{s=rtl.freeLoc(s)}this.EndUpdate(),e.FExpandNodes&&this.ExpandAll(),e.FStretchColumn>-1&&(this.BeginUpdate(),this.FColumnsAppearance.SetStretchAll(!1),this.FColumnsAppearance.SetStretchColumn(e.FStretchColumn),this.FColumnsAppearance.SetStretch(!1),this.AutoSizeColumn(0),this.FColumns.GetItem$1(0).SetWidth(this.GetColWidths(0)),this.FColumnsAppearance.SetStretch(!0),this.EndUpdate())},this.UnSelectAllNodes=function(){this.UnSelectAllVirtualNodes()},this.SelectAllNodes=function(){this.SelectAllVirtualNodes()},this.UnSelectAllVirtualNodes=function(){this.FSelectedNodes.Clear(),this.Invalidate()},this.SelectAllVirtualNodes=function(){var t=0,e=null;this.FSelectedNodes.Clear();for(var i=0,s=this.FVisibleNodes.GetCount()-1;i<=s;i++)t=i,null!=(e=this.FVisibleNodes.GetItem(t))&&this.IsVirtualNodeSelectable(e)&&this.FSelectedNodes.Add(e);this.Invalidate()},this.SelectNode=function(t){null!=t?this.SelectVirtualNode(t.FVirtualNode):this.SelectVirtualNode(null)},this.SelectVirtualNode=function(t){this.FSelectedNodes.Clear(),null!=t&&this.IsVirtualNodeSelectable(t)&&(this.FSelectedNodes.Add(t),this.FFocusedNode=t,this.InternalSelectVirtualNode(t)),this.Invalidate()},this.SelectVirtualNodes=function(t){var e=null;this.FSelectedNodes.Clear();for(var i=0,s=rtl.length(t)-1;i<=s;i++)null!=(e=t[i])&&this.IsVirtualNodeSelectable(e)&&this.FSelectedNodes.Add(e);this.Invalidate()},this.UnSelectVirtualNode=function(t){this.FSelectedNodes.Remove(t),this.Invalidate()},this.RemoveNodeFromSelection=function(t){this.FSelectedNodes.Remove(t)},this.EditVirtualNode=function(t,e){this.HandleNodeEditing(t,e),this.Invalidate()},this.GetVisibleNodeCount=function(){var t,e,i=0;return i=0,t=this.GetFirstVisibleVirtualNode(),e=this.GetLastVisibleVirtualNode(),null!=t&&null!=e&&(i=e.FRow-t.FRow),i},this.GetFirstVisibleVirtualNode=function(){var t=null;return t=null,this.FNodeDisplay.GetCount()>0&&(t=this.FNodeDisplay.GetItem(0).FNode),t},this.GetLastVisibleVirtualNode=function(){var t=null;return t=null,this.FNodeDisplay.GetCount()>0&&(t=this.FNodeDisplay.GetItem(this.FNodeDisplay.GetCount()-1).FNode),t},this.GetFirstVisibleVirtualNodeRow=function(){var t,e=0;return e=0,null!=(t=this.GetFirstVisibleVirtualNode())&&(e=t.FRow),e},this.GetLastVisibleVirtualNodeRow=function(){var t,e=0;return e=0,null!=(t=this.GetLastVisibleVirtualNode())&&(e=t.FRow),e},this.LookupNode=function(t,e,i,s,n,o){var r=null,a="",l=null,h=null,F=null,p="",c=0,u=0,T=!1;if(r=null,a=t,s||(a=pas.SysUtils.UpperCase(a)),e)for(l=this.GetFirstRootVirtualNode();null!=l;){if(h=this.GetFirstVisibleVirtualNode(),F=this.GetLastVisibleVirtualNode(),!this.FInteraction.FLookup.FVisibleNodesOnly||this.FInteraction.FLookup.FVisibleNodesOnly&&null!=h&&null!=F&&l.FRow<=F.FRow&&l.FRow>=h.FRow)if(i>=0&&i<=this.FColumns.GetCount()-1){if(p="",this.DoGetNodeText(l,i,0,{get:function(){return p},set:function(t){p=t}}),p=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(p),s||(p=pas.SysUtils.UpperCase(p)),1===pas.System.Pos(a,p)){r=l;break}}else{T=!1;for(var C=0,S=this.FColumns.GetCount()-1;C<=S;C++)if(u=C,p="",this.DoGetNodeText(l,u,0,{get:function(){return p},set:function(t){p=t}}),p=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(p),s||(p=pas.SysUtils.UpperCase(p)),1===pas.System.Pos(a,p)){r=l,T=!0;break}if(T)break}l=l.GetNextSibling()}else for(var d=0,m=this.FNodeStructure.GetCount()-1;d<=m;d++)if(c=d,null!=(l=this.GetNodeFromNodeStructure(c))&&(h=this.GetFirstVisibleVirtualNode(),F=this.GetLastVisibleVirtualNode(),!this.FInteraction.FLookup.FVisibleNodesOnly||this.FInteraction.FLookup.FVisibleNodesOnly&&null!=h&&null!=F&&l.FRow<=F.FRow&&l.FRow>=h.FRow))if(i>=0&&i<=this.FColumns.GetCount()-1){if(p="",this.DoGetNodeText(l,i,0,{get:function(){return p},set:function(t){p=t}}),p=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(p),s||(p=pas.SysUtils.UpperCase(p)),1===pas.System.Pos(a,p)){r=l;break}}else{T=!1;for(var f=0,g=this.FColumns.GetCount()-1;f<=g;f++)if(u=f,p="",this.DoGetNodeText(l,u,0,{get:function(){return p},set:function(t){p=t}}),p=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(p),s||(p=pas.SysUtils.UpperCase(p)),1===pas.System.Pos(a,p)){r=l,T=!0;break}if(T)break}if(null!=r){if(o){for(l=r.GetParent();null!=l&&l.FLevel>0;)l.FExpanded||l.Expand(!1),l=l.GetParent();null!=l&&l.Expand(!1)}n&&(this.IsVirtualNodeSelectable(r)&&this.SelectVirtualNode(r),this.ScrollToVirtualNode(r,!0,0,!1))}return r},this.IsVirtualNodeSelectable=function(t){var e=!1,i=!1;return e=!0,null!=t&&(this.DoIsNodeEnabled(t,{get:function(){return e},set:function(t){e=t}}),i=!1,this.DoIsNodeExtended(t,{get:function(){return i},set:function(t){i=t}}),(!i||this.FInteraction.FExtendedSelectable)&&this.FVisibleNodes.IndexOf(t)>-1||(e=!1)),e},this.XYToColumnAnchor=function(t,e,i){var s="";return""===(s=this.XYToColumnAnchorCache(t,e,this.FColumnsTopCache,i))&&-1===i.get()&&(s=this.XYToColumnAnchorCache(t,e,this.FColumnsBottomCache,i)),s},this.XYToNode=function(t,e,i){var s,n=null;return n=null,null!=(s=this.XYToCacheItem(t,e,i))&&(n=s.FNode),n},this.XYToNodeAnchor=function(e,i,s){var n=t.TTMSFNCTreeViewNodeAnchor.$new(),o=0,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a="",l="",h=null,F=null,p=0,c=0,u=!1,T=0,C=!1,S=0;if(n.AAnchor="",n.AColumn=-1,null!=e)for(var d=S=this.GetFirstVisibleColumn(),m=this.GetLastVisibleColumn();d<=m;d++)if((o=d)-S>=0&&o-S<=rtl.length(e.FTextRects)-1&&(r.$assign(e.FTextRects[o-S]),pas["WEBLib.TMSFNCTypes"].InflateRectEx(r,this.ScalePaintValue(-2),this.ScalePaintValue(-2)),pas["WEBLib.TMSFNCTypes"].PtInRectEx(r,pas["WEBLib.TMSFNCTypes"].PointF(i,s)))){F=null,o<=this.FColumns.GetCount()-1&&(F=this.FColumns.GetItem$1(o)),C=!1,p=1,c=0,u=!1,T=0,null!=F&&(p=F.FHorizontalTextAlign,c=F.FVerticalTextAlign,u=F.FWordWrapping,T=F.FTrimming),this.DoIsNodeExtended(e,{get:function(){return C},set:function(t){C=t}}),this.DoGetNodeTrimming(e,o,{get:function(){return T},set:function(t){T=t}}),this.DoGetNodeWordWrapping(e,o,{get:function(){return u},set:function(t){u=t}}),this.DoGetNodeHorizontalTextAlign(e,o,{get:function(){return p},set:function(t){p=t}}),this.DoGetNodeVerticalTextAlign(e,o,{get:function(){return c},set:function(t){c=t}}),l="",this.DoGetNodeText(e,o,0,{get:function(){return l},set:function(t){l=t}}),(h=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),null==F||F.FUseDefaultAppearance||C?C?h.FFont.Assign(this.FNodesAppearance.FExtendedFont):h.FFont.Assign(this.FNodesAppearance.FFont):h.FFont.Assign(F.FFont),h.FBitmapContainer=this.GetBitmapContainer(),h.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing;try{a=h.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),l,u,p,c,T,0,-1,-1,!0,!0,i,s)}finally{h.EndScene(),h=rtl.freeLoc(h)}if(""!==a){n.AAnchor=a,n.AColumn=o;break}}return n},this.XYToNodeTitleAnchor=function(e,i,s){var n=t.TTMSFNCTreeViewNodeAnchor.$new(),o=0,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a="",l="",h=null,F=null,p=0,c=0,u=!1,T=0,C=0;if(n.AAnchor="",n.AColumn=-1,null!=e)for(var S=C=this.GetFirstVisibleColumn(),d=this.GetLastVisibleColumn();S<=d;S++)if((o=S)-C>=0&&o-C<=rtl.length(e.FTitleRects)-1&&(r.$assign(e.FTitleRects[o-C]),pas["WEBLib.TMSFNCTypes"].InflateRectEx(r,this.ScalePaintValue(-2),this.ScalePaintValue(-2)),pas["WEBLib.TMSFNCTypes"].PtInRectEx(r,pas["WEBLib.TMSFNCTypes"].PointF(i,s)))){F=null,o<=this.FColumns.GetCount()-1&&(F=this.FColumns.GetItem$1(o)),p=1,c=0,u=!1,T=0,null!=F&&(p=F.FTitleHorizontalTextAlign,c=F.FTitleVerticalTextAlign,u=F.FTitleWordWrapping,T=F.FTitleTrimming),this.DoGetNodeTitleTrimming(e,o,{get:function(){return T},set:function(t){T=t}}),this.DoGetNodeTitleWordWrapping(e,o,{get:function(){return u},set:function(t){u=t}}),this.DoGetNodeTitleHorizontalTextAlign(e,o,{get:function(){return p},set:function(t){p=t}}),this.DoGetNodeTitleVerticalTextAlign(e,o,{get:function(){return c},set:function(t){c=t}}),l="",this.DoGetNodeTitle(e,o,0,{get:function(){return l},set:function(t){l=t}}),(h=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),null==F||F.FUseDefaultAppearance?h.FFont.Assign(this.FNodesAppearance.FTitleFont):h.FFont.Assign(F.FTitleFont),h.FBitmapContainer=this.GetBitmapContainer(),h.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing;try{a=h.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),l,u,p,c,T,0,-1,-1,!0,!0,i,s)}finally{h.EndScene(),h=rtl.freeLoc(h)}if(""!==a){n.AAnchor=a,n.AColumn=o;break}}return n},this.XYToNodeExpand=function(t,e,i){var s=!1,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=!1,r=0;return s=!1,null!=t&&t.FChildren>0&&(o=!0,this.DoIsNodeEnabled(t,{get:function(){return o},set:function(t){o=t}}),o&&(r=this.GetFirstVisibleColumn(),this.FNodesAppearance.FExpandColumn-r>=0&&this.FNodesAppearance.FExpandColumn-r<=rtl.length(t.FExpandRects)-1&&(n.$assign(t.FExpandRects[this.FNodesAppearance.FExpandColumn-r]),s=pas["WEBLib.TMSFNCTypes"].PtInRectEx(n,pas["WEBLib.TMSFNCTypes"].PointF(e,i))))),s},this.XYToNodeExtra=function(t,e,i){var s=!1,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=!1,r=0,a=0;if(s=!1,o=!0,this.DoIsNodeEnabled(t,{get:function(){return o},set:function(t){o=t}}),null!=t&&o)for(var l=a=this.GetFirstVisibleColumn(),h=this.GetLastVisibleColumn();l<=h;l++)if((r=l)-a>=0&&r-a<=rtl.length(t.FExtraRects)-1&&(n.$assign(t.FExtraRects[r-a]),pas["WEBLib.TMSFNCTypes"].PtInRectEx(n,pas["WEBLib.TMSFNCTypes"].PointF(e,i)))){s=!0;break}return s},this.XYToNodeTitleExtra=function(t,e,i){var s=!1,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=!1,r=0,a=0;if(s=!1,o=!0,this.DoIsNodeEnabled(t,{get:function(){return o},set:function(t){o=t}}),null!=t&&o)for(var l=a=this.GetFirstVisibleColumn(),h=this.GetLastVisibleColumn();l<=h;l++)if((r=l)-a>=0&&r-a<=rtl.length(t.FTitleExtraRects)-1&&(n.$assign(t.FTitleExtraRects[r-a]),pas["WEBLib.TMSFNCTypes"].PtInRectEx(n,pas["WEBLib.TMSFNCTypes"].PointF(e,i)))){s=!0;break}return s},this.XYToNodeCheck=function(e,i,s){var n=t.TTMSFNCTreeViewNodeCheck.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=!1,a=0,l=0;if(n.AColumn=-1,n.ANode=null,r=!0,this.DoIsNodeEnabled(e,{get:function(){return r},set:function(t){r=t}}),null!=e&&r)for(var h=l=this.GetFirstVisibleColumn(),F=this.GetLastVisibleColumn();h<=F;h++)if((a=h)-l>=0&&a-l<=rtl.length(e.FCheckRects)-1&&(o.$assign(e.FCheckRects[a-l]),pas["WEBLib.TMSFNCTypes"].PtInRectEx(o,pas["WEBLib.TMSFNCTypes"].PointF(i,s)))){n.ANode=e,n.AColumn=a;break}return n},this.XYToNodeTextColumn=function(t,e,i){var s=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=0,r=0;if(s=-1,null!=t)for(var a=r=this.GetFirstVisibleColumn(),l=this.GetLastVisibleColumn();a<=l;a++)if((o=a)-r>=0&&o-r<=rtl.length(t.FTextRects)-1&&(n.$assign(t.FTextRects[o-r]),pas["WEBLib.TMSFNCTypes"].PtInRectEx(n,pas["WEBLib.TMSFNCTypes"].PointF(e,i)))){s=o;break}return s},this.XYToColumnSize=function(t,e){var i=0,s=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=0,a=0;i=-1,n.$assign(this.GetColumnsTopRect()),n.Left=n.Left-this.GetHorizontalScrollPosition();for(var l=this.FColumnCount-1;l>=0;l--)if((s=l)>=0&&s<=this.FColumns.GetCount()-1&&this.FColumns.GetItem$1(s).FVisible&&(r=this.GetColWidths(s))>=0&&s>=0&&s<=this.FColumns.GetCount()-1&&this.FColumns.GetItem$1(s).FVisible&&(a=this.GetColPos(s),o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(n.Left+a+r-this.ScalePaintValue(4),n.Top,n.Left+a+r+this.ScalePaintValue(4),n.Bottom)),pas["WEBLib.TMSFNCTypes"].PtInRectEx(o,pas["WEBLib.TMSFNCTypes"].PointF(t,e)))){i=s;break}return i},this.XYToColumn=function(t,e,i){var s=0,n=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=0,l=0;s=-1,i?o.$assign(pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.GetContentRect.call(this)):o.$assign(this.GetColumnsTopRect()),o.Left=o.Left-this.GetHorizontalScrollPosition();for(var h=this.FColumnCount-1;h>=0;h--)if((n=h)>=0&&n<=this.FColumns.GetCount()-1&&this.FColumns.GetItem$1(n).FVisible&&(a=this.GetColWidths(n)+this.GetColumnsExtraSize())>=0&&(l=this.GetColPos(n),r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(o.Left+l,o.Top,o.Left+l+a,o.Bottom)),pas["WEBLib.TMSFNCTypes"].PtInRectEx(r,pas["WEBLib.TMSFNCTypes"].PointF(t,e)))){s=n;break}return s},this.XYToColumnFilter=function(t,e){var i=0,s=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=0,l=0,h=0;i=-1,n.$assign(this.GetColumnsTopRect()),n.Left=n.Left-this.GetHorizontalScrollPosition();for(var F=this.FColumnCount-1;F>=0;F--)if((s=F)>=0&&s<=this.FColumns.GetCount()-1&&this.FColumns.GetItem$1(s).FFiltering.FEnabled&&this.FColumns.GetItem$1(s).FVisible&&(l=this.GetColWidths(s)+this.GetColumnsExtraSize())>=0&&(h=this.GetColPos(s),o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(n.Left+h,n.Top,n.Left+h+l,n.Bottom)),a=this.FColumns.GetItem$1(s).FFiltering.FButtonSize,r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(o.Right-a-this.ScalePaintValue(4)),Math.round(o.Top+(o.Bottom-o.Top-a)/2),Math.round(o.Right-this.ScalePaintValue(4)),Math.round(o.Top+(o.Bottom-o.Top-a)/2+a))),pas["WEBLib.TMSFNCTypes"].PtInRectEx(r,pas["WEBLib.TMSFNCTypes"].PointF(t,e)))){i=s;break}return i},this.XYToColumnExpand=function(t,e){var i=0,s=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),l=0,h=0,F=0,p=0;i=-1,n.$assign(this.GetColumnsTopRect()),n.Left=n.Left-this.GetHorizontalScrollPosition();for(var c=this.FColumnCount-1;c>=0;c--)if((s=c)>=0&&s<=this.FColumns.GetCount()-1&&this.FColumns.GetItem$1(s).FExpandable&&this.FColumns.GetItem$1(s).FVisible&&(h=this.GetColWidths(s)+this.GetColumnsExtraSize())>=0&&(F=this.GetColPos(s),o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(n.Left+F,n.Top,n.Left+F+h,n.Bottom)),l=this.FColumns.GetItem$1(s).FExpandingButtonSize,this.FColumns.GetItem$1(s).FFiltering.FEnabled?(p=this.FColumns.GetItem$1(s).FFiltering.FButtonSize,r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(o.Right-p-this.ScalePaintValue(4)),Math.round(o.Top+(o.Bottom-o.Top-p)/2),Math.round(o.Right-this.ScalePaintValue(4)),Math.round(o.Top+(o.Bottom-o.Top-p)/2+p))),a.$assign(o),a.Right=r.Left):a.$assign(o),r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(a.Right-l-this.ScalePaintValue(6)),Math.round(a.Top+(a.Bottom-a.Top-l)/2),Math.round(a.Right-this.ScalePaintValue(6)),Math.round(a.Top+(a.Bottom-a.Top-l)/2+l))),pas["WEBLib.TMSFNCTypes"].PtInRectEx(r,pas["WEBLib.TMSFNCTypes"].PointF(t,e)))){i=s;break}return i},this.SelectedNodeCount=function(){return this.SelectedVirtualNodeCount()},this.SelectedVirtualNodeCount=function(){return this.FSelectedNodes.GetCount()},this.IsVirtualNodeSelected=function(t){return this.FSelectedNodes.IndexOf(t)>-1},rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCTreeViewPublished",this.TTMSFNCCustomTreeView,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("HorizontalScrollBarVisible",2,rtl.boolean,"FHorizontalScrollBarVisible","SetHorizontalScrollBarVisible",{Default:!0}),e.addProperty("VerticalScrollBarVisible",2,rtl.boolean,"FVerticalScrollBarVisible","SetVerticalScrollBarVisible",{Default:!0}),e.addProperty("Groups",2,pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewGroups,"FGroups","SetGroups"),e.addProperty("GroupsAppearance",2,t.$rtti.TTMSFNCTreeViewGroupsAppearance,"FGroupsAppearance","SetGroupsAppearance"),e.addProperty("ColumnStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FColumnStroke","SetColumnStroke"),e.addProperty("Columns",2,pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewColumns,"FColumns","SetColumns"),e.addProperty("Nodes",2,pas["WEBLib.TMSFNCTreeViewData"].$rtti.TTMSFNCTreeViewNodes,"FNodes","SetNodes"),e.addProperty("ColumnsAppearance",2,t.$rtti.TTMSFNCTreeViewColumnsAppearance,"FColumnsAppearance","SetColumnsAppearance"),e.addProperty("NodesAppearance",2,t.$rtti.TTMSFNCTreeViewNodesAppearance,"FNodesAppearance","SetNodesAppearance"),e.addProperty("Interaction",2,t.$rtti.TTMSFNCTreeViewInteraction,"FInteraction","SetInteraction"),e.addProperty("StretchScrollBars",2,rtl.boolean,"FStretchScrollBars","SetStretchScrollBars",{Default:!0}),e.addProperty("Version",1,rtl.string,"GetVersion",""),e.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FPopupMenu","FPopupMenu"),e.addProperty("GlobalFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCAppearanceGlobalFont,"FGlobalFont","SetGlobalFont"),e.addProperty("OnNeedFilterDropDownData",0,t.$rtti.TTMSFNCTreeViewNeedFilterDropDownDataEvent,"FOnNeedFilterDropDownData","FOnNeedFilterDropDownData"),e.addProperty("OnFilterSelect",0,t.$rtti.TTMSFNCTreeViewFilterSelectEvent,"FOnFilterSelect","FOnFilterSelect"),e.addProperty("OnBeforeDrawColumn",0,t.$rtti.TTMSFNCTreeViewBeforeDrawColumnEvent,"FOnBeforeDrawColumn","FOnBeforeDrawColumn"),e.addProperty("OnAfterDrawColumn",0,t.$rtti.TTMSFNCTreeViewAfterDrawColumnEvent,"FOnAfterDrawColumn","FOnAfterDrawColumn"),e.addProperty("OnBeforeDrawColumnHeader",0,t.$rtti.TTMSFNCTreeViewBeforeDrawColumnHeaderEvent,"FOnBeforeDrawColumnHeader","FOnBeforeDrawColumnHeader"),e.addProperty("OnAfterDrawColumnHeader",0,t.$rtti.TTMSFNCTreeViewAfterDrawColumnHeaderEvent,"FOnAfterDrawColumnHeader","FOnAfterDrawColumnHeader"),e.addProperty("OnBeforeDrawNodeColumn",0,t.$rtti.TTMSFNCTreeViewBeforeDrawColumnEvent,"FOnBeforeDrawNodeColumn","FOnBeforeDrawNodeColumn"),e.addProperty("OnAfterDrawNodeColumn",0,t.$rtti.TTMSFNCTreeViewAfterDrawColumnEvent,"FOnAfterDrawNodeColumn","FOnAfterDrawNodeColumn"),e.addProperty("OnBeforeSortNodes",0,t.$rtti.TTMSFNCTreeViewBeforeSortNodesEvent,"FOnBeforeSortNodes","FOnBeforeSortNodes"),e.addProperty("OnAfterSortNodes",0,t.$rtti.TTMSFNCTreeViewAfterSortNodesEvent,"FOnAfterSortNodes","FOnAfterSortNodes"),e.addProperty("OnBeforeDrawGroup",0,t.$rtti.TTMSFNCTreeViewBeforeDrawGroupEvent,"FOnBeforeDrawGroup","FOnBeforeDrawGroup"),e.addProperty("OnAfterDrawGroup",0,t.$rtti.TTMSFNCTreeViewAfterDrawGroupEvent,"FOnAfterDrawGroup","FOnAfterDrawGroup"),e.addProperty("OnBeforeDrawNode",0,t.$rtti.TTMSFNCTreeViewBeforeDrawNodeEvent,"FOnBeforeDrawNode","FOnBeforeDrawNode"),e.addProperty("OnAfterDrawNode",0,t.$rtti.TTMSFNCTreeViewAfterDrawNodeEvent,"FOnAfterDrawNode","FOnAfterDrawNode"),e.addProperty("OnBeforeDrawColumnText",0,t.$rtti.TTMSFNCTreeViewBeforeDrawColumnTextEvent,"FOnBeforeDrawColumnText","FOnBeforeDrawColumnText"),e.addProperty("OnGetColumnText",0,t.$rtti.TTMSFNCTreeViewGetColumnTextEvent,"FOnGetColumnText","FOnGetColumnText"),e.addProperty("OnNodeCompare",0,t.$rtti.TTMSFNCTreeViewNodeCompareEvent,"FOnNodeCompare","FOnNodeCompare"),e.addProperty("OnAfterDrawColumnText",0,t.$rtti.TTMSFNCTreeViewAfterDrawColumnTextEvent,"FOnAfterDrawColumnText","FOnAfterDrawColumnText"),e.addProperty("OnBeforeDrawGroupText",0,t.$rtti.TTMSFNCTreeViewBeforeDrawGroupTextEvent,"FOnBeforeDrawGroupText","FOnBeforeDrawGroupText"),e.addProperty("OnGetGroupText",0,t.$rtti.TTMSFNCTreeViewGetGroupTextEvent,"FOnGetGroupText","FOnGetGroupText"),e.addProperty("OnAfterDrawGroupText",0,t.$rtti.TTMSFNCTreeViewAfterDrawGroupTextEvent,"FOnAfterDrawGroupText","FOnAfterDrawGroupText"),e.addProperty("OnBeforeDrawNodeText",0,t.$rtti.TTMSFNCTreeViewBeforeDrawNodeTextEvent,"FOnBeforeDrawNodeText","FOnBeforeDrawNodeText"),e.addProperty("OnAfterDrawNodeIcon",0,t.$rtti.TTMSFNCTreeViewAfterDrawNodeIconEvent,"FOnAfterDrawNodeIcon","FOnAfterDrawNodeIcon"),e.addProperty("OnAfterDrawNodeExpand",0,t.$rtti.TTMSFNCTreeViewAfterDrawNodeExpandEvent,"FOnAfterDrawNodeExpand","FOnAfterDrawNodeExpand"),e.addProperty("OnBeforeDrawNodeIcon",0,t.$rtti.TTMSFNCTreeViewBeforeDrawNodeIconEvent,"FOnBeforeDrawNodeIcon","FOnBeforeDrawNodeIcon"),e.addProperty("OnBeforeDrawNodeExpand",0,t.$rtti.TTMSFNCTreeViewBeforeDrawNodeExpandEvent,"FOnBeforeDrawNodeExpand","FOnBeforeDrawNodeExpand"),e.addProperty("OnAfterDrawNodeCheck",0,t.$rtti.TTMSFNCTreeViewAfterDrawNodeCheckEvent,"FOnAfterDrawNodeCheck","FOnAfterDrawNodeCheck"),e.addProperty("OnBeforeDrawNodeCheck",0,t.$rtti.TTMSFNCTreeViewBeforeDrawNodeCheckEvent,"FOnBeforeDrawNodeCheck","FOnBeforeDrawNodeCheck"),e.addProperty("OnGetNodeCheckType",0,t.$rtti.TTMSFNCTreeViewGetNodeCheckTypeEvent,"FOnGetNodeCheckType","FOnGetNodeCheckType"),e.addProperty("OnGetNodeText",0,t.$rtti.TTMSFNCTreeViewGetNodeTextEvent,"FOnGetNodeText","FOnGetNodeText"),e.addProperty("OnGetNodeData",0,t.$rtti.TTMSFNCTreeViewGetNodeDataEvent,"FOnGetNodeData","FOnGetNodeData"),e.addProperty("OnBeforeSizeColumn",0,t.$rtti.TTMSFNCTreeViewBeforeSizeColumnEvent,"FOnBeforeSizeColumn","FOnBeforeSizeColumn"),e.addProperty("OnAfterSizeColumn",0,t.$rtti.TTMSFNCTreeViewAfterSizeColumnEvent,"FOnAfterSizeColumn","FOnAfterSizeColumn"),e.addProperty("OnGetNodeTrimming",0,t.$rtti.TTMSFNCTreeViewGetNodeTrimmingEvent,"FOnGetNodeTrimming","FOnGetNodeTrimming"),e.addProperty("OnGetNodeWordWrapping",0,t.$rtti.TTMSFNCTreeViewGetNodeWordWrappingEvent,"FOnGetNodeWordWrapping","FOnGetNodeWordWrapping"),e.addProperty("OnGetNodeHorizontalTextAlign",0,t.$rtti.TTMSFNCTreeViewGetNodeHorizontalTextAlignEvent,"FOnGetNodeHorizontalTextAlign","FOnGetNodeHorizontalTextAlign"),e.addProperty("OnGetNodeVerticalTextAlign",0,t.$rtti.TTMSFNCTreeViewGetNodeVerticalTextAlignEvent,"FOnGetNodeVerticalTextAlign","FOnGetNodeVerticalTextAlign"),e.addProperty("OnGetColumnTrimming",0,t.$rtti.TTMSFNCTreeViewGetColumnTrimmingEvent,"FOnGetColumnTrimming","FOnGetColumnTrimming"),e.addProperty("OnFocusedNodeChanged",0,t.$rtti.TTMSFNCTreeViewFocusedNodeChangedEvent,"FOnFocusedNodeChanged","FOnFocusedNodeChanged"),e.addProperty("OnGetColumnWordWrapping",0,t.$rtti.TTMSFNCTreeViewGetColumnWordWrappingEvent,"FOnGetColumnWordWrapping","FOnGetColumnWordWrapping"),e.addProperty("OnGetColumnHorizontalTextAlign",0,t.$rtti.TTMSFNCTreeViewGetColumnHorizontalTextAlignEvent,"FOnGetColumnHorizontalTextAlign","FOnGetColumnHorizontalTextAlign"),e.addProperty("OnGetColumnVerticalTextAlign",0,t.$rtti.TTMSFNCTreeViewGetColumnVerticalTextAlignEvent,"FOnGetColumnVerticalTextAlign","FOnGetColumnVerticalTextAlign"),e.addProperty("OnBeforeUnCheckNode",0,t.$rtti.TTMSFNCTreeViewBeforeUnCheckNodeEvent,"FOnBeforeUnCheckNode","FOnBeforeUnCheckNode"),e.addProperty("OnAfterUnCheckNode",0,t.$rtti.TTMSFNCTreeViewAfterUnCheckNodeEvent,"FOnAfterUnCheckNode","FOnAfterUnCheckNode"),e.addProperty("OnBeforeCheckNode",0,t.$rtti.TTMSFNCTreeViewBeforeCheckNodeEvent,"FOnBeforeCheckNode","FOnBeforeCheckNode"),e.addProperty("OnAfterCheckNode",0,t.$rtti.TTMSFNCTreeViewAfterCheckNodeEvent,"FOnAfterCheckNode","FOnAfterCheckNode"),e.addProperty("OnBeforeCollapseNode",0,t.$rtti.TTMSFNCTreeViewBeforeCollapseNodeEvent,"FOnBeforeCollapseNode","FOnBeforeCollapseNode"),e.addProperty("OnAfterCollapseNode",0,t.$rtti.TTMSFNCTreeViewAfterCollapseNodeEvent,"FOnAfterCollapseNode","FOnAfterCollapseNode"),e.addProperty("OnBeforeExpandNode",0,t.$rtti.TTMSFNCTreeViewBeforeExpandNodeEvent,"FOnBeforeExpandNode","FOnBeforeExpandNode"),e.addProperty("OnAfterExpandNode",0,t.$rtti.TTMSFNCTreeViewAfterExpandNodeEvent,"FOnAfterExpandNode","FOnAfterExpandNode"),e.addProperty("OnGetNodeIcon",0,t.$rtti.TTMSFNCTreeViewGetNodeIconEvent,"FOnGetNodeIcon","FOnGetNodeIcon"),e.addProperty("OnGetNodeIconSize",0,t.$rtti.TTMSFNCTreeViewGetNodeIconSizeEvent,"FOnGetNodeIconSize","FOnGetNodeIconSize"),e.addProperty("OnGetNumberOfNodes",0,t.$rtti.TTMSFNCTreeViewGetNumberOfNodesEvent,"FOnGetNumberOfNodes","FOnGetNumberOfNodes"),e.addProperty("OnIsNodeExtended",0,t.$rtti.TTMSFNCTreeViewIsNodeExtendedEvent,"FOnIsNodeExtended","FOnIsNodeExtended"),e.addProperty("OnIsNodeExpanded",0,t.$rtti.TTMSFNCTreeViewIsNodeExpandedEvent,"FOnIsNodeExpanded","FOnIsNodeExpanded"),e.addProperty("OnAfterDrawNodeText",0,t.$rtti.TTMSFNCTreeViewAfterDrawNodeTextEvent,"FOnAfterDrawNodeText","FOnAfterDrawNodeText"),e.addProperty("OnIsNodeChecked",0,t.$rtti.TTMSFNCTreeViewIsNodeCheckedEvent,"FOnIsNodeChecked","FOnIsNodeChecked"),e.addProperty("OnNodeAnchorClick",0,t.$rtti.TTMSFNCTreeViewNodeAnchorClickEvent,"FOnNodeAnchorClick","FOnNodeAnchorClick"),e.addProperty("OnBeforeUpdateNode",0,t.$rtti.TTMSFNCTreeViewBeforeUpdateNodeEvent,"FOnBeforeUpdateNode","FOnBeforeUpdateNode"),e.addProperty("OnAfterUpdateNode",0,t.$rtti.TTMSFNCTreeViewAfterUpdateNodeEvent,"FOnAfterUpdateNode","FOnAfterUpdateNode"),e.addProperty("OnBeforeSelectNode",0,t.$rtti.TTMSFNCTreeViewBeforeSelectNodeEvent,"FOnBeforeSelectNode","FOnBeforeSelectNode"),e.addProperty("OnAfterSelectNode",0,t.$rtti.TTMSFNCTreeViewAfterSelectNodeEvent,"FOnAfterSelectNode","FOnAfterSelectNode"),e.addProperty("OnBeforeSelectAllNodes",0,t.$rtti.TTMSFNCTreeViewBeforeSelectAllNodesEvent,"FOnBeforeSelectAllNodes","FOnBeforeSelectAllNodes"),e.addProperty("OnAfterSelectAllNodes",0,t.$rtti.TTMSFNCTreeViewAfterSelectAllNodesEvent,"FOnAfterSelectAllNodes","FOnAfterSelectAllNodes"),e.addProperty("OnNodeClick",0,t.$rtti.TTMSFNCTreeViewNodeClickEvent,"FOnNodeClick","FOnNodeClick"),e.addProperty("OnNodeMouseLeave",0,t.$rtti.TTMSFNCTreeViewNodeMouseLeaveEvent,"FOnNodeMouseLeave","FOnNodeMouseLeave"),e.addProperty("OnNodeMouseEnter",0,t.$rtti.TTMSFNCTreeViewNodeMouseEnterEvent,"FOnNodeMouseEnter","FOnNodeMouseEnter"),e.addProperty("OnNodeDblClick",0,t.$rtti.TTMSFNCTreeViewNodeClickEvent,"FOnNodeDblClick","FOnNodeDblClick"),e.addProperty("OnBeforeUnSelectNode",0,t.$rtti.TTMSFNCTreeViewBeforeUnSelectNodeEvent,"FOnBeforeUnSelectNode","FOnBeforeUnSelectNode"),e.addProperty("OnAfterUnSelectNode",0,t.$rtti.TTMSFNCTreeViewAfterUnSelectNodeEvent,"FOnAfterUnSelectNode","FOnAfterUnSelectNode"),e.addProperty("OnGetNodeSides",0,t.$rtti.TTMSFNCTreeViewGetNodeSidesEvent,"FOnGetNodeSides","FOnGetNodeSides"),e.addProperty("OnBeforeOpenInplaceEditor",0,t.$rtti.TTMSFNCTreeViewBeforeOpenInplaceEditorEvent,"FOnBeforeOpenInplaceEditor","FOnBeforeOpenInplaceEditor"),e.addProperty("OnCloseInplaceEditor",0,t.$rtti.TTMSFNCTreeViewCloseInplaceEditorEvent,"FOnCloseInplaceEditor","FOnCloseInplaceEditor"),e.addProperty("OnAfterOpenInplaceEditor",0,t.$rtti.TTMSFNCTreeViewAfterOpenInplaceEditorEvent,"FOnAfterOpenInplaceEditor","FOnAfterOpenInplaceEditor"),e.addProperty("OnGetInplaceEditor",0,t.$rtti.TTMSFNCTreeViewGetInplaceEditorEvent,"FOnGetInplaceEditor","FOnGetInplaceEditor"),e.addProperty("OnCustomizeInplaceEditor",0,t.$rtti.TTMSFNCTreeViewCustomizeInplaceEditorEvent,"FOnCustomizeInplaceEditor","FOnCustomizeInplaceEditor"),e.addProperty("OnGetInplaceEditorRect",0,t.$rtti.TTMSFNCTreeViewGetInplaceEditorRectEvent,"FOnGetInplaceEditorRect","FOnGetInplaceEditorRect"),e.addProperty("OnNodeChanged",0,t.$rtti.TTMSFNCTreeViewNodeChangedEvent,"FOnNodeChanged","FOnNodeChanged"),e.addProperty("OnHScroll",0,t.$rtti.TTMSFNCTreeViewScrollEvent,"FOnHScroll","FOnHScroll"),e.addProperty("OnVScroll",0,t.$rtti.TTMSFNCTreeViewScrollEvent,"FOnVScroll","FOnVScroll"),e.addProperty("OnBeforeDrawColumnEmptySpace",0,t.$rtti.TTMSFNCTreeViewBeforeDrawColumnEmptySpaceEvent,"FOnBeforeDrawColumnEmptySpace","FOnBeforeDrawColumnEmptySpace"),e.addProperty("OnAfterDrawColumnEmptySpace",0,t.$rtti.TTMSFNCTreeViewAfterDrawColumnEmptySpaceEvent,"FOnAfterDrawColumnEmptySpace","FOnAfterDrawColumnEmptySpace"),e.addProperty("OnBeforeDrawGroupEmptySpace",0,t.$rtti.TTMSFNCTreeViewBeforeDrawGroupEmptySpaceEvent,"FOnBeforeDrawGroupEmptySpace","FOnBeforeDrawGroupEmptySpace"),e.addProperty("OnAfterDrawGroupEmptySpace",0,t.$rtti.TTMSFNCTreeViewAfterDrawGroupEmptySpaceEvent,"FOnAfterDrawGroupEmptySpace","FOnAfterDrawGroupEmptySpace"),e.addProperty("OnIsNodeEnabled",0,t.$rtti.TTMSFNCTreeViewIsNodeEnabledEvent,"FOnIsNodeEnabled","FOnIsNodeEnabled"),e.addProperty("OnGetNodeColor",0,t.$rtti.TTMSFNCTreeViewGetNodeColorEvent,"FOnGetNodeColor","FOnGetNodeColor"),e.addProperty("OnGetNodeSelectedColor",0,t.$rtti.TTMSFNCTreeViewGetNodeColorEvent,"FOnGetNodeSelectedStrokeColor","FOnGetNodeSelectedStrokeColor"),e.addProperty("OnGetNodeDisabledColor",0,t.$rtti.TTMSFNCTreeViewGetNodeColorEvent,"FOnGetNodeDisabledColor","FOnGetNodeDisabledColor"),e.addProperty("OnGetNodeTextColor",0,t.$rtti.TTMSFNCTreeViewGetNodeTextColorEvent,"FOnGetNodeTextColor","FOnGetNodeTextColor"),e.addProperty("OnGetNodeSelectedTextColor",0,t.$rtti.TTMSFNCTreeViewGetNodeTextColorEvent,"FOnGetNodeSelectedTextColor","FOnGetNodeSelectedTextColor"),e.addProperty("OnGetNodeDisabledTextColor",0,t.$rtti.TTMSFNCTreeViewGetNodeTextColorEvent,"FOnGetNodeDisabledTextColor","FOnGetNodeDisabledTextColor"),e.addProperty("OnGetNodeHeight",0,t.$rtti.TTMSFNCTreeViewGetNodeHeightEvent,"FOnGetNodeHeight","FOnGetNodeHeight"),e.addProperty("OnBeforeReorderNode",0,t.$rtti.TTMSFNCTreeViewBeforeReorderNodeEvent,"FOnBeforeReorderNode","FOnBeforeReorderNode"),e.addProperty("OnAfterReorderNode",0,t.$rtti.TTMSFNCTreeViewAfterReorderNodeEvent,"FOnAfterReorderNode","FOnAfterReorderNode"),e.addProperty("OnBeforeDropNode",0,t.$rtti.TTMSFNCTreeViewBeforeDropNodeEvent,"FOnBeforeDropNode","FOnBeforeDropNode"),e.addProperty("OnAfterDropNode",0,t.$rtti.TTMSFNCTreeViewAfterDropNodeEvent,"FOnAfterDropNode","FOnAfterDropNode"),e.addProperty("OnBeforeCutToClipboard",0,t.$rtti.TTMSFNCTreeViewBeforeCutToClipboardEvent,"FOnBeforeCutToClipboard","FOnBeforeCutToClipboard"),e.addProperty("OnBeforeCopyToClipboard",0,t.$rtti.TTMSFNCTreeViewBeforeCopyToClipboardEvent,"FOnBeforeCopyToClipboard","FOnBeforeCopyToClipboard"),e.addProperty("OnBeforePasteFromClipboard",0,t.$rtti.TTMSFNCTreeViewBeforePasteFromClipboardEvent,"FOnBeforePasteFromClipboard","FOnBeforePasteFromClipboard"),e.addProperty("OnAfterCutToClipboard",0,t.$rtti.TTMSFNCTreeViewAfterCutToClipboardEvent,"FOnAfterCutToClipboard","FOnAfterCutToClipboard"),e.addProperty("OnAfterCopyToClipboard",0,t.$rtti.TTMSFNCTreeViewAfterCopyToClipboardEvent,"FOnAfterCopyToClipboard","FOnAfterCopyToClipboard"),e.addProperty("OnAfterPasteFromClipboard",0,t.$rtti.TTMSFNCTreeViewAfterPasteFromClipboardEvent,"FOnAfterPasteFromClipboard","FOnAfterPasteFromClipboard"),e.addProperty("OnBeforeDrawSortIndicator",0,t.$rtti.TTMSFNCTreeViewBeforeDrawSortIndicatorEvent,"FOnBeforeDrawSortIndicator","FOnBeforeDrawSortIndicator"),e.addProperty("OnAfterDrawSortIndicator",0,t.$rtti.TTMSFNCTreeViewAfterDrawSortIndicatorEvent,"FOnAfterDrawSortIndicator","FOnAfterDrawSortIndicator"),e.addProperty("OnColumnAnchorClick",0,t.$rtti.TTMSFNCTreeViewColumnAnchorClickEvent,"FOnColumnAnchorClick","FOnColumnAnchorClick"),e.addProperty("OnBeforeAddJSONNode",0,t.$rtti.TTMSFNCTreeViewBeforeAddJSONNodeEvent,"FOnBeforeAddJSONNode","FOnBeforeAddJSONNode"),e.addProperty("OnAfterAddJSONNode",0,t.$rtti.TTMSFNCTreeViewAfterAddJSONNodeEvent,"FOnAfterAddJSONNode","FOnAfterAddJSONNode"),e.addProperty("DefaultViewJSONOptions",2,t.$rtti.TTMSFNCTreeViewViewJSONOptions,"FDefaultViewJSONOptions","SetDefaultViewJSONOptions"),e.addProperty("OnGetHTMLTemplateValue",0,t.$rtti.TTMSFNCTreeViewGetHTMLTemplateValueEvent,"FOnGetHTMLTemplateValue","FOnGetHTMLTemplateValue"),e.addProperty("OnGetHTMLTemplate",0,t.$rtti.TTMSFNCTreeViewGetHTMLTemplateEvent,"FOnGetHTMLTemplate","FOnGetHTMLTemplate")})),this.TTMSFNCTREEVIEWEXPAND="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAIAAAAmzuBxAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuNvyMY98AAAAySURBVChTY6iurcaPQCr+4wZYVHj5ekFZYEBdFUAJTISiAg4gEnBAIxVoAKoCH6qtBgAs4hCpNRg4EQAAAABJRU5ErkJggg==",this.TTMSFNCTREEVIEWCOLLAPSE="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAIAAAAmzuBxAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuNvyMY98AAAAmSURBVChTY6iurcaPQCr+4wYDoMLL1wsZQQRJNAMroKIKfKi2GgCBNiGJV4wrvQAAAABJRU5ErkJggg==",this.TTMSFNCTREEVIEWEXPANDLARGE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAIAAABL1vtsAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuNvyMY98AAABDSURBVDhPY6iuraYQUc+I/2QBehnh5esFRFAOBhg1AgFoYwREAzEIop42RmACZA2YYNQIBKCXEfgBtY2gBFFsRG01AN+TQqHfgmnlAAAAAElFTkSuQmCC",this.TTMSFNCTREEVIEWCOLLAPSELARGE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAIAAABL1vtsAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwgAADsIBFShKgAAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC42/Ixj3wAAADRJREFUOE9jqK6tphBRz4j/ZIFRIxBg+Bvh5euFB0EVgQEtjSAejBqBAMPTCEoQxUbUVgMAPoCGIXvOpikAAAAASUVORK5CYII=",t.$resourcestrings={sTMSFNCTreeViewFilterAll:{org:"(All)"}},t.$implcode=function(){rtl.createClass(e,"TTMSFNCTreeViewGroupOpen",pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewGroup,(function(){})),rtl.createClass(e,"TTMSFNCTreeViewNodeOpen",pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewNode,(function(){})),rtl.createClass(e,"TTMSFNCTreeViewColumnOpen",pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewColumn,(function(){})),rtl.createClass(e,"TTMSFNCTreeViewVirtualNodeOpen",pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewVirtualNode,(function(){})),e.GetTickCountX=function(){var t=0,e=0,i=0,s=0;return pas.SysUtils.DecodeTime(pas.SysUtils.Now(),{get:function(){return t},set:function(e){t=e}},{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),s+1e3*i+60*e*1e3+60*t*60*1e3},e.AnimateDouble=function(t,e,i,s){var n=!1;return n=!0,t.get()>e.get()-s&&t.get()<e.get()+s?(t.set(e.get()),n=!1):(i=Math.max(s,i),t.get()<e.get()?t.set(t.get()+i):t.set(t.get()-i)),n},e.TTMSFNCTreeViewJSONType={0:"jtValue",jtValue:0,1:"jtArraySize",jtArraySize:1,2:"jtObjectSize",jtObjectSize:2,3:"jtArrayIndex",jtArrayIndex:3}},t.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TTMSFNCTREEVIEWEXPAND),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TTMSFNCTREEVIEWEXPANDLARGE),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TTMSFNCTREEVIEWCOLLAPSE),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TTMSFNCTREEVIEWCOLLAPSELARGE)}}),["SysUtils","Math","WEBLib.TMSFNCTreeViewBase","WEBLib.TMSFNCUtils","WEBLib.TMSFNCStyles","WEBLib.Forms","WEBLib.Graphics"]),rtl.module("WEBLib.TMSFNCCustomSelector",["System","Classes","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCCustomControl","WEBLib.Controls"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=1,this.BLD_VER=0,rtl.createClass(this,"TTMSFNCCustomSelectorItem",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FOwner=null,this.FRowSpan=0,this.FColumnSpan=0,this.FVisible=!1,this.FText="",this.FEnabled=!1,this.FSeparator=!1,this.FSeparatorHeight=0,this.FMargins=null,this.FCanDeselect=!1,this.FCanSelect=!1,this.FVerticalTextAlign=0,this.FHorizontalTextAlign=0,this.FHint=""},this.$final=function(){this.FOwner=void 0,this.FMargins=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetColumnSpan=function(t){this.FColumnSpan!==t&&(this.FColumnSpan=t,this.FOwner.CalculateItems())},this.SetRowSpan=function(t){this.FRowSpan!==t&&(this.FRowSpan=t,this.FOwner.CalculateItems())},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,this.FOwner.CalculateItems())},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.FOwner.InvalidateItems())},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t,this.FOwner.InvalidateItems())},this.SetSeparator=function(t){this.FSeparator!==t&&(this.FSeparator=t,this.FOwner.CalculateItems())},this.SetSeparatorHeight=function(t){this.FSeparatorHeight!==t&&(this.FSeparatorHeight=t,this.FOwner.InvalidateItems())},this.SetMargins=function(t){this.FMargins.Assign(t)},this.SetCanDeselect=function(t){this.FCanDeselect=t},this.SetCanSelect=function(t){this.FCanSelect=t},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t,this.FOwner.InvalidateItems())},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,this.FOwner.InvalidateItems())},this.IsSeparatorHeightStored=function(){return 5!==this.FSeparatorHeight},this.MarginsChanged=function(t){this.FOwner.CalculateItems()},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FOwner=rtl.as(this.FCollection,t.TTMSFNCCustomSelectorItems).FOwner$1),this.FSeparator=!1,this.FColumnSpan=1,this.FCanDeselect=!0,this.FCanSelect=!0,this.FRowSpan=1,this.FMargins=pas["WEBLib.TMSFNCTypes"].TTMSFNCMargins.$create("Create$1"),this.FMargins.FOnChange=rtl.createCallback(this,"MarginsChanged"),this.FEnabled=!0,this.FSeparatorHeight=5,this.FVisible=!0,null!=this.FOwner&&this.FOwner.CalculateItems(),this},this.Assign=function(e){t.TTMSFNCCustomSelectorItem.isPrototypeOf(e)&&(this.FRowSpan=rtl.as(e,t.TTMSFNCCustomSelectorItem).FRowSpan,this.FColumnSpan=rtl.as(e,t.TTMSFNCCustomSelectorItem).FColumnSpan,this.FVisible=rtl.as(e,t.TTMSFNCCustomSelectorItem).FVisible,this.FText=rtl.as(e,t.TTMSFNCCustomSelectorItem).FText,this.FEnabled=rtl.as(e,t.TTMSFNCCustomSelectorItem).FEnabled,this.FSeparator=rtl.as(e,t.TTMSFNCCustomSelectorItem).FSeparator,this.FSeparatorHeight=rtl.as(e,t.TTMSFNCCustomSelectorItem).FSeparatorHeight,this.FMargins.Assign(rtl.as(e,t.TTMSFNCCustomSelectorItem).FMargins),this.FCanDeselect=rtl.as(e,t.TTMSFNCCustomSelectorItem).FCanDeselect,this.FCanSelect=rtl.as(e,t.TTMSFNCCustomSelectorItem).FCanSelect,this.FHint=rtl.as(e,t.TTMSFNCCustomSelectorItem).FHint)},this.Destroy=function(){rtl.free(this,"FMargins"),pas.Classes.TCollectionItem.Destroy.call(this),null!=this.FOwner&&this.FOwner.CalculateItems()};var e=this.$rtti;e.addProperty("CanSelect",2,rtl.boolean,"FCanSelect","SetCanSelect",{Default:!0}),e.addProperty("CanDeselect",2,rtl.boolean,"FCanDeselect","SetCanDeselect",{Default:!0}),e.addProperty("ColumnSpan",2,rtl.longint,"FColumnSpan","SetColumnSpan",{Default:1}),e.addProperty("RowSpan",2,rtl.longint,"FRowSpan","SetRowSpan",{Default:1}),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Separator",2,rtl.boolean,"FSeparator","SetSeparator",{Default:!1}),e.addProperty("SeparatorHeight",14,rtl.double,"FSeparatorHeight","SetSeparatorHeight",{stored:"IsSeparatorHeightStored"}),e.addProperty("Margins",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCMargins,"FMargins","SetMargins"),e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("Hint",0,rtl.string,"FHint","FHint")})),rtl.createClass(this,"TTMSFNCCustomSelectorItems",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FOwner$1=null},this.$final=function(){this.FOwner$1=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.CreateItemClass=function(){return t.TTMSFNCCustomSelectorItem},this.GetOwner=function(){return this.FOwner$1},this.Create$3=function(t){return pas.Classes.TOwnedCollection.Create$2.call(this,t,this.CreateItemClass()),this.FOwner$1=t,this}})),rtl.createClass(this,"TTMSFNCCustomSelectorAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FStrokeHover=null,this.FFillDown=null,this.FVerticalSpacing=0,this.FStrokeDown=null,this.FFillSelected=null,this.FHorizontalSpacing=0,this.FStrokeSelected=null,this.FFill=null,this.FFillHover=null,this.FStroke=null,this.FFillDisabled=null,this.FStrokeDisabled=null,this.FSeparatorStroke=null,this.FFont=null},this.$final=function(){this.FOwner=void 0,this.FStrokeHover=void 0,this.FFillDown=void 0,this.FStrokeDown=void 0,this.FFillSelected=void 0,this.FStrokeSelected=void 0,this.FFill=void 0,this.FFillHover=void 0,this.FStroke=void 0,this.FFillDisabled=void 0,this.FStrokeDisabled=void 0,this.FSeparatorStroke=void 0,this.FFont=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetFillDown=function(t){this.FFillDown.Assign(t)},this.SetFillHover=function(t){this.FFillHover.Assign(t)},this.SetFillSelected=function(t){this.FFillSelected.Assign(t)},this.SetHorizontalSpacing=function(t){this.FHorizontalSpacing!==t&&(this.FHorizontalSpacing=t,this.Changed())},this.SetStroke=function(t){this.FStroke.Assign(t)},this.SetStrokeDown=function(t){this.FStrokeDown.Assign(t)},this.SetStrokeHover=function(t){this.FStrokeHover.Assign(t)},this.SetStrokeSelected=function(t){this.FStrokeSelected.Assign(t)},this.SetVerticalSpacing=function(t){this.FVerticalSpacing!==t&&(this.FVerticalSpacing=t,this.Changed())},this.SetFillDisabled=function(t){this.FFillDisabled.Assign(t)},this.SetStrokeDisabled=function(t){this.FStrokeDisabled.Assign(t)},this.SetSeparatorStroke=function(t){this.FSeparatorStroke.Assign(t)},this.SetFont=function(t){this.FFont.AssignSource(t)},this.IsHorizontalSpacingStored=function(){return 4!==this.FHorizontalSpacing},this.IsVerticalSpacingStored=function(){return 4!==this.FVerticalSpacing},this.Changed=function(){this.FOwner.CalculateItems()},this.FontChanged=function(t){this.FOwner.InvalidateItems()},this.FillChanged=function(t){this.FOwner.InvalidateItems()},this.StrokeChanged=function(t){this.FOwner.InvalidateItems()},this.Create$1=function(t){return this.FOwner=t,this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(13882323,50)),this.FFillHover=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFillHover.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(10061943,50)),this.FFillDown=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFillDown.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(9470064,50)),this.FFillSelected=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFillSelected.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(9470064,50)),this.FFillDisabled=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFillDisabled.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(8421504,50)),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStroke.SetColor(11119017),this.FStrokeHover=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStrokeHover.SetColor(10061943),this.FStrokeDown=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStrokeDown.SetColor(9470064),this.FStrokeSelected=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStrokeSelected.SetColor(5197615),this.FStrokeDisabled=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStrokeDisabled.SetColor(11119017),this.FSeparatorStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FSeparatorStroke.SetColor(11119017),this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FSeparatorStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FFillDown.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FFillHover.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FFillSelected.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FFillDisabled.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FStrokeHover.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FStrokeDown.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FStrokeDisabled.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FStrokeSelected.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FHorizontalSpacing=4,this.FVerticalSpacing=4,this},this.Assign=function(e){t.TTMSFNCCustomSelectorAppearance.isPrototypeOf(e)&&(this.FFill.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FFill),this.FFillHover.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FFillHover),this.FFillSelected.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FFillSelected),this.FFillDisabled.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FFillDisabled),this.FFillDown.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FFillDown),this.FStroke.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FStroke),this.FStrokeHover.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FStrokeHover),this.FStrokeSelected.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FStrokeSelected),this.FStrokeDown.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FStrokeDown),this.FStrokeDisabled.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FStrokeDisabled),this.FVerticalSpacing=rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FVerticalSpacing,this.FHorizontalSpacing=rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FHorizontalSpacing,this.FSeparatorStroke.Assign(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FSeparatorStroke),this.FFont.AssignSource(rtl.as(e,t.TTMSFNCCustomSelectorAppearance).FFont))},this.Destroy=function(){rtl.free(this,"FFont"),rtl.free(this,"FFill"),rtl.free(this,"FFillDown"),rtl.free(this,"FFillSelected"),rtl.free(this,"FFillHover"),rtl.free(this,"FFillDisabled"),rtl.free(this,"FSeparatorStroke"),rtl.free(this,"FStroke"),rtl.free(this,"FStrokeDown"),rtl.free(this,"FStrokeSelected"),rtl.free(this,"FStrokeHover"),rtl.free(this,"FStrokeDisabled"),pas.System.TObject.Destroy.call(this)};var e=this.$rtti;e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("StrokeHover",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStrokeHover","SetStrokeHover"),e.addProperty("FillHover",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFillHover","SetFillHover"),e.addProperty("StrokeDown",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStrokeDown","SetStrokeDown"),e.addProperty("FillDown",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFillDown","SetFillDown"),e.addProperty("StrokeSelected",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStrokeSelected","SetStrokeSelected"),e.addProperty("FillSelected",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFillSelected","SetFillSelected"),e.addProperty("StrokeDisabled",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStrokeDisabled","SetStrokeDisabled"),e.addProperty("FillDisabled",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFillDisabled","SetFillDisabled"),e.addProperty("VerticalSpacing",14,rtl.double,"FVerticalSpacing","SetVerticalSpacing",{stored:"IsVerticalSpacingStored"}),e.addProperty("HorizontalSpacing",14,rtl.double,"FHorizontalSpacing","SetHorizontalSpacing",{stored:"IsHorizontalSpacingStored"}),e.addProperty("SeparatorStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FSeparatorStroke","SetSeparatorStroke"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont")})),rtl.recNewT(this,"TTMSFNCCustomSelectorPositionItem",(function(){this.TileSet=!1,this.$eq=function(t){return this.TileSet===t.TileSet},this.$assign=function(t){return this.TileSet=t.TileSet,this}})),rtl.recNewT(this,"TTMSFNCCustomSelectorDisplayItem",(function(){this.Item=null,this.PageIndex=0,this.Column=0,this.Row=0,this.ColumnSpan=0,this.RowSpan=0,this.$new=function(){var t=Object.create(this);return t.Rect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),t},this.$eq=function(t){return this.Rect.$eq(t.Rect)&&this.Item===t.Item&&this.PageIndex===t.PageIndex&&this.Column===t.Column&&this.Row===t.Row&&this.ColumnSpan===t.ColumnSpan&&this.RowSpan===t.RowSpan},this.$assign=function(t){return this.Rect.$assign(t.Rect),this.Item=t.Item,this.PageIndex=t.PageIndex,this.Column=t.Column,this.Row=t.Row,this.ColumnSpan=t.ColumnSpan,this.RowSpan=t.RowSpan,this}})),rtl.createClass(this,"TTMSFNCCustomSelectorDisplayList",pas.Classes.TList,(function(){this.GetItem=function(e){var i=t.TTMSFNCCustomSelectorDisplayItem.$new();return i.$assign(rtl.getObject(this.Get(e))),i}})),rtl.createClass(this,"TTMSFNCCustomSelector",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FDisplayList=null,this.FUpdateCount$1=0,this.FItems=null,this.FRows=0,this.FColumns=0,this.FPageCount=0,this.FAppearance=null,this.FSelectedItemIndex=0,this.FFocusedItemIndex=0,this.FHoveredItemIndex=0,this.FDownItemIndex=0,this.FOnItemBeforeDrawText=null,this.FOnAfterDraw$1=null,this.FOnItemAfterDrawBackground=null,this.FOnItemSelected=null,this.FOnItemAfterDrawText=null,this.FOnBeforeDraw$1=null,this.FOnItemBeforeDrawBackground=null,this.FOnItemDeselected=null,this.FOnItemClick=null,this.FOnItemBeforeDrawContent=null,this.FOnItemAfterDrawContent=null},this.$final=function(){this.FDisplayList=void 0,this.FItems=void 0,this.FAppearance=void 0,this.FOnItemBeforeDrawText=void 0,this.FOnAfterDraw$1=void 0,this.FOnItemAfterDrawBackground=void 0,this.FOnItemSelected=void 0,this.FOnItemAfterDrawText=void 0,this.FOnBeforeDraw$1=void 0,this.FOnItemBeforeDrawBackground=void 0,this.FOnItemDeselected=void 0,this.FOnItemClick=void 0,this.FOnItemBeforeDrawContent=void 0,this.FOnItemAfterDrawContent=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCCustomSelector)},this.GetDisplayItem=function(e){var i=t.TTMSFNCCustomSelectorDisplayItem.$new(),s=0,n=null;i.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),i.Item=null,i.PageIndex=-1,i.Row=-1,i.Column=-1,i.ColumnSpan=-1,i.RowSpan=-1;for(var o=0,r=this.FDisplayList.GetCount()-1;o<=r;o++)if(s=o,null!=(n=this.FDisplayList.GetItem(s).Item)&&n.GetIndex()===e){i.$assign(this.FDisplayList.GetItem(s));break}return i},this.GetNextSelectableItem=function(){var t=0,e=0,i=null;t=this.FFocusedItemIndex;for(var s=0,n=this.FDisplayList.GetCount()-1;s<=n;s++)if(e=s,null!=(i=this.FDisplayList.GetItem(e).Item)&&i.FEnabled&&!i.FSeparator&&i.GetIndex()>this.FFocusedItemIndex){t=i.GetIndex();break}return t},this.GetPreviousSelectableItem=function(){var t=0,e=0,i=null;t=this.FFocusedItemIndex;for(var s=this.FDisplayList.GetCount()-1;s>=0;s--)if(e=s,null!=(i=this.FDisplayList.GetItem(e).Item)&&i.FEnabled&&!i.FSeparator&&i.GetIndex()<this.FFocusedItemIndex){t=i.GetIndex();break}return t},this.GetNextSelectableRowItem=function(){var e=0,i=0,s=null,n=t.TTMSFNCCustomSelectorDisplayItem.$new();if(-1===(e=this.FFocusedItemIndex))return e=this.GetNextSelectableItem();n.$assign(this.GetDisplayItem(this.FFocusedItemIndex));for(var o=0,r=this.FDisplayList.GetCount()-1;o<=r;o++)if(i=o,null!=(s=this.FDisplayList.GetItem(i).Item)&&s.FEnabled&&!s.FSeparator&&s.GetIndex()>this.FFocusedItemIndex&&n.Column>=this.FDisplayList.GetItem(i).Column&&n.Column<=this.FDisplayList.GetItem(i).Column+(this.FDisplayList.GetItem(i).ColumnSpan-1)&&this.FDisplayList.GetItem(i).Row>n.Row){e=s.GetIndex();break}return e},this.GetPreviousSelectableRowItem=function(){var e=0,i=0,s=null,n=t.TTMSFNCCustomSelectorDisplayItem.$new();if(-1===(e=this.FFocusedItemIndex))return e=this.GetPreviousSelectableItem();n.$assign(this.GetDisplayItem(this.FFocusedItemIndex));for(var o=this.FDisplayList.GetCount()-1;o>=0;o--)if(i=o,null!=(s=this.FDisplayList.GetItem(i).Item)&&s.FEnabled&&!s.FSeparator&&s.GetIndex()<this.FFocusedItemIndex&&n.Column>=this.FDisplayList.GetItem(i).Column&&n.Column<=this.FDisplayList.GetItem(i).Column+(this.FDisplayList.GetItem(i).ColumnSpan-1)&&this.FDisplayList.GetItem(i).Row<n.Row){e=s.GetIndex();break}return e},this.GetFirstSelectableItem=function(){var t=0,e=0,i=null;t=this.FFocusedItemIndex;for(var s=0,n=this.FDisplayList.GetCount()-1;s<=n;s++)if(e=s,null!=(i=this.FDisplayList.GetItem(e).Item)&&i.FEnabled&&!i.FSeparator){t=i.GetIndex();break}return t},this.GetLastSelectableItem=function(){var t=0,e=0,i=null;t=this.FFocusedItemIndex;for(var s=this.FDisplayList.GetCount()-1;s>=0;s--)if(e=s,null!=(i=this.FDisplayList.GetItem(e).Item)&&i.FEnabled&&!i.FSeparator){t=i.GetIndex();break}return t},this.CreateItemsCollection=function(){return t.TTMSFNCCustomSelectorItems.$create("Create$3",[this])},this.CalculateItems=function(){var e,i,s,n,o,r,a,l=this,h=[],F=0,p=0,c=0,u=0,T=0,C=null,S=0,d=0,m=0,f=0,g=0,y=!1,b=0,N=0,M=0,B=0,E=0,L=0,D=0,A=0,$=t.TTMSFNCCustomSelectorDisplayItem.$new();function I(t,e,i,s,n,o,r,a,h){var F=0,p=0,c=0,u=0,T=0,C=0;s.set(!1);for(var S=e.get(),d=n-1;S<=d;S++){F=S;for(var m=i.get(),f=r-1;m<=f;m++){p=m,c=t.FColumnSpan,c=Math.min(c,l.FColumns-i.get()),u=t.FRowSpan,u=Math.min(u,l.FRows-e.get()),s.set(!0);for(var g=0,y=u-1;g<=y;g++){T=g;for(var b=0,N=c-1;b<=N;b++)C=b,h[F+T][p+C].TileSet&&s.set(!1)}if(s.get())break;i.set(i.get()+1)}if(s.get())break;i.set(0),e.set(e.get()+1)}}if(!(3 in this.FComponentState||this.FUpdateCount$1>0)&&(this.FDisplayList.Clear(),0!==this.FItems.GetCount())){for(r=this.GetCalculationWidth(),a=this.GetCalculationHeight(),i=this.FAppearance.FHorizontalSpacing,N=n=r-(s=this.FAppearance.FVerticalSpacing),this.FColumns>0&&(N=(n-this.FColumns*i)/this.FColumns),o=a-s-this.GetTotalSeparatorHeight(),e=this.GetTotalSeparatorCount(),M=o,this.FRows-e>0&&(M=(o-(this.FRows-e)*s)/(this.FRows-e)),T=0,b=0,A=0;T<=this.FItems.GetCount()-1;){for(c=0,F=0,h=rtl.arraySetLength(h,t.TTMSFNCCustomSelectorPositionItem,0,0),h=rtl.arraySetLength(h,t.TTMSFNCCustomSelectorPositionItem,this.FRows,this.FColumns);F<this.FRows;){for(;c<this.FColumns;){if(T>=0&&T<=this.FItems.GetCount()-1&&0===b){if(!(C=this.FItems.GetItem$1(T)).FVisible){T+=1;continue}C.FSeparator?(S=this.FColumns,d=1):(S=C.FColumnSpan,d=C.FRowSpan),S=Math.min(S,this.FColumns-c),d=Math.min(d,this.FRows-F),B=N*S+i*(S-1),E=C.FSeparator?C.FSeparatorHeight:M*d+s*(d-1),L=r*b+i+N*c+i*c,D=A+s+M*F+s*F+this.GetTopOffset(),$.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(L+C.FMargins.FLeft,D+C.FMargins.FTop,L+B-C.FMargins.FRight,D+E-C.FMargins.FBottom)),$.Item=C,$.PageIndex=b,$.Column=c,$.Row=F,$.ColumnSpan=S,$.RowSpan=d,this.FDisplayList.Add(t.TTMSFNCCustomSelectorDisplayItem.$clone($)),m=(m=c)+S-1;for(var P=F,v=F+d-1;P<=v;P++){f=P;for(var G=c,w=m;G<=w;G++)g=G,h[f][g].TileSet=!0}C.FSeparator&&(A=A+C.FSeparatorHeight-M*d+s*(d-1))}if(u=c+=1,p=F,y=!1,(T+=1)>=0&&T<=this.FItems.GetCount()-1&&I(this.FItems.GetItem$1(T),{get:function(){return p},set:function(t){p=t}},{get:function(){return u},set:function(t){u=t}},{get:function(){return y},set:function(t){y=t}},this.FRows,0,this.FColumns,0,rtl.arrayRef(h)),F=p,(c=u)>=this.FColumns||F>=this.FRows)break}if(u=c=0,p=F+=1,y=!1,T>=0&&T<=this.FItems.GetCount()-1&&I(this.FItems.GetItem$1(T),{get:function(){return p},set:function(t){p=t}},{get:function(){return u},set:function(t){u=t}},{get:function(){return y},set:function(t){y=t}},this.FRows,0,this.FColumns,0,rtl.arrayRef(h)),c=u,(F=p)>=this.FRows)break}b+=1}this.FPageCount=b,this.InvalidateItems()}},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&this.FFill.SetColor(t),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundStrokeColor({get:function(){return t},set:function(e){t=e}})&&this.FStroke.SetColor(t),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleDefaultButtonFillColor({get:function(){return t},set:function(e){t=e}})&&this.FAppearance.FFill.SetColor(t),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleSelectionFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FFillSelected.SetColor(t),this.FAppearance.FFillDown.SetColor(t),this.FAppearance.FFillHover.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(t,this.FAppearance.FFill.FColor,25))),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleDefaultButtonStrokeColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FStroke.SetColor(t),this.FAppearance.FStrokeSelected.SetColor(t),this.FAppearance.FStrokeDown.SetColor(t),this.FAppearance.FStrokeHover.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&this.FAppearance.FFont.SetColor(t)},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FFill.SetKind(1),this.FStroke.SetKind(1),this.FFill.SetColor(16777215),this.FStroke.SetColor(12632256),this.FAppearance.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(13882323,50)),this.FAppearance.FFillHover.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(10061943,50)),this.FAppearance.FFillDown.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(9470064,50)),this.FAppearance.FFillSelected.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(9470064,50)),this.FAppearance.FFillDisabled.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(8421504,50)),this.FAppearance.FStroke.SetColor(11119017),this.FAppearance.FStrokeHover.SetColor(10061943),this.FAppearance.FStrokeDown.SetColor(9470064),this.FAppearance.FStrokeSelected.SetColor(5197615),this.FAppearance.FStrokeDisabled.SetColor(11119017),this.FAppearance.FFont.SetColor(0),this.FAppearance.FFill.SetKind(1),this.FAppearance.FFillHover.SetKind(1),this.FAppearance.FFillDown.SetKind(1),this.FAppearance.FFillSelected.SetKind(1),this.FAppearance.FFillDisabled.SetKind(1),this.FAppearance.FStroke.SetKind(1),this.FAppearance.FStrokeHover.SetKind(1),this.FAppearance.FStrokeDown.SetKind(1),this.FAppearance.FStrokeSelected.SetKind(1),this.FAppearance.FStrokeDisabled.SetKind(1),this.FAppearance.FSeparatorStroke.SetKind(1)},this.GetTopOffset=function(){return 0,0},this.GetCalculationWidth=function(){return this.GetWidth()},this.GetCalculationHeight=function(){return this.GetHeight()-this.GetTopOffset()},this.GetTotalSeparatorHeight=function(){var t=0,e=0;t=0;for(var i=0,s=this.FItems.GetCount()-1;i<=s;i++)e=i,this.FItems.GetItem$1(e).FSeparator&&(t=t+this.FItems.GetItem$1(e).FSeparatorHeight+this.FAppearance.FVerticalSpacing);return t},this.GetTotalSeparatorCount=function(){var t=0,e=0;t=0;for(var i=0,s=this.FItems.GetCount()-1;i<=s;i++)e=i,this.FItems.GetItem$1(e).FSeparator&&(t+=1);return t},this.DoItemSelected=function(t){null!=this.FOnItemSelected&&this.FOnItemSelected(this,t)},this.DoItemClick=function(t){null!=this.FOnItemClick&&this.FOnItemClick(this,t)},this.DoItemDeselected=function(t){null!=this.FOnItemDeselected&&this.FOnItemDeselected(this,t)},this.DoItemBeforeDrawBackground=function(t,e,i,s){null!=this.FOnItemBeforeDrawBackground&&this.FOnItemBeforeDrawBackground(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoItemAfterDrawBackground=function(t,e,i){null!=this.FOnItemAfterDrawBackground&&this.FOnItemAfterDrawBackground(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoItemBeforeDrawContent=function(t,e,i,s){null!=this.FOnItemBeforeDrawContent&&this.FOnItemBeforeDrawContent(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoItemAfterDrawContent=function(t,e,i){null!=this.FOnItemAfterDrawContent&&this.FOnItemAfterDrawContent(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoItemBeforeDrawText=function(t,e,i,s,n){null!=this.FOnItemBeforeDrawText&&this.FOnItemBeforeDrawText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoItemAfterDrawText=function(t,e,i,s){null!=this.FOnItemAfterDrawText&&this.FOnItemAfterDrawText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoBeforeDraw$1=function(t,e,i){null!=this.FOnBeforeDraw$1&&this.FOnBeforeDraw$1(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoAfterDraw$1=function(t,e){null!=this.FOnAfterDraw$1&&this.FOnAfterDraw$1(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},this.DrawItems=function(e){for(var i=0,s=0,n=this.FDisplayList.GetCount()-1;s<=n;s++)i=s,this.DrawItem(e,t.TTMSFNCCustomSelectorDisplayItem.$clone(this.FDisplayList.GetItem(i)))},this.Draw=function(t,e){var i=!1;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),i=!0,this.DoBeforeDraw$1(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),{get:function(){return i},set:function(t){i=t}}),i&&(this.DrawItems(t),this.DoAfterDraw$1(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)))},this.DrawItem=function(e,i){this.DrawItemBackGround(e,t.TTMSFNCCustomSelectorDisplayItem.$clone(i)),this.DrawItemContent(e,t.TTMSFNCCustomSelectorDisplayItem.$clone(i)),this.DrawItemText(e,t.TTMSFNCCustomSelectorDisplayItem.$clone(i))},this.DrawItemBackGround=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=null,n=!1,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();null!=(s=e.Item)&&(s.FSeparator?t.FStroke.Assign(this.FAppearance.FSeparatorStroke):(t.FFill.Assign(this.FAppearance.FFill),t.FStroke.Assign(this.FAppearance.FStroke),s.FEnabled?s.GetIndex()===this.FDownItemIndex?(t.FFill.Assign(this.FAppearance.FFillDown),t.FStroke.Assign(this.FAppearance.FStrokeDown)):s.GetIndex()===this.FHoveredItemIndex?(t.FFill.Assign(this.FAppearance.FFillHover),t.FStroke.Assign(this.FAppearance.FStrokeHover)):s.GetIndex()===this.FSelectedItemIndex&&(t.FFill.Assign(this.FAppearance.FFillSelected),t.FStroke.Assign(this.FAppearance.FStrokeSelected)):(t.FFill.Assign(this.FAppearance.FFillDisabled),t.FStroke.Assign(this.FAppearance.FStrokeDisabled))),i.$assign(e.Rect),n=!0,this.DoItemBeforeDrawBackground(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e.Rect),s.GetIndex(),{get:function(){return n},set:function(t){n=t}}),n&&(s.FSeparator?t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,pas["WEBLib.TMSFNCTypes"].CenterPointEx(i).Y)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Right,pas["WEBLib.TMSFNCTypes"].CenterPointEx(i).Y)),2,2):(t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),2),this.IsFocused()&&this.FFocusedItemIndex===s.GetIndex()&&(o.$assign(i),pas["WEBLib.TMSFNCTypes"].InflateRectEx(o,this.ScalePaintValue(-2),this.ScalePaintValue(-2)),t.DrawFocusRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),0,2))),this.DoItemAfterDrawBackground(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e.Rect),s.GetIndex())))},this.DrawItemContent=function(t,e){var i=null,s=!1;null!=(i=e.Item)&&(s=!0,this.DoItemBeforeDrawContent(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e.Rect),i.GetIndex(),{get:function(){return s},set:function(t){s=t}}),s&&this.DoItemAfterDrawContent(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e.Rect),i.GetIndex()))},this.DrawItemText=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=null,n="",o=!1;null!=(s=e.Item)&&""!==s.FText&&(i.$assign(e.Rect),n=s.FText,o=!0,pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-2,-2),t.FFont.AssignSource(this.FAppearance.FFont),this.DoItemBeforeDrawText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e.Rect),s.GetIndex(),{get:function(){return n},set:function(t){n=t}},{get:function(){return o},set:function(t){o=t}}),o&&(t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),n,!1,s.FHorizontalTextAlign,s.FVerticalTextAlign,0,0,-1,-1,!0,!1,-1,-1),this.DoItemAfterDrawText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e.Rect),s.GetIndex(),n)))},this.HandleMouseDown=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.CaptureEx(),this.FDownItemIndex=this.XYToItem(i,s),this.InvalidateItems()},this.HandleMouseUp=function(t,e,i,s){var n=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),this.ReleaseCaptureEx(),(n=this.XYToItem(i,s))===this.FDownItemIndex&&-1!==this.FDownItemIndex&&(this.ProcessSelection(n),-1!==n&&this.DoItemClick(n)),this.FDownItemIndex=-1,this.FHoveredItemIndex=-1,this.InvalidateItems()},this.HandleMouseMove=function(t,e,i){var s=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),this.FDownItemIndex>-1||(s=this.XYToItem(e,i))!==this.FHoveredItemIndex&&(this.FHoveredItemIndex=s,this.CancelHint(),this.InvalidateItems())},this.HandleKeyDown=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyDown.apply(this,arguments);var i=t.get();38===i?(this.FFocusedItemIndex=this.GetPreviousSelectableRowItem(),this.InvalidateItems()):37===i?(this.FFocusedItemIndex=this.GetPreviousSelectableItem(),this.InvalidateItems()):40===i?(this.FFocusedItemIndex=this.GetNextSelectableRowItem(),this.InvalidateItems()):39===i?(this.FFocusedItemIndex=this.GetNextSelectableItem(),this.InvalidateItems()):36===i?(this.FFocusedItemIndex=this.GetFirstSelectableItem(),this.InvalidateItems()):35===i&&(this.FFocusedItemIndex=this.GetLastSelectableItem(),this.InvalidateItems()),13===t.get()&&(this.FDownItemIndex=this.FFocusedItemIndex,this.InvalidateItems())},this.HandleKeyUp=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyUp.apply(this,arguments),13===t.get()&&(this.FDownItemIndex=-1,this.ProcessSelection(this.FFocusedItemIndex),this.InvalidateItems())},this.HandleMouseLeave=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),this.FHoveredItemIndex=-1,this.InvalidateItems()},this.ProcessSelection=function(t){var e=null,i=0;t>=0&&t<=this.FItems.GetCount()-1&&(e=this.FItems.GetItem$1(t)).FCanSelect&&(i=this.FSelectedItemIndex,e.FCanDeselect&&e.GetIndex()===this.FSelectedItemIndex?this.FSelectedItemIndex=-1:this.FSelectedItemIndex=e.GetIndex(),-1!==this.FSelectedItemIndex&&(this.FFocusedItemIndex=this.FSelectedItemIndex),e.FCanDeselect&&-1!==i&&this.DoItemDeselected(i),-1!==this.FSelectedItemIndex&&this.DoItemSelected(this.FSelectedItemIndex))},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FColumns=4,this.FRows=4,this.FItems=this.CreateItemsCollection(),this.FDisplayList=t.TTMSFNCCustomSelectorDisplayList.$create("Create$1"),this.FAppearance=t.TTMSFNCCustomSelectorAppearance.$create("Create$1",[this]),this.FSelectedItemIndex=-1,this.FFocusedItemIndex=-1,this.FHoveredItemIndex=-1,this.FDownItemIndex=-1,this.IsDesignTime()&&this.InitializeDefault(),this},this.Destroy=function(){rtl.free(this,"FAppearance"),rtl.free(this,"FDisplayList"),rtl.free(this,"FItems"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Assign=function(e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments),t.TTMSFNCCustomSelector.isPrototypeOf(e)&&(this.FItems.Assign(rtl.as(e,t.TTMSFNCCustomSelector).FItems),this.FAppearance.Assign(rtl.as(e,t.TTMSFNCCustomSelector).FAppearance),this.FRows=rtl.as(e,t.TTMSFNCCustomSelector).FRows,this.FColumns=rtl.as(e,t.TTMSFNCCustomSelector).FColumns)},this.BeginUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.BeginUpdate.call(this),this.FUpdateCount$1+=1},this.EndUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.EndUpdate.call(this),this.FUpdateCount$1-=1,0===this.FUpdateCount$1&&this.CalculateItems()},this.InvalidateItems=function(){this.Invalidate()},this.UpdateControlAfterResize=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.UpdateControlAfterResize.call(this),this.CalculateItems()},this.InitializeDefault=function(){},this.XYToItem=function(t,e){var i=0,s=0,n=null;i=-1;for(var o=0,r=this.FDisplayList.GetCount()-1;o<=r;o++)if(s=o,pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.FDisplayList.GetItem(s).Rect,pas["WEBLib.TMSFNCTypes"].PointF(t,e))&&null!=(n=this.FDisplayList.GetItem(s).Item)&&n.FEnabled&&!n.FSeparator){i=n.GetIndex();break}return i},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),t.$init=function(){pas.Classes.RegisterClass(t.TTMSFNCCustomSelector)}}),["Math","SysUtils","WEBLib.TMSFNCUtils","WEBLib.TMSFNCStyles"]),rtl.module("WEBLib.TMSFNCCustomPicker",["System","Classes","WEBLib.TMSFNCCustomSelector","WEBLib.TMSFNCPersistence","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCPopup","WEBLib.TMSFNCTypes","WEBLib.Controls","WEBLib.StdCtrls","WEBLib.ExtCtrls"],(function(){"use strict";var t=this.$impl;rtl.createClass(this,"TTMSFNCCustomPicker",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FExitTimerClose=!1,this.FDefaultStyle=!1,this.FKeyDown=0,this.FContent="",this.FEdit=null,this.FTimer=null,this.FExitTimer=null,this.FDown=!1,this.FPopup=null,this.FSelector=null,this.FOnItemBeforeDrawText=null,this.FOnAfterDraw$1=null,this.FOnItemAfterDrawBackground=null,this.FOnItemSelected=null,this.FOnItemAfterDrawText=null,this.FOnBeforeDraw$1=null,this.FOnItemBeforeDrawBackground=null,this.FDropDownHeight=0,this.FDropDownWidth=0,this.FOnItemDeselected=null,this.FOnItemClick=null,this.FOnItemBeforeDrawContent=null,this.FOnItemAfterDrawContent=null,this.FOnPickerBeforeDraw=null,this.FOnPickerAfterDraw=null,this.FShowFocus$1=!1,this.FOnClosePopup=null,this.FOnPopup=null,this.FOnEditChange=null,this.FEditable=!1,this.FUpdateCount$1=0,this.FFont$1=null,this.FPreventDropDown=!1},this.$final=function(){this.FEdit=void 0,this.FTimer=void 0,this.FExitTimer=void 0,this.FPopup=void 0,this.FSelector=void 0,this.FOnItemBeforeDrawText=void 0,this.FOnAfterDraw$1=void 0,this.FOnItemAfterDrawBackground=void 0,this.FOnItemSelected=void 0,this.FOnItemAfterDrawText=void 0,this.FOnBeforeDraw$1=void 0,this.FOnItemBeforeDrawBackground=void 0,this.FOnItemDeselected=void 0,this.FOnItemClick=void 0,this.FOnItemBeforeDrawContent=void 0,this.FOnItemAfterDrawContent=void 0,this.FOnPickerBeforeDraw=void 0,this.FOnPickerAfterDraw=void 0,this.FOnClosePopup=void 0,this.FOnPopup=void 0,this.FOnEditChange=void 0,this.FFont$1=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.CalcSize=function(){},this.GetAppearance=function(){return this.FSelector.FAppearance},this.SetAppearance=function(t){this.FSelector.FAppearance.Assign(t)},this.GetFill=function(){return this.FSelector.FFill},this.GetStroke=function(){return this.FSelector.FStroke},this.SetFill$1=function(t){this.FSelector.FFill.Assign(t)},this.SetStroke$1=function(t){this.FSelector.FStroke.Assign(t)},this.SetDropDownHeight=function(t){this.FDropDownHeight=t,null!=this.FPopup&&this.FPopup.SetDropDownHeight(this.FDropDownHeight)},this.SetDropDownWidth=function(t){this.FDropDownWidth=t,null!=this.FPopup&&this.FPopup.SetDropDownWidth(this.FDropDownWidth)},this.IsDropDownWidthStored=function(){return 135!==this.FDropDownWidth},this.GetPopup=function(){return this.FPopup},this.SetShowFocus$1=function(t){this.FShowFocus$1!==t&&(this.FShowFocus$1=t,this.Invalidate())},this.SetContent=function(t){this.FContent=t,this.UpdateEditText(t)},this.SetDefaultStyle=function(t){this.FDefaultStyle!==t&&(this.FDefaultStyle=t,this.Invalidate())},this.SetFnt=function(t){this.FFont$1.Assign(t)},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,0,4)},this.GetContent=function(){return null!=this.FEdit&&null!=this.FEdit.FParent&&this.FEditable?this.FEdit.GetText():this.FContent},this.SetEditable=function(t){this.FEditable!==t&&(this.FEditable=t,null!=this.FEdit&&(this.FEditable?this.FEdit.SetParent(this):this.FEdit.SetParent(null),this.FEdit.SetVisible(this.FEditable),this.UpdateEditText(this.GetContent()),this.FPopup.FStaysOpen=this.FEditable),this.Invalidate())},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&this.GetFill().SetColor(t),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleLineFillColor({get:function(){return t},set:function(e){t=e}})&&this.GetStroke().SetColor(t),this.Invalidate()},this.SetAdaptToStyle=function(t){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetAdaptToStyle.apply(this,arguments),null!=this.FPopup&&this.FPopup.SetAdaptToStyle(this.GetAdaptToStyle())},this.DoExit=function(){pas["WEBLib.Controls"].TControl.DoExit.call(this),this.Invalidate()},this.DoEnter=function(){pas["WEBLib.Controls"].TControl.DoEnter.call(this),this.FTimer.SetEnabled(!0),this.Invalidate()},this.DoEditExit=function(t){this.FExitTimer.SetEnabled(!0)},this.UpdateEditText=function(t){null!=this.FEdit&&null!=this.FEdit.FParent&&this.FEditable&&this.FEdit.SetText(t)},this.DoItemSelected=function(t,e){this.UpdateEditText(""),null!=this.FOnItemSelected&&this.FOnItemSelected(this,e)},this.DoItemDeselected=function(t,e){null!=this.FOnItemDeselected&&this.FOnItemDeselected(this,e)},this.DoItemClick=function(t,e){null!=this.FOnItemClick&&this.FOnItemClick(this,e)},this.DoItemBeforeDrawBackground=function(t,e,i,s,n){null!=this.FOnItemBeforeDrawBackground&&this.FOnItemBeforeDrawBackground(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,n)},this.DoItemAfterDrawBackground=function(t,e,i,s){null!=this.FOnItemAfterDrawBackground&&this.FOnItemAfterDrawBackground(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s)},this.DoItemBeforeDrawContent=function(t,e,i,s,n){null!=this.FOnItemBeforeDrawContent&&this.FOnItemBeforeDrawContent(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,n)},this.DoItemAfterDrawContent=function(t,e,i,s){null!=this.FOnItemAfterDrawContent&&this.FOnItemAfterDrawContent(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s)},this.DoItemBeforeDrawText=function(t,e,i,s,n,o){null!=this.FOnItemBeforeDrawText&&this.FOnItemBeforeDrawText(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,n,o)},this.DoItemAfterDrawText=function(t,e,i,s,n){null!=this.FOnItemAfterDrawText&&this.FOnItemAfterDrawText(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,n)},this.DoBeforeDraw$1=function(t,e,i,s){null!=this.FOnBeforeDraw$1&&this.FOnBeforeDraw$1(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s)},this.DoAfterDraw$1=function(t,e,i){null!=this.FOnAfterDraw$1&&this.FOnAfterDraw$1(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))},this.DoPickerBeforeDraw=function(t,e,i){null!=this.FOnPickerBeforeDraw&&this.FOnPickerBeforeDraw(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoPickerAfterDraw=function(t,e){null!=this.FOnPickerAfterDraw&&this.FOnPickerAfterDraw(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},this.Draw=function(t,e){var i=!1,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),i=!0,this.DoPickerBeforeDraw(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),{get:function(){return i},set:function(t){i=t}}),i&&(this.DrawBackground(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),s.$assign(e),s.Right=s.Right-this.ScalePaintValue(15),this.DrawContent(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s)),this.FShowFocus$1&&this.IsFocused()&&(n.$assign(e),pas["WEBLib.TMSFNCTypes"].InflateRectEx(n,-1,-1),t.DrawFocusRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),0,2)),this.DoPickerAfterDraw(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)))},this.SelectFirstValue=function(){},this.SelectLastValue=function(){},this.SelectNextValue=function(){},this.SelectPreviousValue=function(){},this.EditUp=function(){},this.EditDown=function(){},this.DoPopup=function(t){this.InitializePopup(),null!=this.FSelector&&this.FSelector.CalculateItems(),null!=this.FOnPopup&&this.FOnPopup(this)},this.DoClosePopup=function(t){null!=this.FOnClosePopup&&this.FOnClosePopup(this)},this.EnterTimerChanged=function(t){this.FEditable&&!this.FExitTimerClose&&this.FEdit.SetFocus(),this.FExitTimerClose=!1,this.FTimer.SetEnabled(!1)},this.ExitTimerChanged=function(t){var e=!1;this.FExitTimer.SetEnabled(!1),this.FExitTimerClose=!0,e=!0,null!=this.FPopup.FFocusedControl?pas["WEBLib.Controls"].TCustomControl.isPrototypeOf(this.FPopup.FFocusedControl)&&(e=!rtl.as(this.FPopup.FFocusedControl,pas["WEBLib.Controls"].TCustomControl).Focused()):null!=this.FPopup.FContentControl&&pas["WEBLib.Controls"].TCustomControl.isPrototypeOf(this.FPopup.FContentControl)&&(e=!rtl.as(this.FPopup.FContentControl,pas["WEBLib.Controls"].TCustomControl).Focused()),this.FPopup.FIsOpen&&!this.FDown&&e&&!this.FPreventDropDown&&this.DropDown(),this.FPreventDropDown=!1},this.EditChange=function(t){this.SetContent(this.FEdit.GetText()),this.DoEditChange(),null!=this.FOnEditChange&&this.FOnEditChange(this)},this.DoEditChange=function(){},this.HandleDialogKey=function(t,e){rtl.neSet(e,{})||this.FEditable&&this.FEdit.IsFocused()&&115===t.get()&&(1 in e||this.DropDown())},this.InitializePopup=function(){null!=this.FPopup&&(this.FPopup.SetAdaptToStyle(this.GetAdaptToStyle()),this.FDefaultStyle?(this.FPopup.FFillColor=-1,this.FPopup.FStrokeColor=-1):(this.FPopup.FFillColor=this.GetFill().FColor,this.FPopup.FStrokeColor=this.GetStroke().FColor)),null!=this.FSelector&&this.FSelector.SetAdaptToStyle(this.GetAdaptToStyle())},this.FntChanged=function(t){this.Invalidate()},this.CreateSelector=function(){return pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.$create("Create$1",[this])},this.GetFocusedControl=function(){return null,null},this.AssignEvents=function(){null!=this.FSelector&&(this.FSelector.FOnItemSelected=rtl.createCallback(this,"DoItemSelected"),this.FSelector.FOnItemDeselected=rtl.createCallback(this,"DoItemDeselected"),this.FSelector.FOnItemClick=rtl.createCallback(this,"DoItemClick"),this.FSelector.FOnItemBeforeDrawBackground=rtl.createCallback(this,"DoItemBeforeDrawBackground"),this.FSelector.FOnItemAfterDrawBackground=rtl.createCallback(this,"DoItemAfterDrawBackground"),this.FSelector.FOnItemBeforeDrawContent=rtl.createCallback(this,"DoItemBeforeDrawContent"),this.FSelector.FOnItemAfterDrawContent=rtl.createCallback(this,"DoItemAfterDrawContent"),this.FSelector.FOnItemBeforeDrawText=rtl.createCallback(this,"DoItemBeforeDrawText"),this.FSelector.FOnItemAfterDrawText=rtl.createCallback(this,"DoItemAfterDrawText"),this.FSelector.FOnBeforeDraw$1=rtl.createCallback(this,"DoBeforeDraw$1"),this.FSelector.FOnAfterDraw$1=rtl.createCallback(this,"DoAfterDraw$1"))},this.SetGraphicColors=function(){pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultPopupFillColor=this.GetFill().FColor,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultPopupStrokeColor=this.GetStroke().FColor,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonFillColor=this.GetFill().FColor,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonStrokeColor=this.GetStroke().FColor,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultTextFontColor=this.FFont$1.FColor,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultSelectionFillColor=11119017,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonFillColorFocused=pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(this.GetFill().FColor,20),pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonStrokeColorFocused=pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(this.GetStroke().FColor,20),pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonStrokeColorDisabled=11119017,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultButtonFillColorDisabled=13882323},this.DrawContent=function(t,e){t.FFont.Assign(this.FFont$1),this.FEnabled||t.FFont.SetColor(12632256)},this.DrawBackground=function(t,e){this.FDefaultStyle||this.SetGraphicColors(),t.DrawDropDownButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FDown,this.IsFocused(),!0,!1,this.GetAdaptToStyle()||!this.FDefaultStyle,this.FPaintScaleFactor),this.FDefaultStyle||t.$class.SetDefaultGraphicColors()},this.HandleMouseDown=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.CanFocus()&&this.SetFocus(),0===t&&(this.FDown=!0,this.Invalidate(),this.DropDown(),this.FEditable&&this.FEdit.SetFocus())},this.HandleMouseUp=function(t,e,i,s){this.FDown=!1,this.Invalidate()},this.HandleKeyUp=function(t,e){if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyUp.apply(this,arguments),!rtl.neSet(e,{})){var i=t.get();32!==i&&13!==i&&115!==i||this.DropDown()}},this.HandleKeyDown=function(t,e){if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyDown.apply(this,arguments),1 in e){var i=t.get();if(38===i||40===i)return void this.DropDown()}var s=t.get();36===s?this.SelectFirstValue():35===s?this.SelectLastValue():38===s||37===s?this.SelectPreviousValue():40!==s&&39!==s||this.SelectNextValue()},this.EditKeyDown=function(t,e,i){this.FKeyDown=e.get()},this.EditKeyPress=function(t,e){this.FKeyDown in rtl.createSet(38,40)&&(38===this.FKeyDown&&this.EditUp(),40===this.FKeyDown&&this.EditDown(),e.set("\0"))},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FExitTimerClose=!1,this.FPreventDropDown=!1,this.FFont$1=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont$1.FOnChanged=rtl.createCallback(this,"FntChanged"),this.FDefaultStyle=!0,this.FTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FTimer.SetInterval(1),this.FTimer.FOnTimer=rtl.createCallback(this,"EnterTimerChanged"),this.FTimer.SetEnabled(!1),this.FExitTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FExitTimer.SetInterval(1),this.FExitTimer.FOnTimer=rtl.createCallback(this,"ExitTimerChanged"),this.FExitTimer.SetEnabled(!1),this.FEdit=t.TTMSFNCCustomPickerEdit.$create("Create$1",[this]),this.FEdit.SetTabOrder(0),this.FEdit.SetTabStop(!0),this.FEdit.FOnKeyDown=rtl.createCallback(this,"EditKeyDown"),this.FEdit.FOnExit=rtl.createCallback(this,"DoEditExit"),this.FEdit.SetAlignWithMargins(!0),this.FEdit.FMargins.SetLeft(0),this.FEdit.FMargins.SetTop(0),this.FEdit.FMargins.SetRight(17),this.FEdit.FMargins.SetBottom(0),this.FEdit.SetAlign(5),this.FEdit.FOnChange=rtl.createCallback(this,"EditChange"),this.FEdit.FOnKeyPress=rtl.createCallback(this,"EditKeyPress"),this.FDropDownWidth=135,this.FDropDownHeight=135,this.FShowFocus$1=!0,this.FSelector=this.CreateSelector(),this.AssignEvents(),this.FPopup=pas["WEBLib.TMSFNCPopup"].TTMSFNCPopup.$create("Create$1",[this]),this.FPopup.SetDragWithParent(!0),this.FPopup.FFocusedControl=this.GetFocusedControl(),this.FPopup.SetContentControl(this.FSelector),this.FPopup.SetDropDownWidth(this.FDropDownWidth),this.FPopup.SetDropDownHeight(this.FDropDownHeight),this.FPopup.FOnPopup=rtl.createCallback(this,"DoPopup"),this.FPopup.FOnClosePopup=rtl.createCallback(this,"DoClosePopup"),this.SetWidth(60),this.SetHeight(22),this},this.Destroy=function(){null!=this.FFont$1&&pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FFont$1},set:function(t){this.p.FFont$1=t}}),null!=this.FSelector&&pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FSelector},set:function(t){this.p.FSelector=t}}),null!=this.FPopup&&pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FPopup},set:function(t){this.p.FPopup=t}}),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.DropDown=function(){this.FPopup.SetPlacementControl(this),this.FPopup.FIsOpen?this.FPopup.SetIsOpen(!1):(this.CalcSize(),this.FPopup.SetIsOpen(!0))},this.BeginUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.BeginUpdate.call(this),this.FUpdateCount$1+=1,null!=this.FSelector&&this.FSelector.BeginUpdate()},this.EndUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.EndUpdate.call(this),this.FUpdateCount$1-=1,null!=this.FSelector&&this.FSelector.EndUpdate()},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCDefaultPicker",this.TTMSFNCCustomPicker,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("DefaultStyle",2,rtl.boolean,"FDefaultStyle","SetDefaultStyle",{Default:!0}),t.addProperty("Fill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetFill","SetFill$1"),t.addProperty("Stroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetStroke","SetStroke$1"),t.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont$1","SetFnt"),t.addProperty("Version",1,rtl.string,"GetVersion",""),t.addProperty("OnPopup",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnPopup","FOnPopup"),t.addProperty("OnClosePopup",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClosePopup","FOnClosePopup")})),this.$implcode=function(){rtl.createClass(t,"TTMSFNCOpenCustomSelector",pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(t,"TTMSFNCCustomPickerEdit",pas["WEBLib.StdCtrls"].TEdit,(function(){rtl.addIntf(this,pas.System.IUnknown)}))}}),["SysUtils","WEBLib.TMSFNCUtils","WEBLib.TMSFNCStyles"]),rtl.module("WEBLib.TMSFNCControlPicker",["System","Classes","Types","WEBLib.Controls","WEBLib.TMSFNCCustomPicker","WEBLib.TMSFNCCustomSelector","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCTypes"],(function(){"use strict";var t=this,e=t.$impl;rtl.createInterface(this,"ITMSFNCControlPickerBase","{FF82E121-0510-4FF1-8BB8-A40AA5219095}",["PickerGetContent"],pas.System.IUnknown),rtl.createInterface(this,"ITMSFNCControlPickerItems","{D0FBAC5E-B2AA-46AE-AD21-91DF23AD4FCB}",["PickerSelectItem","PickerGetSelectedItem","PickerGetVisibleItemCount","PickerGetItemCount","PickerGetItemHeight","PickerSetItemHeight","PickerGetItemWidth","PickerSetItemWidth","PickerGetNextSelectableItem","PickerGetPreviousSelectableItem","PickerGetFirstSelectableItem","PickerGetLastSelectableItem"],this.ITMSFNCControlPickerBase),rtl.recNewT(this,"TTMSFNCControlPickerFilterItem",(function(){this.ItemIndex=0,this.ItemText="",this.$eq=function(t){return this.ItemIndex===t.ItemIndex&&this.ItemText===t.ItemText},this.$assign=function(t){return this.ItemIndex=t.ItemIndex,this.ItemText=t.ItemText,this}})),rtl.createInterface(this,"ITMSFNCControlPickerFull","{3AF9E5D7-2049-4809-920F-BA318E3D8E8D}",["PickerResetFilter","PickerApplyFilter","PickerLookupItem"],this.ITMSFNCControlPickerItems),this.TTMSFNCControlPickerStyle={0:"csDropDown",csDropDown:0,1:"csDropDownList",csDropDownList:1},this.$rtti.$Enum("TTMSFNCControlPickerStyle",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCControlPickerStyle}),this.TTMSFNCControlPickderDropDownHeightMode={0:"chmDropDownHeight",chmDropDownHeight:0,1:"chmControl",chmControl:1,2:"chmItems",chmItems:2,3:"chmPickerHeight",chmPickerHeight:3},this.$rtti.$Enum("TTMSFNCControlPickderDropDownHeightMode",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCControlPickderDropDownHeightMode}),this.TTMSFNCControlPickderDropDownWidthMode={0:"cwmDropDownWidth",cwmDropDownWidth:0,1:"cwmControl",cwmControl:1,2:"cwmItems",cwmItems:2,3:"cwmPickerWidth",cwmPickerWidth:3},this.$rtti.$Enum("TTMSFNCControlPickderDropDownWidthMode",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCControlPickderDropDownWidthMode}),this.$rtti.$MethodVar("TTMSFNCCustomControlPickerItemSelectedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AText",rtl.string],["AItemIndex",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomControlPickerOnAdjustDropDownSizeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ASize",rtl.double,1],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomControlPickerOnSetContentEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AText",rtl.string,1],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomControlPickerBeforeDrawContentEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGrahpics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AContent",rtl.string],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomControlPickerAfterDrawContentEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGrahpics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AContent",rtl.string]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomControlPicker",pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker.$init.call(this),this.FAutoCloseUp=!1,this.FAutoComplete=!1,this.FAutoCompleteDelay=0,this.FAutoCompleteNumChar=0,this.FAutoDropDown=!1,this.FCaseSensitive=!1,this.FControl=null,this.FControlParent=null,this.FControlVisible=!1,this.FControlAlign=0,this.FControlLeft=0,this.FControlTop=0,this.FControlWidth=0,this.FControlHeight=0,this.FDropDownHeightMode=0,this.FKeyDown$1=0,this.FFont$2=null,this.FPrevString="",this.FStyle=0,this.FTick=0,this.FWrapper=null,this.FOnAdjustDropDownHeight=null,this.FOnAfterDrawPickerContent=null,this.FOnBeforeDrawPickerContent=null,this.FOnItemSelected$1=null,this.FOnSetContent=null,this.FDropDownWidthMode=0,this.FOnAdjustDropDownWidth=null,this.FDropDownControlWidth=0,this.FDropDownControlHeight=0},this.$final=function(){this.FControl=void 0,this.FControlParent=void 0,this.FFont$2=void 0,this.FWrapper=void 0,this.FOnAdjustDropDownHeight=void 0,this.FOnAfterDrawPickerContent=void 0,this.FOnBeforeDrawPickerContent=void 0,this.FOnItemSelected$1=void 0,this.FOnSetContent=void 0,this.FOnAdjustDropDownWidth=void 0,pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker.$final.call(this)},this.SetAutoCloseUp=function(t){this.FAutoCloseUp=t},this.SetAutoComplete=function(t){this.FAutoComplete=t},this.SetAutoCompleteDelay=function(t){this.FAutoCompleteDelay=t},this.SetAutoCompleteNumChar=function(t){this.FAutoCompleteNumChar=t>0?t:1},this.SetAutoDropDown=function(t){this.FAutoDropDown=t},this.SetControl=function(t){t!==this&&(4 in this.FComponentState?this.FControl=t:(0 in this.FComponentState||null==this.FControl||(this.FControl.SetParent(this.FControlParent),this.FControl.SetVisible(this.FControlVisible),this.FControl.SetAlign(this.FControlAlign),this.FControl.SetLeft(Math.round(this.FControlLeft)),this.FControl.SetTop(Math.round(this.FControlTop)),this.FControl.SetWidth(Math.round(this.FControlWidth)),this.FControl.SetHeight(Math.round(this.FControlHeight))),this.FControl=t,null!=this.FControl?(this.FControlParent=this.FControl.FParent,this.FControlVisible=this.FControl.FVisible,this.FControlAlign=this.FControl.FAlign,this.FControl.SetAlign(0),this.FControlLeft=this.FControl.GetLeft(),this.FControlTop=this.FControl.GetTop(),this.FControlWidth=this.FControl.GetWidth(),this.FControlHeight=this.FControl.GetHeight(),this.FControl.SetParent(this.FWrapper),this.FControl.SetVisible(!0),this.FControl.SetLeft(0),this.FControl.SetTop(0)):(this.FControlParent=null,this.FControlVisible=!1,this.FControlAlign=0,this.FControlLeft=0,this.FControlTop=0,this.FControlWidth=0,this.FControlHeight=0),this.UpdatePickerContent(),this.AdjustDropDownHeight(),this.AdjustDropDownWidth()),this.Invalidate())},this.SetDropDownHeightMode=function(t){t!==this.FDropDownHeightMode&&(this.FDropDownHeightMode=t,this.AdjustDropDownHeight())},this.SetFnt$1=function(t){this.FFont$2.AssignSource(t)},this.SetItemHeight=function(e){var i=null,s=null,n=rtl.createIntfRefs();try{null!=this.FControl&&(pas.SysUtils.Supports$1(n.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?i.PickerSetItemHeight(e):pas.SysUtils.Supports$1(n.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})&&s.PickerSetItemHeight(e)),this.AdjustDropDownHeight()}finally{n.free(),rtl._Release(i),rtl._Release(s)}},this.SetItemIndex=function(e){var i=null,s=null,n=rtl.createIntfRefs();try{null!=this.FControl&&e>=0&&e<this.GetCount()&&(pas.SysUtils.Supports$1(n.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?i.PickerSelectItem(e):pas.SysUtils.Supports$1(n.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})&&s.PickerSelectItem(e),this.UpdatePickerContent(),this.DoPickerItemSelected(this.GetContent(),e),this.Invalidate())}finally{n.free(),rtl._Release(i),rtl._Release(s)}},this.SetStyle=function(t){if(this.FStyle!==t){this.FStyle=t;var e=this.FStyle;0===e?(this.SetEditable(!0),this.GetPopup().FFocusedControl=this.FEdit,this.GetPopup().FStaysOpen=!0):1===e&&(this.SetEditable(!1),null!=this.FControl&&(this.GetPopup().FFocusedControl=this.FControl),this.GetPopup().FStaysOpen=!1)}},this.SetText=function(t){this.SetContent(t)},this.SetCaseSensitive=function(t){this.FCaseSensitive=t},this.GetItemIndex=function(){var e=0,i=null,s=null,n=rtl.createIntfRefs();try{e=-1,null!=this.FControl&&pas.SysUtils.Supports$1(n.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?e=i.PickerGetSelectedItem():null!=this.FControl&&pas.SysUtils.Supports$1(n.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})&&(e=s.PickerGetSelectedItem())}finally{n.free(),rtl._Release(i),rtl._Release(s)}return e},this.GetItemHeight=function(){var e=0,i=null,s=null,n=rtl.createIntfRefs();try{e=0,null!=this.FControl&&(e=pas.SysUtils.Supports$1(n.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?i.PickerGetItemHeight():pas.SysUtils.Supports$1(n.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})?s.PickerGetItemHeight():this.FControlHeight)}finally{n.free(),rtl._Release(i),rtl._Release(s)}return e},this.GetText=function(){return this.GetContent()},this.GetCount=function(){var e=0,i=null,s=null,n=rtl.createIntfRefs();try{e=0,null!=this.FControl&&(e=pas.SysUtils.Supports$1(n.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?i.PickerGetItemCount():pas.SysUtils.Supports$1(n.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})?s.PickerGetItemCount():1)}finally{n.free(),rtl._Release(i),rtl._Release(s)}return e},this.ApplyFilter=function(e){var i=null,s=rtl.createIntfRefs();try{null!=this.FControl&&pas.SysUtils.Supports$1(s.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return i},set:function(t){i=t}})&&i.PickerApplyFilter(e,this.FCaseSensitive)}finally{s.free(),rtl._Release(i)}},this.ClearFilter=function(){var e=null,i=rtl.createIntfRefs();try{null!=this.FControl&&pas.SysUtils.Supports$1(i.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return e},set:function(t){e=t}})&&e.PickerResetFilter()}finally{i.free(),rtl._Release(e)}},this.LookupItem=function(e){var i=t.TTMSFNCControlPickerFilterItem.$new(),s=null,n=rtl.createIntfRefs();try{i.ItemIndex=-1,i.ItemText="",null!=this.FControl&&pas.SysUtils.Supports$1(n.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})&&i.$assign(s.PickerLookupItem(e,this.FCaseSensitive))}finally{n.free(),rtl._Release(s)}return i},this.SetDropDownWidthMode=function(t){t!==this.FDropDownWidthMode&&(this.FDropDownWidthMode=t,this.AdjustDropDownWidth())},this.GetItemWidth=function(){var e=0,i=null,s=null,n=rtl.createIntfRefs();try{e=0,null!=this.FControl&&(e=pas.SysUtils.Supports$1(n.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?i.PickerGetItemWidth():pas.SysUtils.Supports$1(n.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})?s.PickerGetItemWidth():this.FControlWidth)}finally{n.free(),rtl._Release(i),rtl._Release(s)}return e},this.SetItemWidth=function(e){var i=null,s=null,n=rtl.createIntfRefs();try{null!=this.FControl&&(pas.SysUtils.Supports$1(n.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?i.PickerSetItemWidth(e):pas.SysUtils.Supports$1(n.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})&&s.PickerSetItemWidth(e)),this.AdjustDropDownWidth()}finally{n.free(),rtl._Release(i),rtl._Release(s)}},this.SetDropDownControlHeight=function(t){this.FDropDownControlHeight!==t&&(this.FDropDownControlHeight=t,this.AdjustDropDownHeight())},this.SetDropDownControlWidth=function(t){this.FDropDownControlWidth!==t&&(this.FDropDownControlWidth=t,this.AdjustDropDownWidth())},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FControl&&(this.FControl=null)},this.FontChange=function(t){this.Invalidate()},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.AdjustDropDownHeight(),this.SetControl(this.FControl)},this.DoPickerItemSelected=function(t,e){null!=this.FOnItemSelected$1&&this.FOnItemSelected$1(this,t,e)},this.DoAdjustDropDownHeight=function(t,e){null!=this.FOnAdjustDropDownHeight&&this.FOnAdjustDropDownHeight(this,t,e)},this.DoAdjustDropDownWidth=function(t,e){null!=this.FOnAdjustDropDownWidth&&this.FOnAdjustDropDownWidth(this,t,e)},this.DoAfterDrawPickerContent=function(t,e,i){null!=this.FOnAfterDrawPickerContent&&this.FOnAfterDrawPickerContent(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoBeforeDrawPickerContent=function(t,e,i,s,n){null!=this.FOnBeforeDrawPickerContent&&this.FOnBeforeDrawPickerContent(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoSetContent=function(t,e){null!=this.FOnSetContent&&this.FOnSetContent(this,t,e)},this.DrawContent=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=!1,n=!1;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.DrawContent.apply(this,arguments),this.FEnabled?t.FFont.AssignSource(this.FFont$2):t.FFont.SetColor(12632256),i.$assign(e),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-3,-3),s=!0,n=!0,this.DoBeforeDrawPickerContent(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetContent(),{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}}),s&&(n&&t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetContent(),!1,1,0,0,0,-1,-1,!0,!1,-1,-1),this.DoAfterDrawPickerContent(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetContent()))},this.InitializePopup=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.InitializePopup.call(this),null!=this.FControl&&(this.FControl.SetWidth(Math.round(this.FDropDownWidth)),this.FControl.SetHeight(Math.round(this.FDropDownHeight)))},this.SelectFirstValue=function(){var e=0,i=null,s=null,n=rtl.createIntfRefs();try{pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectFirstValue.call(this),null!=this.FControl&&(e=-1,pas.SysUtils.Supports$1(n.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?e=i.PickerGetFirstSelectableItem():pas.SysUtils.Supports$1(n.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})&&(e=s.PickerGetFirstSelectableItem()),this.SetItemIndex(e))}finally{n.free(),rtl._Release(i),rtl._Release(s)}},this.SelectLastValue=function(){var e=0,i=null,s=null,n=rtl.createIntfRefs();try{pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectLastValue.call(this),null!=this.FControl&&(e=-1,pas.SysUtils.Supports$1(n.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?e=i.PickerGetLastSelectableItem():pas.SysUtils.Supports$1(n.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})&&(e=s.PickerGetLastSelectableItem()),this.SetItemIndex(e))}finally{n.free(),rtl._Release(i),rtl._Release(s)}},this.SelectNextValue=function(){var e=0,i=null,s=null,n=rtl.createIntfRefs();try{pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectNextValue.call(this),null!=this.FControl&&(e=-1,pas.SysUtils.Supports$1(n.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?e=i.PickerGetNextSelectableItem(this.GetItemIndex()):pas.SysUtils.Supports$1(n.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})&&(e=s.PickerGetNextSelectableItem(this.GetItemIndex())),this.SetItemIndex(e))}finally{n.free(),rtl._Release(i),rtl._Release(s)}},this.SelectPreviousValue=function(){var e=0,i=null,s=null,n=rtl.createIntfRefs();try{pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectPreviousValue.call(this),null!=this.FControl&&(e=-1,pas.SysUtils.Supports$1(n.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?e=i.PickerGetPreviousSelectableItem(this.GetItemIndex()):pas.SysUtils.Supports$1(n.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})&&(e=s.PickerGetPreviousSelectableItem(this.GetItemIndex())),this.SetItemIndex(e))}finally{n.free(),rtl._Release(i),rtl._Release(s)}},this.SetAdaptToStyle=function(t){var e=null,i=rtl.createIntfRefs();try{pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SetAdaptToStyle.apply(this,arguments),null!=this.FWrapper&&this.FWrapper.SetAdaptToStyle(this.GetAdaptToStyle()),null!=this.FControl&&pas.SysUtils.Supports$1(i.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),{get:function(){return e},set:function(t){e=t}})&&e.SetAdaptToStyle(this.GetAdaptToStyle())}finally{i.free(),rtl._Release(e)}},this.AdjustDropDownHeight=function(){var t=0,e=!1;t=null!=this.FControl&&2===this.FDropDownHeightMode?this.GetItemHeight()*this.GetVisibleItemCount():null!=this.FControl&&1===this.FDropDownHeightMode?this.FControlHeight:3===this.FDropDownHeightMode?this.GetHeight():this.FDropDownControlHeight,e=!0,this.DoAdjustDropDownHeight({get:function(){return t},set:function(e){t=e}},{get:function(){return e},set:function(t){e=t}}),e&&this.SetDropDownHeight(t)},this.AdjustDropDownWidth=function(){var t=0,e=!1;t=null!=this.FControl&&2===this.FDropDownWidthMode?this.GetItemWidth()*this.GetVisibleItemCount():null!=this.FControl&&1===this.FDropDownWidthMode?this.FControlWidth:3===this.FDropDownWidthMode?this.GetWidth():this.FDropDownControlWidth,e=!0,this.DoAdjustDropDownWidth({get:function(){return t},set:function(e){t=e}},{get:function(){return e},set:function(t){e=t}}),e&&this.SetDropDownWidth(t)},this.UpdateListBoxLookup=function(t){this.ClearFilter(),this.ApplyFilter(t),this.FAutoDropDown&&t.length>=this.FAutoCompleteNumChar&&!this.GetPopup().FIsOpen&&this.GetVisibleItemCount()>0&&this.DropDown()},this.DeleteFromEdit=function(){this.FPrevString=this.FEdit.GetText(),0===this.FEdit.GetSelLength()?pas.System.Delete({p:this,get:function(){return this.p.FPrevString},set:function(t){this.p.FPrevString=t}},this.FEdit.GetSelStart(),1):pas.System.Delete({p:this,get:function(){return this.p.FPrevString},set:function(t){this.p.FPrevString=t}},Math.max(1,this.FEdit.GetSelStart()+1),this.FEdit.GetSelLength()),this.UpdateListBoxLookup(this.FPrevString),this.FPrevString.length<this.FAutoCompleteNumChar&&this.GetPopup().FIsOpen&&(this.DropDown(),this.ClearFilter())},this.EditKeyDown$1=function(t,e,i){this.FKeyDown$1=e.get(),this.FKeyDown$1 in rtl.createSet(38,40)&&(38===this.FKeyDown$1&&this.SelectPreviousValue(),40===this.FKeyDown$1&&this.SelectNextValue(),e.set(0)),8===this.FKeyDown$1&&this.DeleteFromEdit()},this.EditKeyPress$1=function(e,i){var s,n=t.TTMSFNCControlPickerFilterItem.$new(),o=0,r=0;if(null!=this.FControl){if(s=i.get(),27===this.FKeyDown$1)return this.FAutoCloseUp&&this.GetPopup().FIsOpen,void this.DropDown();if(13===this.FKeyDown$1)return this.GetPopup().FIsOpen&&(this.FEdit.SetSelStart(this.FEdit.GetText().length),this.FEdit.SetSelLength(0),this.ClearFilter()),this.UpdatePickerContent(),void this.DropDown();if(this.FAutoComplete){if("\0"===s)return;if(this.FEdit.GetSelLength()===this.FEdit.GetText().length&&(this.FPrevString=""),this.FPrevString=this.FPrevString+s,this.FPrevString.length<this.FAutoCompleteNumChar)return;this.UpdateListBoxLookup(this.FPrevString),n.$assign(this.LookupItem(this.FPrevString)),n.ItemIndex>=0&&(this.SetItemIndex(n.ItemIndex),o=this.FPrevString.length,this.SetContent(n.ItemText),this.FEdit.SetSelStart(o),r=this.FEdit.GetText().length-o,this.FEdit.SetSelLength(r),i.set("\0"),this.FAutoCloseUp&&0===r&&this.GetPopup().FIsOpen&&this.DropDown())}}},this.KeyPress=function(i){var s=t.TTMSFNCControlPickerFilterItem.$new(),n="",o=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.KeyPress.apply(this,arguments),null!=this.FControl){if(n=i.get(),27===this.FKeyDown$1)return this.GetPopup().FIsOpen,void this.DropDown();if(this.FAutoComplete){if(8===this.FKeyDown$1)return pas.System.Delete({p:this,get:function(){return this.p.FPrevString},set:function(t){this.p.FPrevString=t}},this.FPrevString.length,1),void(1===this.FPrevString.length&&this.GetPopup().FIsOpen&&(this.DropDown(),this.ClearFilter()));if("\0"===n)return;this.FAutoDropDown&&!this.GetPopup().FIsOpen&&this.DropDown(),o=this.FAutoCompleteDelay,e.GetTickCountX()-this.FTick<o?this.FPrevString=this.FPrevString+n:(this.FTick=e.GetTickCountX(),this.FPrevString=n)}else{if("\0"===n)return;this.FPrevString=n}s.$assign(this.LookupItem(this.FPrevString)),s.ItemIndex>=0&&(this.SetItemIndex(s.ItemIndex),this.SetContent(s.ItemText),this.Invalidate(),this.FAutoComplete&&this.GetContent()===this.FPrevString&&this.FAutoCloseUp&&this.GetPopup().FIsOpen&&this.DropDown())}},this.KeyDown=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.KeyDown.apply(this,arguments),this.FKeyDown$1=t.get()},this.CreateSelector=function(){return this.FWrapper=pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.$create("Create$1",[this]),null!=this.FControl&&(this.FControl.SetParent(this.FWrapper),this.UpdatePickerContent()),this.FWrapper},this.GetVisibleItemCount=function(){var e=0,i=null,s=null,n=rtl.createIntfRefs();try{e=0,null!=this.FControl&&(e=pas.SysUtils.Supports$1(n.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?i.PickerGetVisibleItemCount():pas.SysUtils.Supports$1(n.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})?s.PickerGetVisibleItemCount():1)}finally{n.free(),rtl._Release(i),rtl._Release(s)}return e},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.Create$1.apply(this,arguments),this.SetWidth(150),this.FDropDownControlWidth=this.GetWidth(),this.FDropDownControlHeight=150,this.SetEditable(!0),this.FPrevString="",this.FAutoComplete=!0,this.FAutoCloseUp=!1,this.FAutoDropDown=!1,this.FCaseSensitive=!1,this.FAutoCompleteNumChar=2,this.FAutoCompleteDelay=500,this.FFont$2=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont$2.FOnChanged=rtl.createCallback(this,"FontChange"),this.FEdit.FOnKeyDown=rtl.createCallback(this,"EditKeyDown$1"),this.FEdit.FOnKeyPress=rtl.createCallback(this,"EditKeyPress$1"),this.FEdit.FFont.Assign(this.FFont$2),this.GetPopup().FFocusedControl=this.FEdit,this.GetPopup().FStaysOpen=!0,this.FDropDownHeightMode=0,this.FDropDownWidthMode=0,this.IsDesignTime()&&this.SetText("TTMSFNCControlPicker"),this},this.Destroy=function(){rtl.free(this,"FFont$2"),pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.Destroy.call(this)},this.CallItemClicked=function(t){this.UpdatePickerContent(),this.ClearFilter(),this.SetItemIndex(t),this.DropDown(),this.Invalidate()},this.UpdatePickerContent=function(){var e=null,i=null,s=null,n="",o=!1,r=rtl.createIntfRefs();try{n=this.GetContent(),pas.SysUtils.Supports$1(r.ref(1,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerBase),{get:function(){return e},set:function(t){e=t}})?n=e.PickerGetContent():pas.SysUtils.Supports$1(r.ref(2,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerItems),{get:function(){return i},set:function(t){i=t}})?n=i.PickerGetContent():pas.SysUtils.Supports$1(r.ref(3,rtl.queryIntfT(this.FControl,pas.System.IUnknown)),rtl.getIntfGUIDR(t.ITMSFNCControlPickerFull),{get:function(){return s},set:function(t){s=t}})&&(n=s.PickerGetContent()),o=!0,this.DoSetContent({get:function(){return n},set:function(t){n=t}},{get:function(){return o},set:function(t){o=t}}),o&&this.SetContent(n)}finally{r.free(),rtl._Release(e),rtl._Release(i),rtl._Release(s)}},this.UpdateDropDown=function(){this.UpdatePickerContent(),this.DropDown(),this.Invalidate()},this.DropDown=function(){this.AdjustDropDownHeight(),this.AdjustDropDownWidth(),this.GetPopup().SetWidth(Math.round(this.FDropDownWidth)),this.GetPopup().SetHeight(Math.round(this.FDropDownHeight)),pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.DropDown.call(this)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCControlPicker",this.TTMSFNCCustomControlPicker,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCControlPicker)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("AutoCloseUp",2,rtl.boolean,"FAutoCloseUp","SetAutoCloseUp",{Default:!1}),e.addProperty("AutoDropDown",2,rtl.boolean,"FAutoDropDown","SetAutoDropDown",{Default:!1}),e.addProperty("AutoComplete",2,rtl.boolean,"FAutoComplete","SetAutoComplete",{Default:!0}),e.addProperty("AutoCompleteDelay",2,rtl.longint,"FAutoCompleteDelay","SetAutoCompleteDelay",{Default:500}),e.addProperty("AutoCompleteNumChar",2,rtl.longint,"FAutoCompleteNumChar","SetAutoCompleteNumChar",{Default:2}),e.addProperty("Control",2,pas["WEBLib.Controls"].$rtti.TControl,"FControl","SetControl"),e.addProperty("CaseSensitive",2,rtl.boolean,"FCaseSensitive","SetCaseSensitive",{Default:!1}),e.addProperty("DropDownControlHeight",2,rtl.double,"FDropDownControlHeight","SetDropDownControlHeight"),e.addProperty("DropDownControlWidth",2,rtl.double,"FDropDownControlWidth","SetDropDownControlWidth"),e.addProperty("DropDownHeightMode",2,t.$rtti.TTMSFNCControlPickderDropDownHeightMode,"FDropDownHeightMode","SetDropDownHeightMode",{Default:t.TTMSFNCControlPickderDropDownHeightMode.chmDropDownHeight}),e.addProperty("DropDownWidthMode",2,t.$rtti.TTMSFNCControlPickderDropDownWidthMode,"FDropDownWidthMode","SetDropDownWidthMode",{Default:t.TTMSFNCControlPickderDropDownWidthMode.cwmDropDownWidth}),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont$2","SetFnt$1"),e.addProperty("ItemIndex",3,rtl.longint,"GetItemIndex","SetItemIndex",{Default:-1}),e.addProperty("ItemHeight",3,rtl.double,"GetItemHeight","SetItemHeight"),e.addProperty("ItemWidth",3,rtl.double,"GetItemWidth","SetItemWidth"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus$1","SetShowFocus$1",{Default:!0}),e.addProperty("Style",2,t.$rtti.TTMSFNCControlPickerStyle,"FStyle","SetStyle",{Default:t.TTMSFNCControlPickerStyle.csDropDown}),e.addProperty("Text",3,rtl.string,"GetText","SetText"),e.addProperty("OnAdjustDropDownHeight",0,t.$rtti.TTMSFNCCustomControlPickerOnAdjustDropDownSizeEvent,"FOnAdjustDropDownHeight","FOnAdjustDropDownHeight"),e.addProperty("OnAdjustDropDownWidth",0,t.$rtti.TTMSFNCCustomControlPickerOnAdjustDropDownSizeEvent,"FOnAdjustDropDownWidth","FOnAdjustDropDownWidth"),e.addProperty("OnAfterDrawPickerContent",0,t.$rtti.TTMSFNCCustomControlPickerAfterDrawContentEvent,"FOnAfterDrawPickerContent","FOnAfterDrawPickerContent"),e.addProperty("OnBeforeDrawPickerContent",0,t.$rtti.TTMSFNCCustomControlPickerBeforeDrawContentEvent,"FOnBeforeDrawPickerContent","FOnBeforeDrawPickerContent"),e.addProperty("OnItemSelected",0,t.$rtti.TTMSFNCCustomControlPickerItemSelectedEvent,"FOnItemSelected$1","FOnItemSelected$1"),e.addProperty("OnSetContent",0,t.$rtti.TTMSFNCCustomControlPickerOnSetContentEvent,"FOnSetContent","FOnSetContent"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),t.$implcode=function(){e.GetTickCountX=function(){var t=0,e=0,i=0,s=0;return pas.SysUtils.DecodeTime(pas.SysUtils.Now(),{get:function(){return t},set:function(e){t=e}},{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),s+1e3*i+60*e*1e3+60*t*60*1e3}}}),["Math","SysUtils","WEBLib.Graphics","WEBLib.TMSFNCStyles","WEBLib.TMSFNCUtils","WEBLib.StdCtrls"]),rtl.module("WEBLib.TMSFNCTreeView",["System","Classes","WEBLib.TMSFNCCustomTreeView","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCControlPicker"],(function(){"use strict";var t=this,e=t.$impl;rtl.createClass(this,"TTMSFNCTreeView",pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCTreeViewPublished,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClasses([t.TTMSFNCTreeView,pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewColumn,pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewNode,pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewNodeValue])},this.DoAfterSelectNode=function(t){pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.DoAfterSelectNode.apply(this,arguments),null!=this.FParent&&pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.isPrototypeOf(this.FParent)&&null!=this.FParent.FOwner&&pas["WEBLib.TMSFNCControlPicker"].TTMSFNCControlPicker.isPrototypeOf(this.FParent.FOwner)&&rtl.as(this.FParent.FOwner,pas["WEBLib.TMSFNCControlPicker"].TTMSFNCControlPicker).UpdateDropDown()},this.DrawBorders=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=pas["WEBLib.TMSFNCTypes"].TRectF.$new();pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.DrawBorders.apply(this,arguments),n.$assign(this.GetGroupsTopRect()),o.$assign(this.GetGroupsBottomRect()),e.$assign(this.GetColumnsTopRect()),i.$assign(this.GetColumnsBottomRect()),r.$assign(this.GetContentClipRect()),s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(r.Right+1,e.Bottom,r.Right+1,i.Top)),t.FStroke.Assign(this.FColumnsAppearance.FTopStroke),s.Right-s.Left>0&&s.Bottom-s.Top>0&&(this.HorizontalScrollBar().FVisible||this.FColumnsAppearance.FStretch?t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s.Right,s.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s.Right,s.Bottom)),3,1):t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s.Right,s.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s.Right,s.Bottom)),2,4)),(this.HorizontalScrollBar().FVisible||this.FColumnsAppearance.FStretch)&&(t.FStroke.Assign(this.FColumnsAppearance.FTopStroke),0 in this.FColumnsAppearance.FLayouts&&this.FColumnsAppearance.FTopSize>0?(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left,e.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left,e.Bottom)),2,4),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Right,e.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Right,e.Bottom)),3,1)):0 in this.FGroupsAppearance.FLayouts||this.FGroupsAppearance.FTopSize<=0||0===this.FDisplayGroups.GetCount()||0===this.FStroke.FKind||t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Left,e.Bottom)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.Right,e.Bottom)),2,3),t.FStroke.Assign(this.FColumnsAppearance.FBottomStroke),1 in this.FColumnsAppearance.FLayouts&&this.FColumnsAppearance.FBottomSize>0?(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,i.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,i.Bottom)),2,4),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Right,i.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Right,i.Bottom)),3,1)):(!(1 in this.FGroupsAppearance.FLayouts)||this.FGroupsAppearance.FBottomSize<=0||0===this.FDisplayGroups.GetCount())&&0!==this.FStroke.FKind&&t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,i.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Right,i.Top)),4,1),t.FStroke.Assign(this.FGroupsAppearance.FTopStroke),0 in this.FGroupsAppearance.FLayouts&&this.FDisplayGroups.GetCount()>0&&this.FGroupsAppearance.FTopSize>0&&(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Bottom)),2,4),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Bottom)),3,1)),(!(0 in this.FColumnsAppearance.FLayouts)||this.FColumnsAppearance.FTopSize<=0)&&0!==this.FStroke.FKind&&t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Bottom)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Bottom)),2,3),t.FStroke.Assign(this.FGroupsAppearance.FBottomStroke),1 in this.FGroupsAppearance.FLayouts&&this.FDisplayGroups.GetCount()>0&&this.FGroupsAppearance.FBottomSize>0&&(t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Bottom)),2,4),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Bottom)),3,1)),(!(1 in this.FColumnsAppearance.FLayouts)||this.FColumnsAppearance.FBottomSize<=0)&&0!==this.FStroke.FKind&&t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Left,o.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Right,o.Top)),4,1))},this.DrawEmptySpaces=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=!1,s=!1;pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.DrawEmptySpaces.apply(this,arguments),this.FColumnsAppearance.FFillEmptySpaces&&!this.FStretchScrollBars&&(0 in this.FColumnsAppearance.FLayouts&&this.FColumnsAppearance.FTopSize>0&&(e.$assign(this.GetColumnTopRightEmptyRect()),i=!0,s=!0,t.FFill.Assign(this.FColumnsAppearance.FTopFill),t.FStroke.Assign(this.FColumnsAppearance.FTopStroke),this.DoBeforeDrawColumnEmptySpace(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),1,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),i&&(s&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),4),this.DoAfterDrawColumnEmptySpace(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),1))),1 in this.FColumnsAppearance.FLayouts&&this.FColumnsAppearance.FBottomSize>0&&(e.$assign(this.GetColumnBottomRightEmptyRect()),i=!0,s=!0,t.FFill.Assign(this.FColumnsAppearance.FBottomFill),t.FStroke.Assign(this.FColumnsAppearance.FBottomStroke),this.DoBeforeDrawColumnEmptySpace(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),3,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),i&&(s&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),10),this.DoAfterDrawColumnEmptySpace(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),3)))),this.FGroupsAppearance.FFillEmptySpaces&&!this.FStretchScrollBars&&(0 in this.FGroupsAppearance.FLayouts&&this.FGroupsAppearance.FTopSize>0&&(e.$assign(this.GetGroupTopRightEmptyRect()),i=!0,s=!0,t.FFill.Assign(this.FGroupsAppearance.FTopFill),t.FStroke.Assign(this.FGroupsAppearance.FTopStroke),this.DoBeforeDrawGroupEmptySpace(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),1,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),i&&(s&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),9),this.DoAfterDrawGroupEmptySpace(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),1))),1 in this.FGroupsAppearance.FLayouts&&this.FGroupsAppearance.FBottomSize>0&&(e.$assign(this.GetGroupBottomRightEmptyRect()),i=!0,s=!0,t.FFill.Assign(this.FGroupsAppearance.FBottomFill),t.FStroke.Assign(this.FGroupsAppearance.FBottomStroke),this.DoBeforeDrawGroupEmptySpace(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),3,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),i&&(s&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),8),this.DoAfterDrawGroupEmptySpace(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),3))))},this.DrawNodeColumns=function(t){var e=!1,i=!1,s=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=0,r=0,a=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),l=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),h=0,F=null;pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.DrawNodeColumns.apply(this,arguments),a.$assign(this.GetContentRect()),l.$assign(this.GetContentClipRect()),h=this.GetHorizontalScrollPosition();for(var p=1,c=this.FColumnCount-1;p<=c;p++)(s=p)>=0&&s<this.FColumns.GetCount()-1&&(o=pas.System.Int(this.GetColPos(s))-pas.System.Int(h),r=pas.System.Int(this.GetColWidths(s)),-1!==this.FColumnStroke.FColor&&0!==this.FColumnStroke.FKind&&(t.FStroke.Assign(this.FColumnStroke),e=!0,i=!0,n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(o,a.Top,o+r,a.Bottom)),this.DoBeforeDrawColumn(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),s,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),e&&(i&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),5),this.DoAfterDrawColumn(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),s))));if(this.FNodeStructure.GetCount()>0)for(var u=0,T=this.FColumnCount-1;u<=T;u++)(s=u)>=0&&s<=this.FColumns.GetCount()-1&&(F=this.FColumns.GetItem$1(s),o=pas.System.Int(this.GetColPos(s))-pas.System.Int(h),r=pas.System.Int(this.GetColWidths(s)),e=!0,i=!0,t.FFill.SetKind(0),t.FStroke.Assign(this.FNodesAppearance.FColumnStroke),F.FUseDefaultAppearance||(t.FStroke.Assign(F.FStroke),t.FFill.Assign(F.FFill)),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(o,l.Top,o+r,l.Bottom)),this.DoBeforeDrawNodeColumn(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),s,{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),e&&(i&&t.DrawRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),rtl.createSet(1,2,3),5),this.DoAfterDrawNodeColumn(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),s)))},this.DrawNode=function(t,e,i,s,n,o){var r="",a=!1,l=!1,h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),p=0,c=null,u=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),T=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),C=0,S=0,d=0,m=0,f=null,g=0,y=0,b=null,N=!1,M=0,B=!1,E=0,L=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),D=null,A=!1,$=!1,I=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),P=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),v=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),G=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),w=!1,O=null,W=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),R=null,x=null,k=null,V=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),H=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),U=0,z=!1,j=null,K=null,J=null,Y={},X=0,q={};if(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.DrawNode.apply(this,arguments),!(null==i||this.FDragNode===i&&this.FDragModeStarted)&&(z=this.FResourceScaleFactor>1,B=!0,this.DoIsNodeEnabled(i,{get:function(){return B},set:function(t){B=t}}),$=!1,this.DoIsNodeExtended(i,{get:function(){return $},set:function(t){$=t}}),w=this.IsVirtualNodeSelected(i),B?w?($?(t.FFill.Assign(this.FNodesAppearance.FExtendedSelectedFill),t.FStroke.Assign(this.FNodesAppearance.FExtendedSelectedStroke)):(t.FFill.Assign(this.FNodesAppearance.FSelectedFill),t.FStroke.Assign(this.FNodesAppearance.FSelectedStroke)),C=t.FFill.FColor,S=t.FStroke.FColor,this.DoGetNodeSelectedColor(i,{get:function(){return C},set:function(t){C=t}}),this.DoGetNodeSelectedStrokeColor(i,{get:function(){return S},set:function(t){S=t}}),t.FFill.SetColor(C),t.FStroke.SetColor(S)):($?(t.FFill.Assign(this.FNodesAppearance.FExtendedFill),t.FStroke.Assign(this.FNodesAppearance.FExtendedStroke)):(t.FFill.Assign(this.FNodesAppearance.FFill),t.FStroke.Assign(this.FNodesAppearance.FStroke)),C=t.FFill.FColor,S=t.FStroke.FColor,this.DoGetNodeColor(i,{get:function(){return C},set:function(t){C=t}}),this.DoGetNodeStrokeColor(i,{get:function(){return S},set:function(t){S=t}}),t.FFill.SetColor(C),t.FStroke.SetColor(S)):($?(t.FFill.Assign(this.FNodesAppearance.FExtendedDisabledFill),t.FStroke.Assign(this.FNodesAppearance.FExtendedDisabledStroke)):(t.FFill.Assign(this.FNodesAppearance.FDisabledFill),t.FStroke.Assign(this.FNodesAppearance.FDisabledStroke)),C=t.FFill.FColor,S=t.FStroke.FColor,this.DoGetNodeDisabledColor(i,{get:function(){return C},set:function(t){C=t}}),this.DoGetNodeDisabledStrokeColor(i,{get:function(){return S},set:function(t){S=t}}),t.FFill.SetColor(C),t.FStroke.SetColor(S)),l=!0,a=!0,this.DoBeforeDrawNode(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,{get:function(){return a},set:function(t){a=t}},{get:function(){return l},set:function(t){l=t}}),a)){if(l){if(V.$assign(e),w&&!$){var Q=this.FNodesAppearance.FSelectionArea;1===Q?0!==this.FStroke.FKind&&-1!==this.FStroke.FColor?V.Left=1:V.Left=0:3===Q&&rtl.length(i.FTextRects)>0&&(V.Left=i.FTextRects[0].Left)}Y=rtl.refSet(pas["WEBLib.TMSFNCGraphicsTypes"].AllSides),X=0,q=rtl.createSet(0,1,2,3),this.DoGetNodeSides(i,{get:function(){return Y},set:function(t){Y=t}}),this.DoGetNodeRounding(i,{get:function(){return X},set:function(t){X=t}},{get:function(){return q},set:function(t){q=t}}),X>0?(X=Math.min(pas.System.Trunc(Math.min(V.Right-V.Left,V.Bottom-V.Top)/2),X),t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(V),X,rtl.refSet(q),0)):t.DrawRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(V),rtl.refSet(Y),0),i===this.GetFocusedVirtualNode()&&this.IsFocused()&&this.FNodesAppearance.FShowFocus&&(W.$assign(V),pas["WEBLib.TMSFNCTypes"].InflateRectEx(W,this.ScalePaintValue(-2),this.ScalePaintValue(-2)),t.DrawFocusRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(W),0,2))}if(!this.FCompactMode){d=this.GetFirstVisibleColumn(),m=this.GetLastVisibleColumn(),$&&(m=Math.min(d,m));for(var _=d,Z=m;_<=Z;_++){if(O=null,(p=_)>=0&&p<=this.FColumns.GetCount()-1&&(O=this.FColumns.GetItem$1(p)),p-d>=0&&p-d<=rtl.length(i.FExpandRects)-1&&this.FNodesAppearance.FShowLines&&p===this.FNodesAppearance.FExpandColumn&&this.FNodesAppearance.FExpandWidth>0){if(H.$assign(i.FExpandRects[p-d]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(H,n,o),t.FStroke.Assign(this.FNodesAppearance.FLineStroke),this.FNodesAppearance.FLineStroke.FKind in rtl.createSet(2,3,4,5)&&t.StartSpecialPen(),U=this.FNodesAppearance.FLevelIndent,I.$assign(pas["WEBLib.TMSFNCTypes"].RectF(H.Left+this.FNodesAppearance.FExpandWidth/2,e.Top,H.Left+this.FNodesAppearance.FExpandWidth/2+U/2,e.Bottom)),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(I.Left,I.Top+(I.Bottom-I.Top)/2)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(I.Right,I.Top+(I.Bottom-I.Top)/2)),2,2),this.FVisibleNodes.GetCount()>1){for(R=(k=i).GetParent(),P.$assign(I);null!=R;)(k===i&&k.FIndex<=R.FChildren-1||k!==i&&k.FIndex<R.FChildren-1)&&(k.FIndex<R.FChildren-1?t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Bottom)),2,4):t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Top+(P.Bottom-P.Top)/2)),2,4)),R=(k=R).GetParent(),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(P,-U,0);if(this.FNodeStructure.GetCount()-i.FTotalChildren-1>0)if(null==(R=i.GetParent()))i.FRow===this.FNodeStructure.GetCount()-i.FTotalChildren-1?t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Top+(P.Bottom-P.Top)/2)),2,4):0===i.FRow?t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Top+(P.Bottom-P.Top)/2)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,pas.System.Int(P.Bottom)-.5)),2,4):t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Bottom)),2,4);else if(null!=R){for(x=R,R=R.GetParent(),P.$assign(I),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(P,-U,0);null!=R;)x=R,R=R.GetParent(),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(P,-U,0);null!=x&&x.FRow<this.FNodeStructure.GetCount()-x.FTotalChildren-1&&t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(P.Left,P.Bottom)),2,4)}}this.FNodesAppearance.FLineStroke.FKind in rtl.createSet(2,3,4,5)&&t.StopSpecialPen()}if(null==O||O.FUseDefaultAppearance||$?$?t.FFont.Assign(this.FNodesAppearance.FExtendedFont):t.FFont.Assign(this.FNodesAppearance.FFont):t.FFont.Assign(O.FFont),this.GetColWidths(p)>0||$){if(B?w?(C=$?this.FNodesAppearance.FExtendedSelectedFontColor:this.FNodesAppearance.FSelectedFontColor,this.DoGetNodeSelectedTextColor(i,p,{get:function(){return C},set:function(t){C=t}}),t.FFont.SetColor(C)):(C=null==O||O.FUseDefaultAppearance||$?$?this.FNodesAppearance.FExtendedFontColor:this.FNodesAppearance.FFont.FColor:O.FFont.FColor,this.DoGetNodeTextColor(i,p,{get:function(){return C},set:function(t){C=t}}),t.FFont.SetColor(C)):(C=$?this.FNodesAppearance.FExtendedDisabledFontColor:this.FNodesAppearance.FDisabledFontColor,this.DoGetNodeDisabledTextColor(i,p,{get:function(){return C},set:function(t){C=t}}),t.FFont.SetColor(C)),p-d>=0&&p-d<=rtl.length(i.FCheckRects)-1&&p-d<=rtl.length(i.FCheckStates)-1&&(E=0,this.DoGetNodeCheckType(i,p,{get:function(){return E},set:function(t){E=t}}),0!==E)){D=null,A=i.FCheckStates[p-d],this.DoIsNodeChecked(i,p,{get:function(){return A},set:function(t){A=t}});var tt=E;1===tt?D=this.GetCheckBoxBitmap(A,!1,!0):2===tt&&(D=this.GetRadioButtonBitmap(A,!1,!0)),null!=D&&(L.$assign(i.FCheckRects[p-d]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(L,n,o),a=!0,this.DoBeforeDrawNodeCheck(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(L),p,i,D,{get:function(){return a},set:function(t){a=t}}),a&&(t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(L),D,!0,!1,!0,!1),this.DoAfterDrawNodeCheck(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(L),p,i,D)))}if(p-d>=0&&p-d<=rtl.length(i.FBitmapRects)-1&&(f=null,this.DoGetNodeIcon(i,p,!1,{get:function(){return f},set:function(t){f=t}}),null==f&&z&&this.DoGetNodeIcon(i,p,!0,{get:function(){return f},set:function(t){f=t}}),null==f||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(f)||(u.$assign(i.FBitmapRects[p-d]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(u,n,o),a=!0,this.DoBeforeDrawNodeIcon(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(u),p,i,f,{get:function(){return a},set:function(t){a=t}}),a&&(t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(u),f,!0,!1,!0,!1),this.DoAfterDrawNodeIcon(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(u),p,i,f)))),p-d>=0&&p-d<=rtl.length(i.FExpandRects)-1&&i.FChildren>0&&p===this.FNodesAppearance.FExpandColumn&&this.FNodesAppearance.FExpandWidth>0){if(c=z?i.FExpanded?this.FNodesAppearance.FCollapseNodeIconLarge:this.FNodesAppearance.FExpandNodeIconLarge:i.FExpanded?this.FNodesAppearance.FCollapseNodeIcon:this.FNodesAppearance.FExpandNodeIcon,K=null,this.GetAdaptToStyle()){(K=pas["WEBLib.Graphics"].TBitmap.$create("Create$3")).SetSize(c.GetWidth(),c.GetHeight()),j=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("Create$1",[K.GetCanvas(),!1]);try{j.BeginScene(),j.FFill.SetColor(pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultSelectionFillColor),j.FFill.SetKind(1),j.FStroke.SetKind(1),j.FStroke.SetColor(pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultTextFontColor),j.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,c.GetWidth(),c.GetHeight())),2),j.FStroke.SetWidth(this.ScalePaintValue(2)),i.FExpanded||j.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(rtl.trunc(c.GetWidth()/2),0)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(rtl.trunc(c.GetWidth()/2),c.GetHeight())),2,2),j.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(0,rtl.trunc(c.GetHeight()/2))),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(c.GetWidth(),rtl.trunc(c.GetHeight()/2))),2,2)}finally{j.EndScene(),j=rtl.freeLoc(j)}}if(v.$assign(i.FExpandRects[p-d]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(v,n,o),a=!0,this.DoBeforeDrawNodeExpand(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(v),p,i,c,{get:function(){return a},set:function(t){a=t}}),a){if(z?(G.$assign(v),pas["WEBLib.TMSFNCTypes"].InflateRectEx(G,this.ScalePaintValue(-2),this.ScalePaintValue(-2))):G.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(v.Left+(v.Right-v.Left-c.GetWidth())/2),pas.System.Int(v.Top+(v.Bottom-v.Top-c.GetHeight())/2),pas.System.Int(v.Left+(v.Right-v.Left-c.GetWidth())/2)+c.GetWidth(),pas.System.Int(v.Top+(v.Bottom-v.Top-c.GetHeight())/2)+c.GetHeight())),this.GetAdaptToStyle()&&null!=K){J=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3");try{J.Assign(K),t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(G),J,!0,!1,!0,!1)}finally{J=rtl.freeLoc(J)}K=rtl.freeLoc(K),K=null}else t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(G),c,!0,!1,!0,!1);this.DoAfterDrawNodeExpand(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(v),p,i,c)}null!=K&&(K=rtl.freeLoc(K))}p-d>=0&&p-d<=rtl.length(i.FTextRects)-1&&i.GetTitleExpanded(p-d)&&(h.$assign(i.FTextRects[p-d]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(h,n,o),pas["WEBLib.TMSFNCTypes"].InflateRectEx(h,this.ScalePaintValue(-2),0),b=null,p>=0&&p<=this.FColumns.GetCount()-1&&(b=this.FColumns.GetItem$1(p)),g=1,y=0,N=!1,M=0,null!=b&&(g=b.FHorizontalTextAlign,y=b.FVerticalTextAlign,N=b.FWordWrapping,M=b.FTrimming),this.DoGetNodeTrimming(i,p,{get:function(){return M},set:function(t){M=t}}),this.DoGetNodeWordWrapping(i,p,{get:function(){return N},set:function(t){N=t}}),this.DoGetNodeHorizontalTextAlign(i,p,{get:function(){return g},set:function(t){g=t}}),this.DoGetNodeVerticalTextAlign(i,p,{get:function(){return y},set:function(t){y=t}}),r="",this.DoGetNodeText(i,p,0,{get:function(){return r},set:function(t){r=t}}),a=!0,this.DoBeforeDrawNodeText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),p,i,r,{get:function(){return a},set:function(t){a=t}}),a&&((!this.FInplaceEditorActive||this.FUpdateNodeColumn===p&&this.GetFocusedVirtualNode()===i)&&this.FInplaceEditorActive||t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),r,N,g,y,M,0,-1,-1,!0,!1,-1,-1),this.DoAfterDrawNodeText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),p,i,r))),null==O||O.FUseDefaultAppearance?t.FFont.Assign(this.FNodesAppearance.FTitleFont):t.FFont.Assign(O.FTitleFont),B?w?(C=this.FNodesAppearance.FSelectedTitleFontColor,this.DoGetNodeSelectedTitleColor(i,p,{get:function(){return C},set:function(t){C=t}}),t.FFont.SetColor(C)):(C=null==O||O.FUseDefaultAppearance?this.FNodesAppearance.FTitleFont.FColor:O.FTitleFont.FColor,this.DoGetNodeTitleColor(i,p,{get:function(){return C},set:function(t){C=t}}),t.FFont.SetColor(C)):(C=this.FNodesAppearance.FDisabledTitleFontColor,this.DoGetNodeDisabledTitleColor(i,p,{get:function(){return C},set:function(t){C=t}}),t.FFont.SetColor(C)),p-d>=0&&p-d<=rtl.length(i.FTitleRects)-1&&(F.$assign(i.FTitleRects[p-d]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(F,n,o),pas["WEBLib.TMSFNCTypes"].InflateRectEx(F,this.ScalePaintValue(-2),0),b=null,p>=0&&p<=this.FColumns.GetCount()-1&&(b=this.FColumns.GetItem$1(p)),g=1,y=0,N=!1,M=0,null!=b&&(g=b.FTitleHorizontalTextAlign,y=b.FTitleVerticalTextAlign,N=b.FTitleWordWrapping,M=b.FTitleTrimming),this.DoGetNodeTitleTrimming(i,p,{get:function(){return M},set:function(t){M=t}}),this.DoGetNodeTitleWordWrapping(i,p,{get:function(){return N},set:function(t){N=t}}),this.DoGetNodeTitleHorizontalTextAlign(i,p,{get:function(){return g},set:function(t){g=t}}),this.DoGetNodeTitleVerticalTextAlign(i,p,{get:function(){return y},set:function(t){y=t}}),r="",this.DoGetNodeTitle(i,p,0,{get:function(){return r},set:function(t){r=t}}),a=!0,this.DoBeforeDrawNodeTitle(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),p,i,r,{get:function(){return a},set:function(t){a=t}}),a&&(t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),r,N,g,y,M,0,-1,-1,!0,!1,-1,-1),this.DoAfterDrawNodeTitle(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(F),p,i,r))),p-d>=0&&p-d<=rtl.length(i.FExtraRects)-1&&(T.$assign(i.FExtraRects[p-d]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(T,n,o),a=!0,this.DoBeforeDrawNodeExtra(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(T),p,i,{get:function(){return a},set:function(t){a=t}}),a&&(this.DoDrawNodeExtra(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(T),p,i),this.DoAfterDrawNodeExtra(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(T),p,i))),p-d>=0&&p-d<=rtl.length(i.FTitleExtraRects)-1&&(T.$assign(i.FTitleExtraRects[p-d]),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(T,n,o),a=!0,this.DoBeforeDrawNodeTitleExtra(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(T),p,i,{get:function(){return a},set:function(t){a=t}}),a&&(this.DoDrawNodeTitleExtra(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(T),p,i),this.DoAfterDrawNodeTitleExtra(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(T),p,i)))}}}this.DoAfterDrawNode(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)}},this.DrawGroup=function(t,e,i,s,n,o){var r=!1,a=!1,l="",h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=null,p=!1;if(F=null,p=!0,i>=0&&i<=this.FGroups.GetCount()-1&&!(F=this.FGroups.GetItem$1(i)).FUseDefaultAppearance){p=!1;var c=o;3===c?(t.FStroke.Assign(F.FTopStroke),t.FFill.Assign(F.FTopFill)):4===c&&(t.FStroke.Assign(F.FBottomStroke),t.FFill.Assign(F.FBottomFill))}if(p){var u=o;3===u?(t.FStroke.Assign(this.FGroupsAppearance.FTopStroke),t.FFill.Assign(this.FGroupsAppearance.FTopFill)):4===u&&(t.FStroke.Assign(this.FGroupsAppearance.FBottomStroke),t.FFill.Assign(this.FGroupsAppearance.FBottomFill))}if(r=!0,a=!0,this.DoBeforeDrawGroup(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n,o,{get:function(){return r},set:function(t){r=t}},{get:function(){return a},set:function(t){a=t}}),r){if(a&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),0),p){var T=o;3===T?t.FFont.Assign(this.FGroupsAppearance.FTopFont):4===T&&t.FFont.Assign(this.FGroupsAppearance.FBottomFont)}else if(null!=F){var C=o;3===C?t.FFont.Assign(F.FTopFont):4===C&&t.FFont.Assign(F.FBottomFont)}if(h.$assign(e),pas["WEBLib.TMSFNCTypes"].InflateRectEx(h,this.ScalePaintValue(-2),this.ScalePaintValue(-2)),l=this.GetGroupText(i),this.DoGetGroupText(i,o,{get:function(){return l},set:function(t){l=t}}),r=!0,this.DoBeforeDrawGroupText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),i,s,n,o,l,{get:function(){return r},set:function(t){r=t}}),r){var S=o;3===S?this.FGroupsAppearance.FTopVerticalText?t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),l,!1,this.FGroupsAppearance.FTopHorizontalTextAlign,this.FGroupsAppearance.FTopVerticalTextAlign,0,-90,-1,-1,!0,!1,-1,-1):t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),l,!1,this.FGroupsAppearance.FTopHorizontalTextAlign,this.FGroupsAppearance.FTopVerticalTextAlign,0,0,-1,-1,!0,!1,-1,-1):4===S&&(this.FGroupsAppearance.FBottomVerticalText?t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),l,!1,this.FGroupsAppearance.FBottomHorizontalTextAlign,this.FGroupsAppearance.FBottomVerticalTextAlign,0,90,-1,-1,!0,!1,-1,-1):t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),l,!1,this.FGroupsAppearance.FBottomHorizontalTextAlign,this.FGroupsAppearance.FBottomVerticalTextAlign,0,0,-1,-1,!0,!1,-1,-1)),this.DoAfterDrawGroupText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),i,s,n,o,l)}this.DoAfterDrawGroup(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n,o)}},this.DrawColumn=function(t,e,i,s){var n=!1,o="",r=!1,a=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),l=!1,h=null,F=0,p=0,c=0,u=!1,T=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),C=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),S=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),d=0,m=0,f=0;if(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.DrawColumn.apply(this,arguments),T.$assign(e),l=!0,h=null,i>=0&&i<=this.FColumns.GetCount()-1&&!(h=this.FColumns.GetItem$1(i)).FUseDefaultAppearance){l=!1;var g=s;1===g?(t.FStroke.Assign(h.FTopStroke),t.FFill.Assign(h.FTopFill)):2===g&&(t.FStroke.Assign(h.FBottomStroke),t.FFill.Assign(h.FBottomFill))}if(l){var y=s;1===y?(t.FStroke.Assign(this.FColumnsAppearance.FTopStroke),t.FFill.Assign(this.FColumnsAppearance.FTopFill)):2===y&&(t.FStroke.Assign(this.FColumnsAppearance.FBottomStroke),t.FFill.Assign(this.FColumnsAppearance.FBottomFill))}if(n=!0,r=!0,this.DoBeforeDrawColumnHeader(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(T),i,s,{get:function(){return n},set:function(t){n=t}},{get:function(){return r},set:function(t){r=t}}),n){if(r&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(T),0),C.$assign(T),f=0,null!=h&&(h.FFiltering.FEnabled&&(d=h.FFiltering.FButtonSize,S.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(T.Right-d-this.ScalePaintValue(4)),Math.round(T.Top+(T.Bottom-T.Top-d)/2),Math.round(T.Right-this.ScalePaintValue(4)),Math.round(T.Top+(T.Bottom-T.Top-d)/2+d))),t.DrawDropDownButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(S),!1,!1,!0,!0,this.GetAdaptToStyle(),this.FPaintScaleFactor),C.Right=S.Left,f=f+d+this.ScalePaintValue(4)),h.FExpandable&&(m=h.FExpandingButtonSize,C.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(C.Right-m-this.ScalePaintValue(6)),Math.round(C.Top+(C.Bottom-C.Top-m)/2),Math.round(C.Right-this.ScalePaintValue(6)),Math.round(C.Top+(C.Bottom-C.Top-m)/2+m))),h.FExpanded?t.DrawCompactButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(C),1,!1,!1,!0,!1,this.FPaintScaleFactor):t.DrawCompactButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(C),0,!1,!1,!0,!1,this.FPaintScaleFactor),C.Right=C.Left,f=f+m+this.ScalePaintValue(6)),0!==h.FSortKind&&this.FSortColumn===i&&(m=this.ScalePaintValue(8),C.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(C.Right-m-this.ScalePaintValue(6)),Math.round(C.Top+(C.Bottom-C.Top-m)/2),Math.round(C.Right-this.ScalePaintValue(6)),Math.round(C.Top+(C.Bottom-C.Top-m)/2+m))),this.DrawSortIndicator(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(C),this.FColumnsAppearance.FSortIndicatorColor,i,h.FSortIndex,h.FSortKind),f=f+m+this.ScalePaintValue(6))),l){var b=s;1===b?t.FFont.Assign(this.FColumnsAppearance.FTopFont):2===b&&t.FFont.Assign(this.FColumnsAppearance.FBottomFont)}else if(null!=h){var N=s;1===N?t.FFont.Assign(h.FTopFont):2===N&&t.FFont.Assign(h.FBottomFont)}if(o=this.GetColumnText(i),this.DoGetColumnText(i,s,{get:function(){return o},set:function(t){o=t}}),p=1,c=0,u=!1,F=0,null!=h&&(p=h.FHorizontalTextAlign,c=h.FVerticalTextAlign,u=h.FWordWrapping,F=h.FTrimming),this.DoGetColumnTrimming(i,s,{get:function(){return F},set:function(t){F=t}}),this.DoGetColumnWordWrapping(i,s,{get:function(){return u},set:function(t){u=t}}),this.DoGetColumnHorizontalTextAlign(i,s,{get:function(){return p},set:function(t){p=t}}),this.DoGetColumnVerticalTextAlign(i,s,{get:function(){return c},set:function(t){c=t}}),n=!0,a.$assign(T),pas["WEBLib.TMSFNCTypes"].InflateRectEx(a,this.ScalePaintValue(-3),this.ScalePaintValue(-3)),a.Right=Math.max(a.Left,a.Right-f),this.DoBeforeDrawColumnText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),i,s,o,{get:function(){return n},set:function(t){n=t}}),n){var M=s;1===M?this.FColumnsAppearance.FTopVerticalText?t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),o,u,p,c,F,-90,-1,-1,!0,!1,-1,-1):t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),o,u,p,c,F,0,-1,-1,!0,!1,-1,-1):2===M&&(this.FColumnsAppearance.FBottomVerticalText?t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),o,u,p,c,F,90,-1,-1,!0,!1,-1,-1):t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),o,u,p,c,F,0,-1,-1,!0,!1,-1,-1)),this.DoAfterDrawColumnText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a),i,s,o)}this.DoAfterDrawColumnHeader(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)}},this.DrawSortIndicator=function(t,e,i,s,n,o){var r,a=null,l=0,h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=!1;if(r=i,t.FFill.SetKind(1),t.FFill.SetColor(r),t.FStroke.SetKind(1),t.FStroke.SetColor(r),F=!0,this.DoBeforeDrawSortIndicator(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),s,n,o,{get:function(){return F},set:function(t){F=t}}),F){l=0,h.$assign(e),a=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{var p=o;1===p?(l=2,a.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/2,e.Top)),a.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Right,e.Bottom)),a.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Left,e.Bottom)),h.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+this.ScalePaintValue(2),e.Right,e.Bottom+this.ScalePaintValue(2)))):2===p&&(l=1,a.MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Left,e.Top)),a.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Right,e.Top)),a.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(e.Left+(e.Right-e.Left)/2,e.Bottom)),h.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top-this.ScalePaintValue(2),e.Right,e.Bottom-this.ScalePaintValue(2)))),a.ClosePath(),t.DrawPath(a,0),-1!==n&&(t.FFont.SetColor(16777215),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(t.FFont,9,1),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),pas.SysUtils.IntToStr(n),!1,0,l,0,0,-1,-1,!0,!1,-1,-1))}finally{a=rtl.freeLoc(a)}this.DoAfterDrawSortIndicator(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),s,n,o)}},this.PickerGetContent=function(){var t="";return t="",this.SelectedVirtualNodeCount()>0&&(t=this.GetSelVirtualNode(0).GetText(0)),t},this.PickerSelectItem=function(t){var e;null!=(e=this.GetNodeFromNodeStructure(t))&&(this.SelectVirtualNode(e),this.ScrollToVirtualNode(e,!0,0,!1))},this.PickerGetSelectedItem=function(){return this.GetSelectedVirtualNodeRow()},this.PickerGetVisibleItemCount=function(){return this.GetVisibleNodeCount()},this.PickerGetItemCount=function(){return this.GetTotalVirtualNodeCount()},this.PickerGetItemHeight=function(){return this.FNodesAppearance.FFixedHeight},this.PickerSetItemHeight=function(t){this.FNodesAppearance.SetFixedHeight(t)},this.PickerGetItemWidth=function(){return this.FColumns.GetCount()>0?this.GetWidth()/this.FColumns.GetCount():0},this.PickerSetItemWidth=function(t){},this.PickerGetNextSelectableItem=function(t){var e,i=0,s=null;return i=-1,null!=(e=this.GetNodeFromNodeStructure(t))&&null!=(s=this.GetNextFocusableNode(e))&&(i=s.FRow),i},this.PickerGetPreviousSelectableItem=function(t){var e,i=0,s=null;return i=-1,null!=(e=this.GetNodeFromNodeStructure(t))&&null!=(s=this.GetPreviousFocusableNode(e))&&(i=s.FRow),i},this.PickerGetFirstSelectableItem=function(){return this.GetFirstVisibleVirtualNodeRow()},this.PickerGetLastSelectableItem=function(){return this.GetLastVisibleVirtualNodeRow()},this.PickerResetFilter=function(){this.FFilter.GetCount()>0&&this.RemoveFilters()},this.PickerApplyFilter=function(t,e){var i=null;(i=this.FFilter.Add$1()).FCondition=t,i.FCaseSensitive=e,this.ApplyFilter()},this.PickerLookupItem=function(t,e){var i=pas["WEBLib.TMSFNCControlPicker"].TTMSFNCControlPickerFilterItem.$new(),s=null;return i.ItemIndex=-1,i.ItemText="",null!=(s=this.LookupNode(t+"*",!1,-1,e,!0,!0))&&(i.ItemIndex=s.FRow,i.ItemText=s.GetText(0)),i},rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown),this.$rtti.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),t.$implcode=function(){rtl.createClass(e,"TTMSFNCTreeViewColumnOpen",pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewColumn,(function(){}))}}),["Math","SysUtils","WEBLib.TMSFNCUtils","WEBLib.Graphics","WEBLib.TMSFNCCustomSelector"]),rtl.module("WEBLib.TMSFNCToolBarRes",["System"],(function(){"use strict";var t=this;this.TMSFNCTOOLBAREXPAND="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAYAAADEUlfTAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOvwAADr8BOAVTJAAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4zjOaXUAAAACVJREFUGFdj+P//P07MEBYW9h8Xxi8JAjglYACnBAzglMAEDAwARZ1DA4NRF38AAAAASUVORK5CYII=",this.TMSFNCTOOLBAREXPANDLARGE=this.TMSFNCTOOLBAREXPAND,this.TMSFNCTOOLBAREXPAND2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAYAAADEUlfTAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOvgAADr4B6kKxwAAAABl0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4xNkRpr/UAAAA3SURBVBhXY3j69KktLgyS/I8LE5RsQxeE4jaQpCKIgSQIlgBiRQYQADGgAqgSMABVkI2QYGAAANnukE/t/B6ZAAAAAElFTkSuQmCC",this.TMSFNCTOOLBAROPTIONSMENU="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAJCAYAAAD+WDajAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOvwAADr8BOAVTJAAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4zjOaXUAAAACpJREFUKFNjwAvCwsL+48IM///jxvh1YhOEYZz2giVgAKcEDOCUwAQMDAAqj1EKDJG5XAAAAABJRU5ErkJggg==",this.TMSFNCTOOLBAROPTIONSMENULARGE=this.TMSFNCTOOLBAROPTIONSMENU,this.TMSFNCTOOLBARQUICKMENU="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAYAAADEUlfTAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwgAADsIBFShKgAAAABl0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4xNkRpr/UAAAAlSURBVBhXYwCC/9gwEAApKAMbJl4SnY0igCQIw3gkcUowMPwHALBNZJw15C+yAAAAAElFTkSuQmCC",this.TMSFNCTOOLBARQUICKMENU2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAYAAADEUlfTAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAAAL0lEQVQYV2P4jxswwCRBNAYGESCAIQHCIAIEYAIgAGejC8D4YEBQEqvE/////wMA7H6pV7j5gXMAAAAASUVORK5CYII=",t.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTOOLBAREXPAND),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTOOLBAREXPAND2),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTOOLBAROPTIONSMENU),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTOOLBARQUICKMENU),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTOOLBARQUICKMENU2)}}),["WEBLib.TMSFNCTypes"]),rtl.module("WEBLib.TMSFNCToolBar",["System","Classes","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCPersistence","WEBLib.TMSFNCStyles","WEBLib.TMSFNCCustomControl","WEBLib.Controls","Types","WEBLib.TMSFNCPopup","WEBLib.TMSFNCTypes","WEBLib.TMSFNCBitmapContainer","WEBLib.StdCtrls","WEBLib.TMSFNCToolBarRes","WEBLib.TMSFNCGraphicsTypes","contnrs","WEBLib.Menus","WEBLib.ExtCtrls"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=2,this.BLD_VER=1,this.TMSFNCTOOLBAREXPANDSVG="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTIiIHdpZHRoPSIxMCI+DQogIDxwYXRoIGQ9Ik0gMiA0IEwgNSA3IEwgOCA0IFoiIHN0eWxlPSJzdHJva2U6YmxhY2s7c3Ryb2tlLXdpZHRoOjEiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgLz4NCjwvc3ZnPg==",rtl.createClass(this,"TTMSFNCToolBarCustomButtonAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FHoverStroke=null,this.FDownFill=null,this.FNormalFill=null,this.FDownStroke=null,this.FDisabledFill=null,this.FNormalStroke=null,this.FDisabledStroke=null,this.FHoverFill=null,this.FCorners={},this.FRounding=0,this.FTransparent=!1,this.FShowInnerStroke=!1,this.FInnerStroke=null,this.FFlatStyle=!1,this.FOnChange=null},this.$final=function(){this.FOwner=void 0,this.FHoverStroke=void 0,this.FDownFill=void 0,this.FNormalFill=void 0,this.FDownStroke=void 0,this.FDisabledFill=void 0,this.FNormalStroke=void 0,this.FDisabledStroke=void 0,this.FHoverFill=void 0,this.FCorners=void 0,this.FInnerStroke=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetDisabledFill=function(t){this.FDisabledFill.Assign(t)},this.SetDisabledStroke=function(t){this.FDisabledStroke.Assign(t)},this.SetDownFill=function(t){this.FDownFill.Assign(t)},this.SetDownStroke=function(t){this.FDownStroke.Assign(t)},this.SetHoverFill=function(t){this.FHoverFill.Assign(t)},this.SetHoverStroke=function(t){this.FHoverStroke.Assign(t)},this.SetNormalFill=function(t){this.FNormalFill.Assign(t)},this.SetNormalStroke=function(t){this.FNormalStroke.Assign(t)},this.SetCorners=function(t){rtl.neSet(this.FCorners,t)&&(this.FCorners=rtl.refSet(t),this.Changed())},this.SetRounding=function(t){this.FRounding!==t&&(this.FRounding=t,this.Changed())},this.SetInnerStroke=function(t){this.FInnerStroke.Assign(t)},this.SetShowInnerStroke=function(t){this.FShowInnerStroke!==t&&(this.FShowInnerStroke=t,this.Changed())},this.SetTransparent=function(t){this.FTransparent!==t&&(this.FTransparent=t,this.Changed())},this.IsRoundingStored=function(){return 3!==this.FRounding},this.SetFlatStyle=function(e){var i=null,s=0;if(this.FFlatStyle!==e){if(this.FFlatStyle=e,null!=this.FOwner)for(var n=0,o=this.FOwner.GetControlsCount()-1;n<=o;n++)s=n,i=this.FOwner.GetControls(s),t.TTMSFNCDefaultToolBarButton.isPrototypeOf(i)&&rtl.as(i,t.TTMSFNCDefaultToolBarButton).FAppearance.SetFlatStyle(this.FFlatStyle),t.TTMSFNCCustomToolBar.isPrototypeOf(i)&&rtl.as(i,t.TTMSFNCCustomToolBar).FAppearance.SetFlatStyle(this.FFlatStyle);this.Changed()}},this.FillChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.Changed=function(){null!=this.FOwner?this.FOwner.AppearanceChanged():null!=this.FOnChange&&this.FOnChange(this)},this.Assign=function(e){t.TTMSFNCToolBarCustomButtonAppearance.isPrototypeOf(e)?(this.FNormalFill.Assign(rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FNormalFill),this.FDisabledFill.Assign(rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FDisabledFill),this.FHoverFill.Assign(rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FHoverFill),this.FDownFill.Assign(rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FDownFill),this.FNormalStroke.Assign(rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FNormalStroke),this.FDisabledStroke.Assign(rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FDisabledStroke),this.FHoverStroke.Assign(rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FHoverStroke),this.FDownStroke.Assign(rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FDownStroke),this.FRounding=rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FRounding,this.FCorners=rtl.refSet(rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FCorners),this.FShowInnerStroke=rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FShowInnerStroke,this.FTransparent=rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FTransparent,this.FFlatStyle=rtl.as(e,t.TTMSFNCToolBarCustomButtonAppearance).FFlatStyle):pas.Classes.TPersistent.Assign.apply(this,arguments)},this.Create$1=function(t){return this.FOwner=t,this.FCorners=rtl.createSet(0,1,2,3),this.FRounding=3,this.FTransparent=!1,this.FShowInnerStroke=!0,this.FFlatStyle=!1,this.FNormalFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[2,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(249,251,252),pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(230,235,235),pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(220,220,236),pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(220,225,236)]),this.FHoverFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[2,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,231,232),pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(210,215,215),pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(200,200,216),pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(200,205,216)]),this.FDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[2,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(219,221,222),pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(200,205,205),pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(190,190,206),pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(190,195,206)]),this.FDisabledFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,13882323,8421504,-1,-1]),this.FNormalStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,8421504]),this.FInnerStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,16777215]),this.FHoverStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,8421504]),this.FDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,8421504]),this.FDisabledStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,8421504]),this.FNormalFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FHoverFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FDisabledFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FInnerStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FNormalStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FHoverStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FDisabledStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this},this.Destroy=function(){rtl.free(this,"FNormalFill"),rtl.free(this,"FHoverFill"),rtl.free(this,"FDownFill"),rtl.free(this,"FDisabledFill"),rtl.free(this,"FInnerStroke"),rtl.free(this,"FNormalStroke"),rtl.free(this,"FHoverStroke"),rtl.free(this,"FDownStroke"),rtl.free(this,"FDisabledStroke"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TTMSFNCToolBarButtonAppearance",this.TTMSFNCToolBarCustomButtonAppearance,(function(){var t=this.$rtti;t.addProperty("Transparent",2,rtl.boolean,"FTransparent","SetTransparent",{Default:!1}),t.addProperty("ShowInnerStroke",2,rtl.boolean,"FShowInnerStroke","SetShowInnerStroke",{Default:!0}),t.addProperty("Rounding",14,rtl.double,"FRounding","SetRounding",{stored:"IsRoundingStored"}),t.addProperty("Corners",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsCorners,"FCorners","SetCorners",{Default:rtl.createSet(0,1,2,3)}),t.addProperty("InnerStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FInnerStroke","SetInnerStroke"),t.addProperty("NormalFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FNormalFill","SetNormalFill"),t.addProperty("NormalStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FNormalStroke","SetNormalStroke"),t.addProperty("HoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FHoverFill","SetHoverFill"),t.addProperty("HoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FHoverStroke","SetHoverStroke"),t.addProperty("DownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDownFill","SetDownFill"),t.addProperty("DownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDownStroke","SetDownStroke"),t.addProperty("DisabledFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDisabledFill","SetDisabledFill"),t.addProperty("DisabledStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDisabledStroke","SetDisabledStroke"),t.addProperty("FlatStyle",2,rtl.boolean,"FFlatStyle","SetFlatStyle",{Default:!1})})),rtl.createClass(this,"TTMSFNCToolBarCompactAppearance",this.TTMSFNCToolBarCustomButtonAppearance,(function(){var t=this.$rtti;t.addProperty("NormalFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FNormalFill","SetNormalFill"),t.addProperty("NormalStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FNormalStroke","SetNormalStroke"),t.addProperty("HoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FHoverFill","SetHoverFill"),t.addProperty("HoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FHoverStroke","SetHoverStroke"),t.addProperty("DownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDownFill","SetDownFill"),t.addProperty("DownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDownStroke","SetDownStroke"),t.addProperty("DisabledFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDisabledFill","SetDisabledFill"),t.addProperty("DisabledStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDisabledStroke","SetDisabledStroke"),t.addProperty("FlatStyle",2,rtl.boolean,"FFlatStyle","SetFlatStyle",{Default:!1})})),rtl.createClass(this,"TTMSFNCToolBarQuickMenuButtonAppearance",this.TTMSFNCToolBarCustomButtonAppearance,(function(){var t=this.$rtti;t.addProperty("NormalFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FNormalFill","SetNormalFill"),t.addProperty("NormalStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FNormalStroke","SetNormalStroke"),t.addProperty("HoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FHoverFill","SetHoverFill"),t.addProperty("HoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FHoverStroke","SetHoverStroke"),t.addProperty("DownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDownFill","SetDownFill"),t.addProperty("DownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDownStroke","SetDownStroke"),t.addProperty("DisabledFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDisabledFill","SetDisabledFill"),t.addProperty("DisabledStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDisabledStroke","SetDisabledStroke"),t.addProperty("FlatStyle",2,rtl.boolean,"FFlatStyle","SetFlatStyle",{Default:!1})})),this.TTMSFNCToolBarElementState={0:"esNormal",esNormal:0,1:"esLarge",esLarge:1},this.$rtti.$Enum("TTMSFNCToolBarElementState",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCToolBarElementState}),rtl.createClass(this,"TTMSFNCCustomToolBarElement",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FBlockUpdate=!1,this.FOnUpdateToolBar=null,this.FOnUpdateToolBarControl=null,this.FCanCopy=!1,this.FState=0,this.FLastElement=!1,this.FControlIndex=0},this.$final=function(){this.FOnUpdateToolBar=void 0,this.FOnUpdateToolBarControl=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetState=function(t){this.FState!==t&&(this.FState=t,this.UpdateState())},this.SetLastElement=function(t){this.FLastElement!==t&&(this.FLastElement=t,this.UpdateToolBar())},this.UpdateState=function(){},this.UpdateToolBar=function(){null==this.FOnUpdateToolBar||this.FBlockUpdate||this.FOnUpdateToolBar(this)},this.VisibleChanging=function(){pas["WEBLib.Controls"].TControl.VisibleChanging.call(this),this.UpdateToolBar()},this.UpdateControlAfterResize=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.UpdateControlAfterResize.call(this),this.UpdateToolBar()},this.Assign=function(e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments),t.TTMSFNCCustomToolBarElement.isPrototypeOf(e)&&(this.FState=rtl.as(e,t.TTMSFNCCustomToolBarElement).FState,this.FLastElement=rtl.as(e,t.TTMSFNCCustomToolBarElement).FLastElement,this.FCanCopy=rtl.as(e,t.TTMSFNCCustomToolBarElement).FCanCopy)},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.DisableBackground(),this.FLastElement=!1,this.FCanCopy=!0,this.FState=0,this},this.Destroy=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),this.TTMSFNCToolBarButtonBitmapPosition={0:"bbpLeft",bbpLeft:0,1:"bbpTop",bbpTop:1},this.$rtti.$Enum("TTMSFNCToolBarButtonBitmapPosition",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCToolBarButtonBitmapPosition}),this.TTMSFNCToolBarButtonLayout={0:"bblNone",bblNone:0,1:"bblBitmap",bblBitmap:1,2:"bblLabel",bblLabel:2,3:"bblLarge",bblLarge:3},this.$rtti.$Enum("TTMSFNCToolBarButtonLayout",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCToolBarButtonLayout}),rtl.createClass(this,"TTMSFNCDefaultToolBarButton",this.TTMSFNCCustomToolBarElement,(function(){this.$init=function(){t.TTMSFNCCustomToolBarElement.$init.call(this),this.FOldHeight=0,this.FBitmapVisible=!1,this.FText="",this.FPopup=null,this.FPopupPlacement=0,this.FDropDownHeight=0,this.FDropDownWidth=0,this.FDown=!1,this.FHover=!1,this.FPrevHover=!1,this.FAppearance=null,this.FBitmapContainer=null,this.FBitmaps=null,this.FApplyName=!1,this.FDropDownControl=null,this.FFont$1=null,this.FOnBeforeDropDown=null,this.FCloseOnSelection=!1,this.FDownState=!1,this.FTextVisible=!1,this.FOnCloseDropDown=null,this.FOnDropDown=null,this.FVerticalTextAlign=0,this.FHorizontalTextAlign=0,this.FWordWrapping=!1,this.FTrimming=0,this.FBitmapSize=0,this.FStretchText=!1,this.FDisabledBitmaps=null,this.FHoverBitmaps=null,this.FShowFocus$1=!1,this.FDropDownAutoWidth=!1,this.FHoverFontColor=0,this.FDownFontColor=0,this.FDisabledFontColor=0,this.FStretchBitmapIfNoText=!1,this.FBitmapPosition=0,this.FMaximumLayout=0,this.FMinimumLayout=0,this.FLayout=0,this.FCompactLayout=0,this.FLargeLayoutBitmapSize=0,this.FLargeLayoutBitmaps=null,this.FLargeLayoutHoverBitmaps=null,this.FLargeLayoutDisabledBitmaps=null,this.FAutoBitmapSize=!1,this.FLargeLayoutAutoBitmapSize=!1},this.$final=function(){this.FPopup=void 0,this.FAppearance=void 0,this.FBitmapContainer=void 0,this.FBitmaps=void 0,this.FDropDownControl=void 0,this.FFont$1=void 0,this.FOnBeforeDropDown=void 0,this.FOnCloseDropDown=void 0,this.FOnDropDown=void 0,this.FDisabledBitmaps=void 0,this.FHoverBitmaps=void 0,this.FLargeLayoutBitmaps=void 0,this.FLargeLayoutHoverBitmaps=void 0,this.FLargeLayoutDisabledBitmaps=void 0,t.TTMSFNCCustomToolBarElement.$final.call(this)},this.SetAppearance=function(t){this.FAppearance.Assign(t)},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,this.UpdateLayout(),this.Invalidate()},this.SetBitmaps=function(t){this.FBitmaps.Assign(t)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.FTextVisible=""!==t,this.UpdateLayout(),this.Invalidate())},this.SetDropDownHeight=function(t){this.FDropDownHeight=t,null==this.FPopup||this.FDropDownAutoWidth||this.FPopup.SetDropDownHeight(this.FDropDownHeight)},this.SetDropDownWidth=function(t){this.FDropDownWidth=t,null!=this.FPopup&&this.FPopup.SetDropDownWidth(this.FDropDownWidth)},this.SetBitmapVisible=function(t){this.FBitmapVisible=t,this.UpdateLayout(),this.Invalidate()},this.SetTextVisible=function(t){this.FTextVisible!==t&&(this.FTextVisible=t,this.UpdateLayout(),this.Invalidate())},this.SetFont$1=function(t){this.FFont$1.Assign(t)},this.SetDropDownControl=function(t){this.FDropDownControl=t,null!=this.FDropDownControl&&(4 in this.FComponentState?4 in this.FComponentState&&(this.SetDropDownHeight(this.FDropDownControl.GetHeight()),this.SetDropDownWidth(this.FDropDownControl.GetWidth())):null!=this.FPopup&&(this.FPopup.SetContentControl(this.FDropDownControl),this.FPopup.FFocusedControl=this.FDropDownControl))},this.IsDropDownHeightStored=function(){return 135!==this.FDropDownHeight},this.IsDropDownWidthStored=function(){return 135!==this.FDropDownWidth},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t,this.Invalidate())},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,this.Invalidate())},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,this.Invalidate())},this.SetTrimming=function(t){this.FTrimming!==t&&(this.FTrimming=t,this.Invalidate())},this.IsBitmapSizeStored=function(){return 24!==this.FBitmapSize},this.SetBitmapSize=function(t){this.FBitmapSize!==t&&(this.FBitmapSize=t,this.UpdateLayout(),this.Invalidate())},this.SetStretchText=function(t){this.FStretchText!==t&&(this.FStretchText=t,this.UpdateLayout(),this.Invalidate())},this.SetDisabledBitmaps=function(t){this.FDisabledBitmaps.Assign(t)},this.SetHoverBitmaps=function(t){this.FHoverBitmaps.Assign(t)},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetShowFocus$1=function(t){this.FShowFocus$1!==t&&(this.FShowFocus$1=t,this.Invalidate())},this.SetDropDownAutoWidth=function(t){this.FDropDownAutoWidth!==t&&(this.FDropDownAutoWidth=t,null!=this.FPopup&&(this.FDropDownAutoWidth?this.FPopup.SetDropDownWidth(this.GetWidth()):this.FPopup.SetDropDownWidth(this.FDropDownWidth)))},this.SetStretchBitmapIfNoText=function(t){this.FStretchBitmapIfNoText!==t&&(this.FStretchBitmapIfNoText=t,this.UpdateLayout(),this.Invalidate())},this.SetBitmapPosition=function(t){this.FBitmapPosition!==t&&(this.FBitmapPosition=t,this.Invalidate())},this.SetMaximumLayout=function(t){this.FMaximumLayout!==t&&(this.FMaximumLayout=t,this.UpdateToolBar())},this.SetMinimumLayout=function(t){this.FMinimumLayout!==t&&(this.FMinimumLayout=t,this.UpdateToolBar())},this.SetLayout=function(t){this.FLayout!==t&&(this.FLayout=t,this.UpdateLayout())},this.SetCompactLayout=function(t){this.FCompactLayout!==t&&(this.FCompactLayout=t)},this.IsLargeLayoutBitmapSizeStored=function(){return 32!==this.FLargeLayoutBitmapSize},this.SetLargeLayoutBitmaps=function(t){this.FLargeLayoutBitmaps.Assign(t)},this.SetLargeLayoutBitmapSize=function(t){this.FLargeLayoutBitmapSize!==t&&(this.FLargeLayoutBitmapSize=t,this.UpdateLayout(),this.Invalidate())},this.SetLargeLayoutDisabledBitmaps=function(t){this.FLargeLayoutDisabledBitmaps.Assign(t)},this.SetLargeLayoutHoverBitmaps=function(t){this.FLargeLayoutHoverBitmaps.Assign(t)},this.SetAutoBitmapSize=function(t){this.FAutoBitmapSize!==t&&(this.FAutoBitmapSize=t,this.UpdateLayout(),this.Invalidate())},this.SetLargeLayoutAutoBitmapSize=function(t){this.FLargeLayoutAutoBitmapSize!==t&&(this.FLargeLayoutAutoBitmapSize=t,this.UpdateLayout(),this.Invalidate())},this.CanDrawDesignTime=function(){return!1,!1},this.GetText=function(){return this.FText},this.GetTextSize=function(){var t=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),e=null,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(t.cx=0,t.cy=0,this.FTextVisible&&""!==this.GetText()){e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,this.FNativeCanvas,!0]),this.FNativeCanvas||e.BeginScene(),e.FBitmapContainer=this.GetBitmapContainer(),e.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing;try{e.FFont.Assign(this.FFont$1),i.$assign(this.GetLocalRect()),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,this.ScalePaintValue(-2),this.ScalePaintValue(-2)),t.$assign(e.CalculateTextSize(this.GetText(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FWordWrapping,!0))}finally{this.FNativeCanvas||e.EndScene(),e=rtl.freeLoc(e)}}return t},this.UpdateControlAfterResize=function(){t.TTMSFNCCustomToolBarElement.UpdateControlAfterResize.call(this),3===this.FLayout&&(this.FOldHeight=this.GetHeight())},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FNormalFill.SetColor(t),this.FAppearance.FNormalFill.SetKind(1),this.FAppearance.FDisabledFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(t,11119017,20)),this.FAppearance.FDisabledFill.SetKind(1),this.FAppearance.FInnerStroke.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(this.FAppearance.FNormalFill.FColor,this.FAppearance.FNormalStroke.FColor,75)),this.FAppearance.FInnerStroke.SetKind(1)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&this.FFont$1.SetColor(t),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundStrokeColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FNormalStroke.SetColor(t),this.FAppearance.FDownStroke.SetColor(t),this.FAppearance.FDisabledStroke.SetColor(t),this.FAppearance.FNormalStroke.SetColor(t),this.FAppearance.FDownStroke.SetColor(t),this.FAppearance.FDisabledStroke.SetColor(t),this.FAppearance.FHoverStroke.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleSelectionFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FHoverFill.SetColor(t),this.FAppearance.FHoverFill.SetKind(1),this.FAppearance.FDownFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Blend(t,this.FFill.FColor,20)),this.FAppearance.FDownFill.SetKind(1))},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FFont$1.SetColor(0),this.FAppearance.FNormalFill.SetColor(16777215),this.FAppearance.FHoverFill.SetColor(16777215),this.FAppearance.FDownFill.SetColor(16777215),this.FAppearance.FDisabledFill.SetColor(13882323),this.FAppearance.FNormalStroke.SetColor(8421504),this.FAppearance.FInnerStroke.SetColor(16777215),this.FAppearance.FHoverStroke.SetColor(8421504),this.FAppearance.FDownStroke.SetColor(8421504),this.FAppearance.FDisabledStroke.SetColor(8421504),this.FAppearance.FNormalFill.SetKind(2),this.FAppearance.FHoverFill.SetKind(2),this.FAppearance.FDownFill.SetKind(2),this.FAppearance.FDisabledFill.SetKind(1),this.FAppearance.FNormalStroke.SetKind(1),this.FAppearance.FInnerStroke.SetKind(1),this.FAppearance.FHoverStroke.SetKind(1),this.FAppearance.FDownStroke.SetKind(1),this.FAppearance.FDisabledStroke.SetKind(1),this.FAppearance.FNormalFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(249,251,252)),this.FAppearance.FNormalFill.SetColorTo(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(230,235,235)),this.FAppearance.FNormalFill.SetColorMirror(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(220,220,236)),this.FAppearance.FNormalFill.SetColorMirrorTo(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(220,225,236)),this.FAppearance.FHoverFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,231,232)),this.FAppearance.FHoverFill.SetColorTo(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(210,215,215)),this.FAppearance.FHoverFill.SetColorMirror(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(200,200,216)),this.FAppearance.FHoverFill.SetColorMirrorTo(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(200,205,216)),this.FAppearance.FDownFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(219,221,222)),this.FAppearance.FDownFill.SetColorTo(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(200,205,205)),this.FAppearance.FDownFill.SetColorMirror(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(190,190,206)),this.FAppearance.FDownFill.SetColorMirrorTo(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(190,195,206))},this.SetAdaptToStyle=function(t){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetAdaptToStyle.apply(this,arguments),null!=this.FPopup&&this.FPopup.SetAdaptToStyle(this.GetAdaptToStyle())},this.BitmapsChanged=function(t){var e=null;e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FBitmaps,0,this.GetBitmapContainer()),this.SetBitmapVisible(null!=e&&!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(e)),this.FBitmapVisible||3!==this.FLayout||(e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FLargeLayoutBitmaps,0,this.GetBitmapContainer()),this.SetBitmapVisible(null!=e&&!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(e))),this.Invalidate()},this.DoFontChanged=function(t){this.Invalidate()},this.UpdateLayout=function(){var t=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),e=0;if(0!==this.FLayout&&!this.FBlockUpdate){this.FBlockUpdate=!0;var i=this.FLayout;1===i?(this.SetTextVisible(!1),this.SetBitmapPosition(0),this.SetStretchText(!1),this.SetHeight(Math.round(this.GetBitmapSize()+6)),this.SetWidth(Math.round(this.GetBitmapSize()+6))):2===i?(this.SetTextVisible(!0),this.SetBitmapPosition(0),this.SetStretchText(!1),t.$assign(this.GetTextSize()),this.FBitmapVisible?(this.SetHeight(Math.round(Math.max(this.GetBitmapSize(),t.cy)+6)),this.SetWidth(Math.round(this.GetBitmapSize()+t.cx+12))):this.FTextVisible&&""!==this.GetText()?(this.SetHeight(Math.round(t.cy+6)),this.SetWidth(Math.round(t.cx+6))):(this.SetWidth(75),this.SetHeight(24))):3===i&&(this.SetTextVisible(!0),this.SetBitmapPosition(1),this.SetStretchText(!this.FBitmapVisible),t.$assign(this.GetTextSize()),e=30,this.FBitmapVisible&&(e=Math.max(e,this.GetLargeLayoutBitmapSize()+6)),this.FTextVisible&&""!==this.GetText()&&(e=Math.max(e,t.cx+12)),this.SetWidth(Math.round(e)),-1!==this.FOldHeight&&this.SetHeight(Math.round(this.FOldHeight))),this.FBlockUpdate=!1,this.UpdateToolBar()}},this.DoClosePopup=function(t){null!=this.FOnCloseDropDown&&this.FOnCloseDropDown(this)},this.DoPopup=function(t){this.InitializePopup()},this.InitializePopup=function(){},this.UpdateState=function(){var e=0;t.TTMSFNCCustomToolBarElement.UpdateState.call(this);var i=this.FState;e=0===i?.8:1===i?1.25:1,0 in this.FComponentState||(this.SetDropDownWidth(this.FDropDownWidth*e),this.SetDropDownHeight(this.FDropDownHeight*e),this.FFont$1.SetSize(Math.round(this.FFont$1.FSize*e)),this.SetBounds(this.GetLeft(),this.GetTop(),Math.round(this.GetWidth()*e),Math.round(this.GetHeight()*e)))},this.AppearanceChanged=function(){this.Invalidate()},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null),1===e&&t===this.FDropDownControl&&(this.FDropDownControl=null)},this.SetName=function(t){var e;e=!(0 in this.FComponentState||this.FName!==this.GetText()||null!=this.FOwner&&pas.Classes.TComponent.isPrototypeOf(this.FOwner)&&0 in this.FOwner.FComponentState),pas["WEBLib.Controls"].TCustomControl.SetName.call(this,t),e&&this.FApplyName&&this.CanChangeText()&&this.SetText(pas.SysUtils.StringReplace(this.GetText(),"TMSFNCToolBar","",rtl.createSet(0)))},this.HandleMouseDown=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.CanFocus()&&this.SetFocus(),this.FDown=!0,this.Invalidate()},this.HandleMouseMove=function(t,e,i){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),this.FHover=!0,this.FPrevHover!==this.FHover&&this.Invalidate(),this.FPrevHover=this.FHover},this.HandleMouseUp=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),this.FDown=!1,this.Invalidate()},this.HandleKeyUp=function(t,e){if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyUp.apply(this,arguments),!rtl.neSet(e,{})){var i=t.get();13!==i&&115!==i||this.CanDropDown()&&this.DropDown()}},this.HandleKeyDown=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyDown.apply(this,arguments);var i=t.get();36===i?this.SelectFirstValue():35===i?this.SelectLastValue():38===i||37===i?this.SelectPreviousValue():40===i||39===i?this.SelectNextValue():32===i&&this.Click()},this.HandleKeyPress=function(t){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyPress.apply(this,arguments),t.get()>=" "&&!(t.get().charCodeAt()in rtl.createSet(113,13,32,27,36,35,38,37,40,39))&&this.SelectValueWithCharacter(t.get())},this.HandleMouseEnter=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseEnter.call(this)},this.HandleMouseLeave=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),this.FDown=!1,this.FHover=!1,this.FPrevHover=!1,this.Invalidate()},this.SelectFirstValue=function(){},this.SelectValueWithCharacter=function(t){},this.SelectLastValue=function(){},this.SelectNextValue=function(){},this.SelectPreviousValue=function(){},this.DrawText=function(t){var e,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(this.FTextVisible&&""!==this.GetText()){i.$assign(this.GetTextRect()),e=t.SaveState(!1);try{t.ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i)),t.FFont.Assign(this.FFont$1),this.FEnabled?(this.FDown||this.FDownState)&&-1!==this.FDownFontColor?t.FFont.SetColor(this.FDownFontColor):this.FHover&&-1!==this.FHoverFontColor&&t.FFont.SetColor(this.FHoverFontColor):-1!==this.FDisabledFontColor&&t.FFont.SetColor(this.FDisabledFontColor),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetText(),this.FWordWrapping,this.FHorizontalTextAlign,this.FVerticalTextAlign,this.FTrimming,0,-1,-1,!0,!1,-1,-1)}finally{t.RestoreState(e,!1)}}},this.DrawBitmap=function(e,i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=null,o=null,r=null,a=0,l=0;if(this.FBitmapVisible)if(s.$assign(this.GetBitmapRect$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))),t.TTMSFNCToolBarDropDownButton.isPrototypeOf(this)&&this.GetAdaptToStyle()){(n=pas["WEBLib.Graphics"].TBitmap.$create("Create$3")).SetSize(this.ScalePaintValue(7),this.ScalePaintValue(7)),r=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("Create$1",[n.GetCanvas(),!1]);try{r.BeginScene(),r.FStroke.SetKind(1),r.FStroke.SetColor(pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.DefaultSelectionFillColor);for(var h=this.ScalePaintValue(1),F=this.ScalePaintValue(5);h<=F&&(l=h,a=Math.max(0,l-this.ScalePaintValue(2)),r.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(a,l)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(n.GetWidth()-1-a,l)),2,2),!(a>=n.GetWidth()-1-a));h++);}finally{r.EndScene(),r=rtl.freeLoc(r)}try{o=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3");try{o.Assign(n),e.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),o,!0,!1,!0,!1)}finally{o=rtl.freeLoc(o)}}finally{n=rtl.freeLoc(n)}}else{e.FBitmapContainer=this.GetBitmapContainer(),3===this.FLayout?this.FEnabled?this.FHover&&this.FLargeLayoutHoverBitmaps.GetCount()>0?e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FLargeLayoutHoverBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1):this.FHover&&this.FHoverBitmaps.GetCount()>0?e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FHoverBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1):this.FLargeLayoutBitmaps.GetCount()>0?e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FLargeLayoutBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1):e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1):this.FLargeLayoutDisabledBitmaps.GetCount()>0?e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FLargeLayoutDisabledBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1):this.FDisabledBitmaps.GetCount()>0?e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FDisabledBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1):e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1):this.FEnabled?this.FHover&&this.FHoverBitmaps.GetCount()>0?e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FHoverBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1):e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1):this.FDisabledBitmaps.GetCount()>0?e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FDisabledBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1):e.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FBitmaps,this.FResourceScaleFactor,!0,!1,!0,!1)}},this.DrawButton=function(t){},this.CanDropDown=function(){return!1,!1},this.CanChangeText=function(){return!0,!0},this.GetTextRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(s.$assign(this.GetLocalRect()),e.$assign(this.GetBitmapRect()),i.$assign(this.GetDropDownRect()),this.FStretchText)t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+3,s.Top+3,i.Left-3,s.Bottom-3));else{var n=this.FBitmapPosition;0===n?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Right+3,s.Top+3,i.Left-3,s.Bottom-3)):1===n&&t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+3,e.Bottom+3,i.Left-3,s.Bottom-3))}return t},this.GetDropDownRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(this.GetLocalRect()),t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Right,e.Top,e.Right,e.Bottom)),t},this.GetBitmapRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(this.GetBitmapRect$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetLocalRect()))),t},this.GetBitmapRect$1=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;if(s=this.GetBitmapSize(),3===this.FLayout&&(s=this.GetLargeLayoutBitmapSize()),i.$assign(t),e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Left,i.Bottom)),this.FBitmapVisible){var n=this.FBitmapPosition;0===n?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+3,e.Top+3,e.Left+3+s,e.Bottom-3)):1===n&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+3,e.Top+3,e.Right-3,e.Top+3+s))}return e},this.GetBitmapSize=function(){var t=0,e=null;return t=this.FBitmapSize,this.FAutoBitmapSize&&(null==(e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FBitmaps,0,this.GetBitmapContainer()))||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(e)||(t=Math.max(e.GetHeight(),e.GetWidth()))),t},this.GetLargeLayoutBitmapSize=function(){var t=0,e=null;return t=this.FLargeLayoutBitmapSize,this.FLargeLayoutAutoBitmapSize&&(null==(e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FLargeLayoutBitmaps,0,this.GetBitmapContainer()))||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(e)||(t=Math.max(e.GetHeight(),e.GetWidth()))),t},this.Assign=function(e){t.TTMSFNCCustomToolBarElement.Assign.apply(this,arguments),t.TTMSFNCDefaultToolBarButton.isPrototypeOf(e)&&(this.FLayout=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FLayout,this.FCompactLayout=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FCompactLayout,this.FMinimumLayout=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FMinimumLayout,this.FMaximumLayout=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FMaximumLayout,this.FBitmapPosition=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FBitmapPosition,this.FBitmapSize=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FBitmapSize,this.FLargeLayoutBitmapSize=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FLargeLayoutBitmapSize,this.FAutoBitmapSize=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FAutoBitmapSize,this.FLargeLayoutAutoBitmapSize=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FLargeLayoutAutoBitmapSize,this.FStretchBitmapIfNoText=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FStretchBitmapIfNoText,this.FAppearance.Assign(rtl.as(e,t.TTMSFNCDefaultToolBarButton).FAppearance),this.FBitmapContainer=rtl.as(e,t.TTMSFNCDefaultToolBarButton).GetBitmapContainer(),this.FBitmaps.Assign(rtl.as(e,t.TTMSFNCDefaultToolBarButton).FBitmaps),this.FDisabledBitmaps.Assign(rtl.as(e,t.TTMSFNCDefaultToolBarButton).FDisabledBitmaps),this.FLargeLayoutHoverBitmaps.Assign(rtl.as(e,t.TTMSFNCDefaultToolBarButton).FLargeLayoutHoverBitmaps),this.FLargeLayoutBitmaps.Assign(rtl.as(e,t.TTMSFNCDefaultToolBarButton).FLargeLayoutBitmaps),this.FLargeLayoutDisabledBitmaps.Assign(rtl.as(e,t.TTMSFNCDefaultToolBarButton).FLargeLayoutDisabledBitmaps),this.FHoverBitmaps.Assign(rtl.as(e,t.TTMSFNCDefaultToolBarButton).FHoverBitmaps),this.FBitmapVisible=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FBitmapVisible,this.FText=rtl.as(e,t.TTMSFNCDefaultToolBarButton).GetText(),this.FTextVisible=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FTextVisible,this.FDropDownHeight=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FDropDownHeight,this.FDropDownWidth=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FDropDownWidth,this.FDropDownAutoWidth=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FDropDownAutoWidth,this.FWordWrapping=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FWordWrapping,this.FHorizontalTextAlign=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FHorizontalTextAlign,this.FVerticalTextAlign=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FVerticalTextAlign,this.FTrimming=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FTrimming,this.FFont$1.Assign(rtl.as(e,t.TTMSFNCDefaultToolBarButton).FFont$1),this.FHoverFontColor=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FHoverFontColor,this.FDownFontColor=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FDownFontColor,this.FDisabledFontColor=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FDisabledFontColor,this.FStretchText=rtl.as(e,t.TTMSFNCDefaultToolBarButton).FStretchText,this.Invalidate())},this.Create$1=function(e){return t.TTMSFNCCustomToolBarElement.Create$1.apply(this,arguments),this.FOldHeight=-1,this.FLayout=0,this.FCompactLayout=0,this.FMinimumLayout=1,this.FMaximumLayout=3,this.FFont$1=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont$1.FOnChanged=rtl.createCallback(this,"DoFontChanged"),this.FHoverFontColor=-1,this.FDownFontColor=-1,this.FDisabledFontColor=-1,this.FDownState=!1,this.FApplyName=!0,this.FCloseOnSelection=!0,this.FBitmapSize=24,this.FLargeLayoutBitmapSize=32,this.FAutoBitmapSize=!1,this.FLargeLayoutAutoBitmapSize=!1,this.FStretchBitmapIfNoText=!0,this.FStretchText=!1,this.FDropDownWidth=135,this.FDropDownHeight=135,this.FDropDownAutoWidth=!1,this.FPopup=pas["WEBLib.TMSFNCPopup"].TTMSFNCPopup.$create("Create$1",[this]),this.FPopup.SetDragWithParent(!0),this.FPopup.SetDropDownWidth(this.FDropDownWidth),this.FPopup.SetDropDownHeight(this.FDropDownHeight),this.FPopup.FOnPopup=rtl.createCallback(this,"DoPopup"),this.FPopup.FOnClosePopup=rtl.createCallback(this,"DoClosePopup"),this.FPopupPlacement=0,this.FBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FBitmaps.FOnChange=rtl.createCallback(this,"BitmapsChanged"),this.FDisabledBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FDisabledBitmaps.FOnChange=rtl.createCallback(this,"BitmapsChanged"),this.FHoverBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FHoverBitmaps.FOnChange=rtl.createCallback(this,"BitmapsChanged"),this.FLargeLayoutBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FLargeLayoutBitmaps.FOnChange=rtl.createCallback(this,"BitmapsChanged"),this.FLargeLayoutDisabledBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FLargeLayoutDisabledBitmaps.FOnChange=rtl.createCallback(this,"BitmapsChanged"),this.FLargeLayoutHoverBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FLargeLayoutHoverBitmaps.FOnChange=rtl.createCallback(this,"BitmapsChanged"),this.FAppearance=t.TTMSFNCToolBarButtonAppearance.$create("Create$1",[this]),this.FTextVisible=!0,this.FBitmapVisible=!1,this.FWordWrapping=!1,this.FHorizontalTextAlign=0,this.FVerticalTextAlign=0,this.FTrimming=1,this.FBitmapPosition=0,this.SetWidth(100),this.SetHeight(24),this},this.Destroy=function(){rtl.free(this,"FFont$1"),rtl.free(this,"FPopup"),rtl.free(this,"FBitmaps"),rtl.free(this,"FDisabledBitmaps"),rtl.free(this,"FHoverBitmaps"),rtl.free(this,"FLargeLayoutBitmaps"),rtl.free(this,"FLargeLayoutDisabledBitmaps"),rtl.free(this,"FLargeLayoutHoverBitmaps"),rtl.free(this,"FAppearance"),t.TTMSFNCCustomToolBarElement.Destroy.call(this)},this.Draw=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),this.FAppearance.FTransparent||(this.FEnabled?this.FDown||this.FDownState?(t.FFill.Assign(this.FAppearance.FDownFill),t.FStroke.Assign(this.FAppearance.FDownStroke)):this.FHover?(t.FFill.Assign(this.FAppearance.FHoverFill),t.FStroke.Assign(this.FAppearance.FHoverStroke)):(t.FFill.Assign(this.FAppearance.FNormalFill),t.FStroke.Assign(this.FAppearance.FNormalStroke)):(t.FFill.Assign(this.FAppearance.FDisabledFill),t.FStroke.Assign(this.FAppearance.FDisabledStroke)),i.$assign(this.GetLocalRect()),this.FAppearance.FFlatStyle?(t.FFill.SetKind(1),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),2)):t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FAppearance.FRounding,rtl.refSet(this.FAppearance.FCorners),2),this.FAppearance.FShowInnerStroke&&!this.FAppearance.FFlatStyle&&(pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-1,-1),t.FStroke.Assign(this.FAppearance.FInnerStroke),t.FFill.SetKind(0),t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FAppearance.FRounding,rtl.refSet(this.FAppearance.FCorners),2))),this.DrawBitmap(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),this.DrawText(t),this.DrawButton(t),this.FShowFocus$1&&this.IsFocused()&&(i.$assign(this.GetTextRect()),t.DrawFocusRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),0,2)),this.IsDesignTime()&&this.CanDrawDesignTime()&&t.DrawFocusRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),0,2)},this.DropDown=function(){null!=this.FPopup&&(this.FPopup.SetPlacementControl(this),this.FPopup.FIsOpen?this.FPopup.SetIsOpen(!1):(null!=this.FOnBeforeDropDown&&this.FOnBeforeDropDown(this),this.FDropDownAutoWidth&&this.FPopup.SetDropDownWidth(this.GetWidth()),this.FPopup.SetPlacement(this.FPopupPlacement),this.FPopup.SetIsOpen(!0),null!=this.FOnDropDown&&this.FOnDropDown(this)))},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),this.TTMSFNCToolBarButtonDropDownKind={0:"ddkNormal",ddkNormal:0,1:"ddkDropDown",ddkDropDown:1,2:"ddkDropDownButton",ddkDropDownButton:2},this.$rtti.$Enum("TTMSFNCToolBarButtonDropDownKind",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCToolBarButtonDropDownKind}),this.TTMSFNCToolBarButtonDropDownPosition={0:"ddpRight",ddpRight:0,1:"ddpBottom",ddpBottom:1},this.$rtti.$Enum("TTMSFNCToolBarButtonDropDownPosition",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCToolBarButtonDropDownPosition}),rtl.createClass(this,"TTMSFNCToolBarDropDownButton",this.TTMSFNCDefaultToolBarButton,(function(){this.$init=function(){t.TTMSFNCDefaultToolBarButton.$init.call(this),this.FDefaultStyle=!1},this.SetDefaultStyle=function(t){this.FDefaultStyle!==t&&(this.FDefaultStyle=t,this.Invalidate())},this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCToolBarDropDownButton)},this.DrawBitmap=function(e,i){var s=null,n=null,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=null;if(this.FDefaultStyle)o.$assign(i),null!=this.FOwner&&t.TTMSFNCCustomToolBarButton.isPrototypeOf(this.FOwner)&&1===rtl.as(this.FOwner,t.TTMSFNCCustomToolBarButton).FDropDownPosition||pas["WEBLib.TMSFNCTypes"].InflateRectEx(o,this.ScalePaintValue(-2),this.ScalePaintValue(-2)),t.TTMSFNCDefaultToolBarButton.DrawBitmap.call(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o));else{(n=pas["WEBLib.Graphics"].TBitmap.$create("Create$3")).SetSize(7,7),r=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("Create$1",[n.GetCanvas(),!1]);try{r.BeginScene(),r.FStroke.SetKind(1),r.FStroke.SetColor(11119017),r.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(0,1)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(6,1)),2,2),r.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(0,2)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(6,2)),2,2),r.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(1,3)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(5,3)),2,2),r.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(2,4)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(4,4)),2,2),r.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(3,5)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(3,5)),2,2)}finally{r.EndScene(),r=rtl.freeLoc(r)}try{o.$assign(i),s=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3");try{s.Assign(n),e.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),s,!0,!1,!0,!1)}finally{s=rtl.freeLoc(s)}}finally{n=rtl.freeLoc(n)}}},this.GetBitmapRect$1=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return i.$assign(t),e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+3,i.Top+3,i.Right-3,i.Bottom-3)),e},this.Create$1=function(e){return t.TTMSFNCDefaultToolBarButton.Create$1.apply(this,arguments),this.FDefaultStyle=!0,this},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("DefaultStyle",2,rtl.boolean,"FDefaultStyle","SetDefaultStyle",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont$1","SetFont$1"),e.addProperty("Text",3,rtl.string,"GetText","SetText"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus$1","SetShowFocus$1",{Default:!1}),e.addProperty("TextVisible",2,rtl.boolean,"FTextVisible","SetTextVisible",{Default:!0}),e.addProperty("StretchText",2,rtl.boolean,"FStretchText","SetStretchText",{Default:!1}),e.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!1}),e.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttCharacter}),e.addProperty("Bitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FBitmaps","SetBitmaps"),e.addProperty("DisabledBitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FDisabledBitmaps","SetDisabledBitmaps"),e.addProperty("HoverBitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FHoverBitmaps","SetHoverBitmaps"),e.addProperty("BitmapVisible",2,rtl.boolean,"FBitmapVisible","SetBitmapVisible",{Default:!1}),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("State",2,t.$rtti.TTMSFNCToolBarElementState,"FState","SetState",{Default:t.TTMSFNCToolBarElementState.esNormal}),e.addProperty("LastElement",2,rtl.boolean,"FLastElement","SetLastElement",{Default:!1}),e.addProperty("Appearance",2,t.$rtti.TTMSFNCToolBarButtonAppearance,"FAppearance","SetAppearance")})),rtl.createClass(this,"TTMSFNCCustomToolBarButton",this.TTMSFNCDefaultToolBarButton,(function(){this.$init=function(){t.TTMSFNCDefaultToolBarButton.$init.call(this),this.FDropDownButton=null,this.FDropDownKind=0,this.FDropDownPosition=0,this.FHidden=!1,this.FAutoOptionsMenuText=""},this.$final=function(){this.FDropDownButton=void 0,t.TTMSFNCDefaultToolBarButton.$final.call(this)},this.SetDropDownKind=function(t){if(this.FDropDownKind!==t){if(this.FDropDownKind=t,null!=this.FDropDownButton){var e=this.FDropDownKind;0===e?(this.FDropDownButton.SetVisible(!1),this.FDropDownButton.SetParent(null),this.FDropDownButton.FAppearance.SetTransparent(!1)):1===e?(this.FDropDownButton.SetVisible(!1),this.FDropDownButton.SetParent(this),this.FDropDownButton.FAppearance.SetTransparent(!0)):2===e&&(this.FDropDownButton.SetVisible(!0),this.FDropDownButton.SetParent(this),this.FDropDownButton.FAppearance.SetTransparent(!1))}this.Invalidate()}},this.SetDropDownPosition=function(t){var e=0;if(this.FDropDownPosition!==t&&(e=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(this,96),this.FDropDownPosition=t,null!=this.FDropDownButton)){var i=t;0===i?(this.FDropDownButton.SetAlign(4),this.FDropDownButton.SetWidth(Math.round(17*e)),this.FDropDownButton.FAppearance.SetCorners(rtl.createSet(1,3))):1===i&&(this.FDropDownButton.SetAlign(2),this.FDropDownButton.SetHeight(Math.round(10*e)),this.FDropDownButton.FAppearance.SetCorners(rtl.createSet(2,3)))}},this.SetAdaptToStyle=function(e){t.TTMSFNCDefaultToolBarButton.SetAdaptToStyle.apply(this,arguments),null!=this.FDropDownButton&&this.FDropDownButton.SetAdaptToStyle(this.GetAdaptToStyle())},this.AppearanceChanged=function(){t.TTMSFNCDefaultToolBarButton.AppearanceChanged.call(this),this.UpdateDropDownButton()},this.UpdateDropDownButton=function(){null!=this.FDropDownButton&&this.FDropDownButton.FAppearance.SetRounding(this.FAppearance.FRounding)},this.HandleMouseDown=function(e,i,s,n){t.TTMSFNCDefaultToolBarButton.HandleMouseDown.apply(this,arguments),1===this.FDropDownKind&&this.DropDown()},this.DropDownButtonClick=function(t){this.DropDown()},this.DrawButton=function(e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(t.TTMSFNCDefaultToolBarButton.DrawButton.apply(this,arguments),null!=this.FDropDownButton&&1===this.FDropDownKind){var s=this.FDropDownPosition;0===s?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.GetWidth()-this.FDropDownButton.GetWidth(),0,this.GetWidth(),this.GetHeight())):1===s&&i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,this.GetHeight()-this.FDropDownButton.GetHeight(),this.GetWidth(),this.GetHeight())),this.FDropDownButton.DrawBitmap(e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))}},this.SetEnabled=function(t){var e=null;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetEnabled.apply(this,arguments),null!=(e=this.GetDropDownButtonControl())&&e.SetEnabled(t)},this.GetDropDownButtonClass=function(){return t.TTMSFNCToolBarDropDownButton},this.GetDropDownRect=function(){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(e.$assign(t.TTMSFNCDefaultToolBarButton.GetDropDownRect.call(this)),null!=this.FDropDownButton&&0!==this.FDropDownKind)if(1===this.FDropDownKind){var i=this.FDropDownPosition;0===i?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.GetWidth()-this.FDropDownButton.GetWidth(),0,this.GetWidth(),this.GetHeight())):1===i&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,this.GetHeight()-this.FDropDownButton.GetHeight(),this.GetWidth(),this.GetHeight()))}else e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FDropDownButton.GetLeft(),this.FDropDownButton.GetTop(),this.FDropDownButton.GetLeft()+this.FDropDownButton.GetWidth(),this.FDropDownButton.GetTop()+this.FDropDownButton.GetHeight()));return e},this.GetTextRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(s.$assign(this.GetLocalRect()),e.$assign(this.GetBitmapRect$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s))),i.$assign(this.GetDropDownRect()),0!==this.FDropDownKind)if(this.FStretchText){var n=this.FDropDownPosition;0===n?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+3,s.Top+3,i.Left-3,s.Bottom-3)):1===n&&t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+3,s.Top+3,s.Right-3,i.Top-3))}else{var o=this.FBitmapPosition;if(0===o){var r=this.FDropDownPosition;0===r?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Right+3,s.Top+3,i.Left-3,s.Bottom-3)):1===r&&t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Right+3,s.Top+3,s.Right-3,i.Top-3))}else if(1===o){var a=this.FDropDownPosition;0===a?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+3,e.Bottom+3,i.Left-3,s.Bottom-3)):1===a&&t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+3,e.Bottom+3,s.Right-3,i.Top-3))}}else if(this.FStretchText)t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+3,s.Top+3,i.Left-3,s.Bottom-3));else{var l=this.FBitmapPosition;0===l?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Right+3,s.Top+3,i.Left-3,s.Bottom-3)):1===l&&t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+3,e.Bottom+3,i.Left-3,s.Bottom-3))}return t},this.GetBitmapRect$1=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=0;if(n=this.GetBitmapSize(),3===this.FLayout&&(n=this.GetLargeLayoutBitmapSize()),i.$assign(t),e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Left,i.Bottom)),this.FBitmapVisible)if(0!==this.FDropDownKind){s.$assign(this.GetDropDownRect());var o=this.FBitmapPosition;if(0===o){var r=this.FDropDownPosition;0===r?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+3,e.Top+3,e.Left+3+n,e.Bottom-3)):1===r&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+3,e.Top+3,e.Left+3+n,s.Top-3))}else if(1===o){var a=this.FDropDownPosition;0===a?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+3,e.Top+3,s.Left-3,e.Top+3+n)):1===a&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+3,e.Top+3,i.Right-3,e.Top+3+n))}}else if(this.FTextVisible&&""!==this.GetText()){if(this.FTextVisible&&""!==this.GetText()){var l=this.FBitmapPosition;0===l?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+3,i.Top+3,i.Left+3+n,i.Bottom-3)):1===l&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+3,i.Top+3,i.Right-3,i.Top+3+n))}}else e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+3,i.Top+3,i.Right-3,i.Bottom-3)),-1===n||this.FStretchBitmapIfNoText||(e.Left=Math.round(i.Left+(i.Right-i.Left-n)/2),e.Top=Math.round(i.Top+(i.Bottom-i.Top-n)/2),e.Right=e.Left+n,e.Bottom=e.Top+n);return e},this.GetBitmapRect=function(){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(t.TTMSFNCDefaultToolBarButton.GetBitmapRect.call(this)),e},this.CanDropDown=function(){return 0!==this.FDropDownKind},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this)},this.Assign=function(e){t.TTMSFNCDefaultToolBarButton.Assign.apply(this,arguments),t.TTMSFNCCustomToolBarButton.isPrototypeOf(e)&&(this.FDropDownKind=rtl.as(e,t.TTMSFNCCustomToolBarButton).FDropDownKind,this.FDropDownPosition=rtl.as(e,t.TTMSFNCCustomToolBarButton).FDropDownPosition,this.FAutoOptionsMenuText=rtl.as(e,t.TTMSFNCCustomToolBarButton).FAutoOptionsMenuText,this.FHidden=rtl.as(e,t.TTMSFNCCustomToolBarButton).FHidden,this.Invalidate())},this.Create$1=function(e){var i="";return t.TTMSFNCDefaultToolBarButton.Create$1.apply(this,arguments),this.FHidden=!1,this.FDropDownPosition=0,this.FDropDownButton=this.GetDropDownButtonClass().$create("Create$1",[this]),this.FDropDownButton.SetTabStop(!1),this.FDropDownButton.SetText(""),this.FDropDownButton.FOnClick=rtl.createCallback(this,"DropDownButtonClick"),this.FDropDownButton.SetVisible(!1),this.FDropDownButton.SetWidth(17),this.FDropDownButton.FAppearance.SetCorners(rtl.createSet(1,3)),this.FDropDownButton.SetAlign(4),this.FDropDownButton.FStored=!1,i=t.TMSFNCTOOLBAREXPANDSVG,this.FDropDownButton.FBitmaps.AddBitmapFromResource$1(i,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this.FDropDownButton.FDisabledBitmaps.AddBitmapFromResource$1(i,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this.FDropDownButton.FHoverBitmaps.AddBitmapFromResource$1(i,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this},this.Destroy=function(){rtl.free(this,"FDropDownButton"),t.TTMSFNCDefaultToolBarButton.Destroy.call(this)},this.GetDropDownButtonControl=function(){return this.FDropDownButton},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCToolBarButton",this.TTMSFNCCustomToolBarButton,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCToolBarButton)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont$1","SetFont$1"),e.addProperty("AutoOptionsMenuText",0,rtl.string,"FAutoOptionsMenuText","FAutoOptionsMenuText"),e.addProperty("DropDownAutoWidth",2,rtl.boolean,"FDropDownAutoWidth","SetDropDownAutoWidth",{Default:!1}),e.addProperty("DropDownKind",2,t.$rtti.TTMSFNCToolBarButtonDropDownKind,"FDropDownKind","SetDropDownKind",{Default:t.TTMSFNCToolBarButtonDropDownKind.ddkNormal}),e.addProperty("DropDownPosition",2,t.$rtti.TTMSFNCToolBarButtonDropDownPosition,"FDropDownPosition","SetDropDownPosition",{Default:t.TTMSFNCToolBarButtonDropDownPosition.ddpRight}),e.addProperty("DropDownHeight",14,rtl.double,"FDropDownHeight","SetDropDownHeight",{stored:"IsDropDownHeightStored"}),e.addProperty("DropDownWidth",14,rtl.double,"FDropDownWidth","SetDropDownWidth",{stored:"IsDropDownWidthStored"}),e.addProperty("DropDownControl",2,pas["WEBLib.Controls"].$rtti.TControl,"FDropDownControl","SetDropDownControl"),e.addProperty("OnBeforeDropDown",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnBeforeDropDown","FOnBeforeDropDown"),e.addProperty("OnDropDown",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDropDown","FOnDropDown"),e.addProperty("OnCloseDropDown",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnCloseDropDown","FOnCloseDropDown"),e.addProperty("Text",3,rtl.string,"GetText","SetText"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus$1","SetShowFocus$1",{Default:!1}),e.addProperty("TextVisible",2,rtl.boolean,"FTextVisible","SetTextVisible",{Default:!0}),e.addProperty("StretchText",2,rtl.boolean,"FStretchText","SetStretchText",{Default:!1}),e.addProperty("StretchBitmapIfNoText",2,rtl.boolean,"FStretchBitmapIfNoText","SetStretchBitmapIfNoText",{Default:!0}),e.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttCharacter}),e.addProperty("Bitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FBitmaps","SetBitmaps"),e.addProperty("LargeLayoutBitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FLargeLayoutBitmaps","SetLargeLayoutBitmaps"),e.addProperty("Layout",2,t.$rtti.TTMSFNCToolBarButtonLayout,"FLayout","SetLayout",{Default:t.TTMSFNCToolBarButtonLayout.bblNone}),e.addProperty("CompactLayout",2,t.$rtti.TTMSFNCToolBarButtonLayout,"FCompactLayout","SetCompactLayout",{Default:t.TTMSFNCToolBarButtonLayout.bblNone}),e.addProperty("MinimumLayout",2,t.$rtti.TTMSFNCToolBarButtonLayout,"FMinimumLayout","SetMinimumLayout",{Default:t.TTMSFNCToolBarButtonLayout.bblBitmap}),e.addProperty("MaximumLayout",2,t.$rtti.TTMSFNCToolBarButtonLayout,"FMaximumLayout","SetMaximumLayout",{Default:t.TTMSFNCToolBarButtonLayout.bblLarge}),e.addProperty("BitmapPosition",2,t.$rtti.TTMSFNCToolBarButtonBitmapPosition,"FBitmapPosition","SetBitmapPosition",{Default:t.TTMSFNCToolBarButtonBitmapPosition.bbpLeft}),e.addProperty("DisabledBitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FDisabledBitmaps","SetDisabledBitmaps"),e.addProperty("HoverBitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FHoverBitmaps","SetHoverBitmaps"),e.addProperty("LargeLayoutDisabledBitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FLargeLayoutDisabledBitmaps","SetLargeLayoutDisabledBitmaps"),e.addProperty("LargeLayoutHoverBitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FLargeLayoutHoverBitmaps","SetLargeLayoutHoverBitmaps"),e.addProperty("BitmapVisible",2,rtl.boolean,"FBitmapVisible","SetBitmapVisible",{Default:!1}),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("BitmapSize",14,rtl.double,"FBitmapSize","SetBitmapSize",{stored:"IsBitmapSizeStored"}),e.addProperty("AutoBitmapSize",2,rtl.boolean,"FAutoBitmapSize","SetAutoBitmapSize",{Default:!1}),e.addProperty("LargeLayoutBitmapSize",14,rtl.double,"FLargeLayoutBitmapSize","SetLargeLayoutBitmapSize",{stored:"IsLargeLayoutBitmapSizeStored"}),e.addProperty("LargeLayoutAutoBitmapSize",2,rtl.boolean,"FLargeLayoutAutoBitmapSize","SetLargeLayoutAutoBitmapSize",{Default:!1}),e.addProperty("State",2,t.$rtti.TTMSFNCToolBarElementState,"FState","SetState",{Default:t.TTMSFNCToolBarElementState.esNormal}),e.addProperty("LastElement",2,rtl.boolean,"FLastElement","SetLastElement",{Default:!1}),e.addProperty("Appearance",2,t.$rtti.TTMSFNCToolBarButtonAppearance,"FAppearance","SetAppearance"),e.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!1}),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),rtl.createClass(this,"TTMSFNCCustomToolBarAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FFill=null,this.FStroke=null,this.FVerticalSpacing=0,this.FHorizontalSpacing=0,this.FDragGripColor=0,this.FDragGrip=!1,this.FFlatStyle=!1,this.FFont=null,this.FSeparatorStroke=null,this.FSeparator=!1},this.$final=function(){this.FOwner=void 0,this.FFill=void 0,this.FStroke=void 0,this.FFont=void 0,this.FSeparatorStroke=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.SetHorizontalSpacing=function(t){this.FHorizontalSpacing!==t&&(this.FHorizontalSpacing=t,this.FOwner.UpdateControls())},this.SetVerticalSpacing=function(t){this.FVerticalSpacing!==t&&(this.FVerticalSpacing=t,this.FOwner.UpdateControls())},this.SetDragGrip=function(t){this.FDragGrip!==t&&(this.FDragGrip=t,this.FOwner.UpdateControls())},this.SetDragGripColor=function(t){this.FDragGripColor!==t&&(this.FDragGripColor=t,this.FOwner.Invalidate())},this.IsHorizontalSpacingStored=function(){return 3!==this.FHorizontalSpacing},this.IsVerticalSpacingStored=function(){return 3!==this.FVerticalSpacing},this.SetFlatStyle=function(t){this.FFlatStyle!==t&&(this.FFlatStyle=t,null!=this.FOwner&&this.FOwner.ApplyFlatStyle())},this.SetSeparator=function(t){this.FSeparator!==t&&(this.FSeparator=t,this.FOwner.Invalidate())},this.SetSeparatorStroke=function(t){this.FSeparatorStroke.Assign(t)},this.FillChanged=function(t){this.FOwner.Invalidate()},this.StrokeChanged=function(t){this.FOwner.Invalidate()},this.Assign=function(e){t.TTMSFNCCustomToolBarAppearance.isPrototypeOf(e)&&(this.FSeparatorStroke.Assign(rtl.as(e,t.TTMSFNCCustomToolBarAppearance).FSeparatorStroke),this.FSeparator=rtl.as(e,t.TTMSFNCCustomToolBarAppearance).FSeparator,this.FFill.Assign(rtl.as(e,t.TTMSFNCCustomToolBarAppearance).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCCustomToolBarAppearance).FStroke),this.FHorizontalSpacing=rtl.as(e,t.TTMSFNCCustomToolBarAppearance).FHorizontalSpacing,this.FVerticalSpacing=rtl.as(e,t.TTMSFNCCustomToolBarAppearance).FVerticalSpacing,this.FDragGripColor=rtl.as(e,t.TTMSFNCCustomToolBarAppearance).FDragGripColor,this.FDragGrip=rtl.as(e,t.TTMSFNCCustomToolBarAppearance).FDragGrip,this.FFlatStyle=rtl.as(e,t.TTMSFNCCustomToolBarAppearance).FFlatStyle)},this.Create$1=function(t){return this.FOwner=t,this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFlatStyle=!1,this.FHorizontalSpacing=3,this.FVerticalSpacing=3,this.FDragGrip=!0,this.FDragGripColor=13882323,this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[2,16777215,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(230,230,230),-1,-1]),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,8421504]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FSeparatorStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,16777215]),this.FSeparatorStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this},this.Destroy=function(){rtl.free(this,"FSeparatorStroke"),rtl.free(this,"FFont"),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TTMSFNCToolBarAppearance",this.TTMSFNCCustomToolBarAppearance,(function(){var t=this.$rtti;t.addProperty("FlatStyle",2,rtl.boolean,"FFlatStyle","SetFlatStyle",{Default:!1}),t.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),t.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),t.addProperty("Separator",2,rtl.boolean,"FSeparator","SetSeparator",{Default:!1}),t.addProperty("SeparatorStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FSeparatorStroke","SetSeparatorStroke"),t.addProperty("HorizontalSpacing",14,rtl.double,"FHorizontalSpacing","SetHorizontalSpacing",{stored:"IsHorizontalSpacingStored"}),t.addProperty("VerticalSpacing",14,rtl.double,"FVerticalSpacing","SetVerticalSpacing",{stored:"IsVerticalSpacingStored"}),t.addProperty("DragGrip",2,rtl.boolean,"FDragGrip","SetDragGrip",{Default:!0}),t.addProperty("DragGripColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDragGripColor","SetDragGripColor",{Default:13882323})})),rtl.createClass(this,"TTMSFNCToolBarControl",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FControlIndex=0,this.FControl=null,this.FLayout=0,this.FBitmap=null},this.$final=function(){this.FControl=void 0,this.FBitmap=void 0,pas.Classes.TPersistent.$final.call(this)},this.Create$1=function(){return this.FBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this},this.Destroy=function(){rtl.free(this,"FBitmap"),pas.System.TObject.Destroy.call(this)}})),this.$rtti.$MethodVar("TTMSFNCToolBarCustomizeOptionsMenu",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["APopupMenu",pas["WEBLib.Menus"].$rtti.TPopupMenu]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCToolBarCustomizeOptionsMenuItem",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AControl",pas["WEBLib.Controls"].$rtti.TControl],["AMenuItem",pas["WEBLib.Menus"].$rtti.TMenuItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCToolBarCanShowOptionsMenuItem",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AControl",pas["WEBLib.Controls"].$rtti.TControl],["ACanShowItem",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCToolBarOptionsMenuItemClick",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AControl",pas["WEBLib.Controls"].$rtti.TControl],["AMenuItem",pas["WEBLib.Menus"].$rtti.TMenuItem],["AExecuteDefaultAction",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCToolBarIsLastElement",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AControl",pas["WEBLib.Controls"].$rtti.TControl],["AIsLastElement",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCToolBarAnchorClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AAnchor",rtl.string]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomToolBarOptionsMenu",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FShowItemText=!1,this.FShowItemBitmap=!1,this.FShowButton=!1,this.FItemBitmapWidth=0,this.FAutoItemBitmapWidth=!1},this.$final=function(){this.FOwner=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetShowButton=function(t){this.FShowButton!==t&&(this.FShowButton=t,this.FOwner.FOptionsMenuButton.SetVisible(this.FShowButton),this.FShowButton?this.FOwner.FOptionsMenuButton.SetParent(this.FOwner):this.FOwner.FOptionsMenuButton.SetParent(null),this.FOwner.UpdateControls())},this.SetShowItemBitmap=function(t){this.FShowItemBitmap!==t&&(this.FShowItemBitmap=t)},this.SetShowItemText=function(t){this.FShowItemText!==t&&(this.FShowItemText=t)},this.SetAutoItemBitmapWidth=function(t){this.FAutoItemBitmapWidth!==t&&(this.FAutoItemBitmapWidth=t)},this.SetItemBitmapWidth=function(t){this.FItemBitmapWidth!==t&&(this.FItemBitmapWidth=t)},this.IsItemBitmapWidthStored=function(){return 50!==this.FItemBitmapWidth},this.Assign=function(e){t.TTMSFNCCustomToolBarOptionsMenu.isPrototypeOf(e)&&(this.FShowItemText=rtl.as(e,t.TTMSFNCCustomToolBarOptionsMenu).FShowItemText,this.FShowItemBitmap=rtl.as(e,t.TTMSFNCCustomToolBarOptionsMenu).FShowItemBitmap,this.FShowButton=rtl.as(e,t.TTMSFNCCustomToolBarOptionsMenu).FShowButton,this.FAutoItemBitmapWidth=rtl.as(e,t.TTMSFNCCustomToolBarOptionsMenu).FAutoItemBitmapWidth,this.FItemBitmapWidth=rtl.as(e,t.TTMSFNCCustomToolBarOptionsMenu).FItemBitmapWidth)},this.Create$1=function(t){return this.FOwner=t,this.FShowItemText=!0,this.FShowButton=!0,this.FShowItemBitmap=!0,this.FAutoItemBitmapWidth=!0,this.FItemBitmapWidth=50,this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TTMSFNCToolBarOptionsMenu",this.TTMSFNCCustomToolBarOptionsMenu,(function(){var t=this.$rtti;t.addProperty("ShowButton",2,rtl.boolean,"FShowButton","SetShowButton",{Default:!0}),t.addProperty("ShowItemBitmap",2,rtl.boolean,"FShowItemBitmap","SetShowItemBitmap",{Default:!0}),t.addProperty("ShowItemText",2,rtl.boolean,"FShowItemText","SetShowItemText",{Default:!0}),t.addProperty("AutoItemBitmapWidth",2,rtl.boolean,"FAutoItemBitmapWidth","SetAutoItemBitmapWidth",{Default:!0}),t.addProperty("ItemBitmapWidth",14,rtl.double,"FItemBitmapWidth","SetItemBitmapWidth",{stored:"IsItemBitmapWidthStored"})})),rtl.createClass(this,"TTMSFNCToolBarControlObjectList",pas.contnrs.TObjectList,(function(){this.GetItem$1=function(t){return this.GetItem(t)}})),rtl.createClass(this,"TTMSFNCToolBarControlList",pas.Classes.TList,(function(){this.GetItem=function(t){return rtl.getObject(this.Get(t))}})),this.$rtti.$MethodVar("TTMSFNCToolBarDragGripMovingEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["DeltaX",rtl.double],["DeltaY",rtl.double]]),methodkind:0}),rtl.createClass(this,"TTMSFNCToolBarPopup",pas["WEBLib.TMSFNCPopup"].TTMSFNCPopup,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCCustomToolBar",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FCompactToolbar=null,this.FCompactPopup=null,this.FHover=!1,this.FHoverP=!1,this.FQuickMenuButtonHover=!1,this.FQuickMenuButtonHoverP=!1,this.FDown=!1,this.FQuickMenuButtonDown=!1,this.FOldWidth=0,this.FOldMenuButtonState=!1,this.FBitmapContainer=null,this.FInsideDrag=!1,this.FDragGripMoving=!1,this.FDragGripDown=!1,this.FDragGripDownPt=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),this.FHiddenControls=null,this.FCompactControls=null,this.FBlockUpdate=!1,this.FBlockResize=!1,this.FAutoSize=!1,this.FAppearance=null,this.FAutoAlign=!1,this.FOptionsMenuButton=null,this.FAutoOptionsMenu=null,this.FOnOptionsMenuCustomize=null,this.FOnOptionsMenuItemCustomize=null,this.FOnOptionsMenuButtonClick=null,this.FOptionsMenu=null,this.FCustomOptionsMenu=null,this.FOnOptionsMenuItemCanShow=null,this.FState=0,this.FOnOptionsMenuItemClick=null,this.FOnOptionsMenuItemApplyStyle=null,this.FOnUpdateDockPanel=null,this.FOnUpdateControls=null,this.FOnIsLastElement=null,this.FOnDragGripMoving=null,this.FAutoMoveToolBar=!1,this.FOnInternalDblClick$1=null,this.FOnInternalMouseDown$1=null,this.FOnInternalMouseMove$1=null,this.FOnInternalMouseUp$1=null,this.FAutoHeight=!1,this.FAutoWidth=!1,this.FOnInternalInsertControl=null,this.FAutoStretchHeight=!1,this.FText="",this.FFont$1=null,this.FVerticalTextAlign=0,this.FTrimming=0,this.FHorizontalTextAlign=0,this.FWordWrapping=!1,this.FTextVisible=!1,this.FMinimumWidth=0,this.FCompact=!1,this.FCanCompact=!1,this.FCompactWidth=0,this.FCompactAppearance=null,this.FCompactBitmaps=null,this.FOnCompactClick=null,this.FCompactBitmapSize=0,this.FCompactBitmapVisible=!1,this.FCompactExpanderBitmaps=null,this.FQuickMenuButton=!1,this.FQuickMenuButtonAppearance=null,this.FOnQuickMenuButtonClick=null,this.FQuickMenuButtonBitmaps=null,this.FQuickMenuButtonHint="",this.FCompactAutoBitmapSize=!1,this.FOnAnchorClick=null},this.$final=function(){this.FCompactToolbar=void 0,this.FCompactPopup=void 0,this.FBitmapContainer=void 0,this.FDragGripDownPt=void 0,this.FHiddenControls=void 0,this.FCompactControls=void 0,this.FAppearance=void 0,this.FOptionsMenuButton=void 0,this.FAutoOptionsMenu=void 0,this.FOnOptionsMenuCustomize=void 0,this.FOnOptionsMenuItemCustomize=void 0,this.FOnOptionsMenuButtonClick=void 0,this.FOptionsMenu=void 0,this.FCustomOptionsMenu=void 0,this.FOnOptionsMenuItemCanShow=void 0,this.FOnOptionsMenuItemClick=void 0,this.FOnOptionsMenuItemApplyStyle=void 0,this.FOnUpdateDockPanel=void 0,this.FOnUpdateControls=void 0,this.FOnIsLastElement=void 0,this.FOnDragGripMoving=void 0,this.FOnInternalDblClick$1=void 0,this.FOnInternalMouseDown$1=void 0,this.FOnInternalMouseMove$1=void 0,this.FOnInternalMouseUp$1=void 0,this.FOnInternalInsertControl=void 0,this.FFont$1=void 0,this.FCompactAppearance=void 0,this.FCompactBitmaps=void 0,this.FOnCompactClick=void 0,this.FCompactExpanderBitmaps=void 0,this.FQuickMenuButtonAppearance=void 0,this.FOnQuickMenuButtonClick=void 0,this.FQuickMenuButtonBitmaps=void 0,this.FOnAnchorClick=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetAppearance=function(t){this.FAppearance.Assign(t)},this.SetAS=function(t){this.FAutoSize!==t&&(this.FAutoSize=t,this.UpdateControls())},this.SetAutoAlign=function(t){this.FAutoAlign!==t&&(this.FAutoAlign=t,this.UpdateControls())},this.SetOptionsMenu=function(t){this.FOptionsMenu.Assign(t)},this.SetState=function(e){var i=0,s=null;if(this.FState!==e){this.FState=e;for(var n=0,o=this.GetControlsCount()-1;n<=o;n++)i=n,s=this.GetControls(i),t.TTMSFNCCustomToolBarElement.isPrototypeOf(s)&&rtl.as(s,t.TTMSFNCCustomToolBarElement).SetState(this.FState)}},this.SetAutoHeight=function(t){this.FAutoHeight!==t&&(this.FAutoHeight=t,this.UpdateControls())},this.SetAutoWidth=function(t){this.FAutoWidth!==t&&(this.FAutoWidth=t,this.UpdateControls())},this.SetAutoStretchHeight=function(t){this.FAutoStretchHeight!==t&&(this.FAutoStretchHeight=t,this.UpdateControls())},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.UpdateControls())},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetFont$1=function(t){this.FFont$1.Assign(t)},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t,this.Invalidate())},this.SetTrimming=function(t){this.FTrimming!==t&&(this.FTrimming=t,this.UpdateControls())},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,this.UpdateControls())},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,this.UpdateControls())},this.IsMinimumWidthStored=function(){return 30!==this.FMinimumWidth},this.SetMinimumWidth=function(t){this.FMinimumWidth!==t&&(this.FMinimumWidth=t,this.UpdateControls())},this.SetCompact=function(t){this.FCompact!==t&&this.FCanCompact&&(this.FCompact=t,this.FCompact?(this.FOldMenuButtonState=this.FOptionsMenu.FShowButton,this.FOptionsMenu.SetShowButton(!1),this.FOldWidth=this.GetWidth(),this.CompactControls(),this.SetWidth(Math.round(this.FCompactWidth))):(this.SetWidth(Math.round(this.FOldWidth)),this.UncompactControls(),this.FOptionsMenu.SetShowButton(this.FOldMenuButtonState)),this.UpdateControls())},this.SetCanCompact=function(t){this.FCanCompact!==t&&(this.FCanCompact=t)},this.IsCompactWidthStored=function(){return 50!==this.FCompactWidth},this.SetCompactWidth=function(t){this.FCompactWidth!==t&&(this.FCompactWidth=t,this.FCompact&&this.SetWidth(Math.round(this.FCompactWidth)))},this.SetCompactAppearance=function(t){this.FCompactAppearance.Assign(t)},this.SetCompactBitmaps=function(t){this.FCompactBitmaps.Assign(t)},this.IsCompactBitmapSizeStored=function(){return 24!==this.FCompactBitmapSize},this.SetCompactBitmapSize=function(t){this.FCompactBitmapSize!==t&&(this.FCompactBitmapSize=t,this.Invalidate())},this.SetCompactBitmapVisible=function(t){this.FCompactBitmapVisible!==t&&(this.FCompactBitmapVisible=t,this.Invalidate())},this.SetQuickMenuButton=function(t){this.FQuickMenuButton!==t&&(this.FQuickMenuButton=t,this.Invalidate())},this.SetQuickMenuButtonAppearance=function(t){this.FQuickMenuButtonAppearance.Assign(t)},this.SetCompactAutoBitmapSize=function(t){this.FCompactAutoBitmapSize!==t&&(this.FCompactAutoBitmapSize=t,this.Invalidate())},this.GetTextRect=function(){var t,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;return s=0,this.FAppearance.FDragGrip&&(s=1===this.FState?3:2),i.$assign(this.GetLocalRect()),i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+this.ScalePaintValue$1(s),i.Top,i.Right,i.Bottom)),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,this.ScalePaintValue(-2),this.ScalePaintValue(-2)),t=this.GetTextSize().cy,e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Bottom-t,i.Right,i.Bottom)),e},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,2,1)},this.CanDrawDesignTime=function(){return!1,!1},this.CanBuildControls=function(){return!0,!0},this.GetOptionsMenuButtonClass=function(){return t.TTMSFNCToolBarDropDownButton},this.GetToolBarButtonClass=function(){return t.TTMSFNCToolBarButton},this.GetTextSize=function(){var t=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),e=null,i=0,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(t.cx=0,t.cy=0,this.FTextVisible&&""!==this.FText){e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,this.FNativeCanvas,!0]),this.FNativeCanvas||e.BeginScene(),e.FBitmapContainer=this.GetBitmapContainer(),e.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing;try{i=0,this.FAppearance.FDragGrip&&(i=1===this.FState?3:2),e.FFont.Assign(this.FFont$1),s.$assign(this.GetLocalRect()),s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+i,s.Top,s.Right,s.Bottom)),pas["WEBLib.TMSFNCTypes"].InflateRectEx(s,-2,-2),t.$assign(e.CalculateTextSize(this.FText,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FWordWrapping,!0))}finally{this.FNativeCanvas||e.EndScene(),e=rtl.freeLoc(e)}}return t},this.GetHiddenControl=function(t){var e=null,i=0;e=null;for(var s=0,n=this.FHiddenControls.GetCount()-1;s<=n;s++)if(i=s,this.FHiddenControls.GetItem$1(i).FControl===t){e=this.FHiddenControls.GetItem$1(i);break}return e},this.GetHiddenControlCount=function(e){var i=0,s=0,n=null;n=t.TTMSFNCToolBarControlList.$create("Create$1");for(var o=0,r=this.FHiddenControls.GetCount()-1;o<=r;o++)s=o,n.Add(this.FHiddenControls.GetItem$1(s));i=0;for(var a=0,l=n.GetCount()-1;a<=l&&(s=a,n.GetItem(s).FControl!==e);a++)i+=1;return n=rtl.freeLoc(n),i},this.GetCompactTextRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return i.$assign(this.GetLocalRect()),e.$assign(this.GetCompactBitmapRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))),t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+3,e.Bottom+3,i.Right-3,i.Bottom-23)),t},this.GetCompactBitmapRect=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;return i.$assign(t),e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Right,i.Top)),this.FCompactBitmapVisible&&(s=this.GetCompactBitmapSize(),this.FTextVisible&&""!==this.FText?this.FTextVisible&&""!==this.FText&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+3,i.Top+3,i.Right-3,i.Top+s)):(e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+3,i.Top+3,i.Right-3,i.Bottom-3)),-1!==s&&(e.Left=Math.round(i.Left+(i.Right-i.Left-s)/2),e.Top=Math.round(i.Top+(i.Bottom-i.Top-s)/2),e.Right=e.Left+s,e.Bottom=e.Top+s))),e},this.GetCompactBitmapSize=function(){var t=0,e=null;return t=this.FCompactBitmapSize,this.FCompactAutoBitmapSize&&(null==(e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FCompactBitmaps,0,this.GetBitmapContainer()))||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(e)||(t=Math.max(e.GetHeight(),e.GetWidth()))),t},this.GetQuickMenuButtonRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.GetWidth()-16,this.GetHeight()-16,this.GetWidth(),this.GetHeight())),this.FAppearance.FSeparator&&(t.Left=t.Left-this.FAppearance.FSeparatorStroke.FWidth,t.Right=t.Right-this.FAppearance.FSeparatorStroke.FWidth),t},this.HandleQuickMenuButton=function(){null!=this.FOnQuickMenuButtonClick&&this.FOnQuickMenuButtonClick(this)},this.CompactAppearanceChanged=function(t){this.Invalidate()},this.QuickMenuButtonAppearanceChanged=function(t){this.Invalidate()},this.CompactBitmapsChanged=function(t){var e;e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FCompactBitmaps,0,this.GetBitmapContainer()),this.SetCompactBitmapVisible(null!=e&&!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(e)),this.Invalidate()},this.CompactExpanderBitmapsChanged=function(t){this.Invalidate()},this.QuickMenuButtonBitmapsChanged=function(t){this.Invalidate()},this.ApplyFlatStyle=function(){for(var e=0,i=null,s=0,n=this.GetControlsCount()-1;s<=n;s++)e=s,i=this.GetControls(e),t.TTMSFNCDefaultToolBarButton.isPrototypeOf(i)&&rtl.as(i,t.TTMSFNCDefaultToolBarButton).FAppearance.SetFlatStyle(this.FAppearance.FFlatStyle),t.TTMSFNCCustomToolBar.isPrototypeOf(i)&&rtl.as(i,t.TTMSFNCCustomToolBar).FAppearance.SetFlatStyle(this.FAppearance.FFlatStyle);this.Invalidate()},this.SetAdaptToStyle=function(t){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetAdaptToStyle.apply(this,arguments),this.UpdateControls()},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FFill.SetKind(1),this.FAppearance.FFill.SetColor(t)),pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColorTo({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FFill.SetKind(2),this.FAppearance.FFill.SetColorTo(t))},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FAppearance.SetDragGripColor(13882323),this.FAppearance.FFill.SetColor(16777215),this.FAppearance.FStroke.SetColor(8421504),this.FAppearance.FFill.SetKind(2),this.FAppearance.FStroke.SetKind(1),this.FAppearance.FFill.SetColor(16777215),this.FAppearance.FFill.SetColorTo(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(230,230,230))},this.HandleMouseDown=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.FAppearance.FDragGrip&&!this.FDragGripMoving&&(this.FDragGripDown=pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetDragGripRect(!0),pas["WEBLib.TMSFNCTypes"].PointF(i,s)),this.FDragGripDownPt.$assign(pas["WEBLib.TMSFNCTypes"].PointF(i,s))),this.FDragGripDown||(this.FCompact?(this.FDown=!0,this.Invalidate(),this.CaptureEx()):this.FQuickMenuButton&&(this.FQuickMenuButtonDown=pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetQuickMenuButtonRect(),pas["WEBLib.TMSFNCTypes"].PointF(i,s)),this.FQuickMenuButtonDown&&(this.Invalidate(),this.CaptureEx()))),null!=this.FOnInternalMouseDown$1&&1!==t&&this.FOnInternalMouseDown$1(this)},this.HandleMouseMove=function(e,i,s){var n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=0,r=0,a=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),l=null;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),this.FCompact?(this.FHoverP=this.FHover,this.FHover=!0,this.FHover!==this.FHoverP&&this.Invalidate()):this.FQuickMenuButton&&(this.FQuickMenuButtonHoverP=this.FQuickMenuButtonHover,this.FQuickMenuButtonHover=pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetQuickMenuButtonRect(),pas["WEBLib.TMSFNCTypes"].PointF(i,s)),this.FQuickMenuButtonHover!==this.FQuickMenuButtonHoverP&&this.Invalidate()),this.FAppearance.FDragGrip&&(this.FDragGripDown?(this.FDragGripMoving||(this.CaptureEx(),this.FDragGripMoving=!0),this.FDragGripMoving&&(o=this.FDragGripDownPt.X-i,r=this.FDragGripDownPt.Y-s,this.FAutoMoveToolBar&&(a.$assign(pas["WEBLib.TMSFNCTypes"].PointF(this.GetLeft()-o,this.GetTop()-r)),t.TTMSFNCCustomDockPanel.isPrototypeOf(this.FParent)&&(l=rtl.as(this.FParent,t.TTMSFNCCustomDockPanel)).FAutoAlign&&(a.Y<l.FAppearance.FMargins.FTop&&(a.Y=Math.round(l.FAppearance.FMargins.FTop)),a.X<l.FAppearance.FMargins.FLeft?a.X=Math.round(l.FAppearance.FMargins.FLeft):a.X+this.GetWidth()>l.GetWidth()-l.FAppearance.FMargins.FRight&&(a.X=Math.round(l.GetWidth()-l.FAppearance.FMargins.FRight-this.GetWidth())),this.SetBounds(Math.round(a.X),Math.round(a.Y),this.GetWidth(),this.GetHeight()))),this.FDragGripDownPt.$assign(pas["WEBLib.TMSFNCTypes"].PointF(i+o,s+r)),this.DoDragGripMoving(o,r))):(n.$assign(this.GetDragGripRect(!0)),pas["WEBLib.TMSFNCTypes"].PtInRectEx(n,pas["WEBLib.TMSFNCTypes"].PointF(i,s))?this.FInsideDrag||(this.FInsideDrag=!0,this.SetControlCursor(5)):this.FInsideDrag&&(this.FInsideDrag=!1,this.SetControlCursor(0)))),""!==this.XYToAnchor(i,s)?this.SetControlCursor(21):21===this.FCursor&&this.SetControlCursor(0),null!=this.FOnInternalMouseMove$1&&this.FOnInternalMouseMove$1(this)},this.HandleMouseLeave=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),this.FHoverP=!1,this.FQuickMenuButtonHover=!1,this.SetControlCursor(0),this.FInsideDrag=!1,this.FHoverP!==this.FHover&&(this.FHover=!1,this.Invalidate())},this.HandleMouseUp=function(t,e,i,s){var n="";pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),this.FDragGripDown?this.ReleaseCaptureEx():this.FDown&&this.FCompact?(this.Invalidate(),this.ReleaseCaptureEx(),this.HandleCompact()):this.FQuickMenuButtonDown&&this.FQuickMenuButton&&!this.FCompact&&(this.Invalidate(),this.ReleaseCaptureEx(),this.HandleQuickMenuButton()),this.FDragGripDown=!1,this.FDragGripMoving=!1,this.FDown=!1,this.FQuickMenuButtonDown=!1,""!==(n=this.XYToAnchor(i,s))&&this.DoAnchorClick(n),null!=this.FOnInternalMouseUp$1&&1!==t&&this.FOnInternalMouseUp$1(this)},this.HandleCompact=function(){var e=0,i=null;this.DeactivateAllPopups(),null!=this.FCompactToolbar&&(rtl.free(this,"FCompactToolbar"),this.FCompactToolbar=null),null!=this.FCompactPopup&&(rtl.free(this,"FCompactPopup"),this.FCompactPopup=null),this.FCompactPopup=t.TTMSFNCToolBarPopup.$create("Create$1",[this]),this.FCompactPopup.FOnClosePopup=rtl.createCallback(this,"DoCloseCompactPopup"),this.FCompactToolbar=t.TTMSFNCCustomToolBar.$create("Create$1",[this.FCompactPopup]),this.FCompactToolbar.Assign(this),this.FCompactToolbar.SetCompact(!1),this.FCompactToolbar.SetAS(!0),this.FCompactToolbar.SetAutoHeight(!1),this.FCompactToolbar.SetAutoWidth(!0),this.FCompactToolbar.SetAutoStretchHeight(!1),this.FCompactToolbar.FAppearance.SetSeparator(!1),this.FCompactToolbar.SetControlMargins(1,1,1,1),this.FCompactToolbar.SetHeight(this.GetHeight()+2);for(var s=this.FCompactControls.GetCount()-1;s>=0;s--)e=s,null!=(i=this.FCompactControls.GetItem$1(e)).FControl&&(t.TTMSFNCDefaultToolBarButton.isPrototypeOf(i.FControl)&&rtl.as(i.FControl,t.TTMSFNCDefaultToolBarButton).SetLayout(rtl.as(i.FControl,t.TTMSFNCDefaultToolBarButton).FCompactLayout),i.FControl.SetVisible(!0),i.FControl.SetParent(this.FCompactToolbar));this.FCompactToolbar.UpdateControls(),this.FCompactPopup.SetPlacementControl(this),this.FCompactPopup.SetContentControl(this.FCompactToolbar),this.FCompactPopup.SetIsOpen(!0),this.DoCompactClick()},this.DeactivateAllPopups=function(){var e=0;if(null!=this.FParent&&pas["WEBLib.Controls"].TWinControl.isPrototypeOf(this.FParent))for(var i=0,s=rtl.as(this.FParent,pas["WEBLib.Controls"].TWinControl).GetControlsCount()-1;i<=s;i++)e=i,t.TTMSFNCCustomToolBar.isPrototypeOf(rtl.as(this.FParent,pas["WEBLib.Controls"].TWinControl).GetControls(e))&&rtl.as(rtl.as(this.FParent,pas["WEBLib.Controls"].TWinControl).GetControls(e),t.TTMSFNCCustomToolBar).CloseCompactPopup()},this.DoCompactClick=function(){null!=this.FOnCompactClick&&this.FOnCompactClick(this)},this.HandleDblClick=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleDblClick.apply(this,arguments),null!=this.FOnInternalDblClick$1&&this.FOnInternalDblClick$1(this)},this.UpdateDockPanel=function(){null!=this.FOnUpdateDockPanel&&this.FOnUpdateDockPanel(this)},this.InsertToolBarControl=function(t,e){t.SetParent(this),e>-1&&this.SetChildOrder(t,e),null!=this.FOnInternalInsertControl&&this.FOnInternalInsertControl(t)},this.DoDragGripMoving=function(t,e){null!=this.FOnDragGripMoving&&this.FOnDragGripMoving(this,t,e)},this.VisibleChanging=function(){pas["WEBLib.Controls"].TControl.VisibleChanging.call(this),this.UpdateDockPanel()},this.GetDragGripRect=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;return i.$assign(this.GetLocalRect()),s=1,1===this.FState&&(s=1.75),t?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Left+this.ScalePaintValue$1(8*s),i.Bottom)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+this.ScalePaintValue(3),i.Top+this.ScalePaintValue(3),i.Left+this.ScalePaintValue$1(6*s),i.Bottom-this.ScalePaintValue(3))),e},this.CompactControls=function(){var e=0,i=null,s=null;this.FBlockUpdate=!0,this.FCompactControls.Clear();for(var n=this.GetControlsCount()-1;n>=0;n--)e=n,(s=this.GetControls(e))!==this.FOptionsMenuButton&&((i=t.TTMSFNCToolBarControl.$create("Create$1")).FControl=s,t.TTMSFNCDefaultToolBarButton.isPrototypeOf(s)&&(i.FLayout=rtl.as(s,t.TTMSFNCDefaultToolBarButton).FLayout,0===rtl.as(s,t.TTMSFNCDefaultToolBarButton).FCompactLayout&&0!==rtl.as(s,t.TTMSFNCDefaultToolBarButton).FLayout&&rtl.as(s,t.TTMSFNCDefaultToolBarButton).SetCompactLayout(rtl.as(s,t.TTMSFNCDefaultToolBarButton).FMaximumLayout)),t.TTMSFNCCustomToolBarElement.isPrototypeOf(s)?i.FControlIndex=rtl.as(s,t.TTMSFNCCustomToolBarElement).FControlIndex:i.FControlIndex=s.FTag$1,s.SetParent(null),s.SetVisible(!1),this.FCompactControls.Add$1(i));this.FBlockUpdate=!0,this.UpdateControls(),this.Invalidate()},this.UncompactControls=function(){var e=0,i=null;this.FBlockUpdate=!0;for(var s=this.FCompactControls.GetCount()-1;s>=0;s--)e=s,null!=(i=this.FCompactControls.GetItem$1(e).FControl)&&(t.TTMSFNCCustomToolBarElement.isPrototypeOf(i)&&(rtl.as(i,t.TTMSFNCCustomToolBarElement).FBlockUpdate=!0),i.SetParent(this),i.SetVisible(!0),t.TTMSFNCCustomToolBarElement.isPrototypeOf(i)&&(rtl.as(i,t.TTMSFNCCustomToolBarElement).FBlockUpdate=!1));this.FBlockUpdate=!1,this.UpdateControls(),this.Invalidate()},this.UpdateToolBar=function(t){this.UpdateControls()},this.DoIsLastElement=function(t,e){null!=this.FOnIsLastElement&&this.FOnIsLastElement(this,t,e)},this.UpdateToolBarControl=function(e){var i=null,s=null,n=null,o=null,r=0;null!=e&&(this.FBlockUpdate=!0,n=rtl.as(e,pas["WEBLib.Controls"].TControl),null!=(i=this.GetHiddenControl(n))?(o=i.FControl,r=Math.max(0,Math.min(this.GetControlsCount(),i.FControlIndex-this.GetHiddenControlCount(o))),this.FHiddenControls.Remove$1(i),this.InsertToolBarControl(o,r),o.SetVisible(!0)):(i=t.TTMSFNCToolBarControl.$create("Create$1"),t.TTMSFNCCustomToolBarElement.isPrototypeOf(n)?i.FControlIndex=rtl.as(n,t.TTMSFNCCustomToolBarElement).FControlIndex:i.FControlIndex=n.FTag$1,i.FControl=n,this.FBlockUpdate=!0,s=n.MakeScreenshot(),this.FBlockUpdate=!1,i.FBitmap.Assign(s),s=rtl.freeLoc(s),this.FHiddenControls.Add$1(i),n.SetParent(null),n.SetVisible(!1)),this.FBlockUpdate=!1,this.UpdateControls())},this.OptionsButtonClick=function(t){var e=pas["WEBLib.TMSFNCTypes"].TPointF.$new();null!=this.FOnOptionsMenuButtonClick?this.FOnOptionsMenuButtonClick(this):(e.$assign(pas["WEBLib.TMSFNCTypes"].PointF(this.FOptionsMenuButton.GetLeft(),this.FOptionsMenuButton.GetTop())),e.$assign(this.LocalToScreenEx(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e.X,e.Y+this.FOptionsMenuButton.GetHeight())))),this.ShowOptionsMenu(e.X,e.Y))},this.DoCloseCompactPopup=function(e){var i=0,s=null;this.FCompactPopup.SetContentControl(null);for(var n=0,o=this.FCompactControls.GetCount()-1;n<=o;n++)i=n,null!=(s=this.FCompactControls.GetItem$1(i)).FControl&&(t.TTMSFNCDefaultToolBarButton.isPrototypeOf(s.FControl)&&rtl.as(s.FControl,t.TTMSFNCDefaultToolBarButton).SetLayout(s.FLayout),s.FControl.SetParent(null),s.FControl.SetVisible(!1));null!=this.FCompactToolbar&&(rtl.free(this,"FCompactToolbar"),this.FCompactToolbar=null)},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null),1===e&&t===this.FCustomOptionsMenu&&(this.FCustomOptionsMenu=null)},this.AlignControls=function(t,e){pas["WEBLib.Controls"].TControl.AlignControls.apply(this,arguments),this.UpdateControls()},this.UpdateControlAfterResize=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.UpdateControlAfterResize.call(this),this.UpdateDockPanel()},this.UpdateControls=function(){var e=this,i=0,s=null,n=0,o=!1,r=0,a=0,l=0,h=0,F=0,p=0,c=0,u=0,T=0,C=0,S=0,d=0,m=null,f=!1,g=null,y=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),b=null,N=0,M=0,B=0,E=0;function L(t){var i=null;if(i=null,t>=0&&t<=e.GetControlsCount()-1&&e.GetControls(t).FVisible)return i=e.GetControls(t);for(;t>=0&&t<=e.GetControlsCount()-1;)if((t+=1)>=0&&t<=e.GetControlsCount()-1&&e.GetControls(t).FVisible)return i=e.GetControls(t);return i}var D=rtl.createIntfRefs();try{if(this.FBlockUpdate||this.FBlockResize||function(){var t=!1,i=0;if(!(t=e.IsLoading()))for(var s=e.GetControlsCount()-1;s>=0;s--)if(i=s,0 in e.GetControls(i).FComponentState)return t=!0;return t}()||this.IsDestroying()||!this.CanBuildControls())return;this.FBlockUpdate=!0,p=Math.round(this.FAppearance.FHorizontalSpacing),u=Math.round(this.FAppearance.FVerticalSpacing),a=p,this.FAppearance.FDragGrip&&(a+=Math.round(this.GetDragGripRect(!1).Right),0===p&&(a+=this.ScalePaintValue(3))),T=a,C=h=u,c=this.ScalePaintValue(30),S=0,d=0,y.$assign(this.GetTextSize()),y.cy>0&&(S=Math.round(y.cy+this.ScalePaintValue(4))),y.cx>0&&(d=Math.round(y.cx+this.ScalePaintValue(8))),l=d,r=0,F=0,n=0,o=!1;for(var A=0,$=e.GetControlsCount()-1;A<=$&&(i=A,s=e.GetControls(i),!(o=!(null!=this.GetHiddenControl(s))));A++);f=!1;for(var I=0,P=e.GetControlsCount()-1;I<=P;I++)if(i=I,s=e.GetControls(i),pas.SysUtils.Supports$1(D.ref(1,rtl.queryIntfT(s,pas.System.IUnknown)),rtl.getIntfGUIDR(pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),{get:function(){return g},set:function(t){g=t}})&&g.SetAdaptToStyle(this.GetAdaptToStyle()),f&&(a=T,C=h=C+F-u),f=!1,t.TTMSFNCCustomToolBarElement.isPrototypeOf(s)&&(f=rtl.as(s,t.TTMSFNCCustomToolBarElement).FLastElement,rtl.as(s,t.TTMSFNCCustomToolBarElement).FOnUpdateToolBar=rtl.createCallback(e,"UpdateToolBar"),rtl.as(s,t.TTMSFNCCustomToolBarElement).FOnUpdateToolBarControl=rtl.createCallback(e,"UpdateToolBarControl")),this.DoIsLastElement(s,{get:function(){return f},set:function(t){f=t}}),f&&(f=!0),s!==this.FOptionsMenuButton){if(o&&(t.TTMSFNCCustomToolBarElement.isPrototypeOf(s)?rtl.as(s,t.TTMSFNCCustomToolBarElement).FControlIndex=n:s.FTag$1=n),s.FVisible){if(s.FAlignWithMargins)if(this.FAutoAlign&&(s.SetLeft(a+s.FMargins.FLeft),s.SetTop(h+s.FMargins.FTop)),this.FAutoStretchHeight||t.TTMSFNCDefaultToolBarButton.isPrototypeOf(s)&&3===rtl.as(s,t.TTMSFNCDefaultToolBarButton).FLayout?(F=this.GetHeight()-s.FMargins.FBottom-S-h,s.SetHeight(F)):F=Math.max(F,s.GetTop()+s.GetHeight()+u+s.FMargins.FBottom),null!=(b=L(i+1))&&t.TTMSFNCDefaultToolBarButton.isPrototypeOf(b)){var v=rtl.as(b,t.TTMSFNCDefaultToolBarButton).FLayout;1===v||2===v?(h=Math.max(h,s.GetTop()+s.GetHeight()+u+s.FMargins.FBottom))+b.FMargins.FTop+b.GetHeight()>this.GetHeight()-b.FMargins.FBottom-S?(a=Math.max(a,Math.max(r,s.GetLeft()+s.GetWidth()+p+s.FMargins.FRight)),h=C):(s.SetLeft(a+s.FMargins.FLeft),r=Math.max(a,Math.max(r,s.GetLeft()+s.GetWidth()+p+s.FMargins.FRight))):0!==v&&3!==v||(a=Math.max(a,s.GetLeft()+s.GetWidth()+p+s.FMargins.FRight),h=C)}else a=Math.max(a,Math.max(r,s.GetLeft()+s.GetWidth()+p+s.FMargins.FRight)),h=C;else if(this.FAutoAlign&&(s.SetLeft(a),s.SetTop(h)),this.FAutoStretchHeight||t.TTMSFNCDefaultToolBarButton.isPrototypeOf(s)&&3===rtl.as(s,t.TTMSFNCDefaultToolBarButton).FLayout?(F=this.GetHeight()-S-h,s.SetHeight(F)):F=Math.max(F,s.GetTop()+s.GetHeight()+u),null!=(b=L(i+1))&&t.TTMSFNCDefaultToolBarButton.isPrototypeOf(b)){var G=rtl.as(b,t.TTMSFNCDefaultToolBarButton).FLayout;1===G||2===G?(h=Math.max(h,s.GetTop()+s.GetHeight()+u))+b.GetHeight()>this.GetHeight()-S?(a=Math.max(a,Math.max(r,s.GetLeft()+s.GetWidth()+p)),h=C):(s.SetLeft(a),r=Math.max(a,Math.max(r,s.GetLeft()+s.GetWidth()+p))):0!==G&&3!==G||(a=Math.max(a,s.GetLeft()+s.GetWidth()+p),h=C)}else a=Math.max(a,Math.max(r,s.GetLeft()+s.GetWidth()+p)),h=C;l=Math.max(l,a)}n+=1}0===F&&(F=c),this.FOptionsMenuButton.SetVisible(this.FOptionsMenu.FShowButton),this.FOptionsMenu.FShowButton?this.FOptionsMenuButton.SetParent(e):this.FOptionsMenuButton.SetParent(null),this.FOptionsMenuButton.FVisible&&(this.FOptionsMenuButton.FControlIndex=e.GetControlsCount()-1,this.FOptionsMenuButton.SetTop(this.FOptionsMenuButton.FMargins.FTop),m=this.FOptionsMenuButton.FMargins,this.FOptionsMenuButton.FAlignWithMargins||(m.SetLeft(0),m.SetTop(0),m.SetRight(0),m.SetBottom(0)),this.FAutoSize?(this.FOptionsMenuButton.SetLeft(l+m.FLeft),this.FAutoHeight?this.FOptionsMenuButton.SetHeight(F-m.FBottom-m.FTop):this.FAutoStretchHeight&&this.FOptionsMenuButton.SetHeight(this.GetHeight()-m.FBottom-S-m.FTop)):(this.FOptionsMenuButton.SetLeft(this.GetWidth()-this.FOptionsMenuButton.GetWidth()-m.FRight),this.FOptionsMenuButton.SetHeight(this.GetHeight()-m.FBottom-m.FTop-S)),l=l+this.FOptionsMenuButton.GetWidth()+m.FRight+m.FLeft),this.FAutoSize&&(this.FAppearance.FSeparator&&(l+=Math.round(this.FAppearance.FSeparatorStroke.FWidth)),l=Math.round(Math.max(this.FMinimumWidth,l)),0===this.GetControlAlignment()&&(N=0,B=0,M=0,E=0,this.GetControlMargins({get:function(){return N},set:function(t){N=t}},{get:function(){return M},set:function(t){M=t}},{get:function(){return B},set:function(t){B=t}},{get:function(){return E},set:function(t){E=t}}),l+=Math.round(N+B)),F+=S,this.FAutoHeight&&this.FAutoWidth&&0===this.GetControlAlignment()?this.SetBounds(this.GetLeft(),this.GetTop(),l,F):this.FAutoHeight&&!(this.GetControlAlignment()in rtl.createSet(3,4,5))?this.SetBounds(this.GetLeft(),this.GetTop(),this.GetWidth(),F):this.FAutoWidth&&!(this.GetControlAlignment()in rtl.createSet(1,2,5))&&this.SetBounds(this.GetLeft(),this.GetTop(),l,this.GetHeight())),null!=this.FOnUpdateControls&&this.FOnUpdateControls(e),this.FBlockUpdate=!1}finally{D.free(),rtl._Release(g)}},this.DrawDragGrip=function(t){var e=this;var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();t.FFill.SetColor(this.FAppearance.FDragGripColor),t.FFill.SetKind(1),i.$assign(this.GetDragGripRect(!1)),function(i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=0;n=1===e.FState?e.ScalePaintValue(3):e.ScalePaintValue(2),i.Left=i.Left,i.Top=i.Top;for(var o=1,r=rtl.trunc(Math.round(i.Bottom)/(2*Math.round(n)));o<=r;o++)o,s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+(i.Right-i.Left-n)/2,i.Top+1,i.Left+n+(i.Right-i.Left-n)/2,i.Top+1+n)),s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(s.Left),pas.System.Int(s.Top),pas.System.Int(s.Right),pas.System.Int(s.Bottom))),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2),i.Top=i.Top+2*n}(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))},this.DrawText=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();this.FTextVisible&&""!==this.FText&&(t.FFont.Assign(this.FFont$1),e.$assign(this.GetTextRect()),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FText,this.FWordWrapping,this.FHorizontalTextAlign,this.FVerticalTextAlign,this.FTrimming,0,-1,-1,!0,!1,-1,-1))},this.DrawCompactBitmap=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();i.$assign(this.GetCompactBitmapRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))),t.FBitmapContainer=this.GetBitmapContainer(),t.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FCompactBitmaps,0,!0,!1,!0,!1)},this.DrawCompactText=function(t){var e,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(this.FTextVisible&&""!==this.FText){i.$assign(this.GetCompactTextRect()),e=t.SaveState(!1);try{t.ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i)),t.FFont.Assign(this.FFont$1),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FText,this.FWordWrapping,this.FHorizontalTextAlign,this.FVerticalTextAlign,this.FTrimming,0,-1,-1,!0,!1,-1,-1)}finally{t.RestoreState(e,!1)}}},this.DrawCompactExpander=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(this.GetLocalRect()),e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Bottom-20,e.Right,e.Bottom)),pas["WEBLib.TMSFNCTypes"].InflateRectEx(e,-2,-2),t.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FCompactExpanderBitmaps,0,!0,!1,!0,!1)},this.ShowOptionsMenu=function(t,e){},this.XYToAnchor=function(t,e){var i="",s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=null;i="",s.$assign(this.GetTextRect()),(n=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),n.FBitmapContainer=this.GetBitmapContainer();try{n.FFont.Assign(this.FFont$1),i=n.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FText,this.FWordWrapping,this.FHorizontalTextAlign,this.FVerticalTextAlign,this.FTrimming,0,-1,-1,!0,!0,t,e)}finally{n.EndScene(),n=rtl.freeLoc(n)}return i},this.DoAnchorClick=function(t){null!=this.FOnAnchorClick?this.FOnAnchorClick(this,t):pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(t)},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this)},this.Assign=function(e){var i=null,s=null,n=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments),t.TTMSFNCCustomToolBar.isPrototypeOf(e)){this.FCompactAppearance.Assign(rtl.as(e,t.TTMSFNCCustomToolBar).FCompactAppearance),this.FQuickMenuButtonAppearance.Assign(rtl.as(e,t.TTMSFNCCustomToolBar).FQuickMenuButtonAppearance),this.FQuickMenuButton=rtl.as(e,t.TTMSFNCCustomToolBar).FQuickMenuButton,this.FCompactBitmaps.Assign(rtl.as(e,t.TTMSFNCCustomToolBar).FCompactBitmaps),this.FCompact=rtl.as(e,t.TTMSFNCCustomToolBar).FCompact,this.FCanCompact=rtl.as(e,t.TTMSFNCCustomToolBar).FCanCompact,this.FMinimumWidth=rtl.as(e,t.TTMSFNCCustomToolBar).FMinimumWidth,this.FCompactWidth=rtl.as(e,t.TTMSFNCCustomToolBar).FCompactWidth,this.FCompactBitmapSize=rtl.as(e,t.TTMSFNCCustomToolBar).FCompactBitmapSize,this.FCompactAutoBitmapSize=rtl.as(e,t.TTMSFNCCustomToolBar).FCompactAutoBitmapSize,this.FCompactExpanderBitmaps.Assign(rtl.as(e,t.TTMSFNCCustomToolBar).FCompactExpanderBitmaps),this.FQuickMenuButtonBitmaps.Assign(rtl.as(e,t.TTMSFNCCustomToolBar).FQuickMenuButtonBitmaps),this.FCompactBitmapVisible=rtl.as(e,t.TTMSFNCCustomToolBar).FCompactBitmapVisible,this.FText=rtl.as(e,t.TTMSFNCCustomToolBar).FText,this.FTextVisible=rtl.as(e,t.TTMSFNCCustomToolBar).FTextVisible,this.FWordWrapping=rtl.as(e,t.TTMSFNCCustomToolBar).FWordWrapping,this.FHorizontalTextAlign=rtl.as(e,t.TTMSFNCCustomToolBar).FHorizontalTextAlign,this.FVerticalTextAlign=rtl.as(e,t.TTMSFNCCustomToolBar).FVerticalTextAlign,this.FTrimming=rtl.as(e,t.TTMSFNCCustomToolBar).FTrimming,this.FFont$1.Assign(rtl.as(e,t.TTMSFNCCustomToolBar).FFont$1),this.FAutoSize=rtl.as(e,t.TTMSFNCCustomToolBar).FAutoSize,this.FAutoHeight=rtl.as(e,t.TTMSFNCCustomToolBar).FAutoHeight,this.FAutoWidth=rtl.as(e,t.TTMSFNCCustomToolBar).FAutoWidth,this.FAutoAlign=rtl.as(e,t.TTMSFNCCustomToolBar).FAutoAlign,this.FAutoStretchHeight=rtl.as(e,t.TTMSFNCCustomToolBar).FAutoStretchHeight,this.FAutoMoveToolBar=rtl.as(e,t.TTMSFNCCustomToolBar).FAutoMoveToolBar,this.FAppearance.Assign(rtl.as(e,t.TTMSFNCCustomToolBar).FAppearance);for(var o=0,r=rtl.as(e,t.TTMSFNCCustomToolBar).GetControlsCount()-1;o<=r;o++)n=o,s=rtl.as(e,t.TTMSFNCCustomToolBar).GetControls(n),(t.TTMSFNCDefaultToolBarButton.isPrototypeOf(s)&&rtl.as(s,t.TTMSFNCDefaultToolBarButton).FCanCopy||!t.TTMSFNCDefaultToolBarButton.isPrototypeOf(s)||!pas["WEBLib.Controls"].TControl.isPrototypeOf(s))&&(t.TTMSFNCDefaultToolBarButton.isPrototypeOf(s)&&(rtl.as(s,t.TTMSFNCDefaultToolBarButton).FApplyName=!1),i=rtl.as(pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.Clone(s),pas["WEBLib.Controls"].TControl),t.TTMSFNCDefaultToolBarButton.isPrototypeOf(s)&&(rtl.as(s,t.TTMSFNCDefaultToolBarButton).FApplyName=!0),this.AddCustomControl(i,-1));this.Invalidate()}else pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments)},this.Create$1=function(e){var i=0;return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FHiddenControls=t.TTMSFNCToolBarControlObjectList.$create("Create$2"),this.FCompactControls=t.TTMSFNCToolBarControlObjectList.$create("Create$2"),this.FState=0,this.FAppearance=t.TTMSFNCToolBarAppearance.$create("Create$1",[this]),this.FCompactAppearance=t.TTMSFNCToolBarCompactAppearance.$create("Create$1",[null]),this.FCompactAppearance.FOnChange=rtl.createCallback(this,"CompactAppearanceChanged"),this.FQuickMenuButtonAppearance=t.TTMSFNCToolBarQuickMenuButtonAppearance.$create("Create$1",[null]),this.FQuickMenuButtonAppearance.FOnChange=rtl.createCallback(this,"QuickMenuButtonAppearanceChanged"),this.FCompactBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FCompactBitmaps.FOnChange=rtl.createCallback(this,"CompactBitmapsChanged"),this.FOptionsMenu=t.TTMSFNCToolBarOptionsMenu.$create("Create$1",[this]),this.FMinimumWidth=30,this.FCompactWidth=50,this.FCompactBitmapSize=24,this.FCompactAutoBitmapSize=!1,this.FCompactBitmapVisible=!1,this.FCompactExpanderBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FCompactExpanderBitmaps.FOnChange=rtl.createCallback(this,"CompactExpanderBitmapsChanged"),this.FQuickMenuButtonBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FQuickMenuButtonBitmaps.FOnChange=rtl.createCallback(this,"QuickMenuButtonBitmapsChanged"),this.FCanCompact=!0,this.FQuickMenuButton=!1,this.FCompact=!1,this.FAutoSize=!0,this.FAutoWidth=!0,this.FAutoHeight=!0,this.FAutoAlign=!0,this.FAutoStretchHeight=!1,this.FAutoMoveToolBar=!0,this.FOptionsMenuButton=this.GetOptionsMenuButtonClass().$create("Create$1",[this]),this.FOptionsMenuButton.FAppearance.FNormalFill.SetKind(1),i=13882323,this.FOptionsMenuButton.FAppearance.FNormalFill.SetColor(i),this.FOptionsMenuButton.FAppearance.SetShowInnerStroke(!1),this.FOptionsMenuButton.FAppearance.SetRounding(0),this.FOptionsMenuButton.FAppearance.FHoverFill.Assign(this.FOptionsMenuButton.FAppearance.FNormalFill),this.FOptionsMenuButton.FAppearance.FDisabledFill.Assign(this.FOptionsMenuButton.FAppearance.FNormalFill),this.FOptionsMenuButton.FAppearance.FDownFill.Assign(this.FOptionsMenuButton.FAppearance.FNormalFill),this.FOptionsMenuButton.FAppearance.FHoverFill.SetColor(15128749),this.FOptionsMenuButton.FAppearance.FDownFill.SetColor(14599344),this.FOptionsMenuButton.FAppearance.FDisabledFill.SetColor(13882323),this.FOptionsMenuButton.SetAlignWithMargins(!0),this.FOptionsMenuButton.FMargins.SetTop(3),this.FOptionsMenuButton.FMargins.SetBottom(3),this.FOptionsMenuButton.FMargins.SetRight(3),this.FOptionsMenuButton.FCanCopy=!1,this.FAutoOptionsMenu=pas["WEBLib.Menus"].TPopupMenu.$create("Create$1",[this]),this.FOptionsMenuButton.FOnClick=rtl.createCallback(this,"OptionsButtonClick"),this.FOptionsMenuButton.SetWidth(17),this.FOptionsMenuButton.SetText(""),this.FOptionsMenuButton.FStored=!1,this.FOptionsMenuButton.FBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBAROPTIONSMENU,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this.FOptionsMenuButton.FBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBAROPTIONSMENULARGE,pas["WEBLib.TMSFNCTypes"].HInstance(),1.5),this.FOptionsMenuButton.FDisabledBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBAROPTIONSMENU,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this.FOptionsMenuButton.FDisabledBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBAROPTIONSMENULARGE,pas["WEBLib.TMSFNCTypes"].HInstance(),1.5),this.FOptionsMenuButton.FHoverBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBAROPTIONSMENU,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this.FOptionsMenuButton.FHoverBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBAROPTIONSMENULARGE,pas["WEBLib.TMSFNCTypes"].HInstance(),1.5),this.FHorizontalTextAlign=0,this.FVerticalTextAlign=0,this.FTrimming=1,this.FWordWrapping=!1,this.FTextVisible=!0,this.FFont$1=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FCompactPopup=t.TTMSFNCToolBarPopup.$create("Create$1",[this]),this.FCompactPopup.FOnClosePopup=rtl.createCallback(this,"DoCloseCompactPopup"),this.FCompactExpanderBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCGraphics"].TMSFNCGRAPHICSDOWN,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this.FQuickMenuButtonBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBARQUICKMENU,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this},this.Destroy=function(){rtl.free(this,"FQuickMenuButtonBitmaps"),rtl.free(this,"FCompactExpanderBitmaps"),rtl.free(this,"FCompactPopup"),rtl.free(this,"FQuickMenuButtonAppearance"),rtl.free(this,"FCompactAppearance"),rtl.free(this,"FCompactBitmaps"),rtl.free(this,"FFont$1"),rtl.free(this,"FOptionsMenu"),rtl.free(this,"FAppearance"),rtl.free(this,"FHiddenControls"),rtl.free(this,"FCompactControls"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Draw=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),s.$assign(this.GetLocalRect()),this.FCompact?(this.FDown?(t.FFill.Assign(this.FCompactAppearance.FDownFill),t.FStroke.Assign(this.FCompactAppearance.FDownStroke)):this.FHover?(t.FFill.Assign(this.FCompactAppearance.FHoverFill),t.FStroke.Assign(this.FCompactAppearance.FHoverStroke)):(t.FFill.Assign(this.FCompactAppearance.FNormalFill),t.FStroke.Assign(this.FCompactAppearance.FNormalStroke)),this.FCompactAppearance.FFlatStyle&&t.FFill.SetKind(1),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(s.Left,s.Top+2,s.Right-3,s.Bottom-2)),2)):(t.FFill.Assign(this.FAppearance.FFill),t.FStroke.Assign(this.FAppearance.FStroke),this.FAppearance.FFlatStyle&&t.FFill.SetKind(1),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2)),this.FCompact?(this.DrawCompactBitmap(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),this.DrawCompactText(t),this.DrawCompactExpander(t)):(this.FAppearance.FDragGrip&&this.DrawDragGrip(t),this.DrawText(t),this.FQuickMenuButton&&(this.FQuickMenuButtonDown?(t.FFill.Assign(this.FQuickMenuButtonAppearance.FDownFill),t.FStroke.Assign(this.FQuickMenuButtonAppearance.FDownStroke)):this.FQuickMenuButtonHover?(t.FFill.Assign(this.FQuickMenuButtonAppearance.FHoverFill),t.FStroke.Assign(this.FQuickMenuButtonAppearance.FHoverStroke)):(t.FFill.Assign(this.FQuickMenuButtonAppearance.FNormalFill),t.FStroke.Assign(this.FQuickMenuButtonAppearance.FNormalStroke)),this.FQuickMenuButtonAppearance.FFlatStyle&&t.FFill.SetKind(1),i.$assign(this.GetQuickMenuButtonRect()),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),2),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-2,-2),t.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FQuickMenuButtonBitmaps,0,!0,!1,!0,!1))),this.FAppearance.FSeparator&&(t.FStroke.Assign(this.FAppearance.FSeparatorStroke),n=this.FAppearance.FSeparatorStroke.FWidth,t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s.Right-n,s.Top+4)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s.Right-n,s.Bottom-4)),2,2)),this.IsDesignTime()&&this.CanDrawDesignTime()&&t.DrawFocusRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),0,2)},this.CloseCompactPopup=function(){null!=this.FCompactPopup&&this.FCompactPopup.SetIsOpen(!1)},this.AddCustomControl=function(t,e){this.FBlockUpdate=!0,this.InsertToolBarControl(t,e),this.FBlockUpdate=!1,this.UpdateControls()},this.AddButton=function(t,e,i,s,n,o){var r=null;return this.FBlockUpdate=!0,(r=this.GetToolBarButtonClass().$create("Create$1",[this])).FAppearance.SetFlatStyle(this.FAppearance.FFlatStyle),r.SetText(n),-1!==t&&r.SetWidth(Math.round(t)),-1!==e&&r.SetHeight(Math.round(e)),""!==i&&(r.FBitmaps.AddBitmapFromResource$1(i,pas["WEBLib.TMSFNCTypes"].HInstance(),1),r.FDisabledBitmaps.AddBitmapFromResource$1(i,pas["WEBLib.TMSFNCTypes"].HInstance(),1),r.FHoverBitmaps.AddBitmapFromResource$1(i,pas["WEBLib.TMSFNCTypes"].HInstance(),1)),""!==s&&(r.FBitmaps.AddBitmapFromResource$1(s,pas["WEBLib.TMSFNCTypes"].HInstance(),1.5),r.FDisabledBitmaps.AddBitmapFromResource$1(s,pas["WEBLib.TMSFNCTypes"].HInstance(),1.5),r.FHoverBitmaps.AddBitmapFromResource$1(s,pas["WEBLib.TMSFNCTypes"].HInstance(),1.5)),this.InsertToolBarControl(r,o),this.FBlockUpdate=!1,this.UpdateControls(),r},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCToolBar",this.TTMSFNCCustomToolBar,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCToolBar)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("OnOptionsMenuButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnOptionsMenuButtonClick","FOnOptionsMenuButtonClick"),e.addProperty("OnOptionsMenuItemCanShow",0,t.$rtti.TTMSFNCToolBarCanShowOptionsMenuItem,"FOnOptionsMenuItemCanShow","FOnOptionsMenuItemCanShow"),e.addProperty("OnOptionsMenuCustomize",0,t.$rtti.TTMSFNCToolBarCustomizeOptionsMenu,"FOnOptionsMenuCustomize","FOnOptionsMenuCustomize"),e.addProperty("OnOptionsMenuItemCustomize",0,t.$rtti.TTMSFNCToolBarCustomizeOptionsMenuItem,"FOnOptionsMenuItemCustomize","FOnOptionsMenuItemCustomize"),e.addProperty("OnOptionsMenuItemApplyStyle",0,t.$rtti.TTMSFNCToolBarCustomizeOptionsMenuItem,"FOnOptionsMenuItemApplyStyle","FOnOptionsMenuItemApplyStyle"),e.addProperty("OnOptionsMenuItemClick",0,t.$rtti.TTMSFNCToolBarOptionsMenuItemClick,"FOnOptionsMenuItemClick","FOnOptionsMenuItemClick"),e.addProperty("OnIsLastElement",0,t.$rtti.TTMSFNCToolBarIsLastElement,"FOnIsLastElement","FOnIsLastElement"),e.addProperty("OnDragGripMoving",0,t.$rtti.TTMSFNCToolBarDragGripMovingEvent,"FOnDragGripMoving","FOnDragGripMoving"),e.addProperty("OnQuickMenuButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnQuickMenuButtonClick","FOnQuickMenuButtonClick"),e.addProperty("OnAnchorClick",0,t.$rtti.TTMSFNCToolBarAnchorClickEvent,"FOnAnchorClick","FOnAnchorClick"),e.addProperty("Version",1,rtl.string,"GetVersion",""),e.addProperty("AutoHeight",2,rtl.boolean,"FAutoHeight","SetAutoHeight",{Default:!0}),e.addProperty("AutoWidth",2,rtl.boolean,"FAutoWidth","SetAutoWidth",{Default:!0}),e.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAS",{Default:!0}),e.addProperty("AutoAlign",2,rtl.boolean,"FAutoAlign","SetAutoAlign",{Default:!0}),e.addProperty("AutoStretchHeight",2,rtl.boolean,"FAutoStretchHeight","SetAutoStretchHeight",{Default:!1}),e.addProperty("AutoMoveToolBar",0,rtl.boolean,"FAutoMoveToolBar","FAutoMoveToolBar",{Default:!0}),e.addProperty("Appearance",2,t.$rtti.TTMSFNCToolBarAppearance,"FAppearance","SetAppearance"),e.addProperty("CanCompact",2,rtl.boolean,"FCanCompact","SetCanCompact",{Default:!0}),e.addProperty("OnCompactClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnCompactClick","FOnCompactClick"),e.addProperty("CompactBitmapVisible",2,rtl.boolean,"FCompactBitmapVisible","SetCompactBitmapVisible",{Default:!1}),e.addProperty("CompactBitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FCompactBitmaps","SetCompactBitmaps"),e.addProperty("Compact",2,rtl.boolean,"FCompact","SetCompact",{Default:!1}),e.addProperty("CompactWidth",14,rtl.double,"FCompactWidth","SetCompactWidth",{stored:"IsCompactWidthStored"}),e.addProperty("CompactAppearance",2,t.$rtti.TTMSFNCToolBarCompactAppearance,"FCompactAppearance","SetCompactAppearance"),e.addProperty("CompactBitmapSize",14,rtl.double,"FCompactBitmapSize","SetCompactBitmapSize",{stored:"IsCompactBitmapSizeStored"}),e.addProperty("CompactAutoBitmapSize",2,rtl.boolean,"FCompactAutoBitmapSize","SetCompactAutoBitmapSize",{Default:!1}),e.addProperty("QuickMenuButtonHint",0,rtl.string,"FQuickMenuButtonHint","FQuickMenuButtonHint"),e.addProperty("QuickMenuButton",2,rtl.boolean,"FQuickMenuButton","SetQuickMenuButton",{Default:!1}),e.addProperty("QuickMenuButtonAppearance",2,t.$rtti.TTMSFNCToolBarQuickMenuButtonAppearance,"FQuickMenuButtonAppearance","SetQuickMenuButtonAppearance"),e.addProperty("MinimumWidth",14,rtl.double,"FMinimumWidth","SetMinimumWidth",{stored:"IsMinimumWidthStored"}),e.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!1}),e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttCharacter}),e.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont$1","SetFont$1"),e.addProperty("OptionsMenu",2,t.$rtti.TTMSFNCToolBarOptionsMenu,"FOptionsMenu","SetOptionsMenu"),e.addProperty("CustomOptionsMenu",0,pas["WEBLib.Menus"].$rtti.TPopupMenu,"FCustomOptionsMenu","FCustomOptionsMenu"),e.addProperty("State",2,t.$rtti.TTMSFNCToolBarElementState,"FState","SetState",{Default:t.TTMSFNCToolBarElementState.esNormal}),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),rtl.createClass(this,"TTMSFNCCustomDockPanelAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null,this.FFill=null,this.FStroke=null,this.FMargins=null},this.$final=function(){this.FOwner=void 0,this.FFill=void 0,this.FStroke=void 0,this.FMargins=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.FillChanged=function(t){this.FOwner.Invalidate()},this.StrokeChanged=function(t){this.FOwner.Invalidate()},this.Create$1=function(t){return this.FOwner=t,this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,8421504]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FMargins=pas["WEBLib.TMSFNCTypes"].TTMSFNCMargins.$create("Create$1"),this.FMargins.SetLeft(3),this.FMargins.SetTop(3),this.FMargins.SetBottom(3),this.FMargins.SetRight(3),this},this.Destroy=function(){rtl.free(this,"FMargins"),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TTMSFNCDockPanelAppearance",this.TTMSFNCCustomDockPanelAppearance,(function(){var t=this.$rtti;t.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),t.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke")})),rtl.createClass(this,"TTMSFNCCustomDockPanel",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FBlockUpdate=!1,this.FAppearance=null,this.FAutoSize=!1,this.FAutoAlign=!1,this.FState=0},this.$final=function(){this.FAppearance=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetAutoAlign=function(t){this.FAutoAlign!==t&&(this.FAutoAlign=t,this.UpdateControls())},this.SetAS=function(t){this.FAutoSize!==t&&(this.FAutoSize=t,this.UpdateControls())},this.SetState=function(e){var i=0,s=null;if(this.FState!==e){this.FState=e;for(var n=0,o=this.GetControlsCount()-1;n<=o;n++)i=n,s=this.GetControls(i),t.TTMSFNCCustomToolBar.isPrototypeOf(s)&&rtl.as(s,t.TTMSFNCCustomToolBar).SetState(this.FState)}},this.SetAdaptToStyle=function(t){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetAdaptToStyle.apply(this,arguments),this.UpdateControls()},this.UpdateControls=function(){var t=0,e=0,i=0,s=null,n=null,o=rtl.createIntfRefs();try{if(this.FBlockUpdate||this.IsLoading()||this.IsDestroying())return;if(this.FBlockUpdate=!0,e=0,i=this.ScalePaintValue(30),this.FAutoAlign&&(this.InitializeControls(),this.RearrangeControls()),this.FAutoSize){for(var r=0,a=this.GetControlsCount()-1;r<=a;r++)t=r,s=this.GetControls(t),pas.SysUtils.Supports$1(o.ref(1,rtl.queryIntfT(s,pas.System.IUnknown)),rtl.getIntfGUIDR(pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),{get:function(){return n},set:function(t){n=t}})&&n.SetAdaptToStyle(this.GetAdaptToStyle()),s.FVisible&&(e=Math.round(Math.max(e,s.GetTop()+s.GetHeight()+this.FAppearance.FMargins.FBottom)));0===e&&(e=i),4 in this.FComponentState&&(e+=this.ScalePaintValue(15)),this.SetBounds(this.GetLeft(),this.GetTop(),this.GetWidth(),e)}this.FBlockUpdate=!1}finally{o.free(),rtl._Release(n)}},this.InitializeControls=function(){for(var e=0,i=null,s=0,n=this.GetControlsCount()-1;s<=n;s++)e=s,i=this.GetControls(e),t.TTMSFNCCustomToolBar.isPrototypeOf(i)&&(rtl.as(i,t.TTMSFNCCustomToolBar).FOnUpdateDockPanel=rtl.createCallback(this,"UpdateDockPanel"),rtl.as(i,t.TTMSFNCCustomToolBar).FDragGripMoving)||i.FVisible&&(i.GetTop()<this.FAppearance.FMargins.FTop&&i.SetTop(Math.round(this.FAppearance.FMargins.FTop)),i.GetLeft()<this.FAppearance.FMargins.FLeft?i.SetLeft(Math.round(this.FAppearance.FMargins.FLeft)):i.GetLeft()+i.GetWidth()>this.GetWidth()-this.FAppearance.FMargins.FRight&&i.SetLeft(Math.round(this.GetWidth()-this.FAppearance.FMargins.FRight-i.GetWidth())))},this.RearrangeControls=function(){for(var e=null,i=null,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=0,r=0,a=0,l=this.GetControlsCount()-1;a<=l;a++)if(o=a,(e=this.GetControls(o)).FVisible&&(!t.TTMSFNCCustomToolBar.isPrototypeOf(e)||!rtl.as(e,t.TTMSFNCCustomToolBar).FDragGripMoving))for(var h=0,F=this.GetControlsCount()-1;h<=F;h++)r=h,(i=this.GetControls(r))!==e&&i.FVisible&&(s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.GetLeft(),e.GetTop(),e.GetLeft()+e.GetWidth(),e.GetTop()+e.GetHeight())),n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.GetLeft(),i.GetTop(),i.GetLeft()+i.GetWidth(),i.GetTop()+i.GetHeight())),n.Left>=s.Left-3&&n.Left<=s.Right+3&&(n.Top<pas["WEBLib.TMSFNCTypes"].CenterPointEx(s).Y&&n.Top>=s.Top-3?(i.SetLeft(e.GetLeft()+e.GetWidth()+3),i.SetTop(e.GetTop())):n.Top>=pas["WEBLib.TMSFNCTypes"].CenterPointEx(s).Y&&n.Top<=s.Bottom+3&&(i.SetTop(e.GetTop()+e.GetHeight()+3),i.SetLeft(e.GetLeft()))))},this.UpdateDockPanel=function(t){this.UpdateControls()},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FFill.SetKind(1),this.FAppearance.FFill.SetColor(t)),pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColorTo({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FFill.SetKind(2),this.FAppearance.FFill.SetColorTo(t))},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this)},this.AlignControls=function(t,e){pas["WEBLib.Controls"].TControl.AlignControls.apply(this,arguments),this.UpdateControls()},this.Assign=function(e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments),t.TTMSFNCCustomDockPanel.isPrototypeOf(e)?(this.FAppearance.Assign(rtl.as(e,t.TTMSFNCCustomDockPanel).FAppearance),this.SetAS(rtl.as(e,t.TTMSFNCCustomDockPanel).FAutoSize),this.SetAutoAlign(rtl.as(e,t.TTMSFNCCustomDockPanel).FAutoAlign),this.SetState(rtl.as(e,t.TTMSFNCCustomDockPanel).FState)):pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments)},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FState=0,this.FAppearance=t.TTMSFNCDockPanelAppearance.$create("Create$1",[this]),this.FAutoSize=!0,this.FAutoAlign=!0,this.SetAlign(1),this.SetHeight(40),this},this.Destroy=function(){rtl.free(this,"FAppearance"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Draw=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),t.FFill.Assign(this.FAppearance.FFill),t.FStroke.Assign(this.FAppearance.FStroke),i.$assign(this.GetLocalRect()),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),2)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),t.$init=function(){pas.Classes.RegisterClass(t.TTMSFNCToolBarButton),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTOOLBAREXPANDSVG)}}),["Math","SysUtils","WEBLib.TMSFNCUtils","WEBLib.Graphics","StrUtils"]),rtl.module("WEBLib.TMSFNCHTMLText",["System","Classes","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCTypes","WEBLib.Controls"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=1,this.REL_VER=0,this.BLD_VER=5,this.$rtti.$MethodVar("TTMSFNCHTMLTextAnchorClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AAnchor",rtl.string]]),methodkind:0}),rtl.createClass(this,"TTMSFNCHTMLText",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FDisableAdjustSize=!1,this.FBitmapContainer=null,this.FOnAnchorClick=null,this.FURLColor=0,this.FShadowOffset=0,this.FShadowColor=0,this.FDisplayHTML=!1,this.FURLUnderline=!1,this.FText="",this.FFont$1=null,this.FWordWrapping=!1,this.FAutoSize=!1,this.FVerticalTextAlign=0,this.FHorizontalTextAlign=0,this.FAutoOpenURL=!1,this.FAutoSizeSpacing=0,this.FAutoHeight=!1,this.FAutoWidth=!1,this.FTrimming=0},this.$final=function(){this.FBitmapContainer=void 0,this.FOnAnchorClick=void 0,this.FFont$1=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetShadowOffset=function(t){this.FShadowOffset!==t&&(this.FShadowOffset=t,this.Invalidate())},this.SetURLColor=function(t){this.FURLColor!==t&&(this.FURLColor=t,this.Invalidate())},this.SetShadowColor=function(t){this.FShadowColor!==t&&(this.FShadowColor=t,this.Invalidate())},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,this.ApplyAutoSize()},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.ApplyAutoSize(),this.Invalidate())},this.SetDisplayHTML=function(t){this.FDisplayHTML!==t&&(this.FDisplayHTML=t,this.ApplyAutoSize(),this.Invalidate())},this.SetURLUnderline=function(t){this.FURLUnderline!==t&&(this.FURLUnderline=t,this.Invalidate())},this.SetFnt=function(t){this.FFont$1.AssignSource(t)},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,this.ApplyAutoSize(),this.Invalidate())},this.SetAS=function(t){this.FAutoSize!==t&&(this.FAutoSize=t,this.ApplyAutoSize(),this.Invalidate())},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t,this.ApplyAutoSize(),this.Invalidate())},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,this.ApplyAutoSize(),this.Invalidate())},this.SetAutoSizeSpacing=function(t){this.FAutoSizeSpacing!==t&&(this.FAutoSizeSpacing=t,this.ApplyAutoSize(),this.Invalidate())},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetAutoHeight=function(t){this.FAutoHeight!==t&&(this.FAutoHeight=t,this.ApplyAutoSize(),this.Invalidate())},this.SetAutoWidth=function(t){this.FAutoWidth!==t&&(this.FAutoWidth=t,this.ApplyAutoSize(),this.Invalidate())},this.SetTrimming=function(t){this.FTrimming!==t&&(this.FTrimming=t,this.Invalidate())},this.GetVersion=function(){return this.$class.GetVersionNumber(1,1,0,5)},this.CanDrawDesignTime=function(){return!0,!0},this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCHTMLText)},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&this.FFill.SetColor(t),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundStrokeColor({get:function(){return t},set:function(e){t=e}})&&this.FStroke.SetColor(t),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&this.FFont$1.SetColor(t)},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FFill.SetColor(16777215),this.FStroke.SetColor(12632256),this.FFont$1.SetColor(0)},this.ApplyAutoSize=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(!this.FDisableAdjustSize&&!(0 in this.FComponentState)){this.FDisableAdjustSize=!0;try{this.FAutoSize&&""!==this.FText&&(t.$assign(this.GetTextRect()),this.FAutoHeight&&this.FAutoWidth?this.SetBounds(this.GetLeft(),this.GetTop(),Math.round(t.Right-t.Left+2*t.Left+this.FFont$1.FSize/3),Math.round(t.Bottom-t.Top+2*t.Top)):this.FAutoWidth?this.SetBounds(this.GetLeft(),this.GetTop(),Math.round(t.Right-t.Left+2*t.Left+this.FFont$1.FSize/3),this.GetHeight()):this.FAutoHeight&&this.SetBounds(this.GetLeft(),this.GetTop(),this.GetWidth(),Math.round(t.Bottom-t.Top+2*t.Top)))}finally{this.FDisableAdjustSize=!1}}},this.DoFontChanged=function(t){this.Invalidate()},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null)},this.HandleMouseDown=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.DoMouseDown(t,rtl.refSet(e),i,s)},this.HandleMouseMove=function(t,e,i){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),this.DoMouseMove(rtl.refSet(t),e,i)},this.DoAnchorClick=function(t){null!=this.FOnAnchorClick?this.FOnAnchorClick(this,t):this.FAutoOpenURL&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(t)},this.DrawHTMLText=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();t.FFont.AssignSource(this.FFont$1),this.FEnabled||t.FFont.SetColor(10789024),t.FURLColor=this.FURLColor,t.FURLUnderline=this.FURLUnderline,this.FAutoSize?this.FAutoWidth&&this.FAutoHeight?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FAutoSizeSpacing,this.FAutoSizeSpacing,this.GetWidth()-this.FAutoSizeSpacing,this.GetHeight()-this.FAutoSizeSpacing)):this.FAutoWidth?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FAutoSizeSpacing,0,this.GetWidth()-this.FAutoSizeSpacing,this.GetHeight())):this.FAutoHeight&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,this.FAutoSizeSpacing,this.GetWidth(),this.GetHeight()-this.FAutoSizeSpacing)):e.$assign(this.GetLocalRect()),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FText,this.FWordWrapping,this.FHorizontalTextAlign,this.FVerticalTextAlign,this.FTrimming,0,-1,-1,this.FDisplayHTML,!1,-1,-1)},this.SetEnabled=function(t){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetEnabled.apply(this,arguments),this.Invalidate()},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FURLColor=16711680,this.FTrimming=0,this.FURLUnderline=!0,this.FDisplayHTML=!0,this.FShadowOffset=1,this.FAutoOpenURL=!0,this.FShadowColor=8421504,this.FWordWrapping=!1,this.FAutoSize=!1,this.FAutoHeight=!0,this.FAutoWidth=!0,this.FHorizontalTextAlign=0,this.FVerticalTextAlign=0,this.FFont$1=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont$1.FOnChanged=rtl.createCallback(this,"DoFontChanged"),this.FAutoSizeSpacing=0,this.FStroke.SetColor(-1),this.IsDesignTime()&&(this.SetText("TTMSFNCHTMLText"),this.DisableBackground()),this.SetWidth(100),this.SetHeight(50),this},this.Destroy=function(){rtl.free(this,"FFont$1"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.GetTextRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=null,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0,n=0;(e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),e.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing,e.FBitmapContainer=this.GetBitmapContainer(),e.FFont.AssignSource(this.FFont$1);try{e.FFont.AssignSource(this.FFont$1),this.FWordWrapping?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.GetWidth(),1e4)):i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),t.$assign(e.CalculateText(this.FText,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FWordWrapping,this.FDisplayHTML)),s=t.Right-t.Left,n=t.Bottom-t.Top,t.Right=t.Left+s+2*this.FAutoSizeSpacing,t.Bottom=t.Top+n+2*this.FAutoSizeSpacing}finally{e.EndScene(),e=rtl.freeLoc(e)}return t},this.Assign=function(e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments),t.TTMSFNCHTMLText.isPrototypeOf(e)&&(this.FTrimming=rtl.as(e,t.TTMSFNCHTMLText).FTrimming,this.FAutoSize=rtl.as(e,t.TTMSFNCHTMLText).FAutoSize,this.FAutoWidth=rtl.as(e,t.TTMSFNCHTMLText).FAutoWidth,this.FAutoHeight=rtl.as(e,t.TTMSFNCHTMLText).FAutoHeight,this.FAutoSizeSpacing=rtl.as(e,t.TTMSFNCHTMLText).FAutoSizeSpacing,this.FAutoOpenURL=rtl.as(e,t.TTMSFNCHTMLText).FAutoOpenURL,this.FDisplayHTML=rtl.as(e,t.TTMSFNCHTMLText).FDisplayHTML,this.FFont$1.AssignSource(rtl.as(e,t.TTMSFNCHTMLText).FFont$1),this.FHorizontalTextAlign=rtl.as(e,t.TTMSFNCHTMLText).FHorizontalTextAlign,this.FShadowColor=rtl.as(e,t.TTMSFNCHTMLText).FShadowColor,this.FShadowOffset=rtl.as(e,t.TTMSFNCHTMLText).FShadowOffset,this.FText=rtl.as(e,t.TTMSFNCHTMLText).FText,this.FURLColor=rtl.as(e,t.TTMSFNCHTMLText).FURLColor,this.FURLUnderline=rtl.as(e,t.TTMSFNCHTMLText).FURLUnderline,this.FVerticalTextAlign=rtl.as(e,t.TTMSFNCHTMLText).FVerticalTextAlign,this.FWordWrapping=rtl.as(e,t.TTMSFNCHTMLText).FWordWrapping)},this.DoMouseMove=function(t,e,i){var s=null,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(this.IsHTML()){(s=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),s.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing,s.FBitmapContainer=this.GetBitmapContainer(),s.FFont.AssignSource(this.FFont$1);try{this.FAutoSize?this.FAutoWidth&&this.FAutoHeight?n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FAutoSizeSpacing,this.FAutoSizeSpacing,this.GetWidth()-this.FAutoSizeSpacing,this.GetHeight()-this.FAutoSizeSpacing)):this.FAutoWidth?n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FAutoSizeSpacing,0,this.GetWidth()-this.FAutoSizeSpacing,this.GetHeight())):this.FAutoHeight&&n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,this.FAutoSizeSpacing,this.GetWidth(),this.GetHeight()-this.FAutoSizeSpacing)):n.$assign(this.GetLocalRect()),""!==s.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),this.FText,this.FWordWrapping,this.FHorizontalTextAlign,this.FVerticalTextAlign,this.FTrimming,0,-1,-1,!0,!0,e,i)?this.SetControlCursor(21):this.SetControlCursor(0)}finally{s.EndScene(),s=rtl.freeLoc(s)}}},this.DoMouseDown=function(t,e,i,s){var n="",o=null,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(this.IsHTML()){(o=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),o.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing,o.FBitmapContainer=this.GetBitmapContainer(),o.FFont.AssignSource(this.FFont$1);try{this.FAutoSize?this.FAutoWidth&&this.FAutoHeight?r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FAutoSizeSpacing,this.FAutoSizeSpacing,this.GetWidth()-this.FAutoSizeSpacing,this.GetHeight()-this.FAutoSizeSpacing)):this.FAutoWidth?r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FAutoSizeSpacing,0,this.GetWidth()-this.FAutoSizeSpacing,this.GetHeight())):this.FAutoHeight&&r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,this.FAutoSizeSpacing,this.GetWidth(),this.GetHeight()-this.FAutoSizeSpacing)):r.$assign(this.GetLocalRect()),""!==(n=o.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),this.FText,this.FWordWrapping,this.FHorizontalTextAlign,this.FVerticalTextAlign,this.FTrimming,0,-1,-1,!0,!0,i,s))&&this.DoAnchorClick(n)}finally{o.EndScene(),o=rtl.freeLoc(o)}}},this.UpdateControlAfterResize=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.UpdateControlAfterResize.call(this),this.ApplyAutoSize()},this.IsHTML=function(){return!!this.FDisplayHTML&&(pas.System.Pos("</",this.FText)>0||pas.System.Pos("/>",this.FText)>0||pas.System.Pos("<BR>",pas.SysUtils.UpperCase(this.FText))>0)},this.Draw=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),t.FBitmapContainer=this.GetBitmapContainer(),this.DrawHTMLText(t),this.IsDesignTime()&&this.CanDrawDesignTime()&&t.DrawFocusRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),0,2)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAS"),e.addProperty("AutoHeight",2,rtl.boolean,"FAutoHeight","SetAutoHeight"),e.addProperty("AutoWidth",2,rtl.boolean,"FAutoWidth","SetAutoWidth"),e.addProperty("AutoSizeSpacing",2,rtl.double,"FAutoSizeSpacing","SetAutoSizeSpacing"),e.addProperty("AutoOpenURL",0,rtl.boolean,"FAutoOpenURL","FAutoOpenURL"),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("DisplayHTML",2,rtl.boolean,"FDisplayHTML","SetDisplayHTML"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont$1","SetFnt"),e.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign"),e.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming"),e.addProperty("ShadowColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FShadowColor","SetShadowColor"),e.addProperty("ShadowOffset",2,rtl.longint,"FShadowOffset","SetShadowOffset"),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("URLColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FURLColor","SetURLColor"),e.addProperty("URLUnderline",2,rtl.boolean,"FURLUnderline","SetURLUnderline"),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign"),e.addProperty("Version",1,rtl.string,"GetVersion",""),e.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping"),e.addProperty("OnAnchorClick",0,t.$rtti.TTMSFNCHTMLTextAnchorClickEvent,"FOnAnchorClick","FOnAnchorClick"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["SysUtils","WEBLib.TMSFNCUtils","WEBLib.TMSFNCStyles","WEBLib.Graphics"]),rtl.module("WEBLib.TMSFNCStatusBar",["System","Classes","SysUtils","Types","WEBLib.Controls","WEBLib.ExtCtrls","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCUtils","WEBLib.TMSFNCStyles"],(function(){"use strict";var t=this;this.TTMSFNCStatusBarPanelStyle={0:"spsHTML",spsHTML:0,1:"spsText",spsText:1,2:"spsOwnerDraw",spsOwnerDraw:2,3:"spsTime",spsTime:3,4:"spsDate",spsDate:4,5:"spsProgress",spsProgress:5,6:"spsImage",spsImage:6,7:"spsImageList",spsImageList:7,8:"spsEllipsText",spsEllipsText:8},this.$rtti.$Enum("TTMSFNCStatusBarPanelStyle",{minvalue:0,maxvalue:8,ordtype:1,enumtype:this.TTMSFNCStatusBarPanelStyle}),this.TTMSFNCStatusBarVerticalPanelAlignment={0:"spaTop",spaTop:0,1:"spaCenter",spaCenter:1,2:"spaBottom",spaBottom:2},this.$rtti.$Enum("TTMSFNCStatusBarVerticalPanelAlignment",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCStatusBarVerticalPanelAlignment}),this.TTMSFNCStatusBarPanelProgressIndication={0:"ppiPercentage",ppiPercentage:0,1:"ppiAbsolute",ppiAbsolute:1},this.$rtti.$Enum("TTMSFNCStatusBarPanelProgressIndication",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCStatusBarPanelProgressIndication}),rtl.recNewT(this,"TTMSFNCStatusBarPanelAnchor",(function(){this.AAnchor="",this.AIndex=0,this.$eq=function(t){return this.AAnchor===t.AAnchor&&this.AIndex===t.AIndex},this.$assign=function(t){return this.AAnchor=t.AAnchor,this.AIndex=t.AIndex,this}})),rtl.createClass(this,"TTMSFNCStatusBarAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FFont=null,this.FFill=null,this.FOnChange=null,this.FStroke=null},this.$final=function(){this.FFont=void 0,this.FFill=void 0,this.FOnChange=void 0,this.FStroke=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetFont=function(t){this.FFont.AssignSource(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.FillChanged=function(t){this.Changed()},this.FontChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.Create$1=function(){return this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this},this.Destroy=function(){rtl.free(this,"FFont"),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCStatusBarAppearance.isPrototypeOf(e)?(this.FFill.Assign(rtl.as(e,t.TTMSFNCStatusBarAppearance).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCStatusBarAppearance).FStroke),this.FFont.AssignSource(rtl.as(e,t.TTMSFNCStatusBarAppearance).FFont)):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke")})),rtl.createClass(this,"TTMSFNCStatusBarProgressAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FMax=0,this.FLevel1Perc=0,this.FShowIndication=!1,this.FBackgroundFill=null,this.FMin=0,this.FIndication=0,this.FLevel2Fill=null,this.FLevel3Fill=null,this.FLevel0Fill=null,this.FLevel1Fill=null,this.FBorderStroke=null,this.FOnChange=null,this.FPosition=0,this.FLevel2Perc=0},this.$final=function(){this.FBackgroundFill=void 0,this.FLevel2Fill=void 0,this.FLevel3Fill=void 0,this.FLevel0Fill=void 0,this.FLevel1Fill=void 0,this.FBorderStroke=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetBackgroundFill=function(t){this.FBackgroundFill.Assign(t)},this.SetBorderStroke=function(t){this.FBorderStroke.Assign(t)},this.SetIndication=function(t){this.FIndication!==t&&(this.FIndication=t,this.Changed())},this.SetLevel0Fill=function(t){this.FLevel0Fill.Assign(t)},this.SetLevel1Fill=function(t){this.FLevel1Fill.Assign(t)},this.SetLevel1Perc=function(t){this.FLevel1Perc!==t&&(this.FLevel1Perc=t,this.Changed())},this.SetLevel2Fill=function(t){this.FLevel2Fill.Assign(t)},this.SetLevel2Perc=function(t){this.FLevel2Perc!==t&&(this.FLevel2Perc=t,this.Changed())},this.SetLevel3Fill=function(t){this.FLevel3Fill.Assign(t)},this.SetMax=function(t){this.FMax!==t&&(this.FMax=t,this.Changed())},this.SetMin=function(t){this.FMin!==t&&(this.FMin=t,this.Changed())},this.SetPosition=function(t){this.FPosition!==t&&(this.FPosition=t,this.Changed())},this.SetShowIndication=function(t){this.FShowIndication!==t&&(this.FShowIndication=t,this.Changed())},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.FillChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.Create$1=function(){return this.FLevel0Fill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FLevel1Fill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FLevel2Fill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FLevel3Fill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FBackgroundFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FBorderStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FIndication=0,this.FMin=0,this.FMax=100,this.FPosition=0,this.FLevel1Perc=70,this.FLevel2Perc=90,this.FShowIndication=!0,this.FLevel0Fill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FLevel1Fill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FLevel2Fill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FLevel3Fill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FBackgroundFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FBorderStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FBackgroundFill.SetColor(16777215),this.FBorderStroke.SetColor(12632256),this.FLevel0Fill.SetColor(65280),this.FLevel1Fill.SetColor(65535),this.FLevel2Fill.SetColor(42495),this.FLevel3Fill.SetColor(255),this},this.Destroy=function(){rtl.free(this,"FLevel0Fill"),rtl.free(this,"FLevel1Fill"),rtl.free(this,"FLevel2Fill"),rtl.free(this,"FLevel3Fill"),rtl.free(this,"FBackgroundFill"),rtl.free(this,"FBorderStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCStatusBarProgressAppearance.isPrototypeOf(e)?(this.FLevel0Fill.Assign(rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FLevel0Fill),this.FLevel1Fill.Assign(rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FLevel1Fill),this.FLevel2Fill.Assign(rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FLevel2Fill),this.FLevel3Fill.Assign(rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FLevel3Fill),this.FBackgroundFill.Assign(rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FBackgroundFill),this.FBorderStroke.Assign(rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FBorderStroke),this.FLevel1Perc=rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FLevel1Perc,this.FLevel2Perc=rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FLevel2Perc,this.FIndication=rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FIndication,this.FMin=rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FMin,this.FMax=rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FMax,this.FPosition=rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FPosition,this.FShowIndication=rtl.as(e,t.TTMSFNCStatusBarProgressAppearance).FShowIndication):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("BackgroundFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FBackgroundFill","SetBackgroundFill"),e.addProperty("BorderStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FBorderStroke","SetBorderStroke"),e.addProperty("Indication",2,t.$rtti.TTMSFNCStatusBarPanelProgressIndication,"FIndication","SetIndication",{Default:t.TTMSFNCStatusBarPanelProgressIndication.ppiPercentage}),e.addProperty("Level0Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FLevel0Fill","SetLevel0Fill"),e.addProperty("Level1Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FLevel1Fill","SetLevel1Fill"),e.addProperty("Level2Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FLevel2Fill","SetLevel2Fill"),e.addProperty("Level3Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FLevel3Fill","SetLevel3Fill"),e.addProperty("Level1Perc",2,rtl.longint,"FLevel1Perc","SetLevel1Perc",{Default:70}),e.addProperty("Level2Perc",2,rtl.longint,"FLevel2Perc","SetLevel2Perc",{Default:90}),e.addProperty("Max",2,rtl.longint,"FMax","SetMax",{Default:100}),e.addProperty("Min",2,rtl.longint,"FMin","SetMin",{Default:0}),e.addProperty("Position",2,rtl.longint,"FPosition","SetPosition"),e.addProperty("ShowIndication",2,rtl.boolean,"FShowIndication","SetShowIndication",{Default:!0})})),rtl.createClass(this,"TTMSFNCStatusBarPanel",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FEnabled=!1,this.FButton=!1,this.FTimeFormat="",this.FWidth=0,this.FAlignment=0,this.FMinWidth=0,this.FDateFormat="",this.FVerticalAlign=0,this.FText="",this.FStyle=0,this.FImageIndex=0,this.FImageCount=0,this.FAutoSize=!1,this.FHint="",this.FProgress=null,this.FOffset=null,this.FVisible=!1,this.FControl=null,this.FControlAlign=0,this.FControlParent=null,this.FControlVisible=!1,this.FControlPrevAlign=0,this.FControlLeft=0,this.FControlTop=0,this.FControlWidth=0,this.FControlHeight=0},this.$final=function(){this.FProgress=void 0,this.FOffset=void 0,this.FControl=void 0,this.FControlParent=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetAlignment=function(t){this.FAlignment!==t&&(this.FAlignment=t,this.Update())},this.SetButton=function(t){this.FButton!==t&&(this.FButton=t,this.Update())},this.SetDateFormat=function(t){this.FDateFormat!==t&&(this.FDateFormat=t,this.Update())},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t,this.Update())},this.SetMinWidth=function(t){this.FMinWidth!==t&&(this.FMinWidth=t,this.Update())},this.SetStyle=function(t){this.FStyle!==t&&(this.FStyle=t,3===this.FStyle?this.FText=pas.SysUtils.FormatDateTime(this.FTimeFormat,pas.SysUtils.Now()):4===this.FStyle&&(this.FText=pas.SysUtils.FormatDateTime(this.FDateFormat,pas.SysUtils.Now())),this.Update())},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.FAutoSize&&null!=this.FCollection&&this.FCollection.FOwner.AutoSizePanels(),this.Update())},this.SetTimeFormat=function(t){this.FTimeFormat!==t&&(this.FTimeFormat=t,this.Update())},this.SetVerticalAlign=function(t){this.FVerticalAlign!==t&&(this.FVerticalAlign=t,this.Update())},this.SetWidth=function(t){this.FWidth!==t&&(this.FWidth=t,this.Update())},this.SetImageIndex=function(t){this.FImageIndex!==t&&(this.FImageIndex=t,this.Update())},this.SetImageCount=function(t){this.FImageCount!==t&&(this.FImageCount=t,this.Update())},this.SetAutoSize=function(t){this.FAutoSize!==t&&(this.FAutoSize=t,this.FAutoSize&&null!=this.FCollection&&this.FCollection.FOwner.AutoSizePanels(),this.Update())},this.SetHint=function(t){this.FHint!==t&&(this.FHint=t)},this.SetProgress=function(t){this.FProgress.Assign(t)},this.SetOffset=function(t){this.FOffset!==t&&(this.FOffset=t,this.Update())},this.IsDateFormatStored=function(){return"dd/MM/yyyy"!==this.FDateFormat},this.IsTextStored=function(){return""!==this.FText},this.IsTimeFormatStored=function(){return"hh:mm:ss"!==this.FTimeFormat},this.IsHintStored=function(){return""!==this.FHint},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,this.Update())},this.SetControl=function(e){var i=0,s=null;if(this.FControl!==e){if(null==(s=rtl.as(this.FCollection,t.TTMSFNCStatusBarPanels).FOwner)||0 in s.FComponentState||null==this.FControl||(this.FControl.SetParent(this.FControlParent),this.FControl.SetVisible(this.FControlVisible),this.FControl.SetAlign(this.FControlPrevAlign),this.FControl.SetLeft(Math.round(this.FControlLeft)),this.FControl.SetTop(Math.round(this.FControlTop)),this.FControl.SetWidth(Math.round(this.FControlWidth)),this.FControl.SetHeight(Math.round(this.FControlHeight))),null!=s)for(var n=0,o=s.FPanels.GetCount()-1;n<=o;n++)i=n,s.FPanels.GetItem$1(i).FControl===e&&(s.FPanels.GetItem$1(i).FControl=null);this.FControl=e,null!=this.FControl&&(this.FControlParent=this.FControl.FParent,this.FControlVisible=this.FControl.FVisible,this.FControlPrevAlign=this.FControl.FAlign,this.FControl.SetAlign(0),this.FControlLeft=this.FControl.GetLeft(),this.FControlTop=this.FControl.GetTop(),this.FControlWidth=this.FControl.GetWidth(),this.FControlHeight=this.FControl.GetHeight(),null!=s&&this.FControl.FParent!==s&&this.FControl.SetParent(s)),null!=this.FControl&&this.UpdateControlBounds()}},this.SetControlAlign=function(t){this.FControlAlign!==t&&(this.FControlAlign=t,null!=this.FControl&&this.UpdateControlBounds())},this.Update=function(){this.FCollection.Update(this)},this.OffsetChanged=function(t){this.Update()},this.ProgressChanged=function(t){this.Update()},this.UpdateControlBounds=function(){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=null;if(null!=this.FControl&&null!=this.FCollection&&t.TTMSFNCStatusBarPanels.isPrototypeOf(this.FCollection)&&null!=rtl.as(this.FCollection,t.TTMSFNCStatusBarPanels).FOwner){i=rtl.as(this.FCollection,t.TTMSFNCStatusBarPanels).FOwner,e.$assign(i.GetPanelRect(this.GetIndex()));var s=this.FControlAlign;0===s?(e.Left=e.Left+this.FControl.GetLeft(),e.Right=e.Left+this.FControl.GetWidth(),e.Top=e.Top+this.FControl.GetTop(),e.Bottom=e.Top+this.FControl.GetHeight()):1===s?e.Bottom=e.Top+this.FControl.GetHeight():2===s?e.Top=e.Bottom-this.FControl.GetHeight():3===s?e.Right=e.Left+this.FControl.GetWidth():4===s&&(e.Left=e.Right-this.FControl.GetWidth()),pas["WEBLib.TMSFNCTypes"].EqualRectEx(pas["WEBLib.TMSFNCTypes"].ConvertToRectF(this.FControl.GetBoundsRect()),e)||(this.FControl.SetBounds(Math.round(e.Left),Math.round(e.Top),Math.round(e.Right-e.Left),Math.round(e.Bottom-e.Top)),i.Invalidate())}},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FText="",this.FStyle=0,this.FMinWidth=20,this.FWidth=50,this.FEnabled=!0,this.FDateFormat="dd/MM/yyyy",this.FTimeFormat="hh:mm:ss",this.FAlignment=0,this.FVerticalAlign=1,this.FButton=!1,this.FImageIndex=-1,this.FImageCount=1,this.FAutoSize=!1,this.FProgress=t.TTMSFNCStatusBarProgressAppearance.$create("Create$1"),this.FProgress.FOnChange=rtl.createCallback(this,"ProgressChanged"),this.FOffset=pas["WEBLib.TMSFNCTypes"].TTMSFNCPoint.$create("Create$1"),this.FOffset.FOnChange=rtl.createCallback(this,"OffsetChanged"),this.FVisible=!0,this.FControlAlign=5,this},this.Destroy=function(){rtl.free(this,"FProgress"),rtl.free(this,"FOffset"),pas.Classes.TCollectionItem.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCStatusBarPanel.isPrototypeOf(e)?(this.FText=rtl.as(e,t.TTMSFNCStatusBarPanel).FText,this.FStyle=rtl.as(e,t.TTMSFNCStatusBarPanel).FStyle,this.FMinWidth=rtl.as(e,t.TTMSFNCStatusBarPanel).FMinWidth,this.FWidth=rtl.as(e,t.TTMSFNCStatusBarPanel).FWidth,this.FEnabled=rtl.as(e,t.TTMSFNCStatusBarPanel).FEnabled,this.FDateFormat=rtl.as(e,t.TTMSFNCStatusBarPanel).FDateFormat,this.FTimeFormat=rtl.as(e,t.TTMSFNCStatusBarPanel).FTimeFormat,this.FAlignment=rtl.as(e,t.TTMSFNCStatusBarPanel).FAlignment,this.FVerticalAlign=rtl.as(e,t.TTMSFNCStatusBarPanel).FVerticalAlign,this.FButton=rtl.as(e,t.TTMSFNCStatusBarPanel).FButton,this.FImageIndex=rtl.as(e,t.TTMSFNCStatusBarPanel).FImageIndex,this.FImageCount=rtl.as(e,t.TTMSFNCStatusBarPanel).FImageCount,this.FAutoSize=rtl.as(e,t.TTMSFNCStatusBarPanel).FAutoSize,this.FProgress.Assign(rtl.as(e,t.TTMSFNCStatusBarPanel).FProgress),this.FOffset.Assign(rtl.as(e,t.TTMSFNCStatusBarPanel).FOffset),this.FControl=rtl.as(e,t.TTMSFNCStatusBarPanel).FControl,this.FControlAlign=rtl.as(e,t.TTMSFNCStatusBarPanel).FControlAlign):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAutoSize",{Default:!1}),e.addProperty("Text",14,rtl.string,"FText","SetText",{stored:"IsTextStored"}),e.addProperty("Style",2,t.$rtti.TTMSFNCStatusBarPanelStyle,"FStyle","SetStyle",{Default:t.TTMSFNCStatusBarPanelStyle.spsHTML}),e.addProperty("MinWidth",2,rtl.longint,"FMinWidth","SetMinWidth",{Default:20}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("DateFormat",14,rtl.string,"FDateFormat","SetDateFormat",{stored:"IsDateFormatStored"}),e.addProperty("TimeFormat",14,rtl.string,"FTimeFormat","SetTimeFormat",{stored:"IsTimeFormatStored"}),e.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment",{Default:pas.Classes.TAlignment.taLeftJustify}),e.addProperty("ImageIndex",2,rtl.longint,"FImageIndex","SetImageIndex",{Default:-1}),e.addProperty("ImageCount",2,rtl.longint,"FImageCount","SetImageCount",{Default:1}),e.addProperty("VerticalAlign",2,t.$rtti.TTMSFNCStatusBarVerticalPanelAlignment,"FVerticalAlign","SetVerticalAlign",{Default:t.TTMSFNCStatusBarVerticalPanelAlignment.spaCenter}),e.addProperty("Button",2,rtl.boolean,"FButton","SetButton",{Default:!1}),e.addProperty("Width",2,rtl.longint,"FWidth","SetWidth"),e.addProperty("Hint",14,rtl.string,"FHint","SetHint",{stored:"IsHintStored"}),e.addProperty("Progress",2,t.$rtti.TTMSFNCStatusBarProgressAppearance,"FProgress","SetProgress"),e.addProperty("Offset",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCPoint,"FOffset","SetOffset"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Control",2,pas["WEBLib.Controls"].$rtti.TControl,"FControl","SetControl"),e.addProperty("ControlAlign",2,pas["WEBLib.TMSFNCCustomControl"].$rtti.TTMSFNCControlAlignment,"FControlAlign","SetControlAlign",{Default:pas["WEBLib.TMSFNCCustomControl"].TTMSFNCControlAlignment.caClient})})),rtl.createClass(this,"TTMSFNCStatusBarPanels",pas.Classes.TCollection,(function(){this.$init=function(){pas.Classes.TCollection.$init.call(this),this.FOwner=null,this.FOnChange=null},this.$final=function(){this.FOwner=void 0,this.FOnChange=void 0,pas.Classes.TCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.DoChange=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Update=function(t){pas.Classes.TCollection.Update.apply(this,arguments),this.DoChange()},this.Create$2=function(e){return pas.Classes.TCollection.Create$1.call(this,t.TTMSFNCStatusBarPanel),this.FOwner=e,this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)}})),this.$rtti.$MethodVar("TTMSFNCStatusBarBeforeDrawPanelEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["APanel",this.$rtti.TTMSFNCStatusBarPanel],["AAllow",rtl.boolean],["ADefaultDraw",rtl.boolean]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCStatusBarAfterDrawPanelEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["APanel",this.$rtti.TTMSFNCStatusBarPanel]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCStatusBarDrawCustomPanelEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["APanel",this.$rtti.TTMSFNCStatusBarPanel]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCStatusBarPanelLeftClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["PanelIndex",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCStatusBarPanelRightClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["PanelIndex",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCStatusBarPanelAnchorClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["APanel",this.$rtti.TTMSFNCStatusBarPanel],["AAnchor",rtl.string]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomStatusBar",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FTimer=null,this.FHoverPanelIndex=0,this.FDownPanelIndex=0,this.FBitmapContainer=null,this.FPanels=null,this.FPanelPos=0,this.FOnDrawCustomPanel=null,this.FOnPanelLeftClick=null,this.FOnPanelRightClick=null,this.FOnAnchorClick=null,this.FOnAfterDrawPanel=null,this.FOnBeforeDrawPanel=null,this.FAppearance=null,this.FShowSplitter=!1,this.FMouseDown=!1,this.FVerMargin=0},this.$final=function(){this.FTimer=void 0,this.FBitmapContainer=void 0,this.FPanels=void 0,this.FOnDrawCustomPanel=void 0,this.FOnPanelLeftClick=void 0,this.FOnPanelRightClick=void 0,this.FOnAnchorClick=void 0,this.FOnAfterDrawPanel=void 0,this.FOnBeforeDrawPanel=void 0,this.FAppearance=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetPanels=function(t){this.FPanels.Assign(t)},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,this.Invalidate()},this.SetAppearance=function(t){this.FAppearance.Assign(t)},this.SetShowSplitter=function(t){this.FShowSplitter!==t&&(this.FShowSplitter=t,this.Invalidate())},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.DoAnchorClick=function(t,e){null!=this.FOnAnchorClick?this.FOnAnchorClick(this,t,e):pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(e)},this.DoBeforeDrawPanel=function(t,e,i,s,n){null!=this.FOnBeforeDrawPanel&&this.FOnBeforeDrawPanel(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoAfterDrawPanel=function(t,e,i){null!=this.FOnAfterDrawPanel&&this.FOnAfterDrawPanel(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.Notification=function(t,e){var i=0;if(pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null),!(3 in this.FComponentState)&&1===e)for(var s=0,n=this.FPanels.GetCount()-1;s<=n;s++)i=s,t===this.FPanels.GetItem$1(i).FControl&&(this.FPanels.GetItem$1(i).FControl=null)},this.Draw=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),t.FBitmapContainer=this.GetBitmapContainer(),this.DrawAllPanels(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},this.DoAfterDraw=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.DoAfterDraw.apply(this,arguments),t.FStroke.Assign(this.FAppearance.FStroke),t.FFill.SetKind(0),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),2)},this.HandleMouseDown=function(t,e,i,s){var n=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.CaptureEx(),this.FMouseDown=!0,-1!==(n=this.GetPanelIndex(i,s))&&(this.FDownPanelIndex=n,null!=this.FOnPanelLeftClick&&0===t&&this.FOnPanelLeftClick(this,n),null!=this.FOnPanelRightClick&&1===t&&this.FOnPanelRightClick(this,n)),this.Invalidate()},this.HandleMouseMove=function(e,i,s){var n=t.TTMSFNCStatusBarPanelAnchor.$new();pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),n.$assign(this.XYToPanelAnchor(i,s)),""!==n.AAnchor?this.SetControlCursor(21):this.SetControlCursor(0),this.FHoverPanelIndex!==n.AIndex&&(this.FHoverPanelIndex=n.AIndex,this.Invalidate())},this.HandleMouseUp=function(t,e,i,s){var n=0,o="";pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),""!==(o=this.XYToPanelAnchor(i,s).AAnchor)&&(n=this.GetPanelIndex(i,s),this.DoAnchorClick(this.FPanels.GetItem$1(n),o)),this.FMouseDown=!1,this.FDownPanelIndex=-1,this.ReleaseCaptureEx(),this.Invalidate()},this.HandleMouseLeave=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),this.FHoverPanelIndex=-1,this.Invalidate()},this.DrawAllPanels=function(t,e){var i=0,s=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=!1,r=!1;s=-1;for(var a=this.FPanels.GetCount()-1;a>=0;a--)if(i=a,this.FPanels.GetItem$1(i).FVisible){s=i;break}for(var l=0,h=this.FPanels.GetCount()-1;l<=h;l++)i=l,this.FPanels.GetItem$1(i).FVisible&&(i===s?n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FPanelPos,0,this.FPanelPos+this.GetLastPanelWidth(),this.GetHeight())):n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FPanelPos,0,this.FPanelPos+this.FPanels.GetItem$1(i).FWidth,this.GetHeight())),o=!0,r=!0,this.DoBeforeDrawPanel(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),this.FPanels.GetItem$1(i),o,r),o&&(r&&this.DrawPanel(this.FPanels.GetItem$1(i),t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n)),this.DoAfterDrawPanel(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),this.FPanels.GetItem$1(i))),this.FPanelPos=this.FPanelPos+this.FPanels.GetItem$1(i).FWidth);this.FPanelPos=0},this.DrawPanel=function(t,e,i){var s=0,n=0,o=0,r=0,a=0,l=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=0,p=0;t.FButton?t.FEnabled?t.GetIndex()===this.FDownPanelIndex?e.DrawButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),!0,!1,!0,!0,1):t.GetIndex()===this.FHoverPanelIndex?e.DrawButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),!1,!0,!0,!0,1):e.DrawButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),!1,!1,!0,!0,1):e.DrawButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),!1,!1,!1,!0,1):(e.FFill.Assign(this.FAppearance.FFill),e.FStroke.SetColor(this.FAppearance.FFill.FColor),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),0)),this.FShowSplitter&&(e.FStroke.Assign(this.FAppearance.FStroke),e.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,i.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,i.Bottom)),2,2)),e.FFont.AssignSource(this.FAppearance.FFont),t.FEnabled?e.FFont.SetColor(this.FAppearance.FFont.FColor):e.FFont.SetColor(12632256),h.$assign(i),h.Right=h.Right-t.FOffset.FX,h.Bottom=h.Bottom-t.FOffset.FY,pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(h,t.FOffset.FX,t.FOffset.FY),p=0,F=0;var c=t.FAlignment;0===c?p=1:1===c?p=2:2===c&&(p=0);var u=t.FVerticalAlign;if(0===u?F=1:1===u?F=0:2===u&&(F=2),null==t.FControl){var T=t.FStyle;if(1===T)pas["WEBLib.TMSFNCTypes"].InflateRectEx(h,-this.ScalePaintValue(10),0),e.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),t.FText,!1,p,F,0,0,-1,-1,!1,!1,-1,-1);else if(0===T)pas["WEBLib.TMSFNCTypes"].InflateRectEx(h,-this.ScalePaintValue(10),0),e.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),t.FText,!1,p,F,0,0,-1,-1,!0,!1,-1,-1);else if(2===T)null!=this.FOnDrawCustomPanel&&this.FOnDrawCustomPanel(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),t);else if(5===T)this.DrawProgressBar(e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),t);else if(6===T){if(null!=this.GetBitmapContainer()&&-1!==t.FImageIndex){r=this.GetBitmapContainer().GetBitmap(t.FImageIndex).GetWidth(),a=this.GetBitmapContainer().GetBitmap(t.FImageIndex).GetHeight(),l.$assign(i),l.Right=l.Left+r,o=0,""!==t.FText&&(h.$assign(i),h.Right=i.Right-r-this.ScalePaintValue(this.FVerMargin),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(h,r+this.ScalePaintValue(this.FVerMargin),0),o=Math.round(e.CalculateTextWidth(t.FText,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),!1,!1)),h.Right=h.Right-t.FOffset.FX,h.Bottom=h.Bottom-t.FOffset.FY,pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(h,t.FOffset.FX,t.FOffset.FY),pas["WEBLib.TMSFNCTypes"].InflateRectEx(h,-this.ScalePaintValue(this.FVerMargin),0),e.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),t.FText,!1,p,F,0,0,-1,-1,!1,!1,-1,-1));var C=p;0===C?l.Left=i.Left+(i.Right-i.Left-o)/2-r:1===C?l.Left=i.Left+this.ScalePaintValue(this.FVerMargin):2===C&&(l.Left=i.Right-r-this.ScalePaintValue(2*this.FVerMargin)-o);var S=F;0===S?l.Top=(this.GetHeight()-a)/2:1===S?l.Top=1:2===S&&(l.Top=this.GetHeight()-a),e.DrawBitmap$5(l.Left,l.Top,this.GetBitmapContainer().GetBitmap(t.FImageIndex))}}else if(7===T){if(null!=this.GetBitmapContainer()&&t.FImageIndex>-1&&t.FImageIndex<this.GetBitmapContainer().ItemCount()){r=this.GetBitmapContainer().GetBitmap(t.FImageIndex).GetWidth(),a=this.GetBitmapContainer().GetBitmap(t.FImageIndex).GetHeight(),l.$assign(i),l.Right=l.Left+r,pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(l,this.ScalePaintValue(this.FVerMargin),0);var d=F;0===d?l.Top=(this.GetHeight()-a)/2:1===d?l.Top=1:2===d&&(l.Top=this.GetHeight()-a),n=Math.min(t.FImageIndex+t.FImageCount,this.GetBitmapContainer().ItemCount());for(var m=t.FImageIndex,f=n-1;m<=f;m++)s=m,e.DrawBitmap$5(l.Left,l.Top,this.GetBitmapContainer().GetBitmap(s)),pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(l,r,0)}}else 8!==T&&3!==T&&4!==T||(pas["WEBLib.TMSFNCTypes"].InflateRectEx(h,-this.ScalePaintValue(this.FVerMargin),0),e.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(h),t.FText,!1,p,F,1,0,-1,-1,!1,!1,-1,-1))}},this.DrawProgressBar=function(t,e,i){var s,n,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(pas["WEBLib.TMSFNCTypes"].InflateRectEx(e,-this.ScalePaintValue(2),-this.ScalePaintValue(2)),t.FFill.Assign(i.FProgress.FBackgroundFill),t.FFont.AssignSource(this.FAppearance.FFont),t.FStroke.SetColor(-1),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),2),(s=Math.round(i.FProgress.FPosition/i.FProgress.FMax*100))<=i.FProgress.FLevel1Perc?t.FFill.Assign(i.FProgress.FLevel0Fill):s>i.FProgress.FLevel1Perc&&s<=i.FProgress.FLevel2Perc?t.FFill.Assign(i.FProgress.FLevel1Fill):s>i.FProgress.FLevel2Perc&&s<i.FProgress.FMax?t.FFill.Assign(i.FProgress.FLevel2Fill):t.FFill.Assign(i.FProgress.FLevel3Fill),o.$assign(e),n=s/100*(o.Right-o.Left),o.Right=o.Left+n,t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),0),i.FProgress.FShowIndication){var r=i.FProgress.FIndication;0===r?t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),pas.SysUtils.IntToStr(s)+"%",!1,0,0,0,0,-1,-1,!0,!1,-1,-1):1===r&&t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),pas.SysUtils.IntToStr(i.FProgress.FPosition),!1,0,0,0,0,-1,-1,!0,!1,-1,-1)}t.FStroke.Assign(i.FProgress.FBorderStroke),t.FFill.SetColor(-1),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),2)},this.AutoSizePanels=function(){for(var t=0,e=0,i=0,s=null,n=0,o=this.FPanels.GetCount()-1;n<=o;n++)if(t=n,(s=this.FPanels.GetItem$1(t)).FAutoSize){e=0,i=0;var r=s.FStyle;0===r?i=this.GetTextWidth(s.FText,!0):1===r||4===r||3===r?i=this.GetTextWidth(s.FText,!1):6===r&&(i=this.GetTextWidth(s.FText,!1),null!=this.GetBitmapContainer()&&s.FImageIndex>-1&&s.FImageIndex<this.GetBitmapContainer().ItemCount()&&(e=this.GetBitmapContainer().GetItems().GetItemEx(s.FImageIndex).FBitmap.GetWidth()+this.ScalePaintValue(this.FVerMargin))),s.SetWidth(Math.max(e+i+this.ScalePaintValue(2*this.FVerMargin),s.FMinWidth))}},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.AutoSizePanels()},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&this.FAppearance.FFont.SetColor(t),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleLineFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FStroke.SetColor(t),this.FStroke.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleAlternativeBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearance.FFill.SetColor(t),this.FFill.SetColor(t))},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FAppearance.FFill.SetColor(16777215),this.FAppearance.FStroke.SetColor(12632256),this.FAppearance.FFont.SetColor(0),this.FFill.SetColor(16777215),this.FStroke.SetColor(12632256)},this.UpdateStatusBar=function(){for(var t=0,e=0,i=this.FPanels.GetCount()-1;e<=i;e++){t=e;var s=this.FPanels.GetItem$1(t).FStyle;4===s?this.FPanels.GetItem$1(t).SetText(pas.SysUtils.FormatDateTime(this.FPanels.GetItem$1(t).FDateFormat,pas.SysUtils.Now())):3===s&&this.FPanels.GetItem$1(t).SetText(pas.SysUtils.FormatDateTime(this.FPanels.GetItem$1(t).FTimeFormat,pas.SysUtils.Now()))}},this.PanelsChanged=function(t){this.FPanels.FUpdateCount>0||0 in this.FComponentState||this.Invalidate()},this.AppearanceChanged=function(t){this.Invalidate()},this.StatusBarTimer=function(t){this.UpdateStatusBar()},this.GetLastPanelWidth=function(){var t=0,e=0,i=0;i=-1;for(var s=this.FPanels.GetCount()-1;s>=0;s--)if(e=s,this.FPanels.GetItem$1(e).FVisible){i=e;break}t=0;for(var n=0,o=this.FPanels.GetCount()-1;n<=o;n++)if(e=n,this.FPanels.GetItem$1(e).FVisible){if(t+this.ScalePaintValue(2*this.FVerMargin)>this.GetWidth())return this.ScalePaintValue(2*this.FVerMargin);if(e===i)return Math.round(this.GetWidth())-t;t+=this.FPanels.GetItem$1(e).FWidth}return Math.round(this.GetWidth())-t},this.GetTextWidth=function(t,e){var i=0,s=null;(s=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).FFont.AssignSource(this.FAppearance.FFont),s.BeginScene();try{i=e?Math.round(s.CalculateTextWidth$1(t)):Math.round(s.CalculateTextWidth(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),!1,!1))}finally{s.EndScene(),s=rtl.freeLoc(s)}return i},this.GetPanelIndex=function(t,e){var i=0,s=0,n=0,o=0,r=0;if(i=-1,e>this.GetHeight()||e<0)return i;n=0,r=-1;for(var a=this.FPanels.GetCount()-1;a>=0;a--)if(s=a,this.FPanels.GetItem$1(s).FVisible){r=s;break}for(var l=0,h=this.FPanels.GetCount()-1;l<=h;l++)if(s=l,this.FPanels.GetItem$1(s).FVisible){if(t<=n+(o=s===r?this.GetLastPanelWidth():this.FPanels.GetItem$1(s).FWidth))return i=s;n+=o}return i},this.XYToPanelAnchor=function(e,i){var s,n=t.TTMSFNCStatusBarPanelAnchor.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=null,a=0,l=0,h="",F="",p=null;if(n.AAnchor="",s=this.GetPanelIndex(e,i),n.AIndex=s,-1!==s&&0===(r=this.FPanels.GetItem$1(s)).FStyle){o.$assign(this.GetPanelRect(s)),s===this.FPanels.GetCount()-1&&(o.Right=o.Left+this.GetLastPanelWidth()),pas["WEBLib.TMSFNCTypes"].InflateRectEx(o,-this.ScalePaintValue(this.FVerMargin),0),o.Right=o.Right-r.FOffset.FX,o.Bottom=o.Bottom-r.FOffset.FY,pas["WEBLib.TMSFNCTypes"].OffsetRectEx$1(o,r.FOffset.FX,r.FOffset.FY),l=1,a=0;var c=r.FAlignment;0===c?l=1:1===c?l=2:2===c&&(l=0);var u=r.FVerticalAlign;0===u?a=1:1===u?a=0:2===u&&(a=2),h=r.FText,F="",(p=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),p.FBitmapContainer=this.GetBitmapContainer(),p.FFont.AssignSource(this.FAppearance.FFont);try{F=p.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),h,!1,l,a,0,0,-1,-1,!0,!0,e,i)}finally{p.EndScene(),p=rtl.freeLoc(p)}n.AAnchor=F}return n},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FPanels=t.TTMSFNCStatusBarPanels.$create("Create$2",[this]),this.FTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FTimer.SetInterval(100),this.FAppearance=t.TTMSFNCStatusBarAppearance.$create("Create$1"),this.FPanelPos=0,this.SetHeight(20),this.FHoverPanelIndex=-1,this.FDownPanelIndex=-1,this.FVerMargin=10,this.FShowSplitter=!0,this.FMouseDown=!1,this.SetAlign(2),this.FTimer.FOnTimer=rtl.createCallback(this,"StatusBarTimer"),this.FPanels.FOnChange=rtl.createCallback(this,"PanelsChanged"),this.FAppearance.FOnChange=rtl.createCallback(this,"AppearanceChanged"),this},this.Destroy=function(){rtl.free(this,"FPanels"),rtl.free(this,"FAppearance"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCustomStatusBar.isPrototypeOf(e)?(this.FBitmapContainer.Assign(rtl.as(e,t.TTMSFNCCustomStatusBar).GetBitmapContainer()),this.FPanels.Assign(rtl.as(e,t.TTMSFNCCustomStatusBar).FPanels),this.FAppearance.Assign(rtl.as(e,t.TTMSFNCCustomStatusBar).FAppearance),this.FShowSplitter=rtl.as(e,t.TTMSFNCCustomStatusBar).FShowSplitter):pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments)},this.GetPanelRect=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=0,s=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(-1,-1,-1,-1)),s=0;for(var o=0,r=t-1;o<=r;o++)i=o,this.FPanels.GetItem$1(i).FVisible&&(s+=this.FPanels.GetItem$1(i).FWidth);return t>=0&&t<=this.FPanels.GetCount()-1&&this.FPanels.GetItem$1(t).FVisible&&(n.Left=s,n.Top=0,n.Bottom=this.GetHeight(),n.Right=n.Left+this.FPanels.GetItem$1(t).FWidth),e.$assign(n),e},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCStatusBar",this.TTMSFNCCustomStatusBar,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alBottom}),e.addProperty("Panels",2,t.$rtti.TTMSFNCStatusBarPanels,"FPanels","SetPanels"),e.addProperty("PanelAppearance",2,t.$rtti.TTMSFNCStatusBarAppearance,"FAppearance","SetAppearance"),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("ShowSplitter",2,rtl.boolean,"FShowSplitter","SetShowSplitter",{Default:!0}),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("OnDrawCustomPanel",0,t.$rtti.TTMSFNCStatusBarDrawCustomPanelEvent,"FOnDrawCustomPanel","FOnDrawCustomPanel"),e.addProperty("OnPanelLeftClick",0,t.$rtti.TTMSFNCStatusBarPanelLeftClickEvent,"FOnPanelLeftClick","FOnPanelLeftClick"),e.addProperty("OnPanelRightClick",0,t.$rtti.TTMSFNCStatusBarPanelRightClickEvent,"FOnPanelRightClick","FOnPanelRightClick"),e.addProperty("OnAnchorClick",0,t.$rtti.TTMSFNCStatusBarPanelAnchorClickEvent,"FOnAnchorClick","FOnAnchorClick"),e.addProperty("OnBeforeDrawPanel",0,t.$rtti.TTMSFNCStatusBarBeforeDrawPanelEvent,"FOnBeforeDrawPanel","FOnBeforeDrawPanel"),e.addProperty("OnAfterDrawPanel",0,t.$rtti.TTMSFNCStatusBarAfterDrawPanelEvent,"FOnAfterDrawPanel","FOnAfterDrawPanel"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["Math"]),rtl.module("WEBLib.TMSFNCListBox",["System","Classes","WEBLib.TMSFNCTreeView","WEBLib.TMSFNCStyles","WEBLib.TMSFNCPersistence","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCCustomTreeView","WEBLib.TMSFNCBitmapContainer","TypInfo","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCControlPicker"],(function(){"use strict";var t=this,e=t.$impl;this.CLP_FMT="#LISTBOX#",this.$rtti.$Class("TTMSFNCListBoxInteraction"),rtl.createClass(this,"TTMSFNCListBoxItem",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FTag=0,this.FDataString="",this.FDataObject=null,this.FDataInteger=0,this.FListBox=null,this.FText="",this.FDBKey="",this.FChecked=!1,this.FDataBoolean=!1,this.FWordWrapping=!1,this.FTrimming=0,this.FTextAlign=0,this.FSelectedTextColor=0,this.FTextColor=0,this.FDisabledTextColor=0,this.FEnabled=!1,this.FBitmapName="",this.FBitmap=null,this.FHeight=0,this.FDataPointer=null,this.FBitmapHeight=0,this.FBitmapWidth=0},this.$final=function(){this.FDataObject=void 0,this.FListBox=void 0,this.FBitmap=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.UpdateItem())},this.SetHeight=function(t){this.FHeight!==t&&(this.FHeight=t,this.UpdateItem())},this.SetTrimming=function(t){this.FTrimming!==t&&(this.FTrimming=t,this.UpdateItem())},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,this.UpdateItem())},this.SetTextAlign=function(t){this.FTextAlign!==t&&(this.FTextAlign=t,this.UpdateItem())},this.SetSelectedTextColor=function(t){this.FSelectedTextColor!==t&&(this.FSelectedTextColor=t,this.UpdateItem())},this.SetTextColor=function(t){this.FTextColor!==t&&(this.FTextColor=t,this.UpdateItem())},this.SetDisabledTextColor=function(t){this.FDisabledTextColor!==t&&(this.FDisabledTextColor=t,this.UpdateItem())},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t,this.UpdateItem())},this.SetBitmapName=function(t){this.FBitmapName!==t&&(this.FBitmapName=t,this.UpdateItem())},this.SetBitmap=function(t){this.FBitmap!==t&&this.FBitmap.Assign(t)},this.SetChecked=function(t){var e=null,i=null;this.FChecked!==t&&(this.FChecked=t,null!=(e=this.ListBox())&&(null!=(i=e.GetNodeForItemIndex(this.GetIndex()))&&i.FCheckStates[0]!==this.FChecked&&(this.FChecked?e.FTreeView.CheckVirtualNode(i,0,!1):e.FTreeView.UnCheckVirtualNode(i,0,!1)),null!=e.FTreeView&&e.FTreeView.Invalidate()))},this.GetStrippedHTMLText=function(){return pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(this.FText)},this.IsHeightStored=function(){return-1!==this.FHeight},this.IsBitmapHeightStored=function(){return-1!==this.FBitmapHeight},this.IsBitmapWidthStored=function(){return-1!==this.FBitmapWidth},this.SetBitmapHeight=function(t){this.FBitmapHeight=t},this.SetBitmapWidth=function(t){this.FBitmapWidth=t},this.UpdateItem=function(){var t=null;null!=(t=this.ListBox())&&t.UpdateItems()},this.BitmapChanged=function(t){this.UpdateItem()},this.ListBox=function(){return this.FListBox},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FListBox=rtl.as(this.FCollection,t.TTMSFNCListBoxItems).ListBox()),this.FTextColor=0,this.FHeight=-1,this.FBitmapWidth=-1,this.FBitmapHeight=-1,this.FEnabled=!0,this.FSelectedTextColor=16777215,this.FDisabledTextColor=12632256,this.FWordWrapping=!1,this.FTextAlign=1,this.FTrimming=0,this.FBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FBitmap.FOnChange=rtl.createCallback(this,"BitmapChanged"),null!=this.FListBox&&this.Assign(this.FListBox.FDefaultItem),this.UpdateItem(),this},this.Destroy=function(){rtl.free(this,"FBitmap"),pas.Classes.TCollectionItem.Destroy.call(this),this.UpdateItem()},this.SaveToString=function(t){var e="";return null==this.FListBox||(e="",e+=this.FText,t||(e+="{0}"),t||(e=(e=(e=e+pas.SysUtils.BoolToStr(this.FChecked,!1)+";")+this.FBitmapName+";")+pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SaveBitmapToHexStr(this.FBitmap)+";",e+=""),t||(e+="{0}",e+=pas.SysUtils.BoolToStr(this.FEnabled,!1))),e},this.LoadFromString=function(t){var e=0,i=null,s=null,n=0,o="",r=0,a="";i=pas.Classes.TStringList.$create("Create$1");try{for(o=t;""!==o;){if(0===(r=pas.System.Pos("{0}",o))){i.Add(o);break}a=pas.System.Copy(o,1,r-1),i.Add(a),pas.System.Delete({get:function(){return o},set:function(t){o=t}},1,r-1+"{0}".length)}for(var l=0,h=i.GetCount()-1;l<=h;l++)if(e=l,""!==i.Get(e))if(0===e)this.SetText(i.Get(e));else if(1===e){s=pas.Classes.TStringList.$create("Create$1");try{pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.Split(";",i.Get(e),s,!1);for(var F=0,p=s.GetCount()-1;F<=p;F++)n=F,""!==s.Get(n)&&(0===n?this.SetChecked(pas.SysUtils.StrToBool(s.Get(n))):1===n?this.SetBitmapName(s.Get(n)):2===n&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.LoadBitmapFromHexStr(s.Get(n),this.FBitmap))}finally{s=rtl.freeLoc(s)}}else 2===e&&this.SetEnabled(pas.SysUtils.StrToBool(i.Get(e)))}finally{i=rtl.freeLoc(i)}},this.Assign=function(e){t.TTMSFNCListBoxItem.isPrototypeOf(e)&&(this.FTag=rtl.as(e,t.TTMSFNCListBoxItem).FTag,this.FText=rtl.as(e,t.TTMSFNCListBoxItem).FText,this.FTrimming=rtl.as(e,t.TTMSFNCListBoxItem).FTrimming,this.FWordWrapping=rtl.as(e,t.TTMSFNCListBoxItem).FWordWrapping,this.FTextAlign=rtl.as(e,t.TTMSFNCListBoxItem).FTextAlign,this.FTextColor=rtl.as(e,t.TTMSFNCListBoxItem).FTextColor,this.FSelectedTextColor=rtl.as(e,t.TTMSFNCListBoxItem).FSelectedTextColor,this.FDisabledTextColor=rtl.as(e,t.TTMSFNCListBoxItem).FDisabledTextColor,this.FEnabled=rtl.as(e,t.TTMSFNCListBoxItem).FEnabled,this.FBitmapName=rtl.as(e,t.TTMSFNCListBoxItem).FBitmapName,this.FBitmap.Assign(rtl.as(e,t.TTMSFNCListBoxItem).FBitmap),this.FHeight=rtl.as(e,t.TTMSFNCListBoxItem).FHeight,this.FBitmapHeight=rtl.as(e,t.TTMSFNCListBoxItem).FBitmapHeight,this.FBitmapWidth=rtl.as(e,t.TTMSFNCListBoxItem).FBitmapWidth,this.FDataPointer=rtl.as(e,t.TTMSFNCListBoxItem).FDataPointer,this.FDataBoolean=rtl.as(e,t.TTMSFNCListBoxItem).FDataBoolean,this.FDataObject=rtl.as(e,t.TTMSFNCListBoxItem).FDataObject,this.FDataString=rtl.as(e,t.TTMSFNCListBoxItem).FDataString,this.FDataInteger=rtl.as(e,t.TTMSFNCListBoxItem).FDataInteger,this.AssignData(e))},this.AssignData=function(e){t.TTMSFNCListBoxItem.isPrototypeOf(e)&&(this.FDataString=rtl.as(e,t.TTMSFNCListBoxItem).FDataString,this.FDataBoolean=rtl.as(e,t.TTMSFNCListBoxItem).FDataBoolean,this.FDataObject=rtl.as(e,t.TTMSFNCListBoxItem).FDataObject,this.FDataInteger=rtl.as(e,t.TTMSFNCListBoxItem).FDataInteger,this.FDataPointer=rtl.as(e,t.TTMSFNCListBoxItem).FDataPointer,this.FDBKey=rtl.as(e,t.TTMSFNCListBoxItem).FDBKey)};var e=this.$rtti;e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("Bitmap",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FBitmap","SetBitmap"),e.addProperty("BitmapWidth",14,rtl.double,"FBitmapWidth","SetBitmapWidth",{stored:"IsBitmapWidthStored"}),e.addProperty("BitmapHeight",14,rtl.double,"FBitmapHeight","SetBitmapHeight",{stored:"IsBitmapHeightStored"}),e.addProperty("BitmapName",2,rtl.string,"FBitmapName","SetBitmapName"),e.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!1}),e.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttNone}),e.addProperty("TextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FTextAlign","SetTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaLeading}),e.addProperty("TextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FTextColor","SetTextColor",{Default:0}),e.addProperty("SelectedTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FSelectedTextColor","SetSelectedTextColor",{Default:16777215}),e.addProperty("DisabledTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDisabledTextColor","SetDisabledTextColor",{Default:12632256}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Height",14,rtl.double,"FHeight","SetHeight",{stored:"IsHeightStored"}),e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag",{Default:0})})),this.TTMSFNCListBoxItemsSortMode={0:"ismAscending",ismAscending:0,1:"ismDescending",ismDescending:1},this.TTMSFNCListBoxItemsSortKind={0:"iskNone",iskNone:0,1:"iskAscending",iskAscending:1,2:"iskDescending",iskDescending:2},this.$rtti.$Enum("TTMSFNCListBoxItemsSortKind",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCListBoxItemsSortKind}),rtl.createClass(this,"TTMSFNCListBoxItems",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FListBox=null},this.$final=function(){this.FListBox=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.GetItemClass=function(){return t.TTMSFNCListBoxItem},this.Compare=function(t,e,i,s){var n=0,o=null;return n=0,null==(o=this.ListBox())||(n=i?pas.SysUtils.AnsiCompareStr(t.GetStrippedHTMLText(),e.GetStrippedHTMLText()):pas.SysUtils.AnsiCompareStr(pas.SysUtils.UpperCase(t.GetStrippedHTMLText()),pas.SysUtils.UpperCase(e.GetStrippedHTMLText())),1===s&&(n*=-1),o.DoItemCompare(t,e,{get:function(){return n},set:function(t){n=t}})),n},this.QuickSort=function(t,e,i,s){var n,o,r,a=0,l=0,h=0,F=null;F=this.FItems;do{a=t,l=e,h=t+e>>>1;do{for(;this.Compare(this.GetItem$1(a),this.GetItem$1(h),i,s)<0;)a+=1;for(;this.Compare(this.GetItem$1(l),this.GetItem$1(h),i,s)>0;)l-=1;a<=l&&(n=a,o=l,r=void 0,r=F.Get(n),F.Put(n,F.Get(o)),F.Put(o,r),h===a?h=l:h===l&&(h=a),a+=1,l-=1)}while(!(a>l));t<l&&this.QuickSort(t,l,i,s),t=a}while(!(a>=e))},this.ListBox=function(){return this.FListBox},this.Create$3=function(t){return pas.Classes.TOwnedCollection.Create$2.call(this,t,this.GetItemClass()),this.FListBox=t,this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)},this.Clear$1=function(){var t=null;null!=(t=this.ListBox())&&t.BeginUpdate(),pas.Classes.TCollection.Clear.call(this),null!=t&&t.EndUpdate()},this.Sort$1=function(t,e){var i=null;null!=(i=this.ListBox())&&(i.FSortMode=e,i.BeginUpdate(),this.BeginUpdate(),this.GetCount()>1&&this.QuickSort(0,this.GetCount()-1,t,e),this.EndUpdate(),i.EndUpdate())}})),rtl.createClass(this,"TTMSFNCListBoxLookup",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null},this.$final=function(){this.FOwner=void 0,pas.Classes.TPersistent.$final.call(this)},this.GetAutoSelect=function(){var t=!1;return t=!1,null!=this.FOwner&&null!=this.FOwner.FListBox&&null!=this.FOwner.FListBox.FTreeView&&(t=this.FOwner.FListBox.FTreeView.FInteraction.FLookup.FAutoSelect),t},this.GetCaseSensitive=function(){var t=!1;return t=!1,null!=this.FOwner&&null!=this.FOwner.FListBox&&null!=this.FOwner.FListBox.FTreeView&&(t=this.FOwner.FListBox.FTreeView.FInteraction.FLookup.FCaseSensitive),t},this.GetEnabled=function(){var t=!1;return t=!1,null!=this.FOwner&&null!=this.FOwner.FListBox&&null!=this.FOwner.FListBox.FTreeView&&(t=this.FOwner.FListBox.FTreeView.FInteraction.FLookup.FEnabled),t},this.GetIncremental=function(){var t=!1;return t=!1,null!=this.FOwner&&null!=this.FOwner.FListBox&&null!=this.FOwner.FListBox.FTreeView&&(t=this.FOwner.FListBox.FTreeView.FInteraction.FLookup.FIncremental),t},this.SetAutoSelect=function(t){null!=this.FOwner&&null!=this.FOwner.FListBox&&null!=this.FOwner.FListBox.FTreeView&&(this.FOwner.FListBox.FTreeView.FInteraction.FLookup.FAutoSelect=t)},this.SetCaseSensitive=function(t){null!=this.FOwner&&null!=this.FOwner.FListBox&&null!=this.FOwner.FListBox.FTreeView&&(this.FOwner.FListBox.FTreeView.FInteraction.FLookup.FCaseSensitive=t)},this.SetEnabled=function(t){null!=this.FOwner&&null!=this.FOwner.FListBox&&null!=this.FOwner.FListBox.FTreeView&&(this.FOwner.FListBox.FTreeView.FInteraction.FLookup.FEnabled=t)},this.SetIncremental=function(t){null!=this.FOwner&&null!=this.FOwner.FListBox&&null!=this.FOwner.FListBox.FTreeView&&(this.FOwner.FListBox.FTreeView.FInteraction.FLookup.FIncremental=t)},this.Create$1=function(t){return this.FOwner=t,this};var t=this.$rtti;t.addProperty("CaseSensitive",3,rtl.boolean,"GetCaseSensitive","SetCaseSensitive",{Default:!1}),t.addProperty("Enabled",3,rtl.boolean,"GetEnabled","SetEnabled",{Default:!0}),t.addProperty("Incremental",3,rtl.boolean,"GetIncremental","SetIncremental",{Default:!0}),t.addProperty("AutoSelect",3,rtl.boolean,"GetAutoSelect","SetAutoSelect",{Default:!0})})),rtl.createClass(this,"TTMSFNCListBoxFiltering",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null},this.$final=function(){this.FOwner=void 0,pas.Classes.TPersistent.$final.call(this)},this.GetDropDownHeight=function(){var t=0;return t=120,null!=this.FOwner&&null!=this.FOwner.FListBox&&null!=this.FOwner.FListBox.FTreeView&&this.FOwner.FListBox.FTreeView.FColumns.GetCount()>0&&(t=this.FOwner.FListBox.FTreeView.FColumns.GetItem$1(0).FFiltering.FDropDownHeight),t},this.GetDropDownWidth=function(){var t=0;return t=100,null!=this.FOwner&&null!=this.FOwner.FListBox&&null!=this.FOwner.FListBox.FTreeView&&this.FOwner.FListBox.FTreeView.FColumns.GetCount()>0&&(t=this.FOwner.FListBox.FTreeView.FColumns.GetItem$1(0).FFiltering.FDropDownWidth),t},this.GetEnabled=function(){var t=!1;return t=!1,null!=this.FOwner&&null!=this.FOwner.FListBox&&null!=this.FOwner.FListBox.FTreeView&&this.FOwner.FListBox.FTreeView.FColumns.GetCount()>0&&(t=this.FOwner.FListBox.FTreeView.FColumns.GetItem$1(0).FFiltering.FEnabled),t},this.SetDropDownHeight=function(t){null!=this.FOwner&&null!=this.FOwner.FListBox&&null!=this.FOwner.FListBox.FTreeView&&this.FOwner.FListBox.FTreeView.FColumns.GetCount()>0&&(this.FOwner.FListBox.FTreeView.FColumns.GetItem$1(0).FFiltering.FDropDownHeight=t)},this.SetDropDownWidth=function(t){null!=this.FOwner&&null!=this.FOwner.FListBox&&null!=this.FOwner.FListBox.FTreeView&&this.FOwner.FListBox.FTreeView.FColumns.GetCount()>0&&(this.FOwner.FListBox.FTreeView.FColumns.GetItem$1(0).FFiltering.FDropDownWidth=t)},this.SetEnabled=function(t){null!=this.FOwner&&null!=this.FOwner.FListBox&&null!=this.FOwner.FListBox.FTreeView&&this.FOwner.FListBox.FTreeView.FColumns.GetCount()>0&&this.FOwner.FListBox.FTreeView.FColumns.GetItem$1(0).FFiltering.SetEnabled(t)},this.Create$1=function(t){return this.FOwner=t,this};var t=this.$rtti;t.addProperty("Enabled",3,rtl.boolean,"GetEnabled","SetEnabled",{Default:!1}),t.addProperty("DropDownWidth",3,rtl.longint,"GetDropDownWidth","SetDropDownWidth",{Default:100}),t.addProperty("DropDownHeight",3,rtl.longint,"GetDropDownHeight","SetDropDownHeight",{Default:120})})),this.TTMSFNCListBoxClipboardMode={0:"lcmNone",lcmNone:0,1:"lcmTextOnly",lcmTextOnly:1,2:"lcmFull",lcmFull:2},this.$rtti.$Enum("TTMSFNCListBoxClipboardMode",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCListBoxClipboardMode}),this.TTMSFNCListBoxDragDropMode={0:"ldmNone",ldmNone:0,1:"ldmMove",ldmMove:1,2:"ldmCopy",ldmCopy:2},this.$rtti.$Enum("TTMSFNCListBoxDragDropMode",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCListBoxDragDropMode}),this.TTMSFNCListBoxSorting={0:"lcsNone",lcsNone:0,1:"lcsNormal",lcsNormal:1,2:"lcsNormalCaseSensitive",lcsNormalCaseSensitive:2},this.$rtti.$Enum("TTMSFNCListBoxSorting",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCListBoxSorting}),rtl.createClass(this,"TTMSFNCListBoxInteraction",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FListBox=null,this.FLookup=null,this.FFiltering=null},this.$final=function(){this.FListBox=void 0,this.FLookup=void 0,this.FFiltering=void 0,pas.Classes.TPersistent.$final.call(this)},this.GetMultiSelect=function(){var t=!1;return t=!1,null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t=this.FListBox.FTreeView.FInteraction.FMultiSelect),t},this.SetMultiSelect=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FInteraction.SetMultiSelect(t)},this.GetClipboardMode=function(){var t=0;return t=0,null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t=this.FListBox.FTreeView.FInteraction.FClipboardMode),t},this.GetDragDropMode=function(){var t=0;return t=0,null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t=this.FListBox.FTreeView.FInteraction.FDragDropMode),t},this.GetReorder=function(){var t=!1;return t=!1,null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t=this.FListBox.FTreeView.FInteraction.FReorder),t},this.GetTouchScrolling=function(){var t=!1;return t=!0,null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t=this.FListBox.FTreeView.FInteraction.FTouchScrolling),t},this.SetDragDropMode=function(t){var e=0;null!=this.FListBox&&null!=this.FListBox.FTreeView&&(e=t,this.FListBox.FTreeView.FInteraction.SetDragDropMode(e))},this.SetFiltering=function(t){this.FFiltering.Assign(t)},this.SetLookup=function(t){this.FLookup.Assign(t)},this.SetReorder=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FInteraction.SetReorder(t)},this.SetTouchScrolling=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FInteraction.SetTouchScrolling(t)},this.SetClipboardMode=function(t){var e=0;null!=this.FListBox&&null!=this.FListBox.FTreeView&&(e=t,this.FListBox.FTreeView.FInteraction.FClipboardMode=e)},this.GetSorting=function(){var t=0;if(t=0,null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FColumns.GetCount()>0){var e=this.FListBox.FTreeView.FColumns.GetItem$1(0).FSorting;0===e?t=0:1===e?t=1:3===e&&(t=2)}return t},this.SetSorting=function(t){if(null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FColumns.GetCount()>0){var e=t;0===e?this.FListBox.FTreeView.FColumns.GetItem$1(0).SetSorting(0):1===e?this.FListBox.FTreeView.FColumns.GetItem$1(0).SetSorting(1):2===e&&this.FListBox.FTreeView.FColumns.GetItem$1(0).SetSorting(3)}},this.Create$1=function(e){return this.FListBox=e,this.FLookup=t.TTMSFNCListBoxLookup.$create("Create$1",[this]),this.FFiltering=t.TTMSFNCListBoxFiltering.$create("Create$1",[this]),this},this.Destroy=function(){rtl.free(this,"FLookup"),rtl.free(this,"FFiltering"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCListBoxInteraction.isPrototypeOf(e)&&(this.FLookup.Assign(rtl.as(e,t.TTMSFNCListBoxInteraction).FLookup),this.FFiltering.Assign(rtl.as(e,t.TTMSFNCListBoxInteraction).FFiltering))};var e=this.$rtti;e.addProperty("MultiSelect",3,rtl.boolean,"GetMultiSelect","SetMultiSelect",{Default:!1}),e.addProperty("TouchScrolling",3,rtl.boolean,"GetTouchScrolling","SetTouchScrolling",{Default:!0}),e.addProperty("ClipboardMode",3,t.$rtti.TTMSFNCListBoxClipboardMode,"GetClipboardMode","SetClipboardMode",{Default:t.TTMSFNCListBoxClipboardMode.lcmNone}),e.addProperty("Reorder",3,rtl.boolean,"GetReorder","SetReorder",{Default:!1}),e.addProperty("DragDropMode",3,t.$rtti.TTMSFNCListBoxDragDropMode,"GetDragDropMode","SetDragDropMode",{Default:t.TTMSFNCListBoxDragDropMode.ldmNone}),e.addProperty("Lookup",2,t.$rtti.TTMSFNCListBoxLookup,"FLookup","SetLookup"),e.addProperty("Filtering",2,t.$rtti.TTMSFNCListBoxFiltering,"FFiltering","SetFiltering"),e.addProperty("Sorting",3,t.$rtti.TTMSFNCListBoxSorting,"GetSorting","SetSorting",{Default:t.TTMSFNCListBoxSorting.lcsNone})})),this.TTMSFNCListBoxItemHeightMode={0:"lihmFixed",lihmFixed:0,1:"lihmVariable",lihmVariable:1},this.$rtti.$Enum("TTMSFNCListBoxItemHeightMode",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCListBoxItemHeightMode}),rtl.createClass(this,"TTMSFNCListBoxItemsAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FListBox=null},this.$final=function(){this.FListBox=void 0,pas.Classes.TPersistent.$final.call(this)},this.GetFont=function(){var t=null;return t=null,null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t=this.FListBox.FTreeView.FNodesAppearance.FFont),t},this.GetSelectedFill=function(){var t=null;return t=null,null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t=this.FListBox.FTreeView.FNodesAppearance.FSelectedFill),t},this.SetFont=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FNodesAppearance.FFont.Assign(t)},this.SetSelectedFill=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FNodesAppearance.FSelectedFill.Assign(t)},this.GetSelectedStroke=function(){var t=null;return t=null,null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t=this.FListBox.FTreeView.FNodesAppearance.FSelectedStroke),t},this.SetSelectedStroke=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FNodesAppearance.FSelectedStroke.Assign(t)},this.GetDisabledFill=function(){var t=null;return t=null,null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t=this.FListBox.FTreeView.FNodesAppearance.FDisabledFill),t},this.GetDisabledStroke=function(){var t=null;return t=null,null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t=this.FListBox.FTreeView.FNodesAppearance.FDisabledStroke),t},this.GetFill=function(){var t=null;return t=null,null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t=this.FListBox.FTreeView.FNodesAppearance.FFill),t},this.GetStroke=function(){var t=null;return t=null,null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t=this.FListBox.FTreeView.FNodesAppearance.FStroke),t},this.SetDisabledFill=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FNodesAppearance.FDisabledFill.Assign(t)},this.SetDisabledStroke=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FNodesAppearance.FDisabledStroke.Assign(t)},this.SetFill=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FNodesAppearance.FFill.Assign(t)},this.SetStroke=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FNodesAppearance.FStroke.Assign(t)},this.GetHeightMode=function(){var t=0;return t=0,null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t=this.FListBox.FTreeView.FNodesAppearance.FHeightMode),t},this.SetHeightMode=function(t){var e=0;null!=this.FListBox&&null!=this.FListBox.FTreeView&&(e=t,this.FListBox.FTreeView.FNodesAppearance.SetHeightMode(e))},this.GetFixedHeight=function(){var t=0;return t=0,null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t=this.FListBox.FTreeView.FNodesAppearance.FFixedHeight),t},this.SetFixedHeight=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FNodesAppearance.SetFixedHeight(t)},this.GetShowFocus=function(){var t=!1;return t=!0,null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t=this.FListBox.FTreeView.FNodesAppearance.FShowFocus),t},this.SetShowFocus=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FNodesAppearance.SetShowFocus(t)},this.Create$1=function(t){return this.FListBox=t,null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.IsDesignTime()&&(this.FListBox.FTreeView.FNodesAppearance.FDisabledFill.SetKind(0),this.FListBox.FTreeView.FNodesAppearance.FDisabledStroke.SetKind(0)),this};var e=this.$rtti;e.addProperty("Font",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"GetFont","SetFont"),e.addProperty("Fill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetFill","SetFill"),e.addProperty("Stroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetStroke","SetStroke"),e.addProperty("SelectedFill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetSelectedFill","SetSelectedFill"),e.addProperty("SelectedStroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetSelectedStroke","SetSelectedStroke"),e.addProperty("DisabledFill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetDisabledFill","SetDisabledFill"),e.addProperty("DisabledStroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetDisabledStroke","SetDisabledStroke"),e.addProperty("HeightMode",3,t.$rtti.TTMSFNCListBoxItemHeightMode,"GetHeightMode","SetHeightMode",{Default:t.TTMSFNCListBoxItemHeightMode.lihmFixed}),e.addProperty("FixedHeight",3,rtl.double,"GetFixedHeight","SetFixedHeight"),e.addProperty("ShowFocus",3,rtl.boolean,"GetShowFocus","SetShowFocus",{Default:!0})})),rtl.createClass(this,"TTMSFNCListBoxHeader",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FListBox=null},this.$final=function(){this.FListBox=void 0,pas.Classes.TPersistent.$final.call(this)},this.GetVisible=function(){var t=!1;return t=!1,null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t=0 in this.FListBox.FTreeView.FColumnsAppearance.FLayouts),t},this.SetVisible=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t?this.FListBox.FTreeView.FColumnsAppearance.SetLayouts(rtl.createSet(0)):this.FListBox.FTreeView.FColumnsAppearance.SetLayouts({}))},this.GetText=function(){var t="";return t="",null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FColumns.GetCount()>0&&(t=this.FListBox.FTreeView.FColumns.GetItem$1(0).FText),t},this.SetText=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FColumns.GetCount()>0&&this.FListBox.FTreeView.FColumns.GetItem$1(0).SetText(t)},this.GetFill=function(){var t=null;return t=null,null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t=this.FListBox.FTreeView.FColumnsAppearance.FTopFill),t},this.GetHorizontalTextAlign=function(){var t=0;return t=0,null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FColumns.GetCount()>0&&(t=this.FListBox.FTreeView.FColumns.GetItem$1(0).FHorizontalTextAlign),t},this.GetSize=function(){var t=0;return t=25,null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t=this.FListBox.FTreeView.FColumnsAppearance.FTopSize),t},this.GetStroke=function(){var t=null;return t=null,null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t=this.FListBox.FTreeView.FColumnsAppearance.FTopStroke),t},this.SetFill=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FColumnsAppearance.FTopFill.Assign(t)},this.SetHorizontalTextAlign=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FColumns.GetCount()>0&&this.FListBox.FTreeView.FColumns.GetItem$1(0).SetHorizontalTextAlign(t)},this.SetSize=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FColumnsAppearance.SetTopSize(t)},this.SetStroke=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FColumnsAppearance.FTopStroke.Assign(t)},this.GetVerticalTextAlign=function(){var t=0;return t=0,null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FColumns.GetCount()>0&&(t=this.FListBox.FTreeView.FColumns.GetItem$1(0).FVerticalTextAlign),t},this.SetVerticalTextAlign=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FColumns.GetCount()>0&&this.FListBox.FTreeView.FColumns.GetItem$1(0).SetVerticalTextAlign(t)},this.GetFont=function(){var t=null;return t=null,null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t=this.FListBox.FTreeView.FColumnsAppearance.FTopFont),t},this.GetTrimming=function(){var t=0;return t=0,null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FColumns.GetCount()>0&&(t=this.FListBox.FTreeView.FColumns.GetItem$1(0).FTrimming),t},this.GetWordWrapping=function(){var t=!1;return t=!1,null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FColumns.GetCount()>0&&(t=this.FListBox.FTreeView.FColumns.GetItem$1(0).FWordWrapping),t},this.SetFont=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FColumnsAppearance.FTopFont.Assign(t)},this.SetTrimming=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FColumns.GetCount()>0&&this.FListBox.FTreeView.FColumns.GetItem$1(0).SetTrimming(t)},this.SetWordWrapping=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FColumns.GetCount()>0&&this.FListBox.FTreeView.FColumns.GetItem$1(0).SetWordWrapping(t)},this.GetSortIndicatorColor=function(){var t=0;return t=16297243,null!=this.FListBox&&null!=this.FListBox.FTreeView&&(t=this.FListBox.FTreeView.FColumnsAppearance.FSortIndicatorColor),t},this.SetSortIndicatorColor=function(t){null!=this.FListBox&&null!=this.FListBox.FTreeView&&this.FListBox.FTreeView.FColumnsAppearance.SetSortIndicatorColor(t)},this.Create$1=function(t){return this.FListBox=t,this};var t=this.$rtti;t.addProperty("Visible",3,rtl.boolean,"GetVisible","SetVisible",{Default:!1}),t.addProperty("Text",3,rtl.string,"GetText","SetText"),t.addProperty("Fill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetFill","SetFill"),t.addProperty("Font",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"GetFont","SetFont"),t.addProperty("Stroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetStroke","SetStroke"),t.addProperty("HorizontalTextAlign",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"GetHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),t.addProperty("VerticalTextAlign",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"GetVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),t.addProperty("WordWrapping",3,rtl.boolean,"GetWordWrapping","SetWordWrapping",{Default:!1}),t.addProperty("Trimming",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"GetTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttNone}),t.addProperty("Size",3,rtl.double,"GetSize","SetSize"),t.addProperty("SortIndicatorColor",3,pas["WEBLib.Graphics"].$rtti.TColor,"GetSortIndicatorColor","SetSortIndicatorColor",{Default:16297243})})),rtl.createClass(this,"TTMSFNCListBoxCopyItems",this.TTMSFNCListBoxItems,(function(){})),this.$rtti.$MethodVar("TTMSFNCListBoxBeforeDrawSortIndicatorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ASortIndex",rtl.longint],["ASortKind",this.$rtti.TTMSFNCListBoxItemsSortKind],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxAfterDrawSortIndicatorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ASortIndex",rtl.longint],["ASortKind",this.$rtti.TTMSFNCListBoxItemsSortKind]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxNeedFilterDropDownDataEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AValues",pas.Classes.$rtti.TStrings]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxItemAnchorClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCListBoxItem],["AAnchor",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxBeforeReorderItemEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AFromItem",this.$rtti.TTMSFNCListBoxItem],["AToItem",this.$rtti.TTMSFNCListBoxItem],["ACanReorder",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxAfterReorderItemEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AFromItem",this.$rtti.TTMSFNCListBoxItem],["AToItem",this.$rtti.TTMSFNCListBoxItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxBeforeDropItemEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AFromItem",this.$rtti.TTMSFNCListBoxItem],["AToItem",this.$rtti.TTMSFNCListBoxItem],["ACanDrop",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxAfterDropItemEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AFromItem",this.$rtti.TTMSFNCListBoxItem],["AToItem",this.$rtti.TTMSFNCListBoxItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxBeforeCopyToClipboardEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACanCopy",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxBeforeCutToClipboardEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACanCut",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxBeforePasteFromClipboardEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACanPaste",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxAfterCopyToClipboardEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxAfterCutToClipboardEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxAfterPasteFromClipboardEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxBeforeDrawItemTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCListBoxItem],["AText",rtl.string],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxAfterDrawItemTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCListBoxItem],["AText",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxItemSelectedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCListBoxItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxItemClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCListBoxItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxItemMouseEnterEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCListBoxItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxItemMouseLeaveEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCListBoxItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxScrollEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["APosition",rtl.double]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxBeforeDrawItemIconEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCListBoxItem],["AIcon",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxAfterDrawItemIconEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCListBoxItem],["AIcon",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxBeforeDrawItemCheckEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCListBoxItem],["ACheck",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxAfterDrawItemCheckEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCListBoxItem],["ACheck",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxBeforeDrawItemEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCListBoxItem],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxAfterDrawItemEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCListBoxItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxItemCompareEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Item1",this.$rtti.TTMSFNCListBoxItem],["Item2",this.$rtti.TTMSFNCListBoxItem],["ACompareResult",rtl.longint,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCListBoxFilterSelectEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACondition",rtl.string,1]]),methodkind:0}),this.TTMSFNCListBoxFilterOperation={0:"lfoSHORT",lfoSHORT:0,1:"lfoNONE",lfoNONE:1,2:"lfoAND",lfoAND:2,3:"lfoXOR",lfoXOR:3,4:"lfoOR",lfoOR:4},this.$rtti.$Enum("TTMSFNCListBoxFilterOperation",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TTMSFNCListBoxFilterOperation}),rtl.createClass(this,"TTMSFNCListBoxFilterData",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FCondition="",this.FCaseSensitive=!1,this.FSuffix="",this.FPrefix="",this.FOperation=0},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FCaseSensitive=!0,this},this.Assign=function(e){var i;null!=(i=rtl.as(e,t.TTMSFNCListBoxFilterData))&&(this.FCondition=i.FCondition,this.FCaseSensitive=i.FCaseSensitive,this.FPrefix=i.FPrefix,this.FSuffix=i.FSuffix,this.FOperation=i.FOperation)};var e=this.$rtti;e.addProperty("Condition",0,rtl.string,"FCondition","FCondition"),e.addProperty("CaseSensitive",0,rtl.boolean,"FCaseSensitive","FCaseSensitive",{Default:!0}),e.addProperty("Prefix",0,rtl.string,"FPrefix","FPrefix"),e.addProperty("Suffix",0,rtl.string,"FSuffix","FSuffix"),e.addProperty("Operation",0,t.$rtti.TTMSFNCListBoxFilterOperation,"FOperation","FOperation")})),rtl.createClass(this,"TTMSFNCListBoxFilter",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FOwner$1=null},this.$final=function(){this.FOwner$1=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return pas.Classes.TCollection.GetItem.call(this,t)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TTMSFNCListBoxFilterData),this.FOwner$1=e,this}})),rtl.createClass(this,"TTMSFNCCustomListBox",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FUpdateCount$1=0,this.FSaveSelectedItemIndex=0,this.FCopyItems=null,this.FAccepted=!1,this.FItems=null,this.FTreeView=null,this.FDefaultItem=null,this.FItemsAppearance=null,this.FOnItemSelected=null,this.FInteraction=null,this.FHeader=null,this.FOnItemAnchorClick=null,this.FOnAfterCutToClipboard=null,this.FOnBeforePasteFromClipboard=null,this.FOnAfterReorderItem=null,this.FOnBeforeDropItem=null,this.FOnBeforeDrawItemText=null,this.FOnVScroll=null,this.FOnBeforeCopyToClipboard=null,this.FOnItemDblClick=null,this.FOnBeforeDrawItemCheck=null,this.FOnAfterDrawItemIcon=null,this.FOnBeforeDrawItem=null,this.FOnAfterPasteFromClipboard=null,this.FOnItemClick=null,this.FOnAfterDropItem=null,this.FOnAfterDrawItemText=null,this.FOnItemCompare=null,this.FOnBeforeCutToClipboard=null,this.FOnBeforeReorderItem=null,this.FOnNeedFilterDropDownData=null,this.FOnAfterCopyToClipboard=null,this.FOnFilterSelect=null,this.FOnAfterDrawItemCheck=null,this.FOnAfterDrawItem=null,this.FOnBeforeDrawItemIcon=null,this.FFilter=null,this.FOnBeforeDrawSortIndicator=null,this.FOnAfterDrawSortIndicator=null,this.FOnItemMouseLeave=null,this.FOnItemMouseEnter=null,this.FSortMode=0,this.FOnHeaderAnchorClick=null,this.FGlobalFont=null},this.$final=function(){this.FCopyItems=void 0,this.FItems=void 0,this.FTreeView=void 0,this.FDefaultItem=void 0,this.FItemsAppearance=void 0,this.FOnItemSelected=void 0,this.FInteraction=void 0,this.FHeader=void 0,this.FOnItemAnchorClick=void 0,this.FOnAfterCutToClipboard=void 0,this.FOnBeforePasteFromClipboard=void 0,this.FOnAfterReorderItem=void 0,this.FOnBeforeDropItem=void 0,this.FOnBeforeDrawItemText=void 0,this.FOnVScroll=void 0,this.FOnBeforeCopyToClipboard=void 0,this.FOnItemDblClick=void 0,this.FOnBeforeDrawItemCheck=void 0,this.FOnAfterDrawItemIcon=void 0,this.FOnBeforeDrawItem=void 0,this.FOnAfterPasteFromClipboard=void 0,this.FOnItemClick=void 0,this.FOnAfterDropItem=void 0,this.FOnAfterDrawItemText=void 0,this.FOnItemCompare=void 0,this.FOnBeforeCutToClipboard=void 0,this.FOnBeforeReorderItem=void 0,this.FOnNeedFilterDropDownData=void 0,this.FOnAfterCopyToClipboard=void 0,this.FOnFilterSelect=void 0,this.FOnAfterDrawItemCheck=void 0,this.FOnAfterDrawItem=void 0,this.FOnBeforeDrawItemIcon=void 0,this.FFilter=void 0,this.FOnBeforeDrawSortIndicator=void 0,this.FOnAfterDrawSortIndicator=void 0,this.FOnItemMouseLeave=void 0,this.FOnItemMouseEnter=void 0,this.FOnHeaderAnchorClick=void 0,this.FGlobalFont=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetItems=function(t){this.FItems.Assign(t)},this.SetDefaultItem=function(t){this.FDefaultItem.Assign(t)},this.SetItemsAppearance=function(t){this.FItemsAppearance.Assign(t)},this.GetItemIndex=function(){var t=0;return t=-1,null!=this.FTreeView&&this.FTreeView.SelectedVirtualNodeCount()>0&&null!=this.FTreeView.GetSelVirtualNode(0)&&(t=this.FTreeView.GetSelVirtualNode(0).FRow),t},this.SetItemIndex=function(t){this.SelectItem(t)},this.SetInteraction=function(t){this.FInteraction.Assign(t)},this.GetBitmapContainer=function(){var t=null;return t=null,null!=this.FTreeView&&(t=this.FTreeView.GetBitmapContainer()),t},this.SetBitmapContainer=function(t){this.FTreeView.SetBitmapContainer(t)},this.SetHeader=function(t){this.FHeader.Assign(t)},this.GetSelectedItem=function(){var t=null;return t=null,this.GetItemIndex()>=0&&this.GetItemIndex()<=this.FItems.GetCount()-1&&(t=this.FItems.GetItem$1(this.GetItemIndex())),t},this.SetSelectedItem=function(t){null!=t&&this.SetItemIndex(t.GetIndex())},this.GetSelItem=function(t){var e=null;return e=null,null!=this.FTreeView&&(e=this.GetItemForNode(this.FTreeView.GetSelVirtualNode(t))),e},this.GetVerticalScrollBarVisible=function(){var t=!1;return t=!0,null!=this.FTreeView&&(t=this.FTreeView.FVerticalScrollBarVisible),t},this.SetVerticalScrollBarVisible=function(t){null!=this.FTreeView&&this.FTreeView.SetVerticalScrollBarVisible(t)},this.GetFill=function(){var t=null;return t=null,null!=this.FTreeView&&(t=this.FTreeView.FFill),t},this.GetStroke=function(){var t=null;return t=null,null!=this.FTreeView&&(t=this.FTreeView.FStroke),t},this.SetFill$1=function(t){null!=this.FTreeView&&this.FTreeView.FFill.Assign(t)},this.SetStroke$1=function(t){null!=this.FTreeView&&this.FTreeView.FStroke.Assign(t)},this.SetGlobalFont=function(t){this.FGlobalFont.Assign(t)},this.IsAppearanceProperty=function(t,e,i){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.IsAppearanceProperty.call(this,t,e,i)||"Header"===e},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,1,0)},this.CreateItems=function(){return t.TTMSFNCListBoxItems.$create("Create$3",[this])},this.GetItemIndexForNode=function(t){var e=0;return e=-1,null!=t&&(e=t.FRow),e},this.GetItemForNode=function(t){var e,i=null;return i=null,(e=this.GetItemIndexForNode(t))>=0&&e<=this.FItems.GetCount()-1&&(i=this.FItems.GetItem$1(e)),i},this.GetNodeForItemIndex=function(t){var e=null;return e=null,null!=this.FTreeView&&(e=this.FTreeView.GetNodeForRow(t)),e},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this)},this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCCustomListBox)},this.ApplyStyle=function(){var t=0,e=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),e=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return e},set:function(t){e=t}})){this.FDefaultItem.SetTextColor(e);for(var i=0,s=this.FItems.GetCount()-1;i<=s;i++)t=i,this.FItems.GetItem$1(t).SetTextColor(e)}},this.ResetToDefaultStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FDefaultItem.SetTextColor(4539717),this.FDefaultItem.SetSelectedTextColor(this.FDefaultItem.FTextColor);for(var e=0,i=this.FItems.GetCount()-1;e<=i;e++)t=e,this.FItems.GetItem$1(t).SetTextColor(4539717),this.FItems.GetItem$1(t).SetSelectedTextColor(this.FDefaultItem.FTextColor)},this.SetAdaptToStyle=function(t){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetAdaptToStyle.apply(this,arguments),null!=this.FTreeView&&this.FTreeView.SetAdaptToStyle(this.GetAdaptToStyle())},this.UpdateItems=function(){var t=null;this.IsDestroying()||null!=this.FTreeView&&0===this.FUpdateCount$1&&(t=this.GetSelectedItem(),this.FTreeView.BeginUpdate(),this.FTreeView.ClearNodeList(),this.FTreeView.EndUpdate(),this.SetSelectedItem(t))},this.DoGetNodeHeight=function(t,e,i,s){e.FRow>=0&&e.FRow<=this.FItems.GetCount()-1&&this.FItems.GetItem$1(e.FRow).FHeight>-1&&s.set(this.FItems.GetItem$1(e.FRow).FHeight)},this.DoGetNodeIcon=function(t,e,i,s,n){e.FRow>=0&&e.FRow<=this.FItems.GetCount()-1&&(null!=this.GetBitmapContainer()&&""!==this.FItems.GetItem$1(e.FRow).FBitmapName&&n.set(this.GetBitmapContainer().FindBitmap$1(this.FItems.GetItem$1(e.FRow).FBitmapName)),null==n.get()&&n.set(this.FItems.GetItem$1(e.FRow).FBitmap))},this.DoGetNodeIconSize=function(t,e,i,s,n,o,r){var a=0,l=0;e.FRow>=0&&e.FRow<=this.FItems.GetCount()-1&&(-1!==(a=this.FItems.GetItem$1(e.FRow).FBitmapWidth)&&o.set(a),-1!==(l=this.FItems.GetItem$1(e.FRow).FBitmapHeight)&&r.set(l))},this.DoGetNumberOfNodes=function(t,e,i){-1===e.FLevel&&i.set(this.FItems.GetCount())},this.DoGetNodeText=function(t,e,i,s,n){e.FRow>=0&&e.FRow<=this.FItems.GetCount()-1&&n.set(this.FItems.GetItem$1(e.FRow).FText)},this.DoGetNodeTrimming=function(t,e,i,s){e.FRow>=0&&e.FRow<=this.FItems.GetCount()-1&&s.set(this.FItems.GetItem$1(e.FRow).FTrimming)},this.DoGetNodeWordWrapping=function(t,e,i,s){e.FRow>=0&&e.FRow<=this.FItems.GetCount()-1&&s.set(this.FItems.GetItem$1(e.FRow).FWordWrapping)},this.DoGetNodeHorizontalTextAlign=function(t,e,i,s){e.FRow>=0&&e.FRow<=this.FItems.GetCount()-1&&s.set(this.FItems.GetItem$1(e.FRow).FTextAlign)},this.DoGetNodeVerticalTextAlign=function(t,e,i,s){s.set(0)},this.DoGetNodeTextColor=function(t,e,i,s){e.FRow>=0&&e.FRow<=this.FItems.GetCount()-1&&s.set(this.FItems.GetItem$1(e.FRow).FTextColor)},this.DoGetNodeSelectedTextColor=function(t,e,i,s){e.FRow>=0&&e.FRow<=this.FItems.GetCount()-1&&s.set(this.FItems.GetItem$1(e.FRow).FSelectedTextColor)},this.DoGetNodeDisabledTextColor=function(t,e,i,s){e.FRow>=0&&e.FRow<=this.FItems.GetCount()-1&&s.set(this.FItems.GetItem$1(e.FRow).FDisabledTextColor)},this.DoIsNodeEnabled=function(t,e,i){e.FRow>=0&&e.FRow<=this.FItems.GetCount()-1&&i.set(this.FItems.GetItem$1(e.FRow).FEnabled)},this.DoAfterSelectNode=function(t,e){null!=this.FOnItemSelected&&this.FOnItemSelected(this,this.GetItemForNode(e)),null!=this.FParent&&pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.isPrototypeOf(this.FParent)&&null!=this.FParent.FOwner&&pas["WEBLib.TMSFNCControlPicker"].TTMSFNCControlPicker.isPrototypeOf(this.FParent.FOwner)&&rtl.as(this.FParent.FOwner,pas["WEBLib.TMSFNCControlPicker"].TTMSFNCControlPicker).UpdateDropDown()},this.DoNeedFilterDropDownData=function(t,e,i){null!=this.FOnNeedFilterDropDownData&&this.FOnNeedFilterDropDownData(this,i)},this.DoFilterSelect=function(t,e,i){null!=this.FOnFilterSelect&&this.FOnFilterSelect(this,i)},this.DoBeforeDrawSortIndicator=function(t,e,i,s,n,o,r){var a=0;null!=this.FOnBeforeDrawSortIndicator&&(a=o,this.FOnBeforeDrawSortIndicator(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),n,a,r))},this.DoAfterDrawSortIndicator=function(t,e,i,s,n,o){var r=0;null!=this.FOnAfterDrawSortIndicator&&(r=o,this.FOnAfterDrawSortIndicator(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),n,r))},this.DoBeforeDrawNode=function(t,e,i,s,n,o){null!=this.FOnBeforeDrawItem&&this.FOnBeforeDrawItem(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(s),n,o)},this.DoAfterDrawNode=function(t,e,i,s){null!=this.FOnAfterDrawItem&&this.FOnAfterDrawItem(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(s))},this.DoItemCompare=function(t,e,i){null!=this.FOnItemCompare&&this.FOnItemCompare(this,t,e,i)},this.DoBeforeDrawNodeText=function(t,e,i,s,n,o,r){null!=this.FOnBeforeDrawItemText&&this.FOnBeforeDrawItemText(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(n),o,r)},this.DoAfterDrawNodeText=function(t,e,i,s,n,o){null!=this.FOnAfterDrawItemText&&this.FOnAfterDrawItemText(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(n),o)},this.DoClick=function(t){this.Click()},this.DoDblClick=function(t){this.DblClick()},this.DoBeforeDrawNodeIcon=function(t,e,i,s,n,o,r){null!=this.FOnBeforeDrawItemIcon&&this.FOnBeforeDrawItemIcon(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(n),o,r)},this.DoAfterDrawNodeIcon=function(t,e,i,s,n,o){null!=this.FOnAfterDrawItemIcon&&this.FOnAfterDrawItemIcon(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(n),o)},this.DoBeforeDrawNodeCheck=function(t,e,i,s,n,o,r){null!=this.FOnBeforeDrawItemCheck&&this.FOnBeforeDrawItemCheck(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(n),o,r)},this.DoAfterDrawNodeCheck=function(t,e,i,s,n,o){null!=this.FOnAfterDrawItemCheck&&this.FOnAfterDrawItemCheck(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(n),o)},this.DoNodeAnchorClick=function(t,e,i,s){null!=this.FOnItemAnchorClick?this.FOnItemAnchorClick(this,this.GetItemForNode(e),s):pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(s)},this.DoColumnAnchorClick=function(t,e,i){null!=this.FOnHeaderAnchorClick?this.FOnHeaderAnchorClick(this,i):pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(i)},this.DoNodeClick=function(t,e){null!=this.FOnItemClick&&this.FOnItemClick(this,this.GetItemForNode(e))},this.DoNodeMouseEnter=function(t,e){null!=this.FOnItemMouseEnter&&this.FOnItemMouseEnter(this,this.GetItemForNode(e))},this.DoNodeMouseLeave=function(t,e){null!=this.FOnItemMouseLeave&&this.FOnItemMouseLeave(this,this.GetItemForNode(e))},this.DoNodeDblClick=function(t,e){null!=this.FOnItemDblClick&&this.FOnItemDblClick(this,this.GetItemForNode(e))},this.DoVScroll=function(t,e){null!=this.FOnVScroll&&this.FOnVScroll(this,e)},this.DoBeforeCutToClipboard=function(t,e){null!=this.FOnBeforeCutToClipboard&&this.FOnBeforeCutToClipboard(this,e)},this.DoBeforeCopyToClipboard=function(t,e){null!=this.FOnBeforeCopyToClipboard&&this.FOnBeforeCopyToClipboard(this,e)},this.DoBeforePasteFromClipboard=function(t,e){null!=this.FOnBeforePasteFromClipboard&&this.FOnBeforePasteFromClipboard(this,e)},this.DoAfterCutToClipboard=function(t){null!=this.FOnAfterCutToClipboard&&this.FOnAfterCutToClipboard(this)},this.DoAfterCopyToClipboard=function(t){null!=this.FOnAfterCopyToClipboard&&this.FOnAfterCopyToClipboard(this)},this.DoAfterPasteFromClipboard=function(t){null!=this.FOnAfterPasteFromClipboard&&this.FOnAfterPasteFromClipboard(this)},this.DoBeforeReorderItem=function(t,e,i){null!=this.FOnBeforeReorderItem&&this.FOnBeforeReorderItem(this,t,e,i)},this.DoAfterReorderItem=function(t,e){null!=this.FOnAfterReorderItem&&this.FOnAfterReorderItem(this,t,e)},this.DoBeforeDropItem=function(t,e,i){null!=this.FOnBeforeDropItem&&this.FOnBeforeDropItem(this,t,e,i)},this.DoAfterDropItem=function(t,e){null!=this.FOnAfterDropItem&&this.FOnAfterDropItem(this,t,e)},this.CustomizeTreeView=function(t){},this.DoCustomDragOver=function(t,e,i,s){s.set(0!==this.FInteraction.GetDragDropMode()&&pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.isPrototypeOf(e)&&null!=rtl.as(e,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FDragNode),this.FAccepted=s.get()},this.DoCustomDragDrop=function(e,i,s){var n=null,o=null,r=null,a=null,l=!1;if(this.FAccepted&&null!=i&&pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.isPrototypeOf(i)&&t.TTMSFNCCustomListBox.isPrototypeOf(rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FParent)&&0!==i.FInteraction.FDragDropMode&&null!=(a=rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FDragNode)&&(o=rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FParent.GetItemForNode(a),(n=this.XYToItem(s.X,s.Y))!==o&&null!=o&&(l=!0,this.DoBeforeDropItem(o,n,{get:function(){return l},set:function(t){l=t}}),l))){if(this.BeginUpdate(),rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FParent.BeginUpdate(),null!=n){var h=rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FParent.FInteraction.GetDragDropMode();1===h?rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FParent===this?o.SetIndex(n.GetIndex()):((r=this.FItems.Add$1()).Assign(o),r.SetIndex(n.GetIndex()),rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FParent.FItems.Delete(o.GetIndex())):2===h&&((r=this.FItems.Add$1()).Assign(o),r.SetIndex(n.GetIndex()))}else{(r=this.FItems.Add$1()).Assign(o),1===rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FParent.FInteraction.GetDragDropMode()&&rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FParent.FItems.Delete(o.GetIndex())}rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FDragNode=null,rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FParent.EndUpdate(),this.EndUpdate(),this.DoAfterDropItem(o,n)}},this.DoCustomReorder=function(t,e,i){var s=null,n=null,o=!1;null!=e&&null!=i&&(o=!0,s=this.GetItemForNode(e),n=this.GetItemForNode(i),this.DoBeforeReorderItem(s,n,{get:function(){return o},set:function(t){o=t}}),o&&(this.BeginUpdate(),s.SetIndex(n.GetIndex()),this.EndUpdate(),this.DoAfterReorderItem(s,n)))},this.DoCopyToClipboard=function(t){this.CopyToClipboard(1===this.FInteraction.GetClipboardMode())},this.DoCutToClipboard=function(t){this.CutToClipboard(1===this.FInteraction.GetClipboardMode())},this.DoPasteFromClipboard=function(t){this.PasteFromClipboard()},this.DoColumnSort=function(t,e,i){var s;s=i,this.FItems.Sort$1(this.FInteraction.GetSorting()in rtl.createSet(2),s)},this.DoLookup=function(t,e){this.LookupItem(e,this.FInteraction.FLookup.GetCaseSensitive(),this.FInteraction.FLookup.GetAutoSelect())},this.PickerGetContent=function(){var t="";return t="",this.GetItemIndex()>=0&&(t=this.FItems.GetItem$1(this.GetItemIndex()).FText),t},this.PickerSelectItem=function(t){t>=0&&t<=this.FItems.GetCount()-1&&this.SetItemIndex(t)},this.PickerGetSelectedItem=function(){return this.GetItemIndex()},this.PickerGetVisibleItemCount=function(){return null!=this.FTreeView?this.FTreeView.FVisibleNodes.GetCount():0},this.PickerGetItemCount=function(){return this.FItems.GetCount()},this.PickerGetItemHeight=function(){return this.FItemsAppearance.GetFixedHeight()},this.PickerSetItemHeight=function(t){this.FItemsAppearance.SetFixedHeight(t)},this.PickerGetItemWidth=function(){return this.GetWidth()},this.PickerSetItemWidth=function(t){},this.PickerGetNextSelectableItem=function(t){return t<this.FItems.GetCount()-1?t+1:t},this.PickerGetPreviousSelectableItem=function(t){return t>0?t-1:t},this.PickerGetFirstSelectableItem=function(){return this.FItems.GetCount()>0?0:-1},this.PickerGetLastSelectableItem=function(){return this.FItems.GetCount()>0?this.FItems.GetCount()-1:-1},this.PickerResetFilter=function(){this.RemoveFilter()},this.PickerApplyFilter=function(t,e){this.ApplyFilter()},this.PickerLookupItem=function(t,e){var i=pas["WEBLib.TMSFNCControlPicker"].TTMSFNCControlPickerFilterItem.$new(),s=null;return s=this.LookupItem(t,e,!1),i.ItemIndex=s.GetIndex(),i.ItemText=s.FText,i},this.SetFonts=function(t){var e=0;if(this.BeginUpdate(),this.FGlobalFont.ApplyChange(this.FItemsAppearance.GetFont(),t),this.FGlobalFont.ApplyChange(this.FHeader.GetFont(),t),1===t)for(var i=0,s=this.FItems.GetCount()-1;i<=s;i++)e=i,this.FItems.GetItem$1(e).SetTextColor(this.FGlobalFont.FColor),this.FItems.GetItem$1(e).SetSelectedTextColor(this.FGlobalFont.FColor);this.EndUpdate()},this.Create$1=function(e){var i=null;return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FFilter=t.TTMSFNCListBoxFilter.$create("Create$3",[this]),this.FHeader=t.TTMSFNCListBoxHeader.$create("Create$1",[this]),this.FItemsAppearance=t.TTMSFNCListBoxItemsAppearance.$create("Create$1",[this]),this.FDefaultItem=t.TTMSFNCListBoxItem.$create("Create$1",[null]),this.FItems=this.CreateItems(),this.FInteraction=t.TTMSFNCListBoxInteraction.$create("Create$1",[this]),this.FCopyItems=t.TTMSFNCListBoxCopyItems.$create("Create$3",[null]),this.FTreeView=pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$create("Create$1",[this]),this.FTreeView.FStored=!1,this.FTreeView.SetParent(this),this.FTreeView.FColumns.Clear(),(i=this.FTreeView.FColumns.Add$1()).SetText("Header"),i.SetHorizontalTextAlign(0),this.FTreeView.ClearNodes(),this.FTreeView.FColumnsAppearance.SetLayouts({}),this.FTreeView.SetStretchScrollBars(!0),this.FTreeView.FNodesAppearance.SetExpandColumn(-1),this.FTreeView.FNodesAppearance.SetLevelIndent(0),this.FTreeView.FNodesAppearance.SetShowLines(!1),this.FTreeView.FNodesAppearance.SetExpandWidth(0),this.FTreeView.FNodesAppearance.SetExpandHeight(0),this.FTreeView.FNodesAppearance.SetSelectionArea(1),this.FTreeView.FOnGetNumberOfNodes=rtl.createCallback(this,"DoGetNumberOfNodes"),this.FTreeView.FOnGetNodeHeight=rtl.createCallback(this,"DoGetNodeHeight"),this.FTreeView.FOnGetNodeIcon=rtl.createCallback(this,"DoGetNodeIcon"),this.FTreeView.FOnGetNodeIconSize=rtl.createCallback(this,"DoGetNodeIconSize"),this.FTreeView.FOnGetNodeTrimming=rtl.createCallback(this,"DoGetNodeTrimming"),this.FTreeView.FOnGetNodeWordWrapping=rtl.createCallback(this,"DoGetNodeWordWrapping"),this.FTreeView.FOnGetNodeTextColor=rtl.createCallback(this,"DoGetNodeTextColor"),this.FTreeView.FOnGetNodeSelectedTextColor=rtl.createCallback(this,"DoGetNodeSelectedTextColor"),this.FTreeView.FOnGetNodeDisabledTextColor=rtl.createCallback(this,"DoGetNodeDisabledTextColor"),this.FTreeView.FOnGetNodeText=rtl.createCallback(this,"DoGetNodeText"),this.FTreeView.FOnGetNodeHorizontalTextAlign=rtl.createCallback(this,"DoGetNodeHorizontalTextAlign"),this.FTreeView.FOnGetNodeVerticalTextAlign=rtl.createCallback(this,"DoGetNodeVerticalTextAlign"),this.FTreeView.FOnIsNodeEnabled=rtl.createCallback(this,"DoIsNodeEnabled"),this.FTreeView.FOnAfterSelectNode=rtl.createCallback(this,"DoAfterSelectNode"),this.FTreeView.FOnNeedFilterDropDownData=rtl.createCallback(this,"DoNeedFilterDropDownData"),this.FTreeView.FOnFilterSelect=rtl.createCallback(this,"DoFilterSelect"),this.FTreeView.FOnBeforeDrawNode=rtl.createCallback(this,"DoBeforeDrawNode"),this.FTreeView.FOnAfterDrawNode=rtl.createCallback(this,"DoAfterDrawNode"),this.FTreeView.FOnAfterDrawNodeIcon=rtl.createCallback(this,"DoAfterDrawNodeIcon"),this.FTreeView.FOnBeforeDrawNodeIcon=rtl.createCallback(this,"DoBeforeDrawNodeIcon"),this.FTreeView.FOnAfterDrawNodeCheck=rtl.createCallback(this,"DoAfterDrawNodeCheck"),this.FTreeView.FOnBeforeDrawNodeCheck=rtl.createCallback(this,"DoBeforeDrawNodeCheck"),this.FTreeView.FOnBeforeDrawNodeText=rtl.createCallback(this,"DoBeforeDrawNodeText"),this.FTreeView.FOnAfterDrawNodeText=rtl.createCallback(this,"DoAfterDrawNodeText"),this.FTreeView.FOnNodeAnchorClick=rtl.createCallback(this,"DoNodeAnchorClick"),this.FTreeView.FOnBeforeDrawSortIndicator=rtl.createCallback(this,"DoBeforeDrawSortIndicator"),this.FTreeView.FOnAfterDrawSortIndicator=rtl.createCallback(this,"DoAfterDrawSortIndicator"),this.FTreeView.FOnNodeClick=rtl.createCallback(this,"DoNodeClick"),this.FTreeView.FOnNodeMouseLeave=rtl.createCallback(this,"DoNodeMouseLeave"),this.FTreeView.FOnNodeMouseEnter=rtl.createCallback(this,"DoNodeMouseEnter"),this.FTreeView.FOnNodeDblClick=rtl.createCallback(this,"DoNodeDblClick"),this.FTreeView.FOnVScroll=rtl.createCallback(this,"DoVScroll"),this.FTreeView.FOnBeforeCutToClipboard=rtl.createCallback(this,"DoBeforeCutToClipboard"),this.FTreeView.FOnBeforeCopyToClipboard=rtl.createCallback(this,"DoBeforeCopyToClipboard"),this.FTreeView.FOnBeforePasteFromClipboard=rtl.createCallback(this,"DoBeforePasteFromClipboard"),this.FTreeView.FOnAfterCutToClipboard=rtl.createCallback(this,"DoAfterCutToClipboard"),this.FTreeView.FOnAfterCopyToClipboard=rtl.createCallback(this,"DoAfterCopyToClipboard"),this.FTreeView.FOnAfterPasteFromClipboard=rtl.createCallback(this,"DoAfterPasteFromClipboard"),this.FTreeView.FOnColumnAnchorClick=rtl.createCallback(this,"DoColumnAnchorClick"),this.FTreeView.FOnCustomReorder=rtl.createCallback(this,"DoCustomReorder"),this.FTreeView.FOnCustomDragOver=rtl.createCallback(this,"DoCustomDragOver"),this.FTreeView.FOnCustomDragDrop=rtl.createCallback(this,"DoCustomDragDrop"),this.FTreeView.FOnCustomCopyToClipboard=rtl.createCallback(this,"DoCopyToClipboard"),this.FTreeView.FOnCustomCutToClipboard=rtl.createCallback(this,"DoCutToClipboard"),this.FTreeView.FOnCustomPasteFromClipboard=rtl.createCallback(this,"DoPasteFromClipboard"),this.FTreeView.FOnCustomColumnSort=rtl.createCallback(this,"DoColumnSort"),this.FTreeView.FOnCustomLookup=rtl.createCallback(this,"DoLookup"),this.FTreeView.FOnClick=rtl.createCallback(this,"DoClick"),this.FTreeView.FOnDblClick=rtl.createCallback(this,"DoDblClick"),this.CustomizeTreeView(this.FTreeView),this.FTreeView.SetAlign(5),this.FGlobalFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCAppearanceGlobalFont.$create("Create$1",[this]),this.SetWidth(200),this.SetHeight(220),this.IsDesignTime()&&this.InitSample(),this},this.Destroy=function(){rtl.free(this,"FGlobalFont"),rtl.free(this,"FFilter"),rtl.free(this,"FCopyItems"),rtl.free(this,"FHeader"),rtl.free(this,"FDefaultItem"),rtl.free(this,"FInteraction"),rtl.free(this,"FItems"),rtl.free(this,"FTreeView"),rtl.free(this,"FItemsAppearance"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCustomListBox.isPrototypeOf(e)&&this.FTreeView.Assign(rtl.as(e,t.TTMSFNCCustomListBox).FTreeView)},this.AddItem=function(t){var e=null;return(e=this.FItems.Add$1()).SetText(t),e},this.XYToItem=function(t,e){var i=null,s=null;return i=null,null!=this.FTreeView&&null!=(s=this.FTreeView.XYToNode(t,e,0))&&s.FRow>=0&&s.FRow<=this.FItems.GetCount()-1&&(i=this.FItems.GetItem$1(s.FRow)),i},this.SelectedItemCount=function(){var t=0;return t=0,null!=this.FTreeView&&(t=this.FTreeView.SelectedVirtualNodeCount()),t},this.LookupItem=function(t,e,i){var s=null,n="",o=null,r=0,a="";s=null,n=t,e||(n=pas.SysUtils.UpperCase(n));for(var l=0,h=this.FItems.GetCount()-1;l<=h;l++)if(r=l,a=(o=this.FItems.GetItem$1(r)).GetStrippedHTMLText(),e||(a=pas.SysUtils.UpperCase(a)),1===pas.System.Pos(n,a)){s=o;break}return null!=s&&this.IsItemSelectable(s)&&i&&(this.SelectItem(s.GetIndex()),this.ScrollToItem(s.GetIndex())),s},this.IsItemSelectable=function(t){var e=!1;return e=!0,null!=t&&(e=t.FEnabled,this.FTreeView.FVisibleNodes.IndexOf(this.GetNodeForItemIndex(t.GetIndex()))>-1||(e=!1)),e},this.RemoveItem=function(t){null!=t&&this.FItems.Delete(t.GetIndex())},this.DoEnter=function(){pas["WEBLib.Controls"].TControl.DoEnter.call(this),null!=this.FTreeView&&(this.FTreeView.GetAllowFocus()&&this.FTreeView.SetFocus(),this.FTreeView.Invalidate())},this.BeginUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.BeginUpdate.call(this),null!=this.FTreeView&&(0===this.FUpdateCount$1&&(this.FSaveSelectedItemIndex=this.GetItemIndex()),this.FUpdateCount$1+=1,this.FTreeView.BeginUpdate(),this.FTreeView.ClearNodeList())},this.EndUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.EndUpdate.call(this),null!=this.FTreeView&&(this.FUpdateCount$1-=1,this.FTreeView.EndUpdate(),0===this.FUpdateCount$1&&this.SetItemIndex(this.FSaveSelectedItemIndex))},this.InitSample=function(){this.BeginUpdate(),this.FItems.Clear$1(),this.ResetToDefaultStyle(),this.AddItem("Bugfix 376"),this.AddItem("Bugfix 378"),this.AddItem("Customer Update"),this.AddItem("Install New server"),this.AddItem("Meeting: Next Phase"),this.AddItem("Release Planning"),this.EndUpdate()},this.ScrollToItem=function(t){var e=null;null!=this.FTreeView&&t>=0&&t<=this.FItems.GetCount()-1&&(e=this.FTreeView).ScrollToVirtualNode(e.GetNodeForRow(t),!0,0,!1)},this.SelectItem=function(t){var e=null;null!=this.FTreeView&&(e=this.FTreeView,t>=0&&t<=this.FItems.GetCount()-1?e.SelectVirtualNode(e.GetNodeForRow(t)):e.SelectVirtualNode(null))},this.CutToClipboard=function(t){var e=0;this.BeginUpdate(),this.CopyToClipboard(t);for(var i=this.SelectedItemCount()-1;i>=0;i--)e=i,this.RemoveItem(this.GetSelItem(e));this.EndUpdate()},this.CopyToClipboard=function(e){var i="",s=0,n=null,o=null;o=pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewIntegerList.$create("Create$1");try{i="";for(var r=0,a=this.SelectedItemCount()-1;r<=a;r++)s=r,null!=(n=this.GetSelItem(s))&&-1===o.IndexOf(n.GetIndex())&&(i=i+n.SaveToString(e)+pas["WEBLib.TMSFNCCustomTreeView"].ENDOFLINE,o.Add(n.GetIndex()));""!==i&&pas["WEBLib.TMSFNCUtils"].TTMSFNCClipBoard.SetText(t.CLP_FMT+i)}finally{o=rtl.freeLoc(o)}},this.PasteFromClipboard=function(){var e="",i=null,s=0,n="";if(pas["WEBLib.TMSFNCUtils"].TTMSFNCClipBoard.HasFormat(0)&&(e=pas["WEBLib.TMSFNCUtils"].TTMSFNCClipBoard.GetText(),pas.System.Pos(t.CLP_FMT,e)>0)){i=pas.Classes.TStringList.$create("Create$1");try{e=pas.SysUtils.StringReplace(e,t.CLP_FMT,"",rtl.createSet(0)),i.SetTextStr(e);try{for(var o=0,r=i.GetCount()-1;o<=r;o++)s=o,n=i.Get(s),this.AddItem("").LoadFromString(n)}finally{}}finally{i=rtl.freeLoc(i)}}},this.ApplyFilter=function(){var t=0,e=null,i=0;if(null!=this.FTreeView){this.FTreeView.FFilter.Clear();for(var s=0,n=this.FFilter.GetCount()-1;s<=n;s++)t=s,(e=this.FTreeView.FFilter.Add$1()).FColumn=0,e.FCondition=this.FFilter.GetItem$1(t).FCondition,e.FCaseSensitive=this.FFilter.GetItem$1(t).FCaseSensitive,e.FPrefix=this.FFilter.GetItem$1(t).FPrefix,e.FSuffix=this.FFilter.GetItem$1(t).FSuffix,i=this.FFilter.GetItem$1(t).FOperation,e.FOperation=i;this.FTreeView.ApplyFilter()}},this.RemoveFilter=function(){null!=this.FTreeView&&this.FTreeView.RemoveFilter()},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCListBox",this.TTMSFNCCustomListBox,(function(){this.RegisterRuntimeClasses=function(){t.TTMSFNCCustomListBox.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClasses([t.TTMSFNCListBox,t.TTMSFNCListBoxItem])},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Fill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetFill","SetFill$1"),e.addProperty("Stroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetStroke","SetStroke$1"),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("ItemsAppearance",2,t.$rtti.TTMSFNCListBoxItemsAppearance,"FItemsAppearance","SetItemsAppearance"),e.addProperty("DefaultItem",2,t.$rtti.TTMSFNCListBoxItem,"FDefaultItem","SetDefaultItem"),e.addProperty("Items",2,t.$rtti.TTMSFNCListBoxItems,"FItems","SetItems"),e.addProperty("Header",2,t.$rtti.TTMSFNCListBoxHeader,"FHeader","SetHeader"),e.addProperty("ItemIndex",3,rtl.longint,"GetItemIndex","SetItemIndex",{Default:-1}),e.addProperty("Interaction",2,t.$rtti.TTMSFNCListBoxInteraction,"FInteraction","SetInteraction"),e.addProperty("OnItemSelected",0,t.$rtti.TTMSFNCListBoxItemSelectedEvent,"FOnItemSelected","FOnItemSelected"),e.addProperty("Version",1,rtl.string,"GetVersion",""),e.addProperty("VerticalScrollBarVisible",3,rtl.boolean,"GetVerticalScrollBarVisible","SetVerticalScrollBarVisible",{Default:!0}),e.addProperty("GlobalFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCAppearanceGlobalFont,"FGlobalFont","SetGlobalFont"),e.addProperty("OnNeedFilterDropDownData",0,t.$rtti.TTMSFNCListBoxNeedFilterDropDownDataEvent,"FOnNeedFilterDropDownData","FOnNeedFilterDropDownData"),e.addProperty("OnFilterSelect",0,t.$rtti.TTMSFNCListBoxFilterSelectEvent,"FOnFilterSelect","FOnFilterSelect"),e.addProperty("OnBeforeDrawItem",0,t.$rtti.TTMSFNCListBoxBeforeDrawItemEvent,"FOnBeforeDrawItem","FOnBeforeDrawItem"),e.addProperty("OnAfterDrawItem",0,t.$rtti.TTMSFNCListBoxAfterDrawItemEvent,"FOnAfterDrawItem","FOnAfterDrawItem"),e.addProperty("OnItemCompare",0,t.$rtti.TTMSFNCListBoxItemCompareEvent,"FOnItemCompare","FOnItemCompare"),e.addProperty("OnAfterDrawItemIcon",0,t.$rtti.TTMSFNCListBoxAfterDrawItemIconEvent,"FOnAfterDrawItemIcon","FOnAfterDrawItemIcon"),e.addProperty("OnBeforeDrawItemIcon",0,t.$rtti.TTMSFNCListBoxBeforeDrawItemIconEvent,"FOnBeforeDrawItemIcon","FOnBeforeDrawItemIcon"),e.addProperty("OnBeforeDrawItemText",0,t.$rtti.TTMSFNCListBoxBeforeDrawItemTextEvent,"FOnBeforeDrawItemText","FOnBeforeDrawItemText"),e.addProperty("OnAfterDrawItemText",0,t.$rtti.TTMSFNCListBoxAfterDrawItemTextEvent,"FOnAfterDrawItemText","FOnAfterDrawItemText"),e.addProperty("OnAfterDrawSortIndicator",0,t.$rtti.TTMSFNCListBoxAfterDrawSortIndicatorEvent,"FOnAfterDrawSortIndicator","FOnAfterDrawSortIndicator"),e.addProperty("OnBeforeDrawSortIndicator",0,t.$rtti.TTMSFNCListBoxBeforeDrawSortIndicatorEvent,"FOnBeforeDrawSortIndicator","FOnBeforeDrawSortIndicator"),e.addProperty("OnItemAnchorClick",0,t.$rtti.TTMSFNCListBoxItemAnchorClickEvent,"FOnItemAnchorClick","FOnItemAnchorClick"),e.addProperty("OnItemClick",0,t.$rtti.TTMSFNCListBoxItemClickEvent,"FOnItemClick","FOnItemClick"),e.addProperty("OnItemMouseLeave",0,t.$rtti.TTMSFNCListBoxItemMouseLeaveEvent,"FOnItemMouseLeave","FOnItemMouseLeave"),e.addProperty("OnItemMouseEnter",0,t.$rtti.TTMSFNCListBoxItemMouseEnterEvent,"FOnItemMouseEnter","FOnItemMouseEnter"),e.addProperty("OnItemDblClick",0,t.$rtti.TTMSFNCListBoxItemClickEvent,"FOnItemDblClick","FOnItemDblClick"),e.addProperty("OnVScroll",0,t.$rtti.TTMSFNCListBoxScrollEvent,"FOnVScroll","FOnVScroll"),e.addProperty("OnBeforeReorderItem",0,t.$rtti.TTMSFNCListBoxBeforeReorderItemEvent,"FOnBeforeReorderItem","FOnBeforeReorderItem"),e.addProperty("OnAfterReorderItem",0,t.$rtti.TTMSFNCListBoxAfterReorderItemEvent,"FOnAfterReorderItem","FOnAfterReorderItem"),e.addProperty("OnBeforeDropItem",0,t.$rtti.TTMSFNCListBoxBeforeDropItemEvent,"FOnBeforeDropItem","FOnBeforeDropItem"),e.addProperty("OnAfterDropItem",0,t.$rtti.TTMSFNCListBoxAfterDropItemEvent,"FOnAfterDropItem","FOnAfterDropItem"),e.addProperty("OnBeforeCutToClipboard",0,t.$rtti.TTMSFNCListBoxBeforeCutToClipboardEvent,"FOnBeforeCutToClipboard","FOnBeforeCutToClipboard"),e.addProperty("OnBeforeCopyToClipboard",0,t.$rtti.TTMSFNCListBoxBeforeCopyToClipboardEvent,"FOnBeforeCopyToClipboard","FOnBeforeCopyToClipboard"),e.addProperty("OnBeforePasteFromClipboard",0,t.$rtti.TTMSFNCListBoxBeforePasteFromClipboardEvent,"FOnBeforePasteFromClipboard","FOnBeforePasteFromClipboard"),e.addProperty("OnAfterCutToClipboard",0,t.$rtti.TTMSFNCListBoxAfterCutToClipboardEvent,"FOnAfterCutToClipboard","FOnAfterCutToClipboard"),e.addProperty("OnAfterCopyToClipboard",0,t.$rtti.TTMSFNCListBoxAfterCopyToClipboardEvent,"FOnAfterCopyToClipboard","FOnAfterCopyToClipboard"),e.addProperty("OnAfterPasteFromClipboard",0,t.$rtti.TTMSFNCListBoxAfterPasteFromClipboardEvent,"FOnAfterPasteFromClipboard","FOnAfterPasteFromClipboard"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),t.$implcode=function(){rtl.createClass(e,"TTMSFNCTreeViewOpen",pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(e,"TTMSFNCCustomTreeViewOpen",pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(e,"TTMSFNCCustomListBoxOpen",t.TTMSFNCCustomListBox,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)}))}}),["WEBLib.TMSFNCUtils","WEBLib.Controls","SysUtils","WEBLib.Graphics","WEBLib.TMSFNCCustomSelector"]),rtl.module("WEBLib.TMSFNCTabSet",["System","Classes","Types","WEBLib.TMSFNCPersistence","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCPopup","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCTypes","WEBLib.Controls","WEBLib.ExtCtrls","WEBLib.StdCtrls","WEBLib.TMSFNCGraphicsTypes"],(function(){"use strict";var t=this,e=t.$impl;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=1,this.BLD_VER=1,this.TMSFNCTABSETLISTSVG="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBkPSJtMTcgMTAtNSA1LTUtNSIgZmlsbD0ibm9uZSIvPjwvc3ZnPg==",this.TMSFNCTABSETCLOSESVG="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgZmlsbD0ibm9uZSI+PHBhdGggc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBkPSJNMTIgMTIgNyA3bTUgNSA1IDVtLTUtNSA1LTVtLTUgNS01IDUiLz48L3N2Zz4=",this.TMSFNCTABSETADDSVG="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSI+CjxnIGlkPSJzdXJmYWNlMSI+CjxwYXRoIHN0eWxlPSIgc3Ryb2tlOm5vbmU7ZmlsbC1ydWxlOm5vbnplcm87ZmlsbDpyZ2IoMCUsMCUsMCUpO2ZpbGwtb3BhY2l0eToxOyIgZD0iTSAxMiA2IEMgMTIuNDE0MDYyIDYgMTIuNzUgNi4zMzU5MzggMTIuNzUgNi43NSBMIDEyLjc1IDExLjI1IEwgMTcuMjUgMTEuMjUgQyAxNy42NjQwNjIgMTEuMjUgMTggMTEuNTg1OTM4IDE4IDEyIEMgMTggMTIuNDE0MDYyIDE3LjY2NDA2MiAxMi43NSAxNy4yNSAxMi43NSBMIDEyLjc1IDEyLjc1IEwgMTIuNzUgMTcuMjUgQyAxMi43NSAxNy42NjQwNjIgMTIuNDE0MDYyIDE4IDEyIDE4IEMgMTEuNTg1OTM4IDE4IDExLjI1IDE3LjY2NDA2MiAxMS4yNSAxNy4yNSBMIDExLjI1IDEyLjc1IEwgNi43NSAxMi43NSBDIDYuMzM1OTM4IDEyLjc1IDYgMTIuNDE0MDYyIDYgMTIgQyA2IDExLjU4NTkzOCA2LjMzNTkzOCAxMS4yNSA2Ljc1IDExLjI1IEwgMTEuMjUgMTEuMjUgTCAxMS4yNSA2Ljc1IEMgMTEuMjUgNi4zMzU5MzggMTEuNTg1OTM4IDYgMTIgNiBaIE0gMTIgNiAiLz4KPC9nPgo8L3N2Zz4K",this.TMSFNCTABSETNEXTSVG="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBkPSJtMTAgNyA1IDUtNSA1Ii8+PC9zdmc+",this.TMSFNCTABSETPREVIOUSSVG="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBkPSJtMTQgNy01IDUgNSA1Ii8+PC9zdmc+",this.TTMSFNCTabSetColorProgress=16297243,this.TTMSFNCTabSetColor=16316397,this.TTMSFNCTabSetDownColor=15655897,this.TTMSFNCTabSetHoverColor=16313827,this.$rtti.$Class("TTMSFNCTabSetTab"),this.TTMSFNCTabSetTabShape={0:"tsRectangle",tsRectangle:0,1:"tsPyramidLeft",tsPyramidLeft:1,2:"tsPyramidRight",tsPyramidRight:2,3:"tsPyramid",tsPyramid:3,4:"tsRoundLeft",tsRoundLeft:4,5:"tsRoundRight",tsRoundRight:5,6:"tsRound",tsRound:6},this.$rtti.$Enum("TTMSFNCTabSetTabShape",{minvalue:0,maxvalue:6,ordtype:1,enumtype:this.TTMSFNCTabSetTabShape}),this.TTMSFNCTabSetTabKind={0:"ttkNormal",ttkNormal:0,1:"ttkInsert",ttkInsert:1},this.TTMSFNCTabSetTabProgressMode={0:"tpmNormal",tpmNormal:0,1:"tpmMarquee",tpmMarquee:1},this.$rtti.$Enum("TTMSFNCTabSetTabProgressMode",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTabSetTabProgressMode}),this.TTMSFNCTabSetTabProgressKind={0:"tpkNone",tpkNone:0,1:"tpkCircular",tpkCircular:1,2:"tpkRectangular",tpkRectangular:2},this.$rtti.$Enum("TTMSFNCTabSetTabProgressKind",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTabSetTabProgressKind}),this.TTMSFNCTabSetTabSizeMode={0:"tsmAutoSize",tsmAutoSize:0,1:"tsmFixedSize",tsmFixedSize:1,2:"tsmFixedSizeAutoShrink",tsmFixedSizeAutoShrink:2,3:"tsmAutoTabSize",tsmAutoTabSize:3},this.$rtti.$Enum("TTMSFNCTabSetTabSizeMode",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCTabSetTabSizeMode}),this.TTMSFNCTabSetLayoutPosition={0:"tlpLeft",tlpLeft:0,1:"tlpTop",tlpTop:1,2:"tlpBottom",tlpBottom:2,3:"tlpRight",tlpRight:3},this.$rtti.$Enum("TTMSFNCTabSetLayoutPosition",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCTabSetLayoutPosition}),this.TTMSFNCTabSetLayoutMultiline={0:"tlmNone",tlmNone:0,1:"tlmEnabled",tlmEnabled:1,2:"tlmEnabledActiveTab",tlmEnabledActiveTab:2},this.$rtti.$Enum("TTMSFNCTabSetLayoutMultiline",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTabSetLayoutMultiline}),this.TTMSFNCTabSetTabCloseAction={0:"ttcaNone",ttcaNone:0,1:"ttcaFree",ttcaFree:1,2:"ttcaHide",ttcaHide:2},this.$rtti.$Enum("TTMSFNCTabSetTabCloseAction",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTabSetTabCloseAction}),rtl.recNewT(this,"TTMSFNCTabSetDisplayTab",(function(){this.Tab=null,this.TabKind=0,this.First=!1,this.Last=!1,this.Index=0,this.Row=0,this.$new=function(){var t=Object.create(this);return t.ContentRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),t.ProgressRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),t.CloseButtonRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),t.Rect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),t.BitmapRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),t.TextRect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),t},this.$eq=function(t){return this.Tab===t.Tab&&this.TabKind===t.TabKind&&this.First===t.First&&this.Last===t.Last&&this.ContentRect.$eq(t.ContentRect)&&this.ProgressRect.$eq(t.ProgressRect)&&this.CloseButtonRect.$eq(t.CloseButtonRect)&&this.Rect.$eq(t.Rect)&&this.BitmapRect.$eq(t.BitmapRect)&&this.Index===t.Index&&this.Row===t.Row&&this.TextRect.$eq(t.TextRect)},this.$assign=function(t){return this.Tab=t.Tab,this.TabKind=t.TabKind,this.First=t.First,this.Last=t.Last,this.ContentRect.$assign(t.ContentRect),this.ProgressRect.$assign(t.ProgressRect),this.CloseButtonRect.$assign(t.CloseButtonRect),this.Rect.$assign(t.Rect),this.BitmapRect.$assign(t.BitmapRect),this.Index=t.Index,this.Row=t.Row,this.TextRect.$assign(t.TextRect),this}})),rtl.createClass(this,"TTMSFNCTabSetDisplayList",pas.Classes.TList,(function(){this.GetItem=function(e){var i=t.TTMSFNCTabSetDisplayTab.$new();return i.$assign(rtl.getObject(this.Get(e))),i},this.SetItem=function(e,i){var s=t.TTMSFNCTabSetDisplayTab.$new();s.$assign(i),this.Put(e,s)}})),rtl.createClass(this,"TTMSFNCTabSetInvisibleTabList",pas.Classes.TList,(function(){this.GetItem=function(t){return rtl.getObject(this.Get(t))}})),rtl.createClass(this,"TTMSFNCTabSetTab",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FAnimMarqueeStartAngle=0,this.FAnimMarqueeSweepAngle=0,this.FAnimMarqueeSwitch=!1,this.FTag=0,this.FDataObject=null,this.FTabSet=null,this.FText="",this.FWordWrapping=!1,this.FTrimming=0,this.FTextAlign=0,this.FActiveTextColor=0,this.FTextColor=0,this.FDisabledTextColor=0,this.FEnabled=!1,this.FBitmaps=null,this.FDisabledBitmaps=null,this.FVisible=!1,this.FUseDefaultAppearance=!1,this.FWidth=0,this.FHeight=0,this.FDisabledColor=0,this.FActiveColor=0,this.FHoverTextColor=0,this.FColor=0,this.FHoverColor=0,this.FDownTextColor=0,this.FDownColor=0,this.FBitmapVisible=!1,this.FBitmapSize=0,this.FTextVisible=!1,this.FStretchText=!1,this.FShape=0,this.FProgressColor=0,this.FProgress=0,this.FProgressMax=0,this.FProgressMode=0,this.FCloseButton=!1,this.FProgressKind=0,this.FBadge="",this.FBadgeColor=0,this.FBadgeTextColor=0,this.FHint=""},this.$final=function(){this.FDataObject=void 0,this.FTabSet=void 0,this.FBitmaps=void 0,this.FDisabledBitmaps=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetTrimming=function(t){this.FTrimming!==t&&(this.FTrimming=t,this.UpdateTab())},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,this.UpdateTab())},this.SetTextAlign=function(t){this.FTextAlign!==t&&(this.FTextAlign=t,this.UpdateTab())},this.SetActiveTextColor=function(t){this.FActiveTextColor!==t&&(this.FActiveTextColor=t,this.UpdateTab())},this.SetTextColor=function(t){this.FTextColor!==t&&(this.FTextColor=t,this.UpdateTab())},this.SetDisabledTextColor=function(t){this.FDisabledTextColor!==t&&(this.FDisabledTextColor=t,this.UpdateTab())},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t,this.UpdateTab())},this.SetBitmaps=function(t){this.FBitmaps.Assign(t)},this.SetDisabledBitmaps=function(t){this.FDisabledBitmaps.Assign(t)},this.GetBitmapContainer=function(){var t=null,e=null;return t=null,null!=(e=this.TabSet())&&(t=e.GetBitmapContainer()),t},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,this.UpdateTab())},this.SetUseDefaultAppearance=function(t){this.FUseDefaultAppearance!==t&&(this.FUseDefaultAppearance=t,this.UpdateTab())},this.IsWidthStored=function(){return-1!==this.FWidth},this.SetWidth=function(t){this.FWidth!==t&&(this.FWidth=t,this.UpdateTab())},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t,this.UpdateTab())},this.SetDisabledColor=function(t){this.FDisabledColor!==t&&(this.FDisabledColor=t,this.UpdateTab())},this.SetDownColor=function(t){this.FDownColor!==t&&(this.FDownColor=t,this.UpdateTab())},this.SetDownTextColor=function(t){this.FDownTextColor!==t&&(this.FDownTextColor=t,this.UpdateTab())},this.SetHoverColor=function(t){this.FHoverColor!==t&&(this.FHoverColor=t,this.UpdateTab())},this.SetHoverTextColor=function(t){this.FHoverTextColor!==t&&(this.FHoverTextColor=t,this.UpdateTab())},this.SetActiveColor=function(t){this.FActiveColor!==t&&(this.FActiveColor=t,this.UpdateTab())},this.SetBitmapVisible=function(t){this.FBitmapVisible!==t&&(this.FBitmapVisible=t,this.UpdateTab())},this.IsBitmapSizeStored=function(){return 24!==this.FBitmapSize},this.SetBitmapSize=function(t){this.FBitmapSize!==t&&(this.FBitmapSize=t,this.UpdateTab())},this.SetTextVisible=function(t){this.FTextVisible!==t&&(this.FTextVisible=t,this.UpdateTab())},this.SetStretchText=function(t){this.FStretchText!==t&&(this.FStretchText=t,this.UpdateTab())},this.SetShape=function(t){this.FShape!==t&&(this.FShape=t,this.UpdateTab())},this.SetProgressColor=function(t){this.FProgressColor!==t&&(this.FProgressColor=t,this.UpdateTab())},this.IsProgressStored=function(){return 0!==this.FProgress},this.SetProgress=function(t){this.FProgress!==t&&(this.FProgress=t,this.UpdateTab())},this.IsProgressMaxStored=function(){return 100!==this.FProgressMax},this.SetProgressMax=function(t){this.FProgressMax!==t&&(this.FProgressMax=t,this.UpdateTab())},this.SetProgressMode=function(t){this.FProgressMode!==t&&(this.FProgressMode=t,1===this.FProgressMode&&0!==this.FProgressKind&&this.FTabSet.StartProgressAnimationTimer(),this.UpdateTab())},this.SetCloseButton=function(t){this.FCloseButton!==t&&(this.FCloseButton=t,this.UpdateTab())},this.SetProgressKind=function(t){this.FProgressKind!==t&&(this.FProgressKind=t,1===this.FProgressMode&&0!==this.FProgressKind&&this.FTabSet.StartProgressAnimationTimer(),this.UpdateTab())},this.SetBadge=function(t){this.FBadge!==t&&(this.FBadge=t,this.UpdateTab())},this.SetBadgeColor=function(t){this.FBadgeColor!==t&&(this.FBadgeColor=t,this.UpdateTab())},this.SetBadgeTextColor=function(t){this.FBadgeTextColor!==t&&(this.FBadgeTextColor=t,this.UpdateTab())},this.SetHint=function(t){this.FHint!==t&&(this.FHint=t,this.UpdateTab())},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.UpdateTab())},this.UpdateTab=function(){var t=null;null!=(t=this.TabSet())&&t.UpdateTabs(!1,!1)},this.BitmapsChanged=function(t){var e;e=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FBitmaps,0,this.GetBitmapContainer()),this.SetBitmapVisible(null!=e&&!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(e))},this.Draw=function(e,i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();null!=this.FTabSet&&null!=i.Tab&&(s.$assign(this.GetFixedRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i.Rect),t.TTMSFNCTabSetDisplayTab.$clone(i))),s.Right-s.Left<=0||s.Bottom-s.Top<=0||(e.FFont.Assign(this.TabSet().FTabAppearance.FFont),this.FEnabled?i.Tab===this.TabSet().FActiveTab?(e.FFill.Assign(this.TabSet().FTabAppearance.FActiveFill),e.FStroke.Assign(this.TabSet().FTabAppearance.FActiveStroke)):i.Tab===this.TabSet().FDownTab?(e.FFill.Assign(this.TabSet().FTabAppearance.FDownFill),e.FStroke.Assign(this.TabSet().FTabAppearance.FDownStroke)):i.Tab===this.TabSet().FHoverTab?(e.FFill.Assign(this.TabSet().FTabAppearance.FHoverFill),e.FStroke.Assign(this.TabSet().FTabAppearance.FHoverStroke)):(e.FFill.Assign(this.TabSet().FTabAppearance.FFill),e.FStroke.Assign(this.TabSet().FTabAppearance.FStroke)):(e.FFill.Assign(this.TabSet().FTabAppearance.FDisabledFill),e.FStroke.Assign(this.TabSet().FTabAppearance.FDisabledStroke)),this.FUseDefaultAppearance||(this.FEnabled?i.Tab===this.TabSet().FActiveTab?e.FFill.SetColor(this.FActiveColor):i.Tab===this.TabSet().FDownTab?e.FFill.SetColor(this.FDownColor):i.Tab===this.TabSet().FHoverTab?e.FFill.SetColor(this.FHoverColor):e.FFill.SetColor(this.FColor):e.FFill.SetColor(this.FDisabledColor)),this.DrawBackground(e,t.TTMSFNCTabSetDisplayTab.$clone(i)),this.DrawProgress(e,t.TTMSFNCTabSetDisplayTab.$clone(i)),this.DrawBitmap(e,t.TTMSFNCTabSetDisplayTab.$clone(i)),this.DrawText(e,t.TTMSFNCTabSetDisplayTab.$clone(i)),this.DrawCloseButton(e,t.TTMSFNCTabSetDisplayTab.$clone(i)),this.DrawFocus(e,t.TTMSFNCTabSetDisplayTab.$clone(i))))},this.DrawBackground=function(e,i){var s=null,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=!1,r=0;null!=this.FTabSet&&(n.$assign(this.GetFixedRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i.Rect),t.TTMSFNCTabSetDisplayTab.$clone(i))),r=this.FEnabled?i.Tab===this.TabSet().FActiveTab?3:i.Tab===this.TabSet().FDownTab?2:i.Tab===this.TabSet().FHoverTab?1:0:4,o=!0,this.FTabSet.DoBeforeDrawTabBackground(e,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),r,{get:function(){return o},set:function(t){o=t}}),o&&(this===this.TabSet().FInsertTab?e.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),this.TabSet().FButtonAppearance.FRounding,rtl.createSet(0,1,2,3),2):null!=(s=this.GetShapePath(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n)))&&(e.DrawPath(s,0),s=rtl.freeLoc(s)),this.FTabSet.DoAfterDrawTabBackground(e,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),r)))},this.DrawText=function(t,e){var i,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=!1,o=0,r=0,a=0,l="",h=!1;if(null!=this.FTabSet&&this.FTextVisible&&""!==this.FText&&(!this.FTabSet.FInplaceEditorActive||this.FTabSet.FUpdateTab.Tab!==this)){s.$assign(e.TextRect),i=t.SaveState(!1);try{if(t.ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s)),this.FUseDefaultAppearance?(n=this.TabSet().FTabAppearance.FWordWrapping,o=this.TabSet().FTabAppearance.FTrimming,r=this.TabSet().FTabAppearance.FTextAlign,this.FEnabled?this===this.TabSet().FActiveTab?t.FFont.SetColor(this.TabSet().FTabAppearance.FActiveTextColor):this===this.TabSet().FDownTab?t.FFont.SetColor(this.TabSet().FTabAppearance.FDownTextColor):this===this.TabSet().FHoverTab?t.FFont.SetColor(this.TabSet().FTabAppearance.FHoverTextColor):t.FFont.SetColor(this.TabSet().FTabAppearance.FTextColor):t.FFont.SetColor(this.TabSet().FTabAppearance.FDisabledTextColor)):(n=this.FWordWrapping,o=this.FTrimming,r=this.FTextAlign,this.FEnabled?this===this.TabSet().FActiveTab?t.FFont.SetColor(this.FActiveTextColor):this===this.TabSet().FDownTab?t.FFont.SetColor(this.FDownTextColor):this===this.TabSet().FHoverTab?t.FFont.SetColor(this.FHoverTextColor):t.FFont.SetColor(this.FTextColor):t.FFont.SetColor(this.FDisabledTextColor)),a=0,l=this.FText,h=!0,this.FTabSet.DoBeforeDrawTabText(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),l,{get:function(){return h},set:function(t){h=t}}),h){var F=this.TabSet().FLayout.FPosition;1===F||2===F?t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),l,n,r,a,o,0,-1,-1,!0,!1,-1,-1):0===F?t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),l,n,r,a,o,-90,-1,-1,!0,!1,-1,-1):3===F&&t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),l,n,r,a,o,90,-1,-1,!0,!1,-1,-1),this.FTabSet.DoAfterDrawTabText(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),l)}}finally{t.RestoreState(i,!1)}}},this.DrawFocus=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();null!=this.FTabSet&&this.FTabSet.FTabAppearance.FShowFocus&&this.FTabSet.IsFocused()&&this===this.FTabSet.FFocusedTab&&(i.$assign(e.ContentRect),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-1,-1),t.DrawFocusRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FTabSet.FTabAppearance.FFocusBorderColor,2))},this.DrawProgress=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=!1;if(null!=this.FTabSet&&0!==this.FProgressKind&&(this.FProgress>0&&this.FProgressMax>0&&0===this.FProgressMode||1===this.FProgressMode)){var o=this.FProgressKind;if(1===o){if(t.FFill.SetKind(0),t.FStroke.Assign(this.FTabSet.FTabAppearance.FProgressStroke),this.FUseDefaultAppearance||t.FStroke.SetColor(this.FProgressColor),t.FStroke.SetWidth(2),i.$assign(e.ProgressRect),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-2,-2),n=!0,this.FTabSet.DoBeforeDrawTabProgress(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FProgressMode,this.FProgressKind,this.FAnimMarqueeStartAngle,this.FAnimMarqueeSweepAngle,this.FProgress,this.FProgressMax,{get:function(){return n},set:function(t){n=t}}),n){var r=this.FProgressMode;0===r?t.DrawArc(pas["WEBLib.TMSFNCTypes"].CenterPointEx(i),pas["WEBLib.TMSFNCTypes"].PointF((i.Right-i.Left)/2,(i.Bottom-i.Top)/2),0,360/this.FProgressMax*this.FProgress):1===r&&t.DrawArc(pas["WEBLib.TMSFNCTypes"].CenterPointEx(i),pas["WEBLib.TMSFNCTypes"].PointF((i.Right-i.Left)/2,(i.Bottom-i.Top)/2),this.FAnimMarqueeStartAngle,this.FAnimMarqueeSweepAngle),this.FTabSet.DoAfterDrawTabProgress(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FProgressMode,this.FProgressKind,this.FAnimMarqueeStartAngle,this.FAnimMarqueeSweepAngle,this.FProgress,this.FProgressMax)}}else if(2===o&&(t.FFill.Assign(this.FTabSet.FTabAppearance.FProgressFill),this.FUseDefaultAppearance||t.FFill.SetColor(this.FProgressColor),t.FStroke.Assign(this.FTabSet.FTabAppearance.FProgressStroke),i.$assign(e.ContentRect),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-4,-4),n=!0,this.FTabSet.DoBeforeDrawTabProgress(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FProgressMode,this.FProgressKind,this.FAnimMarqueeStartAngle,this.FAnimMarqueeSweepAngle,this.FProgress,this.FProgressMax,{get:function(){return n},set:function(t){n=t}}),n)){var a=this.FTabSet.FLayout.FPosition;if(1===a||2===a){var l=this.FProgressMode;0===l?s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Left+(i.Right-i.Left)/this.FProgressMax*this.FProgress,i.Bottom)):1===l&&s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+(i.Right-i.Left)/360*this.FAnimMarqueeSweepAngle-5,i.Top,i.Left+5+(i.Right-i.Left)/360*this.FAnimMarqueeSweepAngle,i.Bottom)),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2)}else if(0===a){var h=this.FProgressMode;0===h?s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Bottom-(i.Bottom-i.Top)/this.FProgressMax*this.FProgress,i.Right,i.Bottom)):1===h&&s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Bottom-(i.Bottom-i.Top)/360*this.FAnimMarqueeSweepAngle,i.Right,i.Bottom)),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2)}else if(3===a){var F=this.FProgressMode;0===F?s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Right,i.Bottom-(i.Bottom-i.Top)/this.FProgressMax*this.FProgress)):1===F&&s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Right,i.Bottom-(i.Bottom-i.Top)/360*this.FAnimMarqueeSweepAngle)),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2)}this.FTabSet.DoAfterDrawTabProgress(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FProgressMode,this.FProgressKind,this.FAnimMarqueeStartAngle,this.FAnimMarqueeSweepAngle,this.FProgress,this.FProgressMax)}}},this.DrawCloseButton=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0,n=0,o=!1,r=0,a=0;null!=this.FTabSet&&1===this.TabSet().FOptions.FCloseMode&&this.FCloseButton&&(i.$assign(e.CloseButtonRect),i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left),pas.System.Int(i.Top),pas.System.Int(i.Right),pas.System.Int(i.Bottom))),e.Tab===this.TabSet().FDownCloseTab?(t.FFill.Assign(this.TabSet().FTabAppearance.FCloseDownFill),t.FStroke.Assign(this.TabSet().FTabAppearance.FCloseDownStroke)):e.Tab===this.TabSet().FHoverCloseTab?(t.FFill.Assign(this.TabSet().FTabAppearance.FCloseHoverFill),t.FStroke.Assign(this.TabSet().FTabAppearance.FCloseHoverStroke)):(t.FFill.Assign(this.TabSet().FTabAppearance.FCloseFill),t.FStroke.Assign(this.TabSet().FTabAppearance.FCloseStroke)),r=e.Tab===this.TabSet().FDownCloseTab?2:e.Tab===this.TabSet().FHoverCloseTab?1:0,o=!0,this.FTabSet.DoBeforeDrawTabCloseButton(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),r,{get:function(){return o},set:function(t){o=t}}),o&&(0!==t.FFill.FKind&&(s=t.FStroke.FKind,n=t.FStroke.FColor,t.FStroke.SetKind(1),t.FStroke.SetColor(t.FFill.FColor),t.DrawEllipse$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),0),t.FStroke.SetKind(s),t.FStroke.SetColor(n)),a=this.FTabSet.FPaintScaleFactor,pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-4*a,-4*a),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,i.Top)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Right,i.Bottom)),0,0),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,i.Bottom)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Right,i.Top)),0,0),this.FTabSet.DoAfterDrawTabCloseButton(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),r)))},this.DrawBitmap=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=!1;null!=this.FTabSet&&this.FBitmapVisible&&(i.$assign(e.BitmapRect),s=!0,this.FTabSet.DoBeforeDrawTabBitmap(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),{get:function(){return s},set:function(t){s=t}}),s&&(this.FEnabled?t.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FBitmaps,0,!0,!1,!0,!1):t.DrawScaledBitmap(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FDisabledBitmaps,0,!0,!1,!0,!1),this.FTabSet.DoAfterDrawTabBitmap(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))))},this.DrawBadge=function(t,e){var i,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),o=null,r=0,a=!1;if(null!=this.FTabSet&&""!==this.FBadge&&(t.FFont.Assign(this.TabSet().FTabAppearance.FBadgeFont),t.FStroke.Assign(this.TabSet().FTabAppearance.FBadgeStroke),t.FFill.Assign(this.TabSet().FTabAppearance.FBadgeFill),this.FUseDefaultAppearance||(t.FFont.SetColor(this.FBadgeTextColor),t.FFill.SetColor(this.FBadgeColor)),i=this.FBadge,n.$assign(t.CalculateTextSize$1(i)),n.cy=n.cy+4,n.cx=Math.max(n.cy,n.cx+6),this.GetShape()in rtl.createSet(0,4,5,6)?s.$assign(e.Rect):s.$assign(e.ContentRect),!((s.Right-s.Left)/3*2<n.cx))){var l=this.TabSet().FLayout.FPosition;if(1===l?s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(s.Right-n.cx/2),pas.System.Int(s.Top-n.cy/2),pas.System.Int(s.Right+n.cx/2),pas.System.Int(s.Top+n.cy/2))):2===l?s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(s.Right-n.cx/2),pas.System.Int(s.Bottom-n.cy/2),pas.System.Int(s.Right+n.cx/2),pas.System.Int(s.Bottom+n.cy/2))):0===l?s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(s.Left-n.cy/2),pas.System.Int(s.Top-n.cx/2),pas.System.Int(s.Left+n.cy/2),pas.System.Int(s.Top+n.cx/2))):3===l&&s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(s.Right-n.cy/2),pas.System.Int(s.Bottom-n.cx/2),pas.System.Int(s.Right+n.cy/2),pas.System.Int(s.Bottom+n.cx/2))),a=!0,this.FTabSet.DoBeforeDrawTabBadge(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),i,{get:function(){return a},set:function(t){a=t}}),a){var h=this.TabSet().FLayout.FPosition;r=1===h||2===h?(s.Bottom-s.Top)/2:0===h||3===h?(s.Right-s.Left)/2:0,(o=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1")).AddArc(pas["WEBLib.TMSFNCTypes"].PointF(s.Left+r,s.Top+r),pas["WEBLib.TMSFNCTypes"].PointF(r,r),180,90),o.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(s.Right-r,s.Top+r),pas["WEBLib.TMSFNCTypes"].PointF(r,r),-90,90),o.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(s.Right-r,s.Bottom-r),pas["WEBLib.TMSFNCTypes"].PointF(r,r),0,90),o.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(s.Left+r,s.Bottom-r),pas["WEBLib.TMSFNCTypes"].PointF(r,r),-270,90),o.ClosePath(),t.DrawPath(o,0);var F=this.TabSet().FLayout.FPosition;1===F||2===F?t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),i,!1,0,0,0,0,-1,-1,!0,!1,-1,-1):0===F?t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),i,!1,0,0,0,-90,-1,-1,!0,!1,-1,-1):3===F&&t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),i,!1,0,0,0,90,-1,-1,!0,!1,-1,-1),o=rtl.freeLoc(o),this.FTabSet.DoAfterDrawTabBadge(t,this.GetIndex(),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),i)}}},this.GetInsertShapePath=function(t){var e,i=null,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return s.$assign(t),e=this.TabSet().FTabAppearance.FShapeRounding,(i=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1")).AddArc(pas["WEBLib.TMSFNCTypes"].PointF(s.Left+e,s.Top+e),pas["WEBLib.TMSFNCTypes"].PointF(e,e),180,90),i.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(s.Right-e,s.Top+e),pas["WEBLib.TMSFNCTypes"].PointF(e,e),-90,90),i.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(s.Right-e,s.Bottom-e),pas["WEBLib.TMSFNCTypes"].PointF(e,e),0,90),i.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(s.Left+e,s.Bottom-e),pas["WEBLib.TMSFNCTypes"].PointF(e,e),-270,90),i.ClosePath(),i},this.GetShapePath=function(t){var e,i,s=null,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=0,r=0;if(n.$assign(t),o=this.GetShape(),0===(e=this.TabSet().FTabAppearance.FShapeSlope)&&o in rtl.createSet(1,2,3)&&(o=0),i=this.TabSet().FTabAppearance.FShapeRounding,r=0,e>0){var a=this.TabSet().FLayout.FPosition;1===a||2===a?r=pas.Math.RadToDeg(Math.asin((n.Bottom-n.Top)/Math.sqrt(Math.pow(n.Bottom-n.Top,2)+Math.pow(e,2)))):0!==a&&3!==a||(r=pas.Math.RadToDeg(Math.asin((n.Right-n.Left)/Math.sqrt(Math.pow(n.Right-n.Left,2)+Math.pow(e,2)))))}var l=this.TabSet().FLayout.FPosition;if(1===l){(s=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1")).MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Bottom));var h=o;0===h||2===h||5===h?s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Top)):1===h||3===h?(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Bottom-i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),-270,-r),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Left+e+i,n.Top+i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),-r-90,r)):4!==h&&6!==h||(s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Top+i)),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Left+i,n.Top+i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),180,90));var F=o;0===F||1===F||4===F?s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Top)):2===F||3===F?(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Right-e-i,n.Top+i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),270,r),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Bottom-i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),r+90,-r)):5!==F&&6!==F||(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Right-i,n.Top+i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),270,90),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Top+i))),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Bottom)),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Bottom)),s.ClosePath()}else if(2===l){(s=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1")).MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Top));var p=o;0===p||2===p||5===p?s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Bottom)):1===p||3===p?(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Top+i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),270,r),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Left+e+i,n.Bottom-i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),r-270,-r)):4!==p&&6!==p||(s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Bottom-i)),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Left+i,n.Bottom-i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),-180,-90));var c=o;0===c||1===c||4===c?s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Bottom)):2===c||3===c?(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Right-e-i,n.Bottom-i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),-270,-r),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Top+i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),270-r,r)):5!==c&&6!==c||(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Right-i,n.Bottom-i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),-270,-90),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Bottom-i))),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Top)),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Top)),s.ClosePath()}else if(0===l){(s=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1")).MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Bottom));var u=o;0===u||2===u||5===u?s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Bottom)):1===u||3===u?(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Right-i,n.Bottom),pas["WEBLib.TMSFNCTypes"].PointF(i,i),0,-r),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Left+i,n.Bottom-e-i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),180-r,r)):4!==u&&6!==u||(s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Left+i,n.Bottom)),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Left+i,n.Bottom-i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),90,90));var T=o;0===T||1===T||4===T?s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Top)):2===T||3===T?(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Left+i,n.Top+e+i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),180,r),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Right-i,n.Top),pas["WEBLib.TMSFNCTypes"].PointF(i,i),r,-r)):5!==T&&6!==T||(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Left+i,n.Top+i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),180,90),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Left+i,n.Top))),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Top)),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Bottom)),s.ClosePath()}else if(3===l){(s=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1")).MoveTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Top));var C=o;0===C||2===C||5===C?s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Top)):1===C||3===C?(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Left+i,n.Top),pas["WEBLib.TMSFNCTypes"].PointF(i,i),-180,-r),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Right-i,n.Top+e+i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),-r,r)):4!==C&&6!==C||(s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Right-i,n.Top)),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Right-i,n.Top+i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),-90,90));var S=o;0===S||1===S||4===S?s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Right,n.Bottom)):2===S||3===S?(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Right-i,n.Bottom-e-i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),0,r),s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Left+i,n.Bottom),pas["WEBLib.TMSFNCTypes"].PointF(i,i),-180+r,-r)):5!==S&&6!==S||(s.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(n.Right-i,n.Bottom-i),pas["WEBLib.TMSFNCTypes"].PointF(i,i),0,90),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Right-i,n.Bottom))),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Bottom)),s.LineTo(pas["WEBLib.TMSFNCTypes"].PointF(n.Left,n.Top)),s.ClosePath()}else s=null;return s},this.GetBitmapRect=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();i.$assign(t),s.$assign(this.GetProgressRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))),e.$assign(i);var n=this.TabSet().FLayout.FPosition;return 1===n||2===n?this.FBitmapVisible?this.FTextVisible&&""!==this.FText?this.FTextVisible&&""!==this.FText&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Right+2,i.Top+2,s.Right+this.FBitmapSize+2,i.Bottom-2)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Right+2,i.Top+2,i.Right-2,i.Bottom-2)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Right,i.Top,s.Right,i.Bottom)):0===n?this.FBitmapVisible?this.FTextVisible&&""!==this.FText?this.FTextVisible&&""!==this.FText&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+2,s.Top-this.FBitmapSize-2,i.Right-2,s.Top-2)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+2,i.Top+2,i.Right-2,s.Bottom-2)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,s.Top,i.Right,s.Top)):3===n&&(this.FBitmapVisible?this.FTextVisible&&""!==this.FText?this.FTextVisible&&""!==this.FText&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+2,s.Bottom+2,i.Right-2,s.Bottom+this.FBitmapSize+2)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+2,s.Top+2,i.Right-2,i.Bottom-2)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,s.Bottom,i.Right,s.Bottom))),e},this.GetTextRect=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();n.$assign(t),i.$assign(this.GetBitmapRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t))),s.$assign(this.GetCloseButtonRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t)));var o=this.TabSet().FLayout.FPosition;return 1===o||2===o?this.FStretchText?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(n.Left+2,n.Top+2,n.Right-2,n.Bottom-2)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Right+2,n.Top+2,s.Left-4,n.Bottom-2)):0===o?this.FStretchText?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(n.Left+2,n.Top+2,n.Right-2,n.Bottom-2)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(n.Left+2,s.Bottom+4,n.Right-2,i.Top-2)):3===o&&(this.FStretchText?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(n.Left+2,n.Top+2,n.Right-2,n.Bottom-2)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(n.Left+2,i.Bottom+2,n.Right-2,s.Top-4))),e},this.GetProgressRect=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=0,s=this.FTabSet.FLayout.FPosition;if(0===s?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left,t.Bottom,t.Right,t.Bottom)):1===s||2===s?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left,t.Top,t.Left,t.Bottom)):3===s&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left,t.Top,t.Right,t.Top)),1===this.FProgressKind){i=this.TabSet().FTabAppearance.FProgressCircularSize+4;var n=this.FTabSet.FLayout.FPosition;1===n||2===n?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+4,e.Top+(e.Bottom-e.Top-i)/2,e.Left+i+4,e.Top+(e.Bottom-e.Top-i)/2+i)):0===n?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+(e.Right-e.Left-i)/2,e.Bottom-i-4,e.Left+(e.Right-e.Left-i)/2+i,e.Bottom-4)):3===n&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+(e.Right-e.Left-i)/2,e.Top+4,e.Left+(e.Right-e.Left-i)/2+i,e.Top+i+4))}return e},this.GetCloseButtonRect=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=0,s=this.FTabSet.FLayout.FPosition;if(0===s?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left,t.Top,t.Right,t.Top)):1===s||2===s?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Right,t.Top,t.Right,t.Bottom)):3===s&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left,t.Bottom,t.Right,t.Bottom)),1===this.FTabSet.FOptions.FCloseMode&&this.FCloseButton){i=this.FTabSet.FTabAppearance.FCloseSize;var n=this.FTabSet.FLayout.FPosition;1===n||2===n?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Right-i-4,e.Top+(e.Bottom-e.Top-i)/2,e.Right-4,e.Top+(e.Bottom-e.Top-i)/2+i)):0===n?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+(e.Right-e.Left-i)/2,e.Top+4,e.Left+(e.Right-e.Left-i)/2+i,e.Top+i+4)):3===n&&e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+(e.Right-e.Left-i)/2,e.Bottom-i-4,e.Left+(e.Right-e.Left-i)/2+i,e.Bottom-4))}return e},this.GetFriendlyName=function(){var t="";return""===(t=this.GetStrippedHTMLText())&&(t="Tab "+pas.SysUtils.IntToStr(this.GetIndex())),t},this.GetStrippedHTMLText=function(){var t;return t=this.FText,this.IsHTML()?pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(t):t},this.IsHTML=function(){return pas.System.Pos("</",this.FText)>0||pas.System.Pos("/>",this.FText)>0||pas.System.Pos("<BR>",pas.SysUtils.UpperCase(this.FText))>0},this.GetFixedRect=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(i.$assign(pas["WEBLib.TMSFNCTypes"].EmptyRect()),null==this.TabSet())return i;i.$assign(t);var s=this.TabSet().FLayout.FPosition;return 1===s||2===s?e.First?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)+.5,pas.System.Int(i.Top)+.5,pas.System.Int(i.Right)+.5,pas.System.Int(i.Bottom)-.5)):e.Last?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)-.5,pas.System.Int(i.Top)+.5,pas.System.Int(i.Right)-.5,pas.System.Int(i.Bottom)-.5)):i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)-.5,pas.System.Int(i.Top)+.5,pas.System.Int(i.Right)+.5,pas.System.Int(i.Bottom)-.5)):0!==s&&3!==s||(e.First?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)+.5,pas.System.Int(i.Top)+.5,pas.System.Int(i.Right)-.5,pas.System.Int(i.Bottom)+.5)):e.Last?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)+.5,pas.System.Int(i.Top)-.5,pas.System.Int(i.Right)-.5,pas.System.Int(i.Bottom)-.5)):i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.System.Int(i.Left)+.5,pas.System.Int(i.Top)-.5,pas.System.Int(i.Right)-.5,pas.System.Int(i.Bottom)+.5))),i},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FTabSet=rtl.as(this.FCollection,t.TTMSFNCTabSetTabs).TabSet()),null!=this.FTabSet&&this.FTabSet.IsDesignTime()&&(this.FText="Tab Item "+pas.SysUtils.IntToStr(this.GetIndex())),this.FEnabled=!0,this.FProgress=0,this.FProgressMax=100,this.FProgressMode=0,this.FProgressKind=0,this.FUseDefaultAppearance=!1,this.FTextColor=0,this.FActiveTextColor=0,this.FDisabledTextColor=0,this.FBadgeColor=42495,this.FBadgeTextColor=139,this.FDownTextColor=0,this.FHoverTextColor=0,this.FColor=16316397,this.FProgressColor=16297243,this.FActiveColor=16777215,this.FDisabledColor=13882323,this.FDownColor=15655897,this.FHoverColor=16313827,this.FWordWrapping=!1,this.FTextAlign=0,this.FTrimming=1,this.FCloseButton=!0,this.FWidth=-1,this.FHeight=-1,this.FStretchText=!1,this.FBitmapVisible=!1,this.FBitmapSize=24,this.FTextVisible=!0,this.FShape=3,this.FVisible=!0,this.FBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this.FTabSet]),this.FBitmaps.FOnChange=rtl.createCallback(this,"BitmapsChanged"),this.FDisabledBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this.FTabSet]),this.FDisabledBitmaps.FOnChange=rtl.createCallback(this,"BitmapsChanged"),this.UpdateTab(),this},this.Destroy=function(){var t=null;rtl.free(this,"FDisabledBitmaps"),rtl.free(this,"FBitmaps"),null!=(t=this.TabSet())&&t.FActiveTab===this&&(t.FActiveTab=null),pas.Classes.TCollectionItem.Destroy.call(this),this.UpdateTab()},this.TabSet=function(){return this.FTabSet},this.GetShape=function(){return this.FUseDefaultAppearance?this.TabSet().FTabAppearance.FShape:this.FShape},this.GetAutoSize=function(){var t,e=0,i=null,s=null,n=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),o=0;if(e=0,o=1,null!=(t=this.TabSet())){i=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,t.FNativeCanvas,!0]),t.FNativeCanvas||i.BeginScene();try{s=this.GetBitmap(),""!==this.FText&&this.FTextVisible&&(i.SetFont(t.FTabAppearance.FFont),n.$assign(i.CalculateTextSize(this.FText,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,1e4,1e4)),!0,!0)),e=e+n.cx+6,(0!==t.FTabAppearance.FTrimming&&this.FUseDefaultAppearance||0!==this.FTrimming&&!this.FUseDefaultAppearance)&&(e+=2)),null!=s&&this.FBitmapVisible&&(e=e+this.FBitmapSize+4),1===this.FProgressKind&&(e=e+t.FTabAppearance.FProgressCircularSize+8),1===t.FOptions.FCloseMode&&this.FCloseButton&&(e=e+t.FTabAppearance.FCloseSize+4)}finally{t.FNativeCanvas||i.EndScene(),i=rtl.freeLoc(i)}o=t.FPaintScaleFactor}return e=Math.max(30*o,e)},this.GetBitmap=function(){return this.FEnabled?pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FBitmaps,0,this.GetBitmapContainer()):pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FDisabledBitmaps,0,this.GetBitmapContainer())},this.Assign=function(e){t.TTMSFNCTabSetTab.isPrototypeOf(e)&&(this.FTag=rtl.as(e,t.TTMSFNCTabSetTab).FTag,this.FText=rtl.as(e,t.TTMSFNCTabSetTab).FText,this.FTrimming=rtl.as(e,t.TTMSFNCTabSetTab).FTrimming,this.FWordWrapping=rtl.as(e,t.TTMSFNCTabSetTab).FWordWrapping,this.FTextAlign=rtl.as(e,t.TTMSFNCTabSetTab).FTextAlign,this.FTextColor=rtl.as(e,t.TTMSFNCTabSetTab).FTextColor,this.FActiveTextColor=rtl.as(e,t.TTMSFNCTabSetTab).FActiveTextColor,this.FDisabledTextColor=rtl.as(e,t.TTMSFNCTabSetTab).FDisabledTextColor,this.FDownTextColor=rtl.as(e,t.TTMSFNCTabSetTab).FDownTextColor,this.FHoverTextColor=rtl.as(e,t.TTMSFNCTabSetTab).FHoverTextColor,this.FColor=rtl.as(e,t.TTMSFNCTabSetTab).FColor,this.FProgressColor=rtl.as(e,t.TTMSFNCTabSetTab).FProgressColor,this.FActiveColor=rtl.as(e,t.TTMSFNCTabSetTab).FActiveColor,this.FDisabledColor=rtl.as(e,t.TTMSFNCTabSetTab).FDisabledColor,this.FDownColor=rtl.as(e,t.TTMSFNCTabSetTab).FDownColor,this.FHoverColor=rtl.as(e,t.TTMSFNCTabSetTab).FHoverColor,this.FEnabled=rtl.as(e,t.TTMSFNCTabSetTab).FEnabled,this.FVisible=rtl.as(e,t.TTMSFNCTabSetTab).FVisible,this.FBitmaps.Assign(rtl.as(e,t.TTMSFNCTabSetTab).FBitmaps),this.FDisabledBitmaps.Assign(rtl.as(e,t.TTMSFNCTabSetTab).FDisabledBitmaps),this.FWidth=rtl.as(e,t.TTMSFNCTabSetTab).FWidth,this.FBitmapVisible=rtl.as(e,t.TTMSFNCTabSetTab).FBitmapVisible,this.FBitmapSize=rtl.as(e,t.TTMSFNCTabSetTab).FBitmapSize,this.FUseDefaultAppearance=rtl.as(e,t.TTMSFNCTabSetTab).FUseDefaultAppearance,this.FTextVisible=rtl.as(e,t.TTMSFNCTabSetTab).FTextVisible,this.FStretchText=rtl.as(e,t.TTMSFNCTabSetTab).FStretchText,this.FShape=rtl.as(e,t.TTMSFNCTabSetTab).FShape,this.FProgress=rtl.as(e,t.TTMSFNCTabSetTab).FProgress,this.FProgressMax=rtl.as(e,t.TTMSFNCTabSetTab).FProgressMax,this.FProgressMode=rtl.as(e,t.TTMSFNCTabSetTab).FProgressMode,this.FProgressKind=rtl.as(e,t.TTMSFNCTabSetTab).FProgressKind,this.FCloseButton=rtl.as(e,t.TTMSFNCTabSetTab).FCloseButton,this.FBadge=rtl.as(e,t.TTMSFNCTabSetTab).FBadge,this.FBadgeColor=rtl.as(e,t.TTMSFNCTabSetTab).FBadgeColor,this.FBadgeTextColor=rtl.as(e,t.TTMSFNCTabSetTab).FBadgeTextColor,this.FHint=rtl.as(e,t.TTMSFNCTabSetTab).FHint)};var e=this.$rtti;e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("Badge",2,rtl.string,"FBadge","SetBadge"),e.addProperty("Hint",2,rtl.string,"FHint","SetHint"),e.addProperty("StretchText",2,rtl.boolean,"FStretchText","SetStretchText",{Default:!1}),e.addProperty("TextVisible",2,rtl.boolean,"FTextVisible","SetTextVisible",{Default:!0}),e.addProperty("TabVisible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Bitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FBitmaps","SetBitmaps"),e.addProperty("DisabledBitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FDisabledBitmaps","SetDisabledBitmaps"),e.addProperty("BitmapVisible",2,rtl.boolean,"FBitmapVisible","SetBitmapVisible",{Default:!1}),e.addProperty("BitmapSize",14,rtl.double,"FBitmapSize","SetBitmapSize",{stored:"IsBitmapSizeStored"}),e.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!1}),e.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttCharacter}),e.addProperty("TextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FTextAlign","SetTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("TextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FTextColor","SetTextColor",{Default:0}),e.addProperty("ActiveTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FActiveTextColor","SetActiveTextColor",{Default:0}),e.addProperty("HoverTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FHoverTextColor","SetHoverTextColor",{Default:0}),e.addProperty("DownTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDownTextColor","SetDownTextColor",{Default:0}),e.addProperty("DisabledTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDisabledTextColor","SetDisabledTextColor",{Default:0}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:16316397}),e.addProperty("ProgressColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FProgressColor","SetProgressColor",{Default:16297243}),e.addProperty("ActiveColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FActiveColor","SetActiveColor",{Default:16777215}),e.addProperty("HoverColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FHoverColor","SetHoverColor",{Default:16313827}),e.addProperty("DownColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDownColor","SetDownColor",{Default:15655897}),e.addProperty("DisabledColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDisabledColor","SetDisabledColor",{Default:13882323}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("UseDefaultAppearance",2,rtl.boolean,"FUseDefaultAppearance","SetUseDefaultAppearance",{Default:!1}),e.addProperty("Width",14,rtl.double,"FWidth","SetWidth",{stored:"IsWidthStored"}),e.addProperty("Shape",2,t.$rtti.TTMSFNCTabSetTabShape,"FShape","SetShape",{Default:t.TTMSFNCTabSetTabShape.tsPyramid}),e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag",{Default:0}),e.addProperty("Progress",14,rtl.double,"FProgress","SetProgress",{stored:"IsProgressStored"}),e.addProperty("ProgressMax",14,rtl.double,"FProgressMax","SetProgressMax",{stored:"IsProgressMaxStored"}),e.addProperty("ProgressMode",2,t.$rtti.TTMSFNCTabSetTabProgressMode,"FProgressMode","SetProgressMode",{Default:t.TTMSFNCTabSetTabProgressMode.tpmNormal}),e.addProperty("ProgressKind",2,t.$rtti.TTMSFNCTabSetTabProgressKind,"FProgressKind","SetProgressKind",{Default:t.TTMSFNCTabSetTabProgressKind.tpkNone}),e.addProperty("CloseButton",2,rtl.boolean,"FCloseButton","SetCloseButton",{Default:!0}),e.addProperty("BadgeTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FBadgeTextColor","SetBadgeTextColor",{Default:139}),e.addProperty("BadgeColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FBadgeColor","SetBadgeColor",{Default:42495})})),rtl.createClass(this,"TTMSFNCTabSetTabs",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FTabSet=null},this.$final=function(){this.FTabSet=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetTab=function(t){return this.GetItem(t)},this.GetTabClass=function(){return t.TTMSFNCTabSetTab},this.TabSet=function(){return this.FTabSet},this.Create$3=function(t){return pas.Classes.TOwnedCollection.Create$2.call(this,t,this.GetTabClass()),this.FTabSet=t,this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)},this.Clear$1=function(){var t=null,e=null;if(null!=(t=this.TabSet())&&(t.BeginUpdate(),t.SetActiveTabIndex(-1)),this.GetCount()>0)for(;this.GetCount()>0;)e=this.GetItem(this.GetCount()-1),e=rtl.freeLoc(e);null!=t&&t.EndUpdate()}})),rtl.createClass(this,"TTMSFNCTabSetTabSize",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTabSet=null,this.FMode=0,this.FWidth=0,this.FHeight=0,this.FSpacing=0,this.FMargins=null,this.FOnChange=null},this.$final=function(){this.FTabSet=void 0,this.FMargins=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.IsHeightStored=function(){return 22!==this.FHeight},this.IsWidthStored=function(){return 100!==this.FWidth},this.SetHeight=function(t){this.FHeight!==t&&(this.FHeight=t,this.UpdateTabs())},this.SetMode=function(t){this.FMode!==t&&(this.FMode=t,this.UpdateTabs())},this.SetWidth=function(t){this.FWidth!==t&&(this.FWidth=t,this.UpdateTabs())},this.IsSpacingStored=function(){return 0!==this.FSpacing},this.SetMargins=function(t){this.FMargins.Assign(t)},this.SetSpacing=function(t){this.FSpacing!==t&&(this.FSpacing=t,this.UpdateTabs())},this.UpdateTabs=function(){null!=this.FOnChange&&this.FOnChange(this),null!=this.FTabSet&&this.FTabSet.UpdateTabs(!1,!1)},this.MarginsChanged=function(t){this.UpdateTabs()},this.Create$1=function(t){return this.FTabSet=t,this.FWidth=100,this.FHeight=22,this.FSpacing=0,this.FMode=3,this.FMargins=pas["WEBLib.TMSFNCTypes"].TTMSFNCMargins.$create("Create$1"),null!=this.FTabSet&&this.FTabSet.IsDesignTime()&&(this.FMargins.SetLeft(8),this.FMargins.SetTop(8),this.FMargins.SetRight(8),this.FMargins.SetBottom(8)),this.FMargins.FOnChange=rtl.createCallback(this,"MarginsChanged"),this},this.Destroy=function(){rtl.free(this,"FMargins"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCTabSetTabSize.isPrototypeOf(e)&&(this.FMode=rtl.as(e,t.TTMSFNCTabSetTabSize).FMode,this.FWidth=rtl.as(e,t.TTMSFNCTabSetTabSize).FWidth,this.FHeight=rtl.as(e,t.TTMSFNCTabSetTabSize).FHeight,this.FMargins.Assign(rtl.as(e,t.TTMSFNCTabSetTabSize).FMargins),this.FSpacing=rtl.as(e,t.TTMSFNCTabSetTabSize).FSpacing)};var e=this.$rtti;e.addProperty("Mode",2,t.$rtti.TTMSFNCTabSetTabSizeMode,"FMode","SetMode",{Default:t.TTMSFNCTabSetTabSizeMode.tsmAutoTabSize}),e.addProperty("Width",14,rtl.double,"FWidth","SetWidth",{stored:"IsWidthStored"}),e.addProperty("Height",14,rtl.double,"FHeight","SetHeight",{stored:"IsHeightStored"}),e.addProperty("Margins",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCMargins,"FMargins","SetMargins"),e.addProperty("Spacing",14,rtl.double,"FSpacing","SetSpacing",{stored:"IsSpacingStored"})})),this.TTMSFNCTabSetCloseMode={0:"tcmNone",tcmNone:0,1:"tcmTab",tcmTab:1,2:"tcmMenu",tcmMenu:2},this.$rtti.$Enum("TTMSFNCTabSetCloseMode",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTabSetCloseMode}),this.TTMSFNCTabSetInsertMode={0:"timNone",timNone:0,1:"timTab",timTab:1,2:"timMenu",timMenu:2},this.$rtti.$Enum("TTMSFNCTabSetInsertMode",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTabSetInsertMode}),rtl.createClass(this,"TTMSFNCTabSetButtonAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTabSet=null,this.FSize=0,this.FHoverFill=null,this.FStroke=null,this.FHoverStroke=null,this.FDownFill=null,this.FDownStroke=null,this.FDisabledFill=null,this.FDisabledStroke=null,this.FFill=null,this.FCloseIcon=null,this.FScrollPreviousIcon=null,this.FInsertIcon=null,this.FScrollNextIcon=null,this.FTabListIcon=null,this.FRounding=0},this.$final=function(){this.FTabSet=void 0,this.FHoverFill=void 0,this.FStroke=void 0,this.FHoverStroke=void 0,this.FDownFill=void 0,this.FDownStroke=void 0,this.FDisabledFill=void 0,this.FDisabledStroke=void 0,this.FFill=void 0,this.FCloseIcon=void 0,this.FScrollPreviousIcon=void 0,this.FInsertIcon=void 0,this.FScrollNextIcon=void 0,this.FTabListIcon=void 0,pas.Classes.TPersistent.$final.call(this)},this.IsSizedStored=function(){return 20!==this.FSize},this.SetSize=function(t){this.FSize!==t&&(this.FSize=t,this.UpdateTabs())},this.SetDisabledFill=function(t){this.FDisabledFill.Assign(t)},this.SetDisabledStroke=function(t){this.FDisabledStroke.Assign(t)},this.SetDownFill=function(t){this.FDownFill.Assign(t)},this.SetDownStroke=function(t){this.FDownStroke.Assign(t)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetHoverFill=function(t){this.FHoverFill.Assign(t)},this.SetHoverStroke=function(t){this.FHoverStroke.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.SetCloseIcon=function(t){this.FCloseIcon.Assign(t)},this.SetInsertIcon=function(t){this.FInsertIcon.Assign(t)},this.SetScrollNextIcon=function(t){this.FScrollNextIcon.Assign(t)},this.SetScrollPreviousIcon=function(t){this.FScrollPreviousIcon.Assign(t)},this.SetTabListIcon=function(t){this.FTabListIcon.Assign(t)},this.IsRoundingStored=function(){return 5!==this.FRounding},this.SetRounding=function(t){this.FRounding=t},this.UpdateTabs=function(){null!=this.FTabSet&&this.FTabSet.UpdateTabs(!1,!1)},this.FillChanged=function(t){this.UpdateTabs()},this.StrokeChanged=function(t){this.UpdateTabs()},this.BitmapChanged=function(t){null!=this.FTabSet&&null!=this.FTabSet.FInsertTab&&(this.FTabSet.FInsertTab.FBitmaps.Clear(),this.FTabSet.FInsertTab.FBitmaps.AddBitmap(this.FInsertIcon,1),this.FTabSet.FInsertTab.FDisabledBitmaps.Clear(),this.FTabSet.FInsertTab.FDisabledBitmaps.AddBitmap(this.FInsertIcon,1)),this.UpdateTabs()},this.Create$1=function(e){return this.FTabSet=e,this.FSize=20,this.FRounding=5,this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16316397,8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,15655897,8421504,-1,-1]),this.FDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FHoverFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16313827,8421504,-1,-1]),this.FHoverFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FDisabledFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,13882323,8421504,-1,-1]),this.FDisabledFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FHoverStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FHoverStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FDisabledStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FDisabledStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FTabListIcon=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TMSFNCTABSETLISTSVG,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FTabListIcon.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FCloseIcon=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TMSFNCTABSETCLOSESVG,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FCloseIcon.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FInsertIcon=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TMSFNCTABSETADDSVG,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FInsertIcon.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FScrollNextIcon=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TMSFNCTABSETNEXTSVG,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FScrollNextIcon.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.FScrollPreviousIcon=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource$1(t.TMSFNCTABSETPREVIOUSSVG,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FScrollPreviousIcon.FOnChange=rtl.createCallback(this,"BitmapChanged"),this},this.Assign=function(e){t.TTMSFNCTabSetButtonAppearance.isPrototypeOf(e)&&(this.FSize=rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FSize,this.FRounding=rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FRounding,this.FFill.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FFill),this.FDownFill.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FDownFill),this.FHoverFill.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FHoverFill),this.FDisabledFill.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FDisabledFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FStroke),this.FDownStroke.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FDownStroke),this.FHoverStroke.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FHoverStroke),this.FDisabledStroke.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FDisabledStroke),this.FTabListIcon.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FTabListIcon),this.FCloseIcon.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FCloseIcon),this.FInsertIcon.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FInsertIcon),this.FScrollNextIcon.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FScrollNextIcon),this.FScrollPreviousIcon.Assign(rtl.as(e,t.TTMSFNCTabSetButtonAppearance).FScrollPreviousIcon))},this.Destroy=function(){rtl.free(this,"FTabListIcon"),rtl.free(this,"FCloseIcon"),rtl.free(this,"FInsertIcon"),rtl.free(this,"FScrollPreviousIcon"),rtl.free(this,"FScrollNextIcon"),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FHoverFill"),rtl.free(this,"FHoverStroke"),rtl.free(this,"FDownFill"),rtl.free(this,"FDownStroke"),rtl.free(this,"FDisabledFill"),rtl.free(this,"FDisabledStroke"),pas.System.TObject.Destroy.call(this)};var e=this.$rtti;e.addProperty("Rounding",14,rtl.double,"FRounding","SetRounding",{stored:"IsRoundingStored"}),e.addProperty("Size",14,rtl.double,"FSize","SetSize",{stored:"IsSizedStored"}),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("DownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDownFill","SetDownFill"),e.addProperty("DownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDownStroke","SetDownStroke"),e.addProperty("DisabledFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDisabledFill","SetDisabledFill"),e.addProperty("DisabledStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDisabledStroke","SetDisabledStroke"),e.addProperty("HoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FHoverFill","SetHoverFill"),e.addProperty("HoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FHoverStroke","SetHoverStroke"),e.addProperty("CloseIcon",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FCloseIcon","SetCloseIcon"),e.addProperty("InsertIcon",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FInsertIcon","SetInsertIcon"),e.addProperty("TabListIcon",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FTabListIcon","SetTabListIcon"),e.addProperty("ScrollNextIcon",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FScrollNextIcon","SetScrollNextIcon"),e.addProperty("ScrollPreviousIcon",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FScrollPreviousIcon","SetScrollPreviousIcon")})),rtl.createClass(this,"TTMSFNCTabSetTabAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTabSet=null,this.FHoverStroke=null,this.FDownFill=null,this.FDownStroke=null,this.FDisabledFill=null,this.FFont=null,this.FActiveFill=null,this.FDisabledStroke=null,this.FActiveStroke=null,this.FFill=null,this.FHoverFill=null,this.FStroke=null,this.FWordWrapping=!1,this.FTrimming=0,this.FTextAlign=0,this.FShape=0,this.FShapeOverlap=0,this.FShapeSlope=0,this.FTextColor=0,this.FHoverTextColor=0,this.FDownTextColor=0,this.FDisabledTextColor=0,this.FActiveTextColor=0,this.FShowFocus=!1,this.FFocusBorderColor=0,this.FProgressFill=null,this.FShapeRounding=0,this.FProgressStroke=null,this.FCloseSize=0,this.FProgressCircularSize=0,this.FCloseHoverStroke=null,this.FCloseDownFill=null,this.FCloseDownStroke=null,this.FCloseFill=null,this.FCloseHoverFill=null,this.FCloseStroke=null,this.FInsertSize=0,this.FBadgeFont=null,this.FBadgeFill=null,this.FBadgeStroke=null,this.FTextSpacing=0},this.$final=function(){this.FTabSet=void 0,this.FHoverStroke=void 0,this.FDownFill=void 0,this.FDownStroke=void 0,this.FDisabledFill=void 0,this.FFont=void 0,this.FActiveFill=void 0,this.FDisabledStroke=void 0,this.FActiveStroke=void 0,this.FFill=void 0,this.FHoverFill=void 0,this.FStroke=void 0,this.FProgressFill=void 0,this.FProgressStroke=void 0,this.FCloseHoverStroke=void 0,this.FCloseDownFill=void 0,this.FCloseDownStroke=void 0,this.FCloseFill=void 0,this.FCloseHoverFill=void 0,this.FCloseStroke=void 0,this.FBadgeFont=void 0,this.FBadgeFill=void 0,this.FBadgeStroke=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetDisabledFill=function(t){this.FDisabledFill.Assign(t)},this.SetDisabledStroke=function(t){this.FDisabledStroke.Assign(t)},this.SetDownFill=function(t){this.FDownFill.Assign(t)},this.SetDownStroke=function(t){this.FDownStroke.Assign(t)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetFont=function(t){this.FFont.Assign(t)},this.SetHoverFill=function(t){this.FHoverFill.Assign(t)},this.SetHoverStroke=function(t){this.FHoverStroke.Assign(t)},this.SetActiveFill=function(t){this.FActiveFill.Assign(t)},this.SetActiveStroke=function(t){this.FActiveStroke.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.SetTextAlign=function(t){this.FTextAlign!==t&&(this.FTextAlign=t,this.UpdateTabs())},this.SetTrimming=function(t){this.FTrimming!==t&&(this.FTrimming=t,this.UpdateTabs())},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,this.UpdateTabs())},this.SetShape=function(t){this.FShape!==t&&(this.FShape=t,this.UpdateTabs())},this.SetShapeOverlap=function(t){this.FShapeOverlap!==t&&(this.FShapeOverlap=t,this.UpdateTabs())},this.IsShapeOverlapStored=function(){return 12!==this.FShapeOverlap},this.IsShapeSlopeStored=function(){return 11!==this.FShapeSlope},this.SetShapeSlope=function(t){this.FShapeSlope!==t&&(this.FShapeSlope=t,this.UpdateTabs())},this.SetActiveTextColor=function(t){this.FActiveTextColor!==t&&(this.FActiveTextColor=t,this.UpdateTabs())},this.SetDisabledTextColor=function(t){this.FDisabledTextColor!==t&&(this.FDisabledTextColor=t,this.UpdateTabs())},this.SetDownTextColor=function(t){this.FDownTextColor!==t&&(this.FDownTextColor=t,this.UpdateTabs())},this.SetHoverTextColor=function(t){this.FHoverTextColor!==t&&(this.FHoverTextColor=t,this.UpdateTabs())},this.SetTextColor=function(t){this.FTextColor!==t&&(this.FTextColor=t,this.UpdateTabs())},this.SetFocusBorderColor=function(t){this.FFocusBorderColor!==t&&(this.FFocusBorderColor=t,this.UpdateTabs())},this.SetShowFocus=function(t){this.FShowFocus!==t&&(this.FShowFocus=t,this.UpdateTabs())},this.SetProgressFill=function(t){this.FProgressFill.Assign(t)},this.IsShapeRoundingStored=function(){return 5!==this.FShapeRounding},this.SetShapeRounding=function(t){this.FShapeRounding!==t&&(this.FShapeRounding=t,this.UpdateTabs())},this.SetProgressStroke=function(t){this.FProgressStroke.Assign(t)},this.IsCloseSizeStored=function(){return 14!==this.FCloseSize},this.SetCloseSize=function(t){this.FCloseSize!==t&&(this.FCloseSize=t,this.UpdateTabs())},this.IsProgressCircularSizeStored=function(){return 15!==this.FProgressCircularSize},this.SetProgressCircularSize=function(t){this.FProgressCircularSize!==t&&(this.FProgressCircularSize=t,this.UpdateTabs())},this.SetCloseDownFill=function(t){this.FCloseDownFill.Assign(t)},this.SetCloseDownStroke=function(t){this.FCloseDownStroke.Assign(t)},this.SetCloseFill=function(t){this.FCloseFill.Assign(t)},this.SetCloseHoverFill=function(t){this.FCloseHoverFill.Assign(t)},this.SetCloseHoverStroke=function(t){this.FCloseHoverStroke.Assign(t)},this.SetCloseStroke=function(t){this.FCloseStroke.Assign(t)},this.IsInsertSizeStored=function(){return 20!==this.FInsertSize},this.SetInsertSize=function(t){this.FInsertSize!==t&&(this.FInsertSize=t,this.UpdateTabs())},this.SetBadgeFill=function(t){this.FBadgeFill.Assign(t)},this.SetBadgeFont=function(t){this.FBadgeFont.Assign(t)},this.SetBadgeStroke=function(t){this.FBadgeStroke.Assign(t)},this.SetTextSpacing=function(t){this.FTextSpacing!==t&&(this.FTextSpacing=t,this.UpdateTabs())},this.UpdateTabs=function(){null!=this.FTabSet&&this.FTabSet.UpdateTabs(!1,!1)},this.FillChanged=function(t){this.UpdateTabs()},this.StrokeChanged=function(t){this.UpdateTabs()},this.FontChanged=function(t){this.UpdateTabs()},this.Create$1=function(t){return this.FTabSet=t,this.FWordWrapping=!1,this.FTrimming=1,this.FShapeOverlap=12,this.FTextAlign=0,this.FShapeSlope=11,this.FTextSpacing=0,this.FProgressCircularSize=15,this.FCloseSize=14,this.FInsertSize=20,this.FShapeRounding=5,this.FTextColor=0,this.FBadgeFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,42495,8421504,-1,-1]),this.FBadgeFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FBadgeStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,139]),this.FBadgeStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FBadgeFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),null!=this.FTabSet&&this.FTabSet.IsDesignTime()&&(this.FBadgeFont.SetColor(139),this.FBadgeFont.SetStyle(rtl.createSet(0))),this.FBadgeFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FActiveTextColor=0,this.FDisabledTextColor=0,this.FDownTextColor=0,this.FShowFocus=!0,this.FFocusBorderColor=0,this.FHoverTextColor=0,this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FProgressFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16297243,8421504,-1,-1]),this.FProgressFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FProgressStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,16297243]),this.FProgressStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16316397,8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,15655897,8421504,-1,-1]),this.FDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FActiveFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FActiveFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FHoverFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16313827,8421504,-1,-1]),this.FHoverFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FDisabledFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,13882323,8421504,-1,-1]),this.FDisabledFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FActiveStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FActiveStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FHoverStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FHoverStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FDisabledStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FDisabledStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FCloseFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[0,16316397,8421504,-1,-1]),this.FCloseFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FCloseStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FCloseStroke.SetWidth(2),this.FCloseStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FCloseHoverFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,255,8421504,-1,-1]),this.FCloseHoverFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FCloseHoverStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,16777215]),this.FCloseHoverStroke.SetWidth(2),this.FCloseHoverStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FCloseDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,3937500,8421504,-1,-1]),this.FCloseDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FCloseDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,16777215]),this.FCloseDownStroke.SetWidth(2),this.FCloseDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FShape=3,this},this.Assign=function(e){t.TTMSFNCTabSetTabAppearance.isPrototypeOf(e)&&(this.FWordWrapping=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FWordWrapping,this.FTrimming=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FTrimming,this.FShapeOverlap=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FShapeOverlap,this.FTextAlign=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FTextAlign,this.FShapeSlope=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FShapeSlope,this.FTextSpacing=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FTextSpacing,this.FShapeRounding=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FShapeRounding,this.FFont.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FFont),this.FTextColor=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FTextColor,this.FActiveTextColor=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FActiveTextColor,this.FDisabledTextColor=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FDisabledTextColor,this.FDownTextColor=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FDownTextColor,this.FHoverTextColor=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FHoverTextColor,this.FFill.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FFill),this.FProgressFill.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FProgressFill),this.FProgressStroke.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FProgressStroke),this.FDownFill.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FDownFill),this.FActiveFill.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FActiveFill),this.FHoverFill.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FHoverFill),this.FDisabledFill.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FDisabledFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FStroke),this.FDownStroke.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FDownStroke),this.FActiveStroke.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FActiveStroke),this.FHoverStroke.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FHoverStroke),this.FDisabledStroke.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FDisabledStroke),this.FShape=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FShape,this.FShowFocus=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FShowFocus,this.FFocusBorderColor=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FFocusBorderColor,this.FCloseSize=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FCloseSize,this.FInsertSize=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FInsertSize,this.FProgressCircularSize=rtl.as(e,t.TTMSFNCTabSetTabAppearance).FProgressCircularSize,this.FCloseFill.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FCloseFill),this.FCloseStroke.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FCloseStroke),this.FCloseHoverFill.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FCloseHoverFill),this.FCloseHoverStroke.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FCloseHoverStroke),this.FCloseDownFill.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FCloseDownFill),this.FCloseDownStroke.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FCloseDownStroke),this.FBadgeFont.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FBadgeFont),this.FBadgeFill.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FBadgeFill),this.FBadgeStroke.Assign(rtl.as(e,t.TTMSFNCTabSetTabAppearance).FBadgeStroke))},this.Destroy=function(){rtl.free(this,"FBadgeFont"),rtl.free(this,"FBadgeFill"),rtl.free(this,"FBadgeStroke"),rtl.free(this,"FFont"),rtl.free(this,"FFill"),rtl.free(this,"FProgressFill"),rtl.free(this,"FProgressStroke"),rtl.free(this,"FDownFill"),rtl.free(this,"FHoverFill"),rtl.free(this,"FDisabledFill"),rtl.free(this,"FActiveFill"),rtl.free(this,"FStroke"),rtl.free(this,"FDownStroke"),rtl.free(this,"FHoverStroke"),rtl.free(this,"FDisabledStroke"),rtl.free(this,"FActiveStroke"),rtl.free(this,"FCloseHoverStroke"),rtl.free(this,"FCloseHoverFill"),rtl.free(this,"FCloseFill"),rtl.free(this,"FCloseStroke"),rtl.free(this,"FCloseDownFill"),rtl.free(this,"FCloseDownStroke"),pas.System.TObject.Destroy.call(this)};var e=this.$rtti;e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("ProgressFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FProgressFill","SetProgressFill"),e.addProperty("ProgressStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FProgressStroke","SetProgressStroke"),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("ActiveFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FActiveFill","SetActiveFill"),e.addProperty("ActiveStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FActiveStroke","SetActiveStroke"),e.addProperty("DisabledFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDisabledFill","SetDisabledFill"),e.addProperty("DisabledStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDisabledStroke","SetDisabledStroke"),e.addProperty("DownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDownFill","SetDownFill"),e.addProperty("DownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDownStroke","SetDownStroke"),e.addProperty("HoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FHoverFill","SetHoverFill"),e.addProperty("HoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FHoverStroke","SetHoverStroke"),e.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!1}),e.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttCharacter}),e.addProperty("TextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FTextAlign","SetTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("TextSpacing",2,rtl.double,"FTextSpacing","SetTextSpacing"),e.addProperty("Shape",2,t.$rtti.TTMSFNCTabSetTabShape,"FShape","SetShape",{Default:t.TTMSFNCTabSetTabShape.tsPyramid}),e.addProperty("ShapeOverlap",14,rtl.double,"FShapeOverlap","SetShapeOverlap",{stored:"IsShapeOverlapStored"}),e.addProperty("ShapeSlope",14,rtl.double,"FShapeSlope","SetShapeSlope",{stored:"IsShapeSlopeStored"}),e.addProperty("ShapeRounding",14,rtl.double,"FShapeRounding","SetShapeRounding",{stored:"IsShapeRoundingStored"}),e.addProperty("TextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FTextColor","SetTextColor",{Default:0}),e.addProperty("ActiveTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FActiveTextColor","SetActiveTextColor",{Default:0}),e.addProperty("HoverTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FHoverTextColor","SetHoverTextColor",{Default:0}),e.addProperty("DownTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDownTextColor","SetDownTextColor",{Default:0}),e.addProperty("DisabledTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDisabledTextColor","SetDisabledTextColor",{Default:0}),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default:!0}),e.addProperty("FocusBorderColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FFocusBorderColor","SetFocusBorderColor",{Default:0}),e.addProperty("ProgressCircularSize",14,rtl.double,"FProgressCircularSize","SetProgressCircularSize",{stored:"IsProgressCircularSizeStored"}),e.addProperty("InsertSize",14,rtl.double,"FInsertSize","SetInsertSize",{stored:"IsInsertSizeStored"}),e.addProperty("CloseSize",14,rtl.double,"FCloseSize","SetCloseSize",{stored:"IsCloseSizeStored"}),e.addProperty("CloseFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FCloseFill","SetCloseFill"),e.addProperty("CloseStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FCloseStroke","SetCloseStroke"),e.addProperty("CloseDownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FCloseDownFill","SetCloseDownFill"),e.addProperty("CloseDownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FCloseDownStroke","SetCloseDownStroke"),e.addProperty("CloseHoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FCloseHoverFill","SetCloseHoverFill"),e.addProperty("CloseHoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FCloseHoverStroke","SetCloseHoverStroke"),e.addProperty("BadgeFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FBadgeFill","SetBadgeFill"),e.addProperty("BadgeStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FBadgeStroke","SetBadgeStroke"),e.addProperty("BadgeFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FBadgeFont","SetBadgeFont")})),rtl.createClass(this,"TTMSFNCTabSetLayout",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTabSet=null,this.FMultiline=0,this.FPosition=0,this.FOnChange=null},this.$final=function(){this.FTabSet=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetMultiline=function(t){this.FMultiline!==t&&(this.FMultiline=t,this.UpdateTabs())},this.SetPosition=function(t){if(this.FPosition!==t){if(this.FPosition=t,null!=this.FTabSet&&null!=this.FTabSet.FTabList){var e=this.FPosition;0===e?this.FTabSet.FTabListPopup.SetPlacement(3):1===e?this.FTabSet.FTabListPopup.SetPlacement(0):2===e?this.FTabSet.FTabListPopup.SetPlacement(1):3===e&&this.FTabSet.FTabListPopup.SetPlacement(2)}this.UpdateTabs()}},this.UpdateTabs=function(){null!=this.FOnChange&&this.FOnChange(this),null!=this.FTabSet&&this.FTabSet.UpdateTabs(!1,!1)},this.Assign=function(e){t.TTMSFNCTabSetLayout.isPrototypeOf(e)&&(this.FMultiline=rtl.as(e,t.TTMSFNCTabSetLayout).FMultiline,this.FPosition=rtl.as(e,t.TTMSFNCTabSetLayout).FPosition)},this.Create$1=function(t){return this.FTabSet=t,this.FMultiline=0,this.FPosition=1,this};var e=this.$rtti;e.addProperty("Position",2,t.$rtti.TTMSFNCTabSetLayoutPosition,"FPosition","SetPosition",{Default:t.TTMSFNCTabSetLayoutPosition.tlpTop}),e.addProperty("Multiline",2,t.$rtti.TTMSFNCTabSetLayoutMultiline,"FMultiline","SetMultiline",{Default:t.TTMSFNCTabSetLayoutMultiline.tlmNone})})),rtl.createClass(this,"TTMSFNCTabSetInteraction",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTabSet=null,this.FSelectTabOnFocus=!1,this.FEditing=!1,this.FSelectTabOnInsert=!1,this.FSelectTabOnScroll=!1,this.FInsertTabWithKeyboard=!1,this.FCloseTabWithKeyboard=!1,this.FAutoOpenURL=!1,this.FReorder=!1},this.$final=function(){this.FTabSet=void 0,pas.Classes.TPersistent.$final.call(this)},this.Assign=function(e){t.TTMSFNCTabSetInteraction.isPrototypeOf(e)&&(this.FSelectTabOnFocus=rtl.as(e,t.TTMSFNCTabSetInteraction).FSelectTabOnFocus,this.FSelectTabOnInsert=rtl.as(e,t.TTMSFNCTabSetInteraction).FSelectTabOnInsert,this.FSelectTabOnScroll=rtl.as(e,t.TTMSFNCTabSetInteraction).FSelectTabOnScroll,this.FEditing=rtl.as(e,t.TTMSFNCTabSetInteraction).FEditing,this.FCloseTabWithKeyboard=rtl.as(e,t.TTMSFNCTabSetInteraction).FCloseTabWithKeyboard,this.FInsertTabWithKeyboard=rtl.as(e,t.TTMSFNCTabSetInteraction).FInsertTabWithKeyboard,this.FAutoOpenURL=rtl.as(e,t.TTMSFNCTabSetInteraction).FAutoOpenURL,this.FReorder=rtl.as(e,t.TTMSFNCTabSetInteraction).FReorder)},this.Create$1=function(t){return this.FTabSet=t,this.FSelectTabOnFocus=!0,this.FSelectTabOnInsert=!0,this.FSelectTabOnScroll=!0,this.FEditing=!1,this.FInsertTabWithKeyboard=!0,this.FCloseTabWithKeyboard=!0,this.FAutoOpenURL=!0,this.FReorder=!1,this};var e=this.$rtti;e.addProperty("SelectTabOnFocus",0,rtl.boolean,"FSelectTabOnFocus","FSelectTabOnFocus",{Default:!0}),e.addProperty("SelectTabOnInsert",0,rtl.boolean,"FSelectTabOnInsert","FSelectTabOnInsert",{Default:!0}),e.addProperty("SelectTabOnScroll",0,rtl.boolean,"FSelectTabOnScroll","FSelectTabOnScroll",{Default:!0}),e.addProperty("Editing",0,rtl.boolean,"FEditing","FEditing",{Default:!1}),e.addProperty("CloseTabWithKeyboard",0,rtl.boolean,"FCloseTabWithKeyboard","FCloseTabWithKeyboard",{Default:!0}),e.addProperty("InsertTabWithKeyboard",0,rtl.boolean,"FInsertTabWithKeyboard","FInsertTabWithKeyboard",{Default:!0}),e.addProperty("AutoOpenURL",0,rtl.boolean,"FAutoOpenURL","FAutoOpenURL",{Default:!0}),e.addProperty("Reorder",0,rtl.boolean,"FReorder","FReorder",{Default:!1})})),rtl.createClass(this,"TTMSFNCTabSetOptions",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTabSet=null,this.FCloseMode=0,this.FInsertMode=0,this.FTabListButton=!1,this.FCloseAction=0},this.$final=function(){this.FTabSet=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetCloseMode=function(t){this.FCloseMode!==t&&(this.FCloseMode=t,this.UpdateTabs())},this.SetInsertMode=function(t){this.FInsertMode!==t&&(this.FInsertMode=t,this.UpdateTabs())},this.SetTabListButton=function(t){this.FTabListButton!==t&&(this.FTabListButton=t,this.UpdateTabs())},this.UpdateTabs=function(){null!=this.FTabSet&&this.FTabSet.UpdateTabs(!1,!1)},this.Assign=function(e){t.TTMSFNCTabSetOptions.isPrototypeOf(e)&&(this.FCloseMode=rtl.as(e,t.TTMSFNCTabSetOptions).FCloseMode,this.FInsertMode=rtl.as(e,t.TTMSFNCTabSetOptions).FInsertMode,this.FTabListButton=rtl.as(e,t.TTMSFNCTabSetOptions).FTabListButton,this.FCloseAction=rtl.as(e,t.TTMSFNCTabSetOptions).FCloseAction)},this.Create$1=function(t){return this.FTabSet=t,this.FCloseMode=0,this.FInsertMode=0,this.FTabListButton=!1,this.FCloseAction=2,this};var e=this.$rtti;e.addProperty("CloseMode",2,t.$rtti.TTMSFNCTabSetCloseMode,"FCloseMode","SetCloseMode",{Default:t.TTMSFNCTabSetCloseMode.tcmNone}),e.addProperty("CloseAction",0,t.$rtti.TTMSFNCTabSetTabCloseAction,"FCloseAction","FCloseAction",{Default:t.TTMSFNCTabSetTabCloseAction.ttcaHide}),e.addProperty("InsertMode",2,t.$rtti.TTMSFNCTabSetInsertMode,"FInsertMode","SetInsertMode",{Default:t.TTMSFNCTabSetInsertMode.timNone}),e.addProperty("TabListButton",2,rtl.boolean,"FTabListButton","SetTabListButton",{Default:!1})})),this.TTMSFNCTabSetButtonState={0:"tbsNormal",tbsNormal:0,1:"tbsHover",tbsHover:1,2:"tbsDown",tbsDown:2,3:"tbsDisabled",tbsDisabled:3},this.$rtti.$Enum("TTMSFNCTabSetButtonState",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCTabSetButtonState}),this.TTMSFNCTabSetTabState={0:"ttsNormal",ttsNormal:0,1:"ttsHover",ttsHover:1,2:"ttsDown",ttsDown:2,3:"ttsActive",ttsActive:3,4:"ttsDisabled",ttsDisabled:4},this.$rtti.$Enum("TTMSFNCTabSetTabState",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TTMSFNCTabSetTabState}),this.TTMSFNCTabSetMenuButton={0:"tmbClose",tmbClose:0,1:"tmbInsert",tmbInsert:1,2:"tmbTabList",tmbTabList:2,3:"tmbScrollPrevious",tmbScrollPrevious:3,4:"tmbScrollNext",tmbScrollNext:4},this.$rtti.$Enum("TTMSFNCTabSetMenuButton",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TTMSFNCTabSetMenuButton}),this.$rtti.$ClassRef("TTMSFNCTabSetInplaceEditorClass",{instancetype:pas["WEBLib.Controls"].$rtti.TWinControl}),this.$rtti.$MethodVar("TTMSFNCTabSetCustomizeInplaceEditorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATabIndex",rtl.longint],["AInplaceEditor",pas["WEBLib.Controls"].$rtti.TWinControl]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetGetInplaceEditorRectEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATabIndex",rtl.longint],["AInplaceEditor",pas["WEBLib.Controls"].$rtti.TWinControl],["AInplaceEditorRect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetGetInplaceEditorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATabIndex",rtl.longint],["AInplaceEditorClass",this.$rtti.TTMSFNCTabSetInplaceEditorClass,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetBeforeOpenInplaceEditorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATabIndex",rtl.longint],["ACanOpen",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetOpenInplaceEditorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATabIndex",rtl.longint],["AInplaceEditor",pas["WEBLib.Controls"].$rtti.TWinControl],["AInplaceEditorRect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetCloseInplaceEditorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATabIndex",rtl.longint],["AInplaceEditor",pas["WEBLib.Controls"].$rtti.TWinControl],["ACancelled",rtl.boolean],["ACanClose",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetBeforeUpdateTabEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATabIndex",rtl.longint],["AText",rtl.string,1],["ACanUpdate",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetUpdateTabEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATabIndex",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetAnchorTabClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ATabIndex",rtl.longint],["AAnchor",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetBeforeDrawTabBackgroundEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AState",this.$rtti.TTMSFNCTabSetTabState],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetBeforeDrawTabProgressEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AProgressMode",this.$rtti.TTMSFNCTabSetTabProgressMode],["AProgressKind",this.$rtti.TTMSFNCTabSetTabProgressKind],["AAnimationStartAngle",rtl.double],["AAnimationSweepAngle",rtl.double],["AProgress",rtl.double],["AProgressMax",rtl.double],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetBeforeDrawTabBadgeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetBeforeDrawTabTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetBeforeDrawTabCloseButtonEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AState",this.$rtti.TTMSFNCTabSetButtonState],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetBeforeDrawTabBitmapEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetAfterDrawTabBackgroundEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AState",this.$rtti.TTMSFNCTabSetTabState]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetAfterDrawTabProgressEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AProgressMode",this.$rtti.TTMSFNCTabSetTabProgressMode],["AProgressKind",this.$rtti.TTMSFNCTabSetTabProgressKind],["AAnimationStartAngle",rtl.double],["AAnimationSweepAngle",rtl.double],["AProgress",rtl.double],["AProgressMax",rtl.double]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetAfterDrawTabBadgeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetAfterDrawTabTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetAfterDrawTabCloseButtonEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AState",this.$rtti.TTMSFNCTabSetButtonState]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetAfterDrawTabBitmapEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ATabIndex",rtl.longint],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetBeforeDrawMenuButton",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AButton",this.$rtti.TTMSFNCTabSetMenuButton],["AState",this.$rtti.TTMSFNCTabSetButtonState],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTabSetAfterDrawMenuButton",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AButton",this.$rtti.TTMSFNCTabSetMenuButton],["AState",this.$rtti.TTMSFNCTabSetButtonState]]),methodkind:0}),rtl.createClass(this,"TTMSFNCTabSetEdit",pas["WEBLib.StdCtrls"].TEdit,(function(){this.$init=function(){pas["WEBLib.StdCtrls"].TEdit.$init.call(this),this.FTabSet=null},this.$final=function(){this.FTabSet=void 0,pas["WEBLib.StdCtrls"].TEdit.$final.call(this)},this.KeyDown=function(t,e){if(pas["WEBLib.Controls"].TControl.KeyDown.apply(this,arguments),null!=this.FTabSet&&this.FTabSet.FInplaceEditorActive){var i=t.get();27===i?(this.FTabSet.CloseInplaceEditor(!0),this.FTabSet.FInplaceEditorClosed=!0,t.set(0)):113!==i&&13!==i||(this.FTabSet.CloseInplaceEditor(!1),this.FTabSet.FInplaceEditorClosed=!0,t.set(0))}},this.DoExit=function(){pas["WEBLib.Controls"].TControl.DoExit.call(this),null!=this.FTabSet&&this.FTabSet.FInplaceEditorActive&&this.FTabSet.CloseInplaceEditor(!1)},this.Create$1=function(e){return pas["WEBLib.Controls"].TControl.Create$1.apply(this,arguments),t.TTMSFNCCustomTabSet.isPrototypeOf(e)&&(this.FTabSet=rtl.as(e,t.TTMSFNCCustomTabSet)),this},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCCustomTabSet",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FTotalTabHeight=0,this.FDownX=0,this.FDownY=0,this.FDragDownX=0,this.FDragDownY=0,this.FClosing=!1,this.FTabAnchor="",this.FDblClicked=!1,this.FInplaceEditorClosed=!1,this.FCloseWithDialogKey=!1,this.FUpdateTab=t.TTMSFNCTabSetDisplayTab.$new(),this.FInplaceEditorClass=null,this.FInplaceEditor=null,this.FInplaceEditorActive=!1,this.FMenuSize=0,this.FInvisibleTabList=null,this.FTabListPopup=null,this.FTabList=null,this.FFirstTabIndex=0,this.FLastTabIndex=0,this.FTabListButtonState=0,this.FCloseButtonState=0,this.FInsertButtonState=0,this.FScrollButtonPreviousState=0,this.FScrollButtonNextState=0,this.FPrevTabListButtonState=0,this.FPrevCloseButtonState=0,this.FPrevInsertButtonState=0,this.FPrevScrollButtonPreviousState=0,this.FPrevScrollButtonNextState=0,this.FScrollButtonNextDisabled=!1,this.FScrollButtonPreviousDisabled=!1,this.FShowMenu=!1,this.FShowScrollButtons=!1,this.FAllowScrolling=!1,this.FShowCloseButton=!1,this.FShowTabListButton=!1,this.FShowInsertButton=!1,this.FInsertTab=null,this.FDragTab=null,this.FActiveTabIndex=0,this.FDownCount=0,this.FAnimTimer=null,this.FDownTimer=null,this.FActiveTab=null,this.FFocusedTab=null,this.FPrevTab=null,this.FDownTab=null,this.FPrevHoverTab=null,this.FHoverTab=null,this.FTabChanging=!1,this.FDownCloseTab=null,this.FHoverCloseTab=null,this.FPrevHoverCloseTab=null,this.FDragTabDisplay=t.TTMSFNCTabSetDisplayTab.$new(),this.FOrigRect$1=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),this.FStartTab=0,this.FScrollCount=0,this.FUpdateCount$1=0,this.FDisplayList=null,this.FBitmapContainer=null,this.FTabs=null,this.FTabSize=null,this.FLayout=null,this.FTabAppearance=null,this.FInteraction=null,this.FOnChangeTab=null,this.FOnCloseTab=null,this.FOnBeforeChangeTab=null,this.FOnBeforeCloseTab=null,this.FOptions=null,this.FOnInsertTab=null,this.FOnBeforeInsertTab=null,this.FButtonAppearance=null,this.FOnGetInplaceEditorRect=null,this.FOnCustomizeInplaceEditor=null,this.FOnOpenInplaceEditor=null,this.FOnGetInplaceEditor=null,this.FOnCloseInplaceEditor=null,this.FOnBeforeOpenInplaceEditor=null,this.FOnUpdateTab=null,this.FOnBeforeUpdateTab=null,this.FOnAnchorTabClick=null,this.FOnReorderTab=null,this.FOnBeforeReorderTab=null,this.FOnBeforeDrawTabBadge=null,this.FOnBeforeDrawTabText=null,this.FOnAfterDrawTabBackground=null,this.FOnAfterDrawTabBitmap=null,this.FOnBeforeDrawTabCloseButton=null,this.FOnAfterDrawTabProgress=null,this.FOnAfterDrawTabBadge=null,this.FOnAfterDrawTabText=null,this.FOnAfterDrawTabCloseButton=null,this.FOnBeforeDrawTabBackground=null,this.FOnBeforeDrawTabBitmap=null,this.FOnBeforeDrawTabProgress=null,this.FOnAfterDrawMenuButton=null,this.FOnBeforeDrawMenuButton=null,this.FGlobalFont=null},this.$final=function(){this.FUpdateTab=void 0,this.FInplaceEditorClass=void 0,this.FInplaceEditor=void 0,this.FInvisibleTabList=void 0,this.FTabListPopup=void 0,this.FTabList=void 0,this.FInsertTab=void 0,this.FDragTab=void 0,this.FAnimTimer=void 0,this.FDownTimer=void 0,this.FActiveTab=void 0,this.FFocusedTab=void 0,this.FPrevTab=void 0,this.FDownTab=void 0,this.FPrevHoverTab=void 0,this.FHoverTab=void 0,this.FDownCloseTab=void 0,this.FHoverCloseTab=void 0,this.FPrevHoverCloseTab=void 0,this.FDragTabDisplay=void 0,this.FOrigRect$1=void 0,this.FDisplayList=void 0,this.FBitmapContainer=void 0,this.FTabs=void 0,this.FTabSize=void 0,this.FLayout=void 0,this.FTabAppearance=void 0,this.FInteraction=void 0,this.FOnChangeTab=void 0,this.FOnCloseTab=void 0,this.FOnBeforeChangeTab=void 0,this.FOnBeforeCloseTab=void 0,this.FOptions=void 0,this.FOnInsertTab=void 0,this.FOnBeforeInsertTab=void 0,this.FButtonAppearance=void 0,this.FOnGetInplaceEditorRect=void 0,this.FOnCustomizeInplaceEditor=void 0,this.FOnOpenInplaceEditor=void 0,this.FOnGetInplaceEditor=void 0,this.FOnCloseInplaceEditor=void 0,this.FOnBeforeOpenInplaceEditor=void 0,this.FOnUpdateTab=void 0,this.FOnBeforeUpdateTab=void 0,this.FOnAnchorTabClick=void 0,this.FOnReorderTab=void 0,this.FOnBeforeReorderTab=void 0,this.FOnBeforeDrawTabBadge=void 0,this.FOnBeforeDrawTabText=void 0,this.FOnAfterDrawTabBackground=void 0,this.FOnAfterDrawTabBitmap=void 0,this.FOnBeforeDrawTabCloseButton=void 0,this.FOnAfterDrawTabProgress=void 0,this.FOnAfterDrawTabBadge=void 0,this.FOnAfterDrawTabText=void 0,this.FOnAfterDrawTabCloseButton=void 0,this.FOnBeforeDrawTabBackground=void 0,this.FOnBeforeDrawTabBitmap=void 0,this.FOnBeforeDrawTabProgress=void 0,this.FOnAfterDrawMenuButton=void 0,this.FOnBeforeDrawMenuButton=void 0,this.FGlobalFont=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetTabSize=function(t){this.FTabSize.Assign(t)},this.SetLayout=function(t){this.FLayout!==t&&(this.FLayout=t,this.UpdateTabs(!1,!1))},this.SetTabAppearance=function(t){this.FTabAppearance.Assign(t)},this.GetActiveTab=function(){var t=null;return t=null,this.FActiveTabIndex>=0&&this.FActiveTabIndex<=this.FTabs.GetCount()-1&&(t=this.FTabs.GetTab(this.FActiveTabIndex)),t},this.GetActiveTabIndex=function(){var t=0;return t=this.FActiveTabIndex,null!=this.FActiveTab&&(t=this.FActiveTab.GetIndex()),t},this.SetActiveTab=function(t){this.HandleChangeTab(t)},this.SetActiveTabIndex=function(t){this.FActiveTabIndex=Math.max(0,Math.min(t,this.FTabs.GetCount()-1)),this.FActiveTabIndex>=0&&this.FActiveTabIndex<=this.FTabs.GetCount()-1?this.SetActiveTab(this.FTabs.GetTab(this.FActiveTabIndex)):this.SetActiveTab(null)},this.SetInteraction=function(t){this.FInteraction.Assign(t)},this.SetOptions=function(t){this.FOptions.Assign(t)},this.SetButtonAppearance=function(t){this.FButtonAppearance.Assign(t)},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.CreateTabs=function(){return t.TTMSFNCTabSetTabs.$create("Create$3",[this])},this.GetTotalTabHeight=function(){return this.FTotalTabHeight},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,1,1)},this.GetTabSize=function(t){var e=0;if(e=0,t===this.GetTotalTabCount()-1&&1===this.FOptions.FInsertMode)e=this.FTabAppearance.FInsertSize;else if(t>=0&&t<=this.FTabs.GetCount()-1){var i=this.FTabSize.FMode;3===i?(e=this.FTabs.GetTab(t).GetAutoSize(),this.FTabAppearance.FShape in rtl.createSet(1,2,3)?e+=2*this.FTabAppearance.FShapeSlope:this.FTabAppearance.FShape in rtl.createSet(4,5,6)?e+=this.FTabAppearance.FShapeSlope:e+=2*this.FTabAppearance.FShapeOverlap,e+=this.FTabAppearance.FTextSpacing):1!==i&&2!==i||(e=this.FTabs.GetTab(t).FWidth>-1?this.FTabs.GetTab(t).FWidth:this.FTabSize.FWidth)}return e},this.GetTotalTabCount=function(){var t=0;return t=this.FTabs.GetCount(),1===this.FOptions.FInsertMode&&(t+=1),t},this.GetTabRect=function(){var t,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(this.GetLocalRect()),i.$assign(e),t=this.FMenuSize;var s=this.FLayout.FPosition;return 0===s?(e.Left=i.Left+this.FTabSize.FMargins.FLeft+1,e.Top=i.Top+this.FTabSize.FMargins.FTop,e.Right=i.Left+this.FTabSize.FMargins.FLeft+this.FTabSize.FHeight,this.FShowMenu?e.Bottom=i.Bottom-this.FTabSize.FMargins.FBottom-t:e.Bottom=i.Bottom-this.FTabSize.FMargins.FBottom):1===s?(e.Left=i.Left+this.FTabSize.FMargins.FLeft,e.Top=i.Top+this.FTabSize.FMargins.FTop+1,this.FShowMenu?e.Right=i.Right-this.FTabSize.FMargins.FRight-t:e.Right=i.Right-this.FTabSize.FMargins.FRight,e.Bottom=i.Top+this.FTabSize.FMargins.FTop+this.FTabSize.FHeight):2===s?(e.Left=i.Left+this.FTabSize.FMargins.FLeft,e.Top=i.Bottom-this.FTabSize.FMargins.FBottom-this.FTabSize.FHeight,this.FShowMenu?e.Right=i.Right-this.FTabSize.FMargins.FRight-t:e.Right=i.Right-this.FTabSize.FMargins.FRight,e.Bottom=i.Bottom-this.FTabSize.FMargins.FBottom-1):3===s&&(e.Left=i.Right-this.FTabSize.FMargins.FRight-this.FTabSize.FHeight,e.Top=i.Top+this.FTabSize.FMargins.FTop,e.Right=i.Right-this.FTabSize.FMargins.FRight-1,this.FShowMenu?e.Bottom=i.Bottom-this.FTabSize.FMargins.FBottom-t:e.Bottom=i.Bottom-this.FTabSize.FMargins.FBottom),e},this.GetMenuRect=function(){var t,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(this.GetTabRect()),i.$assign(e),t=this.FMenuSize;var s=this.FLayout.FPosition;return 1===s||2===s?(e.Left=i.Right,e.Top=i.Top,e.Right=i.Right+t,e.Bottom=i.Bottom):0!==s&&3!==s||(e.Left=i.Left,e.Top=i.Bottom,e.Right=i.Right,e.Bottom=i.Bottom+t),e},this.GetVisibleTabCount=function(){var t=0,e=0;t=0;for(var i=0,s=this.FTabs.GetCount()-1;i<=s;i++)e=i,this.IsTabVisible(e)&&(t+=1);return t},this.GetInvisibleTabCount=function(){var t=0,e=0;t=0;for(var i=0,s=this.FTabs.GetCount()-1;i<=s;i++)e=i,this.IsTabVisible(e)||(t+=1);return t},this.GetInvisibleTabCountForScrolling=function(){var t=0,e=0;t=0;for(var i=this.FStartTab,s=this.FLastTabIndex;i<=s;i++)e=i,this.IsTabVisible(e)||(t+=1);return t},this.GetLastScrollableTabIndex=function(){var t=0,e=0;t=0;for(var i=this.FTabs.GetCount()-1;i>=0;i--)if(e=i,this.IsTabVisible(e)&&this.IsTabEnabled(e)){t=e;break}return t},this.GetFirstScrollableTabIndex=function(){var t=0,e=0;t=0;for(var i=0,s=this.FTabs.GetCount()-1;i<=s;i++)if(e=i,this.IsTabVisible(e)&&this.IsTabEnabled(e)){t=e;break}return t},this.GetDisplayCount=function(){return this.FDisplayList.GetCount()},this.GetNormalDisplayCount=function(){var t=0;return t=this.GetDisplayCount(),1===this.FOptions.FInsertMode&&(t-=1),t},this.GetAdditionalTabSpacing=function(){var t=0;return t=0,1===this.FOptions.FInsertMode&&(t=t+this.FTabAppearance.FInsertSize+10),t},this.GetTabListButtonRect=function(){var t,e,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();s.$assign(this.GetMenuRect()),t=this.FButtonAppearance.FSize,e=this.ScalePaintValue(3);var n=this.FLayout.FPosition;return 1===n||2===n?this.FShowTabListButton?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Right-e-t,s.Top+(s.Bottom-s.Top-t)/2,s.Right-e,s.Top+(s.Bottom-s.Top-t)/2+t)):i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Right,s.Top,s.Right,s.Bottom)):0!==n&&3!==n||(this.FShowTabListButton?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left+(s.Right-s.Left-t)/2,s.Bottom-e-t,s.Left+(s.Right-s.Left-t)/2+t,s.Bottom-e)):i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Left,s.Bottom,s.Right,s.Bottom))),i},this.GetCloseButtonRect=function(){var t,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;i.$assign(this.GetTabListButtonRect()),t=this.FButtonAppearance.FSize,s=this.FShowTabListButton?this.ScalePaintValue(6):this.ScalePaintValue(3);var n=this.FLayout.FPosition;return 1===n||2===n?this.FShowCloseButton?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left-s-t,i.Top+(i.Bottom-i.Top-t)/2,i.Left-s,i.Top+(i.Bottom-i.Top-t)/2+t)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Left,i.Bottom)):0!==n&&3!==n||(this.FShowCloseButton?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+(i.Right-i.Left-t)/2,i.Top-s-t,i.Left+(i.Right-i.Left-t)/2+t,i.Top-s)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Right,i.Top))),e},this.GetInsertButtonRect=function(){var t,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;i.$assign(this.GetCloseButtonRect()),t=this.FButtonAppearance.FSize,s=this.FShowTabListButton||this.FShowCloseButton?6:3;var n=this.FLayout.FPosition;return 1===n||2===n?this.FShowInsertButton?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left-s-t,i.Top+(i.Bottom-i.Top-t)/2,i.Left-s,i.Top+(i.Bottom-i.Top-t)/2+t)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Left,i.Bottom)):0!==n&&3!==n||(this.FShowInsertButton?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+(i.Right-i.Left-t)/2,i.Top-s-t,i.Left+(i.Right-i.Left-t)/2+t,i.Top-s)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Right,i.Top))),e},this.GetScrollButtonNextRect=function(){var t,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;i.$assign(this.GetInsertButtonRect()),t=this.FButtonAppearance.FSize,s=this.FShowTabListButton||this.FShowCloseButton||this.FShowInsertButton?this.ScalePaintValue(6):this.ScalePaintValue(3);var n=this.FLayout.FPosition;return 1===n||2===n?this.FShowScrollButtons?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left-s-t,i.Top+(i.Bottom-i.Top-t)/2,i.Left-s,i.Top+(i.Bottom-i.Top-t)/2+t)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Left,i.Bottom)):0!==n&&3!==n||(this.FShowScrollButtons?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+(i.Right-i.Left-t)/2,i.Top-s-t,i.Left+(i.Right-i.Left-t)/2+t,i.Top-s)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Right,i.Top))),e},this.GetScrollButtonPreviousRect=function(){var t,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;i.$assign(this.GetScrollButtonNextRect()),t=this.FButtonAppearance.FSize,s=this.FShowScrollButtons?this.ScalePaintValue(6):this.ScalePaintValue(3);var n=this.FLayout.FPosition;return 1===n||2===n?this.FShowScrollButtons?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left-s-t,i.Top+(i.Bottom-i.Top-t)/2,i.Left-s,i.Top+(i.Bottom-i.Top-t)/2+t)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Left,i.Bottom)):0!==n&&3!==n||(this.FShowScrollButtons?e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+(i.Right-i.Left-t)/2,i.Top-s-t,i.Left+(i.Right-i.Left-t)/2+t,i.Top-s)):e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,i.Right,i.Top))),e},this.IsButtonStateDown=function(){return 2===this.FTabListButtonState||2===this.FInsertButtonState||2===this.FCloseButtonState||2===this.FScrollButtonPreviousState||2===this.FScrollButtonNextState},this.DragTabDisplay=function(){var e=t.TTMSFNCTabSetDisplayTab.$new();return e.$assign(this.FDragTabDisplay),e},this.IsButtonStateChanged=function(){return this.FTabListButtonState!==this.FPrevTabListButtonState||this.FInsertButtonState!==this.FPrevInsertButtonState||this.FCloseButtonState!==this.FPrevCloseButtonState||this.FScrollButtonPreviousState!==this.FPrevScrollButtonPreviousState||this.FScrollButtonNextState!==this.FPrevScrollButtonNextState},this.GetNextTab=function(t){var e=0,i=0,s=0;if(e=t,t<0)return e;for(i=t,s=1;s<this.FTabs.GetCount();){if((i+=1)>=this.FTabs.GetCount()&&(i=0),t!==i&&this.IsTabVisible(i)&&this.IsTabEnabled(i)){e=i;break}s+=1}return e},this.GetPreviousTab=function(t){var e=0,i=0,s=0;if(e=t,t<0)return e;for(i=t,s=1;s<this.FTabs.GetCount();){if((i-=1)>=this.FTabs.GetCount()&&(i=0),i<0&&(i=this.FTabs.GetCount()-1),t!==i&&this.IsTabVisible(i)&&this.IsTabEnabled(i)){e=i;break}s+=1}return e},this.GetDisplayTab=function(i){var s=t.TTMSFNCTabSetDisplayTab.$new(),n=0,o=t.TTMSFNCTabSetDisplayTab.$new();s.$assign(e.EmptyDisplayTab());for(var r=0,a=this.GetNormalDisplayCount()-1;r<=a;r++)if(n=r,o.$assign(this.FDisplayList.GetItem(n)),null!=o.Tab&&o.Tab.GetIndex()===i){s.$assign(o);break}return s},this.HandleInsertTab=function(t){var e=null,i=0,s=!1;return e=null,i=this.FTabs.GetCount(),s=!0,this.DoBeforeInsertTab({get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),s&&((e=this.FTabs.Add$1()).SetIndex(i),this.DoInsertTab(i),t.set(!0)),e},this.GetInplaceEditorRect=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),null==t.Tab||(i.$assign(t.TextRect),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,2,0),e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.Math.Floor(i.Left),pas.Math.Floor(i.Top),Math.round(i.Right),Math.round(i.Bottom))),null!=this.FOnGetInplaceEditorRect&&this.FOnGetInplaceEditorRect(this,t.Tab.GetIndex(),this.FInplaceEditor,e)),e},this.XYToAnchor=function(t,e,i){var s="",n=null,o=0,r=0,a=!1,l=0;if(s="",null==t.Tab)return s;if(t.Tab.IsHTML()){n=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,this.FNativeCanvas,!0]),this.FNativeCanvas||n.BeginScene(),n.FBitmapContainer=this.GetBitmapContainer(),n.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing;try{n.FFont.Assign(this.FTabAppearance.FFont),t.Tab.FUseDefaultAppearance?(a=this.FTabAppearance.FWordWrapping,l=this.FTabAppearance.FTrimming,o=this.FTabAppearance.FTextAlign):(a=t.Tab.FWordWrapping,l=t.Tab.FTrimming,o=t.Tab.FTextAlign),r=0;var h=this.FLayout.FPosition;1===h||2===h?s=n.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t.TextRect),t.Tab.FText,a,o,r,l,0,-1,-1,!0,!0,e,i):0===h?s=n.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t.TextRect),t.Tab.FText,a,o,r,l,-90,-1,-1,!0,!0,e,i):3===h&&(s=n.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t.TextRect),t.Tab.FText,a,o,r,l,90,-1,-1,!0,!0,e,i))}finally{this.FNativeCanvas||n.EndScene(),n=rtl.freeLoc(n)}}return s},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,this.UpdateTabs(!1,!1)},this.PopupListSelected=function(e){var i=null;this.FTabListPopup.SetIsOpen(!1),this.FTabList.GetItemIndex()>=0&&this.FTabList.GetItemIndex()<=this.FTabList.GetCount()-1&&null!=(i=rtl.as(this.FTabList.FItems.GetObject(this.FTabList.GetItemIndex()),t.TTMSFNCTabSetTab))&&i.SetVisible(!0)},this.ApplyStyle=function(){var t=0,e=0,i=0,s=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),i=t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&(i=t,this.FTabAppearance.FActiveFill.SetColor(t)),t=-1,e=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleSelectionFillColor({get:function(){return t},set:function(e){t=e}})&&(e=t=pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetColorRed(t),pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetColorGreen(t),pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetColorBlue(t)),this.FTabAppearance.FHoverFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(t,20)),this.FTabAppearance.FDownFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Darker(t,20)),this.FTabAppearance.FFill.SetColor(t),this.FTabAppearance.FBadgeFill.SetColor(t),this.FButtonAppearance.FHoverFill.SetColor(this.FTabAppearance.FHoverFill.FColor),this.FButtonAppearance.FDownFill.SetColor(this.FTabAppearance.FDownFill.FColor),this.FButtonAppearance.FFill.SetColor(this.FTabAppearance.FFill.FColor)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleLineFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FTabAppearance.FActiveStroke.SetColor(t),this.FTabAppearance.FStroke.SetColor(t),this.FTabAppearance.FHoverStroke.SetColor(t),this.FTabAppearance.FDownStroke.SetColor(t),this.FButtonAppearance.FStroke.SetColor(t),this.FButtonAppearance.FHoverStroke.SetColor(t),this.FButtonAppearance.FDownStroke.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&(i!==t?this.FTabAppearance.SetActiveTextColor(t):16777215===t?this.FTabAppearance.SetActiveTextColor(8421504):this.FTabAppearance.SetActiveTextColor(pas["WEBLib.TMSFNCGraphicsTypes"].Darker(t,40)),e!==t?this.FTabAppearance.SetDownTextColor(t):16777215===t?this.FTabAppearance.SetDownTextColor(8421504):this.FTabAppearance.SetDownTextColor(pas["WEBLib.TMSFNCGraphicsTypes"].Darker(t,40)),e!==t?this.FTabAppearance.SetHoverTextColor(t):16777215===t?this.FTabAppearance.SetHoverTextColor(8421504):this.FTabAppearance.SetHoverTextColor(pas["WEBLib.TMSFNCGraphicsTypes"].Darker(t,40)),e!==t?this.FTabAppearance.SetTextColor(t):16777215===t?this.FTabAppearance.SetTextColor(8421504):this.FTabAppearance.SetTextColor(pas["WEBLib.TMSFNCGraphicsTypes"].Darker(t,40)));for(var n=0,o=this.FTabs.GetCount()-1;n<=o;n++)s=n,this.FTabs.GetTab(s).SetUseDefaultAppearance(!0);null!=this.FInsertTab&&this.FInsertTab.SetUseDefaultAppearance(!0)},this.ResetToDefaultStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.BeginUpdate(),this.FTabAppearance.FBadgeFill.SetColor(42495),this.FButtonAppearance.FHoverFill.SetColor(this.FTabAppearance.FHoverFill.FColor),this.FButtonAppearance.FDownFill.SetColor(this.FTabAppearance.FDownFill.FColor),this.FButtonAppearance.FFill.SetColor(this.FTabAppearance.FFill.FColor),this.FTabAppearance.FActiveStroke.SetColor(11119017),this.FTabAppearance.FStroke.SetColor(11119017),this.FTabAppearance.FHoverStroke.SetColor(11119017),this.FTabAppearance.FDownStroke.SetColor(11119017),this.FButtonAppearance.FStroke.SetColor(11119017),this.FButtonAppearance.FHoverStroke.SetColor(11119017),this.FButtonAppearance.FDownStroke.SetColor(11119017),this.FTabAppearance.FFill.SetColor(16578806),this.FTabAppearance.FHoverFill.SetColor(16380654),this.FTabAppearance.FDownFill.SetColor(15776936),this.FTabAppearance.FHoverStroke.SetColor(15702829),this.FTabAppearance.SetTextColor(8026746),this.FTabAppearance.SetActiveTextColor(4539717),this.FTabAppearance.FActiveFill.SetColor(16777215),this.FTabAppearance.SetHoverTextColor(this.FTabAppearance.FTextColor),this.FTabAppearance.SetDownTextColor(this.FTabAppearance.FActiveTextColor),this.FTabAppearance.FDownStroke.SetColor(this.FTabAppearance.FHoverStroke.FColor),this.FTabAppearance.FHoverFill.SetKind(1),this.FTabAppearance.FDownFill.SetKind(1),this.FTabAppearance.FActiveFill.SetKind(1),this.FTabAppearance.FFill.SetKind(1),this.FTabAppearance.SetShowFocus(!1);for(var e=0,i=this.FTabs.GetCount()-1;e<=i;e++)t=e,this.FTabs.GetTab(t).SetUseDefaultAppearance(!0);null!=this.FInsertTab&&this.FInsertTab.SetUseDefaultAppearance(!1),this.EndUpdate()},this.DoInvalidate=function(){},this.InitializeInvisibleTabs=function(){var t=0,e=null;this.FInvisibleTabList.Clear();for(var i=0,s=this.FTabs.GetCount()-1;i<=s;i++)t=i,(e=this.FTabs.GetTab(t)).FVisible||this.FInvisibleTabList.Add(e)},this.InitializeScrollButtonState=function(){this.FInteraction.FSelectTabOnScroll?(this.FScrollButtonPreviousDisabled=this.GetActiveTabIndex()===this.GetFirstScrollableTabIndex()||-1===this.GetActiveTabIndex(),this.FScrollButtonNextDisabled=this.GetActiveTabIndex()===this.GetLastScrollableTabIndex()||-1===this.GetActiveTabIndex()):(this.FScrollButtonPreviousDisabled=0===this.FStartTab,this.FScrollButtonNextDisabled=this.FScrollCount-this.FStartTab==0)},this.FillTabList=function(){var t=0;this.FTabList.SetParent(this),this.FTabList.FItems.Clear();for(var e=0,i=this.FInvisibleTabList.GetCount()-1;e<=i;e++)t=e,this.FTabList.FItems.AddObject(this.FInvisibleTabList.GetItem(t).GetFriendlyName(),this.FInvisibleTabList.GetItem(t));this.FTabList.SetParent(null)},this.SaveButtonState=function(){this.FPrevTabListButtonState=this.FTabListButtonState,this.FPrevCloseButtonState=this.FCloseButtonState,this.FPrevScrollButtonPreviousState=this.FScrollButtonPreviousState,this.FPrevScrollButtonNextState=this.FScrollButtonNextState,this.FPrevInsertButtonState=this.FInsertButtonState},this.ClearButtonState=function(){this.FTabListButtonState=0,this.FCloseButtonState=0,this.FScrollButtonPreviousState=0,this.FScrollButtonNextState=0,this.FInsertButtonState=0},this.HandleButtonDownState=function(t,e){this.XYToScrollPreviousButton(t,e)?this.FScrollButtonPreviousState=2:this.XYToScrollNextButton(t,e)?this.FScrollButtonNextState=2:this.XYToCloseButton(t,e)?this.FCloseButtonState=2:this.XYToInsertButton(t,e)?this.FInsertButtonState=2:this.XYToTabListButton(t,e)&&(this.FTabListButtonState=2)},this.HandleButtonHoverState=function(t,e){this.XYToScrollPreviousButton(t,e)?this.FScrollButtonPreviousState=1:this.XYToScrollNextButton(t,e)?this.FScrollButtonNextState=1:this.XYToCloseButton(t,e)?this.FCloseButtonState=1:this.XYToInsertButton(t,e)?this.FInsertButtonState=1:this.XYToTabListButton(t,e)&&(this.FTabListButtonState=1)},this.InitializeMenu=function(){this.FMenuSize=0,this.FShowCloseButton=2===this.FOptions.FCloseMode,this.FShowInsertButton=2===this.FOptions.FInsertMode,this.FShowTabListButton=this.GetInvisibleTabCount()>0&&this.FOptions.FTabListButton,this.FShowTabListButton&&(this.FMenuSize=this.FMenuSize+this.FButtonAppearance.FSize+8,this.FShowMenu=!0),this.FShowCloseButton&&(this.FMenuSize=this.FMenuSize+this.FButtonAppearance.FSize+8,this.FShowMenu=!0),this.FShowInsertButton&&(this.FMenuSize=this.FMenuSize+this.FButtonAppearance.FSize+8,this.FShowMenu=!0),this.FShowScrollButtons&&(this.FMenuSize=this.FMenuSize+2*(this.FButtonAppearance.FSize+8),this.FShowMenu=!0)},this.StartProgressAnimationTimer=function(){this.FAnimTimer.SetEnabled(!this.IsDesignTime())},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null)},this.CalculateRects=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e.$assign(t.Rect);var i=this.FLayout.FPosition;if(1===i||2===i){var s=this.FTabAppearance.FShape;0===s?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+this.FTabAppearance.FShapeOverlap,e.Top,e.Right,e.Bottom)):1===s?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+this.FTabAppearance.FShapeSlope,e.Top,e.Right,e.Bottom)):2===s?t.First||this.FActiveTab===t.Tab?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top,e.Right-this.FTabAppearance.FShapeSlope,e.Bottom)):t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+this.FTabAppearance.FShapeSlope/2,e.Top,e.Right-this.FTabAppearance.FShapeSlope,e.Bottom)):3===s?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+this.FTabAppearance.FShapeSlope,e.Top,e.Right-this.FTabAppearance.FShapeSlope,e.Bottom)):4===s?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+this.FTabAppearance.FShapeSlope/2,e.Top,e.Right,e.Bottom)):5===s?t.First||this.FActiveTab===t.Tab?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top,e.Right-this.FTabAppearance.FShapeSlope/2,e.Bottom)):t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+this.FTabAppearance.FShapeSlope/2,e.Top,e.Right-this.FTabAppearance.FShapeSlope/2,e.Bottom)):6===s&&t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left+this.FTabAppearance.FShapeSlope/2,e.Top,e.Right-this.FTabAppearance.FShapeSlope/2,e.Bottom))}else if(0===i||3===i){var n=this.FTabAppearance.FShape;0===n?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+this.FTabAppearance.FShapeOverlap,e.Right,e.Bottom)):1===n?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+this.FTabAppearance.FShapeSlope,e.Right,e.Bottom)):2===n?t.First||this.FActiveTab===t.Tab?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top,e.Right,e.Bottom-this.FTabAppearance.FShapeSlope)):t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+this.FTabAppearance.FShapeSlope/2,e.Right,e.Bottom-this.FTabAppearance.FShapeSlope)):3===n?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+this.FTabAppearance.FShapeSlope,e.Right,e.Bottom-this.FTabAppearance.FShapeSlope)):4===n?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+this.FTabAppearance.FShapeSlope/2,e.Right,e.Bottom)):5===n?t.First||this.FActiveTab===t.Tab?t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top,e.Right,e.Bottom-this.FTabAppearance.FShapeSlope/2)):t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+this.FTabAppearance.FShapeSlope/2,e.Right,e.Bottom-this.FTabAppearance.FShapeSlope/2)):6===n&&t.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+this.FTabAppearance.FShapeSlope/2,e.Right,e.Bottom-this.FTabAppearance.FShapeSlope/2))}t.ProgressRect.$assign(t.Tab.GetProgressRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t.ContentRect))),t.BitmapRect.$assign(t.Tab.GetBitmapRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t.ContentRect))),t.TextRect.$assign(t.Tab.GetTextRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t.ContentRect))),t.CloseButtonRect.$assign(t.Tab.GetCloseButtonRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t.ContentRect)))},this.FixStartTab=function(){var e=t.TTMSFNCTabSetDisplayTab.$new(),i=t.TTMSFNCTabSetDisplayTab.$new(),s=0,n=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=0,a=0;if(this.FDisplayList.GetCount()>0&&this.FStartTab>0&&2!==this.FTabSize.FMode&&this.FAllowScrolling&&0===this.FLayout.FMultiline&&this.FScrollCount>0&&this.FLastTabIndex===this.GetLastScrollableTabIndex()&&(i.$assign(this.FDisplayList.GetItem(this.FDisplayList.GetCount()-1)),e.$assign(this.FDisplayList.GetItem(0)),null!=i.Tab&&null!=e.Tab&&(r=this.GetPreviousTab(e.Tab.GetIndex()))>=0&&r<=this.FTabs.GetCount()-1)){o.$assign(this.GetTabRect()),n=this.GetTabSize(r);var l=this.FLayout.FPosition;1===l||2===l?(s=i.Rect.Right+n+this.FTabSize.FSpacing-this.FTabAppearance.FShapeOverlap,1===this.FOptions.FInsertMode?s+=this.GetAdditionalTabSpacing():s+=5,a=o.Right):0===l||3===l?(s=i.Rect.Bottom+n+this.FTabSize.FSpacing-this.FTabAppearance.FShapeOverlap,1===this.FOptions.FInsertMode?s+=this.GetAdditionalTabSpacing():s+=5,a=o.Bottom):(s=0,a=0),s<a&&(this.FStartTab-=1,this.FStartTab=Math.max(0,this.FStartTab),this.UpdateTabs(!1,!1))}},this.UpdateTabs=function(e,i){var s,n,o=0,r=t.TTMSFNCTabSetDisplayTab.$new(),a=t.TTMSFNCTabSetDisplayTab.$new(),l=0,h=0,F=0,p=0,c=0,u=0,T=0,C=0,S=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),d=0,m=0,f=0,g=0,y=0,b=0,N=0,M=0,B=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(!this.FTabChanging&&(this.FDisplayList.Clear(),this.FInvisibleTabList.Clear(),i||!(this.FUpdateCount$1>0||3 in this.FComponentState)))if(this.FShowMenu=!1,e||(this.FShowScrollButtons=!1),this.InitializeMenu(),0!==this.FTabs.GetCount()){S.$assign(this.GetTabRect()),l=S.Left,h=S.Top,d=0,b=0;var E=this.FLayout.FPosition;1===E||2===E?(c=this.FTabSize.FWidth,u=S.Bottom-S.Top):0===E||3===E?(c=S.Right-S.Left,u=this.FTabSize.FWidth):(c=0,u=0),s=this.GetVisibleTabCount();var L=this.FTabSize.FMode;if(0===L){var D=this.FLayout.FPosition;if(1===D||2===D){if((F=s>0?(S.Right-S.Left+(s-1)*this.FTabAppearance.FShapeOverlap-(s-1)*this.FTabSize.FSpacing-this.GetAdditionalTabSpacing())/s:0)>0)for(var A=0,$=this.FTabs.GetCount()-1;A<=$;A++)o=A,this.IsTabVisible(o)&&(r.First=!1,r.Last=!1,r.Tab=this.FTabs.GetTab(o),r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h,l+F,h+u)),r.Row=0,this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(r)),l=l+F+this.FTabSize.FSpacing-this.FTabAppearance.FShapeOverlap);1===this.FOptions.FInsertMode&&(a.Tab=this.FInsertTab,a.TabKind=1,a.First=!1,a.Last=!1,a.Row=0,this.FDisplayList.GetCount()>0?a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l+5+this.FTabAppearance.FShapeOverlap,h,l+5+this.FTabAppearance.FShapeOverlap+this.FTabAppearance.FInsertSize,h+u)):a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l+5,h,l+5+this.FTabAppearance.FInsertSize,h+u)),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(a)))}else if(0===D||3===D){if((p=s>0?(S.Bottom-S.Top+(s-1)*this.FTabAppearance.FShapeOverlap-(s-1)*this.FTabSize.FSpacing-this.GetAdditionalTabSpacing())/s:0)>0)for(var I=0,P=this.FTabs.GetCount()-1;I<=P;I++)o=I,this.IsTabVisible(o)&&(r.First=!1,r.Last=!1,r.Tab=this.FTabs.GetTab(o),r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h,l+c,h+p)),r.Row=0,this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(r)),h=h+p+this.FTabSize.FSpacing-this.FTabAppearance.FShapeOverlap);1===this.FOptions.FInsertMode&&(a.Tab=this.FInsertTab,a.TabKind=1,a.First=!1,a.Last=!1,a.Row=0,this.FDisplayList.GetCount()>0?a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h+5+this.FTabAppearance.FShapeOverlap,l+c,h+5+this.FTabAppearance.FShapeOverlap+this.FTabAppearance.FInsertSize)):a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h+5,l+c,h+5+this.FTabAppearance.FInsertSize)),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(a)))}}else if(1===L||2===L||3===L){C=0,2!==this.FTabSize.FMode&&this.FAllowScrolling&&0===this.FLayout.FMultiline&&(C=this.FStartTab),N=this.FTabs.GetCount(),1===this.FOptions.FInsertMode&&(N+=1);for(var v=C,G=N-1;v<=G;v++)if((o=v)<=this.FTabs.GetCount()-1&&this.IsTabVisible(o)||o>this.FTabs.GetCount()-1){var w=this.FLayout.FPosition;if(1===w||2===w){if((F=this.GetTabSize(o))>0)if(o===N-1&&1===this.FOptions.FInsertMode?(r.Tab=this.FInsertTab,r.TabKind=1,r.First=!1,r.Last=!1,r.Row=d,this.FDisplayList.GetCount()>0?(r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l+5+this.FTabAppearance.FShapeOverlap,h,l+5+this.FTabAppearance.FShapeOverlap+F,h+u)),m=l+F+5+this.FTabAppearance.FShapeOverlap):(r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l+5,h,l+5+F,h+u)),m=l+F+5),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(r))):(r.First=0===this.FDisplayList.GetCount(),r.Last=!1,r.Tab=this.FTabs.GetTab(o),r.Row=d,r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h,l+F,h+u)),o===this.GetActiveTabIndex()&&(b=d),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(r)),m=l+F+this.FTabSize.FSpacing,1===this.FOptions.FInsertMode&&o===N-2&&(m=m+this.FTabAppearance.FInsertSize+5)),g=S.Right,1===this.FOptions.FInsertMode?g-=this.GetAdditionalTabSpacing():g-=5,m>g&&this.FAllowScrolling&&this.FDisplayList.GetCount()>1&&(o<N-1&&1===this.FOptions.FInsertMode||1!==this.FOptions.FInsertMode)){if(d+=1,2===this.FTabSize.FMode||0===this.FLayout.FMultiline){this.FDisplayList.Remove(t.TTMSFNCTabSetDisplayTab.$clone(r));break}l=S.Left;var O=this.FLayout.FPosition;1===O?h+=u:2===O&&(h-=u),r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h,l+F,h+u)),r.First=!0,r.Row=d,o===this.GetActiveTabIndex()&&(b=d),this.FDisplayList.SetItem(this.FDisplayList.GetCount()-1,r),this.FDisplayList.GetCount()>1&&(r.$assign(this.FDisplayList.GetItem(this.FDisplayList.GetCount()-2)),r.Last=!0,this.FDisplayList.SetItem(this.FDisplayList.GetCount()-2,r)),l=m=l+F+this.FTabSize.FSpacing-this.FTabAppearance.FShapeOverlap}else 1===this.FOptions.FInsertMode&&o===N-2&&(m=m-this.FTabAppearance.FInsertSize-5),l=m-this.FTabAppearance.FShapeOverlap}else if((0===w||3===w)&&(p=this.GetTabSize(o))>0)if(o===N-1&&1===this.FOptions.FInsertMode?(r.Tab=this.FInsertTab,r.TabKind=1,r.First=!1,r.Last=!1,r.Row=d,this.FDisplayList.GetCount()>0?(r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h+5+this.FTabAppearance.FShapeOverlap,l+c,h+5+this.FTabAppearance.FShapeOverlap+p)),f=h+p+5+this.FTabAppearance.FShapeOverlap):(r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h+5,l+c,h+5+p)),f=h+p+5),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(r))):(r.First=0===this.FDisplayList.GetCount(),r.Last=!1,r.Tab=this.FTabs.GetTab(o),r.Row=d,r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h,l+c,h+p)),o===this.GetActiveTabIndex()&&(b=d),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(r)),f=h+p+this.FTabSize.FSpacing,1===this.FOptions.FInsertMode&&o===N-2&&(f=f+this.FTabAppearance.FInsertSize+5)),y=S.Bottom,1===this.FOptions.FInsertMode?y-=this.GetAdditionalTabSpacing():y-=5,f>y&&this.FAllowScrolling&&this.FDisplayList.GetCount()>1&&(o<N-1&&1===this.FOptions.FInsertMode||1!==this.FOptions.FInsertMode)){if(d+=1,2===this.FTabSize.FMode||0===this.FLayout.FMultiline){this.FDisplayList.Remove(t.TTMSFNCTabSetDisplayTab.$clone(r));break}h=S.Top;var W=this.FLayout.FPosition;0===W?l+=c:3===W&&(l-=c),r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h,l+c,h+p)),r.First=!0,r.Row=d,o===this.GetActiveTabIndex()&&(b=d),this.FDisplayList.SetItem(this.FDisplayList.GetCount()-1,r),this.FDisplayList.GetCount()>1&&(r.$assign(this.FDisplayList.GetItem(this.FDisplayList.GetCount()-2)),r.Last=!0,this.FDisplayList.SetItem(this.FDisplayList.GetCount()-2,r)),h=f=h+p+this.FTabSize.FSpacing-this.FTabAppearance.FShapeOverlap}else 1===this.FOptions.FInsertMode&&o===N-2&&(f=f-this.FTabAppearance.FInsertSize-5),h=f-this.FTabAppearance.FShapeOverlap}if(d+this.FStartTab>0&&this.GetDisplayCount()>0)if(2===this.FTabSize.FMode){l=S.Left,h=S.Top,this.FDisplayList.Clear();var R=this.FLayout.FPosition;if(1===R||2===R){if((F=s>0?(S.Right-S.Left+(s-1)*this.FTabAppearance.FShapeOverlap-(s-1)*this.FTabSize.FSpacing-this.GetAdditionalTabSpacing())/s:0)>0)for(var x=0,k=this.FTabs.GetCount()-1;x<=k;x++)o=x,this.IsTabVisible(o)&&(r.First=!1,r.Last=!1,r.Tab=this.FTabs.GetTab(o),r.Row=0,r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h,l+F,h+u)),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(r)),l=l+F+this.FTabSize.FSpacing-this.FTabAppearance.FShapeOverlap);1===this.FOptions.FInsertMode&&(a.Tab=this.FInsertTab,a.TabKind=1,a.First=!1,a.Last=!1,a.Row=0,this.FDisplayList.GetCount()>0?a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l+5+this.FTabAppearance.FShapeOverlap,h,l+5+this.FTabAppearance.FShapeOverlap+this.FTabAppearance.FInsertSize,h+u)):a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l+5,h,l+5+this.FTabAppearance.FInsertSize,h+u)),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(a)))}else if(0===R||3===R){if((p=s>0?(S.Bottom-S.Top+(s-1)*this.FTabAppearance.FShapeOverlap-(s-1)*this.FTabSize.FSpacing-this.GetAdditionalTabSpacing())/s:0)>0)for(var V=0,H=this.FTabs.GetCount()-1;V<=H;V++)o=V,this.IsTabVisible(o)&&(r.First=!1,r.Last=!1,r.Tab=this.FTabs.GetTab(o),r.Row=0,r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h,l+c,h+p)),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(r)),h=h+p+this.FTabSize.FSpacing-this.FTabAppearance.FShapeOverlap);1===this.FOptions.FInsertMode&&(a.Tab=this.FInsertTab,a.TabKind=1,a.First=!1,a.Last=!1,a.Row=0,this.FDisplayList.GetCount()>0?a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h+5+this.FTabAppearance.FShapeOverlap,l+c,h+5+this.FTabAppearance.FShapeOverlap+this.FTabAppearance.FInsertSize)):a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l,h+5,l+c,h+5+this.FTabAppearance.FInsertSize)),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(a)))}}else if(0===this.FLayout.FMultiline)if(!this.FShowScrollButtons&&this.FAllowScrolling)this.FShowScrollButtons=!0,this.UpdateTabs(!0,i);else if(1===this.FOptions.FInsertMode&&d>0){var U=this.FLayout.FPosition;1===U||2===U?(a.Tab=this.FInsertTab,a.TabKind=1,a.First=!1,a.Last=!1,a.Row=d,r.$assign(this.FDisplayList.GetItem(this.FDisplayList.GetCount()-1)),a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(r.Rect.Right+5,r.Rect.Top,r.Rect.Right+5+this.FTabAppearance.FInsertSize,r.Rect.Top+u)),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(a))):0!==U&&3!==U||(a.Tab=this.FInsertTab,a.TabKind=1,a.First=!1,a.Last=!1,a.Row=d,r.$assign(this.FDisplayList.GetItem(this.FDisplayList.GetCount()-1)),a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(r.Rect.Left,r.Rect.Bottom+5,r.Rect.Left+c,r.Rect.Bottom+5+this.FTabAppearance.FInsertSize)),this.FDisplayList.Add(t.TTMSFNCTabSetDisplayTab.$clone(a)))}}n=d>0&&2===this.FLayout.FMultiline&&-1!==this.GetActiveTabIndex()&&(1===this.FTabSize.FMode||3===this.FTabSize.FMode);for(var z=0,j=this.GetNormalDisplayCount()-1;z<=j;z++){if(o=z,r.$assign(this.FDisplayList.GetItem(o)),r.Index=o,r.TabKind=0,0===o&&(r.First=!0,null!=r.Tab&&(this.FFirstTabIndex=r.Tab.GetIndex())),o===this.GetNormalDisplayCount()-1&&(r.Last=!0,null!=r.Tab&&(this.FLastTabIndex=r.Tab.GetIndex())),n){M=0;var K=this.FLayout.FPosition;T=0===K||3===K?c:1===K||2===K?u:0,r.Row===b?M=(d-b)*T:r.Row>b&&(M=-T);var J=this.FLayout.FPosition;0===J?r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(r.Rect.Left+M,r.Rect.Top,r.Rect.Right+M,r.Rect.Bottom)):1===J?r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(r.Rect.Left,r.Rect.Top+M,r.Rect.Right,r.Rect.Bottom+M)):2===J?r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(r.Rect.Left,r.Rect.Top-M,r.Rect.Right,r.Rect.Bottom-M)):3===J&&r.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(r.Rect.Left-M,r.Rect.Top,r.Rect.Right-M,r.Rect.Bottom))}this.CalculateRects(r),this.FDisplayList.SetItem(o,r)}if(1===this.FOptions.FInsertMode&&this.FDisplayList.GetCount()>0&&(a.$assign(this.FDisplayList.GetItem(this.FDisplayList.GetCount()-1)),null!=a.Tab)){B.$assign(a.Rect);var Y=this.FLayout.FPosition;if(0===Y||3===Y?a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(B.Left+(B.Right-B.Left-this.FTabAppearance.FInsertSize)/2,B.Top,B.Left+(B.Right-B.Left-this.FTabAppearance.FInsertSize)/2+this.FTabAppearance.FInsertSize,B.Bottom)):1!==Y&&2!==Y||a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(B.Left,B.Top+(B.Bottom-B.Top-this.FTabAppearance.FInsertSize)/2,B.Right,B.Top+(B.Bottom-B.Top-this.FTabAppearance.FInsertSize)/2+this.FTabAppearance.FInsertSize)),n){M=0;var X=this.FLayout.FPosition;T=0===X||3===X?c:1===X||2===X?u:0,r.Row===b?M=(d-b)*T:r.Row>b&&(M=-T);var q=this.FLayout.FPosition;0===q?a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(a.Rect.Left+M,a.Rect.Top,a.Rect.Right+M,a.Rect.Bottom)):1===q?a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(a.Rect.Left,a.Rect.Top+M,a.Rect.Right,a.Rect.Bottom+M)):2===q?a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(a.Rect.Left,a.Rect.Top-M,a.Rect.Right,a.Rect.Bottom-M)):3===q&&a.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(a.Rect.Left-M,a.Rect.Top,a.Rect.Right-M,a.Rect.Bottom))}B.$assign(a.Rect),a.BitmapRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(pas.Math.Floor(B.Left),pas.Math.Floor(B.Top),pas.Math.Floor(B.Right),pas.Math.Floor(B.Bottom))),this.FDisplayList.SetItem(this.FDisplayList.GetCount()-1,a)}this.FActiveTabIndex>=0&&this.FActiveTabIndex<=this.FTabs.GetCount()-1?this.FActiveTab=this.FTabs.GetTab(this.FActiveTabIndex):this.FActiveTab=null,this.FScrollCount=0,2!==this.FTabSize.FMode&&0===this.FLayout.FMultiline&&this.FAllowScrolling&&(this.FScrollCount=this.FTabs.GetCount()-this.GetNormalDisplayCount()-this.GetInvisibleTabCountForScrolling()),this.InitializeScrollButtonState(),this.InitializeInvisibleTabs(),this.StartProgressAnimationTimer(),this.FixStartTab(),0!==this.FLayout.FMultiline&&this.FTabSize.FMode in rtl.createSet(1,3)?this.FTotalTabHeight=(d+1)*this.FTabSize.FHeight:this.FTotalTabHeight=this.FTabSize.FHeight,this.Invalidate()}else this.Invalidate()},this.DoBeforeDrawMenuButton=function(t,e,i,s,n){null!=this.FOnBeforeDrawMenuButton&&this.FOnBeforeDrawMenuButton(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoAfterDrawMenuButton=function(t,e,i,s){null!=this.FOnAfterDrawMenuButton&&this.FOnAfterDrawMenuButton(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoBeforeDrawTabBackground=function(t,e,i,s,n){null!=this.FOnBeforeDrawTabBackground&&this.FOnBeforeDrawTabBackground(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,n)},this.DoBeforeDrawTabProgress=function(t,e,i,s,n,o,r,a,l,h){null!=this.FOnBeforeDrawTabProgress&&this.FOnBeforeDrawTabProgress(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,n,o,r,a,l,h)},this.DoBeforeDrawTabBadge=function(t,e,i,s,n){null!=this.FOnBeforeDrawTabBadge&&this.FOnBeforeDrawTabBadge(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,n)},this.DoBeforeDrawTabText=function(t,e,i,s,n){null!=this.FOnBeforeDrawTabText&&this.FOnBeforeDrawTabText(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,n)},this.DoBeforeDrawTabCloseButton=function(t,e,i,s,n){null!=this.FOnBeforeDrawTabCloseButton&&this.FOnBeforeDrawTabCloseButton(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,n)},this.DoBeforeDrawTabBitmap=function(t,e,i,s){null!=this.FOnBeforeDrawTabBitmap&&this.FOnBeforeDrawTabBitmap(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s)},this.DoAfterDrawTabBackground=function(t,e,i,s){null!=this.FOnAfterDrawTabBackground&&this.FOnAfterDrawTabBackground(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s)},this.DoAfterDrawTabProgress=function(t,e,i,s,n,o,r,a,l){null!=this.FOnAfterDrawTabProgress&&this.FOnAfterDrawTabProgress(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,n,o,r,a,l)},this.DoAfterDrawTabBadge=function(t,e,i,s){null!=this.FOnAfterDrawTabBadge&&this.FOnAfterDrawTabBadge(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s)},this.DoAfterDrawTabText=function(t,e,i,s){null!=this.FOnAfterDrawTabText&&this.FOnAfterDrawTabText(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s)},this.DoAfterDrawTabCloseButton=function(t,e,i,s){null!=this.FOnAfterDrawTabCloseButton&&this.FOnAfterDrawTabCloseButton(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s)},this.DoAfterDrawTabBitmap=function(t,e,i){null!=this.FOnAfterDrawTabBitmap&&this.FOnAfterDrawTabBitmap(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))},this.DoBeforeChangeTab=function(t,e,i){null!=this.FOnBeforeChangeTab&&this.FOnBeforeChangeTab(this,t,e,i)},this.DoChangeTab=function(t,e){null!=this.FOnChangeTab&&this.FOnChangeTab(this,t,e)},this.DoBeforeReorderTab=function(t,e,i){null!=this.FOnBeforeReorderTab&&this.FOnBeforeReorderTab(this,t,e,i)},this.DoReorderTab=function(t,e){null!=this.FOnReorderTab&&this.FOnReorderTab(this,t,e)},this.DoBeforeCloseTab=function(t,e){null!=this.FOnBeforeCloseTab&&this.FOnBeforeCloseTab(this,t,e)},this.DoCloseTab=function(t,e){null!=this.FOnCloseTab&&this.FOnCloseTab(this,t,e)},this.DoBeforeInsertTab=function(t,e){null!=this.FOnBeforeInsertTab&&this.FOnBeforeInsertTab(this,t,e)},this.DoInsertTab=function(t){null!=this.FOnInsertTab&&this.FOnInsertTab(this,t)},this.DoAnchorTabClick=function(t,e){this.FInteraction.FAutoOpenURL?pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(e):null!=this.FOnAnchorTabClick&&this.FOnAnchorTabClick(this,t,e)},this.Draw=function(t,e){var i=null,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),i=t.SaveState(!1),this.DrawCustom(t),s.$assign(this.GetLocalRect()),pas["WEBLib.TMSFNCTypes"].InflateRectEx(s,-1,-1),t.ClipRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s)),t.FBitmapContainer=this.GetBitmapContainer(),this.DrawTabs(t),this.DrawBadges(t),this.DrawMenu(t),t.RestoreState(i,!1)},this.DrawTabs=function(i){var s=0,n=t.TTMSFNCTabSetDisplayTab.$new(),o=t.TTMSFNCTabSetDisplayTab.$new(),r=null;o.$assign(e.EmptyDisplayTab());for(var a=this.GetDisplayCount()-1;a>=0;a--)if(s=a,n.$assign(this.FDisplayList.GetItem(s)),null!=(r=n.Tab))if(r===this.FActiveTab)o.$assign(n);else{if(r===this.FDragTab)continue;r.Draw(i,t.TTMSFNCTabSetDisplayTab.$clone(n))}null!=this.FActiveTab&&this.FActiveTab!==this.FDragTab&&null!=o.Tab&&this.FActiveTab.Draw(i,t.TTMSFNCTabSetDisplayTab.$clone(o)),null!=this.FDragTab&&null!=this.FDragTabDisplay.Tab&&this.FDragTab.Draw(i,t.TTMSFNCTabSetDisplayTab.$clone(this.FDragTabDisplay))},this.DrawCustom=function(t){},this.DrawBadges=function(e){for(var i=0,s=t.TTMSFNCTabSetDisplayTab.$new(),n=null,o=this.GetDisplayCount()-1;o>=0;o--)i=o,s.$assign(this.FDisplayList.GetItem(i)),null!=(n=s.Tab)&&n.DrawBadge(e,t.TTMSFNCTabSetDisplayTab.$clone(s))},this.DrawMenu=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=null,s=!1;if(this.FShowTabListButton){var n=this.FTabListButtonState;0===n?(t.FFill.Assign(this.FButtonAppearance.FFill),t.FStroke.Assign(this.FButtonAppearance.FStroke)):1===n?(t.FFill.Assign(this.FButtonAppearance.FHoverFill),t.FStroke.Assign(this.FButtonAppearance.FHoverStroke)):2===n&&(t.FFill.Assign(this.FButtonAppearance.FDownFill),t.FStroke.Assign(this.FButtonAppearance.FDownStroke)),e.$assign(this.GetTabListButtonRect()),s=!0,this.DoBeforeDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),2,this.FTabListButtonState,{get:function(){return s},set:function(t){s=t}}),s&&(t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FButtonAppearance.FRounding,rtl.createSet(0,1,2,3),2),null!=(i=this.FButtonAppearance.FTabListIcon)&&t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,!0,!1,!0,!1),this.DoAfterDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),2,this.FTabListButtonState))}if(this.FShowCloseButton){var o=this.FCloseButtonState;0===o?(t.FFill.Assign(this.FButtonAppearance.FFill),t.FStroke.Assign(this.FButtonAppearance.FStroke)):1===o?(t.FFill.Assign(this.FButtonAppearance.FHoverFill),t.FStroke.Assign(this.FButtonAppearance.FHoverStroke)):2===o&&(t.FFill.Assign(this.FButtonAppearance.FDownFill),t.FStroke.Assign(this.FButtonAppearance.FDownStroke)),e.$assign(this.GetCloseButtonRect()),s=!0,this.DoBeforeDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),0,this.FCloseButtonState,{get:function(){return s},set:function(t){s=t}}),s&&(t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FButtonAppearance.FRounding,rtl.createSet(0,1,2,3),2),null!=(i=this.FButtonAppearance.FCloseIcon)&&t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,!0,!1,!0,!1),this.DoAfterDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),0,this.FCloseButtonState))}if(this.FShowInsertButton){var r=this.FInsertButtonState;0===r?(t.FFill.Assign(this.FButtonAppearance.FFill),t.FStroke.Assign(this.FButtonAppearance.FStroke)):1===r?(t.FFill.Assign(this.FButtonAppearance.FHoverFill),t.FStroke.Assign(this.FButtonAppearance.FHoverStroke)):2===r&&(t.FFill.Assign(this.FButtonAppearance.FDownFill),t.FStroke.Assign(this.FButtonAppearance.FDownStroke)),e.$assign(this.GetInsertButtonRect()),s=!0,this.DoBeforeDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),1,this.FInsertButtonState,{get:function(){return s},set:function(t){s=t}}),s&&(t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FButtonAppearance.FRounding,rtl.createSet(0,1,2,3),2),null!=(i=this.FButtonAppearance.FInsertIcon)&&t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,!0,!1,!0,!1),this.DoAfterDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),1,this.FInsertButtonState))}if(this.FShowScrollButtons){if(this.FScrollButtonPreviousDisabled)t.FFill.Assign(this.FButtonAppearance.FDisabledFill),t.FStroke.Assign(this.FButtonAppearance.FDisabledStroke);else{var a=this.FScrollButtonPreviousState;0===a?(t.FFill.Assign(this.FButtonAppearance.FFill),t.FStroke.Assign(this.FButtonAppearance.FStroke)):1===a?(t.FFill.Assign(this.FButtonAppearance.FHoverFill),t.FStroke.Assign(this.FButtonAppearance.FHoverStroke)):2===a&&(t.FFill.Assign(this.FButtonAppearance.FDownFill),t.FStroke.Assign(this.FButtonAppearance.FDownStroke))}if(e.$assign(this.GetScrollButtonPreviousRect()),s=!0,this.FScrollButtonPreviousDisabled?this.DoBeforeDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),3,3,{get:function(){return s},set:function(t){s=t}}):this.DoBeforeDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),3,this.FScrollButtonPreviousState,{get:function(){return s},set:function(t){s=t}}),s&&(t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FButtonAppearance.FRounding,rtl.createSet(0,1,2,3),2),null!=(i=this.FButtonAppearance.FScrollPreviousIcon)&&t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,!0,!1,!0,!1),this.FScrollButtonPreviousDisabled?this.DoAfterDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),3,3):this.DoAfterDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),3,this.FScrollButtonPreviousState)),this.FScrollButtonNextDisabled)t.FFill.Assign(this.FButtonAppearance.FDisabledFill),t.FStroke.Assign(this.FButtonAppearance.FDisabledStroke);else{var l=this.FScrollButtonNextState;0===l?(t.FFill.Assign(this.FButtonAppearance.FFill),t.FStroke.Assign(this.FButtonAppearance.FStroke)):1===l?(t.FFill.Assign(this.FButtonAppearance.FHoverFill),t.FStroke.Assign(this.FButtonAppearance.FHoverStroke)):2===l&&(t.FFill.Assign(this.FButtonAppearance.FDownFill),t.FStroke.Assign(this.FButtonAppearance.FDownStroke))}e.$assign(this.GetScrollButtonNextRect()),s=!0,this.FScrollButtonNextDisabled?this.DoBeforeDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),4,3,{get:function(){return s},set:function(t){s=t}}):this.DoBeforeDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),4,this.FScrollButtonNextState,{get:function(){return s},set:function(t){s=t}}),s&&(t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FButtonAppearance.FRounding,rtl.createSet(0,1,2,3),2),null!=(i=this.FButtonAppearance.FScrollNextIcon)&&t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,!0,!1,!0,!1),this.FScrollButtonNextDisabled?this.DoAfterDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),4,3):this.DoAfterDrawMenuButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),4,this.FScrollButtonNextState))}},this.HandleMouseDown=function(e,i,s,n){var o=t.TTMSFNCTabSetDisplayTab.$new(),r=t.TTMSFNCTabSetDisplayTab.$new();pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),1!==e&&(this.FDownX=s,this.FDownY=n,this.FDownCount=0,this.FDragDownX=s,this.FDragDownY=n,this.CaptureEx(),!this.FDblClicked&&(this.CanFocus()&&this.SetFocus(),this.FInplaceEditorActive&&(this.CloseInplaceEditor(!1),this.FInplaceEditorActive))||(this.FDblClicked=!1,o.$assign(this.XYToTab(s,n,null)),r.$assign(this.XYToCloseTab(s,n)),null!=r.Tab?this.FDownCloseTab=r.Tab:null==o.Tab||this.XYToScrollNextButton(s,n)||this.XYToScrollPreviousButton(s,n)?(this.SaveButtonState(),this.ClearButtonState(),this.HandleButtonDownState(s,n),this.IsButtonStateDown()&&this.StartDownTimer()):(this.FTabAnchor=this.XYToAnchor(t.TTMSFNCTabSetDisplayTab.$clone(o),s,n),""===this.FTabAnchor&&o.Tab.FEnabled&&(this.FDownTab=o.Tab,this.FDragTabDisplay.$assign(this.GetDisplayTab(this.FDownTab.GetIndex())),this.FOrigRect$1.$assign(this.FDragTabDisplay.Rect))),this.Invalidate()))},this.HandleMouseMove=function(e,i,s){var n=t.TTMSFNCTabSetDisplayTab.$new(),o=t.TTMSFNCTabSetDisplayTab.$new(),r=0,a=!1,l=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),null==this.FDownTab&&null==this.FDownCloseTab)n.$assign(this.XYToTab(i,s,null)),this.FPrevHoverTab=this.FHoverTab,this.FHoverTab=n.Tab,null==this.FHoverTab||this.XYToScrollNextButton(i,s)||this.XYToScrollPreviousButton(i,s)?this.IsButtonStateDown()||(this.SetControlCursor(0),this.FPrevHoverCloseTab=null,this.FHoverCloseTab=null,this.SaveButtonState(),this.ClearButtonState(),this.HandleButtonHoverState(i,s)):(o.$assign(this.XYToCloseTab(i,s)),this.FPrevHoverCloseTab=this.FHoverCloseTab,this.FHoverCloseTab=o.Tab,null==this.FHoverCloseTab&&(""!==this.XYToAnchor(t.TTMSFNCTabSetDisplayTab.$clone(n),i,s)&&this.FHoverTab.IsHTML()?this.SetControlCursor(21):this.SetControlCursor(0))),this.FHoverTab!==this.FPrevHoverTab&&this.CancelHint(),(this.FHoverTab!==this.FPrevHoverTab||this.FPrevHoverCloseTab!==this.FHoverCloseTab||this.IsButtonStateChanged()&&!this.IsButtonStateDown())&&this.Invalidate();else if(null==this.FDownCloseTab&&this.FInteraction.FReorder&&(Math.abs(this.FDownX-i)>3||Math.abs(this.FDownY-s)>3)){this.FDragTab=this.FDownTab,l.$assign(this.GetTabRect());var h=this.FLayout.FPosition;1===h||2===h?(r=i-this.FDragDownX,this.FOrigRect$1.Left+r<l.Left?r=l.Left-this.FOrigRect$1.Left:this.FOrigRect$1.Right+r>l.Right&&(r=l.Right-this.FOrigRect$1.Right),this.FDragTabDisplay.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FOrigRect$1.Left+r,this.FOrigRect$1.Top,this.FOrigRect$1.Right+r,this.FOrigRect$1.Bottom))):0!==h&&3!==h||(r=s-this.FDragDownY,this.FOrigRect$1.Top+r<l.Top?r=l.Top-this.FOrigRect$1.Top:this.FOrigRect$1.Bottom+r>l.Bottom&&(r=l.Bottom-this.FOrigRect$1.Bottom),this.FDragTabDisplay.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FOrigRect$1.Left,this.FOrigRect$1.Top+r,this.FOrigRect$1.Right,this.FOrigRect$1.Bottom+r))),this.CalculateRects(this.FDragTabDisplay),a=!1;var F=this.FLayout.FPosition;1===F||2===F?(this.FDownX=i,i>l.Right-10&&this.HandleScrollNext({get:function(){return a},set:function(t){a=t}},!1),i<l.Left+10&&this.HandleScrollPrevious({get:function(){return a},set:function(t){a=t}},!1)):0!==F&&3!==F||(this.FDownY=s,s<l.Top+10&&this.HandleScrollNext({get:function(){return a},set:function(t){a=t}},!1),s>l.Bottom-10&&this.HandleScrollPrevious({get:function(){return a},set:function(t){a=t}},!1)),a?this.UpdateTabs(!1,!1):(this.Invalidate(),this.DoInvalidate())}},this.HandleDblClick=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleDblClick.apply(this,arguments),this.FDblClicked=!0},this.HandleMouseUp=function(i,s,n,o){var r=t.TTMSFNCTabSetDisplayTab.$new(),a=t.TTMSFNCTabSetDisplayTab.$new(),l=null,h=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),F=!1,p=null;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),l=null,F=!1,null!=this.FDragTab){var c=this.FLayout.FPosition;1===c||2===c?r.$assign(this.XYToTab(n,this.FDragTabDisplay.Rect.Top+(this.FDragTabDisplay.Rect.Bottom-this.FDragTabDisplay.Rect.Top)/2,this.FDragTab)):0!==c&&3!==c||r.$assign(this.XYToTab(this.FDragTabDisplay.Rect.Left+(this.FDragTabDisplay.Rect.Right-this.FDragTabDisplay.Rect.Left)/2,o,this.FDragTab))}else r.$assign(this.XYToTab(n,o,null)),a.$assign(this.XYToCloseTab(n,o));this.ReleaseCaptureEx(),null!=this.FDragTab?(this.HandleDragTab(this.FDragTab,r.Tab),F=!0):""!==this.FTabAnchor&&null!=r.Tab&&""!==this.XYToAnchor(t.TTMSFNCTabSetDisplayTab.$clone(r),n,o)?this.DoAnchorTabClick(r.Tab.GetIndex(),this.FTabAnchor):(this.FUpdateCount$1+=1,null!=this.FDownCloseTab&&this.FDownCloseTab===a.Tab?this.HandleCloseTab(this.FDownCloseTab,{get:function(){return F},set:function(t){F=t}}):null!=this.FDownTab&&this.FDownTab===this.FInsertTab?l=this.HandleInsertTab({get:function(){return F},set:function(t){F=t}}):null!=this.FDownTab&&this.FDownTab===r.Tab?(p=this.FActiveTab)===this.FDownTab&&this.FInteraction.FEditing?this.HandleTabEditing(t.TTMSFNCTabSetDisplayTab.$clone(r)):(this.FFocusedTab=this.FDownTab,this.HandleChangeTab(this.FDownTab),F=2===this.FLayout.FMultiline&&p!==this.FActiveTab&&-1!==this.GetActiveTabIndex()):2===this.FTabListButtonState&&this.XYToTabListButton(n,o)?(this.FillTabList(),h.$assign(this.GetTabListButtonRect()),this.FTabListPopup.SetPlacementControl(this),this.FTabListPopup.FPlacementRectangle.SetLeft(h.Left),this.FTabListPopup.FPlacementRectangle.SetTop(h.Top),this.FTabListPopup.FPlacementRectangle.SetRight(h.Right),this.FTabListPopup.FPlacementRectangle.SetBottom(h.Bottom),this.FTabListPopup.Popup(!1)):2===this.FCloseButtonState&&this.XYToCloseButton(n,o)?this.HandleCloseTab(this.FActiveTab,{get:function(){return F},set:function(t){F=t}}):2===this.FInsertButtonState&&this.XYToInsertButton(n,o)?l=this.HandleInsertTab({get:function(){return F},set:function(t){F=t}}):2===this.FScrollButtonPreviousState&&this.XYToScrollPreviousButton(n,o)?this.HandleScrollPrevious({get:function(){return F},set:function(t){F=t}},!0):2===this.FScrollButtonNextState&&this.XYToScrollNextButton(n,o)&&this.HandleScrollNext({get:function(){return F},set:function(t){F=t}},!0)),this.StopDownTimer(),this.FTabAnchor="",this.FDragTab=null,this.FDragTabDisplay.$assign(e.EmptyDisplayTab()),this.FDownTab=null,this.FHoverTab=null,this.FDownCloseTab=null,this.FHoverCloseTab=null,this.ClearButtonState(),this.FUpdateCount$1-=1,F&&this.UpdateTabs(!1,!1),null!=l&&this.FInteraction.FSelectTabOnInsert?this.HandleChangeTab(l):F||this.Invalidate()},this.HandleMouseEnter=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseEnter.call(this),this.Invalidate()},this.HandleMouseLeave=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),this.ClearButtonState(),this.FHoverTab=null,this.FDownTab=null,this.FHoverCloseTab=null,this.FDownCloseTab=null,this.Invalidate()},this.DoExit=function(){pas["WEBLib.Controls"].TControl.DoExit.call(this),this.FInplaceEditorActive&&this.CloseInplaceEditor(!1),this.Invalidate()},this.DoEnter=function(){pas["WEBLib.Controls"].TControl.DoEnter.call(this),this.Invalidate()},this.UpdateControlAfterResize=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.UpdateControlAfterResize.call(this),this.UpdateTabs(!1,!1)},this.StartDownTimer=function(){this.FDownTimer.SetEnabled(!this.IsDesignTime())},this.StopDownTimer=function(){this.FDownTimer.SetEnabled(!1)},this.HandleKeyDown=function(t,e){var i=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyDown.apply(this,arguments),!this.FInplaceEditorClosed){var s=t.get();37===s||38===s?this.FocusPreviousTab(this.FInteraction.FSelectTabOnFocus):39===s||40===s?this.FocusNextTab(this.FInteraction.FSelectTabOnFocus):36===s?(i=this.GetFirstScrollableTabIndex(),this.IsTabVisible(i)&&this.IsTabEnabled(i)?this.FocusTab(i,this.FInteraction.FSelectTabOnFocus):(i>=0&&i<this.FTabs.GetCount()-1&&(this.FFocusedTab=this.FTabs.GetTab(i)),this.FocusNextTab(this.FInteraction.FSelectTabOnFocus))):35===s&&(i=this.GetLastScrollableTabIndex(),this.IsTabVisible(i)&&this.IsTabEnabled(i)?this.FocusTab(i,this.FInteraction.FSelectTabOnFocus):(i>=0&&i<this.FTabs.GetCount()-1&&(this.FFocusedTab=this.FTabs.GetTab(i)),this.FocusPreviousTab(this.FInteraction.FSelectTabOnFocus)))}},this.HandleDialogKey=function(t,e){this.FInplaceEditorClosed||null!=this.FInplaceEditor&&this.FInplaceEditorActive&&(27===t.get()||9===t.get()||113===t.get()||pas["WEBLib.StdCtrls"].TEdit.isPrototypeOf(this.FInplaceEditor)&&13===t.get())&&(this.FCloseWithDialogKey=!0,this.CloseInplaceEditor(27===t.get())),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleDialogKey.apply(this,arguments)},this.HandleKeyUp=function(e,i){var s=t.TTMSFNCTabSetDisplayTab.$new(),n=!1,o=!1,r=null;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyUp.apply(this,arguments),this.FInplaceEditorClosed)this.FInplaceEditorClosed=!1;else if(this.FCloseWithDialogKey)this.FCloseWithDialogKey=!1;else{o=!1,n=!1,r=null;var a=e.get();if(13===a||32===a?this.FInteraction.FSelectTabOnFocus||null==this.FFocusedTab||this.FFocusedTab===this.FActiveTab||(this.HandleChangeTab(this.FFocusedTab),n=!0):45===a&&this.FInteraction.FInsertTabWithKeyboard&&(r=this.HandleInsertTab({get:function(){return o},set:function(t){o=t}})),null!=this.FFocusedTab&&!n){var l=e.get();46===l?this.FInteraction.FCloseTabWithKeyboard&&this.HandleCloseTab(this.FFocusedTab,{get:function(){return o},set:function(t){o=t}}):113!==l&&13!==l||this.IsTabEnabled(this.FFocusedTab.GetIndex())&&this.FInteraction.FEditing&&(s.$assign(this.GetDisplayTab(this.FFocusedTab.GetIndex())),this.HandleTabEditing(t.TTMSFNCTabSetDisplayTab.$clone(s)))}o&&this.UpdateTabs(!1,!1),null!=r&&this.FInteraction.FSelectTabOnInsert?this.HandleChangeTab(r):o||this.Invalidate()}},this.HandleMouseWheel=function(t,e,i){var s=!1;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseWheel.apply(this,arguments),this.IsFocused()&&(s=!1,e>0?this.HandleScrollNext({get:function(){return s},set:function(t){s=t}},!0):this.HandleScrollPrevious({get:function(){return s},set:function(t){s=t}},!0),s&&this.UpdateTabs(!1,!1))},this.HandleCloseTab=function(t,e){var i,s=0,n=0,o=!1,r=!1,a=null;if(null!=t&&(s=this.FOptions.FCloseAction,i=t.GetIndex(),this.DoBeforeCloseTab(t.GetIndex(),{get:function(){return s},set:function(t){s=t}}),0!==s)){var l=s;1===l?(o=(n=t.GetIndex())===this.FActiveTabIndex,this.FUpdateCount$1+=1,t=rtl.freeLoc(t),e.set(!0),this.FUpdateCount$1-=1,n<=this.FActiveTabIndex&&(this.FActiveTabIndex=Math.max(0,this.FActiveTabIndex-1)),this.FActiveTabIndex>=0&&this.FActiveTabIndex<=this.FTabs.GetCount()-1?this.IsTabEnabled(this.FActiveTabIndex)&&this.IsTabVisible(this.FActiveTabIndex)||this.SelectNextSequentialTab():(this.FActiveTabIndex=-1,this.FActiveTab=null,this.FFocusedTab=null),o&&(r=!0,this.FActiveTabIndex>=0&&this.FActiveTabIndex<=this.FTabs.GetCount()-1&&((a=this.FTabs.GetTab(this.FActiveTabIndex)).FEnabled&&a.FVisible?(this.DoBeforeChangeTab(n,a.GetIndex(),{get:function(){return r},set:function(t){r=t}}),r&&(this.FActiveTab=a,this.FActiveTabIndex=this.FActiveTab.GetIndex(),this.FFocusedTab=this.FActiveTab,this.FTabChanging=!0,this.DoChangeTab(n,this.FActiveTab.GetIndex()),this.FTabChanging=!1)):(this.FTabChanging=!0,this.DoChangeTab(n,this.FActiveTabIndex),this.FTabChanging=!1)))):2===l&&(t.SetVisible(!1),this.FActiveTabIndex===t.GetIndex()&&(this.SelectNextSequentialTab(),this.FActiveTabIndex>=0&&this.FActiveTabIndex<=this.FTabs.GetCount()-1&&this.GetNormalDisplayCount()>0?this.HandleChangeTab(this.FTabs.GetTab(this.FActiveTabIndex)):this.HandleChangeTab(null)),e.set(!0)),this.DoCloseTab(i,s)}},this.HandleDragTab=function(t,e){var i=!1,s=0;null!=t&&null!=e&&(i=!0,this.DoBeforeReorderTab(t.GetIndex(),e.GetIndex(),{get:function(){return i},set:function(t){i=t}}),i&&(s=this.FDragTab.GetIndex(),t.SetIndex(e.GetIndex()),null!=this.FActiveTab&&(this.FActiveTabIndex=this.FActiveTab.GetIndex()),this.DoReorderTab(s,t.GetIndex())))},this.HandleChangeTab=function(t){var e=!1,i=0,s=0;this.FPrevTab=this.FActiveTab,this.FPrevTab!==t&&(null!=t&&this.IsTabVisible(t.GetIndex())&&this.IsTabEnabled(t.GetIndex())||null==t)&&(i=null!=this.FPrevTab?this.FPrevTab.GetIndex():-1,s=null!=t?t.GetIndex():-1,e=!0,this.DoBeforeChangeTab(i,s,{get:function(){return e},set:function(t){e=t}}),e&&(this.FActiveTab=t,this.FFocusedTab=t,this.FActiveTabIndex=s,this.FTabChanging=!0,this.DoChangeTab(i,s),this.FTabChanging=!1,2===this.FLayout.FMultiline&&-1!==this.GetActiveTabIndex()?this.UpdateTabs(!1,!1):this.ScrollToTab(this.FActiveTabIndex)))},this.HandleTabEditing=function(e){var i=!1,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas.Types.TRect.$new();if(null!=e.Tab&&(this.FInplaceEditorClass=t.TTMSFNCTabSetEdit,i=!0,this.DoBeforeOpenInplaceEditor(e.Index,{get:function(){return i},set:function(t){i=t}}),i)){if(this.DoGetInplaceEditor(e.Tab.GetIndex(),{p:this,get:function(){return this.p.FInplaceEditorClass},set:function(t){this.p.FInplaceEditorClass=t}}),null!=this.FInplaceEditor&&(rtl.free(this,"FInplaceEditor"),this.FInplaceEditor=null),null!=this.FInplaceEditorClass?this.FInplaceEditor=this.FInplaceEditorClass.$create("Create$1",[this]):this.FInplaceEditor=t.TTMSFNCTabSetEdit.$create("Create$1",[this]),s.$assign(this.GetInplaceEditorRect(t.TTMSFNCTabSetDisplayTab.$clone(e))),null!=this.FInplaceEditor){this.FUpdateTab.$assign(e),this.FInplaceEditor.SetShowFocus(!1),this.FInplaceEditor.SetParent(this),this.FInplaceEditor.SetVisible(!1),n.$assign(pas.Types.Rect(Math.round(s.Left),Math.round(s.Top),Math.round(s.Right),Math.round(s.Bottom))),this.FInplaceEditor.SetBoundsRect(n),this.FInplaceEditor.SetBoundsRect(pas.Types.Rect(n.Left,n.Top+rtl.trunc((n.Bottom-n.Top-this.FInplaceEditor.GetHeight())/2),n.Right,n.Top+rtl.trunc((n.Bottom-n.Top-this.FInplaceEditor.GetHeight())/2)+this.FInplaceEditor.GetHeight())),this.FInplaceEditor.SetVisible(!0),this.CustomizeInplaceEditor(this.FInplaceEditor,t.TTMSFNCTabSetDisplayTab.$clone(e));try{e.Tab.FText}finally{}this.FInplaceEditor.CanFocus()&&this.FInplaceEditor.SetFocus(),pas["WEBLib.StdCtrls"].TEdit.isPrototypeOf(this.FInplaceEditor)&&rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TEdit).SetSelStart(rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TEdit).GetText().length),this.FInplaceEditorActive=!0,this.Invalidate()}this.DoOpenInplaceEditor(e.Tab.GetIndex(),this.FInplaceEditor,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s))}},this.CustomizeInplaceEditor=function(t,e){null!=e.Tab&&null!=t&&null!=this.FOnCustomizeInplaceEditor&&this.FOnCustomizeInplaceEditor(this,e.Tab.GetIndex(),this.FInplaceEditor)},this.SelectNextSequentialTab=function(){var t=0,e=0,i=!1;if(!(this.FActiveTabIndex<0)){for(i=!1,t=this.FActiveTabIndex,e=1;e<this.FTabs.GetCount()&&!((t+=1)>=this.FTabs.GetCount());){if(this.FActiveTabIndex!==t&&this.IsTabVisible(t)&&this.IsTabEnabled(t)){this.FActiveTabIndex=t,i=!0;break}e+=1}if(!i)for(t=this.FActiveTabIndex,e=1;e<this.FTabs.GetCount()&&!((t-=1)>=this.FTabs.GetCount())&&!(t<0);){if(this.FActiveTabIndex!==t&&this.IsTabVisible(t)&&this.IsTabEnabled(t)){this.FActiveTabIndex=t;break}e+=1}}},this.AnimateTimerChanged=function(e){var i=0,s=t.TTMSFNCTabSetDisplayTab.$new(),n=!1;n=!1;for(var o=0,r=this.GetDisplayCount()-1;o<=r;o++)i=o,s.$assign(this.FDisplayList.GetItem(i)),null!=s.Tab&&(n||1!==s.Tab.FProgressMode||0===s.Tab.FProgressKind||(n=!0),s.Tab.FAnimMarqueeSwitch?(s.Tab.FAnimMarqueeStartAngle=s.Tab.FAnimMarqueeStartAngle+5,s.Tab.FAnimMarqueeSweepAngle=s.Tab.FAnimMarqueeSweepAngle-5):s.Tab.FAnimMarqueeSweepAngle=s.Tab.FAnimMarqueeSweepAngle+5,360===s.Tab.FAnimMarqueeSweepAngle&&0===s.Tab.FAnimMarqueeStartAngle?s.Tab.FAnimMarqueeSwitch=!0:360===s.Tab.FAnimMarqueeStartAngle&&0===s.Tab.FAnimMarqueeSweepAngle&&(s.Tab.FAnimMarqueeSwitch=!1,s.Tab.FAnimMarqueeStartAngle=0));n&&this.Invalidate(),this.FAnimTimer.SetEnabled(n)},this.DownTimerChanged=function(t){var e=!1;this.FDownCount+=1,this.FDownCount>3&&(e=!1,2!==this.FScrollButtonNextState||this.FScrollButtonNextDisabled||this.HandleScrollNext({get:function(){return e},set:function(t){e=t}},!0),2!==this.FScrollButtonPreviousState||this.FScrollButtonPreviousDisabled||this.HandleScrollPrevious({get:function(){return e},set:function(t){e=t}},!0),e&&this.UpdateTabs(!1,!1))},this.HandleScrollNext=function(t,e){var i=0;this.FInteraction.FSelectTabOnScroll&&e?this.SelectNextTab():(i=this.FStartTab,this.FStartTab<this.FScrollCount&&(this.FStartTab+=1),!this.IsTabVisible(this.FStartTab)&&this.FStartTab<this.GetLastScrollableTabIndex()&&(this.FStartTab=this.GetNextTab(this.FStartTab)),t.set(i!==this.FStartTab))},this.HandleScrollPrevious=function(t,e){var i=0;this.FInteraction.FSelectTabOnScroll&&e?this.SelectPreviousTab():(i=this.FStartTab,this.FStartTab>0&&(this.FStartTab-=1),!this.IsTabVisible(this.FStartTab)&&this.FStartTab>this.GetFirstScrollableTabIndex()&&(this.FStartTab=this.GetPreviousTab(this.FStartTab)),t.set(i!==this.FStartTab))},this.DoBeforeOpenInplaceEditor=function(t,e){null!=this.FOnBeforeOpenInplaceEditor&&this.FOnBeforeOpenInplaceEditor(this,t,e)},this.DoOpenInplaceEditor=function(t,e,i){null!=this.FOnOpenInplaceEditor&&this.FOnOpenInplaceEditor(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i))},this.DoBeforeUpdateTab=function(t,e,i){null!=this.FOnBeforeUpdateTab&&this.FOnBeforeUpdateTab(this,t,e,i)},this.DoUpdateTab=function(t){null!=this.FOnUpdateTab&&this.FOnUpdateTab(this,t)},this.DoCloseInplaceEditor=function(t,e,i,s){null!=this.FOnCloseInplaceEditor&&this.FOnCloseInplaceEditor(this,t,e,i,s)},this.DoGetInplaceEditor=function(t,e){null!=this.FOnGetInplaceEditor&&this.FOnGetInplaceEditor(this,t,e)},this.SetFonts=function(t){var e=0;if(this.BeginUpdate(),this.FGlobalFont.ApplyChange(this.FTabAppearance.FFont,t),this.FGlobalFont.ApplyChange(this.FTabAppearance.FBadgeFont,t),1===t){this.FTabAppearance.SetTextColor(this.FGlobalFont.FColor),this.FTabAppearance.SetHoverTextColor(this.FGlobalFont.FColor),this.FTabAppearance.SetActiveTextColor(this.FGlobalFont.FColor),this.FTabAppearance.SetDownTextColor(this.FGlobalFont.FColor);for(var i=0,s=this.FTabs.GetCount()-1;i<=s;i++)e=i,this.FTabs.GetTab(e).SetTextColor(this.FGlobalFont.FColor),this.FTabs.GetTab(e).SetHoverTextColor(this.FGlobalFont.FColor),this.FTabs.GetTab(e).SetActiveTextColor(this.FGlobalFont.FColor),this.FTabs.GetTab(e).SetDownTextColor(this.FGlobalFont.FColor)}this.EndUpdate()},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FInsertTab=t.TTMSFNCTabSetTab.$create("Create$1",[null]),this.FInsertTab.SetCloseButton(!1),this.FInsertTab.SetTextVisible(!1),this.FInsertTab.SetText(""),this.FInsertTab.SetProgressKind(0),this.FActiveTabIndex=0,this.FAnimTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FAnimTimer.SetEnabled(!1),this.FAnimTimer.SetInterval(1),this.FAnimTimer.FOnTimer=rtl.createCallback(this,"AnimateTimerChanged"),this.FDownTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FDownTimer.SetEnabled(!1),this.FDownTimer.SetInterval(100),this.FDownTimer.FOnTimer=rtl.createCallback(this,"DownTimerChanged"),this.FDisplayList=t.TTMSFNCTabSetDisplayList.$create("Create$1"),this.FInvisibleTabList=t.TTMSFNCTabSetInvisibleTabList.$create("Create$1"),this.FTabs=this.CreateTabs(),this.FTabSize=t.TTMSFNCTabSetTabSize.$create("Create$1",[this]),this.FTabAppearance=t.TTMSFNCTabSetTabAppearance.$create("Create$1",[this]),this.FButtonAppearance=t.TTMSFNCTabSetButtonAppearance.$create("Create$1",[this]),this.FInteraction=t.TTMSFNCTabSetInteraction.$create("Create$1",[this]),this.FOptions=t.TTMSFNCTabSetOptions.$create("Create$1",[this]),this.FLayout=t.TTMSFNCTabSetLayout.$create("Create$1",[this]),this.FStartTab=0,this.FAllowScrolling=!0,this.FInsertTab.FBitmaps.AddBitmap(this.FButtonAppearance.FInsertIcon,1),this.FInsertTab.FDisabledBitmaps.AddBitmap(this.FButtonAppearance.FInsertIcon,1),this.FInsertTab.FTabSet=this,this.FTabListPopup=pas["WEBLib.TMSFNCPopup"].TTMSFNCPopup.$create("Create$1",[this]),this.FTabList=pas["WEBLib.StdCtrls"].TListBox.$create("Create$1",[this.FTabList]),this.FTabList.FOnClick=rtl.createCallback(this,"PopupListSelected"),this.FTabListPopup.SetContentControl(this.FTabList),this.FTabListPopup.FFocusedControl=this.FTabList,this.FTabListPopup.SetPlacement(0),this.FTabListPopup.SetDropDownHeight(125),this.FTabListPopup.SetDropDownWidth(100),this.FGlobalFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCAppearanceGlobalFont.$create("Create$1",[this]),this},this.Destroy=function(){rtl.free(this,"FGlobalFont"),rtl.free(this,"FAnimTimer"),rtl.free(this,"FTabList"),rtl.free(this,"FTabListPopup"),rtl.free(this,"FInsertTab"),rtl.free(this,"FTabSize"),rtl.free(this,"FTabs"),rtl.free(this,"FTabAppearance"),rtl.free(this,"FButtonAppearance"),rtl.free(this,"FInteraction"),rtl.free(this,"FOptions"),rtl.free(this,"FLayout"),rtl.free(this,"FInvisibleTabList"),rtl.free(this,"FDisplayList"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.XYToTab=function(i,s,n){var o=t.TTMSFNCTabSetDisplayTab.$new(),r=0,a=t.TTMSFNCTabSetDisplayTab.$new(),l=null,h=!1;h=!1,o.$assign(e.EmptyDisplayTab());for(var F=this.GetDisplayCount()-1;F>=0&&(r=F,a.$assign(this.FDisplayList.GetItem(r)),null==a.Tab||a.Tab===n||(null!=(l=a.Tab===this.FInsertTab?a.Tab.GetInsertShapePath(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a.Rect)):a.Tab.GetShapePath(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(a.Rect)))&&(pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.PointInPath(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i,s)),l)&&(o.$assign(a),h=!0),l=rtl.freeLoc(l)),!h));F--);return o},this.XYToCloseTab=function(i,s){var n=t.TTMSFNCTabSetDisplayTab.$new(),o=0,r=t.TTMSFNCTabSetDisplayTab.$new();if(n.$assign(e.EmptyDisplayTab()),1!==this.FOptions.FCloseMode)return n;for(var a=this.GetDisplayCount()-1;a>=0;a--)if(o=a,r.$assign(this.FDisplayList.GetItem(o)),null!=r.Tab&&r.Tab.FCloseButton&&pas["WEBLib.TMSFNCTypes"].PtInRectEx(r.CloseButtonRect,pas["WEBLib.TMSFNCTypes"].PointF(i,s))){n.$assign(r);break}return n},this.XYToScrollNextButton=function(t,e){return this.FShowScrollButtons&&!this.FScrollButtonNextDisabled&&pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetScrollButtonNextRect(),pas["WEBLib.TMSFNCTypes"].PointF(t,e))},this.XYToScrollPreviousButton=function(t,e){return this.FShowScrollButtons&&!this.FScrollButtonPreviousDisabled&&pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetScrollButtonPreviousRect(),pas["WEBLib.TMSFNCTypes"].PointF(t,e))},this.XYToCloseButton=function(t,e){return this.FShowCloseButton&&pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetCloseButtonRect(),pas["WEBLib.TMSFNCTypes"].PointF(t,e))},this.XYToInsertButton=function(t,e){return this.FShowInsertButton&&pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetInsertButtonRect(),pas["WEBLib.TMSFNCTypes"].PointF(t,e))},this.XYToTabListButton=function(t,e){return this.FShowTabListButton&&pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetTabListButtonRect(),pas["WEBLib.TMSFNCTypes"].PointF(t,e))},this.IsTabVisible=function(t){var e=!1;return e=!1,t>=0&&t<=this.FTabs.GetCount()-1&&(e=this.FTabs.GetTab(t).FVisible),e},this.IsTabEnabled=function(t){var e=!1;return e=!1,t>=0&&t<=this.FTabs.GetCount()-1&&(e=this.FTabs.GetTab(t).FEnabled),e},this.Assign=function(e){t.TTMSFNCCustomTabSet.isPrototypeOf(e)&&(this.FTabSize.Assign(rtl.as(e,t.TTMSFNCCustomTabSet).FTabSize),this.FTabAppearance.Assign(rtl.as(e,t.TTMSFNCCustomTabSet).FTabAppearance),this.FInteraction.Assign(rtl.as(e,t.TTMSFNCCustomTabSet).FInteraction),this.FOptions.Assign(rtl.as(e,t.TTMSFNCCustomTabSet).FOptions),this.FLayout.Assign(rtl.as(e,t.TTMSFNCCustomTabSet).FLayout),this.FTabs.Assign(rtl.as(e,t.TTMSFNCCustomTabSet).FTabs))},this.BeginUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.BeginUpdate.call(this),this.FUpdateCount$1+=1},this.EndUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.EndUpdate.call(this),this.FUpdateCount$1-=1,0===this.FUpdateCount$1&&this.UpdateTabs(!1,!1)},this.SelectNextTab=function(){var t=0,e=0;if(!(this.FActiveTabIndex<0)){for(t=this.FActiveTabIndex,e=1;e<this.FTabs.GetCount();){if((t+=1)>=this.FTabs.GetCount()&&(t=0),this.FActiveTabIndex!==t&&this.IsTabVisible(t)&&this.IsTabEnabled(t)){this.FActiveTabIndex=t;break}e+=1}this.FActiveTabIndex>=0&&this.FActiveTabIndex<=this.FTabs.GetCount()-1&&(this.HandleChangeTab(this.FTabs.GetTab(this.FActiveTabIndex)),0===this.FUpdateCount$1&&this.Invalidate())}},this.SelectPreviousTab=function(){var t=0,e=0;if(!(this.FActiveTabIndex<0)){for(t=this.FActiveTabIndex,e=1;e<this.FTabs.GetCount();){if((t-=1)>=this.FTabs.GetCount()&&(t=0),t<0&&(t=this.FTabs.GetCount()-1),this.FActiveTabIndex!==t&&this.IsTabVisible(t)&&this.IsTabEnabled(t)){this.FActiveTabIndex=t;break}e+=1}this.FActiveTabIndex>=0&&this.FActiveTabIndex<=this.FTabs.GetCount()-1&&(this.HandleChangeTab(this.FTabs.GetTab(this.FActiveTabIndex)),0===this.FUpdateCount$1&&this.Invalidate())}},this.ScrollToTab=function(t){if(2!==this.FTabSize.FMode&&this.FAllowScrolling&&0===this.FLayout.FMultiline&&this.FScrollCount>0&&t>=0&&t<=this.FTabs.GetCount()-1&&this.IsTabVisible(t))if(t>this.FLastTabIndex||t<this.FFirstTabIndex){if(this.FStartTab=Math.max(0,t-this.GetNormalDisplayCount()-this.GetInvisibleTabCount()),this.UpdateTabs(!1,!0),t>this.FLastTabIndex)for(;this.FLastTabIndex<t;)this.FStartTab+=1,this.IsTabVisible(this.FStartTab)||(this.FStartTab=this.GetNextTab(this.FStartTab)),this.UpdateTabs(!1,!0);else if(t<this.FFirstTabIndex)for(;this.FFirstTabIndex>t;)this.FStartTab-=1,this.IsTabVisible(this.FStartTab)||(this.FStartTab=this.GetPreviousTab(this.FStartTab)),this.UpdateTabs(!1,!0)}else this.InitializeScrollButtonState(),this.Invalidate();else this.Invalidate()},this.CloseInplaceEditor=function(t){var e="",i=!1,s=!1,n="";if(!this.FClosing){if(this.FClosing=!0,null!=this.FUpdateTab.Tab&&null!=this.FInplaceEditor){if(!t)try{n="",pas["WEBLib.StdCtrls"].TEdit.isPrototypeOf(this.FInplaceEditor)&&(e=rtl.as(this.FInplaceEditor,pas["WEBLib.StdCtrls"].TEdit).GetText()),n=e}finally{}s=!0,this.DoCloseInplaceEditor(this.FUpdateTab.Tab.GetIndex(),this.FInplaceEditor,t,{get:function(){return s},set:function(t){s=t}}),s&&(i=!0,this.DoBeforeUpdateTab(this.FUpdateTab.Tab.GetIndex(),{get:function(){return n},set:function(t){n=t}},{get:function(){return i},set:function(t){i=t}}),i&&!t&&(this.FUpdateCount$1+=1,null!=this.FUpdateTab.Tab&&this.FUpdateTab.Tab.SetText(n),this.FUpdateCount$1-=1,this.DoUpdateTab(this.FUpdateTab.Tab.GetIndex())),this.FInplaceEditor.SetParent(null),rtl.free(this,"FInplaceEditor"),this.FInplaceEditor=null,this.FInplaceEditorActive=!1),s&&(this.UpdateTabs(!1,!1),this.CanFocus()&&this.SetFocus())}this.FClosing=!1}},this.FocusNextTab=function(t){var e=0,i=0,s=0;if(null!=this.FFocusedTab){for(e=s=this.FFocusedTab.GetIndex(),i=1;i<this.FTabs.GetCount();){if((e+=1)>=this.FTabs.GetCount()&&(e=0),s!==e&&this.IsTabVisible(e)&&this.IsTabEnabled(e)){s=e;break}i+=1}s>=0&&s<=this.FTabs.GetCount()-1&&(this.FFocusedTab=this.FTabs.GetTab(s),t?this.HandleChangeTab(this.FFocusedTab):this.ScrollToTab(s))}},this.FocusPreviousTab=function(t){var e=0,i=0,s=0;if(null!=this.FFocusedTab){for(e=s=this.FFocusedTab.GetIndex(),i=1;i<this.FTabs.GetCount();){if((e-=1)>=this.FTabs.GetCount()&&(e=0),e<0&&(e=this.FTabs.GetCount()-1),s!==e&&this.IsTabVisible(e)&&this.IsTabEnabled(e)){s=e;break}i+=1}s>=0&&s<=this.FTabs.GetCount()-1&&(this.FFocusedTab=this.FTabs.GetTab(s),t?this.HandleChangeTab(this.FFocusedTab):this.ScrollToTab(s))}},this.FocusTab=function(t,e){t>=0&&t<=this.FTabs.GetCount()-1&&this.IsTabVisible(t)&&(this.FFocusedTab=this.FTabs.GetTab(t),e?this.HandleChangeTab(this.FFocusedTab):this.ScrollToTab(t))},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),this.TMSFNCTABSETLIST="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAJCAYAAAD+WDajAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOvwAADr8BOAVTJAAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4zjOaXUAAAACpJREFUKFNjwAvCwsL+48IM///jxvh1YhOEYZz2giVgAKcEDOCUwAQMDAAqj1EKDJG5XAAAAABJRU5ErkJggg==",this.TMSFNCTABSETCLOSE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuOWwzfk4AAABVSURBVDhPYxh+QBSI/0OYWAFIThjCxA5ACmAYHeCTQwHYFGITwwuQNSBjkgBFmkGAIgNAGv5BaZINQdYMA0Qbgk0zDBBlCCiR4FMAkhOCMIcJYGAAAHvVMBv6PIFYAAAAAElFTkSuQmCC",this.TMSFNCTABSETPREVIOUS="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAEpJREFUOI3lzKENgEAQAMEJBkkIDdDTSxp6gqMyCkB8IQgMFdwZAutn+U19Bi84MUbxhZrBawSXB+8RDDMaDkyvmQyZyYYuOvh6N24uDUKEV//MAAAAAElFTkSuQmCC",this.TMSFNCTABSETNEXT="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAFNJREFUOI3tzzsSQFAQRNFDqSezHUuwYBJLsBuhEomE4/ll3HBq+nY1PxENRrS5xzK4L1jPSiISesxPJcORJJqwU9xthjrX/ko4mpBQocN0tf1rbDeZDIfcSud0AAAAAElFTkSuQmCC",this.TMSFNCTABSETADD="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAALEAAACxABrSO9dQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC45bDN+TgAAAEtJREFUOE/dzEEKACAIRFHvf2nLhZDyI6VVBS9yahJVvYJhB4YdGLq5bJtHvjcYugc/8MJJ6IQhPdwJnXXIqJBh6D74oALDDgzrVAajy7VnCteJXAAAAABJRU5ErkJggg==",t.$implcode=function(){e.EmptyDisplayTab=function(){var e=t.TTMSFNCTabSetDisplayTab.$new();return e.Tab=null,e.ContentRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),e.BitmapRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),e.TextRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),e.ProgressRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),e.CloseButtonRect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),e.Rect.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),e.First=!1,e.Last=!1,e.Index=-1,e.Row=0,e}},t.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTABSETLIST),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTABSETCLOSE),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTABSETPREVIOUS),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTABSETNEXT),pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.CreateFromResource(t.TMSFNCTABSETADD)}}),["WEBLib.TMSFNCUtils","WEBLib.Forms","WEBLib.Graphics","SysUtils","Math","WEBLib.TMSFNCStyles"]),rtl.module("WEBLib.TMSFNCPageControl",["System","Classes","WEBLib.TMSFNCTabSet","WEBLib.TMSFNCPersistence","WEBLib.TMSFNCTypes","WEBLib.Controls","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCPopup","Types"],(function(){"use strict";var t=this,e=t.$impl;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=0,this.BLD_VER=6,rtl.createClass(this,"TTMSFNCPageControlContainer",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FIsDestroying=!1,this.FPage=null,this.FPageControl=null,this.FPageIndex=0,this.FIsActive=!1},this.$final=function(){this.FPage=void 0,this.FPageControl=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetPageControl=function(t){this.SetParent(t),this.FPageControl=t},this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCPageControlContainer)},this.SetParent=function(e){t.TTMSFNCCustomPageControl.isPrototypeOf(e)&&(this.FPageControl=rtl.as(e,t.TTMSFNCCustomPageControl)),pas["WEBLib.Controls"].TControl.SetParent.apply(this,arguments)},this.Create$1=function(t){return this.Create$8(t,null),this},this.Create$8=function(t,e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.call(this,t),this.FPage=e,null!=this.FPage&&null!=this.FPage.FPageControl&&(this.FTransparent=this.FPage.FPageControl.FTransparent,this.FBufferedPainting=this.FPage.FPageControl.FBufferedPainting),this},this.Destroy=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this),this.FPage=null},this.Draw=function(t,e){var i=null,s=pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetDisplayTab.$new(),n=null,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),!(3 in this.FComponentState)&&null!=this.FPage&&null!=this.FPage.FContainer&&this.FPage.FContainer===this&&(this.IsDesignTime()&&(t.FFont.SetHeight(this.ScalePaintValue(t.FFont.FHeight)),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetLocalRect()),this.FPage.GetFriendlyName(),!1,0,0,0,0,-1,-1,!0,!1,-1,-1)),null!=(i=this.FPage.PageControl())&&i.GetActivePage()===this.FPage&&(s.$assign(i.GetDisplayTab(this.FPage.GetIndex())),null!=s.Tab&&s.Tab===this.FPage))){if(n=s.Tab,null!=i.DragTabDisplay().Tab&&i.DragTabDisplay().Tab===this.FPage?o.$assign(n.GetFixedRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i.DragTabDisplay().Rect),pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetDisplayTab.$clone(i.DragTabDisplay()))):o.$assign(n.GetFixedRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s.Rect),pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetDisplayTab.$clone(s))),o.Right-o.Left<=0||o.Bottom-o.Top<=0)return;2===i.FTabAppearance.FActiveFill.FKind?t.FStroke.SetColor(i.FTabAppearance.FActiveFill.FColorTo):n.FUseDefaultAppearance?t.FStroke.SetColor(i.FTabAppearance.FActiveFill.FColor):t.FStroke.SetColor(n.FActiveColor),t.FStroke.SetWidth(t.FStroke.FWidth*pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(null,-1));var a=i.FLayout.FPosition;if(0===a||3===a){if(o.Top=o.Top+t.FStroke.FWidth,o.Bottom=o.Bottom-t.FStroke.FWidth,i.FCollapsed){var l=i.FLayout.FPosition;0===l?(o.Left=.5,o.Right=.5):3===l&&(o.Left=this.GetWidth()-.5,o.Right=this.GetWidth()-.5)}}else if((1===a||2===a)&&(o.Left=o.Left+t.FStroke.FWidth,o.Right=o.Right-t.FStroke.FWidth,i.FCollapsed)){var h=i.FLayout.FPosition;1===h?(o.Top=.5,o.Bottom=.5):2===h&&(o.Top=this.GetHeight()-.5,o.Bottom=this.GetHeight()-.5)}r=Math.round(4*pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(null,-1));var F=i.FLayout.FPosition;if(3===F){var p=n.GetShape();1===p?o.Top=o.Top+r:2===p?o.Bottom=o.Bottom-r:3===p&&(o.Top=o.Top+r,o.Bottom=o.Bottom-r),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Left-this.GetLeft(),o.Top-this.GetTop())),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Left-this.GetLeft(),o.Bottom-this.GetTop())),0,0)}else if(0===F){var c=n.GetShape();1===c?o.Bottom=o.Bottom-r:2===c?o.Top=o.Top+r:3===c&&(o.Top=o.Top+r,o.Bottom=o.Bottom-r),t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Right-this.GetLeft(),o.Top-this.GetTop())),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Right-this.GetLeft(),o.Bottom-this.GetTop())),0,0)}else if(1===F||2===F){var u=n.GetShape();1===u?o.Left=o.Left+r:2===u?o.Right=o.Right-r:3===u&&(o.Left=o.Left+r,o.Right=o.Right-r);var T=i.FLayout.FPosition;1===T?t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Left-this.GetLeft(),o.Bottom-this.GetTop())),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Right-this.GetLeft(),o.Bottom-this.GetTop())),0,0):2===T&&t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Left-this.GetLeft(),o.Top-this.GetTop())),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(o.Right-this.GetLeft(),o.Top-this.GetTop())),0,0)}}},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke")})),rtl.createClass(this,"TTMSFNCPageControlPage",pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTab,(function(){this.$init=function(){pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTab.$init.call(this),this.FContainer=null,this.FPageControl=null},this.$final=function(){this.FContainer=void 0,this.FPageControl=void 0,pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTab.$final.call(this)},this.UpdatePage=function(){null!=this.FPageControl&&this.FPageControl.UpdatePages()},this.GetFriendlyName=function(){var t="";return""===(t=this.GetStrippedHTMLText())&&(t="Page "+pas.SysUtils.IntToStr(this.GetIndex())),t},this.Create$1=function(e){var i=null;return pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTab.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FPageControl=rtl.as(this.FCollection,t.TTMSFNCPageControlPages).PageControl(),null==(i=this.PageControl())||i.IsReading()||i.IsLoading()||0 in i.FComponentState||(this.FContainer=i.GetContainerClass().$create("Create$8",[i.FOwner,this]),this.FContainer.SetPageControl(i),this.FContainer.SetAdaptToStyle(i.GetAdaptToStyle()),this.FContainer.SetTabStop(!1),i.IsDesigning()&&this.FContainer.SetName(i.FName+"Page"+pas.SysUtils.IntToStr(this.GetIndex())),this.FContainer.SetAlignWithMargins(!0),this.FContainer.SetAlign(5),this.FContainer.SetVisible(!1),i.UpdateMargins(this.FContainer),this.SetText(this.GetFriendlyName()))),null!=this.FPageControl&&(this.FPageControl.FUpdateMargins=!0,null!=this.FPageControl.FOnInternalInsertPage&&this.FPageControl.FOnInternalInsertPage(this)),this.UpdatePage(),this},this.Destroy=function(){null!=this.FContainer&&(this.FContainer.FIsDestroying=!0,null!=this.FPageControl&&this.FPageControl.FPrevActivePageContainer===this.FContainer&&(this.FPageControl.FPrevActivePageContainer=null),null==this.FContainer.FParent||null==this.FPageControl||this.FPageControl.IsDestroying()||rtl.free(this,"FContainer"),this.FContainer=null),pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTab.Destroy.call(this),null!=this.FPageControl&&(this.FPageControl.FUpdateMargins=!0),this.UpdatePage()},this.PageControl=function(){return this.FPageControl}})),rtl.createClass(this,"TTMSFNCPageControlPages",pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTabs,(function(){this.$init=function(){pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTabs.$init.call(this),this.FPageControl=null},this.$final=function(){this.FPageControl=void 0,pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTabs.$final.call(this)},this.GetTabClass=function(){return t.TTMSFNCPageControlPage},this.PageControl=function(){return this.FPageControl},this.Create$3=function(e){return pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTabs.Create$3.apply(this,arguments),this.FPageControl=rtl.as(e,t.TTMSFNCCustomPageControl),this},this.Clear$1=function(){null!=this.FPageControl&&(this.FPageControl.FPrevActivePageContainer=null,this.FPageControl.BeginUpdate()),pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTabs.Clear$1.call(this),null!=this.FPageControl&&this.FPageControl.EndUpdate()},this.Add$2=function(){return pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTabs.Add$1.call(this)}})),this.TTMSFNCPageControlPageCloseAction={0:"ttcaNone",ttcaNone:0,1:"ttcaFree",ttcaFree:1,2:"ttcaHide",ttcaHide:2},this.$rtti.$Enum("TTMSFNCPageControlPageCloseAction",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCPageControlPageCloseAction}),this.$rtti.$MethodVar("TTMSFNCPageControlBeforeReorderPageEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACurrentPageIndex",rtl.longint],["ANewPageIndex",rtl.longint],["ACanReorder",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCPageControlBeforeChangePageEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACurrentPageIndex",rtl.longint],["ANewPageIndex",rtl.longint],["ACanChange",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCPageControlChangePageEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["APreviousPageIndex",rtl.longint],["ACurrentPageIndex",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCPageControlReorderPageEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["APreviousPageIndex",rtl.longint],["ACurrentPageIndex",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCPageControlBeforeClosePageEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["APageIndex",rtl.longint],["ACloseAction",this.$rtti.TTMSFNCPageControlPageCloseAction,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCPageControlClosePageEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["APageIndex",rtl.longint],["ACloseAction",this.$rtti.TTMSFNCPageControlPageCloseAction]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCPageControlBeforeInsertPageEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANewPageIndex",rtl.longint,1],["ACanInsert",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCPageControlInsertPageEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ANewPageIndex",rtl.longint]]),methodkind:0}),rtl.createClass(this,"TTMSFNCPageControlPopupForm",pas["WEBLib.TMSFNCPopup"].TTMSFNCCustomPopupForm,(function(){rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCPageControlPopup",pas["WEBLib.TMSFNCPopup"].TTMSFNCNonFocusablePopup,(function(){this.GetPopupFormClass=function(){return t.TTMSFNCPageControlPopupForm},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCCustomPageControl",pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet,(function(){this.$init=function(){pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.$init.call(this),this.FBlockAssign=!1,this.FSaveActivePage=null,this.FPopup=null,this.FSaveHeight=0,this.FSaveWidth=0,this.FUpdateMargins=!1,this.FUpdateVisibility=!1,this.FPrevActivePageContainer=null,this.FUpdateCount$2=0,this.FOnInsertPage=null,this.FOnBeforeClosePage=null,this.FOnBeforeInsertPage=null,this.FOnChangePage=null,this.FOnReorderPage=null,this.FOnClosePage=null,this.FOnBeforeChangePage=null,this.FOnBeforeReorderPage=null,this.FOnInternalInsertPage=null,this.FCollapsed=!1},this.$final=function(){this.FSaveActivePage=void 0,this.FPopup=void 0,this.FPrevActivePageContainer=void 0,this.FOnInsertPage=void 0,this.FOnBeforeClosePage=void 0,this.FOnBeforeInsertPage=void 0,this.FOnChangePage=void 0,this.FOnReorderPage=void 0,this.FOnClosePage=void 0,this.FOnBeforeChangePage=void 0,this.FOnBeforeReorderPage=void 0,this.FOnInternalInsertPage=void 0,pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.$final.call(this)},this.GetActivePageIndex=function(){return this.GetActiveTabIndex()},this.SetActivePageIndex=function(t){this.SetActiveTabIndex(t)},this.SetPages=function(t){this.FTabs.Assign(t)},this.GetActivePage=function(){return rtl.as(this.GetActiveTab(),t.TTMSFNCPageControlPage)},this.SetActivePage=function(t){this.SetActiveTab(t)},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,0,6)},this.CreateTabs=function(){return t.TTMSFNCPageControlPages.$create("Create$3",[this])},this.GetContainerClass=function(){return t.TTMSFNCPageControlContainer},this.GetPages=function(){return rtl.as(this.FTabs,t.TTMSFNCPageControlPages)},this.Loaded=function(){var e=0,i=null;pas["WEBLib.Controls"].TCustomControl.Loaded.call(this);for(var s=0,n=this.GetPages().GetCount()-1;s<=n;s++)e=s,null!=(i=rtl.as(this.GetPages().GetTab(e),t.TTMSFNCPageControlPage).FContainer)&&i.SetVisible(!0);this.UpdatePages();for(var o=0,r=this.GetPages().GetCount()-1;o<=r;o++)e=o,null!=(i=rtl.as(this.GetPages().GetTab(e),t.TTMSFNCPageControlPage).FContainer)&&i.SetVisible(i.FIsActive)},this.SetCollapsed=function(t){if(this.FCollapsed!==t){this.FCollapsed=t,this.FBlockAssign=!this.FCollapsed,this.FPopup.Deactivate(),this.FBlockAssign=!1;var e=this.FLayout.FPosition;0===e||3===e?this.FCollapsed&&-1===this.FSaveWidth&&(this.FSaveWidth=this.GetWidth()):1!==e&&2!==e||this.FCollapsed&&-1===this.FSaveHeight&&(this.FSaveHeight=Math.round(this.GetHeight())),this.FCollapsed?(this.FSaveActivePage=this.GetActivePage(),this.SetActivePage(null),this.FUpdateVisibility=!0,this.FUpdateMargins=!0,this.UpdatePages()):null!=this.FSaveActivePage&&this.SetActivePage(this.FSaveActivePage);var i=this.FLayout.FPosition;0===i||3===i?this.FCollapsed?(0===this.FLayout.FPosition?this.SetWidth(Math.round(this.FTabSize.FHeight+this.FTabSize.FMargins.FLeft)):this.SetWidth(Math.round(this.FTabSize.FHeight+this.FTabSize.FMargins.FRight)),3===this.FLayout.FPosition&&this.SetLeft(this.GetLeft()+Math.round(this.FSaveWidth-this.GetWidth()))):(3===this.FLayout.FPosition&&this.SetLeft(this.GetLeft()-Math.round(this.FSaveWidth-this.GetWidth())),this.SetWidth(Math.round(this.FSaveWidth))):1!==i&&2!==i||(this.FCollapsed?(1===this.FLayout.FPosition?this.SetHeight(Math.round(this.FTabSize.FHeight+this.FTabSize.FMargins.FTop)):this.SetHeight(Math.round(this.FTabSize.FHeight+this.FTabSize.FMargins.FBottom)),2===this.FLayout.FPosition&&this.SetTop(this.GetTop()+Math.round(this.FSaveHeight-this.GetHeight()))):(2===this.FLayout.FPosition&&this.SetTop(this.GetTop()-Math.round(this.FSaveHeight-this.GetHeight())),this.SetHeight(Math.round(this.FSaveHeight)))),this.FCollapsed||(this.FUpdateVisibility=!0,this.FUpdateMargins=!0,this.UpdatePages())}},this.DoClosePopup=function(t){this.FBlockAssign||this.SetActivePage(null)},this.SetAdaptToStyle=function(e){var i=0,s=null;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetAdaptToStyle.apply(this,arguments);for(var n=0,o=this.GetPages().GetCount()-1;n<=o;n++)i=n,null!=(s=rtl.as(this.GetPages().GetTab(i),t.TTMSFNCPageControlPage).FContainer)&&s.SetAdaptToStyle(this.GetAdaptToStyle())},this.UpdateAllPages=function(t){this.FUpdateMargins=!0},this.Notification=function(e,i){var s=null;!(3 in this.FComponentState)&&1===i&&t.TTMSFNCPageControlContainer.isPrototypeOf(e)&&((s=rtl.as(e,t.TTMSFNCPageControlContainer)).FIsDestroying||null==s.FPage||(this.FPrevActivePageContainer===s.FPage.FContainer&&(this.FPrevActivePageContainer=null),s.FPage.FContainer=null,rtl.free(s,"FPage"),s.FPage=null,this.SetActivePageIndex(Math.max(0,Math.min(this.GetActivePageIndex(),this.GetPages().GetCount()-1))))),pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.Notification.apply(this,arguments)},this.UpdatePages=function(){var e,i=null;this.FUpdateCount$2>0||3 in this.FComponentState||(!0,this.UpdatePageIndexes(),this.UpdateVisibility(),(e=this.GetActivePageIndex())>=0&&e<=this.GetPages().GetCount()-1?null!=(i=rtl.as(this.GetPages().GetTab(e),t.TTMSFNCPageControlPage).FContainer)&&(this.UpdateMargins(i),i.SetVisible(!this.FCollapsed),null!=i.FParent&&i.BringToFront(),i.Invalidate(),null!=this.FPrevActivePageContainer&&this.FPrevActivePageContainer!==i&&this.FPrevActivePageContainer.SetVisible(!1),this.FPrevActivePageContainer=i):null!=this.FPrevActivePageContainer&&(this.FPrevActivePageContainer.SetVisible(!1),this.FPrevActivePageContainer.SendToBack()))},this.UpdateTabs=function(t,e){pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.UpdateTabs.apply(this,arguments),this.UpdatePages()},this.UpdateMargins=function(t){var e;if(e=this.GetTotalTabHeight(),this.FCollapsed||e<=0){var i=this.FLayout.FPosition;0===i||3===i?(t.SetWidth(Math.round(this.FSaveWidth)),t.SetHeight(Math.round(this.GetHeight()))):1!==i&&2!==i||(t.SetWidth(Math.round(this.GetWidth())),t.SetHeight(Math.round(this.FSaveHeight)));var s=this.FLayout.FPosition;0===s?t.SetWidth(t.GetWidth()-Math.round(this.FTabSize.FHeight-this.FTabSize.FMargins.FLeft+1)):1===s?t.SetHeight(t.GetHeight()-Math.round(this.FTabSize.FHeight-this.FTabSize.FMargins.FTop+1)):2===s?t.SetHeight(t.GetHeight()-Math.round(this.FTabSize.FHeight-this.FTabSize.FMargins.FBottom+1)):3===s&&t.SetWidth(t.GetWidth()-Math.round(this.FTabSize.FHeight-this.FTabSize.FMargins.FRight+1)),t.FMargins.SetTop(0),t.FMargins.SetLeft(0),t.FMargins.SetRight(0),t.FMargins.SetBottom(0)}else{var n=this.FLayout.FPosition;0===n?(t.FMargins.SetTop(0),t.FMargins.SetLeft(Math.round(e+this.FTabSize.FMargins.FLeft-1)),t.FMargins.SetRight(0),t.FMargins.SetBottom(0)):1===n?(t.FMargins.SetTop(Math.round(e+this.FTabSize.FMargins.FTop-1)),t.FMargins.SetLeft(0),t.FMargins.SetRight(0),t.FMargins.SetBottom(0)):2===n?(t.FMargins.SetTop(0),t.FMargins.SetLeft(0),t.FMargins.SetRight(0),t.FMargins.SetBottom(Math.round(this.FTabSize.FMargins.FBottom+e-1))):3===n&&(t.FMargins.SetTop(0),t.FMargins.SetLeft(0),t.FMargins.SetRight(Math.round(this.FTabSize.FMargins.FRight+e-1)),t.FMargins.SetBottom(0))}},this.UpdatePageIndexes=function(){for(var e=null,i=0,s=0,n=this.GetPages().GetCount()-1;s<=n;s++)i=s,null!=(e=rtl.as(this.GetPages().GetTab(i),t.TTMSFNCPageControlPage).FContainer)&&(e.FPageIndex=i,e.FIsActive=e.FPageIndex===this.GetActivePageIndex(),this.FUpdateMargins&&this.UpdateMargins(e));this.FUpdateMargins=!1},this.UpdateVisibility=function(){var e=null,i=0;if(this.FUpdateVisibility&&this.FCollapsed)for(var s=0,n=this.GetPages().GetCount()-1;s<=n;s++)i=s,null!=(e=rtl.as(this.GetPages().GetTab(i),t.TTMSFNCPageControlPage).FContainer)&&e.SetVisible(!this.FCollapsed)},this.DoInvalidate=function(){var t=null;pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.DoInvalidate.call(this),null!=this.GetActivePage()&&null!=(t=this.GetActivePage().FContainer)&&t.Invalidate()},this.Draw=function(t,e){pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.Draw.apply(this,arguments),4 in this.FComponentState&&0===this.GetPages().GetCount()&&(t.DrawFocusRectangle$3(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),0,2),t.FFont.SetHeight(this.ScalePaintValue(t.FFont.FHeight)),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),'Please add pages by clicking "New Page" in the context menu',!1,0,0,0,0,-1,-1,!0,!1,-1,-1))},this.DoBeforeChangeTab=function(t,e,i){pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.DoBeforeChangeTab.apply(this,arguments),this.DoBeforeChangePage(t,e,i)},this.DoChangeTab=function(t,e){var i=null;if(pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.DoChangeTab.apply(this,arguments),this.UpdatePages(),this.DoChangePage(t,e),this.FCollapsed&&null!=this.GetActivePage()){this.FSaveActivePage=this.GetActivePage(),this.FBlockAssign=!0,this.FPopup.Deactivate(),this.FBlockAssign=!1,i=this.GetActivePage().FContainer,this.FPopup.SetContentControl(i),this.FPopup.SetPlacementControl(this);var s=this.FLayout.FPosition;0===s?(this.FPopup.SetDropDownWidth(this.FSaveWidth-Math.round(this.FTabSize.FHeight+this.FTabSize.FMargins.FTop+1)),this.FPopup.SetDropDownHeight(this.GetHeight())):3===s?(this.FPopup.SetDropDownWidth(this.FSaveWidth-Math.round(this.FTabSize.FHeight+this.FTabSize.FMargins.FRight+1)),this.FPopup.SetDropDownHeight(this.GetHeight())):1===s?(this.FPopup.SetDropDownWidth(this.GetWidth()),this.FPopup.SetDropDownHeight(this.FSaveHeight-Math.round(this.FTabSize.FHeight+this.FTabSize.FMargins.FTop+1))):2===s&&(this.FPopup.SetDropDownWidth(this.GetWidth()),this.FPopup.SetDropDownHeight(this.FSaveHeight-Math.round(this.FTabSize.FHeight+this.FTabSize.FMargins.FBottom+1)));var n=this.FLayout.FPosition;0===n||3===n?(this.FPopup.FHorizontalOffset=-1,this.FPopup.FVerticalOffset=0,this.FPopup.SetDropDownWidth(this.FPopup.FDropDownWidth+2)):1!==n&&2!==n||(this.FPopup.FVerticalOffset=-1,this.FPopup.FHorizontalOffset=0,this.FPopup.SetDropDownHeight(this.FPopup.FDropDownHeight+2));var o=this.FLayout.FPosition;0===o?this.FPopup.SetPlacement(3):1===o?this.FPopup.SetPlacement(0):2===o?this.FPopup.SetPlacement(1):3===o&&this.FPopup.SetPlacement(2),this.FPopup.Activate()}},this.DoBeforeReorderTab=function(t,e,i){pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.DoBeforeReorderTab.apply(this,arguments),this.DoBeforeReorderPage(t,e,i)},this.DoReorderTab=function(t,e){pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.DoReorderTab.apply(this,arguments),this.DoReorderPage(t,e),this.FUpdateMargins=!0},this.DoBeforeCloseTab=function(t,e){var i=0,s=0;pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.DoBeforeCloseTab.apply(this,arguments),s=e.get(),i=s,this.DoBeforeClosePage(t,{get:function(){return i},set:function(t){i=t}}),s=i,e.set(s)},this.DoCloseTab=function(t,e){var i=0;pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.DoCloseTab.apply(this,arguments),i=e,this.DoClosePage(t,i),this.FUpdateMargins=!0},this.DoBeforeInsertTab=function(t,e){pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.DoBeforeInsertTab.apply(this,arguments),this.DoBeforeInsertPage(t,e)},this.DoInsertTab=function(t){pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.DoInsertTab.apply(this,arguments),this.DoInsertPage(t),this.FUpdateMargins=!0},this.DoBeforeChangePage=function(t,e,i){null!=this.FOnBeforeChangePage&&this.FOnBeforeChangePage(this,t,e,i)},this.DoChangePage=function(t,e){null!=this.FOnChangePage&&this.FOnChangePage(this,t,e)},this.DoBeforeReorderPage=function(t,e,i){null!=this.FOnBeforeReorderPage&&this.FOnBeforeReorderPage(this,t,e,i)},this.DoReorderPage=function(t,e){null!=this.FOnReorderPage&&this.FOnReorderPage(this,t,e)},this.DoBeforeClosePage=function(t,e){null!=this.FOnBeforeClosePage&&this.FOnBeforeClosePage(this,t,e)},this.DoClosePage=function(t,e){null!=this.FOnClosePage&&this.FOnClosePage(this,t,e)},this.DoBeforeInsertPage=function(t,e){null!=this.FOnBeforeInsertPage&&this.FOnBeforeInsertPage(this,t,e)},this.DoInsertPage=function(t){null!=this.FOnInsertPage&&this.FOnInsertPage(this,t)},this.Create$1=function(e){return pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.Create$1.apply(this,arguments),this.FPopup=t.TTMSFNCPageControlPopup.$create("Create$1",[this]),this.FPopup.FOnClosePopup=rtl.createCallback(this,"DoClosePopup"),this.IsDesignTime()&&this.DisableBackground(),this.FTabSize.FOnChange=rtl.createCallback(this,"UpdateAllPages"),this.FLayout.FOnChange=rtl.createCallback(this,"UpdateAllPages"),this.FSaveWidth=-1,this.FSaveHeight=-1,this},this.Destroy=function(){rtl.free(this,"FPopup"),pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.Destroy.call(this)},this.AddPage=function(t){var e=null;return(e=this.GetPages().Add$2()).SetText(t),null!=this.FOnInternalInsertPage&&this.FOnInternalInsertPage(e),e},this.BeginUpdate=function(){pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.BeginUpdate.call(this),this.FUpdateCount$2+=1},this.EndUpdate=function(){pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.EndUpdate.call(this),this.FUpdateCount$2-=1,0===this.FUpdateCount$2&&this.UpdatePages()},this.RemovePage=function(t){t>=0&&t<=this.GetPages().GetCount()-1&&this.GetPages().Delete(t)},this.UpdateControlAfterResize=function(){this.FUpdateMargins=!0,pas["WEBLib.TMSFNCTabSet"].TTMSFNCCustomTabSet.UpdateControlAfterResize.call(this)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCPageControl",this.TTMSFNCCustomPageControl,(function(){this.$init=function(){t.TTMSFNCCustomPageControl.$init.call(this),this.FInitialize=!1},this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClasses([t.TTMSFNCPageControl,t.TTMSFNCPageControlPage])},this.SetName=function(t){pas["WEBLib.Controls"].TCustomControl.SetName.apply(this,arguments),this.FInitialize&&(this.InitSample$1(),this.FInitialize=!1)},this.Create$1=function(e){return t.TTMSFNCCustomPageControl.Create$1.apply(this,arguments),this.SetWidth(500),this.SetHeight(500),this.FInitialize=this.IsDesignTime(),this},this.InitSample$1=function(){this.BeginUpdate(),this.ResetToDefaultStyle(),this.GetPages().Clear$1(),this.AddPage("Page 1").SetUseDefaultAppearance(!0),this.AddPage("Page 2").SetUseDefaultAppearance(!0),this.AddPage("Page 3").SetUseDefaultAppearance(!0),this.EndUpdate()},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("ActivePageIndex",3,rtl.longint,"GetActivePageIndex","SetActivePageIndex",{Default:0}),e.addProperty("Collapsed",2,rtl.boolean,"FCollapsed","SetCollapsed",{Default:!1}),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("TabAppearance",2,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetTabAppearance,"FTabAppearance","SetTabAppearance"),e.addProperty("ButtonAppearance",2,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetButtonAppearance,"FButtonAppearance","SetButtonAppearance"),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("Interaction",2,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetInteraction,"FInteraction","SetInteraction"),e.addProperty("Options",2,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetOptions,"FOptions","SetOptions"),e.addProperty("TabSize",2,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetTabSize,"FTabSize","SetTabSize"),e.addProperty("Layout",2,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetLayout,"FLayout","SetLayout"),e.addProperty("Version",1,rtl.string,"GetVersion",""),e.addProperty("Pages",3,t.$rtti.TTMSFNCPageControlPages,"GetPages","SetPages"),e.addProperty("OnBeforeClosePage",0,t.$rtti.TTMSFNCPageControlBeforeClosePageEvent,"FOnBeforeClosePage","FOnBeforeClosePage"),e.addProperty("OnBeforeChangePage",0,t.$rtti.TTMSFNCPageControlBeforeChangePageEvent,"FOnBeforeChangePage","FOnBeforeChangePage"),e.addProperty("OnClosePage",0,t.$rtti.TTMSFNCPageControlClosePageEvent,"FOnClosePage","FOnClosePage"),e.addProperty("OnChangePage",0,t.$rtti.TTMSFNCPageControlChangePageEvent,"FOnChangePage","FOnChangePage"),e.addProperty("OnAnchorTabClick",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetAnchorTabClickEvent,"FOnAnchorTabClick","FOnAnchorTabClick"),e.addProperty("OnBeforeInsertPage",0,t.$rtti.TTMSFNCPageControlBeforeInsertPageEvent,"FOnBeforeInsertPage","FOnBeforeInsertPage"),e.addProperty("OnInsertPage",0,t.$rtti.TTMSFNCPageControlInsertPageEvent,"FOnInsertPage","FOnInsertPage"),e.addProperty("OnBeforeUpdateTab",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetBeforeUpdateTabEvent,"FOnBeforeUpdateTab","FOnBeforeUpdateTab"),e.addProperty("OnUpdateTab",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetUpdateTabEvent,"FOnUpdateTab","FOnUpdateTab"),e.addProperty("OnBeforeOpenInplaceEditor",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetBeforeOpenInplaceEditorEvent,"FOnBeforeOpenInplaceEditor","FOnBeforeOpenInplaceEditor"),e.addProperty("OnCloseInplaceEditor",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetCloseInplaceEditorEvent,"FOnCloseInplaceEditor","FOnCloseInplaceEditor"),e.addProperty("OnOpenInplaceEditor",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetOpenInplaceEditorEvent,"FOnOpenInplaceEditor","FOnOpenInplaceEditor"),e.addProperty("OnGetInplaceEditor",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetGetInplaceEditorEvent,"FOnGetInplaceEditor","FOnGetInplaceEditor"),e.addProperty("OnCustomizeInplaceEditor",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetCustomizeInplaceEditorEvent,"FOnCustomizeInplaceEditor","FOnCustomizeInplaceEditor"),e.addProperty("OnGetInplaceEditorRect",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetGetInplaceEditorRectEvent,"FOnGetInplaceEditorRect","FOnGetInplaceEditorRect"),e.addProperty("OnBeforeReorderPage",0,t.$rtti.TTMSFNCPageControlBeforeReorderPageEvent,"FOnBeforeReorderPage","FOnBeforeReorderPage"),e.addProperty("OnReorderPage",0,t.$rtti.TTMSFNCPageControlReorderPageEvent,"FOnReorderPage","FOnReorderPage"),e.addProperty("OnBeforeDrawTabBackground",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetBeforeDrawTabBackgroundEvent,"FOnBeforeDrawTabBackground","FOnBeforeDrawTabBackground"),e.addProperty("OnBeforeDrawTabProgress",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetBeforeDrawTabProgressEvent,"FOnBeforeDrawTabProgress","FOnBeforeDrawTabProgress"),e.addProperty("OnBeforeDrawTabBadge",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetBeforeDrawTabBadgeEvent,"FOnBeforeDrawTabBadge","FOnBeforeDrawTabBadge"),e.addProperty("OnBeforeDrawTabText",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetBeforeDrawTabTextEvent,"FOnBeforeDrawTabText","FOnBeforeDrawTabText"),e.addProperty("OnBeforeDrawTabCloseButton",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetBeforeDrawTabCloseButtonEvent,"FOnBeforeDrawTabCloseButton","FOnBeforeDrawTabCloseButton"),e.addProperty("OnBeforeDrawTabBitmap",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetBeforeDrawTabBitmapEvent,"FOnBeforeDrawTabBitmap","FOnBeforeDrawTabBitmap"),e.addProperty("OnAfterDrawTabBackground",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetAfterDrawTabBackgroundEvent,"FOnAfterDrawTabBackground","FOnAfterDrawTabBackground"),e.addProperty("OnAfterDrawTabProgress",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetAfterDrawTabProgressEvent,"FOnAfterDrawTabProgress","FOnAfterDrawTabProgress"),e.addProperty("OnAfterDrawTabBadge",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetAfterDrawTabBadgeEvent,"FOnAfterDrawTabBadge","FOnAfterDrawTabBadge"),e.addProperty("OnAfterDrawTabText",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetAfterDrawTabTextEvent,"FOnAfterDrawTabText","FOnAfterDrawTabText"),e.addProperty("OnAfterDrawTabCloseButton",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetAfterDrawTabCloseButtonEvent,"FOnAfterDrawTabCloseButton","FOnAfterDrawTabCloseButton"),e.addProperty("OnAfterDrawTabBitmap",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetAfterDrawTabBitmapEvent,"FOnAfterDrawTabBitmap","FOnAfterDrawTabBitmap"),e.addProperty("OnBeforeDrawMenuButton",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetBeforeDrawMenuButton,"FOnBeforeDrawMenuButton","FOnBeforeDrawMenuButton"),e.addProperty("OnAfterDrawMenuButton",0,pas["WEBLib.TMSFNCTabSet"].$rtti.TTMSFNCTabSetAfterDrawMenuButton,"FOnAfterDrawMenuButton","FOnAfterDrawMenuButton"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),t.$implcode=function(){rtl.createClass(e,"TTMSFNCTabSetTabOpen",pas["WEBLib.TMSFNCTabSet"].TTMSFNCTabSetTab,(function(){}))},t.$init=function(){pas.Classes.RegisterClass(t.TTMSFNCPageControlContainer)}}),["WEBLib.TMSFNCUtils","WEBLib.Graphics","SysUtils","Math","WEBLib.TMSFNCGraphicsTypes"]),rtl.module("WEBLib.TMSFNCSplitter",["System","Classes","SysUtils","Types","WEBLib.ExtCtrls","WEBLib.Controls","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCStyles","WEBLib.Graphics","WEBLib.Forms"],(function(){"use strict";var t=this;this.TTMSFNCSplitterIndicator={0:"siCircle",siCircle:0,1:"siCircles",siCircles:1,2:"siLine",siLine:2,3:"siSquare",siSquare:3,4:"siSquares",siSquares:4,5:"siImage",siImage:5},this.$rtti.$Enum("TTMSFNCSplitterIndicator",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TTMSFNCSplitterIndicator}),this.TTMSFNCSplitterResizeStyle={0:"rsOnce",rsOnce:0,1:"rsContinuous",rsContinuous:1},this.$rtti.$Enum("TTMSFNCSplitterResizeStyle",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCSplitterResizeStyle}),rtl.createClass(this,"TTMSFNCCustomSplitterAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FIndicatorBitmap=null,this.FIndicatorDownFill=null,this.FIndicatorDownStroke=null,this.FIndicatorFill=null,this.FIndicatorHoverFill=null,this.FIndicatorHoverStroke=null,this.FIndicatorMargin=0,this.FIndicatorStroke=null,this.FOwner=null,this.FSplitterDownFill=null,this.FSplitterDownStroke=null,this.FSplitterFill=null,this.FSplitterHoverFill=null,this.FSplitterHoverStroke=null,this.FSplitterStroke=null,this.FOnChange=null},this.$final=function(){this.FIndicatorBitmap=void 0,this.FIndicatorDownFill=void 0,this.FIndicatorDownStroke=void 0,this.FIndicatorFill=void 0,this.FIndicatorHoverFill=void 0,this.FIndicatorHoverStroke=void 0,this.FIndicatorStroke=void 0,this.FOwner=void 0,this.FSplitterDownFill=void 0,this.FSplitterDownStroke=void 0,this.FSplitterFill=void 0,this.FSplitterHoverFill=void 0,this.FSplitterHoverStroke=void 0,this.FSplitterStroke=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetIndicatorBitmap=function(t){this.FIndicatorBitmap.Assign(t),this.BitmapChanged(this.FIndicatorBitmap)},this.SetIndicatorDownFill=function(t){this.FIndicatorDownFill.Assign(t),this.FillChanged(this.FIndicatorDownFill)},this.SetIndicatorDownStroke=function(t){this.FIndicatorDownStroke.Assign(t),this.StrokeChanged(this.FIndicatorDownStroke)},this.SetIndicatorFill=function(t){this.FIndicatorFill.Assign(t),this.FillChanged(this.FIndicatorFill)},this.SetIndicatorHoverFill=function(t){this.FIndicatorHoverFill.Assign(t),this.FillChanged(this.FIndicatorHoverFill)},this.SetIndicatorHoverStroke=function(t){this.FIndicatorHoverStroke.Assign(t),this.StrokeChanged(this.FIndicatorHoverStroke)},this.SetIndicatorMargin=function(t){this.FIndicatorMargin!==t&&(this.FIndicatorMargin=t,this.Changed())},this.SetIndicatorStroke=function(t){this.FIndicatorStroke.Assign(t),this.StrokeChanged(this.FIndicatorStroke)},this.SetSplitterDownFill=function(t){this.FSplitterDownFill.Assign(t),this.FillChanged(this.FSplitterDownFill)},this.SetSplitterDownStroke=function(t){this.FSplitterDownStroke.Assign(t),this.StrokeChanged(this.FSplitterDownStroke)},this.SetSplitterHoverFill=function(t){this.FSplitterHoverFill.Assign(t),this.FillChanged(this.FSplitterHoverFill)},this.SetSplitterHoverStroke=function(t){this.FSplitterHoverStroke.Assign(t),this.StrokeChanged(this.FSplitterHoverStroke)},this.SetSplitterFill=function(t){this.FSplitterFill.Assign(t),this.FillChanged(this.FSplitterFill)},this.SetSplitterStroke=function(t){this.FSplitterStroke.Assign(t),this.StrokeChanged(this.FSplitterStroke)},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.BitmapChanged=function(t){this.Changed()},this.FillChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.Create$1=function(t){return this.FOwner=t,this.FSplitterFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor("#E9E9E9"),8421504,-1,-1]),this.FSplitterFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FSplitterStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),this.FSplitterStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FSplitterHoverFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor("#BBC4CC"),8421504,-1,-1]),this.FSplitterHoverFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FSplitterHoverStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,10061943]),this.FSplitterHoverStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FSplitterDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor("#B8C0C8"),8421504,-1,-1]),this.FSplitterDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FSplitterDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,9470064]),this.FSplitterDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FIndicatorMargin=1,this.FIndicatorFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FIndicatorFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FIndicatorStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,8421504]),this.FIndicatorStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FIndicatorHoverFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FIndicatorHoverFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FIndicatorHoverStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,8421504]),this.FIndicatorHoverStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FIndicatorDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.HTMLToColor("#1BADF8"),8421504,-1,-1]),this.FIndicatorDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FIndicatorDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,8421504]),this.FIndicatorDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FIndicatorBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this},this.Destroy=function(){rtl.free(this,"FSplitterFill"),rtl.free(this,"FSplitterStroke"),rtl.free(this,"FSplitterHoverFill"),rtl.free(this,"FSplitterHoverStroke"),rtl.free(this,"FSplitterDownFill"),rtl.free(this,"FSplitterDownStroke"),rtl.free(this,"FIndicatorFill"),rtl.free(this,"FIndicatorStroke"),rtl.free(this,"FIndicatorHoverFill"),rtl.free(this,"FIndicatorHoverStroke"),rtl.free(this,"FIndicatorDownFill"),rtl.free(this,"FIndicatorDownStroke"),rtl.free(this,"FIndicatorBitmap"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCustomSplitterAppearance.isPrototypeOf(e)?(this.SetIndicatorBitmap(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FIndicatorBitmap),this.SetIndicatorFill(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FIndicatorFill),this.SetIndicatorStroke(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FIndicatorStroke),this.SetIndicatorHoverFill(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FIndicatorHoverFill),this.SetIndicatorHoverStroke(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FIndicatorHoverStroke),this.SetIndicatorDownFill(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FIndicatorDownFill),this.SetIndicatorDownStroke(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FIndicatorDownStroke),this.SetIndicatorMargin(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FIndicatorMargin),this.SetSplitterFill(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FSplitterFill),this.SetSplitterStroke(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FSplitterStroke),this.SetSplitterHoverFill(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FSplitterHoverFill),this.SetSplitterHoverStroke(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FSplitterHoverStroke),this.SetSplitterDownFill(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FSplitterDownFill),this.SetSplitterDownStroke(rtl.as(e,t.TTMSFNCCustomSplitterAppearance).FSplitterDownStroke)):pas.Classes.TPersistent.Assign.apply(this,arguments)}})),rtl.createClass(this,"TTMSFNCSplitterAppearance",this.TTMSFNCCustomSplitterAppearance,(function(){var t=this.$rtti;t.addProperty("IndicatorBitmap",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FIndicatorBitmap","SetIndicatorBitmap"),t.addProperty("IndicatorDownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FIndicatorDownFill","SetIndicatorDownFill"),t.addProperty("IndicatorDownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FIndicatorDownStroke","SetIndicatorDownStroke"),t.addProperty("IndicatorFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FIndicatorFill","SetIndicatorFill"),t.addProperty("IndicatorHoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FIndicatorHoverFill","SetIndicatorHoverFill"),t.addProperty("IndicatorHoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FIndicatorHoverStroke","SetIndicatorHoverStroke"),t.addProperty("IndicatorMargin",2,rtl.longint,"FIndicatorMargin","SetIndicatorMargin",{Default:1}),t.addProperty("IndicatorStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FIndicatorStroke","SetIndicatorStroke"),t.addProperty("SplitterDownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FSplitterDownFill","SetSplitterDownFill"),t.addProperty("SplitterDownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FSplitterDownStroke","SetSplitterDownStroke"),t.addProperty("SplitterFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FSplitterFill","SetSplitterFill"),t.addProperty("SplitterHoverFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FSplitterHoverFill","SetSplitterHoverFill"),t.addProperty("SplitterHoverStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FSplitterHoverStroke","SetSplitterHoverStroke"),t.addProperty("SplitterStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FSplitterStroke","SetSplitterStroke")})),rtl.createClass(this,"TTMSFNCSplitterCache",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FSplitter=null},this.$final=function(){this.FSplitter=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.Draw=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),null!=this.FSplitter&&(0!==this.FSplitter.FAppearance.FSplitterDownFill.FKind?t.FFill.Assign(this.FSplitter.FAppearance.FSplitterDownFill):(t.FFill.SetKind(1),t.FFill.SetColor(8421504)),t.FStroke.Assign(this.FSplitter.FAppearance.FSplitterDownStroke),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),2))},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),this.$rtti.$MethodVar("TTMSFNCSplitterMoveEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AResizeStyle",this.$rtti.TTMSFNCSplitterResizeStyle],["ADownPos",pas["WEBLib.TMSFNCTypes"].$rtti.TPointF],["ACurrentPos",pas["WEBLib.TMSFNCTypes"].$rtti.TPointF],["ASplit",rtl.double]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomSplitter",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FAppearance=null,this.FCache=null,this.FControl=null,this.FDownPos=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),this.FMaxSize=0,this.FMinSize=0,this.FMouseDown=!1,this.FMouseHover=!1,this.FNewSize=0,this.FOldSize=0,this.FShowIndicator=!1,this.FSplit=0,this.FSplitterIndicator=0,this.FResizeStyle=0,this.FOnAppearanceChanged=null,this.FOnAfterDrawIndicator=null,this.FOnBeforeDrawIndicator=null,this.FOnChanged=null,this.FOnSplitterMove=null,this.FOnSplitterMoved=null},this.$final=function(){this.FAppearance=void 0,this.FCache=void 0,this.FControl=void 0,this.FDownPos=void 0,this.FOnAppearanceChanged=void 0,this.FOnAfterDrawIndicator=void 0,this.FOnBeforeDrawIndicator=void 0,this.FOnChanged=void 0,this.FOnSplitterMove=void 0,this.FOnSplitterMoved=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.AppearanceChanged=function(t){this.Invalidate(),this.DoAppearanceChanged(t)},this.CalcSplitSize=function(t,e,i,s){var n=0;this.GetSplitterAlign()in rtl.createSet(3,4)?s.set(t-this.FDownPos.X):s.set(e-this.FDownPos.Y),n=0;var o=this.GetSplitterAlign();3===o?n=this.FControl.GetWidth()+s.get():4===o?n=this.FControl.GetWidth()-s.get():1===o?n=this.FControl.GetHeight()+s.get():2===o&&(n=this.FControl.GetHeight()-s.get()),i.set(n),n<this.FMinSize?i.set(this.FMinSize):n>this.FMaxSize&&i.set(this.FMaxSize),n!==i.get()&&(this.GetSplitterAlign()in rtl.createSet(2,4)?n-=i.get():n=i.get()-n,s.set(s.get()+n))},this.DrawIndicatorCircle=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=!1,n=!1;i.$assign(this.GetDrawingRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))),s=!0,n=!0,this.DoBeforeDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FResizeStyle,{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}}),s&&(n&&t.DrawEllipse$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),2),this.DoAfterDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FResizeStyle))},this.DrawIndicatorCircles=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=!1,r=!1;this.GetDrawingRects(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n),o=!0,r=!0,this.DoBeforeDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,n.Right,n.Bottom)),this.FResizeStyle,{get:function(){return o},set:function(t){o=t}},{get:function(){return r},set:function(t){r=t}}),o&&(r&&(t.DrawEllipse$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),2),t.DrawEllipse$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2),t.DrawEllipse$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),2)),this.DoAfterDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,n.Right,n.Bottom)),this.FResizeStyle))},this.DrawIndicatorImage=function(t,e){var i=0,s=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=!1,r=!1;null==this.FAppearance.FIndicatorBitmap||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FAppearance.FIndicatorBitmap)||(i=(this.GetWidth()-this.FAppearance.FIndicatorBitmap.GetWidth())/2,s=(this.GetHeight()-this.FAppearance.FIndicatorBitmap.GetHeight())/2,n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i,s,i+this.FAppearance.FIndicatorBitmap.GetWidth(),s+this.FAppearance.FIndicatorBitmap.GetHeight())),o=!0,r=!0,this.DoBeforeDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),this.FResizeStyle,{get:function(){return o},set:function(t){o=t}},{get:function(){return r},set:function(t){r=t}}),o&&(r&&t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),this.FAppearance.FIndicatorBitmap,!0,!1,!0,!1),this.DoAfterDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),this.FResizeStyle)))},this.DrawIndicatorLine=function(t,e){var i,s=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),n=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),o=!1,r=!1;i=this.ScalePaintValue(10),this.GetSplitterAlign()in rtl.createSet(3,4)?(s.$assign(pas["WEBLib.TMSFNCTypes"].PointF(this.GetWidth()/2,this.GetHeight()/2+i)),n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(this.GetWidth()/2,this.GetHeight()/2-i))):(s.$assign(pas["WEBLib.TMSFNCTypes"].PointF(this.GetWidth()/2+i,this.GetHeight()/2)),n.$assign(pas["WEBLib.TMSFNCTypes"].PointF(this.GetWidth()/2-i,this.GetHeight()/2))),o=!0,r=!0,this.DoBeforeDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(s.X,s.Y,n.X,n.Y)),this.FResizeStyle,{get:function(){return o},set:function(t){o=t}},{get:function(){return r},set:function(t){r=t}}),o&&(r&&t.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(s),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(n),2,2),this.DoAfterDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(s.X,s.Y,n.X,n.Y)),this.FResizeStyle))},this.DrawIndicatorSquare=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=!1,n=!1;i.$assign(this.GetDrawingRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))),s=!0,n=!0,this.DoBeforeDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FResizeStyle,{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}}),s&&(n&&t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),2),this.DoAfterDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FResizeStyle))},this.DrawIndicatorSquares=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=!1,r=!1;this.GetDrawingRects(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n),o=!0,r=!0,this.DoBeforeDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,n.Right,n.Bottom)),this.FResizeStyle,{get:function(){return o},set:function(t){o=t}},{get:function(){return r},set:function(t){r=t}}),o&&(r&&(t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),2),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n),2)),this.DoAfterDrawIndicator(t,this.FSplitterIndicator,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(i.Left,i.Top,n.Right,n.Bottom)),this.FResizeStyle))},this.DrawLine=function(){null==this.FCache&&(this.FCache=t.TTMSFNCSplitterCache.$create("Create$1",[this]),this.FCache.FSplitter=this),this.FCache.SetBoundsRect(this.GetBoundsRect()),this.GetSplitterAlign()in rtl.createSet(3,4)?this.FCache.SetLeft(this.GetLeft()+Math.round(this.FSplit)):this.FCache.SetTop(this.GetTop()+Math.round(this.FSplit)),this.FCache.SetParent(this.FParent)},this.GetDrawingRect=function(t){var e,i,s,n,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return n=this.FAppearance.FIndicatorMargin,i=Math.max(this.GetWidth()-2*n,1),s=Math.max(this.GetHeight()-2*n,1),e=Math.min(i,s),o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left+n+(i-e)/2,t.Top+n+(s-e)/2,t.Left+n+(i+e)/2,t.Top+n+(s+e)/2)),o},this.GetDrawingRects=function(t,e,i,s){var n,o,r,a;a=this.FAppearance.FIndicatorMargin,o=this.GetWidth()-2*a,r=this.GetHeight()-2*a,n=Math.min(o,r),this.GetSplitterAlign()in rtl.createSet(3,4)?(i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left+a+(o-n)/2,t.Top+a+(r-n)/2,t.Left+a+(o+n)/2,t.Top+a+(r+n)/2)),e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left+a+(o-n)/2,t.Top+a+(r-n)/2-n-this.ScalePaintValue(2),t.Left+a+(o+n)/2,t.Top+a+(r+n)/2-n-this.ScalePaintValue(2))),s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left+a+(o-n)/2,t.Top+a+(r-n)/2+n+this.ScalePaintValue(2),t.Left+a+(o+n)/2,t.Top+a+(r+n)/2+n+this.ScalePaintValue(2)))):(i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left+a+(o-n)/2,t.Top+a+(r-n)/2,t.Left+a+(o+n)/2,t.Top+a+(r+n)/2)),e.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left+a+(o-n)/2-n-this.ScalePaintValue(2),t.Top+a+(r-n)/2,t.Left+a+(o+n)/2-n-this.ScalePaintValue(2),t.Top+a+(r+n)/2)),s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left+a+(o-n)/2+n+this.ScalePaintValue(2),t.Top+a+(r-n)/2,t.Left+a+(o+n)/2+n+this.ScalePaintValue(2),t.Top+a+(r+n)/2)))},this.SetAppearance=function(t){this.FAppearance.Assign(t)},this.SetMinSize=function(t){this.FMinSize!==t&&t>=0&&(this.FMinSize=t,this.DoChanged())},this.SetShowIndicator=function(t){this.FShowIndicator!==t&&(this.FShowIndicator=t,this.DoChanged())},this.SetSplitterIndicator=function(t){this.FSplitterIndicator!==t&&(this.FSplitterIndicator=t,this.DoChanged())},this.SetResizeStyle=function(t){this.FResizeStyle!==t&&(this.FResizeStyle=t,this.DoChanged())},this.DoAppearanceChanged=function(t){null!=this.FOnAppearanceChanged&&this.FOnAppearanceChanged(this)},this.DoAfterDrawIndicator=function(t,e,i,s){null!=this.FOnAfterDrawIndicator&&this.FOnAfterDrawIndicator(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s)},this.DoBeforeDrawIndicator=function(t,e,i,s,n,o){null!=this.FOnBeforeDrawIndicator&&this.FOnBeforeDrawIndicator(this,t,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s,n,o)},this.DoSplitterMove=function(t,e,i,s){null!=this.FOnSplitterMove&&this.FOnSplitterMove(this,t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(e),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(i),s)},this.DoSplitterMoved=function(t,e,i,s){null!=this.FOnSplitterMoved&&this.FOnSplitterMoved(this,t,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(e),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(i),s)},this.DoCanResize=function(t){return!0,t.get()<=this.FMinSize&&t.set(this.FMinSize),!0},this.DoChanged=function(){this.Invalidate(),null!=this.FOnChanged&&this.FOnChanged(this)},this.DrawBackGroundColor=function(t,e){this.FMouseDown&&0!==this.FResizeStyle?(t.FFill.Assign(this.FAppearance.FSplitterDownFill),t.FStroke.Assign(this.FAppearance.FSplitterDownStroke)):this.FMouseHover?(t.FFill.Assign(this.FAppearance.FSplitterHoverFill),t.FStroke.Assign(this.FAppearance.FSplitterHoverStroke)):(t.FFill.Assign(this.FAppearance.FSplitterFill),t.FStroke.Assign(this.FAppearance.FSplitterStroke)),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),2)},this.DrawIndicator=function(t,e){if(this.FShowIndicator){this.FMouseDown?(t.FFill.Assign(this.FAppearance.FIndicatorDownFill),t.FStroke.Assign(this.FAppearance.FIndicatorDownStroke)):this.FMouseHover?(t.FFill.Assign(this.FAppearance.FIndicatorHoverFill),t.FStroke.Assign(this.FAppearance.FIndicatorHoverStroke)):(t.FFill.Assign(this.FAppearance.FIndicatorFill),t.FStroke.Assign(this.FAppearance.FIndicatorStroke));var i=this.FSplitterIndicator;0===i?this.DrawIndicatorCircle(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)):1===i?this.DrawIndicatorCircles(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)):5===i?this.DrawIndicatorImage(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)):2===i?this.DrawIndicatorLine(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)):3===i?this.DrawIndicatorSquare(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)):4===i&&this.DrawIndicatorSquares(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))}},this.FindControl=function(){var t=null,e=pas["WEBLib.TMSFNCTypes"].TPointF.$new(),i=0,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=!1,o=!1;t=null,e.$assign(pas["WEBLib.TMSFNCTypes"].PointF(this.GetLeft(),this.GetTop()));var r=this.GetSplitterAlign();if(3===r)e.X=e.X-1;else if(4===r)e.X=e.X+this.GetWidth();else if(1===r)e.Y=e.Y-1;else{if(2!==r)return t;e.Y=e.Y+this.GetHeight()}if(null!==this.FParent){o=this.GetSplitterAlign()in rtl.createSet(1,2),n=this.GetSplitterAlign()in rtl.createSet(3,4);for(var a=0,l=this.FParent.GetControlsCount()-1;a<=l;a++)if(i=a,t=this.FParent.GetControls(i),(!n||t.FAlign in rtl.createSet(3,4))&&(!o||t.FAlign in rtl.createSet(1,2))&&t.FVisible&&(s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.GetBoundsRect().Left,t.GetBoundsRect().Top,t.GetBoundsRect().Right,t.GetBoundsRect().Bottom)),s.Right-s.Left==0&&(this.GetSplitterAlign()in rtl.createSet(1,3)?s.Left=s.Left-1:s.Right=s.Right+1),s.Bottom-s.Top==0&&(this.GetSplitterAlign()in rtl.createSet(1,3)?s.Top=s.Top-1:s.Bottom=s.Bottom+1),pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.PointInRect(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(e),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s))))return t}return t=null},this.HandleMouseDown=function(t,e,i,s){var n=0,o=null;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.CaptureEx(),0===t&&null!=this.FParent){if(this.FDownPos.$assign(pas["WEBLib.TMSFNCTypes"].PointF(i,s)),this.FControl=this.FindControl(),null!==this.FControl){if(this.GetSplitterAlign()in rtl.createSet(4,3)){this.FMaxSize=this.FParent.GetClientWidth()-this.FMinSize;for(var r=0,a=this.FParent.GetControlsCount()-1;r<=a;r++)n=r,pas["WEBLib.Controls"].TControl.isPrototypeOf(this.FParent.GetControls(n))&&(o=this.FParent.GetControls(n)).FVisible&&o.FAlign in rtl.createSet(3,4)&&(this.FMaxSize=this.FMaxSize-o.GetWidth());this.FMaxSize=this.FMaxSize+this.FControl.GetWidth()}else{this.FMaxSize=this.FParent.GetClientHeight()-this.FMinSize;for(var l=0,h=this.FParent.GetControlsCount()-1;l<=h;l++)n=l,pas["WEBLib.Controls"].TControl.isPrototypeOf(this.FParent.GetControls(n))&&(o=this.FParent.GetControls(n)).FVisible&&o.FAlign in rtl.createSet(1,2)&&(this.FMaxSize=this.FMaxSize-o.GetHeight());this.FMaxSize=this.FMaxSize+this.FControl.GetHeight()}this.UpdateSplitterSize(i,s)}0===this.FResizeStyle&&this.DrawLine(),this.FMouseDown=!0,this.Invalidate()}},this.HandleMouseEnter=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseEnter.call(this),this.FMouseHover=!0,this.Invalidate()},this.HandleMouseLeave=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),this.FMouseHover=!1,this.Invalidate()},this.HandleMouseMove=function(t,e,i){var s=0,n=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),this.FMouseDown&&null!==this.FControl&&this.FControl.FVisible&&(this.CalcSplitSize(e,i,{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}}),this.DoCanResize({get:function(){return s},set:function(t){s=t}})&&(this.FNewSize=s,this.FSplit=n,this.DoSplitterMove(this.FResizeStyle,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(this.FDownPos),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(e,i)),this.FSplit),1===this.FResizeStyle&&this.UpdateSplitterControlSize(),0===this.FResizeStyle&&this.DrawLine()))},this.HandleMouseUp=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),null!=this.FControl&&(this.UpdateSplitterControlSize(),this.DoSplitterMoved(this.FResizeStyle,pas["WEBLib.TMSFNCTypes"].TPointF.$clone(this.FDownPos),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i,s)),this.FSplit)),null!=this.FCache&&(rtl.free(this,"FCache"),this.FCache=null),this.ReleaseCaptureEx(),this.FMouseDown=!1,this.FControl=null,this.FDownPos.$assign(pas["WEBLib.TMSFNCTypes"].PointF(-1,-1)),this.Invalidate()},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments)},this.UpdateSplitterControlSize=function(){if(this.FNewSize!==this.FOldSize){var t=this.GetSplitterAlign();3===t?this.FControl.SetWidth(Math.round(this.FNewSize)):4===t?(this.FControl.SetLeft(this.FControl.GetLeft()+(this.FControl.GetWidth()-Math.round(this.FNewSize))),this.FControl.SetWidth(Math.round(this.FNewSize))):1===t?this.FControl.SetHeight(Math.round(this.FNewSize)):2===t&&(this.FControl.SetTop(this.FControl.GetTop()+(this.FControl.GetHeight()-Math.round(this.FNewSize))),this.FControl.SetHeight(Math.round(this.FNewSize)))}this.FOldSize=this.FNewSize},this.UpdateSplitterSize=function(t,e){this.CalcSplitSize(t,e,{p:this,get:function(){return this.p.FNewSize},set:function(t){this.p.FNewSize=t}},{p:this,get:function(){return this.p.FSplit},set:function(t){this.p.FSplit=t}})},this.SetSplitterAlign=function(t){var e;e=Math.min(this.GetWidth(),this.GetHeight()),this.SetAlign(t),this.GetSplitterAlign()in rtl.createSet(1,2)?this.SetControlCursor(15):this.SetControlCursor(14),this.SetBounds(this.GetLeft(),this.GetTop(),Math.round(e),Math.round(e))},this.GetSplitterAlign=function(){return this.FAlign},this.SetParent=function(t){pas["WEBLib.Controls"].TControl.SetParent.apply(this,arguments),this.SetSplitterAlign(this.GetSplitterAlign())},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FAppearance=t.TTMSFNCSplitterAppearance.$create("Create$1",[this]),this.FAppearance.FOnChange=rtl.createCallback(this,"AppearanceChanged"),this.FSplitterIndicator=0,this.FShowIndicator=!0,this.FResizeStyle=1,this.FMouseHover=!1,this.FMouseDown=!1,this.FDownPos.$assign(pas["WEBLib.TMSFNCTypes"].PointF(-1,-1)),this.FMinSize=20,this.SetWidth(10),this.SetHeight(15),this.SetAlign(3),this},this.Destroy=function(){rtl.free(this,"FAppearance"),null!=this.FCache&&rtl.free(this,"FCache"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Draw=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),2),this.DrawBackGroundColor(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),this.DrawIndicator(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCSplitter",this.TTMSFNCCustomSplitter,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Align",3,pas["WEBLib.Controls"].$rtti.TAlign,"GetSplitterAlign","SetSplitterAlign"),e.addProperty("Appearance",2,t.$rtti.TTMSFNCSplitterAppearance,"FAppearance","SetAppearance"),e.addProperty("MinSize",2,rtl.double,"FMinSize","SetMinSize"),e.addProperty("ResizeStyle",2,t.$rtti.TTMSFNCSplitterResizeStyle,"FResizeStyle","SetResizeStyle",{Default:t.TTMSFNCSplitterResizeStyle.rsContinuous}),e.addProperty("ShowIndicator",2,rtl.boolean,"FShowIndicator","SetShowIndicator",{Default:!0}),e.addProperty("SplitterIndicator",2,t.$rtti.TTMSFNCSplitterIndicator,"FSplitterIndicator","SetSplitterIndicator",{Default:t.TTMSFNCSplitterIndicator.siCircle}),e.addProperty("OnAppearanceChanged",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnAppearanceChanged","FOnAppearanceChanged"),e.addProperty("OnChanged",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChanged","FOnChanged"),e.addProperty("OnSplitterMove",0,t.$rtti.TTMSFNCSplitterMoveEvent,"FOnSplitterMove","FOnSplitterMove"),e.addProperty("OnSplitterMoved",0,t.$rtti.TTMSFNCSplitterMoveEvent,"FOnSplitterMoved","FOnSplitterMoved"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["Math","WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCPanel",["System","Classes","WEBLib.TMSFNCCustomControl","Types","WEBLib.TMSFNCTypes","WEBLib.Controls","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCPopup","WEBLib.TMSFNCGraphicsTypes","TypInfo"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=2,this.BLD_VER=0,this.MINSECTIONHEIGHT=16,this.TTMSFNCPanelButton={0:"pbCompact",pbCompact:0,1:"pbClose",pbClose:1,2:"pbExpander",pbExpander:2,3:"pbDropDown",pbDropDown:3},this.$rtti.$Enum("TTMSFNCPanelButton",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TTMSFNCPanelButton}),this.$rtti.$Set("TTMSFNCPanelButtons",{comptype:this.$rtti.TTMSFNCPanelButton}),this.TTMSFNCPanelCloseAction={0:"pcaNone",pcaNone:0,1:"pcaFree",pcaFree:1,2:"pcaHide",pcaHide:2},this.$rtti.$Enum("TTMSFNCPanelCloseAction",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCPanelCloseAction}),this.TTMSFNCPanelDropDownAction={0:"pddaNone",pddaNone:0,1:"pddaPopup",pddaPopup:1},this.$rtti.$Enum("TTMSFNCPanelDropDownAction",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCPanelDropDownAction}),this.TTMSFNCPanelExpandAction={0:"peaNone",peaNone:0,1:"peaExpand",peaExpand:1},this.$rtti.$Enum("TTMSFNCPanelExpandAction",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCPanelExpandAction}),this.TTMSFNCPanelCompactAction={0:"pcNone",pcNone:0,1:"pcCompact",pcCompact:1},this.$rtti.$Enum("TTMSFNCPanelCompactAction",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCPanelCompactAction}),rtl.createClass(this,"TTMSFNCPanelElement",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOnChanged=null,this.FText="",this.FSize=0,this.FWordWrapping=!1,this.FVerticalTextAlign=0,this.FHorizontalTextAlign=0,this.FTrimming=0,this.FFont=null,this.FShowButtons=!1,this.FButtons={},this.FVisible=!1,this.FButtonSpacing=0,this.FButtonSize=0,this.FFill=null,this.FStroke=null,this.FStretchText=!1,this.FDropDownControl=null,this.FDropDownHeight=0,this.FDropDownWidth=0},this.$final=function(){this.FOnChanged=void 0,this.FFont=void 0,this.FButtons=void 0,this.FFill=void 0,this.FStroke=void 0,this.FDropDownControl=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.Changed())},this.IsSizeStored=function(){return 28!==this.FSize},this.SetSize=function(t){this.FSize!==t&&(this.FSize=t,this.Changed())},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t,this.Changed())},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,this.Changed())},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,this.Changed())},this.SetTrimming=function(t){this.FTrimming!==t&&(this.FTrimming=t,this.Changed())},this.SetFont=function(t){this.FFont.AssignSource(t)},this.SetButtons=function(t){rtl.neSet(this.FButtons,t)&&(this.FButtons=rtl.refSet(t),this.Changed())},this.SetShowButtons=function(t){this.FShowButtons!==t&&(this.FShowButtons=t,this.Changed())},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,this.Changed())},this.IsButtonSizeStored=function(){return 20!==this.FButtonSize},this.IsButtonSpacingStored=function(){return 4!==this.FButtonSpacing},this.SetButtonSize=function(t){this.FButtonSize!==t&&(this.FButtonSize=t,this.Changed())},this.SetButtonSpacing=function(t){this.FButtonSpacing!==t&&(this.FButtonSpacing=t,this.Changed())},this.SetFill=function(t){this.FFill.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.SetStretchText=function(t){this.FStretchText!==t&&(this.FStretchText=t,this.Changed())},this.SetDropDownControl=function(t){null===t&&null!=this.FDropDownControl&&this.FDropDownControl.SetVisible(!0),this.FDropDownControl=t,null!=this.FDropDownControl&&(this.FDropDownControl.SetVisible(!1),this.FDropDownWidth=this.FDropDownControl.GetWidth(),this.FDropDownHeight=this.FDropDownControl.GetHeight())},this.IsDropDownHeightStored=function(){return 120!==this.FDropDownHeight},this.IsDropDownWidthStored=function(){return 100!==this.FDropDownWidth},this.Changed=function(){null!=this.FOnChanged&&this.FOnChanged(this)},this.FontChanged=function(t){this.Changed()},this.FillChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.IsHTML=function(){return pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.IsHTML(this.FText)},this.Create$1=function(){return this.FSize=28,this.FVisible=!0,this.FStretchText=!0,this.FHorizontalTextAlign=0,this.FVerticalTextAlign=0,this.FWordWrapping=!0,this.FTrimming=0,this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FShowButtons=!0,this.FButtons={},this.FButtonSpacing=4,this.FButtonSize=20,this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(228,228,228),8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FDropDownWidth=100,this.FDropDownHeight=120,this},this.Destroy=function(){rtl.free(this,"FFont"),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCPanelElement.isPrototypeOf(e)&&(this.FText=rtl.as(e,t.TTMSFNCPanelElement).FText,this.FStretchText=rtl.as(e,t.TTMSFNCPanelElement).FStretchText,this.FSize=rtl.as(e,t.TTMSFNCPanelElement).FSize,this.FHorizontalTextAlign=rtl.as(e,t.TTMSFNCPanelElement).FHorizontalTextAlign,this.FVerticalTextAlign=rtl.as(e,t.TTMSFNCPanelElement).FVerticalTextAlign,this.FWordWrapping=rtl.as(e,t.TTMSFNCPanelElement).FWordWrapping,this.FTrimming=rtl.as(e,t.TTMSFNCPanelElement).FTrimming,this.FFont.AssignSource(rtl.as(e,t.TTMSFNCPanelElement).FFont),this.FShowButtons=rtl.as(e,t.TTMSFNCPanelElement).FShowButtons,this.FButtons=rtl.refSet(rtl.as(e,t.TTMSFNCPanelElement).FButtons),this.FVisible=rtl.as(e,t.TTMSFNCPanelElement).FVisible,this.FButtonSpacing=rtl.as(e,t.TTMSFNCPanelElement).FButtonSpacing,this.FButtonSize=rtl.as(e,t.TTMSFNCPanelElement).FButtonSize,this.FStretchText=rtl.as(e,t.TTMSFNCPanelElement).FStretchText,this.FDropDownWidth=rtl.as(e,t.TTMSFNCPanelElement).FDropDownWidth,this.FDropDownHeight=rtl.as(e,t.TTMSFNCPanelElement).FDropDownHeight,this.FFill.Assign(rtl.as(e,t.TTMSFNCPanelElement).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCPanelElement).FStroke))};var e=this.$rtti;e.addProperty("StretchText",2,rtl.boolean,"FStretchText","SetStretchText",{Default:!0}),e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("Size",14,rtl.double,"FSize","SetSize",{stored:"IsSizeStored"}),e.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),e.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!0}),e.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttNone}),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("ShowButtons",2,rtl.boolean,"FShowButtons","SetShowButtons",{Default:!0}),e.addProperty("Buttons",2,t.$rtti.TTMSFNCPanelButtons,"FButtons","SetButtons",{Default:{}}),e.addProperty("ButtonSize",14,rtl.double,"FButtonSize","SetButtonSize",{stored:"IsButtonSizeStored"}),e.addProperty("ButtonSpacing",14,rtl.double,"FButtonSpacing","SetButtonSpacing",{stored:"IsButtonSpacingStored"}),e.addProperty("DropDownControl",2,pas["WEBLib.Controls"].$rtti.TControl,"FDropDownControl","SetDropDownControl"),e.addProperty("DropDownWidth",12,rtl.double,"FDropDownWidth","FDropDownWidth",{stored:"IsDropDownWidthStored"}),e.addProperty("DropDownHeight",12,rtl.double,"FDropDownHeight","FDropDownHeight",{stored:"IsDropDownHeightStored"})})),rtl.createClass(this,"TTMSFNCPanelHeader",this.TTMSFNCPanelElement,(function(){})),rtl.createClass(this,"TTMSFNCPanelFooter",this.TTMSFNCPanelElement,(function(){this.Create$1=function(){return t.TTMSFNCPanelElement.Create$1.call(this),this.FShowButtons=!1,this.FVisible=!1,this};var e=this.$rtti;e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!1}),e.addProperty("ShowButtons",2,rtl.boolean,"FShowButtons","SetShowButtons",{Default:!1})})),this.TTMSFNCPanelButtonState={0:"bsNormal",bsNormal:0,1:"bsHover",bsHover:1,2:"bsDown",bsDown:2},rtl.createClass(this,"TTMSFNCPanelButtonStates",pas.Classes.TList,(function(){this.GetItem=function(t){return this.Get(t)},this.SetItem=function(t,e){this.Put(t,e)}})),rtl.recNewT(this,"TTMSFNCPanelDownButton",(function(){this.Button=0,this.Down=!1,this.$eq=function(t){return this.Button===t.Button&&this.Down===t.Down},this.$assign=function(t){return this.Button=t.Button,this.Down=t.Down,this}})),this.TTMSFNCPanelExpandState={0:"pesCollapsed",pesCollapsed:0,1:"pesExpanded",pesExpanded:1},this.TTMSFNCPanelCompactState={0:"pcsCollapsed",pcsCollapsed:0,1:"pcsExpanded",pcsExpanded:1},this.$rtti.$MethodVar("TTMSFNCPanelAnchorClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AAnchor",rtl.string]]),methodkind:0}),rtl.createClass(this,"TTMSFNCPanelSection",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FOwner=null,this.FSize=0,this.FTag=0,this.FText="",this.FControl=null},this.$final=function(){this.FOwner=void 0,this.FControl=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetSize=function(t){this.FSize!==t&&(this.FSize=t,this.Changed$1())},this.IsSizeStored=function(){return 48!==this.FSize},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.Changed$1())},this.SetControl=function(t){var e=0,i=null;if(this.FControl!==t){if(null!=t&&null!=(i=this.FOwner)){for(var s=0,n=i.FSections.GetCount()-1;s<=n;s++)e=s,i.FSections.GetItem$1(e).FControl===t&&i.FSections.GetItem$1(e).SetControl(null);t.FParent!==i&&t.SetParent(i)}this.FControl=t,null!=this.FControl&&this.UpdateControlBounds()}},this.Changed$1=function(){null!=this.FOwner&&this.FOwner.Invalidate()},this.UpdateControlBounds=function(){var t=0,e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=null,s=null,n=0;if(null!=this.FControl&&null!=(i=this.FOwner)){e.$assign(i.GetSectionRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i.GetLocalRect())));for(var o=0,r=this.GetIndex()-1;o<=r;o++)t=o,e.Top=e.Top+i.FSections.GetItem$1(t).FSize;(s=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene();try{s.FFont.AssignSource(i.FSectionsAppearance.FFont),n=Math.max(16,s.CalculateTextHeight$1(this.FText)+4)}finally{s.EndScene(),s=rtl.freeLoc(s)}e.Top=e.Top+n-1,this.GetIndex()!==i.FSections.GetCount()-1&&(e.Bottom=e.Top+this.FSize-n+1),pas["WEBLib.TMSFNCTypes"].EqualRectEx(pas["WEBLib.TMSFNCTypes"].ConvertToRectF(this.FControl.GetBoundsRect()),e)||(this.FControl.SetBoundsRect(pas["WEBLib.TMSFNCTypes"].ConvertToRect(e)),i.Invalidate())}},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FOwner=rtl.as(this.FCollection,t.TTMSFNCPanelSections).FOwner$1),this.FSize=48,this.Changed$1(),this},this.Assign=function(e){t.TTMSFNCPanelSection.isPrototypeOf(e)&&(this.FText=rtl.as(e,t.TTMSFNCPanelSection).FText,this.FSize=rtl.as(e,t.TTMSFNCPanelSection).FSize)},this.Destroy=function(){pas.Classes.TCollectionItem.Destroy.call(this),this.Changed$1()};var e=this.$rtti;e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("Size",14,rtl.double,"FSize","SetSize",{stored:"IsSizeStored"}),e.addProperty("Control",2,pas["WEBLib.Controls"].$rtti.TControl,"FControl","SetControl"),e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag",{Default:0})})),rtl.createClass(this,"TTMSFNCPanelSections",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FOwner$1=null,this.FOnChanged=null},this.$final=function(){this.FOwner$1=void 0,this.FOnChanged=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TTMSFNCPanelSection),this.FOwner$1=e,this}})),rtl.createClass(this,"TTMSFNCPanelSectionsAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FFont=null,this.FFill=null,this.FStroke=null,this.FOnChange=null},this.$final=function(){this.FFont=void 0,this.FFill=void 0,this.FStroke=void 0,this.FOnChange=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetFont=function(t){this.FFont.AssignSource(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.FillChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.FontChanged=function(t){this.Changed()},this.Assign=function(e){t.TTMSFNCPanelSectionsAppearance.isPrototypeOf(e)&&(this.FFill.Assign(rtl.as(e,t.TTMSFNCPanelSectionsAppearance).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCPanelSectionsAppearance).FStroke),this.FFont.AssignSource(rtl.as(e,t.TTMSFNCPanelSectionsAppearance).FFont))},this.Create$1=function(){return this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(240,240,240),8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this},this.Destroy=function(){rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FFont"),pas.System.TObject.Destroy.call(this)};var e=this.$rtti;e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke")})),rtl.createClass(this,"TTMSFNCCustomPanel",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FOldHeight=0,this.FOldWidth=0,this.FPopup=null,this.FExpandState=0,this.FCompactState=0,this.FHeaderDownButton=t.TTMSFNCPanelDownButton.$new(),this.FFooterDownButton=t.TTMSFNCPanelDownButton.$new(),this.FHeaderButtonStates=null,this.FFooterButtonStates=null,this.FHeaderAnchor="",this.FFooterAnchor="",this.FBitmapContainer=null,this.FHeader=null,this.FFooter=null,this.FOnHeaderDropDownButtonClick=null,this.FOnHeaderExpandButtonClick=null,this.FOnHeaderCloseButtonClick=null,this.FOnHeaderAnchorClick=null,this.FOnFooterAnchorClick=null,this.FOnFooterDropDownButtonClick=null,this.FOnFooterExpandButtonClick=null,this.FOnFooterCloseButtonClick=null,this.FCloseAction=0,this.FDropDownAction=0,this.FExpandAction=0,this.FCompactAction=0,this.FSections=null,this.FSectionsAppearance=null,this.FOnHeaderCompactButtonClick=null,this.FOnFooterCompactButtonClick=null,this.FOnInternalHeaderCompactButtonClick=null,this.FGlobalFont=null},this.$final=function(){this.FPopup=void 0,this.FHeaderDownButton=void 0,this.FFooterDownButton=void 0,this.FHeaderButtonStates=void 0,this.FFooterButtonStates=void 0,this.FBitmapContainer=void 0,this.FHeader=void 0,this.FFooter=void 0,this.FOnHeaderDropDownButtonClick=void 0,this.FOnHeaderExpandButtonClick=void 0,this.FOnHeaderCloseButtonClick=void 0,this.FOnHeaderAnchorClick=void 0,this.FOnFooterAnchorClick=void 0,this.FOnFooterDropDownButtonClick=void 0,this.FOnFooterExpandButtonClick=void 0,this.FOnFooterCloseButtonClick=void 0,this.FSections=void 0,this.FSectionsAppearance=void 0,this.FOnHeaderCompactButtonClick=void 0,this.FOnFooterCompactButtonClick=void 0,this.FOnInternalHeaderCompactButtonClick=void 0,this.FGlobalFont=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,this.Invalidate()},this.SetFooter=function(t){this.FFooter.Assign(t)},this.SetHeader=function(t){this.FHeader.Assign(t)},this.SetCloseAction=function(t){this.FCloseAction=t},this.SetDropDownAction=function(t){this.FDropDownAction=t},this.SetExpandAction=function(t){this.FExpandAction=t},this.SetCompactAction=function(t){this.FCompactAction=t},this.SetSections=function(t){this.FSections.Assign(t)},this.SetSectionsAppearance=function(t){this.FSectionsAppearance.Assign(t)},this.SetGlobalFont=function(t){this.FGlobalFont.Assign(t)},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),this.FFill.SetKind(0),this.FHeader.FStroke.SetColor(this.FStroke.FColor),this.FFooter.FStroke.SetColor(this.FStroke.FColor),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FHeader.FFill.SetKind(1),this.FHeader.FFill.SetColor(t),this.FFooter.FFill.SetKind(1),this.FFooter.FFill.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleHeaderFillColorTo({get:function(){return t},set:function(e){t=e}})&&(this.FHeader.FFill.SetKind(2),this.FHeader.FFill.SetColorTo(t),this.FFooter.FFill.SetKind(2),this.FFooter.FFill.SetColorTo(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&(this.FHeader.FFont.SetColor(t),this.FFooter.FFont.SetColor(t))},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FFill.SetKind(1),this.FHeader.FStroke.SetColor(12632256),this.FFooter.FStroke.SetColor(12632256),this.BeginUpdate(),this.FHeader.FFill.SetColor(16380654),this.FHeader.FFont.SetColor(4539717),this.FFooter.FFill.SetColor(16380654),this.FFooter.FFont.SetColor(4539717),this.FHeader.FStroke.SetKind(0),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(this.FHeader.FFont,14,this.FPaintScaleFactor),this.FHeader.FFont.SetStyle(rtl.createSet(0)),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(this.FFooter.FFont,14,this.FPaintScaleFactor),this.EndUpdate()},this.GetElementRect=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e===this.FHeader?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left,t.Top,t.Right,t.Top+e.FSize)):e===this.FFooter&&i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left,t.Bottom-e.FSize,t.Right,t.Bottom)),i},this.GetTextRect=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;return s=e.FStretchText?t.Right:this.GetButtonsRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),e).Left,e===this.FHeader?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left,t.Top,s,t.Top+e.FSize)):e===this.FFooter&&i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left,t.Bottom-e.FSize,s,t.Bottom)),i},this.GetSectionRect=function(t){var e=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e.$assign(t),this.FHeader.FVisible&&(e.Top=e.Top+this.FHeader.FSize),this.FFooter.FVisible&&(e.Bottom=e.Bottom-this.FFooter.FSize),e},this.GetButtonsRect=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;if(e===this.FHeader?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Right,t.Top,t.Right,t.Top+e.FSize)):e===this.FFooter&&i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Right,t.Bottom-e.FSize,t.Right,t.Bottom)),e.FShowButtons&&rtl.neSet(e.FButtons,{}))for(s=0;s<=3;s++)s in e.FButtons&&(0===s&&0===this.FCompactState||1===this.FCompactState)&&(i.Left=i.Left-e.FButtonSpacing-e.FButtonSize);return i},this.XYToAnchor=function(t,e,i){var s="",n=null,o=0,r=0;if(s="",i.IsHTML()){(n=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),n.FOptimizedHTMLDrawing=this.FOptimizedHTMLDrawing,n.FBitmapContainer=this.GetBitmapContainer();try{n.FFont.Assign(i.FFont),o=i.FHorizontalTextAlign,r=i.FVerticalTextAlign,s=n.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetTextRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetLocalRect()),i)),i.FText,i.FWordWrapping,o,r,i.FTrimming,0,-1,-1,!0,!0,t,e)}finally{n.EndScene(),n=rtl.freeLoc(n)}}return s},this.XYToButton=function(t,e,i,s){var n=!1,o=0,r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(n=!1,!i.FShowButtons||rtl.eqSet(i.FButtons,{}))return n;for(a.$assign(this.GetButtonsRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetLocalRect()),i)),o=0;o<=3;o++)if(o in i.FButtons&&(0===o&&0===this.FCompactState||1===this.FCompactState)){if(r.$assign(pas["WEBLib.TMSFNCTypes"].RectF(a.Right-i.FButtonSpacing-i.FButtonSize,a.Top+(a.Bottom-a.Top-i.FButtonSize)/2,a.Right-i.FButtonSpacing,a.Top+(a.Bottom-a.Top-i.FButtonSize)/2+i.FButtonSize)),pas["WEBLib.TMSFNCTypes"].PtInRectEx(r,pas["WEBLib.TMSFNCTypes"].PointF(t,e))){s.set(o),n=!0;break}a.Right=a.Right-i.FButtonSpacing-i.FButtonSize}return n},this.ClearButtonStates=function(t){var e=!1,i=0,s=0;e=!1;for(var n=0,o=this.FHeaderButtonStates.GetCount()-1;n<=o;n++)i=n,0!==(s=this.FHeaderButtonStates.GetItem(i))&&(e=!0),(t&&1===s||!t)&&this.FHeaderButtonStates.SetItem(i,0);for(var r=0,a=this.FFooterButtonStates.GetCount()-1;r<=a;r++)i=r,0!==(s=this.FFooterButtonStates.GetItem(i))&&(e=!0),(t&&1===s||!t)&&this.FFooterButtonStates.SetItem(i,0);return e},this.GetButtonRect=function(t,e,i){var s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=pas["WEBLib.TMSFNCTypes"].TRectF.$new();for(r.$assign(this.GetButtonsRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(t),e)),n=0;n<=3;n++)n in e.FButtons&&(0===n&&0===this.FCompactState||1===this.FCompactState)&&(o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(r.Right-e.FButtonSpacing-e.FButtonSize),Math.round(r.Top+(r.Bottom-r.Top-e.FButtonSize)/2),Math.round(r.Right-e.FButtonSpacing),Math.round(r.Top+(r.Bottom-r.Top-e.FButtonSize)/2+e.FButtonSize))),r.Right=r.Right-e.FButtonSpacing-e.FButtonSize,n===i&&s.$assign(o));return s},this.GetCollapsedHeight=function(){var t=0;return t=0,this.FHeader.FVisible&&(t+=this.FHeader.FSize),this.FFooter.FVisible&&(t+=this.FFooter.FSize),t},this.GetCollapsedWidth=function(){return this.FHeader.FButtonSize+2*this.FHeader.FButtonSpacing},this.IsAppearanceProperty=function(t,e,i){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.IsAppearanceProperty.call(this,t,e,i)||"Header"===e||"Footer"===e},this.Notification=function(t,e){var i=0;if(pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),3 in this.FComponentState||1!==e||t!==this.FBitmapContainer||(this.FBitmapContainer=null),!(3 in this.FComponentState)&&1===e)for(var s=0,n=this.FSections.GetCount()-1;s<=n;s++)i=s,t===this.FSections.GetItem$1(i).FControl&&(this.FSections.GetItem$1(i).FControl=null)},this.FooterChanged=function(t){this.Realign(),this.Invalidate()},this.HeaderChanged=function(t){this.Realign(),this.Invalidate()},this.SectionsChanged=function(t){this.UpdateControlBounds(),this.Invalidate()},this.SectionsAppearanceChanged=function(t){this.UpdateControlBounds(),this.Invalidate()},this.Draw=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),t.FBitmapContainer=this.GetBitmapContainer(),this.DrawSections(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetSectionRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)))),this.DrawElement(t,this.FHeader,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetTextRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FHeader)),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetElementRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FHeader)),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetButtonsRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FHeader)),this.FHeaderButtonStates),this.DrawElement(t,this.FFooter,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetTextRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FFooter)),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetElementRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FFooter)),pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetButtonsRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FFooter)),this.FFooterButtonStates)},this.DrawSections=function(t,e){var i=0,s=null,n=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();n=0,t.FFill.Assign(this.FSectionsAppearance.FFill),t.FStroke.Assign(this.FSectionsAppearance.FStroke),t.FFont.AssignSource(this.FSectionsAppearance.FFont);for(var r=0,a=this.FSections.GetCount()-1;r<=a;r++)i=r,s=this.FSections.GetItem$1(i),o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left,e.Top+n,e.Right,e.Top+n+Math.max(16,t.CalculateTextHeight$1(s.FText)+4))),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),11),pas["WEBLib.TMSFNCTypes"].InflateRectEx(o,-2,-2),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),s.FText,!1,1,0,0,0,-1,-1,!0,!1,-1,-1),n+=s.FSize},this.DrawElement=function(t,e,i,s,n,o){var r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),l=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),h=0,F=0,p=0;if(e.FVisible&&(t.FFill.Assign(e.FFill),t.FStroke.Assign(e.FStroke),t.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),2),1===this.FCompactState&&(r.$assign(i),pas["WEBLib.TMSFNCTypes"].InflateRectEx(r,this.ScalePaintValue(-3),this.ScalePaintValue(-3)),t.FFont.AssignSource(e.FFont),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(r),e.FText,e.FWordWrapping,e.FHorizontalTextAlign,e.FVerticalTextAlign,e.FTrimming,0,-1,-1,!0,!1,-1,-1)),e.FShowButtons&&rtl.neSet(e.FButtons,{})))for(a.$assign(n),h=0;h<=3;h++)if(h in e.FButtons&&(0===h&&0===this.FCompactState||1===this.FCompactState)){l.$assign(pas["WEBLib.TMSFNCTypes"].RectF(Math.round(a.Right-e.FButtonSpacing-e.FButtonSize),Math.round(a.Top+(a.Bottom-a.Top-e.FButtonSize)/2),Math.round(a.Right-e.FButtonSpacing),Math.round(a.Top+(a.Bottom-a.Top-e.FButtonSize)/2+e.FButtonSize))),F=this.FExpandState,p=this.FCompactState;var c=h;0===c?t.DrawCompactButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),p,2===o.GetItem(h),1===o.GetItem(h),!0,this.GetAdaptToStyle(),this.FPaintScaleFactor):1===c?t.DrawCloseButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),2===o.GetItem(h),1===o.GetItem(h),!0,this.GetAdaptToStyle(),this.FPaintScaleFactor):2===c?t.DrawExpanderButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),F,2===o.GetItem(h),1===o.GetItem(h),!0,this.GetAdaptToStyle(),this.FPaintScaleFactor):3===c&&t.DrawDropDownButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),2===o.GetItem(h),1===o.GetItem(h),!0,!0,this.GetAdaptToStyle(),this.FPaintScaleFactor),a.Right=a.Right-e.FButtonSpacing-e.FButtonSize}},this.HandleMouseLeave=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),this.ClearButtonStates(!1)&&this.Invalidate()},this.UpdateControlAfterResize=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.UpdateControlAfterResize.call(this),this.UpdateControlBounds()},this.HandleMouseDown=function(t,e,i,s){var n=!1,o=!1,r=0,a=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.FHeaderDownButton.Down=!1,this.FFooterDownButton.Down=!1,o=!1,r=1,(n=this.XYToButton(i,s,this.FHeader,{get:function(){return r},set:function(t){r=t}}))?(this.FHeaderButtonStates.SetItem(r,2),this.FHeaderDownButton.Down=!0,this.FHeaderDownButton.Button=r):(a=1,(o=this.XYToButton(i,s,this.FFooter,{get:function(){return a},set:function(t){a=t}}))&&(this.FFooterButtonStates.SetItem(a,2),this.FFooterDownButton.Down=!0,this.FFooterDownButton.Button=a)),n||o||(this.FHeaderAnchor=this.XYToAnchor(i,s,this.FHeader),""===this.FHeaderAnchor&&(this.FFooterAnchor=this.XYToAnchor(i,s,this.FFooter))),(o||n)&&this.Invalidate()},this.HandleMouseMove=function(t,e,i){var s="",n="",o=!1,r=!1,a=!1,l=0,h=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),a=!1,o=!1,r=!1,this.FHeaderDownButton.Down||this.FFooterDownButton.Down||(a=this.ClearButtonStates(!0),r=!1,l=1,(o=this.XYToButton(e,i,this.FHeader,{get:function(){return l},set:function(t){l=t}}))?this.FHeaderButtonStates.SetItem(l,1):(h=1,(r=this.XYToButton(e,i,this.FFooter,{get:function(){return h},set:function(t){h=t}}))&&this.FFooterButtonStates.SetItem(h,1))),o||r||(""===(s=this.XYToAnchor(e,i,this.FHeader))&&(n=this.XYToAnchor(e,i,this.FFooter)),""!==s||""!==n?this.SetControlCursor(21):this.SetControlCursor(0)),(r||o||a)&&this.Invalidate()},this.HandleMouseUp=function(t,e,i,s){var n=0,o=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),""===this.FFooterAnchor&&""===this.FHeaderAnchor){if(n=1,this.XYToButton(i,s,this.FHeader,{get:function(){return n},set:function(t){n=t}})){if(n===this.FHeaderDownButton.Button&&this.FHeaderDownButton.Down){var r=n;0===r?this.HandleCompactAction(this.FHeader):1===r?this.HandleCloseAction(this.FHeader):2===r?this.HandleExpandAction(this.FHeader):3===r&&this.HandleDropDownAction(n,this.FHeader)}}else if(o=1,this.XYToButton(i,s,this.FFooter,{get:function(){return o},set:function(t){o=t}})&&o===this.FFooterDownButton.Button&&this.FFooterDownButton.Down){var a=o;0===a?this.HandleCompactAction(this.FFooter):1===a?this.HandleCloseAction(this.FFooter):2===a?this.HandleExpandAction(this.FHeader):3===a&&this.HandleDropDownAction(o,this.FFooter)}}else""!==this.FHeaderAnchor&&this.DoHeaderAnchorClick(this.FHeaderAnchor),""!==this.FFooterAnchor&&this.DoFooterAnchorClick(this.FFooterAnchor);this.FFooterAnchor="",this.FHeaderAnchor="",this.FHeaderDownButton.Down=!1,this.FFooterDownButton.Down=!1,this.ClearButtonStates(!1)&&this.Invalidate()},this.HandleDropDownAction=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TPointF.$new();1===this.FDropDownAction&&null!=e.FDropDownControl&&(i.$assign(this.GetButtonRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(this.GetLocalRect()),e,t)),s.$assign(this.LocalToScreenEx(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,i.Top+(i.Bottom-i.Top))))),e.FDropDownControl.SetWidth(Math.round(e.FDropDownWidth)),e.FDropDownControl.SetHeight(Math.round(e.FDropDownHeight)),this.FPopup.SetDropDownHeight(e.FDropDownHeight),this.FPopup.SetDropDownWidth(e.FDropDownWidth),this.FPopup.SetContentControl(e.FDropDownControl),this.FPopup.FFocusedControl=e.FDropDownControl,this.FPopup.SetPlacementControl(this),this.FPopup.FPlacementRectangle.SetLeft(s.X),this.FPopup.FPlacementRectangle.SetTop(s.Y),this.FPopup.FPlacementRectangle.SetRight(s.X+this.FPopup.FDropDownWidth),this.FPopup.FPlacementRectangle.SetBottom(s.Y+this.FPopup.FDropDownHeight),this.FPopup.Popup(!1)),e===this.FHeader?this.DoHeaderDropDownButtonClick():e===this.FFooter&&this.DoFooterDropDownButtonClick()},this.HandleCloseAction=function(t){2===this.FCloseAction&&this.SetVisible(!1),t===this.FHeader?this.DoHeaderCloseButtonClick():t===this.FFooter&&this.DoFooterCloseButtonClick()},this.HandleExpandAction=function(t){if(1===this.FExpandAction){var e=this.FExpandState;0===e?this.Expand(!1):1===e&&this.Collapse(!1)}t===this.FHeader?this.DoHeaderExpandButtonClick():t===this.FFooter&&this.DoFooterExpandButtonClick()},this.HandleCompactAction=function(t){if(1===this.FCompactAction){var e=this.FCompactState;0===e?this.Expand(!0):1===e&&this.Collapse(!0)}t===this.FHeader?this.DoHeaderCompactButtonClick():t===this.FFooter&&this.DoFooterCompactButtonClick()},this.DoHeaderAnchorClick=function(t){null!=this.FOnHeaderAnchorClick?this.FOnHeaderAnchorClick(this,t):pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(t)},this.DoHeaderCloseButtonClick=function(){null!=this.FOnHeaderCloseButtonClick&&this.FOnHeaderCloseButtonClick(this)},this.DoHeaderExpandButtonClick=function(){null!=this.FOnHeaderExpandButtonClick&&this.FOnHeaderExpandButtonClick(this)},this.DoHeaderDropDownButtonClick=function(){null!=this.FOnHeaderDropDownButtonClick&&this.FOnHeaderDropDownButtonClick(this)},this.DoHeaderCompactButtonClick=function(){null!=this.FOnInternalHeaderCompactButtonClick&&this.FOnInternalHeaderCompactButtonClick(this),null!=this.FOnHeaderCompactButtonClick&&this.FOnHeaderCompactButtonClick(this)},this.DoFooterAnchorClick=function(t){null!=this.FOnFooterAnchorClick?this.FOnFooterAnchorClick(this,t):pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(t)},this.DoFooterCloseButtonClick=function(){null!=this.FOnFooterCloseButtonClick&&this.FOnFooterCloseButtonClick(this)},this.DoFooterExpandButtonClick=function(){null!=this.FOnFooterExpandButtonClick&&this.FOnFooterExpandButtonClick(this)},this.DoFooterDropDownButtonClick=function(){null!=this.FOnFooterDropDownButtonClick&&this.FOnFooterDropDownButtonClick(this)},this.DoFooterCompactButtonClick=function(){null!=this.FOnFooterCompactButtonClick&&this.FOnFooterCompactButtonClick(this)},this.UpdateControlBounds=function(){for(var t=0,e=0,i=this.FSections.GetCount()-1;e<=i;e++)t=e,this.FSections.GetItem$1(t).UpdateControlBounds()},this.AlignControls=function(t,e){this.FHeader.FVisible&&(e.Top=e.Top+Math.round(this.FHeader.FSize)),this.FFooter.FVisible&&(e.Bottom=e.Bottom-Math.round(this.FFooter.FSize)),pas["WEBLib.Controls"].TControl.AlignControls.apply(this,arguments)},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this)},this.SetFonts=function(t){this.BeginUpdate(),this.FGlobalFont.ApplyChange(this.FHeader.FFont,t),this.FGlobalFont.ApplyChange(this.FFooter.FFont,t),this.FGlobalFont.ApplyChange(this.FSectionsAppearance.FFont,t),this.EndUpdate()},this.Create$1=function(e){var i=0;for(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FSectionsAppearance=t.TTMSFNCPanelSectionsAppearance.$create("Create$1"),this.FSectionsAppearance.FOnChange=rtl.createCallback(this,"SectionsAppearanceChanged"),this.FSections=t.TTMSFNCPanelSections.$create("Create$3",[this]),this.FSections.FOnChanged=rtl.createCallback(this,"SectionsChanged"),this.FFooter=t.TTMSFNCPanelFooter.$create("Create$1"),this.IsDesignTime()&&this.FFooter.SetText("Footer"),this.FFooter.FOnChanged=rtl.createCallback(this,"FooterChanged"),this.FHeader=t.TTMSFNCPanelHeader.$create("Create$1"),this.IsDesignTime()&&this.FHeader.SetText("Header"),this.FHeader.FOnChanged=rtl.createCallback(this,"HeaderChanged"),this.FHeaderButtonStates=t.TTMSFNCPanelButtonStates.$create("Create$1"),i=0;i<=3;i++)this.FHeaderButtonStates.Add(0);for(this.FFooterButtonStates=t.TTMSFNCPanelButtonStates.$create("Create$1"),i=0;i<=3;i++)this.FFooterButtonStates.Add(0);return this.FCloseAction=2,this.FExpandAction=1,this.FCompactAction=1,this.FDropDownAction=1,this.FPopup=pas["WEBLib.TMSFNCPopup"].TTMSFNCPopup.$create("Create$1",[this]),this.FPopup.SetPlacement(9),this.FExpandState=1,this.FCompactState=1,this.FGlobalFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCAppearanceGlobalFont.$create("Create$1",[this]),this.SetWidth(200),this.SetHeight(275),this.IsDesignTime()&&this.InitSample(),this},this.Destroy=function(){rtl.free(this,"FGlobalFont"),rtl.free(this,"FHeaderButtonStates"),rtl.free(this,"FFooterButtonStates"),rtl.free(this,"FFooter"),rtl.free(this,"FHeader"),rtl.free(this,"FSections"),rtl.free(this,"FSectionsAppearance"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Assign=function(e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments),t.TTMSFNCCustomPanel.isPrototypeOf(e)&&(this.FHeader.Assign(rtl.as(e,t.TTMSFNCCustomPanel).FHeader),this.FFooter.Assign(rtl.as(e,t.TTMSFNCCustomPanel).FFooter),this.FCloseAction=rtl.as(e,t.TTMSFNCCustomPanel).FCloseAction,this.FDropDownAction=rtl.as(e,t.TTMSFNCCustomPanel).FDropDownAction,this.FExpandAction=rtl.as(e,t.TTMSFNCCustomPanel).FExpandAction,this.FCompactAction=rtl.as(e,t.TTMSFNCCustomPanel).FCompactAction)},this.Expand=function(t){t?0===this.FCompactState&&(this.SetWidth(Math.round(this.FOldWidth)),this.FCompactState=1):0===this.FExpandState&&(this.SetHeight(Math.round(this.FOldHeight)),this.FExpandState=1)},this.Collapse=function(t){t?1===this.FCompactState&&(this.FOldWidth=this.GetWidth(),this.SetWidth(Math.round(this.GetCollapsedWidth())),this.FCompactState=0):1===this.FExpandState&&(this.FOldHeight=this.GetHeight(),this.SetHeight(Math.round(this.GetCollapsedHeight())),this.FExpandState=0)},this.SetBounds=function(t,e,i,s){pas["WEBLib.Controls"].TControl.SetBounds.call(this,t,e,i,s),this.UpdateControlBounds()},this.InitSample=function(){this.ResetToDefaultStyle()},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCPanel",this.TTMSFNCCustomPanel,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCPanel)},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,2,0)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("Version",1,rtl.string,"GetVersion",""),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Sections",2,t.$rtti.TTMSFNCPanelSections,"FSections","SetSections"),e.addProperty("SectionsAppearance",2,t.$rtti.TTMSFNCPanelSectionsAppearance,"FSectionsAppearance","SetSectionsAppearance"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("Header",2,t.$rtti.TTMSFNCPanelHeader,"FHeader","SetHeader"),e.addProperty("Footer",2,t.$rtti.TTMSFNCPanelFooter,"FFooter","SetFooter"),e.addProperty("CloseAction",2,t.$rtti.TTMSFNCPanelCloseAction,"FCloseAction","SetCloseAction",{Default:t.TTMSFNCPanelCloseAction.pcaHide}),e.addProperty("DropDownAction",2,t.$rtti.TTMSFNCPanelDropDownAction,"FDropDownAction","SetDropDownAction",{Default:t.TTMSFNCPanelDropDownAction.pddaPopup}),e.addProperty("ExpandAction",2,t.$rtti.TTMSFNCPanelExpandAction,"FExpandAction","SetExpandAction",{Default:t.TTMSFNCPanelExpandAction.peaExpand}),e.addProperty("CompactAction",2,t.$rtti.TTMSFNCPanelCompactAction,"FCompactAction","SetCompactAction",{Default:t.TTMSFNCPanelCompactAction.pcCompact}),e.addProperty("GlobalFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCAppearanceGlobalFont,"FGlobalFont","SetGlobalFont"),e.addProperty("OnHeaderAnchorClick",0,t.$rtti.TTMSFNCPanelAnchorClickEvent,"FOnHeaderAnchorClick","FOnHeaderAnchorClick"),e.addProperty("OnHeaderCloseButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnHeaderCloseButtonClick","FOnHeaderCloseButtonClick"),e.addProperty("OnHeaderExpandButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnHeaderExpandButtonClick","FOnHeaderExpandButtonClick"),e.addProperty("OnHeaderCompactButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnHeaderCompactButtonClick","FOnHeaderCompactButtonClick"),e.addProperty("OnHeaderDropDownButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnHeaderDropDownButtonClick","FOnHeaderDropDownButtonClick"),e.addProperty("OnFooterAnchorClick",0,t.$rtti.TTMSFNCPanelAnchorClickEvent,"FOnFooterAnchorClick","FOnFooterAnchorClick"),e.addProperty("OnFooterCloseButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnFooterCloseButtonClick","FOnFooterCloseButtonClick"),e.addProperty("OnFooterExpandButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnFooterExpandButtonClick","FOnFooterExpandButtonClick"),e.addProperty("OnFooterCompactButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnFooterCompactButtonClick","FOnFooterCompactButtonClick"),e.addProperty("OnFooterDropDownButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnFooterDropDownButtonClick","FOnFooterDropDownButtonClick"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["Math","SysUtils","WEBLib.TMSFNCUtils","WEBLib.TMSFNCStyles","WEBLib.Graphics"]),rtl.module("WEBLib.TMSFNCEdit",["System","Classes","WEBLib.TMSFNCToolBar","WEBLib.TMSFNCToolBarRes","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCTypes","WEBLib.TMSFNCPopup","WEBLib.ExtCtrls","WEBLib.StdCtrls","WEBLib.Graphics","WEBLib.Controls","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCBitmapContainer"],(function(){"use strict";var t=this,e=t.$impl;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=3,this.BLD_VER=1,this.LOOKUPITEMHEIGHT=18,this.TTMSFNCEditType={0:"etString",etString:0,1:"etNumeric",etNumeric:1,2:"etSignedNumeric",etSignedNumeric:2,3:"etFloat",etFloat:3,4:"etSignedFloat",etSignedFloat:4,5:"etUppercase",etUppercase:5,6:"etMixedCase",etMixedCase:6,7:"etLowerCase",etLowerCase:7,8:"etMoney",etMoney:8,9:"etHex",etHex:9,10:"etAlphaNumeric",etAlphaNumeric:10,11:"etValidChars",etValidChars:11},this.$rtti.$Enum("TTMSFNCEditType",{minvalue:0,maxvalue:11,ordtype:1,enumtype:this.TTMSFNCEditType}),this.TTMSFNCEditPrecisionDisplay={0:"pdNormal",pdNormal:0,1:"pdShortest",pdShortest:1},this.$rtti.$Enum("TTMSFNCEditPrecisionDisplay",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCEditPrecisionDisplay}),rtl.createClass(this,"TTMSFNCEditLookupSettings",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FDisplayList=null,this.FValueList=null,this.FDisplayCount=0,this.FColor=0,this.FEnabled=!1,this.FNumChars=0,this.FCaseSensitive=!1,this.FHistory=!1,this.FMulti=!1,this.FSeparator="",this.FAcceptOnTab=!1,this.FWidth=0,this.FHeight=0,this.FUseValueList=!1,this.FMinimumWidth=0,this.FMinimumHeight=0},this.$final=function(){this.FDisplayList=void 0,this.FValueList=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetDisplayList=function(t){this.FDisplayList.Assign(t)},this.SetValueList=function(t){this.FValueList.Assign(t)},this.SetNumChars=function(t){t>0&&(this.FNumChars=t)},this.SetHeight=function(t){this.FHeight=t},this.SetWidth=function(t){this.FWidth=t},this.SetMinimumHeight=function(t){this.FMinimumHeight=t},this.SetMinimumWidth=function(t){this.FMinimumWidth=t},this.Create$1=function(){return pas.System.TObject.Create.call(this),this.FUseValueList=!0,this.FWidth=0,this.FMinimumWidth=0,this.FHeight=0,this.FMinimumHeight=0,this.FDisplayList=pas.Classes.TStringList.$create("Create$1"),this.FDisplayList.SetSorted(!0),this.FDisplayList.FDuplicates=0,this.FValueList=pas.Classes.TStringList.$create("Create$1"),this.FColor=16777215,this.FDisplayCount=4,this.FNumChars=2,this.FEnabled=!1,this.FSeparator=";",this},this.Destroy=function(){rtl.free(this,"FValueList"),rtl.free(this,"FDisplayList"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCEditLookupSettings.isPrototypeOf(e)&&(this.FAcceptOnTab=rtl.as(e,t.TTMSFNCEditLookupSettings).FAcceptOnTab,this.FCaseSensitive=rtl.as(e,t.TTMSFNCEditLookupSettings).FCaseSensitive,this.FColor=rtl.as(e,t.TTMSFNCEditLookupSettings).FColor,this.FDisplayCount=rtl.as(e,t.TTMSFNCEditLookupSettings).FDisplayCount,this.FDisplayList.Assign(rtl.as(e,t.TTMSFNCEditLookupSettings).FDisplayList),this.FEnabled=rtl.as(e,t.TTMSFNCEditLookupSettings).FEnabled,this.FHistory=rtl.as(e,t.TTMSFNCEditLookupSettings).FHistory,this.FNumChars=rtl.as(e,t.TTMSFNCEditLookupSettings).FNumChars,this.FValueList.Assign(rtl.as(e,t.TTMSFNCEditLookupSettings).FValueList),this.FMulti=rtl.as(e,t.TTMSFNCEditLookupSettings).FMulti,this.FSeparator=rtl.as(e,t.TTMSFNCEditLookupSettings).FSeparator,this.FWidth=rtl.as(e,t.TTMSFNCEditLookupSettings).FWidth,this.FHeight=rtl.as(e,t.TTMSFNCEditLookupSettings).FHeight,this.FMinimumWidth=rtl.as(e,t.TTMSFNCEditLookupSettings).FMinimumWidth,this.FMinimumHeight=rtl.as(e,t.TTMSFNCEditLookupSettings).FMinimumHeight,this.FUseValueList=rtl.as(e,t.TTMSFNCEditLookupSettings).FUseValueList)};var e=this.$rtti;e.addProperty("CaseSensitive",0,rtl.boolean,"FCaseSensitive","FCaseSensitive",{Default:!1}),e.addProperty("DisplayCount",0,rtl.longint,"FDisplayCount","FDisplayCount",{Default:4}),e.addProperty("DisplayList",2,pas.Classes.$rtti.TStringList,"FDisplayList","SetDisplayList"),e.addProperty("Enabled",0,rtl.boolean,"FEnabled","FEnabled",{Default:!1}),e.addProperty("History",0,rtl.boolean,"FHistory","FHistory",{Default:!1}),e.addProperty("NumChars",2,rtl.longint,"FNumChars","SetNumChars",{Default:2}),e.addProperty("ValueList",2,pas.Classes.$rtti.TStringList,"FValueList","SetValueList"),e.addProperty("Multi",0,rtl.boolean,"FMulti","FMulti",{Default:!1}),e.addProperty("Separator",0,rtl.char,"FSeparator","FSeparator"),e.addProperty("Width",2,rtl.longint,"FWidth","SetWidth",{Default:0}),e.addProperty("Height",2,rtl.longint,"FHeight","SetHeight",{Default:0}),e.addProperty("MinimumWidth",2,rtl.longint,"FMinimumWidth","SetMinimumWidth",{Default:0}),e.addProperty("MinimumHeight",2,rtl.longint,"FMinimumHeight","SetMinimumHeight",{Default:0}),e.addProperty("UseValueList",0,rtl.boolean,"FUseValueList","FUseValueList",{Default:!0})})),this.$rtti.$MethodVar("TTMSFNCEditLookupSelectEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Value",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCEditLookupIndexSelectEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Index",rtl.longint],["Value",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCEditLookupNeedDataEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Value",rtl.string],["List",pas.Classes.$rtti.TStrings],["ItemIndex",rtl.longint,1]]),methodkind:0}),rtl.createClass(this,"TTMSFNCLookupListBoxItem",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FIdx=0},this.Create$1=function(t){return this.FIdx=t,this}})),rtl.createClass(this,"TTMSFNCLookupList",pas.Classes.TList,(function(){})),rtl.createClass(this,"TTMSFNCEdit",pas["WEBLib.StdCtrls"].TCustomEdit,(function(){this.$init=function(){pas["WEBLib.StdCtrls"].TCustomEdit.$init.call(this),this.FLookupListBoxItems=null,this.FAllowFocus=!1,this.FLookupFormTimer=null,this.FKeyDown=0,this.FShiftState={},this.FEditType$1=0,this.FValidChars="",this.FLookupList=null,this.FLookupListBox=null,this.FLookup=null,this.FOnLookupSelect=null,this.FOnLookupIndexSelect=null,this.FSigned=!1,this.FPrefix="",this.FSuffix="",this.FIsModified=!1,this.FLengthLimit=0,this.FFullTextSearch=!1,this.FAutoThousandSeparator=!1,this.FPrecision=0,this.FPrecisionDisplay=0,this.FBlockChange=!1,this.FAllowNumericNullValue=!1,this.FAutoComplete=!1,this.FOnLookupNeedData=null,this.FAutoClose=!1,this.FOnLookupClose=null,this.FOnLookupOpen=null},this.$final=function(){this.FLookupListBoxItems=void 0,this.FLookupFormTimer=void 0,this.FShiftState=void 0,this.FLookupList=void 0,this.FLookupListBox=void 0,this.FLookup=void 0,this.FOnLookupSelect=void 0,this.FOnLookupIndexSelect=void 0,this.FOnLookupNeedData=void 0,this.FOnLookupClose=void 0,this.FOnLookupOpen=void 0,pas["WEBLib.StdCtrls"].TCustomEdit.$final.call(this)},this.CloseLookup=function(){this.CanFocus()&&this.SetFocus(),null!=this.FLookupList&&(this.FLookupList.FIsOpen&&this.DoLookupClose(),this.FLookupList.SetIsOpen(!1))},this.DoneLookup=function(){var t=0,e=0,i="",s="",n="",o=null;if(null!=this.FLookupListBox&&-1!==this.FLookupListBox.GetItemIndex()){if(t=-1,null!=(o=this.FLookupListBox.FItems.GetObject(this.FLookupListBox.GetItemIndex()))&&(t=o.FIdx),i=t>=0&&t<this.FLookup.FValueList.GetCount()&&this.FLookup.FUseValueList?this.FLookup.FValueList.Get(t):this.FLookupListBox.FItems.Get(this.FLookupListBox.GetItemIndex()),null!=this.FOnLookupSelect&&this.FOnLookupSelect(this,{get:function(){return i},set:function(t){i=t}}),null!=this.FOnLookupIndexSelect&&this.FOnLookupIndexSelect(this,t,{get:function(){return i},set:function(t){i=t}}),this.FLookup.FMulti){for(i+=this.FLookup.FSeparator,s=this.GetT(),n="",e=-1;pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos(this.FLookup.FSeparator,s,{get:function(){return e},set:function(t){e=t}})>0;)n+=pas.System.Copy(s,1,e),pas.System.Delete({get:function(){return s},set:function(t){s=t}},1,e);this.SetT(n+i)}else this.SetT(i);this.FLookup.FMulti?this.SetSelStart(this.GetT().length):this.SelectAll(),this.CloseLookup()}},this.UpdateLookup=function(){var i=0,s=0,n=0,o=0,r=0,a=0,l="",h=0,F=null;if(this.FLookup.FEnabled&&null!=this.FLookupListBox){if(this.FLookup.FMulti)for(l=this.GetT(),a=-1;pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.VarPos(this.FLookup.FSeparator,l,{get:function(){return a},set:function(t){a=t}})>0;)pas.System.Delete({get:function(){return l},set:function(t){l=t}},1,a);else l=this.GetT();if(l.length>=this.FLookup.FNumChars){o=18*this.FLookup.FDisplayCount+4,this.FLookupListBox.SetParent(this),this.CleanupLookupList(),this.FLookupListBox.FItems.Clear();for(var p=1,c=this.FLookup.FDisplayList.GetCount();p<=c;p++)i=p,this.FLookup.FCaseSensitive?1===pas.System.Pos(l,this.FLookup.FDisplayList.Get(i-1))&&(F=t.TTMSFNCLookupListBoxItem.$create("Create$1",[i-1]),this.FLookupListBox.FItems.AddObject(e.CleanString(this.FLookup.FDisplayList.Get(i-1)),F),this.FLookupListBoxItems.Add(F)):(a=pas.System.Pos(pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(l),pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(this.FLookup.FDisplayList.Get(i-1))),(this.FFullTextSearch?a>0:1===a)&&(F=t.TTMSFNCLookupListBoxItem.$create("Create$1",[i-1]),this.FLookupListBox.FItems.AddObject(e.CleanString(this.FLookup.FDisplayList.Get(i-1)),F),this.FLookupListBoxItems.Add(F)));if(h=0,this.DoLookupNeedData(l,this.FLookupListBox.FItems,{get:function(){return h},set:function(t){h=t}}),s=this.FLookupListBox.FItems.GetCount(),this.FLookup.FDisplayList.GetCount()>0&&this.FLookupListBox.FItems.GetCount()>0&&this.FLookupListBox.SetItemIndex(h),s<this.FLookup.FDisplayCount&&(o=18*s+4),this.FLookupListBox.SetSorted(!0),n=50,this.FLookupList.SetDropDownWidth(0),s>0){for(var u=1,T=s;u<=T;u++)i=u,r=0,null!=this.FLookupListBox.GetCanvas()&&(r=Math.round(this.FLookupListBox.GetCanvas().TextWidth(this.FLookupListBox.FItems.Get(i-1)))),r>n&&(n=r);n+=26}this.FLookup.FWidth>0&&(n=this.FLookup.FWidth),this.FLookup.FHeight>0&&(o=this.FLookup.FHeight),this.FLookupList.SetPlacementControl(this),s>0?(this.FLookupList.SetDropDownWidth(Math.max(this.FLookup.FMinimumWidth,n)),this.FLookupList.SetDropDownHeight(Math.max(this.FLookup.FMinimumHeight,o)),this.FLookupList.HasPopupForm()&&(this.FLookupListBox.SetParent(this.FLookupList.FPopupForm),this.FLookupList.FPopupForm.SetWidth(Math.round(this.FLookupList.FDropDownWidth)),this.FLookupList.FPopupForm.SetHeight(Math.round(this.FLookupList.FDropDownHeight))),this.FLookupList.FIsOpen||this.DoLookupOpen(),this.FLookupList.SetIsOpen(!0),this.FLookupFormTimer.SetEnabled(this.FAutoClose)):(this.FLookupList.FIsOpen&&this.DoLookupClose(),this.FLookupList.SetIsOpen(!1))}else this.FLookupList.FIsOpen&&this.DoLookupClose(),this.FLookupList.SetIsOpen(!1)}},this.UpdateAutoComplete=function(){var t,i="",s=0;if(this.FAutoComplete&&(i="",(t=this.GetT()).length>=1)){for(var n=1,o=this.FLookup.FDisplayList.GetCount();n<=o;n++)if(s=n,this.FLookup.FCaseSensitive){if(1===pas.System.Pos(t,this.FLookup.FDisplayList.Get(s-1))){i=this.FLookup.FDisplayList.Get(s-1);break}}else if(1===pas.System.Pos(pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(t),pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(this.FLookup.FDisplayList.Get(s-1)))){i=this.FLookup.FDisplayList.Get(s-1);break}""!==i&&(this.SetT(e.CleanString(i)),this.SetSelStart(t.length),this.SetSelLength(this.GetT().length-this.GetSelStart()))}},this.SetLookup=function(t){this.FLookup.Assign(t)},this.AllowMin=function(t){return this.FSigned&&this.FEditType$1 in rtl.createSet(3,4,1,2,8)&&"-"===t},this.FixedLength=function(t){var e,i=0;return t=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.StripThousandSep(t),i=(e=pas.System.Pos(pas.SysUtils.FormatSettings.DecimalSeparator,t))>0?e:t.length+1,this.FSigned&&this.FEditType$1 in rtl.createSet(3,4,1,2,8)&&pas.System.Pos("-",t)>0&&(i-=1),i},this.SetModified=function(t){0 in this.FComponentState||this.FReadOnly||(this.FIsModified=t)},this.DecimalPos=function(){var t;return 0===(t=pas.System.Pos(pas.SysUtils.FormatSettings.DecimalSeparator,this.GetT()))?this.FPrefix.length+this.GetT().length+this.FSuffix.length+1:this.FPrefix.length+t},this.AutoSeparators=function(){var t,e,i,s="",n="",o="",r=0;r=(s=this.GetT()).length,e=this.GetSelStart(),""!==s&&(1===pas.System.Pos("-",s)?(pas.System.Delete({get:function(){return s},set:function(t){s=t}},1,1),o="-"):o="",s=pas.System.Pos(pas.SysUtils.FormatSettings.DecimalSeparator,s)>0?pas.System.Copy(s,pas.System.Pos(pas.SysUtils.FormatSettings.DecimalSeparator,s),255):"",t=pas.System.Trunc(Math.abs(this.GetFloat())),n=this.FAutoThousandSeparator?pas.SysUtils.Format("%n",pas.System.VarRecs(3,t)):pas.SysUtils.Format("%f",pas.System.VarRecs(3,t)),n=pas.System.Copy(n,1,pas.System.Pos(pas.SysUtils.FormatSettings.DecimalSeparator,n)-1),i=this.FPrecision,this.FPrecision=0,this.FBlockChange=this.GetT()!==this.FPrefix+o+n+s+this.FSuffix,this.FBlockChange&&pas["WEBLib.StdCtrls"].TCustomEdit.SetText.call(this,this.FPrefix+o+n+s+this.FSuffix),this.FBlockChange=!1,this.FPrecision=i,r=this.GetT().length-r,this.SetSelStart(e+r),this.SetSelLength(0))},this.GetFloat=function(){var t=0,i="",s=0,n=0;t=0;var o=this.FEditType$1;return 9===o?""!==this.GetT()&&(t=e.HexToInt(this.GetT())):0===o?(i=this.GetT(),","===pas.SysUtils.FormatSettings.DecimalSeparator&&(i=pas.SysUtils.StringReplace(i,",",".",rtl.createSet(0))),pas.System.val$8(i,{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}}),t=s):1===o||2===o||3===o||4===o?""!==this.GetT()&&(t="-"===(i=this.GetT())?0:this.EStrToFloat(i)):8===o&&""!==this.GetT()&&(i=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.StripThousandSep(this.GetT()),pas.System.Pos(pas.SysUtils.FormatSettings.DecimalSeparator,i)===i.length&&pas.System.Delete({get:function(){return i},set:function(t){i=t}},pas.System.Pos(pas.SysUtils.FormatSettings.DecimalSeparator,i),1),t=""===i||"-"===i?0:this.EStrToFloat(i)),t},this.SetFloat=function(t){var e="",i=this.FEditType$1;9===i?this.SetT(pas.SysUtils.IntToHex(pas.System.Trunc(t),0)):1===i||2===i?this.FPrecision>=0?this.SetT(pas.SysUtils.Format("%."+pas.SysUtils.IntToStr(this.FPrecision)+"n",pas.System.VarRecs(3,t))):this.SetT(pas.SysUtils.Format("%g",pas.System.VarRecs(3,t))):3===i||4===i||0===i?this.FPrecision>=0?(e=pas.SysUtils.Format("%."+pas.SysUtils.IntToStr(this.FPrecision)+"f",pas.System.VarRecs(3,t)),this.SetT(e)):this.SetT(pas.SysUtils.Format("%g",pas.System.VarRecs(3,t))):8===i&&(this.FPrecision>=0?this.SetT(pas.SysUtils.Format("%."+pas.SysUtils.IntToStr(this.FPrecision)+"f",pas.System.VarRecs(3,t))):this.SetT(pas.SysUtils.Format("%g",pas.System.VarRecs(3,t))),this.AutoSeparators()),this.SetModified(!0)},this.SetAutoThousandSeparator=function(t){this.FAutoThousandSeparator=t,this.FEditType$1 in rtl.createSet(1,2,8,3,4)&&this.AutoSeparators()},this.SetPrecision=function(t){this.FPrecision!==t&&this.FEditType$1 in rtl.createSet(3,4,8,0)&&(this.FPrecision=t,""===this.GetT()&&this.FAllowNumericNullValue||(e.IsType(this.GetT())in rtl.createSet(1,0)?this.SetFloat(this.GetFloat()):this.SetFloat(0)))},this.SetPrecisionDisplay=function(t){this.FPrecisionDisplay!==t&&(this.FPrecisionDisplay=t,this.SetFloat(this.GetFloat()))},this.EStrToFloat=function(t){var e=0;e=0,pas.System.Pos(pas.SysUtils.FormatSettings.ThousandSeparator,t)>0&&(t=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.StripThousandSep(t)),this.FPrecision>0&&t.length>this.FPrecision&&t.charAt(t.length-this.FPrecision-1)===pas.SysUtils.FormatSettings.ThousandSeparator.charAt(-1)&&(t=rtl.setCharAt(t,t.length-this.FPrecision-1,pas.SysUtils.FormatSettings.DecimalSeparator.charAt(-1)));try{pas.SysUtils.TryStrToFloat(t,{get:function(){return e},set:function(t){e=t}})}catch(t){e=0}return e},this.SetInt=function(t){var e=this.FEditType$1;9===e?this.SetT(pas.SysUtils.IntToHex(t,0)):2===e||1===e||4===e||3===e?this.SetT(pas.SysUtils.IntToStr(t)):8===e&&(this.SetT(pas.SysUtils.IntToStr(t)),this.AutoSeparators()),this.SetModified(!0)},this.SetEditType$1=function(t){var i=0;if(this.FEditType$1!==t){if(this.FEditType$1=t,0 in this.FComponentState)return;if(""!==this.GetT()||!this.FAllowNumericNullValue){i=e.IsType(this.GetT());var s=this.FEditType$1;9===s?i in rtl.createSet(0,5)||this.SetInt(0):1===s||2===s?0!==i&&this.SetInt(0):3!==s&&4!==s&&8!==s||i in rtl.createSet(1,0)||this.SetFloat(0)}!(4 in this.FComponentState)||0 in this.FComponentState||3!==this.FEditType$1&&4!==this.FEditType$1||0!==this.FPrecision||this.SetPrecision(2)}this.SetCharCase(1);var n=this.FEditType$1;5===n?this.SetCharCase(3):6===n?this.SetCharCase(2):7===n&&this.SetCharCase(0)},this.IsLookupListVisible=function(){return null!=this.FLookupList&&this.FLookupList.FIsOpen},this.GetAllowFocus=function(){return this.FAllowFocus},this.SetAllowFocus=function(t){this.FAllowFocus=t},this.GetVersionNumber=function(t,e,i,s){return"",""},this.Validate=function(t){var e=!1,i=0,s="",n=!1;pas["WEBLib.StdCtrls"].TCustomEdit.Validate.apply(this,arguments),e=!0;for(var o=1,r=t.length;o<=r;o++){i=o,s=t.charAt(i-1),n=!0;var a=this.FEditType$1;if(1===a?pas["WEBLib.TMSFNCTypes"].CharIsNumber(s)||(n=!1):3===a?pas["WEBLib.TMSFNCTypes"].CharIsNumber(s)||s===pas.SysUtils.FormatSettings.DecimalSeparator||(n=!1):4===a||2===a?pas["WEBLib.TMSFNCTypes"].CharInArray(s,["-"])||pas["WEBLib.TMSFNCTypes"].CharIsNumber(s)||s===pas.SysUtils.FormatSettings.DecimalSeparator||(n=!1):8===a?pas["WEBLib.TMSFNCTypes"].CharIsNumber(s)||s===pas.SysUtils.FormatSettings.DecimalSeparator||s===pas.SysUtils.FormatSettings.ThousandSeparator||(n=!1):9===a?pas["WEBLib.TMSFNCTypes"].CharIsHex(s)||(n=!1):10===a&&(pas["WEBLib.TMSFNCTypes"].CharIsLetterOrNumber(s)||(n=!1)),!n){e=!1;break}}return e},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,3,1)},this.DoLookupFormTimer=function(t){null!=this.FLookupList&&null!=this.FLookupListBox?(null!=this.FLookupList.FPopupForm&&this.FLookupList.FPopupForm.ApplyPlacement(),this.FLookupList.FIsOpen&&(this.IsFocused()||this.FLookupList.IsFocused()||this.FLookupListBox.Focused())||(this.LookupList().FIsOpen&&this.DoLookupClose(),this.FLookupList.SetIsOpen(!1),this.FLookupFormTimer.SetEnabled(!1))):this.FLookupFormTimer.SetEnabled(!1)},this.GetT=function(){var t="";return t=pas["WEBLib.StdCtrls"].TCustomEdit.GetText.call(this),""!==this.FPrefix&&1===pas.System.Pos(pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(this.FPrefix),pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(t))&&pas.System.Delete({get:function(){return t},set:function(e){t=e}},1,this.FPrefix.length),""!==this.FSuffix&&pas.System.Delete({get:function(){return t},set:function(e){t=e}},t.length-this.FSuffix.length+1,this.FSuffix.length),t},this.GetCaretPosition=function(){return this.GetSelStart()},this.CleanupLookupList=function(){var t=0,e=null;if(null!=this.FLookupListBoxItems){for(var i=0,s=this.FLookupListBoxItems.GetCount()-1;i<=s;i++)t=i,null!=(e=rtl.getObject(this.FLookupListBoxItems.Get(t)))&&(e=rtl.freeLoc(e));this.FLookupListBoxItems.Clear()}},this.SetCaretPosition=function(t){this.SetSelStart(t),this.SetSelLength(0)},this.SetT=function(t){var i="",s=0,n="";if(""!==(n=t)||!this.FAllowNumericNullValue){var o=this.FEditType$1;3===o||8===o?e.IsType(n)in rtl.createSet(1,0)||(n="0"):9===o?e.IsType(n)in rtl.createSet(5,0)||(n="0"):1===o&&(e.IsType(n)in rtl.createSet(0)||(n="0")),0===this.FPrecisionDisplay?(this.FPrecision>=0||8===this.FEditType$1)&&""!==n&&(this.FEditType$1 in rtl.createSet(8)&&this.FPrecision>=0&&(i="%."+pas.SysUtils.IntToStr(this.FPrecision)+"n",n=pas.SysUtils.Format(i,pas.System.VarRecs(3,this.EStrToFloat(n)))),this.FEditType$1 in rtl.createSet(3,4)&&(i="%."+pas.SysUtils.IntToStr(this.FPrecision)+"f",s=this.EStrToFloat(n),n=pas.SysUtils.Format(i,pas.System.VarRecs(3,s)))):this.FEditType$1 in rtl.createSet(3,8,4)&&(s=this.EStrToFloat(n),n=pas.SysUtils.Format("%g",pas.System.VarRecs(3,s)))}this.FEditType$1 in rtl.createSet(9,5)?n=pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(n):this.FEditType$1 in rtl.createSet(7)&&(n=pas["WEBLib.TMSFNCTypes"].AnsiLowerCase(n)),pas["WEBLib.StdCtrls"].TCustomEdit.SetText.call(this,this.FPrefix+n+this.FSuffix),this.SetModified(!1)},this.InsertText=function(t){var e="";this.FReadOnly||(e=this.GetT(),pas.System.Delete({get:function(){return e},set:function(t){e=t}},this.GetSelStart()+1,this.GetSelLength()),pas.System.Insert(t,{get:function(){return e},set:function(t){e=t}},this.GetSelStart()+1),(this.FMaxLength<=0||e.length<=this.FMaxLength)&&(this.SetT(e),this.SetCaretPosition(this.GetSelStart()+t.length)),this.SetSelLength(0))},this.ListKeyUp=function(t,e,i){13===e.get()&&this.DoneLookup(),9===e.get()&&this.FLookup.FAcceptOnTab&&this.DoneLookup()},this.ListMouseUp=function(t,e,i,s,n){this.DoneLookup()},this.KeyPress=function(t){var i=this,s="",n="",o="",r="",a=!1,l=0,h=!1,F=0,p="";function c(){i.FKeyDown in rtl.createSet(38,40)||t.set("\0")}if(null!=this.FLookupListBox){if(s=t.get(),p=t.get(),18!==this.FKeyDown&&27!==this.FKeyDown||this.CloseLookup(),!(8===this.FKeyDown&&""!==this.FPrefix&&this.GetSelStart()<=this.FPrefix.length&&0===this.GetSelLength()))if(this.FLengthLimit>0&&this.FixedLength(i.GetT())>this.FLengthLimit&&0===this.GetSelLength()&&this.GetSelStart()<this.DecimalPos()&&8!==this.FKeyDown&&this.FKeyDown!==pas.SysUtils.FormatSettings.DecimalSeparator.charCodeAt(-1)&&!this.AllowMin(p))c();else{if(this.FKeyDown in rtl.createSet(36,35,9,37,39,33,34,46,8))return 8===this.FKeyDown?(s=i.GetT(),0===this.GetSelLength()?pas.System.Delete({get:function(){return s},set:function(t){s=t}},this.GetSelStart()-this.FPrefix.length,1):pas.System.Delete({get:function(){return s},set:function(t){s=t}},Math.max(1,this.GetSelStart()-this.FPrefix.length),this.GetSelLength()),h=s!==this.GetT()||this.FIsModified,this.SetModified(h),pas["WEBLib.StdCtrls"].TCustomEdit.KeyPress.apply(this,arguments),8===this.FEditType$1&&this.AutoSeparators(),""!==this.GetT()||""===s&&!h||this.Change(),this.SetModified(h),void this.UpdateLookup()):(this.FKeyDown in rtl.createSet(36,35,9,37,39,33,34)&&this.FAutoComplete&&this.GetSelLength()>0&&this.IsLookupListVisible()&&this.CloseLookup(),o=i.GetT(),pas["WEBLib.StdCtrls"].TCustomEdit.KeyPress.apply(this,arguments),void(i.GetT()!==o&&this.SetModified(!0)));if(13===this.FKeyDown&&this.IsLookupListVisible())this.DoneLookup();else if(this.FKeyDown in rtl.createSet(9,13,27))pas["WEBLib.StdCtrls"].TCustomEdit.KeyPress.apply(this,arguments);else if(36===this.FKeyDown&&this.IsLookupListVisible())this.FLookupListBox.FItems.GetCount()>0?this.FLookupListBox.SetItemIndex(0):this.FLookupListBox.SetItemIndex(-1);else if(35===this.FKeyDown&&this.IsLookupListVisible())this.FLookupListBox.FItems.GetCount()>0?this.FLookupListBox.SetItemIndex(this.FLookupListBox.FItems.GetCount()-1):this.FLookupListBox.SetItemIndex(-1);else if(34===this.FKeyDown&&this.IsLookupListVisible())this.FLookupListBox.FItems.GetCount()>0?this.FLookupListBox.GetItemIndex()+this.FLookup.FDisplayCount<this.FLookupListBox.FItems.GetCount()?this.FLookupListBox.SetItemIndex(this.FLookupListBox.GetItemIndex()+this.FLookup.FDisplayCount):this.FLookupListBox.SetItemIndex(this.FLookupListBox.FItems.GetCount()-1):this.FLookupListBox.SetItemIndex(-1);else if(33===this.FKeyDown&&this.IsLookupListVisible())this.FLookupListBox.FItems.GetCount()>0?this.FLookupListBox.GetItemIndex()>this.FLookup.FDisplayCount?this.FLookupListBox.SetItemIndex(this.FLookupListBox.GetItemIndex()-this.FLookup.FDisplayCount):this.FLookupListBox.SetItemIndex(0):this.FLookupListBox.SetItemIndex(-1);else if(38===this.FKeyDown&&this.IsLookupListVisible())this.FLookupListBox.FItems.GetCount()>0?this.FLookupListBox.GetItemIndex()>0&&this.FLookupListBox.SetItemIndex(this.FLookupListBox.GetItemIndex()-1):this.FLookupListBox.SetItemIndex(-1);else if(40===this.FKeyDown&&this.IsLookupListVisible())this.FLookupListBox.FItems.GetCount()>0?this.FLookupListBox.GetItemIndex()+1<this.FLookupListBox.FItems.GetCount()&&this.FLookupListBox.SetItemIndex(this.FLookupListBox.GetItemIndex()+1):this.FLookupListBox.SetItemIndex(-1);else if(27===this.FKeyDown&&this.IsLookupListVisible())this.CloseLookup();else{if(46===this.FKeyDown&&this.GetSelStart()>=this.FPrefix.length){if(s=i.GetT(),0===this.GetSelLength()?pas.System.Delete({get:function(){return s},set:function(t){s=t}},this.GetSelStart()-this.FPrefix.length+1,1):pas.System.Delete({get:function(){return s},set:function(t){s=t}},this.GetSelStart()-this.FPrefix.length+1,this.GetSelLength()),this.FLengthLimit>0&&this.FixedLength(s)-1>this.FLengthLimit)return void c();this.SetModified(!0)}if(!(this.FMaxLength>0&&0===this.GetSelLength()&&this.GetT().length>=this.FMaxLength)){if(""!==this.FPrefix&&this.GetSelStart()<this.FPrefix.length&&this.SetSelStart(this.FPrefix.length),rtl.eqSet(this.FShiftState,rtl.createSet(2))&&""===p){n=pas["WEBLib.TMSFNCUtils"].TTMSFNCClipBoard.GetText(),l=e.IsType(n),a=!0;var u=this.FEditType$1;return 1===u||2===u?a=0===l:3===u||4===u?a=1===l:5===u?n=pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(n):6===u?n=e.ShiftCase(n):7===u?n=pas["WEBLib.TMSFNCTypes"].AnsiLowerCase(n):8===u?a=1===l:9===u&&(a=l in rtl.createSet(5,0)),a&&this.InsertText(n),void c()}var T=this.FEditType$1;0===T||(1===T?pas["WEBLib.TMSFNCTypes"].CharIsNumber(p)||c():3===T?(pas["WEBLib.TMSFNCTypes"].CharIsNumber(p)||p===pas.SysUtils.FormatSettings.DecimalSeparator||c(),pas.System.Pos(pas.SysUtils.FormatSettings.DecimalSeparator,this.GetT())>0&&t.get()===pas.SysUtils.FormatSettings.DecimalSeparator&&c()):4===T||2===T?(4===this.FEditType$1?pas["WEBLib.TMSFNCTypes"].CharInArray(p,["-"])||pas["WEBLib.TMSFNCTypes"].CharIsNumber(p)||p===pas.SysUtils.FormatSettings.DecimalSeparator||c():pas["WEBLib.TMSFNCTypes"].CharInArray(p,["-"])||pas["WEBLib.TMSFNCTypes"].CharIsNumber(p)||c(),pas.System.Pos(pas.SysUtils.FormatSettings.DecimalSeparator,this.GetT())>0&&t.get()===pas.SysUtils.FormatSettings.DecimalSeparator&&c(),pas.System.Pos("-",this.GetT())>0&&"-"===t.get()&&this.GetSelLength()!==this.GetT().length&&c()):5===T?(p=(s=pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(s)).charAt(0),t.set(p)):7===T?(p=(s=pas["WEBLib.TMSFNCTypes"].AnsiLowerCase(s)).charAt(0),t.set(p)):8===T?pas["WEBLib.TMSFNCTypes"].CharIsNumber(p)||p===pas.SysUtils.FormatSettings.DecimalSeparator||p===pas.SysUtils.FormatSettings.ThousandSeparator||c():9===T?pas["WEBLib.TMSFNCTypes"].CharIsHex(p)||c():10===T?pas["WEBLib.TMSFNCTypes"].CharIsLetterOrNumber(p)||c():11===T&&""!==this.FValidChars&&0===pas.System.Pos(pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(s),pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(this.FValidChars))&&c()),s=i.GetT(),pas["WEBLib.StdCtrls"].TCustomEdit.KeyPress.apply(this,arguments),i.GetT()!==s&&this.SetModified(!0),this.FEditType$1 in rtl.createSet(8,4,2)&&(r=this.GetT(),pas.System.Pos("-",r)>1&&(pas.System.Delete({get:function(){return r},set:function(t){r=t}},pas.System.Pos("-",r),1),this.SetT("-"+r))),8===this.FEditType$1&&this.AutoSeparators(),this.FEditType$1 in rtl.createSet(3,4,8)&&(F=this.GetT().length-s.length)>1&&this.SetCaretPosition(this.GetCaretPosition()+F),rtl.eqSet(this.FShiftState,{})&&this.UpdateLookup()}}}}else pas["WEBLib.StdCtrls"].TCustomEdit.KeyPress.apply(this,arguments)},this.KeyDown=function(t,e){pas["WEBLib.Controls"].TControl.KeyDown.apply(this,arguments),this.FKeyDown=t.get(),this.FShiftState=rtl.refSet(e)},this.KeyUp=function(t,i){var s=0,n="";pas["WEBLib.Controls"].TControl.KeyUp.apply(this,arguments),n=String.fromCharCode(t.get()),9===t.get()&&this.IsLookupListVisible()&&this.FLookup.FAcceptOnTab&&this.DoneLookup(),6===this.FEditType$1&&(s=this.GetSelStart(),this.SetT(e.ShiftCase(this.GetT())),this.SetSelStart(s)),""!==n&&"\b"!==n&&this.UpdateAutoComplete()},this.DoLookupNeedData=function(t,e,i){null!=this.FOnLookupNeedData&&this.FOnLookupNeedData(this,t,e,i)},this.DoLookupOpen=function(){null!=this.FOnLookupOpen&&this.FOnLookupOpen(this)},this.DoLookupClose=function(){null!=this.FOnLookupClose&&this.FOnLookupClose(this)},this.DoExit=function(){var t,e=!1;pas["WEBLib.Controls"].TControl.DoExit.call(this),0 in this.FComponentState||(this.FPrecision>=0&&this.FEditType$1 in rtl.createSet(3,4,8)&&(""===this.GetT()&&this.FAllowNumericNullValue||(e=this.FIsModified,this.SetFloat(this.GetFloat()),this.SetModified(e))),this.FEditType$1 in rtl.createSet(1,2)&&""===this.GetT()&&!this.FAllowNumericNullValue&&this.SetT("0"),this.FEditType$1 in rtl.createSet(3,4,8)&&""===this.GetT()&&!this.FAllowNumericNullValue&&this.SetFloat(0),t=pas.SysUtils.Trim(this.GetT()),this.FLookup.FEnabled&&this.FLookup.FHistory&&""!==t&&-1===this.FLookup.FDisplayList.IndexOf(t)&&this.FLookup.FDisplayList.Add(t))},this.LookupList=function(){return this.FLookupList},this.CanFocus=function(){return pas["WEBLib.Controls"].TControl.CanFocus.call(this)&&this.GetAllowFocus()},this.Create$1=function(e){return pas["WEBLib.Controls"].TControl.Create$1.apply(this,arguments),this.FAutoClose=!0,this.FAllowFocus=!0,this.SetAutoCompletion(51),this.FLookupFormTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FLookupFormTimer.FOnTimer=rtl.createCallback(this,"DoLookupFormTimer"),this.FLookupFormTimer.SetEnabled(!1),this.FLookupFormTimer.SetInterval(1),this.FAutoThousandSeparator=!0,this.FLengthLimit=0,this.FAutoComplete=!1,this.FLookup=t.TTMSFNCEditLookupSettings.$create("Create$1"),this.FLookupListBoxItems=t.TTMSFNCLookupList.$create("Create$1"),this.FLookupList=pas["WEBLib.TMSFNCPopup"].TTMSFNCPopup.$create("Create$1",[this]),this.FLookupList.FStaysOpen=!0,this.FLookupListBox=pas["WEBLib.StdCtrls"].TListBox.$create("Create$1",[this]),this.FLookupListBox.SetItemHeight(18),this.FLookupListBox.FOnKeyUp=rtl.createCallback(this,"ListKeyUp"),this.FLookupListBox.FOnMouseUp=rtl.createCallback(this,"ListMouseUp"),this.FLookupListBox.SetVisible(!1),this.FLookupListBox.SetAlign(5),this.SetAutoSize(!1),this.FLookupList.SetContentControl(this.FLookupListBox),this.FLookupList.FFocusedControl=this,this},this.Destroy=function(){rtl.free(this,"FLookupFormTimer"),rtl.free(this,"FLookup"),this.CleanupLookupList(),null!=this.FLookupListBox&&(rtl.free(this,"FLookupListBox"),this.FLookupListBox=null),rtl.free(this,"FLookupListBoxItems"),null!=this.FLookupList&&(rtl.free(this,"FLookupList"),this.FLookupList=null),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("AllowFocus",3,rtl.boolean,"GetAllowFocus","SetAllowFocus",{Default:!0}),i.addProperty("Align",2,pas["WEBLib.Controls"].$rtti.TAlign,"FAlign","SetAlign",{Default:pas["WEBLib.Controls"].TAlign.alNone}),i.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment"),i.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti.TAnchors,"FAnchors","SetAnchors",{Default:rtl.createSet(0,1)}),i.addProperty("AutoSelect",2,rtl.boolean,"FAutoSelect","SetAutoSelect",{Default:!1}),i.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAutoSize",{Default:!1}),i.addProperty("Hint",2,rtl.string,"FHint","SetHint"),i.addProperty("TextHint",2,rtl.string,"FTextHint","SetTextHint"),i.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti.TBorderStyle,"FBorderStyle","SetBorderStyle",{Default:pas["WEBLib.Controls"].TBorderStyle.bsSingle}),i.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor"),i.addProperty("DoubleBuffered",0,rtl.boolean,"FDoubleBuffered","FDoubleBuffered",{Default:!1}),i.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),i.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti.TFont,"FFont","SetFont"),i.addProperty("HideSelection",2,rtl.boolean,"FHideSelection","SetHideSelection"),i.addProperty("MaxLength",2,rtl.longint,"FMaxLength","SetMaxLength",{Default:0}),i.addProperty("PasswordChar",2,rtl.char,"FPasswordChar","SetPasswordChar",{Default:"\0"}),i.addProperty("ReadOnly",2,rtl.boolean,"FReadOnly","SetReadOnly",{Default:!1}),i.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default:!1}),i.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder"),i.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default:!0}),i.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),i.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),i.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnClick","FOnClick"),i.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDblClick","FOnDblClick"),i.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnEnter","FOnEnter"),i.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnExit","FOnExit"),i.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyDown","FOnKeyDown"),i.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti.TKeyPressEvent,"FOnKeyPress","FOnKeyPress"),i.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti.TKeyEvent,"FOnKeyUp","FOnKeyUp"),i.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseDown","FOnMouseDown"),i.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseEnter","FOnMouseEnter"),i.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnMouseLeave","FOnMouseLeave"),i.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti.TMouseMoveEvent,"FOnMouseMove","FOnMouseMove"),i.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti.TMouseEvent,"FOnMouseUp","FOnMouseUp"),i.addProperty("Text",3,rtl.string,"GetT","SetT"),i.addProperty("Version",1,rtl.string,"GetVersion",""),i.addProperty("AutoComplete",0,rtl.boolean,"FAutoComplete","FAutoComplete",{Default:!1}),i.addProperty("EditType",2,t.$rtti.TTMSFNCEditType,"FEditType$1","SetEditType$1",{Default:t.TTMSFNCEditType.etString}),i.addProperty("Lookup",2,t.$rtti.TTMSFNCEditLookupSettings,"FLookup","SetLookup"),i.addProperty("ValidChars",0,rtl.string,"FValidChars","FValidChars"),i.addProperty("AllowNumericNullValue",0,rtl.boolean,"FAllowNumericNullValue","FAllowNumericNullValue",{Default:!1}),i.addProperty("AutoThousandSeparator",2,rtl.boolean,"FAutoThousandSeparator","SetAutoThousandSeparator",{Default:!0}),i.addProperty("FullTextSearch",0,rtl.boolean,"FFullTextSearch","FFullTextSearch",{Default:!1}),i.addProperty("LengthLimit",0,rtl.smallint,"FLengthLimit","FLengthLimit",{Default:0}),i.addProperty("Precision",2,rtl.smallint,"FPrecision","SetPrecision",{Default:0}),i.addProperty("PrecisionDisplay",2,t.$rtti.TTMSFNCEditPrecisionDisplay,"FPrecisionDisplay","SetPrecisionDisplay",{Default:t.TTMSFNCEditPrecisionDisplay.pdNormal}),i.addProperty("OnLookupSelect",0,t.$rtti.TTMSFNCEditLookupSelectEvent,"FOnLookupSelect","FOnLookupSelect"),i.addProperty("OnLookupIndexSelect",0,t.$rtti.TTMSFNCEditLookupIndexSelectEvent,"FOnLookupIndexSelect","FOnLookupIndexSelect"),i.addProperty("OnLookupNeedData",0,t.$rtti.TTMSFNCEditLookupNeedDataEvent,"FOnLookupNeedData","FOnLookupNeedData"),i.addProperty("OnLookupOpen",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnLookupOpen","FOnLookupOpen"),i.addProperty("OnLookupClose",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnLookupClose","FOnLookupClose"),i.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),rtl.createClass(this,"TTMSFNCEditButton",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FBlockDropDown=!1,this.FPopup=null,this.FEdit=null,this.FButton=null,this.FPopupControl=null,this.FOnButtonClick=null,this.FModalPopup=!1,this.FBitmap=null,this.FBitmapName="",this.FButtonSize=0,this.FBitmapContainer=null},this.$final=function(){this.FPopup=void 0,this.FEdit=void 0,this.FButton=void 0,this.FPopupControl=void 0,this.FOnButtonClick=void 0,this.FBitmap=void 0,this.FBitmapContainer=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetPopupControl=function(t){this.FPopupControl=t,this.FPopup.SetContentControl(this.FPopupControl)},this.GetText=function(){return this.FEdit.GetT()},this.SetText=function(t){this.FEdit.SetT(t)},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetBitmap=function(t){this.FBitmap=t,null!=this.FButton&&(this.FButton.FBitmaps.Clear(),this.FButton.FBitmaps.AddBitmap(t,1))},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,null!=this.FButton&&this.FButton.SetBitmapContainer(t)},this.SetBitmapName=function(t){this.FBitmapName=t,null!=this.FButton&&(this.FButton.FBitmaps.Clear(),this.FButton.FBitmaps.AddBitmapName(t,1))},this.SetButtonSize=function(t){this.FButtonSize=t,null!=this.FButton&&this.FButton.SetWidth(t)},this.SetAdaptToStyle=function(t){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetAdaptToStyle.apply(this,arguments),null!=this.FButton&&this.FButton.SetAdaptToStyle(this.GetAdaptToStyle())},this.BeforeDropDown=function(){},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),null!=this.FButton&&null!=this.FBitmapContainer&&""!==this.FBitmapName&&(this.FButton.FBitmaps.Clear(),this.FButton.FBitmaps.AddBitmapName(this.FBitmapName,1))},this.KeyDown=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.KeyDown.apply(this,arguments),115!==t.get()||this.DropDown()},this.Notification=function(t,e){1===e&&t===this.FPopupControl&&(this.FPopupControl=null),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null),pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments)},this.ButtonClick=function(t){this.FBlockDropDown||this.DropDown(),this.FBlockDropDown=!1,null!=this.FOnButtonClick&&this.FOnButtonClick(this)},this.ButtonDblClick=function(t){this.FBlockDropDown=!0},this.BitmapChanged=function(t){null!=this.FButton&&(this.FButton.FBitmaps.Clear(),this.FButton.FBitmaps.AddBitmap(this.FBitmap,1))},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FModalPopup=!1,this.FButton=pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBarDropDownButton.$create("Create$1",[this]),this.FButton.SetTabStop(!1),this.FButton.SetAllowFocus(!1),this.FButton.FStored=!1,this.FButton.SetWidth(18),this.FButton.FAppearance.SetRounding(0),this.FButton.SetAlign(4),this.FButton.SetParent(this),this.FButton.FOnClick=rtl.createCallback(this,"ButtonClick"),this.FButton.FOnDblClick=rtl.createCallback(this,"ButtonDblClick"),this.FButton.FBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBAREXPAND,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this.FButton.FBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBAREXPANDLARGE,pas["WEBLib.TMSFNCTypes"].HInstance(),1.5),this.FButton.FDisabledBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBAREXPAND,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this.FButton.FDisabledBitmaps.AddBitmapFromResource$1(pas["WEBLib.TMSFNCToolBarRes"].TMSFNCTOOLBAREXPANDLARGE,pas["WEBLib.TMSFNCTypes"].HInstance(),1.5),this.FEdit=t.TTMSFNCEdit.$create("Create$1",[this]),this.FEdit.SetParent(this),this.FEdit.SetAlign(5),this.FPopup=pas["WEBLib.TMSFNCPopup"].TTMSFNCPopup.$create("Create$1",[this]),this.FPopup.SetPlacement(0),this.FPopup.FStored=!1,this.FPopup.SetDragWithParent(!0),this.FPopup.SetWidth(240),this.FPopup.SetHeight(160),this.FButtonSize=18,this.FBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FBitmap.FOnChange=rtl.createCallback(this,"BitmapChanged"),this.SetWidth(118),this.SetHeight(22),this},this.Destroy=function(){rtl.free(this,"FButton"),rtl.free(this,"FPopup"),rtl.free(this,"FBitmap"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.DropDown=function(){null!=this.FPopupControl&&(this.FPopup.SetPlacementControl(this),this.FPopup.FIsOpen?this.FPopup.SetIsOpen(!1):(this.BeforeDropDown(),this.FPopup.Popup(this.FModalPopup)))},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("Bitmap",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FBitmap","SetBitmap"),e.addProperty("BitmapName",2,rtl.string,"FBitmapName","SetBitmapName"),e.addProperty("ButtonSize",2,rtl.longint,"FButtonSize","SetButtonSize",{Default:18}),e.addProperty("PopupControl",2,pas["WEBLib.Controls"].$rtti.TControl,"FPopupControl","SetPopupControl"),e.addProperty("OnButtonClick",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnButtonClick","FOnButtonClick"),e.addProperty("Text",3,rtl.string,"GetText","SetText"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),t.$implcode=function(){e.TTMSFNCEditAutoType={0:"atNumeric",atNumeric:0,1:"atFloat",atFloat:1,2:"atString",atString:2,3:"atDate",atDate:3,4:"atTime",atTime:4,5:"atHex",atHex:5},rtl.createClass(e,"TTMSFNCPopupOpen",pas["WEBLib.TMSFNCPopup"].TTMSFNCPopup,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown)})),e.CheckTerminator=function(t){return pas["WEBLib.TMSFNCTypes"].CharInArray(t,[" ",",",".","/","\\",":","*","$","-","(",")","[","]",'"',"'","&"])},e.ShiftCase=function(t){var i,s=0,n="",o=!1;o=!0,n=t;for(var r=1,a=i=t.length;r<=a;r++)s=r,e.CheckTerminator(n.charAt(s-1))?o=!0:o?(n=rtl.setCharAt(n,s-1,pas["WEBLib.TMSFNCTypes"].AnsiUpperCase(t).charAt(s-1)),o=!1):n=rtl.setCharAt(n,s-1,pas["WEBLib.TMSFNCTypes"].AnsiLowerCase(t).charAt(s-1)),("Mc"===pas.System.Copy(n,1,s)||"Mac"===pas.System.Copy(n,1,s)||pas.System.Pos(" Mc",n)===s-2&&s>2||s>i-3&&(" I"===pas.System.Copy(n,s-1,2)||" II"===pas.System.Copy(n,s-2,3)))&&(o=!0);return n},e.IsType=function(t){var e=0,i=0,s=!1,n=!1,o=!1,r=0,a=0,l=0;e=2,s=!0,n=!0,o=!0,""===t&&(s=!1,n=!1,o=!1),r=-1,a=0,l=0;for(var h=1,F=t.length;h<=F;h++)i=h,pas["WEBLib.TMSFNCTypes"].CharIsNumber(t.charAt(i-1))||(s=!1),pas["WEBLib.TMSFNCTypes"].CharIsNumber(t.charAt(i-1))||pas["WEBLib.TMSFNCTypes"].CharInArray(t.charAt(i-1),[".",","])||(n=!1),pas["WEBLib.TMSFNCTypes"].CharIsNumber(t.charAt(i-1))||pas["WEBLib.TMSFNCTypes"].CharIsLetter(t.charAt(i-1))||(o=!1),t.charAt(i-1)===pas.SysUtils.FormatSettings.ThousandSeparator&&i-r<3&&(n=!1),t.charAt(i-1)===pas.SysUtils.FormatSettings.ThousandSeparator&&(r=i),t.charAt(i-1)===pas.SysUtils.FormatSettings.DecimalSeparator&&(a+=1),"-"===t.charAt(i-1)&&(l+=1);return o&&!s&&(e=5),s?e=0:n&&(e=1),(l>1||a>1)&&(e=2),e},e.HexToInt=function(t){var e=0,i=0,s=0;function n(t){var e=0;return e=0,t>="0"&&t<="9"&&(e=t.charCodeAt()-48),t>="A"&&t<="F"&&(e=t.charCodeAt()-65+10),t>="a"&&t<="f"&&(e=t.charCodeAt()-97+10),e}i=0,s=1;for(var o=t.length;o>=1;o--)e=o,i+=s*n(t.charAt(e-1)),s<<=4;return i},e.CleanString=function(t){var e=0;return(e=pas.System.Pos("\r",t))>0&&pas.System.Delete({get:function(){return t},set:function(e){t=e}},e,1),(e=pas.System.Pos("\n",t))>0&&pas.System.Delete({get:function(){return t},set:function(e){t=e}},e,1),(e=pas.System.Pos("\v",t))>0&&pas.System.Delete({get:function(){return t},set:function(e){t=e}},e,1),t}},t.$init=function(){pas.Classes.RegisterClass(t.TTMSFNCEditButton)}}),["SysUtils","Types","WEBLib.TMSFNCUtils","Math"]),rtl.module("WEBLib.TMSFNCTaskDialog",["System","Classes","WEBLib.Forms","WEBLib.StdCtrls","SysUtils","WEBLib.Graphics","Types","WEBLib.Controls","WEBLib.Dialogs","WEBLib.ComCtrls","WEBLib.ExtCtrls","Web","WEBLib.TMSFNCCustomComponent","WEBLib.TMSFNCTypes","WEBLib.TMSFNCHTMLText","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCImage","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCPanel","WEBLib.TMSFNCEdit","WEBLib.TMSFNCUtils","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCPopup"],(function(){"use strict";var t=this,e=t.$impl;rtl.createClass(this,"TTMSFNCCustomTaskDialogForm",pas["WEBLib.Forms"].TForm,(function(){rtl.addIntf(this,pas.System.IUnknown)})),this.TTMSFNCTaskDialogOption={0:"tdoCommandLinks",tdoCommandLinks:0,1:"tdoCommandLinksNoIcon",tdoCommandLinksNoIcon:1,2:"tdoExpandedDefault",tdoExpandedDefault:2,3:"tdoVerifyChecked",tdoVerifyChecked:3,4:"tdoProgressBar",tdoProgressBar:4,5:"tdoTimer",tdoTimer:5,6:"tdoNoDefaultRadioButton",tdoNoDefaultRadioButton:6},this.$rtti.$Enum("TTMSFNCTaskDialogOption",{minvalue:0,maxvalue:6,ordtype:1,enumtype:this.TTMSFNCTaskDialogOption}),this.$rtti.$Set("TTMSFNCTaskDialogOptions",{comptype:this.$rtti.TTMSFNCTaskDialogOption}),this.TTMSFNCTaskDialogDisplayedButtons={0:"tdbNone",tdbNone:0,1:"tdbDefault",tdbDefault:1},this.$rtti.$Enum("TTMSFNCTaskDialogDisplayedButtons",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTaskDialogDisplayedButtons}),this.TTMSFNCTaskDialogCommonButton={0:"tcbOK",tcbOK:0,1:"tcbYes",tcbYes:1,2:"tcbNo",tcbNo:2,3:"tcbCancel",tcbCancel:3,4:"tcbRetry",tcbRetry:4,5:"tcbClose",tcbClose:5},this.$rtti.$Enum("TTMSFNCTaskDialogCommonButton",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TTMSFNCTaskDialogCommonButton}),this.$rtti.$Set("TTMSFNCTaskDialogCommonButtons",{comptype:this.$rtti.TTMSFNCTaskDialogCommonButton}),this.TTMSFNCTaskDialogPosition={0:"tdpScreenCenter",tdpScreenCenter:0,1:"tdpOwnerFormCenter",tdpOwnerFormCenter:1},this.$rtti.$Enum("TTMSFNCTaskDialogPosition",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTaskDialogPosition}),this.TTMSFNCTaskDialogInputType={0:"titEdit",titEdit:0,1:"titMemo",titMemo:1,2:"titComboList",titComboList:2,3:"titDate",titDate:3,4:"titCustom",titCustom:4,5:"titNone",titNone:5,6:"titTime",titTime:6,7:"titPassword",titPassword:7},this.$rtti.$Enum("TTMSFNCTaskDialogInputType",{minvalue:0,maxvalue:7,ordtype:1,enumtype:this.TTMSFNCTaskDialogInputType}),this.TTMSFNCTaskDialogIcon={0:"tdiBlank",tdiBlank:0,1:"tdiWarning",tdiWarning:1,2:"tdiQuestion",tdiQuestion:2,3:"tdiError",tdiError:3,4:"tdiInformation",tdiInformation:4,5:"tdiShield",tdiShield:5,6:"tdiAbout",tdiAbout:6},this.$rtti.$Enum("TTMSFNCTaskDialogIcon",{minvalue:0,maxvalue:6,ordtype:1,enumtype:this.TTMSFNCTaskDialogIcon}),rtl.createClass(this,"TTMSFNCTaskDialogButton",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FIcon=null,this.FCaption$1="",this.FModalResult=0,this.FInside=!1,this.FMouseDown=!1,this.FTextFont=null,this.FButtonFill=0},this.$final=function(){this.FIcon=void 0,this.FTextFont=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetCap=function(t){this.FCaption$1!==t&&(this.FCaption$1=t)},this.SetModalResult=function(t){this.FModalResult!==t&&(this.FModalResult=t)},this.DoEnter=function(){pas["WEBLib.Controls"].TControl.DoEnter.call(this),this.FStroke.SetKind(1),this.Invalidate()},this.DoExit=function(){pas["WEBLib.Controls"].TControl.DoExit.call(this),this.FStroke.SetKind(0),this.Invalidate()},this.Draw=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),t.FFont.AssignSource(this.FTextFont),i.$assign(e),pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FIcon.FBitmap)?i.Left=this.ScalePaintValue(10):(s=(i.Bottom-i.Top)/2-this.FIcon.FBitmap.GetHeight()/2,t.DrawBitmap$5(this.ScalePaintValue(10),s,this.FIcon.FBitmap),i.Left=this.ScalePaintValue(10)+this.FIcon.GetWidth()+this.ScalePaintValue(10)),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FCaption$1,!1,1,0,0,0,-1,-1,!0,!1,-1,-1)},this.BitmapLoaded=function(t){this.Invalidate()},this.HandleMouseLeave=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),this.FInside=!1,this.FMouseDown&&(this.FFill.SetColor(16777215),this.FIcon.FFill.SetColor(16777215)),this.IsFocused()||this.FStroke.SetKind(0)},this.HandleMouseEnter=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseEnter.call(this),this.FStroke.SetKind(1),this.FInside=!0,this.FMouseDown&&(this.FFill.SetColor(this.FButtonFill),this.FIcon.FFill.SetColor(this.FButtonFill))},this.HandleMouseDown=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),this.FInside&&(this.FMouseDown=!0,this.FFill.SetColor(this.FButtonFill),this.FIcon.FFill.SetColor(this.FButtonFill))},this.HandleMouseUp=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),this.FMouseDown&&(this.FMouseDown=!1,this.FFill.SetColor(16777215),this.FIcon.FFill.SetColor(16777215))},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FButtonFill=pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(229,229,229),this.FIcon=pas["WEBLib.TMSFNCImage"].TTMSFNCImage.$create("Create$1",[this]),this.FIcon.SetBounds(0,0,20,20),this.FIcon.FOnBitmapChanged=rtl.createCallback(this,"BitmapLoaded"),this.FTextFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FInside=!1,this.FStroke.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(204,204,204)),this.FStroke.SetKind(0),this},this.Destroy=function(){rtl.free(this,"FIcon"),rtl.free(this,"FTextFont"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),this.$rtti.$MethodVar("TTMSFNCCustomTaskDialogVerifyClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Checked",rtl.boolean]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomTaskDialogRadioClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["RadioID",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomTaskDialogButtonClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ButtonID",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomTaskDialogProgressEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Pos",rtl.longint,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomTaskDialogExandButtonClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Expanded",rtl.boolean]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomTaskDialogDialogResultEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AModalResult",rtl.longint]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomTaskDialog",pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.$init.call(this),this.FBitmapContainer=null,this.FTitle="",this.FInstruction="",this.FContent="",this.FOptions={},this.FMinDialogWidth=0,this.FIcon=0,this.FApplicationIsParent=!1,this.FCustomIcon=null,this.FRadioButtons=null,this.FProgressBarMin=0,this.FProgressBarMax=0,this.FDefaultRadioButton=0,this.FDialogPosition=0,this.FCommonButtons={},this.FCustomButtons=null,this.FCollapseControlText="",this.FExpandedText="",this.FExpandControlText="",this.FVerifyText="",this.FFooterIcon=0,this.FFooter="",this.FInputType=0,this.FInputItems=null,this.FInputText="",this.FInputControl=null,this.FOnDialogRadioClick=null,this.FOnDialogVerifyClick=null,this.FOnDialogButtonClick=null,this.FRadioButtonResult=0,this.FVerifyResult=!1,this.FOnDialogCreated=null,this.FOnDialogClosed=null,this.FOnDialogTimer=null,this.FDialogForm=null,this.FOnDialogProgress=null,this.FAutoClose=!1,this.FAutoCloseTimeOut=0,this.FAutoCloseCounter=0,this.FOnAutoClose=null,this.FMaxDialogWidth=0,this.FOnDialogExpandButtonClick=null,this.FOnDialogResult=null,this.FButtonFont=null,this.FCommandLinkFont=null,this.FDisplayedButtons=0,this.FGlobalFont=null},this.$final=function(){this.FBitmapContainer=void 0,this.FOptions=void 0,this.FCustomIcon=void 0,this.FRadioButtons=void 0,this.FCommonButtons=void 0,this.FCustomButtons=void 0,this.FInputItems=void 0,this.FInputControl=void 0,this.FOnDialogRadioClick=void 0,this.FOnDialogVerifyClick=void 0,this.FOnDialogButtonClick=void 0,this.FOnDialogCreated=void 0,this.FOnDialogClosed=void 0,this.FOnDialogTimer=void 0,this.FDialogForm=void 0,this.FOnDialogProgress=void 0,this.FOnAutoClose=void 0,this.FOnDialogExpandButtonClick=void 0,this.FOnDialogResult=void 0,this.FButtonFont=void 0,this.FCommandLinkFont=void 0,this.FGlobalFont=void 0,pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.$final.call(this)},this.SetContent=function(t){this.FContent!==t&&(this.FContent=t)},this.SetInstruction=function(t){this.FInstruction!==t&&(this.FInstruction=t)},this.SetTitle=function(t){this.FTitle!==t&&(this.FTitle=t)},this.SetMinDialogWidth=function(t){this.FMinDialogWidth!==t&&(this.FMinDialogWidth=t)},this.SetIcon=function(t){this.FIcon!==t&&(this.FIcon=t)},this.SetApplicationIsParent=function(t){this.FApplicationIsParent!==t&&(this.FApplicationIsParent=t)},this.SetCustomIcon=function(t){this.FCustomIcon!==t&&this.FCustomIcon.Assign(t)},this.SetRadioButtons=function(t){this.FRadioButtons.Assign(t)},this.SetDefaultRadioButton=function(t){this.FDefaultRadioButton!==t&&(this.FDefaultRadioButton=t)},this.SetDialogPosition=function(t){this.FDialogPosition!==t&&(this.FDialogPosition=t)},this.SetCommonButtons=function(t){rtl.neSet(this.FCommonButtons,t)&&(this.FCommonButtons=rtl.refSet(t))},this.SetCustomButtons=function(t){this.FCustomButtons.Assign(t)},this.SetCollapseControlText=function(t){this.FCollapseControlText!==t&&(this.FCollapseControlText=t)},this.SetExpandControlText=function(t){this.FExpandControlText!==t&&(this.FExpandControlText=t)},this.SetExpandedText=function(t){this.FExpandedText!==t&&(this.FExpandedText=t)},this.SetVerifytext=function(t){this.FVerifyText!==t&&(this.FVerifyText=t)},this.SetFooter=function(t){this.FFooter!==t&&(this.FFooter=t)},this.SetFooterIcon=function(t){this.FFooterIcon!==t&&(this.FFooterIcon=t)},this.SetInputItems=function(t){this.FInputItems.Assign(t)},this.SetInputType=function(t){this.FInputType!==t&&(this.FInputType=t)},this.SetInputText=function(t){this.FInputText!==t&&(this.FInputText=t)},this.SetRadioButtonResult=function(t){this.FRadioButtonResult!==t&&(this.FRadioButtonResult=t)},this.SetVerifyResult=function(t){this.FVerifyResult!==t&&(this.FVerifyResult=t)},this.SetAutoClose=function(t){this.FAutoClose!==t&&(this.FAutoClose=t)},this.SetAutoCloseTimeOut=function(t){this.FAutoCloseTimeOut!==t&&(this.FAutoCloseTimeOut=t)},this.SetOnAutoClose=function(t){this.FOnAutoClose=t},this.SetBitmapContainer=function(t){this.FBitmapContainer=t},this.SetMaxDialogWidth=function(t){this.FMaxDialogWidth!==t&&(this.FMaxDialogWidth=t)},this.SetButtonFont=function(t){this.FButtonFont.Assign(t)},this.SetCommandLinkFont=function(t){this.FCommandLinkFont.Assign(t)},this.SetInputControl=function(t){null===t&&null!=this.FInputControl&&this.FInputControl.SetVisible(!0),this.FInputControl=t,null!=this.FInputControl&&this.FInputControl.SetVisible(!1)},this.IsCollapseControlTextStored=function(){return""!==this.FCollapseControlText},this.IsExpandControlTextStored=function(){return""!==this.FExpandControlText},this.IsInputTextStored=function(){return""!==this.FInputText},this.IsInstructionStored=function(){return""!==this.FInstruction},this.IsTitleStored=function(){return""!==this.FTitle},this.IsVerifyTextStored=function(){return""!==this.FVerifyText},this.IsContentStored=function(){return""!==this.FContent},this.IsExpandedTextStored=function(){return""!==this.FExpandedText},this.IsFooterStored=function(){return""!==this.FFooter},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetGlobalFont=function(t){this.FGlobalFont.Assign(t)},this.DoAutoClose=function(){null!=this.FOnAutoClose&&this.FOnAutoClose(this)},this.Close=function(){null!=this.FDialogForm&&this.FDialogForm.Close()},this.Notification=function(t,e){pas.Classes.TComponent.Notification.apply(this,arguments),3 in this.FComponentState||1===e&&(t===this.FInputControl&&(this.FInputControl=null),t===this.FBitmapContainer&&(this.FBitmapContainer=null))},this.TaskDialogFormCreated=function(t){null!=this.FOnDialogCreated&&this.FOnDialogCreated(this)},this.TaskDialogFromClosed=function(t,e){null!=this.FOnDialogClosed&&this.FOnDialogClosed(this),this.FDialogForm=null},this.CreateButton=function(t){return pas["WEBLib.StdCtrls"].TWebButton.$create("Create$1",[this])},this.CreateRadioButton=function(t){return pas["WEBLib.StdCtrls"].TWebRadioButton.$create("Create$1",[t])},this.SetFonts=function(t){this.BeginUpdate(),this.FGlobalFont.ApplyChange(this.FButtonFont,t),this.FGlobalFont.ApplyChange(this.FCommandLinkFont,t),this.EndUpdate()},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomComponent"].TTMSFNCCustomComponent.Create$1.call(this,t),this.FDialogForm=null,this.FOptions={},this.FCommonButtons={},this.FCustomIcon=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FRadioButtons=pas.Classes.TStringList.$create("Create$1"),this.FCustomButtons=pas.Classes.TStringList.$create("Create$1"),this.FInputItems=pas.Classes.TStringList.$create("Create$1"),this.FApplicationIsParent=!1,this.FMinDialogWidth=350,this.FMaxDialogWidth=1e3,this.FProgressBarMin=0,this.FProgressBarMax=100,this.FDefaultRadioButton=0,this.FDialogPosition=0,this.FIcon=0,this.FInputText="",this.FInputType=5,this.FAutoClose=!1,this.FAutoCloseTimeOut=0,this.FButtonFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FCommandLinkFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FCommandLinkFont.SetSize(11),this.FCommandLinkFont.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(0,83,196)),this.FDisplayedButtons=1,this.FGlobalFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCAppearanceGlobalFont.$create("Create$1",[this]),this},this.Destroy=function(){rtl.free(this,"FGlobalFont"),rtl.free(this,"FCustomIcon"),rtl.free(this,"FRadioButtons"),rtl.free(this,"FCustomButtons"),rtl.free(this,"FInputItems"),rtl.free(this,"FButtonFont"),rtl.free(this,"FCommandLinkFont"),pas["WEBLib.Controls"].TCustomControl.Destroy.call(this)},this.Execute=function(t){var i=0;if(i=0,null==this)return i;this.FAutoCloseCounter=0,this.FDialogForm=e.CreateMessageDlg(this),this.FDialogForm.FOnShow=rtl.createCallback(this,"TaskDialogFormCreated"),this.FDialogForm.FOnClose=rtl.createCallback(this,"TaskDialogFromClosed");var s=this.FDialogForm;return 1===this.FDialogPosition?s.SetPosition(7):s.SetPosition(4),i=this.FDialogForm.ShowModal$1(t)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCTaskDialogForm",this.TTMSFNCCustomTaskDialogForm,(function(){this.$init=function(){t.TTMSFNCCustomTaskDialogForm.$init.call(this),this.FTaskDialog=null,this.FMessage=null,this.FContent=null,this.FHorMargin=0,this.FVerMargin=0,this.FHorSpacing=0,this.FVerSpacing=0,this.FMinFormWidth=0,this.FIcon=null,this.FRadioButtons=null,this.FProgressBar=null,this.FCommBtnList=null,this.FCustBtnList=null,this.FExpandButtonIcon=null,this.FExpanded=!1,this.FExpandedText=null,this.FExpandButtonText=null,this.FPanel=null,this.FVerify=null,this.FFooter=null,this.FFooterIcon=null,this.FInputEdit=null,this.FInputMemo=null,this.FInputComboBox=null,this.FInputDate=null,this.FInputTime=null,this.FTimer=null,this.FMaxFormWidth=0,this.FOldParent=null,this.FScale=0},this.$final=function(){this.FTaskDialog=void 0,this.FMessage=void 0,this.FContent=void 0,this.FIcon=void 0,this.FRadioButtons=void 0,this.FProgressBar=void 0,this.FCommBtnList=void 0,this.FCustBtnList=void 0,this.FExpandButtonIcon=void 0,this.FExpandedText=void 0,this.FExpandButtonText=void 0,this.FPanel=void 0,this.FVerify=void 0,this.FFooter=void 0,this.FFooterIcon=void 0,this.FInputEdit=void 0,this.FInputMemo=void 0,this.FInputComboBox=void 0,this.FInputDate=void 0,this.FInputTime=void 0,this.FTimer=void 0,this.FOldParent=void 0,t.TTMSFNCCustomTaskDialogForm.$final.call(this)},this.SetFormWidth=function(t){this.FMinFormWidth!==t&&(this.FMinFormWidth=t)},this.SetMaxFormWidth=function(t){this.FMaxFormWidth!==t&&(this.FMaxFormWidth=t)},this.GetBitmapContainer=function(){var t=null,e=null,i=rtl.createIntfRefs();try{t=null,null!=this.FTaskDialog&&pas.SysUtils.Supports$1(i.ref(1,rtl.queryIntfT(this.FTaskDialog,pas.System.IUnknown)),rtl.getIntfGUIDR(pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),{get:function(){return e},set:function(t){e=t}})&&(t=e.GetBitmapContainer())}finally{i.free(),rtl._Release(e)}return t},this.FormBitmapUpdated=function(t){this.Invalidate()},this.DoClose=function(t){null!=this.FTaskDialog&&(4===this.FTaskDialog.FInputType&&null!=this.FTaskDialog.FInputControl&&(this.FTaskDialog.FInputControl.SetVisible(!1),this.FTaskDialog.FInputControl.SetParent(this.FOldParent)),this.DoUpdateInput(),pas["WEBLib.Forms"].TCustomForm.DoClose.apply(this,arguments))},this.DoTimer=function(t){var e=0;null!=this.FTaskDialog&&(this.FTaskDialog.FAutoCloseCounter=this.FTaskDialog.FAutoCloseCounter+100,5 in this.FTaskDialog.FOptions&&null!=this.FTaskDialog.FOnDialogTimer&&this.FTaskDialog.FOnDialogTimer(this.FTaskDialog),null!=this.FTaskDialog.FOnDialogProgress&&(e=this.FProgressBar.FPosition,this.FTaskDialog.FOnDialogProgress(this.FTaskDialog,{get:function(){return e},set:function(t){e=t}}),this.FProgressBar.SetPosition(e)),this.FTaskDialog.FAutoCloseCounter>this.FTaskDialog.FAutoCloseTimeOut&&this.FTaskDialog.FAutoCloseTimeOut>0&&this.FTaskDialog.FAutoClose&&(this.FTaskDialog.DoAutoClose(),this.FTaskDialog.Close()))},this.DoVerifyClick=function(t){null!=this.FTaskDialog&&null!=this.FVerify&&(this.FTaskDialog.SetVerifyResult(this.FVerify.GetChecked()),null!=this.FTaskDialog.FOnDialogVerifyClick&&this.FTaskDialog.FOnDialogVerifyClick(this.FTaskDialog,this.FTaskDialog.FVerifyResult))},this.DoRadioClick=function(t){null!=this.FTaskDialog&&null!=this.FRadioButtons&&(this.FTaskDialog.SetRadioButtonResult(this.FRadioButtons.IndexOf(t)),null!=this.FTaskDialog&&null!=this.FTaskDialog.FOnDialogRadioClick&&this.FTaskDialog.FOnDialogRadioClick(this.FTaskDialog,this.FTaskDialog.FRadioButtonResult))},this.DoUpdateInput=function(){if(null!=this.FTaskDialog){var t=this.FTaskDialog.FInputType;0===t||7===t?this.FTaskDialog.SetInputText(this.FInputEdit.GetT()):2===t?this.FTaskDialog.SetInputText(this.FInputComboBox.GetText()):3===t?this.FTaskDialog.SetInputText(pas.SysUtils.DateToStr(this.FInputDate.GetDate())):6===t?this.FTaskDialog.SetInputText(pas.SysUtils.TimeToStr(this.FInputDate.GetTime())):1===t&&this.FTaskDialog.SetInputText(this.FInputMemo.FLines.GetTextStr())}},this.DoResult=function(t){null!=this.FTaskDialog&&(null!=this.FTimer&&this.FTimer.SetEnabled(!1),null!=this.FTaskDialog.FOnDialogResult&&this.FTaskDialog.FOnDialogResult(this.FTaskDialog,t))},this.BtnClickHandler=function(t){this.SetModalResult(rtl.as(t,pas["WEBLib.StdCtrls"].TWebButton).FTag$1),null!=this.FTaskDialog&&(null!=this.FTaskDialog.FOnDialogButtonClick&&this.FTaskDialog.FOnDialogButtonClick(this.FTaskDialog,rtl.as(t,pas["WEBLib.StdCtrls"].TWebButton).FTag$1),this.DoResult(this.FModalResult))},this.CommandLinkHandler=function(e){this.SetModalResult(rtl.as(e,t.TTMSFNCTaskDialogButton).FModalResult),null!=this.FTaskDialog&&(null!=this.FTaskDialog.FOnDialogButtonClick&&this.FTaskDialog.FOnDialogButtonClick(this.FTaskDialog,rtl.as(e,t.TTMSFNCTaskDialogButton).FModalResult),this.DoResult(this.FModalResult))},this.DrawLines=function(t,e,i){var s,n=0,o=0;s=i.Right-i.Left,e.FStroke.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(223,223,223)),e.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,i.Top+.5)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s,i.Top+.5)),2,2),null!=this.FPanel&&(o=this.FPanel.GetControlsCount(),null!=this.FFooter&&""!==this.FFooter.FText&&o>1&&(n=i.Bottom-this.FHorSpacing-Math.max(this.FFooter.GetHeight(),16*this.FScale)-this.FHorSpacing,e.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,n-.5)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s,n-.5)),2,2),e.FStroke.SetColor(16777215),e.DrawLine$1(pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(i.Left,n+.5)),pas["WEBLib.TMSFNCTypes"].TPointF.$clone(pas["WEBLib.TMSFNCTypes"].PointF(s,n+.5)),2,2)))},this.ExpandIconClicked=function(t){null!=this.FExpandButtonIcon&&(this.SetExpanded(!this.FExpanded),null!=this.FTaskDialog&&null!=this.FTaskDialog.FOnDialogExpandButtonClick&&this.FTaskDialog.FOnDialogExpandButtonClick(this.FTaskDialog,this.FExpanded))},this.ExpandIconChanged=function(t){this.FExpandButtonIcon.Invalidate()},this.ExpandIconKeyDown=function(t,e,i){13!==e.get()&&32!==e.get()||this.SetExpanded(!this.FExpanded)},this.CommandLinkKeyDown=function(e,i,s){13!==i.get()&&32!==i.get()||(this.SetModalResult(rtl.as(e,t.TTMSFNCTaskDialogButton).FModalResult),null!=this.FTaskDialog&&(null!=this.FTaskDialog.FOnDialogButtonClick&&this.FTaskDialog.FOnDialogButtonClick(this.FTaskDialog,rtl.as(e,t.TTMSFNCTaskDialogButton).FModalResult),this.DoResult(this.FModalResult)))},this.SetExpanded=function(e){this.FExpanded?this.FExpandButtonIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGEXPAND,pas["WEBLib.TMSFNCTypes"].HInstance()):this.FExpandButtonIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGCOLLAPSE,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FExpanded=e,this.SetPositions(),this.Invalidate()},this.GetParentControl=function(){return this,this},this.CalculateCmButtonWidth=function(){var t=0,e=0,i=null,s=0;if(t=0,null==this.FTaskDialog)return t;for(s=0,i=pas["WEBLib.StdCtrls"].TWebButton.$create("Create$1",[this]),e=0;e<=5;e++)e in this.FTaskDialog.FCommonButtons&&(s+=1);return!(0 in this.FTaskDialog.FOptions)&&rtl.eqSet(this.FTaskDialog.FCommonButtons,{})&&0===this.FTaskDialog.FCustomButtons.GetCount()&&(s+=1),s>0&&(t=s*Math.round(i.GetWidth())+(s-1)*this.FVerSpacing),t},this.CalculateButtonListWidth=function(t,e,i){var s=null,n=0,o=0;if(o=0,null!=t&&1===i){if(0!==t.GetCount()){if(e&&0 in this.FTaskDialog.FOptions)return o;for(var r=0,a=t.GetCount()-1;r<=a;r++)n=r,s=rtl.getObject(t.Get(n)),o=o+Math.round(s.GetWidth())+this.FVerSpacing}o-=this.FVerSpacing}return o},this.CalculateCsButtonWidth=function(){var t=0,e=0,i=0,s=0,n=null;if(i=0,t=0,null==this.FTaskDialog)return t;if(null!=this.FCustBtnList&&!(0 in this.FTaskDialog.FOptions)){(n=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene();try{n.FFont.Assign(this.FTaskDialog.FButtonFont);for(var o=0,r=this.FTaskDialog.FCustomButtons.GetCount()-1;o<=r;o++)s=o,((e=Math.round(n.CalculateTextWidth$1(this.FTaskDialog.FCustomButtons.Get(s))))+20)*this.FScale<70*this.FScale&&(e=Math.round(50*this.FScale)),i=i+e+Math.round(20)}finally{n.EndScene(),n=rtl.freeLoc(n)}this.FTaskDialog.FCustomButtons.GetCount()>0&&(i=Math.round(i+(this.FTaskDialog.FCustomButtons.GetCount()-1)*this.FVerSpacing))}return t=i},this.CalculateExpButtonWidth=function(){var t=0,e=0,i=0,s=null;if(t=0,null==this.FTaskDialog)return t;if(""!==this.FTaskDialog.FExpandedText){(s=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene();try{e=Math.round(s.CalculateTextWidth$1(this.FTaskDialog.FCollapseControlText)+2*this.FVerSpacing+20*this.FScale),i=Math.round(s.CalculateTextWidth$1(this.FTaskDialog.FExpandControlText)+2*this.FVerSpacing+20*this.FScale),t=Math.max(e,i)}finally{s.EndScene(),s=rtl.freeLoc(s)}}return t},this.CalculateCheckBoxWidth=function(t){var e=0,i=null;e=0,(i=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene();try{""!==t&&(e=Math.round(i.CalculateTextWidth$1(t)+30*this.FScale))}finally{i.EndScene(),i=rtl.freeLoc(i)}return e},this.CalculateCsInputWidth=function(){var t=0;return t=0,null!=this.FTaskDialog.FInputControl&&4===this.FTaskDialog.FInputType&&(t=Math.round(this.FTaskDialog.FInputControl.GetWidth()/this.FScale)+2*this.FVerMargin,0!==this.FTaskDialog.FIcon?t+=32:null!=this.FTaskDialog.FCustomIcon&&(t+=this.FTaskDialog.FCustomIcon.GetWidth())),t},this.GetCsBtnWidth=function(t){var e=0,i=null;(i=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene();try{i.FFont.Assign(t.FFont),(e=Math.round(i.CalculateTextWidth$1(t.FCaption))+20)*this.FScale<70*this.FScale&&(e=Math.round(70*this.FScale))}finally{i.EndScene(),i=rtl.freeLoc(i)}return e},this.Create$1=function(t){return pas["WEBLib.Forms"].TCustomForm.Create$1.apply(this,arguments),this.FPopupClose=1,this},this.CreateNew=function(t,e){return pas["WEBLib.Forms"].TCustomForm.CreateNew.apply(this,arguments),this.FScale=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(t,96),0===this.FScale&&(this.FScale=1),this.FRadioButtons=pas.Classes.TList.$create("Create$1"),this.FCommBtnList=pas.Classes.TList.$create("Create$1"),this.FCustBtnList=pas.Classes.TList.$create("Create$1"),this.FExpanded=!1,this.FHorMargin=Math.round(15*this.FScale),this.FVerMargin=Math.round(15*this.FScale),this.FHorSpacing=10,this.FVerSpacing=Math.round(8*this.FScale),this.SetColor(16777215),this.FPanel=pas["WEBLib.TMSFNCPanel"].TTMSFNCPanel.$create("Create$1",[this]),this.FPanel.SetParent(this),this.FPanel.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(240,240,240)),this.FPanel.FStroke.SetKind(0),this.FPanel.FHeader.SetVisible(!1),this.FPanel.FOnAfterDraw=rtl.createCallback(this,"DrawLines"),this},this.Destroy=function(){rtl.free(this,"FRadioButtons"),rtl.free(this,"FCommBtnList"),rtl.free(this,"FCustBtnList"),pas["WEBLib.Forms"].TCustomForm.Destroy.call(this)},this.BuildTaskDialog=function(i){var s,n,o,r,a,l,h,F="",p=0,c=0,u=0,T=0,C=!1,S=0,d=null,m=0,f=0,g=0,y=0,b=0,N=0,M=0,B=0,E=0,L=null,D=0,A=null,$=null,I=0,P=0;if(null!=i){if(this.FTaskDialog=i,null!=this.GetBitmapContainer()&&(this.GetBitmapContainer().FOnBitmapChanged=rtl.createCallback(this,"FormBitmapUpdated")),f=Math.round(this.FVerMargin/this.FScale),g=Math.round(this.FHorMargin/this.FScale),y=Math.round(this.FVerMargin/this.FScale),g+=25,b=this.FMinFormWidth,c=0,l=this.FMaxFormWidth,M=-1,C=!1,h=this.GetParentControl(),""!==i.FTitle?this.SetCaption(i.FTitle):this.SetCaption(e.GetExeName()),n=this.CalculateCmButtonWidth(),o=this.CalculateCsButtonWidth(),p=this.CalculateExpButtonWidth(),a=this.CalculateCheckBoxWidth(i.FVerifyText),""===i.FExpandedText&&(p=a),u=n+o+p+this.FVerSpacing+2*this.FVerMargin+Math.round(20*this.FScale),r=this.CalculateCsInputWidth(),(b=Math.max(b,Math.max(u,r)))>l&&(M=(b=l)-2*this.FVerMargin-p-this.FVerSpacing),N=b,s=i.FInstruction,0!==i.FIcon||!pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(i.FCustomIcon)){if(this.FIcon=pas["WEBLib.TMSFNCImage"].TTMSFNCImage.$create("Create$1",[h]),this.FIcon.SetParent(h),this.FIcon.SetStretch(!0),this.FIcon.FStroke.SetKind(0),pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(i.FCustomIcon)){var v=i.FIcon;1===v?this.FIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGWARNING,pas["WEBLib.TMSFNCTypes"].HInstance()):2===v?this.FIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGQUESTION,pas["WEBLib.TMSFNCTypes"].HInstance()):3===v?this.FIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGERROR,pas["WEBLib.TMSFNCTypes"].HInstance()):4===v?this.FIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGINFORMATION,pas["WEBLib.TMSFNCTypes"].HInstance()):5===v?this.FIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGSHIELD,pas["WEBLib.TMSFNCTypes"].HInstance()):6===v&&this.FIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGABOUT,pas["WEBLib.TMSFNCTypes"].HInstance())}else this.FIcon.FBitmap.Assign(i.FCustomIcon);this.FIcon.SetBounds(f,g-6,32,32),f=f+Math.round(this.FVerMargin/this.FScale)+this.FIcon.GetWidth(),y=y+this.FIcon.GetHeight()+this.FHorSpacing,N=b-this.FIcon.GetWidth()-this.FVerMargin,this.FIcon.SetTabStop(!1)}if(N-=2*this.FVerMargin,""!==s){this.FMessage=pas["WEBLib.StdCtrls"].TWebLabel.$create("Create$1",[h]),this.FMessage.SetParent(h),this.FMessage.SetWidth(N),this.FMessage.FFont.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(0,83,196)),this.FMessage.FFont.SetSize(11),this.FMessage.SetCaption(s),this.FMessage.FWordWrap=!0,this.FMessage.SetLeft(f),this.FMessage.SetTop(g),(d=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene();try{d.FFont.Assign(this.FMessage.FFont),S=d.CalculateTextHeight(this.FMessage.FCaption,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.FMessage.GetWidth()*this.FScale,1e4)),!0,!0)}finally{d.EndScene(),d=rtl.freeLoc(d)}g=g+Math.round(S/this.FScale)+Math.round(this.FHorSpacing/this.FScale)}(5 in i.FOptions||i.FAutoClose||4 in i.FOptions)&&(this.FTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FTimer.SetInterval(100),this.FTimer.FOnTimer=rtl.createCallback(this,"DoTimer"),this.FTimer.SetEnabled(!0)),""!==i.FContent&&(this.FContent=pas["WEBLib.TMSFNCHTMLText"].TTMSFNCHTMLText.$create("Create$1",[h]),this.FContent.SetBitmapContainer(this.GetBitmapContainer()),this.FContent.SetParent(h),this.FContent.SetWordWrapping(!0),this.FContent.SetVerticalTextAlign(1),this.FContent.SetHorizontalTextAlign(1),this.FContent.SetText(i.FContent),this.FContent.SetWidth(N),this.FContent.SetAS(!0),this.FContent.SetLeft(f),this.FContent.SetTop(g),this.FContent.SetTabStop(!1),g=g+this.FContent.GetHeight()+this.FHorSpacing,E=this.FContent.GetWidth()+this.FVerMargin+f,b=Math.max(b,E),N=(b=Math.min(b,l))-f-this.FVerMargin,this.FContent.SetWidth(N));var G=i.FInputType;if(0===G||7===G)this.FInputEdit=pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit.$create("Create$1",[h]),this.FInputEdit.SetParent(h),this.FInputEdit.SetT(i.FInputText),this.FInputEdit.SetWidth(N),this.FInputEdit.SetLeft(f),this.FInputEdit.SetTop(g),7===i.FInputType&&this.FInputEdit.SetPasswordChar("*"),this.FInputEdit.SetTabStop(!0),this.FInputEdit.SetTabOrder(c),c+=1,g=g+this.FInputEdit.GetHeight()+this.FHorSpacing;else if(1===G)this.FInputMemo=pas["WEBLib.StdCtrls"].TWebMemo.$create("Create$1",[h]),this.FInputMemo.SetParent(h),this.FInputMemo.SetLines(i.FInputItems),this.FInputMemo.SetHeight(60),this.FInputMemo.SetWidth(N),this.FInputMemo.SetLeft(f),this.FInputMemo.SetTop(g),this.FInputMemo.SetTabStop(!0),this.FInputMemo.SetTabOrder(c),c+=1,g=g+this.FInputMemo.GetHeight()+this.FHorSpacing;else if(2===G)this.FInputComboBox=pas["WEBLib.StdCtrls"].TWebComboBox.$create("Create$1",[h]),this.FInputComboBox.SetParent(h),this.FInputComboBox.SetItems(i.FInputItems),this.FInputComboBox.SetWidth(N),this.FInputComboBox.SetLeft(f),this.FInputComboBox.SetTop(g),this.FInputComboBox.SetTabStop(!0),this.FInputComboBox.SetTabOrder(c),c+=1,g=g+this.FInputComboBox.GetHeight()+this.FHorSpacing;else if(3===G)this.FInputDate=pas["WEBLib.StdCtrls"].TWebDateTimePicker.$create("Create$1",[h]),this.FInputDate.SetParent(h),this.FInputDate.SetWidth(120),b=Math.max(b,f+Math.round(120*this.FScale)+this.FVerMargin),this.FInputDate.SetLeft(f),this.FInputDate.SetTop(g),this.FInputDate.SetTabStop(!0),this.FInputDate.SetTabOrder(c),c+=1,g=g+this.FInputDate.GetHeight()+this.FHorSpacing;else if(6===G)this.FInputTime=pas["WEBLib.StdCtrls"].TWebDateTimePicker.$create("Create$1",[h]),this.FInputTime.SetParent(h),this.FInputTime.SetWidth(120),b=Math.max(b,f+Math.round(120*this.FScale)+this.FVerMargin),this.FInputTime.SetKind(1),this.FInputTime.SetLeft(f),this.FInputTime.SetTop(g),this.FInputTime.SetTabStop(!0),this.FInputTime.SetTabOrder(c),c+=1,g=g+this.FInputTime.GetHeight()+this.FHorSpacing;else if(4===G&&null!=i.FInputControl){var w=i.FInputControl;this.FOldParent=w.FParent,w.SetParent(h),w.SetVisible(!0),w.SetLeft(f),w.SetTop(g),rtl.as(i.FInputControl,pas["WEBLib.Controls"].TWinControl).SetTabStop(!0),rtl.as(i.FInputControl,pas["WEBLib.Controls"].TWinControl).SetTabOrder(c),c+=1,N=(b=Math.max(b,f+this.FVerMargin+i.FInputControl.GetWidth()))-f-this.FVerMargin,g=g+i.FInputControl.GetHeight()+this.FHorSpacing}if(4 in i.FOptions&&(this.FProgressBar=pas["WEBLib.ComCtrls"].TWebProgressBar.$create("Create$1",[h]),this.FProgressBar.SetParent(h),this.FProgressBar.SetBounds(f,g,N,Math.round(12*this.FScale)),this.FProgressBar.SetMin(i.FProgressBarMin),this.FProgressBar.SetMax(i.FProgressBarMax),this.FProgressBar.SetPosition(0),this.FProgressBar.SetTabStop(!1),g=g+this.FHorSpacing+this.FProgressBar.GetHeight()),i.FRadioButtons.GetCount()>0){for(var O=0,W=i.FRadioButtons.GetCount()-1;O<=W;O++)u=O,L=i.CreateRadioButton(h),this.FRadioButtons.Add(L),L.SetParent(h),L.SetGroupName(this.FName),L.SetCaption(i.FRadioButtons.Get(u)),L.SetLeft(f),L.SetTop(g),L.SetWidth(N),L.SetTabStop(!0),L.SetTabOrder(c),L.FOnClick=rtl.createCallback(this,"DoRadioClick"),c+=1,g=g+L.GetHeight()+5,6 in i.FOptions?L.SetChecked(!1):L.SetChecked(u===i.FDefaultRadioButton);g=g-5+this.FHorSpacing}if(this.FCustBtnList.Clear(),0 in i.FOptions){for(var R=0,x=i.FCustomButtons.GetCount()-1;R<=x;R++)u=R,$=t.TTMSFNCTaskDialogButton.$create("Create$1",[h]),this.FCustBtnList.Add($),F=i.FCustomButtons.Get(u),1 in i.FOptions||$.FIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGARROWRIGHT,pas["WEBLib.TMSFNCTypes"].HInstance()),$.SetCap(i.FCustomButtons.Get(u)),$.SetParent(h),$.SetModalResult(200+u),$.FTextFont.Assign(this.FTaskDialog.FCommandLinkFont),$.SetHeight(40),$.SetWidth(N),$.SetLeft(f),$.SetTop(g),$.SetTabStop(!0),$.SetTabOrder(c),$.FOnClick=rtl.createCallback(this,"CommandLinkHandler"),$.FOnKeyDown=rtl.createCallback(this,"CommandLinkKeyDown"),c+=1,g+=$.GetHeight();g+=this.FHorSpacing}if(this.FPanel.SetTabStop(!1),this.FPanel.SetTabOrder(c),T=0,B=this.FHorSpacing,A=null,1===i.FDisplayedButtons){for(this.FCommBtnList.Clear(),(M<n||M<n+o+this.FVerSpacing)&&-1!==M?(m=M,C=!0):m=n,A=pas["WEBLib.StdCtrls"].TWebButton.$create("Create$1",[this.FPanel]),D=0;D<=5;D++)D in i.FCommonButtons&&(A=i.CreateButton(this.FPanel),this.FCommBtnList.Add(A),A.SetParent(this.FPanel),A.SetCaption(t.ButtonNames[D]),A.FTag$1=t.ModalResults[D],A.FFont.Assign(this.FTaskDialog.FButtonFont),A.SetTabStop(!0),A.SetTabOrder(T),m<A.GetWidth()&&(m=M,B=B+A.GetHeight()+this.FHorSpacing),A.SetTop(B),A.SetLeft(b-this.FVerMargin-m),A.FOnClick=rtl.createCallback(this,"BtnClickHandler"),m=m-A.GetWidth()-this.FVerSpacing,T+=1);if(!(0 in i.FOptions)){!C&&m<=0&&(m=o+n+this.FVerSpacing);for(var k=0,V=i.FCustomButtons.GetCount()-1;k<=V;k++)u=k,A=i.CreateButton(this.FPanel),this.FCustBtnList.Add(A),F=i.FCustomButtons.Get(u),A.SetParent(this.FPanel),A.FFont.Assign(this.FTaskDialog.FButtonFont),A.SetCaption(F),A.FTag$1=100+u,A.SetWidth(this.GetCsBtnWidth(A)),A.SetTabStop(!0),A.SetTabOrder(T),m<A.GetWidth()&&-1!==M&&(m=M,B=B+A.GetHeight()+this.FHorSpacing),A.SetTop(B),A.SetLeft(b-this.FVerMargin-m),A.FOnClick=rtl.createCallback(this,"BtnClickHandler"),A.FFont.Assign(this.FTaskDialog.FButtonFont),m=m-A.GetWidth()-this.FVerSpacing,T+=1}0===this.FCommBtnList.GetCount()&&0===this.FCustBtnList.GetCount()&&(D=0,A=i.CreateButton(this.FPanel),this.FCommBtnList.Add(A),A.SetParent(this.FPanel),A.SetCaption(t.ButtonNames[D]),A.FTag$1=t.ModalResults[D],A.SetDefault(!0),A.SetTabStop(!0),A.SetTabOrder(T),A.FFont.Assign(this.FTaskDialog.FButtonFont),A.FOnClick=rtl.createCallback(this,"BtnClickHandler"),A.SetTop(this.FHorSpacing),A.SetLeft(b-A.GetWidth()-this.FVerMargin),T+=1)}if(P=0===this.FCommBtnList.GetCount()&&0 in i.FOptions?this.FHorSpacing:B+(I=null!=A?A.GetHeight():0)+this.FHorSpacing,u=this.FHorSpacing,""!==i.FExpandedText&&(this.FExpandButtonIcon=pas["WEBLib.TMSFNCImage"].TTMSFNCImage.$create("Create$1",[this.FPanel]),this.FExpandButtonIcon.SetParent(this.FPanel),this.FExpandButtonIcon.FOnClick=rtl.createCallback(this,"ExpandIconClicked"),this.FExpandButtonIcon.FOnKeyDown=rtl.createCallback(this,"ExpandIconKeyDown"),this.FExpandButtonIcon.FOnBitmapChanged=rtl.createCallback(this,"ExpandIconChanged"),this.FExpandButtonIcon.FStroke.SetKind(0),this.FExpandButtonText=pas["WEBLib.StdCtrls"].TWebLabel.$create("Create$1",[this.FPanel]),this.FExpandButtonText.SetParent(this.FPanel),this.FExpandedText=pas["WEBLib.TMSFNCHTMLText"].TTMSFNCHTMLText.$create("Create$1",[h]),this.FExpandedText.SetParent(h),this.FExpandedText.SetWordWrapping(!0),this.FExpandedText.SetVerticalTextAlign(1),this.FExpandedText.SetHorizontalTextAlign(1),this.FExpandedText.SetText(i.FExpandedText),this.FExpandedText.SetWidth(N),this.FExpandedText.SetAS(!0),this.FExpandedText.SetVisible(!1),this.FExpandedText.SetTabStop(!1),this.FExpandedText.SetBitmapContainer(this.GetBitmapContainer()),2 in i.FOptions?(this.FExpanded=!0,this.FExpandedText.SetVisible(!0),this.FExpandedText.SetLeft(f),this.FExpandedText.SetTop(g),g=g+this.FExpandedText.GetHeight()+this.FHorSpacing,this.FExpandButtonIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGCOLLAPSE,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FExpandButtonIcon.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(240,240,240)),this.FExpandButtonIcon.SetTabStop(!0),this.FExpandButtonIcon.SetTabOrder(T),T+=1,this.FExpandButtonText.SetTop(this.FHorSpacing+3),this.FExpandButtonText.SetLeft(this.FVerMargin+20+this.FVerSpacing),this.FExpandButtonText.SetWidth(p),this.FExpandButtonText.SetCaption(this.FTaskDialog.FCollapseControlText)):(this.FExpandButtonIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGEXPAND,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FExpandButtonIcon.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(240,240,240)),this.FExpandButtonIcon.SetTabStop(!0),this.FExpandButtonIcon.SetTabOrder(T),T+=1,this.FExpandButtonText.SetTop(this.FHorSpacing+3),this.FExpandButtonText.SetLeft(this.FVerMargin+20+this.FVerSpacing),this.FExpandButtonText.SetWidth(p),this.FExpandButtonText.SetCaption(this.FTaskDialog.FExpandControlText)),this.FExpandButtonIcon.SetBounds(this.FVerMargin,this.FHorSpacing,20,20),0===this.FCommBtnList.GetCount()&&0 in i.FOptions&&(P=this.FExpandButtonIcon.GetHeight()+2*this.FHorSpacing),u=Math.round(P)),""!==i.FVerifyText&&(this.FVerify=pas["WEBLib.StdCtrls"].TWebCheckBox.$create("Create$1",[this.FPanel]),this.FVerify.SetParent(this.FPanel),this.FVerify.SetColor(this.FPanel.FColor),this.FVerify.SetCaption(i.FVerifyText),this.FVerify.SetLeft(this.FVerMargin),this.FVerify.SetTop(u),3 in i.FOptions&&this.FVerify.SetChecked(!0),this.FVerify.SetWidth(a),this.FVerify.SetTabStop(!0),this.FVerify.SetTabOrder(T),this.FVerify.FOnClick=rtl.createCallback(this,"DoVerifyClick"),this.FTaskDialog.SetVerifyResult(this.FVerify.GetChecked()),I=this.FVerify.GetHeight(),P=Math.max(P,u+this.FHorSpacing+I)),0===this.FPanel.GetControlsCount()&&(P=0),""!==i.FFooter){if(f=this.FVerMargin,0!==i.FFooterIcon){this.FFooterIcon=pas["WEBLib.TMSFNCImage"].TTMSFNCImage.$create("Create$1",[this.FPanel]),this.FFooterIcon.SetParent(this.FPanel),this.FFooterIcon.FStroke.SetKind(0);var H=i.FFooterIcon;1===H?this.FFooterIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGWARNING,pas["WEBLib.TMSFNCTypes"].HInstance()):2===H?this.FFooterIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGQUESTION,pas["WEBLib.TMSFNCTypes"].HInstance()):3===H?this.FFooterIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGERROR,pas["WEBLib.TMSFNCTypes"].HInstance()):4===H?this.FFooterIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGINFORMATION,pas["WEBLib.TMSFNCTypes"].HInstance()):5===H?this.FFooterIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGSHIELD,pas["WEBLib.TMSFNCTypes"].HInstance()):6===H&&this.FFooterIcon.FBitmap.LoadFromResource$1(t.TTMSFNCTASKDIALOGABOUT,pas["WEBLib.TMSFNCTypes"].HInstance()),this.FFooterIcon.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(240,240,240)),this.FFooterIcon.SetBounds(f,Math.round(P)+this.FHorSpacing,16,16),this.FFooterIcon.SetTabStop(!1),f=f+16+this.FVerSpacing}this.FFooter=pas["WEBLib.TMSFNCHTMLText"].TTMSFNCHTMLText.$create("Create$1",[this.FPanel]),this.FFooter.SetParent(this.FPanel),this.FFooter.SetWordWrapping(!0),this.FFooter.SetVerticalTextAlign(1),this.FFooter.SetHorizontalTextAlign(1),this.FFooter.SetText(i.FFooter),this.FFooter.SetWidth(N),this.FFooter.SetAS(!0),this.FFooter.SetLeft(f),this.FFooter.SetTop(Math.round(P)+this.FHorSpacing),this.FFooter.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(240,240,240)),this.FFooter.SetTabStop(!1),this.FFooter.SetBitmapContainer(this.GetBitmapContainer()),P=P+(E=Math.round(Math.max(this.FFooter.GetHeight()/this.FScale,16*this.FScale)))+2*this.FHorSpacing}b=Math.max(b,this.FMinFormWidth),this.SetClientWidth(Math.round(b)),E=Math.max(y,g),this.FPanel.SetTop(E),this.FPanel.SetLeft(0),this.FPanel.SetWidth(b),this.FPanel.SetHeight(Math.round(P)),this.SetClientHeight(Math.round(E+P))}},this.SetPositions=function(){var t,e,i=0,s=0,n=0,o=0,r=0,a=0,l=null;if(null!=this.FTaskDialog){if(s=this.FHorMargin,n=this.FVerMargin,o=this.FVerMargin,n+=25,o+=25,a=r=this.FMinFormWidth,i=this.CalculateButtonListWidth(this.FCommBtnList,!1,this.FTaskDialog.FDisplayedButtons)+this.CalculateButtonListWidth(this.FCustBtnList,!0,this.FTaskDialog.FDisplayedButtons)+this.CalculateExpButtonWidth()+this.FVerSpacing+2*this.FVerMargin+20,e=this.CalculateCsInputWidth(),r=Math.max(r,Math.max(i,e)),0===this.FTaskDialog.FIcon&&pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(this.FTaskDialog.FCustomIcon)||(this.FIcon.SetBounds(s,n-6,Math.round(32*this.FScale),Math.round(32*this.FScale)),s=s+this.FVerMargin+this.FIcon.GetWidth(),o=o+this.FHorSpacing+this.FIcon.GetHeight(),a=r-this.FIcon.GetWidth()-this.FVerMargin),a-=2*this.FVerMargin,null!=this.FMessage&&""!==this.FMessage.FCaption&&(this.FMessage.SetLeft(s),this.FMessage.SetTop(n),n=n+this.FMessage.GetHeight()+this.FHorSpacing),null!=this.FContent&&""!==this.FContent.FText){var h=this.FContent;h.SetWordWrapping(!0),h.SetVerticalTextAlign(1),h.SetHorizontalTextAlign(1),h.SetWidth(a),h.SetAS(!0),h.SetLeft(s),h.SetTop(n),n=n+this.FContent.GetHeight()+this.FHorSpacing}var F=this.FTaskDialog.FInputType;if(0===F||7===F?(this.FInputEdit.SetTop(n),this.FInputEdit.SetLeft(s),n=n+this.FInputEdit.GetHeight()+this.FHorSpacing):1===F?(this.FInputMemo.SetTop(n),this.FInputMemo.SetLeft(s),n=n+this.FInputMemo.GetHeight()+this.FHorSpacing):2===F?(this.FInputComboBox.SetTop(n),this.FInputComboBox.SetLeft(s),n=n+this.FInputComboBox.GetHeight()+this.FHorSpacing):3===F?(this.FInputDate.SetTop(n),this.FInputDate.SetLeft(s),n=n+this.FInputDate.GetHeight()+this.FHorSpacing):6===F?(this.FInputTime.SetTop(n),this.FInputTime.SetLeft(s),n=n+this.FInputTime.GetHeight()+this.FHorSpacing):4===F&&null!=this.FTaskDialog.FInputControl&&(this.FTaskDialog.FInputControl.SetTop(n),this.FTaskDialog.FInputControl.SetLeft(s),a=(r=Math.max(r,s+this.FVerMargin+this.FTaskDialog.FInputControl.GetWidth()))-s-this.FVerMargin,n=n+this.FTaskDialog.FInputControl.GetHeight()+this.FHorSpacing),null!=this.FProgressBar&&4 in this.FTaskDialog.FOptions&&(this.FProgressBar.SetBounds(s,n,a,Math.round(12*this.FScale)),n=n+this.FHorSpacing+this.FProgressBar.GetHeight()),null!=this.FRadioButtons&&0!==this.FRadioButtons.GetCount()){for(var p=0,c=this.FRadioButtons.GetCount()-1;p<=c;p++)i=p,(l=rtl.getObject(this.FRadioButtons.Get(i))).SetWidth(a),l.SetLeft(s),l.SetTop(n),n=n+l.GetHeight()+5;n=n-5+this.FHorSpacing}if(0 in this.FTaskDialog.FOptions){for(var u=0,T=this.FCustBtnList.GetCount()-1;u<=T;u++)i=u,rtl.getObject(this.FCustBtnList.Get(i)).SetTop(n),n+=rtl.getObject(this.FCustBtnList.Get(i)).GetHeight();n+=this.FHorSpacing}null!=this.FExpandedText&&""!==this.FExpandedText.FText&&(this.FExpanded?(this.FExpandedText.SetLeft(s),this.FExpandedText.SetTop(n),this.FExpandedText.SetWidth(a),this.FExpandedText.SetVisible(!0),this.FExpandButtonText.SetCaption(this.FTaskDialog.FCollapseControlText),n=n+this.FExpandedText.GetHeight()+this.FHorSpacing):(this.FExpandedText.SetVisible(!1),this.FExpandButtonText.SetCaption(this.FTaskDialog.FExpandControlText))),n=(t=Math.max(n,o))+this.FPanel.GetHeight(),this.SetClientHeight(Math.round(n)),this.FPanel.SetTop(t)}},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCTaskDialog",this.TTMSFNCCustomTaskDialog,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("ApplicationIsParent",2,rtl.boolean,"FApplicationIsParent","SetApplicationIsParent",{Default:!1}),e.addProperty("DisplayedButtons",0,t.$rtti.TTMSFNCTaskDialogDisplayedButtons,"FDisplayedButtons","FDisplayedButtons",{Default:t.TTMSFNCTaskDialogDisplayedButtons.tdbDefault}),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("Title",14,rtl.string,"FTitle","SetTitle",{stored:"IsTitleStored"}),e.addProperty("Instruction",14,rtl.string,"FInstruction","SetInstruction",{stored:"IsInstructionStored"}),e.addProperty("Options",0,t.$rtti.TTMSFNCTaskDialogOptions,"FOptions","FOptions",{Default:{}}),e.addProperty("Icon",2,t.$rtti.TTMSFNCTaskDialogIcon,"FIcon","SetIcon",{Default:t.TTMSFNCTaskDialogIcon.tdiBlank}),e.addProperty("CustomIcon",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FCustomIcon","SetCustomIcon"),e.addProperty("Content",14,rtl.string,"FContent","SetContent",{stored:"IsContentStored"}),e.addProperty("RadioButtons",2,pas.Classes.$rtti.TStringList,"FRadioButtons","SetRadioButtons"),e.addProperty("DefaultRadioButton",2,rtl.longint,"FDefaultRadioButton","SetDefaultRadioButton",{Default:0}),e.addProperty("DialogPosition",2,t.$rtti.TTMSFNCTaskDialogPosition,"FDialogPosition","SetDialogPosition",{Default:t.TTMSFNCTaskDialogPosition.tdpScreenCenter}),e.addProperty("CommonButtons",2,t.$rtti.TTMSFNCTaskDialogCommonButtons,"FCommonButtons","SetCommonButtons",{Default:{}}),e.addProperty("CustomButtons",2,pas.Classes.$rtti.TStringList,"FCustomButtons","SetCustomButtons"),e.addProperty("ButtonFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FButtonFont","SetButtonFont"),e.addProperty("CommandLinkFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FCommandLinkFont","SetCommandLinkFont"),e.addProperty("ExpandedText",14,rtl.string,"FExpandedText","SetExpandedText",{stored:"IsExpandedTextStored"}),e.addProperty("ExpandControlText",14,rtl.string,"FExpandControlText","SetExpandControlText",{stored:"IsExpandControlTextStored"}),e.addProperty("CollapseControlText",14,rtl.string,"FCollapseControlText","SetCollapseControlText",{stored:"IsCollapseControlTextStored"}),e.addProperty("MinDialogWidth",2,rtl.longint,"FMinDialogWidth","SetMinDialogWidth",{Default:350}),e.addProperty("MaxDialogWidth",2,rtl.longint,"FMaxDialogWidth","SetMaxDialogWidth",{Default:1e3}),e.addProperty("VerifyText",14,rtl.string,"FVerifyText","SetVerifytext",{stored:"IsVerifyTextStored"}),e.addProperty("FooterIcon",2,t.$rtti.TTMSFNCTaskDialogIcon,"FFooterIcon","SetFooterIcon",{Default:t.TTMSFNCTaskDialogIcon.tdiBlank}),e.addProperty("Footer",14,rtl.string,"FFooter","SetFooter",{stored:"IsFooterStored"}),e.addProperty("InputType",2,t.$rtti.TTMSFNCTaskDialogInputType,"FInputType","SetInputType",{Default:t.TTMSFNCTaskDialogInputType.titNone}),e.addProperty("InputItems",2,pas.Classes.$rtti.TStringList,"FInputItems","SetInputItems"),e.addProperty("InputText",14,rtl.string,"FInputText","SetInputText",{stored:"IsInputTextStored"}),e.addProperty("InputControl",2,pas["WEBLib.Controls"].$rtti.TControl,"FInputControl","SetInputControl"),e.addProperty("AutoClose",2,rtl.boolean,"FAutoClose","SetAutoClose",{Default:!1}),e.addProperty("AutoCloseTimeOut",2,rtl.longint,"FAutoCloseTimeOut","SetAutoCloseTimeOut",{Default:0}),e.addProperty("GlobalFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCAppearanceGlobalFont,"FGlobalFont","SetGlobalFont"),e.addProperty("OnAutoClose",2,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnAutoClose","SetOnAutoClose"),e.addProperty("OnDialogVerifyClick",0,t.$rtti.TTMSFNCCustomTaskDialogVerifyClickEvent,"FOnDialogVerifyClick","FOnDialogVerifyClick"),e.addProperty("OnDialogRadioClick",0,t.$rtti.TTMSFNCCustomTaskDialogRadioClickEvent,"FOnDialogRadioClick","FOnDialogRadioClick"),e.addProperty("OnDialogButtonClick",0,t.$rtti.TTMSFNCCustomTaskDialogButtonClickEvent,"FOnDialogButtonClick","FOnDialogButtonClick"),e.addProperty("OnDialogExpandButtonClick",0,t.$rtti.TTMSFNCCustomTaskDialogExandButtonClickEvent,"FOnDialogExpandButtonClick","FOnDialogExpandButtonClick"),e.addProperty("OnDialogCreated",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDialogCreated","FOnDialogCreated"),e.addProperty("OnDialogClosed",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDialogClosed","FOnDialogClosed"),e.addProperty("OnDialogTimer",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnDialogTimer","FOnDialogTimer"),e.addProperty("OnDialogProgress",0,t.$rtti.TTMSFNCCustomTaskDialogProgressEvent,"FOnDialogProgress","FOnDialogProgress"),e.addProperty("OnDialogResult",0,t.$rtti.TTMSFNCCustomTaskDialogDialogResultEvent,"FOnDialogResult","FOnDialogResult"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),this.TTMSFNCTASKDIALOGABOUT="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABX0lEQVRYhcXXMU/CQBQH8L8wu3SQsTqx2EQ3VidYdHRygK9BogN8EBriFwAXWHA2ri6yGEcYTAgSmkAIS3uh3Dt699K7vq2B6/8Hfde8AwquM+7C+86oB6AZX4ZvL42WM8BReFIshDFAEc5GGAEywlkIbQAVflU5BwD8zJZshBaACm8/3qJWvQAAfP3+od3/ZCFKnPDA90Q4AFz7HgLfO17ajNfyAapnPluspe/+RxvqFpmIsmk4AKyiLeaLCIHvYbPdoT+Z4uN7rrrVTfXu6XL6/jqgPiR7QLPbTYvsCQlgKVyJSAFMwofP9dT1Q3fMQogmtPzLDyvVmCXH4RIi+QdchgvEIaCwSgBhAdmhAMRd6RIhdoJ4BA4R9DZ0hJBeRFITWkSQr2JyF1hAKGcD5TbMEXFyMDn5HsgBkTkVsUeyPMK1AQxEvkOpIcLOWK6JsHswyUC4OZopEOzDaeG1B3J6q66a2wm6AAAAAElFTkSuQmCC",this.TTMSFNCTASKDIALOGERROR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAACnElEQVRYhc2XP0zbQBTGP4IEUVEgY2FAZslgFpSKhaXJRBcUlgzdOmWApVPX2FOlSlW7JAOqBJ06eGgQUyfcBXWywuIhC1YG3CpCDYosJQqROuTOuTh39jkJKt+U3D3f7/P9eX4H/GctyAbaxawC4BBAAcAOgDQnzARwDqCmGpYzFwME/InA48gEoKuGZU5twC5mNQDlmOCgPhMjbWkDdjGbBnCJ4VTPQ3UAeZ6JCQOPAA81keAEfg/C13IHyJyaSCqZSMriSgpbH75hLXcQ7NoBcElecBTP/iFr/iYI3zjSkFhaxurePrzrKzy074TwzfIJkkoGqd0c+i0XPafBhjwHkKzY7g/a4C8B2e03PDirgddBUy+hOz7wGJzVbVXDvXkR9Jqnp4NdgrHdzoOLQCI4AGwcabzl8FkLgL/x/rIRmVMTiyupiQGp6Ez0W64QTtV1Grh59zrYvKUalkNnYCLJNPUSBl5HOCh9axl4Uy/xug6B0RIURA9GmZCBC8YosAaUKQYIlcSzOdaAMOlMY2LgdeBWy1LP8BLRTCZEx3QmA48pKQNJJYPN8knosaQKywlhBurzgMc00Y40MA08hok6a+DnNPCB15FKVgIT56yBGsiUUMnAm3pJOmNyVPMNkCKhxvb++foxEt51GlJHlDPWGS1a2VOgg5mFe/MCt1UtFE4VZkLwOdbpD78gqdhu+3h7vQfgFW3rOQ30Wy5SuzkhnOqhfQfv+gqre/tILC2HwlXD8md7rCKq2O6v4+11BUxqpiaeqS8iMxxr4veX9zx4XTWsse/y0ytKSUAegU05o0weHIi+mLzFsHziXcNkpauGpYk6Za9mZQwrmDhGzgjcCQuKczlNExMvMdwfwT1SB+BgdDnlXsWenP4BbVdo/mzjj6gAAAAASUVORK5CYII=",this.TTMSFNCTASKDIALOGINFORMATION="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABt0lEQVRYhe2XsU7CQBjHfxodjIOMLBB0IW6wOdrIxlBceQgDD0AI4QHaycEHYIUOxMkUn4AmurAIiYsxJtYBQ8LiwLUepUKrtF38b/16d/9f7r67+w4S1k7QhuWGkQMqgAoUgJSniQ1YgAH0+m11shWAcsMoABpwHhRWaADU+23V+hVAuWGkgCZQC2nslQ60+m3VDgwgzE0WU+2rs9M0pUKWw4N9HsZvdMzROggLUPwgVgCCmJeKGWqXxaXY3fAZrTsMDbEb1hzgopj1iWXWdUGMaQoPfwAWa77WHOD1/XM1Zq/GfoBo+gKIbA+UcDe3jzy9fLjf09kcrbs22WXVhBcAe9IPLegI09mcq+t7TtJHbhKGlAYoIJJQHDLjsKP8Ucf9tjpxlqASs7nr6SyBGqZnVclTVfJLsY452nQWeKUCujMDGzM/AhXgexd4L5Y4lJIBEtM/gAPge1VGLFsGCHyOblGWDGAkAGDIAL0EAHougCggBzGaD5yiVd4F9RgBXC8XQFSvegzmulwpe8+BFtHuCEt4uFoCEAWjEhHE5qI0QojgZbmjRB8mHpBknmY+IDkieJwmri+yuJWo4dhEEQAAAABJRU5ErkJggg==",this.TTMSFNCTASKDIALOGQUESTION="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAACmklEQVRYhcWXsUsbURzHPy0KNkJzpSU9ByFmaQMV4mYmE9qlZDi7dm8Hh6KjQxDJHxBx6NCCo2PJCcHFELtotwQUisspZGgKFZIhbSBLh1zOu8u7d+9Si98p/N7v3veb3/u93+/34I5xT9WxUDSTwCpgABlA87l0gCZgApVqybi6FQGFopkBykBOVayNY2CjWjKaEwkoFE0N2ALWIxL7sQNsV0tGR1mATV5nGOrbQBPIi0SMCZCRL6d1ss/nWJh7SEqPO3ar3eXs8pqDU4ufnd+RRHgEyMh311Y8pEHYr1+wX79QFnHf57AlIgeUyAHe5p+xnNaDljM2hwNHgJ3t/5pwALx//UK2vG5zATDlWiiHbdzrDzhqtKg1WljtLgBGNsU7H2FCi5HS446PAGUgD3YE7CKTk5Fb7S4fPn7l8+G5Z2Pz1KLWaI35zz6Ylm2XszmdI1iVeQNs7p0EZrgk82VYdQswwrx7/UHg2uLCkzHb2eWvsC0Nt4CJC86rpXkWk489NtGRCJBxC/A3FmXy9TdLHluvP+DT4bnK55pbwK2Rb+6dSI/Lj4kELKf1QHLJ1RNiKtxlHP5CY7W7kf/5CKMICFulCCk9TkKLeWw7X5qTkHfcAqRDgxv+AnN2dR057G7OkQBT9aven+hhDoAJNzlQQaEXwPC8Je02CirgmgcKRbNO9LlvUhxXS0YevLdgA2iofJ3S4xjZFIlHMawfw4hETMKN0Q//RFQmZCZ4qsXYXVthduYmGUedUhE71ZLhCPAXom1CbsTLpXkPOQwjImpIAjRtDgceAfaslpeJCAq1wu0QDqVjpThMxJFrGhqhJrCpkMOED5PZmWmyaZ2EFsNqd/n2vS0jj/4w8Qm5m6eZQEiS//A4vXP8BV1DBp8MQbulAAAAAElFTkSuQmCC",this.TTMSFNCTASKDIALOGSHIELD="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABcklEQVRYhe2XwW2DMBSGv1S9V2KBsEF741hGyAb1CNnAsEGzAd2g3YAefQsbkAWsZAJ6wGoRGGwnUHroL3GILN7/BZv3fjZN07Cm7lZ1B+6vvVErKYDM/HwFiijJz6F1NiFboJWMAQHsgYfe8qUDUs8GoJVMgRTYAY+edSvgHSijJC+DALSSBRCba+tp6NIJqIE6SnLRXbCdgZeZTLvamuuZdgu/tfpb8A9gA/hc0G9Q+08+geOCfoNOaQMIbqcBGvw5G0C5IMCg9m9vgfsJmIlWLWBe2abl2FtQLgBgrTkGUCwAYK05Oo61kjXzTcMqSvIn28JUI8pmMoc2qFg1GUi0kkf8Q8iYTlGSx2OLrla8v9EcevM/CMDEqcMN5gdXJPMZRhnX9YUKj3PkBDDNQ9CmXl9dAOET073GcZTkR9pk7ANRAam5xynvPNCBmNqOIPMggB7Eh2X5zZgHjfOgL6OutJI7fhqMcJ322QHm0uqZ8At4gHIZ+agWPAAAAABJRU5ErkJggg==",this.TTMSFNCTASKDIALOGWARNING="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABk0lEQVRYhe2WoVICQRzGfzo2CTdDoDGnBSM2AoEngKNa5A3EYlwYooU30GYFg2+gM9sMJos6mgw7EnwAg3vMAXt3/70Bi3zpbmf3+7797v+/Xdjiv2On6EKj1QSI7Ou03Bh1i/DsFhTvJ8QBIjv2NwaAgWPszGgVbNyA0WoIuIRCwDsFrxowWoXAIxBc3rzw/P4NQK1a4uLkEGAGHJcbozcpp28CY9y7jxHYOWKIDRitWiwWXhoiO3e9BvDbmXiuyIBtsXpy7Ki673y2qEvbMteAbS1X2+VhIGlLSQJ5hZcGUUFmGjBa1YFeAfEYPctRzAAZO6hVS85nH45MA0arHtDKWixEy3LJDdji8fqh5GCcVpBpCfQpVnhpCEg5J1bOAvu/f12jeBIHy+eEK4HrDYk7uRcSMFpFwETC9PD0xdXdBwCdZoV2syI10S03RtP4ZTkBceHF4gC395/SZSsacwP2ohH6MBVEaLUWDQCnPiydROQdefwrWnuJQa+2a/t992XMtZIJnPN7pdo0ZlZriy0A+AEf2GjRMLvNlAAAAABJRU5ErkJggg==",this.TTMSFNCTASKDIALOGEXPAND="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAmtJREFUOI2dlMFOE2EQx/8zu22V0N2db5aDJIRL3wBOCij4AFaTihhfQq96IBBvajQh8R00Ws8KXvDII3BBIbRdsu2hly5pPw9dm9JuUZzbzv8/v/lmM99HyIpSqWDieN0SlQlYAHAjVU4tcGCBakvkIw4PO6OlNJqQMHxku93XzDxlgSpZ+wPAcSrPWaIlAu73gDb1es+azeaHzEMBYGPMe6OaiOrmzMzM9CSjqhZFdcuoJiKyA4DHTCksFpGbk0Bj04gspTU7Y2Om3f4ZNgS9ZVQTY0ylnymVCoHIiahuXhU2gKpuBqq/AOTZxPE6M0+5zK/+F+gyv2JgOlCtsCUqW6AaRVF70DEMN0TEn3giET9QffznO4qitgWqAMpMwEK6GoMga59b5q9ZUN/3Awt8A/BipGafgUVGf2mPh0XXce4CKALY9X1fhmDCzLtgns4xr10AEh0BmB3fHwCNRqNecN07xHzdcZw9z/OM53nGcZw9Yr6Wd5zVKIpqWbUM4BTA3KhQr9cbSS63CiLXdd0913W/g8hNcrnVRqNRH/Vba+cBnLAFDizRUla3dq0WJZ3OGtIrmnQ6a+1aLcryWqIVAAcIVJ8Y1ZaqFrOMAIBSqQAgP0lW1aJRbUkYbvQXW/VYVLcmAv8SorptVI8GTUXkYXr1Mke/LIIwXDGq58aYBxe7iOwY1WYQhstXgN02qk1RfZelcwo9F9Xty/6pMcYT1Zep9y2Gnq+xB9YYU+kRvQHgEfAFvd4+Ef0EAMs8j2532TLfY6AFa5/Gcfx5uH4MmEY+UK0AKDOwCGA2zZ+gv2bV5tnZJwDJaOFvIMS2gQ33gdwAAAAASUVORK5CYII=",this.TTMSFNCTASKDIALOGCOLLAPSE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAopJREFUOI2dlE1PU1EQht8zQGuaQjozt0gxpJv+A0jUCHGBGN2hSUUT/4BLdWNYGIOJCxO/EhLXbiWCexPA4LI/gZWCRKH3thUjpfee44KL6WcCznLemee8kzPnGHSLQiEpvj/njJk1wDiAXKzsOKDkgJUK8xI2N+vtraY9wZ5320XRCyJKOWDFOPcFwFYsjzljJg1wwwL7xtoHQRC872oKAInIW1Gti8jjbDab7lWoqoOsuiCqh8y8CIA6imJYWUQu9AJ1TMM8KapBDG0dU0QOROT8SWHHkfG8KVFtiEjxKFMoJDPM2yIyf1rYP0OqTzOq3wAkSHx/joiSqVTqVa+GXC6XyufzZ3rpBDwHMJRRLRpWXTbO/fB9/1634mw2O9KwdpWcOwjD8EqtVvN7uHzngBQZYNwas9GtSFVHG2G4Dmv3AZj+/v7VdDrtdbVp7QYBEwQgB2O22nUROWetXQdRYICZMAynAdhEMrmaHhnJttcbY74CGO3cHwDMPAbgsyH62QdcDYKgWqvV/CiKpp219USjsTY8PHy2Wy8B2IFzY62HmTUA3/uIrpXL5V/HQrVaDay1Mxb4HUbRp2aQI8oD2CYHlMi5qWbNOTc/MDBwfXd3d7/dQbVarZBzM3DuSYsQRVMASsio3hXVci6XS3Ub4SQhIkMZ5hp73h2qMC9Z4E+9Xn/4v0BnzCMiCoK9vQ8AAGa+Jap1Zr54WljG8y7HT+9mi8DMi6LqM/OlU8IqrPqmm04x9JBVF1R1sBdIRIZY9ZmoNlj1NZq+r44PVkSK1piXAIYM8BHWbsRLe7QaUTTlgFkiCuDcfd/3l5v7O4BxJDKqRQCzBEwAGI3z2wBKzpiV+AIO2xv/Ag295uDBZxPuAAAAAElFTkSuQmCC",this.TTMSFNCTASKDIALOGARROWRIGHT="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAASdJREFUOI3N1D9Lw2AQx/HvXaKEpIivwaEgTm46iSJklYq+Acd2E1wciouTICi4uutSkA4uiqs4OPhGin+oJLnHJSqUYp7Upb/5+DzPHdzBtEd8Cw8fs01RWR7M6dl5Uz//Be5cuaC5kL0pGplxG74HW0frMhxXqz7g9a4UmD4AqJLmSdHr3rtoYhAg1KCFcVeFes8QoPvkYrPiBmUDYFz7tUAfVAC6L27WPrJVQ2Z8UIFYVI6BpVE0BCiG+YWo7nkPdCSqpNbIT4COli/mE1o/cY4CIATQ17BjjezSBK+WFUkwTlFZBHBGfzAfHJSfq5f9Z0ui3PoKa7+Ybn9vTy2wCqsF+mBQztAncW49KjDwXT3nxMxWqjB/UMQBKdAO4qD11/ma/nwBeY6UFXvuI2AAAAAASUVORK5CYII=",this.ButtonNames=["OK","Yes","No","Cancel","Retry","Close"],this.ModalResults=[1,6,7,2,4,3],t.$implcode=function(){e.CreateMessageDlg=function(e){var i=null;return i=null,null==e||(e.FApplicationIsParent?(i=t.TTMSFNCTaskDialogForm.$create("CreateNew",[pas["WEBLib.Forms"].Application,0])).SetParent(pas["WEBLib.Forms"].Application.FMainForm):null!=e.FOwner&&pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(e.FOwner)?(i=t.TTMSFNCTaskDialogForm.$create("CreateNew",[rtl.as(e.FOwner,pas["WEBLib.Forms"].TCustomForm),0])).SetParent(rtl.as(e.FOwner,pas["WEBLib.Forms"].TCustomForm)):(i=t.TTMSFNCTaskDialogForm.$create("CreateNew",[pas["WEBLib.Forms"].Application,0])).SetParent(pas["WEBLib.Forms"].Application.FMainForm),i.SetBorder(3),i.FPopup=!0,i.SetShadow(!0),i.SetFormWidth(e.FMinDialogWidth),i.SetMaxFormWidth(e.FMaxDialogWidth),i.BuildTaskDialog(e),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.ScaleForCurrentDPI(i)),i},e.GetExeName=function(){return document.title}}}),["Math"]),rtl.module("WebLib.SEFNC.Logger",["System","Classes","SysUtils"],(function(){"use strict";var t=this;this.TSEFNCLogLevel={0:"sellTrace",sellTrace:0,1:"sellDebug",sellDebug:1,2:"sellInfo",sellInfo:2,3:"sellWarn",sellWarn:3,4:"sellError",sellError:4},this.SEFNCLogLevels=["Trace","Debug","Info","Warn","Error"],this.fmt_dts_long="yy-mm-dd hh:nn:ss.zzz",this.fmt_dts_short="hh:nn:ss.zzz",this.SEFNCLogLevelColors=["a6fade","94ff69","d0a9e1","f6f58d","fbb8ce"],this.html_Start='<P bgcolor="#',this.html_CloseColor='">',this.Html_End="</P>",rtl.createClass(this,"TSEFNCLogMsg",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FDTS=0,this.FLogLevel=0,this.FSrcClassName="",this.FSrcUnitName="",this.Msg=""},this.ColorWrap=function(e){return t.html_Start+t.SEFNCLogLevelColors[this.FLogLevel]+t.html_CloseColor+e+t.Html_End},this.PrintDTS=function(e){return e?pas.SysUtils.FormatDateTime(t.fmt_dts_long,this.FDTS):pas.SysUtils.FormatDateTime(t.fmt_dts_short,this.FDTS)},this.DispDTS=function(t){return this.ColorWrap(this.PrintDTS(t))},this.PrintLogLevel=function(){return t.SEFNCLogLevels[this.FLogLevel]},this.DispLogLevel=function(){return this.ColorWrap(this.PrintLogLevel())},this.Create$1=function(t,e){return this.FLogLevel=t,this.Msg=e,this.FDTS=pas.SysUtils.Now(),this},this.Create$2=function(t,e,i){return this.Create$1(t,e),this.FSrcClassName=i.$classname,this.FSrcUnitName=i.$module.$name,this}})),rtl.createInterface(this,"ISEFNCLogger","{A79FD981-6953-4D86-B4ED-D758D9CD06DA}",["Debug","Debug$1","Error$1","Info$1","Warn","Warn$1","Trace","Trace$1","LogQueue"],pas.System.IUnknown),rtl.createClass(this,"TSEFNCLoggerFactory",pas.System.TObject,(function(){this.FLogger=null})),rtl.createClass(this,"TSEFNCLogger",pas.System.TInterfacedObject,(function(){this.$init=function(){pas.System.TInterfacedObject.$init.call(this),this.FLogHistory=null},this.$final=function(){this.FLogHistory=void 0,pas.System.TInterfacedObject.$final.call(this)},this.WriteMsg=function(e,i){var s;s=t.TSEFNCLogMsg.$create("Create$1",[e,i]),this.FLogHistory.AddObject(i,s)},this.WriteMsg$1=function(e,i,s){var n;n=t.TSEFNCLogMsg.$create("Create$2",[e,i,s]),this.FLogHistory.AddObject(i,n)},this.Create$1=function(){return this.FLogHistory=pas.Classes.TStringList.$create("Create$1"),this.FLogHistory.FOwnsObjects=!0,this},this.Destroy=function(){rtl.free(this,"FLogHistory"),pas.System.TObject.Destroy.call(this)},this.Debug=function(t){this.WriteMsg(1,t)},this.Debug$1=function(t,e){this.WriteMsg$1(1,t,e)},this.Error$1=function(t,e){this.WriteMsg$1(4,t,e)},this.Info$1=function(t,e){this.WriteMsg$1(2,t,e)},this.Warn=function(t){this.WriteMsg(3,t)},this.Warn$1=function(t,e){this.WriteMsg$1(3,t,e)},this.Trace=function(t){this.WriteMsg(0,t)},this.Trace$1=function(t,e){this.WriteMsg$1(0,t,e)},this.LogQueue=function(t,e){var i=!1,s=0,n=null;if(t===this.FLogHistory.GetCount())return!1;try{for(var o=t,r=this.FLogHistory.GetCount()-1;o<=r;o++)s=o,n=this.FLogHistory.GetObject(s),e.get().AddObject(this.FLogHistory.Get(s),n);i=e.get().GetCount()>0}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;i=!1}return i},rtl.addIntf(this,t.ISEFNCLogger),rtl.addIntf(this,pas.System.IUnknown)})),this.Logger=function(){var e=null,i=!1;try{e=rtl.setIntfL(e,t.TSEFNCLoggerFactory.FLogger),i=!0}finally{i||rtl._Release(e)}return e},t.$init=function(){rtl.setIntfP(t.TSEFNCLoggerFactory,"FLogger",rtl.queryIntfT(t.TSEFNCLogger.$create("Create$1"),t.ISEFNCLogger),!0)}})),rtl.module("WEBLib.Crypto",["System","Classes","JS","Web","Types"],(function(){"use strict";var t=this;this.TCryptoHash={0:"ehSHA1",ehSHA1:0,1:"ehSHA256",ehSHA256:1,2:"ehSHA384",ehSHA384:2,3:"ehSHA512",ehSHA512:3},rtl.createClass(this,"TSHAHash",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FHashType=0},this.Create$2=function(t){return this.FHashType=t,this},this.Hash=function(e){var i=this;return new Promise((function(s,n){var o,r="";o=t.GetMessageEncoding(e);var a=i.FHashType;r=0===a?"SHA-1":2===a?"SHA-384":3===a?"SHA-512":"SHA-256",window.crypto.subtle.digest(r,o).then((function(e){s(t.ABToHex(e))}))}))}})),rtl.createClass(this,"TWebSHAHash",this.TSHAHash,(function(){})),this.GetMessageEncoding=function(t){return(new TextEncoder).encode(t)},this.ABToHex=function(t){var e="",i=null,s=0,n=0;e="",i=new DataView(t);for(var o=0,r=rtl.trunc(i.byteLength/4)-1;o<=r;o++)s=o,n=i.getUint32(4*s),e+=pas.SysUtils.IntToHex(n,8);return e}}),["SysUtils"]),rtl.module("NetEncoding",["System","Web","Classes","JS","SysUtils"],(function(){"use strict";rtl.createClass(this,"TNetEncoding",pas.System.TObject,(function(){})),rtl.createClass(this,"TBase64Encoding",this.TNetEncoding,(function(){}))})),rtl.module("WebLib.SEconstable.Session",["System","Generics.Collections","Types","SysUtils","WEBLib.TMSFNCTypes","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCJSONReader","WEBLib.TMSFNCPersistence","WEBLib.ExtCtrls","JS","Web","Classes"],(function(){"use strict";var t=this,e=t.$impl;this.file_ext_session_json=".rttkjson",this.file_dt_fmt="yyyy-mm-dd_hh-nn-ss",this.zip_dir_nm_infostreams="InfoStreams/",this.stream_nilval_hash="nilhash",this.stream_nilval_b64string="nilval",this.stream_fileext_csv="csv",this.stream_fileext_json="json",rtl.createClass(this,"TSERTTKSessionStorageBase",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FID=pas.System.TGuid.$new()},this.$final=function(){this.FID=void 0,pas.Classes.TPersistent.$final.call(this)},this.IDRead=function(){return pas.SysUtils.TGuidHelper.ToString.call(this.FID,!1)},this.IDWrite=function(t){this.FID.$assign(pas.SysUtils.StringToGUID(t))},this.Create$1=function(){return pas.SysUtils.CreateGUID(this.FID),this},this.$rtti.addProperty("ID",3,rtl.string,"IDRead","IDWrite")})),rtl.createClass(this,"TSESSessionStepBase",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FDTS=0,this.FSysGenerated=!1,this.FID=pas.System.TGuid.$new()},this.$final=function(){this.FID=void 0,pas.Classes.TPersistent.$final.call(this)},this.IDRead=function(){return pas.SysUtils.TGuidHelper.ToString.call(this.FID,!1)},this.IDWrite=function(t){this.FID.$assign(pas.SysUtils.StringToGUID(t))},this.GetDisplayDTS=function(){return'<FONT color="#003399"  face="Consolas" >'+pas.SysUtils.FormatDateTime("hh:nn:ss.zzz",this.FDTS)+"</FONT> :: "},this.Create$1=function(t){return pas.SysUtils.CreateGUID(this.FID),this.FSysGenerated=t,this.FDTS=pas.SysUtils.Now(),this};var t=this.$rtti;t.addProperty("DTS",0,pas.System.$rtti.TDateTime,"FDTS","FDTS"),t.addProperty("SysGenerated",0,rtl.boolean,"FSysGenerated","FSysGenerated"),t.addProperty("ID",3,rtl.string,"IDRead","IDWrite")})),rtl.createClass(this,"TSESSessionStepLog",this.TSESSessionStepBase,(function(){this.$init=function(){t.TSESSessionStepBase.$init.call(this),this.FStepMessage=""},this.GetDisplayString=function(){return this.GetDisplayDTS()+this.FStepMessage},this.Create$2=function(e,i){return t.TSESSessionStepBase.Create$1.call(this,i),this.FStepMessage=e,this},this.$rtti.addProperty("StepMessage",0,rtl.string,"FStepMessage","FStepMessage")})),rtl.createClass(this,"TSESSessionScreenShot",this.TSESSessionStepLog,(function(){this.$init=function(){t.TSESSessionStepLog.$init.call(this),this.FFormName="",this.FBitmapGuid=pas.System.TGuid.$new()},this.$final=function(){this.FBitmapGuid=void 0,t.TSESSessionStepLog.$final.call(this)},this.BitmapGuidGet=function(){return pas.SysUtils.TGuidHelper.ToString.call(this.FBitmapGuid,!1)},this.BitmapGuidSet=function(t){this.FBitmapGuid.$assign(pas.SysUtils.StringToGUID(t))},this.GetDisplayString=function(){return this.GetDisplayDTS()+this.FStepMessage+" "+this.FFormName+" Screen Shot "},this.Create$3=function(e,i,s){return t.TSESSessionStepLog.Create$2.call(this,i,s),this.FFormName=e,pas.SysUtils.CreateGUID(this.FBitmapGuid),this};var e=this.$rtti;e.addProperty("FormName",0,rtl.string,"FFormName","FFormName"),e.addProperty("BitmapString",3,rtl.string,"BitmapGuidGet","BitmapGuidSet")})),this.TSESSessionBookmarkLevel={0:"sblInfo",sblInfo:0,1:"sblWarn",sblWarn:1,2:"sblError",sblError:2},this.$rtti.$Enum("TSESSessionBookmarkLevel",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TSESSessionBookmarkLevel}),this.BookmarkLevels=["Info","Warn","Error"],rtl.createClass(this,"TSESSessionBookmark",this.TSESSessionStepLog,(function(){this.$init=function(){t.TSESSessionStepLog.$init.call(this),this.FBookmarkLevel=0},this.GetDisplayString=function(){return this.GetDisplayDTS()+t.BookmarkLevels[this.FBookmarkLevel]+" : "+this.FStepMessage},this.Create$3=function(e){return t.TSESSessionStepLog.Create$2.call(this,e,!0),this.FStepMessage=e,this.FBookmarkLevel=0,this},this.$rtti.addProperty("Level",0,t.$rtti.TSESSessionBookmarkLevel,"FBookmarkLevel","FBookmarkLevel")})),rtl.createClass(this,"TSESSessionStepBitmap",this.TSESSessionStepLog,(function(){this.$init=function(){t.TSESSessionStepLog.$init.call(this),this.FBMGUID=pas.System.TGuid.$new()},this.$final=function(){this.FBMGUID=void 0,t.TSESSessionStepLog.$final.call(this)},this.FBMGUIDRead=function(){return pas.SysUtils.TGuidHelper.ToString.call(this.FBMGUID,!1)},this.FBMGUIDWrite=function(t){this.FBMGUID.$assign(pas.SysUtils.StringToGUID(t))},this.GetDisplayString=function(){return this.GetDisplayDTS()+this.FStepMessage},this.Create$3=function(e,i){return t.TSESSessionStepLog.Create$2.call(this,e,i),pas.SysUtils.CreateGUID(this.FBMGUID),this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)},this.$rtti.addProperty("BitmapGuid",3,rtl.string,"FBMGUIDRead","FBMGUIDWrite")})),rtl.createClass(this,"TSESSessionScreenDiff",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FScreenName="",this.FBeforeGuid=pas.System.TGuid.$new(),this.FAfterGuid=pas.System.TGuid.$new()},this.$final=function(){this.FBeforeGuid=void 0,this.FAfterGuid=void 0,pas.Classes.TPersistent.$final.call(this)},this.AfterGuidGet=function(){return pas.SysUtils.TGuidHelper.ToString.call(this.FAfterGuid,!1)},this.AfterGuidSet=function(t){this.FAfterGuid.$assign(pas.SysUtils.StringToGUID(t))},this.BeforeGuidGet=function(){return pas.SysUtils.TGuidHelper.ToString.call(this.FBeforeGuid,!1)},this.BeforeGuidSet=function(t){this.FBeforeGuid.$assign(pas.SysUtils.StringToGUID(t))},this.Create$1=function(t){return this.FScreenName=t,this};var t=this.$rtti;t.addProperty("ScreenName",0,rtl.string,"FScreenName","FScreenName"),t.addProperty("BeforeGuidStr",3,rtl.string,"BeforeGuidGet","BeforeGuidSet"),t.addProperty("AfterGuidStr",3,rtl.string,"AfterGuidGet","AfterGuidSet")})),rtl.createClass(this,"TSESSessionCompExport",this.TSESSessionStepLog,(function(){this.$init=function(){t.TSESSessionStepLog.$init.call(this),this.FCompExport=""},this.$rtti.addProperty("TxtExport",0,rtl.string,"FCompExport","FCompExport")})),rtl.createClass(this,"TSERTTKSessionScreenDiffs",pas["Generics.Collections"].TObjectList$G3,(function(){this.$init=function(){pas["Generics.Collections"].TObjectList$G3.$init.call(this),this.FOwnerInterface=null},this.$final=function(){rtl.setIntfP(this,"FOwnerInterface",null),pas["Generics.Collections"].TObjectList$G3.$final.call(this)},this.GetItemClass=function(){return t.TSESSessionScreenDiff},this._AddRef=function(){return null!==this.FOwnerInterface?this.FOwnerInterface._AddRef():-1},this._Release=function(){return null!==this.FOwnerInterface?this.FOwnerInterface._Release():-1},this.QueryInterface=function(t,e){return this.GetInterface(t,e)?0:-2147467262},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCBaseListIO)})),rtl.createClass(this,"TSESSessionStepInspector",this.TSESSessionStepLog,(function(){this.$init=function(){t.TSESSessionStepLog.$init.call(this),this.FScreenDiffs=null,this.FPropertyName="",this.FPropertyValue="",this.FCompPath="",this.FPreviousValue=""},this.$final=function(){this.FScreenDiffs=void 0,t.TSESSessionStepLog.$final.call(this)},this.GetCompDisplayPath=function(){var t="";return t=pas.SysUtils.TStringHelper.Replace$2.call({p:this,get:function(){return this.p.FCompPath},set:function(t){this.p.FCompPath=t}},"|",' <FONT color="#FF0000">\\</FONT> '),pas.SysUtils.TStringHelper.Contains.call({get:function(){return t},set:function(e){t=e}},"}")&&pas.SysUtils.TStringHelper.Contains.call({get:function(){return t},set:function(e){t=e}},"{")&&(t=pas.SysUtils.TStringHelper.Replace$2.call({get:function(){return t},set:function(e){t=e}},"}",'<FONT color="#800000">'),t=pas.SysUtils.TStringHelper.Replace$2.call({get:function(){return t},set:function(e){t=e}},"{","</FONT>")),t},this.GetDisplayString=function(){return this.GetDisplayDTS()+this.FStepMessage+"<BR>"+this.DispPropertyName()+"<BR>"+this.DispPropertyPreviousValue()+"<BR>"+this.DispPropertyValue()+" <BR> path= "+this.GetCompDisplayPath()},this.DispPropertyName=function(){return'<FONT color="#800000"><B>Property Changed:</B> '+this.FPropertyName+"</FONT>"},this.DispPropertyValue=function(){return'<FONT color="#0000FF"><B>After:</B> '+this.FPropertyValue+"</FONT>"},this.DispPropertyPreviousValue=function(){return'<FONT color="#993366"><B>Before:</B> '+this.FPreviousValue+"</FONT>"},this.Create$3=function(e,i){return t.TSESSessionStepLog.Create$2.call(this,e,i),this.FScreenDiffs=t.TSERTTKSessionScreenDiffs.$create("Create$4",[!0]),this},this.Destroy=function(){rtl.free(this,"FScreenDiffs"),pas.System.TObject.Destroy.call(this)};var e=this.$rtti;e.addProperty("ScreenDiffs",0,t.$rtti.TSERTTKSessionScreenDiffs,"FScreenDiffs","FScreenDiffs"),e.addProperty("PropertyName",0,rtl.string,"FPropertyName","FPropertyName"),e.addProperty("PropertyValue",0,rtl.string,"FPropertyValue","FPropertyValue"),e.addProperty("PreviousValue",0,rtl.string,"FPreviousValue","FPreviousValue"),e.addProperty("CompPath",0,rtl.string,"FCompPath","FCompPath")})),rtl.createClass(this,"TSERTTKSessionInfoStream",this.TSERTTKSessionStorageBase,(function(){this.$init=function(){t.TSERTTKSessionStorageBase.$init.call(this),this.FPayload=[],this.FStream=null,this.FStreamExtension="",this.FB64String="",this.FDecodeString="",this.FHash64Src="",this.FHash64Ret="",this.FHashVal="",this.FReloaded=!1,this.FExported=!1},this.$final=function(){this.FPayload=void 0,this.FStream=void 0,t.TSERTTKSessionStorageBase.$final.call(this)},this.DataB64Read=function(){return this.FExported||this.FReloaded?this.FB64String:"not exported"},this.DataB64Write=function(e){try{this.FB64String=e,this.HashForString(this.FB64String),this.FHash64Ret=this.FHashVal,this.FHash64Ret===this.FHash64Src&&(pas.NetEncoding.TBase64Encoding.$create("Create"),this.FPayload=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.Decode64ToBytes(this.FB64String,!1),this.FStream.Clear(),this.FStream.Write(this.FPayload,rtl.length(this.FPayload)),this.FStream.SetPosition(0)),this.FReloaded=!0}catch(e){if(!pas.SysUtils.Exception.isPrototypeOf(e))throw e;this.FDecodeString=t.stream_nilval_b64string}},this.Hash64SrcGet=function(){return this.FExported||this.FReloaded?this.HashSrcBase64():"notExported"},this.Hash64SrcSet=function(t){this.FHash64Src=t},this.HashSrcBase64=function(){var e="";return this.FB64String===t.stream_nilval_b64string?e=t.stream_nilval_hash:(this.HashForString(this.FB64String),e=this.FHashVal),e},this.HashForString=async function(t){var e=null;e=pas["WEBLib.Crypto"].TWebSHAHash.$create("Create$2",[1]);try{this.FHashVal=await e.Hash(t)}finally{e=rtl.freeLoc(e)}},this.PrepareExportBase64=function(){try{this.FStream.SetPosition(0),this.FPayload=rtl.arraySetLength(this.FPayload,0,this.FStream.GetSize()),this.FStream.Read({p:this,get:function(){return this.p.FPayload},set:function(t){this.p.FPayload=t}},this.FStream.GetSize()),this.FB64String=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.Encode64$1(this.FPayload,!1),this.FExported=!0}catch(e){if(!pas.SysUtils.Exception.isPrototypeOf(e))throw e;this.FB64String=t.stream_nilval_b64string}},this.Create$2=function(e){return t.TSERTTKSessionStorageBase.Create$1.call(this),this.FStreamExtension=e,this.FStream=pas.Classes.TMemoryStream.$create("Create"),this.FB64String=t.stream_nilval_b64string,this.FDecodeString=t.stream_nilval_b64string,this.FHash64Src=t.stream_nilval_hash,this.FHash64Ret=t.stream_nilval_hash,this.FReloaded=!1,this.FExported=!1,this},this.Destroy=function(){rtl.free(this,"FStream"),this.FPayload=rtl.arraySetLength(this.FPayload,0,0),pas.System.TObject.Destroy.call(this)},this.InfoStreamFileName=function(){return t.zip_dir_nm_infostreams+this.IDRead()+"."+this.FStreamExtension},this.DataLoaded=function(){return this.FExported||this.FReloaded};var e=this.$rtti;e.addProperty("AHashBase64",3,rtl.string,"Hash64SrcGet","Hash64SrcSet"),e.addProperty("InfoStreamExtension",0,rtl.string,"FStreamExtension","FStreamExtension"),e.addProperty("DataBase64",3,rtl.string,"DataB64Read","DataB64Write")})),rtl.createClass(this,"TSESSessionStepInfoStream",this.TSESSessionStepLog,(function(){this.$init=function(){t.TSESSessionStepLog.$init.call(this),this.FInfoStream=null,this.FStreamRegistered=!1},this.$final=function(){this.FInfoStream=void 0,t.TSESSessionStepLog.$final.call(this)},this.InfoStreamIDGet=function(){return this.FInfoStream.IDRead()},this.InfoStreamIDSet=function(t){this.FInfoStream.IDWrite(t)},this.ReplaceInfoStream=function(t){null!==this.FInfoStream&&rtl.free(this,"FInfoStream"),this.FInfoStream=t,this.FStreamRegistered=!0},this.Create$3=function(e,i){return t.TSESSessionStepLog.Create$2.call(this,e,!0),this.FInfoStream=t.TSERTTKSessionInfoStream.$create("Create$2",[i]),this.FStreamRegistered=!1,this},this.Destroy=function(){this.FStreamRegistered||rtl.free(this,"FInfoStream"),pas.System.TObject.Destroy.call(this)},this.$rtti.addProperty("InfoStreamID",3,rtl.string,"InfoStreamIDGet","InfoStreamIDSet")})),rtl.createClass(this,"TSERTTKSessionInfoStreams",pas["Generics.Collections"].TObjectDictionary$G1,(function(){this.$init=function(){pas["Generics.Collections"].TObjectDictionary$G1.$init.call(this),this.FOwnerInterface=null},this.$final=function(){rtl.setIntfP(this,"FOwnerInterface",null),pas["Generics.Collections"].TObjectDictionary$G1.$final.call(this)},this.GetItemClass=function(){return t.TSERTTKSessionInfoStream},this._AddRef=function(){return null!==this.FOwnerInterface?this.FOwnerInterface._AddRef():-1},this._Release=function(){return null!==this.FOwnerInterface?this.FOwnerInterface._Release():-1},this.QueryInterface=function(t,e){return this.GetInterface(t,e)?0:-2147467262},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCBaseListIO)})),rtl.createClass(this,"TSESSessionStepInfoTree",this.TSESSessionStepInfoStream,(function(){this.Create$4=function(e){return t.TSESSessionStepInfoStream.Create$3.call(this,e,t.stream_fileext_json),this}})),rtl.createClass(this,"TSESSessionStepInfoCSV",this.TSESSessionStepInfoStream,(function(){this.Create$4=function(e){return t.TSESSessionStepInfoStream.Create$3.call(this,e,t.stream_fileext_csv),this}})),rtl.createClass(this,"TSESScreenDiffInfo",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.Score=0,this.Diffs=null},this.$final=function(){this.Diffs=void 0,pas.System.TObject.$final.call(this)},this.Destroy=function(){rtl.free(this,"Diffs"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TSEStepDiffAnalysis",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FScreenList=null},this.$final=function(){this.FScreenList=void 0,pas.System.TObject.$final.call(this)},this.Destroy=function(){rtl.free(this,"FScreenList"),pas.System.TObject.Destroy.call(this)},this.ScreenDiffInfo=function(t,e){return this.FScreenList.TryGetValue(t,e)}})),rtl.createClass(this,"TSESupSessionStepInfo",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FID=pas.System.TGuid.$new(),this.FClassType=""},this.$final=function(){this.FID=void 0,pas.Classes.TPersistent.$final.call(this)},this.GuidRead=function(){return pas.SysUtils.TGuidHelper.ToString.call(this.FID,!1)},this.GuidWrite=function(t){this.FID.$assign(pas.SysUtils.StringToGUID(t))},this.ClassTypeWrite=function(t){},this.Create$1=function(t,e){return this.FID.$assign(t),this.FClassType=e,this.ClassTypeWrite(e),this};var t=this.$rtti;t.addProperty("ID",3,rtl.string,"GuidRead","GuidWrite"),t.addProperty("ClassTypeName",2,rtl.string,"FClassType","ClassTypeWrite")})),rtl.createClass(this,"TSERTTKSessionStepInfos",pas["Generics.Collections"].TObjectList$G4,(function(){this.$init=function(){pas["Generics.Collections"].TObjectList$G4.$init.call(this),this.FOwnerInterface=null},this.$final=function(){rtl.setIntfP(this,"FOwnerInterface",null),pas["Generics.Collections"].TObjectList$G4.$final.call(this)},this.GetItemClass=function(){return t.TSESupSessionStepInfo},this._AddRef=function(){return null!==this.FOwnerInterface?this.FOwnerInterface._AddRef():-1},this._Release=function(){return null!==this.FOwnerInterface?this.FOwnerInterface._Release():-1},this.QueryInterface=function(t,e){return this.GetInterface(t,e)?0:-2147467262},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCBaseListIO)})),rtl.createClass(this,"TSESupSessionManifest",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FStartTime=0,this.FEndTime=0,this.FAppInfoStream="",this.FStepInfos=null,this.FApplicationName=""},this.$final=function(){this.FStepInfos=void 0,pas.Classes.TPersistent.$final.call(this)},this.AddStep=function(e,i){var s;s=t.TSESupSessionStepInfo.$create("Create$1",[e,i]),this.FStepInfos.Add(s),this.UpdateEndTime()},this.Create$1=function(e){return this.FStartTime=pas.SysUtils.Now(),this.FApplicationName=e,this.FStepInfos=t.TSERTTKSessionStepInfos.$create("Create$4",[!0]),this.UpdateEndTime(),this},this.Destroy=function(){rtl.free(this,"FStepInfos"),pas.System.TObject.Destroy.call(this)},this.UpdateEndTime=function(){this.FEndTime=pas.SysUtils.Now()};var e=this.$rtti;e.addProperty("ApplicationName",0,rtl.string,"FApplicationName","FApplicationName"),e.addProperty("EndTime",0,pas.System.$rtti.TDateTime,"FEndTime","FEndTime"),e.addProperty("StartTime",0,pas.System.$rtti.TDateTime,"FStartTime","FStartTime"),e.addProperty("StepInfos",0,t.$rtti.TSERTTKSessionStepInfos,"FStepInfos","FStepInfos"),e.addProperty("AppInfoStream",0,rtl.string,"FAppInfoStream","")})),rtl.createClass(this,"TSESupSessionInfo",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FStartTime=0,this.FApplicationName="",this.FVersion=0};var t=this.$rtti;t.addProperty("Version",0,rtl.longint,"FVersion","FVersion"),t.addProperty("StartTime",0,pas.System.$rtti.TDateTime,"FStartTime","FStartTime"),t.addProperty("ApplicationName",0,rtl.string,"FApplicationName","FApplicationName")})),rtl.createClass(this,"TSERTTKSessionStorageBitmap",this.TSERTTKSessionStorageBase,(function(){this.$init=function(){t.TSERTTKSessionStorageBase.$init.call(this),this.FBitmap=null},this.$final=function(){this.FBitmap=void 0,t.TSERTTKSessionStorageBase.$final.call(this)},this.Create$2=function(e){return t.TSERTTKSessionStorageBase.Create$1.call(this),this.FBitmap=null===e?pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"):e,this},this.Destroy=function(){null!==this.FBitmap&&rtl.free(this,"FBitmap"),pas.System.TObject.Destroy.call(this)},this.$rtti.addProperty("Bitmap",0,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FBitmap","FBitmap")})),rtl.createClass(this,"TSERTTKSessionBitmaps",pas["Generics.Collections"].TObjectDictionary$G3,(function(){this.$init=function(){pas["Generics.Collections"].TObjectDictionary$G3.$init.call(this),this.FOwnerInterface=null},this.$final=function(){rtl.setIntfP(this,"FOwnerInterface",null),pas["Generics.Collections"].TObjectDictionary$G3.$final.call(this)},this.GetItemClass=function(){return t.TSERTTKSessionStorageBitmap},this._AddRef=function(){return null!==this.FOwnerInterface?this.FOwnerInterface._AddRef():-1},this._Release=function(){return null!==this.FOwnerInterface?this.FOwnerInterface._Release():-1},this.QueryInterface=function(t,e){return this.GetInterface(t,e)?0:-2147467262},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCBaseListIO)})),rtl.createClass(this,"TSERTTKSessionSteps",pas["Generics.Collections"].TObjectDictionary$G4,(function(){this.$init=function(){pas["Generics.Collections"].TObjectDictionary$G4.$init.call(this),this.FOwnerInterface=null},this.$final=function(){rtl.setIntfP(this,"FOwnerInterface",null),pas["Generics.Collections"].TObjectDictionary$G4.$final.call(this)},this.GetItemClass=function(){return t.TSESSessionStepLog},this._AddRef=function(){return null!==this.FOwnerInterface?this.FOwnerInterface._AddRef():-1},this._Release=function(){return null!==this.FOwnerInterface?this.FOwnerInterface._Release():-1},this.QueryInterface=function(t,e){return this.GetInterface(t,e)?0:-2147467262},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCBaseListIO)})),rtl.createClass(this,"TSERTTKSessionStorageMemory",pas.Classes.TInterfacedPersistent,(function(){this.$init=function(){pas.Classes.TInterfacedPersistent.$init.call(this),this.FSteps=null,this.FBitmaps=null,this.FInfoStreams=null,this.FApplicationName="",this.FManifest=null,this.FEvents=null},this.$final=function(){this.FSteps=void 0,this.FBitmaps=void 0,this.FInfoStreams=void 0,this.FManifest=void 0,this.FEvents=void 0,pas.Classes.TInterfacedPersistent.$final.call(this)},this.StartTimeGet=function(){return this.FManifest.FStartTime},this.EndTimeGet=function(){return this.FManifest.FEndTime},this.CreateObject=function(e,i){var s=null,n=pas.System.TGuid.$new(),o=rtl.createIntfRefs();try{s=null,o.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Create Object class = "+e+" base class = "+i.$classname,this),"TTMSFNCBitmap"===e?s=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"):"TSERTTKSessionStorageBitmap"===e?s=t.TSERTTKSessionStorageBitmap.$create("Create$2",[null]):"TSESSessionStepLog"===e?s=t.TSESSessionStepLog.$create("Create$2",["",!0]):"TSESSessionStepInspector"===e?s=t.TSESSessionStepInspector.$create("Create$3",["",!0]):"TSESSessionBookmark"===e?s=t.TSESSessionBookmark.$create("Create$3",[""]):"TSESSessionScreenDiff"===e?s=t.TSESSessionScreenDiff.$create("Create$1",[""]):"TSERTTKSessionScreenDiffs"===e?s=t.TSERTTKSessionScreenDiffs.$create("Create$4",[!0]):"TSESSessionScreenShot"===e?s=t.TSESSessionScreenShot.$create("Create$3",["","",!0]):"TSESSessionCompExport"===e?s=t.TSESSessionCompExport.$create("Create$2",["",!0]):"TSESSessionStepInfoTree"===e?s=t.TSESSessionStepInfoTree.$create("Create$4",[""]):"TSESSessionStepInfoCSV"===e?s=t.TSESSessionStepInfoCSV.$create("Create$4",[""]):"TSESupSessionStepInfo"===e?s=t.TSESupSessionStepInfo.$create("Create$1",[n,""]):"TSESSessionStepBitmap"===e?s=t.TSESSessionStepBitmap.$create("Create$3",["",!1]):"TSERTTKSessionInfoStream"===e?s=t.TSERTTKSessionInfoStream.$create("Create$2",["rest"]):"TSESSessionStepInfoStream"===e?s=t.TSESSessionStepInfoStream.$create("Create$3",["","rest"]):o.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Unknown class on JSON restore class = "+e+" Base="+i.$classname,this)}finally{o.free()}return s},this.Create$1=function(e){var i=null;return this.FApplicationName=e,this.FManifest=t.TSESupSessionManifest.$create("Create$1",[this.FApplicationName]),this.FSteps=t.TSERTTKSessionSteps.$create("Create$5",[rtl.createSet(1)]),this.FInfoStreams=t.TSERTTKSessionInfoStreams.$create("Create$5",[rtl.createSet(1)]),i=t.TSESSessionStepLog.$create("Create$2",["Memory store ready",!0]),this.FSteps.Add(i.IDRead(),i),this.FBitmaps=t.TSERTTKSessionBitmaps.$create("Create$5",[rtl.createSet(1)]),this.FEvents=pas.Classes.TStringList.$create("Create$1"),this},this.Create$2=function(e,i){return this.FSteps=t.TSERTTKSessionSteps.$create("Create$5",[rtl.createSet(1)]),this.FBitmaps=t.TSERTTKSessionBitmaps.$create("Create$5",[rtl.createSet(1)]),this.FInfoStreams=t.TSERTTKSessionInfoStreams.$create("Create$5",[rtl.createSet(1)]),this.FEvents=pas.Classes.TStringList.$create("Create$1"),this.FManifest=t.TSESupSessionManifest.$create("Create$1",["123"]),this},this.Destroy=function(){rtl.free(this,"FBitmaps"),rtl.free(this,"FSteps"),rtl.free(this,"FManifest"),rtl.free(this,"FEvents"),rtl.free(this,"FInfoStreams"),pas.System.TObject.Destroy.call(this)},this.AddSessionStep=function(e){var i=rtl.createIntfRefs();try{this.FSteps.Add(e.IDRead(),e),this.FManifest.AddStep(e.FID,e.$classname),this.FEvents.Add(e.IDRead()),t.TSESSessionStepInfoStream.isPrototypeOf(e)&&(this.AddInfoStream(e.FInfoStream)?e.FStreamRegistered=!0:i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Error$1("Stream not correctly registred in session memory",this))}finally{i.free()}},this.BitmapByGuid=function(t,e){var i,s=null;return(i=this.FBitmaps.TryGetValue(pas.SysUtils.TGuidHelper.ToString.call(t,!1),{get:function(){return s},set:function(t){s=t}}))&&e.set(s.FBitmap),i},this.SaveToFile=function(t){this.FManifest.UpdateEndTime(),pas["WEBLib.TMSFNCTypes"].TTMSFNCObjectHelper.SaveToJSONFile.call(this,t)},this.AddInfoStream=function(t){return!0,t.PrepareExportBase64(),this.FInfoStreams.Add(t.IDRead(),t),!0},this.LoadStepInfoStream=function(t){var e,i=null;return(e=this.FInfoStreams.TryGetValue(t.InfoStreamIDGet(),{get:function(){return i},set:function(t){i=t}}))&&t.ReplaceInfoStream(i),e},rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCBasePersistenceIO),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Manifest",0,t.$rtti.TSESupSessionManifest,"FManifest",""),e.addProperty("Bitmaps",0,t.$rtti.TSERTTKSessionBitmaps,"FBitmaps","FBitmaps"),e.addProperty("InfoStreams",0,t.$rtti.TSERTTKSessionInfoStreams,"FInfoStreams","FInfoStreams"),e.addProperty("StartTime",1,pas.System.$rtti.TDateTime,"StartTimeGet",""),e.addProperty("EndTime",1,pas.System.$rtti.TDateTime,"EndTimeGet",""),e.addProperty("ApplicationName",0,rtl.string,"FApplicationName","FApplicationName"),e.addProperty("Steps",0,t.$rtti.TSERTTKSessionSteps,"FSteps","FSteps"),e.addProperty("Events",0,pas.Classes.$rtti.TStringList,"FEvents","FEvents")})),rtl.createClass(this,"TSESSession",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FStepDiffAnalysis=null,this.FStorePersist=!1,this.FStorageMemory=null},this.$final=function(){this.FStepDiffAnalysis=void 0,this.FStorageMemory=void 0,pas.Classes.TPersistent.$final.call(this)},this.CreateCommon=function(t){this.FStepDiffAnalysis=pas["Generics.Collections"].TObjectDictionary$G5.$create("Create$5",[rtl.createSet(1)])},this.SessionStepsGet=function(){return this.FStorageMemory.FSteps},this.EventsGet=function(){return this.FStorageMemory.FEvents},this.ApplicationNameGet=function(){return null!==this.FStorageMemory?this.FStorageMemory.FApplicationName:"Name unset in Manifest"},this.RegisterJSONDependency=function(){pas.Classes.RegisterClass(t.TSESSessionStepBase),pas.Classes.RegisterClass(t.TSESSessionStepLog),pas.Classes.RegisterClass(t.TSESSessionStepInspector),pas.Classes.RegisterClass(t.TSESSessionScreenDiff),pas.Classes.RegisterClass(t.TSESSessionScreenShot),pas.Classes.RegisterClass(t.TSESupSessionStepInfo),pas.Classes.RegisterClass(t.TSESupSessionInfo),pas.Classes.RegisterClass(t.TSESupSessionManifest),pas.Classes.RegisterClass(t.TSESSessionCompExport),pas.Classes.RegisterClass(t.TSESSessionStepBitmap),pas.Classes.RegisterClass(t.TSERTTKSessionInfoStream),pas.Classes.RegisterClass(t.TSESSessionStepInfoStream),pas.Classes.RegisterClass(t.TSESSessionStepInfoTree),pas.Classes.RegisterClass(t.TSESSessionStepInfoCSV),pas.Classes.RegisterClass(t.TSESSessionBookmark),pas.Classes.RegisterClass(t.TSERTTKSessionStorageMemory),pas.Classes.RegisterClass(t.TSERTTKSessionStorageBitmap),pas.Classes.RegisterClass(pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap)},this.StepAdd=function(t){if(null==t)throw pas.SysUtils.Exception.$create("Create$1",["not a step"]);this.FStorageMemory.AddSessionStep(t)},this.AddBookmark=function(t){this.StepAdd(t)},this.AddStep=function(e,i){this.StepAdd(t.TSESSessionStepLog.$create("Create$2",[e,i]))},this.SessionJsonFileName=function(){return"RTM."+this.ApplicationNameGet()+"."+pas.SysUtils.FormatDateTime(t.file_dt_fmt,this.FStorageMemory.StartTimeGet())+t.file_ext_session_json},this.SessionJSONSaveToFile=function(t){this.$class.RegisterJSONDependency(),null!=this.FStorageMemory&&this.FStorageMemory.SaveToFile(t)},this.Create$1=function(e,i,s){return this.FStorageMemory=t.TSERTTKSessionStorageMemory.$create("Create$1",[e]),this.CreateCommon(!0),this.$class.RegisterJSONDependency(),this.FStorePersist=i,this.AddStep("Session started",!0),this},this.Destroy=function(){rtl.free(this,"FStepDiffAnalysis"),rtl.free(this,"FStorageMemory"),pas.System.TObject.Destroy.call(this)},this.BitmapByGuid=function(t,e){var i=null;return this.FStorageMemory.BitmapByGuid(t,{get:function(){return i},set:function(t){i=t}})?(e.set(i),!0):!1},this.InfoStreamByStep=function(t){var e=!1,i=rtl.createIntfRefs();try{(e=this.FStorageMemory.LoadStepInfoStream(t))?i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Memory returned info stream",this):(i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Store is not persisted - info stream",this),e=!1),e&&t.FInfoStream.FStream.SetPosition(0)}finally{i.free()}return e},this.StepDiffAnalysis=function(t,e){return!1!==this.FStorePersist&&this.FStepDiffAnalysis.TryGetValue(t,e)}})),t.$implcode=function(){e.E_NOINTERFACE=2147500034}}),["DateUtils","WEBLib.TMSFNCUtils","WebLib.SEFNC.Logger","WEBLib.Crypto","NetEncoding"]),rtl.module("WebLib.SEConstable.Registry",["System","Generics.Collections","Classes","WebLib.SEConstable.Repository"],(function(){"use strict";var t=this,e=t.$impl;rtl.createInterface(this,"IConstablePlugins","{63B1B35F-D84E-4A8F-A282-CCF29219BB36}",["Transforms"],pas.System.IUnknown),this.MarshalPlugins=function(){var t=null,i=!1;try{t=rtl.setIntfL(t,e.TMarshalPluginFactory.FPlugins),i=!0}finally{i||rtl._Release(t)}return t},t.$implcode=function(){rtl.createClass(e,"TMarshalPluginFactory",pas.System.TObject,(function(){this.FPlugins=null})),rtl.createClass(e,"TMarshalPlugins",pas.System.TInterfacedObject,(function(){this.$init=function(){pas.System.TInterfacedObject.$init.call(this),this.FTransforms=null},this.$final=function(){this.FTransforms=void 0,pas.System.TInterfacedObject.$final.call(this)},this.Create$1=function(){return this.FTransforms=pas["Generics.Collections"].TObjectList$G8.$create("Create$4",[!0]),this},this.Destroy=function(){rtl.free(this,"FTransforms"),pas.System.TObject.Destroy.call(this)},this.Transforms=function(){return this.FTransforms},rtl.addIntf(this,t.IConstablePlugins),rtl.addIntf(this,pas.System.IUnknown)}))},t.$init=function(){rtl.setIntfP(e.TMarshalPluginFactory,"FPlugins",rtl.queryIntfT(e.TMarshalPlugins.$create("Create$1"),t.IConstablePlugins),!0)}}),[]),rtl.module("WebLib.SEConstable.Repository",["System","Generics.Collections","Classes","WEBLib.Forms","WEBLib.Modules","WEBLib.Forms","WEBLib.TMSFNCTypes","WebLib.SEconstable.Session","SysUtils"],(function(){"use strict";var t=this;this.SupFormName="SEConstableForm",rtl.createClass(this,"ESERTTKBaseException",pas.SysUtils.Exception,(function(){})),rtl.createClass(this,"ESERTTKTransformException",this.ESERTTKBaseException,(function(){})),rtl.createClass(this,"TSESInspectToolBase",pas.System.TObject,(function(){})),rtl.createClass(this,"TSERTTKRepoItem",pas.System.TObject,(function(){this.txt_path_delim="|",this.$init=function(){pas.System.TObject.$init.call(this),this.FLabels=null,this.FChildren=null,this.FRepoParent=null,this.FRepoRoot=null,this.FRefObject=null,this.FToolInfos=null},this.$final=function(){this.FLabels=void 0,this.FChildren=void 0,this.FRepoParent=void 0,this.FRepoRoot=void 0,this.FRefObject=void 0,this.FToolInfos=void 0,pas.System.TObject.$final.call(this)},this.RootLookupObject=function(t,e){return this.FRepoRoot.FRefApplication.RootLookupObject$1(t,e)},this.VerifyParent=function(){var t=null,e=null,i=null,s=rtl.createIntfRefs();try{pas.Classes.TComponent.isPrototypeOf(this.FRefObject)&&((t=this.FRefObject).HasParent()?(e=t.GetParentComponent(),s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1(t.FName+" Parent is "+e.FName,this),this.FRepoParent.FRefObject===e?s.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Parent is correct",this):(s.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("UPDATE Parent needed",this),this.RootLookupObject(e,{get:function(){return i},set:function(t){i=t}})?this.ChangeParent(i):s.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("!!Parent not found to sanitize",this))):s.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1(t.FName+" has no parent",this))}finally{s.free()}},this.GetCompDisplayName=function(){var t="";return t=this.RefObjName(),pas.SysUtils.TStringHelper.Contains.call({get:function(){return t},set:function(e){t=e}},"}")&&pas.SysUtils.TStringHelper.Contains.call({get:function(){return t},set:function(e){t=e}},"{")&&(t=pas.SysUtils.TStringHelper.Replace$2.call({get:function(){return t},set:function(e){t=e}},"}",'<FONT color="#800000">'),t=pas.SysUtils.TStringHelper.Replace$2.call({get:function(){return t},set:function(e){t=e}},"{","</FONT>")),t},this.GetCompDisplayPath=function(){var t="";return t=pas.SysUtils.TStringHelper.Replace$2.call({a:this.RefObjPath(),get:function(){return this.a},set:function(t){this.a=t}},"|",' <FONT color="#FF0000">\\</FONT> '),pas.SysUtils.TStringHelper.Contains.call({get:function(){return t},set:function(e){t=e}},"}")&&pas.SysUtils.TStringHelper.Contains.call({get:function(){return t},set:function(e){t=e}},"{")&&(t=pas.SysUtils.TStringHelper.Replace$2.call({get:function(){return t},set:function(e){t=e}},"}",'<FONT color="#800000">'),t=pas.SysUtils.TStringHelper.Replace$2.call({get:function(){return t},set:function(e){t=e}},"{","</FONT>")),t},this.DiscoverChildren=function(){var t=0,e=0,i=0,s=null,n=null,o=null,r=null,a=null,l=rtl.createIntfRefs();try{try{if(pas["WEBLib.Controls"].TControl.isPrototypeOf(this.FRefObject)){l.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Repo Item:Discover Children - Step Loading Controls "+this.RefObjName(),this),a=this.FRefObject;for(var h=0,F=a.GetControlsCount()-1;h<=F;h++)if(e=h,3 in(r=a.GetControls(e)).FComponentState)l.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Repo Item:Discover Children - Control destroying, aborting",this);else if(s=r,this.RootLookupObject(s,{get:function(){return o},set:function(t){o=t}})?(l.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Repo Item:Discover Children - Comp in the root list"+s.FName,this),this.FChildren.Contains(o)?l.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Repo Item:Discover Children - found in child list"+s.FName,this):(l.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Repo Item:Discover Children - missing from child list"+s.FName,this),o.ChangeParent(this))):(l.ref(6,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Repo Item:Discover Children - not found in the root list"+s.FName,this),o=this.AddChild(s)),pas["WEBLib.Controls"].TWinControl.isPrototypeOf(o.FRefObject)?o.FRefObject.GetControlsCount()>0&&(l.ref(7,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Repo Item:Discover Children - Recursion Discover children for "+o.FRefObject.FName,this),o.DiscoverChildren()):l.ref(8,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1(r.FName+" Not WinControl",this),9 in r.FComponentState){for(var p=0,c=r.GetComponentCount()-1;p<=c;p++)i=p,3 in(n=r.GetComponent(i)).FComponentState||o.AddChild(n);o.DiscoverChildren()}}l.ref(9,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Repo Item:Discover children ::Child count = "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:this.FChildren,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this);for(var u=this.FChildren.FLength-1;u>=0;u--)t=u,this.FChildren.GetItem(t).VerifyParent()}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;var T=t;l.ref(10,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Repo Item:Discover children ex="+T.fMessage,this)}}finally{l.free()}},this.AddChild=function(e){var i=null;if(null===e)throw pas.SysUtils.Exception.$create("Create$1",["Cannot add nil child reference"]);return this.FRepoRoot.FRefApplication.RootLookupObject$1(e,{get:function(){return i},set:function(t){i=t}})?i.ChangeParent(this):(i=t.TSERTTKRepoItem.$create("Create$1",[e,this,this.FRepoRoot]),this.FRepoRoot.FRefApplication.AddRefObject(i)),this.FChildren.Add(i),i},this.RefObjName=function(){var t="";return pas.Classes.TComponent.isPrototypeOf(this.FRefObject)&&(t=pas.SysUtils.Format("%s",pas.System.VarRecs(18,this.FRefObject.FName)),pas.SysUtils.TStringHelper.GetLength.call({a:pas.SysUtils.TStringHelper.Trim.call({get:function(){return t},set:function(e){t=e}}),get:function(){return this.a},set:function(t){this.a=t}})>0)?t:t="}"+this.FRefObject.$classname+"{"},this.RefObjPath=function(){var t="";return t=this.RefObjName(),null!==this.FRepoParent&&(t=this.FRepoParent.RefObjPath()+this.txt_path_delim+t),t},this.ChangeParent=function(t){var e=!1,i=rtl.createIntfRefs();try{e=!1;try{if(null===this.FRepoParent&&(this.FRepoParent=t,i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Parent was nil for "+this.RefObjName()+", changed to new parent ="+t.RefObjName(),this)),this.FRepoParent.Equals(t))return!0;i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Change Parent "+this.FRepoParent.RefObjName()+" to + "+t.RefObjName(),this),i.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Parent count before extract "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:this.FRepoParent.FChildren,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this),this.FRepoParent.FChildren.Extract(this),i.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Parent count after extract "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:this.FRepoParent.FChildren,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this),this.FRepoParent=t,i.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Parent now "+this.FRepoParent.RefObjName(),this),i.ref(6,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Parent count before add "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:this.FRepoParent.FChildren,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this),this.FRepoParent.FChildren.Add(this),i.ref(7,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Parent count after add "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:this.FRepoParent.FChildren,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this),e=!0}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;var s=t;i.ref(8,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Exception on change parent :"+s.fMessage,this)}}finally{i.free()}return e},this.Create$1=function(t,e,i){return this.FToolInfos=pas["Generics.Collections"].TObjectList$G6.$create("Create$4",[!0]),this.FLabels=pas["Generics.Collections"].TObjectList$G5.$create("Create$4",[!0]),this.FChildren=pas["Generics.Collections"].TList$G12.$create("Create$1"),this.FRefObject=t,this.FRepoParent=e,this.FRepoRoot=i,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FToolInfos},set:function(t){this.p.FToolInfos=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FLabels},set:function(t){this.p.FLabels=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FChildren},set:function(t){this.p.FChildren=t}}),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TSESRepoLabel",this.TSERTTKRepoItem,(function(){})),rtl.createClass(this,"TSESRepoRoot",this.TSERTTKRepoItem,(function(){this.$init=function(){t.TSERTTKRepoItem.$init.call(this),this.FRefApplication=null,this.FRootComponent=null},this.$final=function(){this.FRefApplication=void 0,this.FRootComponent=void 0,t.TSERTTKRepoItem.$final.call(this)},this.Create$2=function(e,i){var s=rtl.createIntfRefs();try{t.TSERTTKRepoItem.Create$1.call(this,e,null,this),this.FRefApplication=i,this.FRootComponent=e,s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("RepoRoot::Create: starting to Tree the components",this)}finally{s.free()}return this},this.DiscoverChildren=function(){var e=0,i=rtl.createIntfRefs();try{for(var s=0,n=this.FRootComponent.GetComponentCount()-1;s<=n;s++)e=s,3 in this.FRootComponent.GetComponent(e).FComponentState?i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Control destroying, aborting",this):this.AddChild(this.FRootComponent.GetComponent(e));i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Child count = "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:this.FChildren,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this),t.TSERTTKRepoItem.DiscoverChildren.call(this),i.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Child count = "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:this.FChildren,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this)}finally{i.free()}}})),rtl.createClass(this,"TSESRepoRootComp",this.TSESRepoRoot,(function(){this.GetDisplayName=function(){var t="";return null!=this.FRootComponent&&(t=this.FRootComponent.FName),t},this.LoadRootControls=function(){var t=rtl.createIntfRefs();try{try{t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Load root controls - Begin for item "+this.RefObjName(),this),this.FChildren.Clear(),this.DiscoverChildren(),t.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Load root controls - End for item "+this.RefObjName(),this)}catch(e){if(!pas.SysUtils.Exception.isPrototypeOf(e))throw e;t.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("failed loading controls for root "+this.GetDisplayName(),this)}}finally{t.free()}}})),rtl.createClass(this,"TSESRepoForm",this.TSESRepoRootComp,(function(){this.ActiveControl=function(){if(!this.HasActive())throw pas.SysUtils.Exception.$create("Create$1",["No active control"]);return this.FRootComponent.GetActiveControl()},this.HasActive=function(){return null!==this.FRootComponent.GetActiveControl()}})),rtl.createClass(this,"TSESRepoDataModule",this.TSESRepoRootComp,(function(){})),rtl.createClass(this,"TSESAppReference",this.TSERTTKRepoItem,(function(){this.$init=function(){t.TSERTTKRepoItem.$init.call(this),this.FAppName="",this.FRoots=null,this.FObjectDict=null,this.FApplication=null},this.$final=function(){this.FRoots=void 0,this.FObjectDict=void 0,this.FApplication=void 0,t.TSERTTKRepoItem.$final.call(this)},this.ClearRoots=function(){null!=this.FRoots&&rtl.free(this,"FRoots"),this.FRoots=pas["Generics.Collections"].TList$G14.$create("Create$1")},this.AddRefObject=function(t){this.FObjectDict.AddOrSetValue(t.FRefObject,t)},this.AddRoot=function(t){var e=rtl.createIntfRefs();try{this.FRoots.Add(t),this.AddRefObject(t),e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Root added "+t.RefObjName(),this)}finally{e.free()}},this.RefreshRoot=function(e){var i=!1,s=null,n=rtl.createIntfRefs();try{try{n.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Refresh Root, = "+e.RefObjName(),this),t.TSESRepoRootComp.isPrototypeOf(e)?(s=e,n.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Discover begin for loop item "+s.RefObjName(),this),s.LoadRootControls(),n.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Discover end for loop item "+s.RefObjName(),this),i=!0):i=!1}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){throw pas.SysUtils.Exception.$create("Create$1",["Unknown repo root on reload"])}throw t}}finally{n.free()}return i},this.RootLookupObject$1=function(t,e){return this.FObjectDict.TryGetValue(t,e)},this.Create$2=function(e){return t.TSERTTKRepoItem.Create$1.call(this,e,null,null),this.FApplication=e,this.ClearRoots(),this.FObjectDict=pas["Generics.Collections"].TObjectDictionary$G6.$create("Create$5",[rtl.createSet(1)]),this},this.Destroy=function(){rtl.free(this,"FRoots"),rtl.free(this,"FObjectDict"),t.TSERTTKRepoItem.Destroy.call(this)}})),rtl.createClass(this,"TSESProvider",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FAppReference=null},this.$final=function(){this.FAppReference=void 0,pas.System.TObject.$final.call(this)},this.FilterForm=function(t){return!1,!1},this.AppComp=function(){return pas["WEBLib.Forms"].Application},this.ApplicationName=function(){var t="";return t=location.pathname,0===pas.SysUtils.TStringHelper.GetLength.call({get:function(){return t},set:function(e){t=e}})?"WebApp":t},this.DiscoverForms=function(){var e=0,i=null,s=null,n=rtl.createIntfRefs();try{n.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Discover Forms: Begin Discover root count ="+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:this.FAppReference.FRoots,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this),null!=pas["WEBLib.Forms"].Application.FMainForm?(n.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Discover Forms: main form assigned",this),i=t.TSESRepoForm.$create("Create$2",[pas["WEBLib.Forms"].Application.FMainForm,this.FAppReference]),this.FAppReference.AddRoot(i),n.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Discover Forms: Begin load root controls "+i.RefObjName(),this),i.LoadRootControls(),n.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Discover Forms: End load root controls "+i.RefObjName(),this)):n.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("main form nil",this),n.ref(6,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Discover Forms: App component count = "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:pas["WEBLib.Forms"].Application.GetComponentCount(),get:function(){return this.p},set:function(t){this.p=t}}),this);for(var o=0,r=pas["WEBLib.Forms"].Application.GetComponentCount()-1;o<=r;o++)if(e=o,pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(pas["WEBLib.Forms"].Application.GetComponent(e)))if(this.$class.FilterForm(pas["WEBLib.Forms"].Application.GetComponent(e).FName))n.ref(7,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Discover Forms:Form filtered ="+pas["WEBLib.Forms"].Application.GetComponent(e).FName,this);else{if(n.ref(8,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Discover Forms:Evaluating form ="+pas["WEBLib.Forms"].Application.GetComponent(e).FName,this),this.FAppReference.RootLookupObject$1(pas["WEBLib.Forms"].Application.GetComponent(e),{get:function(){return s},set:function(t){s=t}})){if(t.TSESRepoForm.isPrototypeOf(s)){n.ref(9,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Discover Forms:Root exists, "+s.RefObjName(),this);continue}throw pas.SysUtils.Exception.$create("Create$1",["Object found not form"])}i=t.TSESRepoForm.$create("Create$2",[pas["WEBLib.Forms"].Application.GetComponent(e),this.FAppReference]),this.FAppReference.AddRoot(i),n.ref(10,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Discover Forms:Discover begin for loop item "+i.RefObjName(),this),i.LoadRootControls(),n.ref(11,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Discover Forms:Discover end for loop item "+i.RefObjName(),this)}n.ref(12,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Discover Forms:Forms Loaded",this)}finally{n.free()}},this.DiscoverDataModules=function(){var e=0,i=null,s=null,n=rtl.createIntfRefs();try{n.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Discover DataModules: Creating DataModule list",this);for(var o=0,r=pas["WEBLib.Forms"].Application.GetComponentCount()-1;o<=r;o++)if(e=o,pas["WEBLib.Modules"].TDataModule.isPrototypeOf(pas["WEBLib.Forms"].Application.GetComponent(e))){if(this.FAppReference.RootLookupObject$1(pas["WEBLib.Forms"].Application.GetComponent(e),{get:function(){return s},set:function(t){s=t}})){if(t.TSESRepoDataModule.isPrototypeOf(s))return void n.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Root exists, "+s.RefObjName(),this);throw pas.SysUtils.Exception.$create("Create$1",["Object found not datamodule"])}i=t.TSESRepoDataModule.$create("Create$2",[pas["WEBLib.Forms"].Application.GetComponent(e),this.FAppReference]),this.FAppReference.AddRoot(i),n.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Discover begin for loop item "+i.RefObjName(),this),i.LoadRootControls(),n.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Discover end for loop item "+i.RefObjName(),this)}n.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("DataModules loaded",this)}finally{n.free()}}})),rtl.createClass(this,"ETransformException",pas.SysUtils.Exception,(function(){})),rtl.createClass(this,"ETransformIndividualFailed",this.ETransformException,(function(){})),rtl.createClass(this,"TSESTransformBase",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FRepoItem=null,this.FRepoRoot=null,this.FTransformClass=null},this.$final=function(){this.FRepoItem=void 0,this.FRepoRoot=void 0,this.FTransformClass=void 0,pas.System.TObject.$final.call(this)},this.Transform=function(e,i){this.FRepoItem=e,this.FRepoRoot=i;try{if(!this.FTransformClass.isPrototypeOf(this.FRepoItem.FRefObject))return;this.ExecTransform()}catch(e){if(pas.SysUtils.Exception.isPrototypeOf(e)){throw t.ETransformIndividualFailed.$create("Create$1",["Could not execute transform for "+this.TransClassName()])}throw e}},this.TransClassName=function(){return this.FTransformClass.$classname}})),rtl.createClass(this,"TSERTTKClassTransforms",pas["Generics.Collections"].TList$G17,(function(){})),rtl.createClass(this,"TSERTTKTransformRegistry",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FRegistry=null},this.$final=function(){this.FRegistry=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(){return this.FRegistry=pas["Generics.Collections"].TObjectDictionary$G8.$create("Create$5",[rtl.createSet(1)]),this},this.Destroy=function(){rtl.free(this,"FRegistry"),pas.System.TObject.Destroy.call(this)},this.AddTransform=function(t){var e,i=null;e=t.FTransformClass,this.FRegistry.TryGetValue(e,{get:function(){return i},set:function(t){i=t}})?i.Add(t):((i=pas["Generics.Collections"].TObjectList$G8.$create("Create$4",[!0])).Add(t),this.FRegistry.Add(e,i))},this.GetTransforms=function(e,i){var s,n=null,o=null;if(s=this.FRegistry.TryGetValue(e,{get:function(){return n},set:function(t){n=t}})){null==i.get()&&i.set(t.TSERTTKClassTransforms.$create("Create$1"));var r=n.GetEnumerator$1();try{for(;r.MoveNext();)o=r.DoGetCurrent(),i.get().Add(o)}finally{r=rtl.freeLoc(r)}}return s},this.TransformCount=function(){return this.FRegistry.GetCount()}})),rtl.createClass(this,"TSERTTKTransformClasses",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FCache=null,this.FRegistry=null},this.$final=function(){this.FCache=void 0,this.FRegistry=void 0,pas.System.TObject.$final.call(this)},this.TransformClass=function(t,e){var i=!1,s=null,n=null,o=0;i=!1,s=pas.contnrs.TClassList.$create("Create$1");try{n=t,s.Add$1(t);do{n=n.$ancestor,s.Insert$1(0,n)}while(n!==pas.System.TObject);for(var r=0,a=s.GetCount()-1;r<=a;r++)o=r,n=s.GetItems(o),this.FRegistry.GetTransforms(n,e)&&(i=!0)}finally{s=rtl.freeLoc(s)}return i},this.DiscoverRegistryTransforms=function(){var t=null,e=null,i=0,s=rtl.createIntfRefs();try{s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Plugin Registry transform count = "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:s.ref(2,pas["WebLib.SEConstable.Registry"].MarshalPlugins()).Transforms(),get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this);for(var n=s.ref(3,pas["WebLib.SEConstable.Registry"].MarshalPlugins()).Transforms().FLength-1;n>=0;n--)i=n,t=s.ref(4,pas["WebLib.SEConstable.Registry"].MarshalPlugins()).Transforms().GetItem(i),e=s.ref(5,pas["WebLib.SEConstable.Registry"].MarshalPlugins()).Transforms().Extract(t),this.FRegistry.AddTransform(e),s.ref(6,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Plugin transform count = "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:s.ref(7,pas["WebLib.SEConstable.Registry"].MarshalPlugins()).Transforms(),get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this),s.ref(8,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Registry transform count = "+pas.SysUtils.TIntegerHelper.ToString$1.call({a:this.FRegistry.TransformCount(),get:function(){return this.a},set:function(t){this.a=t}}),this)}finally{s.free()}},this.DiscoverTransforms=function(){var e=rtl.createIntfRefs();try{try{e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Discover Transforms::Repo Registry transform count = "+pas.SysUtils.TIntegerHelper.ToString$1.call({a:this.FRegistry.TransformCount(),get:function(){return this.a},set:function(t){this.a=t}}),this),this.DiscoverRegistryTransforms(),e.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Discover Transforms::Repo Registry transform count = "+pas.SysUtils.TIntegerHelper.ToString$1.call({a:this.FRegistry.TransformCount(),get:function(){return this.a},set:function(t){this.a=t}}),this)}catch(e){if(pas.SysUtils.Exception.isPrototypeOf(e)){throw t.ESERTTKTransformException.$create("Create$1",["Failed to Discover Transforms"])}throw e}}finally{e.free()}},this.GetTransforms=function(t,e){return this.FCache.TryGetValue(t.$class.ClassType(),e)||(this.TransformClass(t.$class.ClassType(),e)?this.FCache.Add(t.$class.ClassType(),e.get()):this.FCache.Add(t.$class.ClassType(),null)),!0},this.Create$1=function(){return this.FCache=pas["Generics.Collections"].TObjectDictionary$G9.$create("Create$5",[rtl.createSet(1)]),this.FRegistry=t.TSERTTKTransformRegistry.$create("Create$1"),this.DiscoverTransforms(),this},this.Destroy=function(){rtl.free(this,"FCache"),rtl.free(this,"FRegistry"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TSESRepository",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FPlatformProvider=null,this.FTransformClasses=null,this.FAppRef=null,this.FSession=null},this.$final=function(){this.FPlatformProvider=void 0,this.FTransformClasses=void 0,this.FAppRef=void 0,this.FSession=void 0,pas.System.TObject.$final.call(this)},this.ExecTransform=function(t,e){var i=!1,s=null,n=null,o=rtl.createIntfRefs();try{if(this.FTransformClasses.GetTransforms(t.FRefObject,{get:function(){return n},set:function(t){n=t}})&&null!=n&&n.FLength>0){var r=n.GetEnumerator$1();try{for(;r.MoveNext();){s=r.DoGetCurrent();try{s.Transform(t,e)}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;o.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug("Transform for "+s.TransClassName()+"Failed")}}}finally{r=rtl.freeLoc(r)}}i=!0}finally{o.free()}return i},this.ReloadModel=function(){var t=rtl.createIntfRefs();try{this.FAppRef.ClearRoots(),t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("ReloadModel, Dictionary ready ",this),this.FPlatformProvider.DiscoverForms(),t.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Form Discovery complete",this),this.FPlatformProvider.DiscoverDataModules(),t.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Repo::ReloadModel: Ready for transform ",this),this.TransformRepo()}finally{t.free()}},this.TransformRepo=function(){var t=null,e=rtl.createIntfRefs();try{try{this.TransformRepoItem(this.FAppRef,null);var i=this.FAppRef.FRoots.GetEnumerator$1();try{for(;i.MoveNext();)t=i.DoGetCurrent(),this.TransformRootItem(t)}finally{i=rtl.freeLoc(i)}}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Transform Repo Failed",this)}}finally{e.free()}},this.TransformRootItem=function(t){this.TransformRepoItem(t,t)},this.TransformRepoItem=function(e,i){var s=null,n=rtl.createIntfRefs();try{try{n.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Tranform Repo Item "+e.RefObjName(),this),this.ExecTransform(e,i)}catch(e){if(!t.ETransformIndividualFailed.isPrototypeOf(e)){if(pas.SysUtils.Exception.isPrototypeOf(e)){throw n.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Transform Failed : general Exception",this),pas.SysUtils.Exception.$create("Create$1",["Transform Failed for Item"])}throw e}n.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Individual trans failed, moving to children",this)}try{var o=e.FChildren.GetEnumerator$1();try{for(;o.MoveNext();)s=o.DoGetCurrent(),this.TransformRepoItem(s,i)}finally{o=rtl.freeLoc(o)}}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){throw pas.SysUtils.Exception.$create("Create$1",["Failed transform in  Recurse Children"])}throw t}}finally{n.free()}},this.DiscoverNewRoots=function(t){var e=0,i=null,s=0,n=null,o=rtl.createIntfRefs();try{i=pas["Generics.Collections"].TList$G14.$create("Create$1");try{o.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Discover new roots begin",this),i.AddRange$2(this.FAppRef.FRoots),o.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Before discover dm , Root Count = "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:this.FAppRef.FRoots,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this),this.FPlatformProvider.DiscoverDataModules(),o.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("After discover dm , Root Count = "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:this.FAppRef.FRoots,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this),o.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Before discover forms , Root Count = "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:this.FAppRef.FRoots,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this),this.FPlatformProvider.DiscoverForms(),o.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("After discover forms , Root Count = "+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:this.FAppRef.FRoots,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this);for(var r=0,a=this.FAppRef.FRoots.FLength-1;r<=a;r++)s=r,n=this.FAppRef.FRoots.GetItem(s),-1===i.IndexOf(n)?(o.ref(6,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Begin tranform new root"+n.RefObjName(),this),this.TransformRootItem(n),t.get().Add(n),o.ref(7,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("End tranform new root"+n.RefObjName(),this)):o.ref(8,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Root already existed, no tranform executed",this);e=t.get().FLength,o.ref(9,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Discover new roots End",this)}finally{i=rtl.freeLoc(i)}}finally{o.free()}return e},this.ReloadRepoRoot=function(t){var e=rtl.createIntfRefs();try{return this.FAppRef.RefreshRoot(t)?(this.TransformRootItem(t),!0):(e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Failed refresh repo root "+t.RefObjName(),this),!1)}finally{e.free()}return!1},this.ScreenList=function(e){var i=null,s=this.FAppRef.FRoots.GetEnumerator$1();try{for(;s.MoveNext();)i=s.DoGetCurrent(),t.TSESRepoForm.isPrototypeOf(i)&&e.get().Add(i.GetCompDisplayName())}finally{s=rtl.freeLoc(s)}return e.get().GetCount()},this.Create$1=function(){var e=rtl.createIntfRefs();try{try{this.FPlatformProvider=t.TSESProvider.$create("Create"),e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Provider Created successfully",this),this.FAppRef=t.TSESAppReference.$create("Create$2",[this.FPlatformProvider.AppComp()]),this.FPlatformProvider.FAppReference=this.FAppRef,this.FTransformClasses=t.TSERTTKTransformClasses.$create("Create$1"),e.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Transforms Created successfully",this),this.FSession=pas["WebLib.SEconstable.Session"].TSESSession.$create("Create$1",[this.FPlatformProvider.ApplicationName(),!1,!0]),this.FAppRef.FAppName=this.FPlatformProvider.ApplicationName(),e.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Application Name set to "+this.FSession.ApplicationNameGet(),this),this.ReloadModel(),e.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Model loaded successfully",this)}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){var i=t;throw e.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Repository failed: "+i.fMessage,this),pas.SysUtils.Exception.$create("Create$1",["Could not create repository"])}throw t}}finally{e.free()}return this},this.Destroy=function(){rtl.free(this,"FAppRef"),rtl.free(this,"FTransformClasses"),rtl.free(this,"FPlatformProvider"),pas.System.TObject.Destroy.call(this)}}))}),["contnrs","WebLib.SEConstable.Registry","WebLib.SEFNC.Logger","WEBLib.Controls","WEBLib.Graphics"]),rtl.module("WEBLib.TMSFNCCheckedListBox",["System","Classes","WEBLib.TMSFNCListBox","WEBLib.TMSFNCTreeView","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCTypes"],(function(){"use strict";var t=this;this.MAJ_VER=1,this.MIN_VER=0,this.REL_VER=0,this.BLD_VER=2,rtl.createClass(this,"TTMSFNCCheckedListBoxItem",pas["WEBLib.TMSFNCListBox"].TTMSFNCListBoxItem,(function(){this.$rtti.addProperty("Checked",2,rtl.boolean,"FChecked","SetChecked",{Default:!1})})),rtl.createClass(this,"TTMSFNCCheckedListBoxItems",pas["WEBLib.TMSFNCListBox"].TTMSFNCListBoxItems,(function(){this.GetItemClass=function(){return t.TTMSFNCCheckedListBoxItem}})),this.$rtti.$MethodVar("TTMSFNCCheckedListBoxItemCheckChanged",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCCheckedListBoxItem]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomCheckedListBox",pas["WEBLib.TMSFNCListBox"].TTMSFNCListBox,(function(){this.$init=function(){pas["WEBLib.TMSFNCListBox"].TTMSFNCListBox.$init.call(this),this.FOnItemCheckChanged=null},this.$final=function(){this.FOnItemCheckChanged=void 0,pas["WEBLib.TMSFNCListBox"].TTMSFNCListBox.$final.call(this)},this.Loaded=function(){pas["WEBLib.TMSFNCListBox"].TTMSFNCCustomListBox.Loaded.call(this),window.setTimeout(rtl.createSafeCallback(this,"UpdateItems"),100)},this.CreateItems=function(){return t.TTMSFNCCheckedListBoxItems.$create("Create$3",[this])},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,0,2)},this.DoItemCheckChanged=function(t,e){null!=this.FOnItemCheckChanged&&this.FOnItemCheckChanged(this,e)},this.CustomizeTreeView=function(t){pas["WEBLib.TMSFNCListBox"].TTMSFNCCustomListBox.CustomizeTreeView.apply(this,arguments),t.FOnIsNodeChecked=rtl.createCallback(this,"DoIsNodeChecked"),t.FOnGetNodeCheckType=rtl.createCallback(this,"DoGetNodeCheckType"),t.FOnAfterUnCheckNode=rtl.createCallback(this,"DoAfterUnCheckNode"),t.FOnAfterCheckNode=rtl.createCallback(this,"DoAfterCheckNode")},this.DoIsNodeChecked=function(e,i,s,n){i.FRow>=0&&i.FRow<=this.FItems.GetCount()-1&&n.set(rtl.as(this.FItems.GetItem$1(i.FRow),t.TTMSFNCCheckedListBoxItem).FChecked)},this.DoGetNodeCheckType=function(t,e,i,s){s.set(1)},this.DoAfterCheckNode=function(e,i,s){var n=null;i.FRow>=0&&i.FRow<=this.FItems.GetCount()-1&&((n=rtl.as(this.FItems.GetItem$1(i.FRow),t.TTMSFNCCheckedListBoxItem)).SetChecked(!0),this.DoItemCheckChanged(this,n))},this.DoAfterUnCheckNode=function(e,i,s){var n=null;i.FRow>=0&&i.FRow<=this.FItems.GetCount()-1&&((n=rtl.as(this.FItems.GetItem$1(i.FRow),t.TTMSFNCCheckedListBoxItem)).SetChecked(!1),this.DoItemCheckChanged(this,n))},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCCheckedListBox",this.TTMSFNCCustomCheckedListBox,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("OnItemCheckChanged",0,t.$rtti.TTMSFNCCheckedListBoxItemCheckChanged,"FOnItemCheckChanged","FOnItemCheckChanged"),e.addProperty("OnAfterDrawItemCheck",0,pas["WEBLib.TMSFNCListBox"].$rtti.TTMSFNCListBoxAfterDrawItemCheckEvent,"FOnAfterDrawItemCheck","FOnAfterDrawItemCheck"),e.addProperty("OnBeforeDrawItemCheck",0,pas["WEBLib.TMSFNCListBox"].$rtti.TTMSFNCListBoxBeforeDrawItemCheckEvent,"FOnBeforeDrawItemCheck","FOnBeforeDrawItemCheck"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))}),["WEBLib.TMSFNCUtils","Web"]),rtl.module("WebLib.SEConstable.CVTypes",["System","Classes","Generics.Collections","SysUtils","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCPageControl","WEBLib.TMSFNCToolBar","WEBLib.TMSFNCStatusBar","WEBLib.TMSFNCListBox","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCCheckedListBox","WebLib.SEConstable.Repository","WebLib.SEconstable.Session","WebLib.SEFNC.Layout","WEBLib.Controls","WEBLib.StdCtrls"],(function(){"use strict";var t=this;this.TSESPMOption={0:"pmoShowPath",pmoShowPath:0,1:"pmoGoToActive",pmoGoToActive:1,2:"pmoRefreshRoot",pmoRefreshRoot:2},this.PMOptionDisplay=["ShowPath","Go To Active","Refresh"],rtl.createClass(this,"ESECvBaseException",pas.SysUtils.Exception,(function(){})),rtl.createClass(this,"ECVToolInstanceCreateException",this.ESECvBaseException,(function(){})),rtl.createClass(this,"ECVToolPageLayoutCreateException",this.ESECvBaseException,(function(){})),rtl.createClass(this,"TSECVToolArea",pas["WebLib.SEFNC.Layout"].TSEFNCLayout,(function(){this.$init=function(){pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$init.call(this),this.FToolBar=null,this.FHelpButton=null,this.FOwner$1=null,this.FButtons=null},this.$final=function(){this.FToolBar=void 0,this.FHelpButton=void 0,this.FOwner$1=void 0,this.FButtons=void 0,pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$final.call(this)},this.HelpLinkClick=function(t){pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBarButton.isPrototypeOf(t)&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(t.FDataString)},this.AddButton=function(t){var e=null;return(e=this.FToolBar.AddButton(80,-1,"resString","resStringLarge",t,-1)).SetBitmapVisible(!1),e.SetTextVisible(!0),this.FButtons.Add(t,e),e},this.HelpLinkSet=function(t){this.FHelpButton=pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBarButton.$create("Create$1",[this.FOwner$1]),this.FHelpButton.SetParent(this),this.FHelpButton.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(4)),this.FHelpButton.FOnClick=rtl.createCallback(this,"HelpLinkClick"),this.FHelpButton.FDataString=t,this.FHelpButton.SetText("Help")},this.Create$4=function(t){return this.FOwner$1=t.FOwner,pas["WEBLib.Controls"].TControl.Create$1.call(this,this.FOwner$1),this.SetHeight(Math.round(32*pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(this,-1))),this.SetParent(t),this.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(1)),this.FButtons=pas["Generics.Collections"].TDictionary$G14.$create("Create$1",[0]),this.FToolBar=pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBar.$create("Create$1",[this]),this.FToolBar.SetParent(this),this.FToolBar.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FToolBar.FOptionsMenu.SetShowButton(!1),this},this.Destroy=function(){rtl.free(this,"FButtons"),pas["WEBLib.ExtCtrls"].TCustomPanel.Destroy.call(this)},this.ButtonByName=function(t){var e=null;return this.FButtons.TryGetValue(t,{get:function(){return e},set:function(t){e=t}}),e},this.NewButton=function(t){this.AddButton(t)},this.NewButton$1=function(t,e){this.AddButton(t).FOnClick=e},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TSECVRepositoryBase",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FSession=null,this.FSupportRepository=null},this.$final=function(){this.FSession=void 0,this.FSupportRepository=void 0,pas.System.TObject.$final.call(this)},this.RepositoryGet=function(){return this.FSupportRepository},this.RepositorySet=function(t){this.FSupportRepository=t,this.SessionSet(this.FSupportRepository.FSession)},this.SessionSet=function(t){this.FSession=t}})),rtl.createClass(this,"TSECVOwnedDisplay",this.TSECVRepositoryBase,(function(){this.$init=function(){t.TSECVRepositoryBase.$init.call(this),this.FOwner=null},this.$final=function(){this.FOwner=void 0,t.TSECVRepositoryBase.$final.call(this)},this.Create$1=function(t){return this.FOwner=t,this}})),rtl.createClass(this,"TSECVDisplayBase",this.TSECVOwnedDisplay,(function(){this.$init=function(){t.TSECVOwnedDisplay.$init.call(this),this.FLayout=null},this.$final=function(){this.FLayout=void 0,t.TSECVOwnedDisplay.$final.call(this)},this.Create$2=function(e,i){return t.TSECVOwnedDisplay.Create$1.call(this,i),this.FLayout=e,this}})),rtl.createClass(this,"TSECVToolPage",this.TSECVOwnedDisplay,(function(){})),rtl.createClass(this,"TSECVBookmarkPanel",pas["WebLib.SEFNC.Layout"].TSEFNCLayout,(function(){this.$init=function(){pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$init.call(this),this.FMemo=null,this.FScreenList=null,this.FDetailArea=null,this.FSupportRepository=null},this.$final=function(){this.FMemo=void 0,this.FScreenList=void 0,this.FDetailArea=void 0,this.FSupportRepository=void 0,pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$final.call(this)},this.BuildPanel=function(){this.FMemo=pas["WEBLib.StdCtrls"].TMemo.$create("Create$1",[this.FOwner]),this.FMemo.SetParent(this),this.FMemo.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(1)),this.FMemo.FMargins.SetLeft(2),this.FMemo.FMargins.SetBottom(2),this.FDetailArea=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner]),this.FDetailArea.SetParent(this),this.FDetailArea.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FScreenList=pas["WEBLib.TMSFNCCheckedListBox"].TTMSFNCCheckedListBox.$create("Create$1",[this.FOwner]),this.FScreenList.SetParent(this.FDetailArea),this.FScreenList.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(3)),this.FScreenList.FHeader.SetText("Screens to Capture"),this.FScreenList.FHeader.SetVisible(!0)},this.ResetPanel=function(){this.FScreenList.FItems.Clear$1(),this.FMemo.FLines.Clear()},this.LoadScreens=function(){var t=null,e="",i=null,s=rtl.createIntfRefs();try{t=pas.Classes.TStringList.$create("Create$1");try{if(this.FSupportRepository.ScreenList({get:function(){return t},set:function(e){t=e}})>0){this.FScreenList.BeginUpdate(),this.FScreenList.FItems.Clear$1();var n=t.GetEnumerator();try{for(;n.MoveNext();)e=n.GetCurrent(),(i=this.FScreenList.FItems.Add$1()).SetText(e),i.FDataString=e}finally{n=rtl.freeLoc(n)}}else s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("No Screens found in repo",this)}finally{this.FScreenList.EndUpdate(),t=rtl.freeLoc(t)}}finally{s.free()}},this.Create$1=function(t){return pas["WEBLib.Controls"].TControl.Create$1.call(this,t),this.BuildPanel(),this},this.Destroy=function(){pas["WEBLib.ExtCtrls"].TCustomPanel.Destroy.call(this)},this.SaveBookmark=function(){var t;t=pas["WebLib.SEconstable.Session"].TSESSessionBookmark.$create("Create$3",[this.FMemo.FLines.GetTextStr()]),this.FSupportRepository.FSession.AddBookmark(t)},this.ResetBookmark=function(){this.ResetPanel(),this.LoadScreens()},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TSECVLogToolBase",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FPageContainer=null,this.FOwner=null},this.$final=function(){this.FPageContainer=void 0,this.FOwner=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t,e){return this.FPageContainer=t,this.FOwner=e,this.Initialize(),this}}))}),["WEBLib.TMSFNCUtils","WEBLib.Graphics","WebLib.SEFNC.Logger"]),rtl.module("WEBLib.TMSFNCSwitch",["System","Classes","Types","WEBLib.ExtCtrls","WEBLib.Controls","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCTypes"],(function(){"use strict";var t=this,e=t.$impl;this.TTMSFNCCustomSwitchOrientation={0:"soHorizontal",soHorizontal:0,1:"soVertical",soVertical:1},this.$rtti.$Enum("TTMSFNCCustomSwitchOrientation",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCCustomSwitchOrientation}),this.TTMSFNCCustomSwitchState={0:"ssOff",ssOff:0,1:"ssOn",ssOn:1},this.$rtti.$Enum("TTMSFNCCustomSwitchState",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCCustomSwitchState}),this.TTMSFNCCustomSwitchLayout={0:"sloSimple",sloSimple:0,1:"sloExtended",sloExtended:1},this.$rtti.$Enum("TTMSFNCCustomSwitchLayout",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCCustomSwitchLayout}),rtl.createClass(this,"TTMSFNCCustomSwitchAppearanceOff",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOnChange=null,this.FFill=null,this.FStroke=null,this.FText="",this.FFont=null},this.$final=function(){this.FOnChange=void 0,this.FFill=void 0,this.FStroke=void 0,this.FFont=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.Changed())},this.IsTextStored=function(){return"Off"!==this.FText},this.SetFont=function(t){this.FFont.AssignSource(t)},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.FillChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.FontChanged=function(t){this.Changed()},this.Create$1=function(){return this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FText="Off",this},this.Destroy=function(){rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FFont"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCustomSwitchAppearanceOff.isPrototypeOf(e)?(this.FFill.Assign(rtl.as(e,t.TTMSFNCCustomSwitchAppearanceOff).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCCustomSwitchAppearanceOff).FStroke),this.FFont.AssignSource(rtl.as(e,t.TTMSFNCCustomSwitchAppearanceOff).FFont),this.FText=rtl.as(e,t.TTMSFNCCustomSwitchAppearanceOff).FText):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("Text",14,rtl.string,"FText","SetText",{stored:"IsTextStored"}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange")})),rtl.createClass(this,"TTMSFNCCustomSwitchAppearanceOn",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOnChange=null,this.FFill=null,this.FStroke=null,this.FText="",this.FFont=null},this.$final=function(){this.FOnChange=void 0,this.FFill=void 0,this.FStroke=void 0,this.FFont=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.Changed())},this.IsTextStored=function(){return"On"!==this.FText},this.SetFont=function(t){this.FFont.AssignSource(t)},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.FillChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.FontChanged=function(t){this.Changed()},this.Create$1=function(){return this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16748574,8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FText="On",this},this.Destroy=function(){rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FFont"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCustomSwitchAppearanceOn.isPrototypeOf(e)?(this.FFill.Assign(rtl.as(e,t.TTMSFNCCustomSwitchAppearanceOn).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCCustomSwitchAppearanceOn).FStroke),this.FFont.AssignSource(rtl.as(e,t.TTMSFNCCustomSwitchAppearanceOn).FFont),this.FText=rtl.as(e,t.TTMSFNCCustomSwitchAppearanceOn).FText):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("Text",14,rtl.string,"FText","SetText",{stored:"IsTextStored"}),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange")})),rtl.createClass(this,"TTMSFNCCustomSwitchButtonAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOnChange=null,this.FFill=null,this.FStroke=null,this.FMargin=0,this.FOffFill=null,this.FOffStroke=null},this.$final=function(){this.FOnChange=void 0,this.FFill=void 0,this.FStroke=void 0,this.FOffFill=void 0,this.FOffStroke=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.SetMargin=function(t){this.FMargin!==t&&(this.FMargin=t,this.Changed())},this.IsMarginStored=function(){return 3!==this.FMargin},this.SetOffFill=function(t){this.FOffFill.Assign(t)},this.SetOffStroke=function(t){this.FOffStroke.Assign(t)},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this)},this.FillChanged=function(t){this.Changed()},this.StrokeChanged=function(t){this.Changed()},this.Create$1=function(){return this.FMargin=3,this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FOffFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FOffFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FOffStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,12632256]),this.FOffStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this},this.Destroy=function(){rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FOffFill"),rtl.free(this,"FOffStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCCustomSwitchButtonAppearance.isPrototypeOf(e)?(this.FFill.Assign(rtl.as(e,t.TTMSFNCCustomSwitchButtonAppearance).FFill),this.FOffFill.Assign(rtl.as(e,t.TTMSFNCCustomSwitchButtonAppearance).FOffFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCCustomSwitchButtonAppearance).FStroke),this.FOffStroke.Assign(rtl.as(e,t.TTMSFNCCustomSwitchButtonAppearance).FOffStroke),this.FMargin=rtl.as(e,t.TTMSFNCCustomSwitchButtonAppearance).FMargin):pas.Classes.TPersistent.Assign.apply(this,arguments)};var e=this.$rtti;e.addProperty("Margin",14,rtl.double,"FMargin","SetMargin",{stored:"IsMarginStored"}),e.addProperty("OffFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FOffFill","SetOffFill"),e.addProperty("OffStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FOffStroke","SetOffStroke"),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange")})),this.$rtti.$MethodVar("TTMSFNCCustomSwitchBeforeDrawSwitchEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ASwitchState",this.$rtti.TTMSFNCCustomSwitchState],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomSwitchAfterDrawSwitchEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ASwitchState",this.$rtti.TTMSFNCCustomSwitchState]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomSwitchBeforeDrawSwitchButtonEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ASwitchState",this.$rtti.TTMSFNCCustomSwitchState],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomSwitchAfterDrawSwitchButtonEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["ASwitchState",this.$rtti.TTMSFNCCustomSwitchState]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCCustomSwitchStateChangeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ASwitchState",this.$rtti.TTMSFNCCustomSwitchState]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomSwitch",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FButtonPos=0,this.FPosTo=0,this.FMouseDown=!1,this.FMouseDownButton=!1,this.FOrientation=0,this.FAppearanceOff=null,this.FAppearanceOn=null,this.FButtonAppearance=null,this.FRounded=!1,this.FLayout=0,this.FSwitchState=0,this.FSwitchTimer=null,this.FAnimationFactor=0,this.FDoAnimation=!1,this.FOnAfterDrawSwitch=null,this.FOnAfterDrawSwitchButton=null,this.FOnBeforeDrawSwitch=null,this.FOnBeforeDrawSwitchButton=null,this.FOnStateChange=null,this.FOnChange=null,this.FGlobalFont=null},this.$final=function(){this.FAppearanceOff=void 0,this.FAppearanceOn=void 0,this.FButtonAppearance=void 0,this.FSwitchTimer=void 0,this.FOnAfterDrawSwitch=void 0,this.FOnAfterDrawSwitchButton=void 0,this.FOnBeforeDrawSwitch=void 0,this.FOnBeforeDrawSwitchButton=void 0,this.FOnStateChange=void 0,this.FOnChange=void 0,this.FGlobalFont=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetOrientation=function(t){this.FOrientation!==t&&(this.FOrientation=t,rtl.eqSet(rtl.intersectSet(this.FComponentState,rtl.createSet(0,6)),{})&&this.SetBounds(this.GetLeft(),this.GetTop(),this.GetHeight(),this.GetWidth()),this.Changed())},this.SetAppearanceOff=function(t){this.FAppearanceOff.Assign(t)},this.SetAppearanceOn=function(t){this.FAppearanceOn.Assign(t)},this.SetButtonAppearance=function(t){this.FButtonAppearance.Assign(t)},this.SetRounded=function(t){this.FRounded!==t&&(this.FRounded=t,this.Changed())},this.SetLayout=function(t){this.FLayout!==t&&(this.FLayout=t,this.Changed())},this.SetSwitchState=function(t){if(this.FSwitchState!==t){this.FSwitchState=t;var e=t;1===e?(this.FPosTo=this.GetButtonOnPos(),this.FButtonPos=this.GetButtonOnPos()):0===e&&(this.FPosTo=this.GetButtonOffPos(),this.FButtonPos=this.GetButtonOffPos()),this.DoStateChange(t),this.Changed()}},this.SetAnimationFactor=function(t){this.FAnimationFactor!==t&&(this.FAnimationFactor=t,this.Changed())},this.SetGlobalFont=function(t){this.FGlobalFont.Assign(t)},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleBackgroundFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearanceOff.FFill.SetKind(1),this.FAppearanceOff.FFill.SetColor(t),this.FButtonAppearance.FFill.SetKind(1),this.FButtonAppearance.FFill.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleSelectionFillColorTo({get:function(){return t},set:function(e){t=e}})&&(this.FAppearanceOn.FFill.SetKind(1),this.FAppearanceOn.FFill.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearanceOn.FFont.SetColor(t),this.FAppearanceOff.FFont.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleLineFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FAppearanceOff.FStroke.SetKind(1),this.FAppearanceOff.FStroke.SetColor(t),this.FAppearanceOn.FStroke.SetKind(1),this.FAppearanceOn.FStroke.SetColor(t),this.FButtonAppearance.FStroke.SetKind(1),this.FButtonAppearance.FStroke.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleDefaultButtonFillColor({get:function(){return t},set:function(e){t=e}})&&(this.FButtonAppearance.FOffFill.SetKind(1),this.FButtonAppearance.FOffFill.SetColor(t)),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleDefaultButtonStrokeColor({get:function(){return t},set:function(e){t=e}})&&(this.FButtonAppearance.FOffStroke.SetKind(1),this.FButtonAppearance.FOffStroke.SetColor(t))},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FAppearanceOff.FFill.SetColor(16777215),this.FAppearanceOn.FFill.SetColor(16748574),this.FAppearanceOn.FFont.SetColor(0),this.FAppearanceOff.FFont.SetColor(0),this.FAppearanceOff.FStroke.SetColor(12632256),this.FAppearanceOn.FStroke.SetColor(12632256),this.FButtonAppearance.FFill.SetColor(16777215),this.FButtonAppearance.FStroke.SetColor(12632256)},this.Draw=function(t,e){this.DrawSwitchBackground(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),this.DrawSwitchButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},this.DrawSwitchBackground=function(t,e){var i=0,s=0,n=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=!1,a=!1,l=0;n=0;var h=this.FOrientation;if(0===h?n=e.Right-e.Left:1===h&&(n=e.Bottom-e.Top),s=0,1===this.FOrientation&&(s=-90),this.FRounded){i=0;var F=this.FOrientation;0===F?i=(e.Bottom-e.Top)/2:1===F&&(i=(e.Right-e.Left)/2)}else i=1;this.FButtonPos<n/2?(t.FFill.Assign(this.FAppearanceOff.FFill),t.FStroke.Assign(this.FAppearanceOff.FStroke)):(t.FFill.Assign(this.FAppearanceOn.FFill),t.FStroke.Assign(this.FAppearanceOn.FStroke)),r=!0,a=!0,this.DoBeforeDrawSwitch(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FSwitchState,{get:function(){return r},set:function(t){r=t}},{get:function(){return a},set:function(t){a=t}}),r&&(a&&(t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i-1,rtl.createSet(0,1,2,3),2),1===this.FLayout&&(l=this.GetButtonOnPos(),this.FButtonPos!==l&&(o.$assign(this.GetOffTextRect()),t.FFont.AssignSource(this.FAppearanceOff.FFont),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),this.FAppearanceOff.FText,!1,0,0,0,s,-1,-1,!0,!1,-1,-1)),l=this.GetButtonOffPos(),this.FButtonPos!==l&&(o.$assign(this.GetOnTextRect()),t.FFont.AssignSource(this.FAppearanceOn.FFont),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),this.FAppearanceOn.FText,!1,0,0,0,s,-1,-1,!0,!1,-1,-1)))),this.DoAfterDrawSwitch(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FSwitchState))},this.DrawSwitchButton=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0,n=0,o=!1,r=!1;n=0;var a=this.FOrientation;if(0===a?n=e.Right-e.Left:1===a&&(n=e.Bottom-e.Top),this.FButtonPos<n/2?(t.FFill.Assign(this.FButtonAppearance.FOffFill),t.FStroke.Assign(this.FButtonAppearance.FOffStroke)):(t.FFill.Assign(this.FButtonAppearance.FFill),t.FStroke.Assign(this.FButtonAppearance.FStroke)),i.$assign(this.GetSwitchButtonRect()),s=this.FButtonAppearance.FMargin+1,this.FRounded){var l=this.FOrientation;0===l?s=(e.Bottom-e.Top)/2:1===l&&(s=(e.Right-e.Left)/2)}o=!0,r=!0,this.DoBeforeDrawSwtichButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FSwitchState,{get:function(){return o},set:function(t){o=t}},{get:function(){return r},set:function(t){r=t}}),o&&(r&&t.DrawRoundRectangle$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),s-this.FButtonAppearance.FMargin-1,rtl.createSet(0,1,2,3),0),this.DoAfterDrawSwitchButton(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.FSwitchState))},this.HandleMouseDown=function(t,e,i,s){var n=pas["WEBLib.TMSFNCTypes"].TRectF.$new();pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseDown.apply(this,arguments),n.$assign(this.GetSwitchButtonRect()),pas["WEBLib.TMSFNCTypes"].PtInRectEx(n,pas["WEBLib.TMSFNCTypes"].PointF(i,s))?(this.FMouseDown=!0,this.CaptureEx()):this.FMouseDownButton=!0},this.HandleMouseUp=function(t,e,i,s){if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),this.FMouseDown){var n=this.FOrientation;0===n?i>this.GetWidth()/2?(this.FPosTo=this.GetButtonOnPos(),this.FSwitchState=1,this.DoStateChange(1)):(this.FPosTo=this.GetButtonOffPos(),this.FSwitchState=0,this.DoStateChange(0)):1===n&&(s<this.GetHeight()/2?(this.FPosTo=this.GetButtonOnPos(),this.FSwitchState=1,this.DoStateChange(1)):(this.FPosTo=this.GetButtonOffPos(),this.FSwitchState=0,this.DoStateChange(0))),this.FDoAnimation=!0,this.FMouseDown=!1,this.ReleaseCaptureEx(),this.Changed()}else if(this.FMouseDownButton){var o=this.FSwitchState;0===o?(this.FSwitchState=1,this.FPosTo=this.GetButtonOnPos(),this.DoStateChange(1)):1===o&&(this.FSwitchState=0,this.FPosTo=this.GetButtonOffPos(),this.DoStateChange(0)),this.FDoAnimation=!0,this.FMouseDownButton=!1,this.Changed()}},this.HandleMouseMove=function(t,e,i){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),this.FMouseDown&&1===this.FLayout&&(this.FButtonPos=this.CalculateButtonPosition(e,i),this.Invalidate())},this.DoBeforeDrawSwitch=function(t,e,i,s,n){null!=this.FOnBeforeDrawSwitch&&this.FOnBeforeDrawSwitch(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoAfterDrawSwitch=function(t,e,i){null!=this.FOnAfterDrawSwitch&&this.FOnAfterDrawSwitch(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoBeforeDrawSwtichButton=function(t,e,i,s,n){null!=this.FOnBeforeDrawSwitchButton&&this.FOnBeforeDrawSwitchButton(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoAfterDrawSwitchButton=function(t,e,i){null!=this.FOnAfterDrawSwitchButton&&this.FOnAfterDrawSwitchButton(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoStateChange=function(t){null!=this.FOnStateChange&&this.FOnStateChange(this,t)},this.DoSwitchTimer=function(t){var i=0,s=0;this.FMouseDown||this.FDoAnimation&&(s=Math.abs(this.FButtonPos-this.FPosTo)/this.FAnimationFactor,i=this.FButtonPos,e.AnimateDouble({get:function(){return i},set:function(t){i=t}},{p:this,get:function(){return this.p.FPosTo},set:function(t){this.p.FPosTo=t}},s,.01)?(this.FButtonPos=i,this.Invalidate()):this.FDoAnimation=!1)},this.UpdateControlAfterResize=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.UpdateControlAfterResize.call(this),this.FButtonPos=this.GetButtonPos(),this.FPosTo=this.GetButtonOffPos()},this.AppearanceChanged=function(t){this.Changed()},this.Changed=function(){null!=this.FOnChange&&this.FOnChange(this),this.Invalidate()},this.GetSwitchButtonRect=function(){var t,e,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;s=0;var n=this.FOrientation;0===n?s=this.GetControlRect().Bottom-this.GetContentRect().Top:1===n&&(s=this.GetContentRect().Right-this.GetContentRect().Left),t=s/2,e=this.FButtonAppearance.FMargin+this.FButtonAppearance.FStroke.FWidth/2;var o=this.FOrientation;return 0===o?i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FButtonPos-t,this.GetContentRect().Top,this.FButtonPos+t,this.GetControlRect().Bottom)):1===o&&i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.GetContentRect().Left,this.FButtonPos-t,this.GetContentRect().Right,this.FButtonPos+t)),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-e,-e),i},this.CalculateButtonPosition=function(t,e){var i,s=0,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();s=-1,o.$assign(this.GetSwitchButtonRect()),i=this.FButtonAppearance.FMargin+this.FButtonAppearance.FStroke.FWidth/2+(o.Right-o.Left)/2,n.$assign(this.GetControlRect());var r=this.FOrientation;return 0===r?s=n.Left+i>=t?n.Left+i:n.Right-i<=t?n.Right-i:t:1===r&&(s=n.Top+i>=e?n.Top+i:n.Bottom-i<=e?n.Bottom-i:e),s},this.GetButtonPos=function(){var t=0;t=0;var e=this.FSwitchState;return 0===e?t=this.GetButtonOffPos():1===e&&(t=this.GetButtonOnPos()),t},this.GetButtonOffPos=function(){var t,e=0,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e=0,i.$assign(this.GetSwitchButtonRect()),t=this.FButtonAppearance.FMargin+this.FButtonAppearance.FStroke.FWidth/2+(i.Right-i.Left)/2;var s=this.FOrientation;return 0===s?e=this.GetControlRect().Left+t:1===s&&(e=this.GetControlRect().Bottom-t),e},this.GetButtonOnPos=function(){var t,e=0,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();e=0,i.$assign(this.GetSwitchButtonRect()),t=this.FButtonAppearance.FMargin+this.FButtonAppearance.FStroke.FWidth/2+(i.Right-i.Left)/2;var s=this.FOrientation;return 0===s?e=this.GetControlRect().Right-t:1===s&&(e=this.GetControlRect().Top+t),e},this.GetOffTextRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=0;t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),e.$assign(this.GetSwitchButtonRect());var s=this.FOrientation;return 0===s?(i=e.Right-e.Left,t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Right,this.GetControlRect().Top,e.Right+(this.GetControlRect().Right-i),this.GetControlRect().Bottom))):1===s&&(i=this.GetControlRect().Bottom-this.GetControlRect().Top-(e.Bottom-e.Top),t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.GetControlRect().Left,e.Top-i,this.GetControlRect().Right,e.Top))),t},this.GetOnTextRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),i=0;t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,0,0)),e.$assign(this.GetSwitchButtonRect());var s=this.FOrientation;return 0===s?(i=this.GetControlRect().Right-this.GetControlRect().Left-(e.Right-e.Left),t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(e.Left-i,this.GetControlRect().Top,e.Left,this.GetControlRect().Bottom))):1===s&&(i=this.GetControlRect().Bottom-this.GetControlRect().Top-(e.Bottom-e.Top),t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.GetControlRect().Left,e.Bottom,this.GetControlRect().Right,e.Bottom+i))),t},this.SetFonts=function(t){this.BeginUpdate(),this.FGlobalFont.ApplyChange(this.FAppearanceOff.FFont,t),this.FGlobalFont.ApplyChange(this.FAppearanceOn.FFont,t),this.EndUpdate()},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FMouseDown=!1,this.FSwitchState=0,this.FAnimationFactor=8,this.FMouseDownButton=!1,this.FAppearanceOff=t.TTMSFNCCustomSwitchAppearanceOff.$create("Create$1"),this.FAppearanceOff.FOnChange=rtl.createCallback(this,"AppearanceChanged"),this.FAppearanceOn=t.TTMSFNCCustomSwitchAppearanceOn.$create("Create$1"),this.FAppearanceOn.FOnChange=rtl.createCallback(this,"AppearanceChanged"),this.FButtonAppearance=t.TTMSFNCCustomSwitchButtonAppearance.$create("Create$1"),this.FButtonAppearance.FOnChange=rtl.createCallback(this,"AppearanceChanged"),this.FButtonPos=this.GetButtonOffPos(),this.FPosTo=this.GetButtonOffPos(),this.SetWidth(75),this.SetHeight(25),this.FFill.SetColor(-1),this.FStroke.SetColor(-1),this.FDoAnimation=!1,this.FGlobalFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCAppearanceGlobalFont.$create("Create$1",[this]),this.FSwitchTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FSwitchTimer.SetInterval(10),this.FSwitchTimer.FOnTimer=rtl.createCallback(this,"DoSwitchTimer"),this.FSwitchTimer.SetEnabled(!0),this},this.Destroy=function(){rtl.free(this,"FGlobalFont"),rtl.free(this,"FAppearanceOff"),rtl.free(this,"FAppearanceOn"),rtl.free(this,"FButtonAppearance"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCSwitch",this.TTMSFNCCustomSwitch,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("AppearanceOff",2,t.$rtti.TTMSFNCCustomSwitchAppearanceOff,"FAppearanceOff","SetAppearanceOff"),e.addProperty("AppearanceOn",2,t.$rtti.TTMSFNCCustomSwitchAppearanceOn,"FAppearanceOn","SetAppearanceOn"),e.addProperty("ButtonAppearance",2,t.$rtti.TTMSFNCCustomSwitchButtonAppearance,"FButtonAppearance","SetButtonAppearance"),e.addProperty("AnimationFactor",2,rtl.longint,"FAnimationFactor","SetAnimationFactor",{Default:15}),e.addProperty("State",2,t.$rtti.TTMSFNCCustomSwitchState,"FSwitchState","SetSwitchState",{Default:t.TTMSFNCCustomSwitchState.ssOff}),e.addProperty("Layout",2,t.$rtti.TTMSFNCCustomSwitchLayout,"FLayout","SetLayout",{Default:t.TTMSFNCCustomSwitchLayout.sloSimple}),e.addProperty("Orientation",2,t.$rtti.TTMSFNCCustomSwitchOrientation,"FOrientation","SetOrientation",{Default:t.TTMSFNCCustomSwitchOrientation.soHorizontal}),e.addProperty("Rounded",2,rtl.boolean,"FRounded","SetRounded",{Default:!1}),e.addProperty("GlobalFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCAppearanceGlobalFont,"FGlobalFont","SetGlobalFont"),e.addProperty("OnBeforeDrawSwitch",0,t.$rtti.TTMSFNCCustomSwitchBeforeDrawSwitchEvent,"FOnBeforeDrawSwitch","FOnBeforeDrawSwitch"),e.addProperty("OnAfterDrawSwitch",0,t.$rtti.TTMSFNCCustomSwitchAfterDrawSwitchEvent,"FOnAfterDrawSwitch","FOnAfterDrawSwitch"),e.addProperty("OnBeforeDrawSwitchButton",0,t.$rtti.TTMSFNCCustomSwitchBeforeDrawSwitchButtonEvent,"FOnBeforeDrawSwitchButton","FOnBeforeDrawSwitchButton"),e.addProperty("OnAfterDrawSwitchButton",0,t.$rtti.TTMSFNCCustomSwitchAfterDrawSwitchButtonEvent,"FOnAfterDrawSwitchButton","FOnAfterDrawSwitchButton"),e.addProperty("OnStateChange",0,t.$rtti.TTMSFNCCustomSwitchStateChangeEvent,"FOnStateChange","FOnStateChange"),e.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),t.$implcode=function(){e.AnimateDouble=function(t,e,i,s){var n=!1;return n=!0,t.get()>e.get()-s&&t.get()<e.get()+s?(t.set(e.get()),n=!1):(i=Math.max(s,i),t.get()<e.get()?t.set(t.get()+i):t.set(t.get()-i)),n}}}),["Math","WEBLib.TMSFNCStyles","WEBLib.TMSFNCUtils"]),rtl.module("WebLib.SEFNC.CVLoggerViewer",["System","Classes","SysUtils","WEBLib.TMSFNCTreeView","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCSwitch","WEBLib.TMSFNCToolBar","WEBLib.TMSFNCPageControl","WEBLib.ExtCtrls","WEBLib.Controls","WebLib.SEFNC.Layout"],(function(){"use strict";rtl.createClass(this,"TSEFNCLoggerViewer",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FHistoryCounter=0,this.FTreeView=null,this.FPanel=null,this.FSwitchEnable=null,this.FToolBar=null,this.FPage=null,this.FTimer=null},this.$final=function(){this.FTreeView=void 0,this.FPanel=void 0,this.FSwitchEnable=void 0,this.FToolBar=void 0,this.FPage=void 0,this.FTimer=void 0,pas.System.TObject.$final.call(this)},this.InitTree=function(){var t=null;this.FTreeView.ClearColumns(),this.FTreeView.ClearNodes(),(t=this.FTreeView.FColumns.Add$1()).SetText("DTS"),(t=this.FTreeView.FColumns.Add$1()).SetText("Level"),t.FFiltering.SetEnabled(!0),t.FFiltering.FMultiColumn=!0,t.FFiltering.SetButtonSize(Math.round(20*pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(this.FTreeView,-1))),(t=this.FTreeView.FColumns.Add$1()).SetText("Message"),(t=this.FTreeView.FColumns.Add$1()).SetText("Class"),t.SetWidth(150),t.FFiltering.SetEnabled(!0),t.FFiltering.FMultiColumn=!0,t.FFiltering.FDropDownWidth=200,t.FFiltering.SetButtonSize(Math.round(20*pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(this.FTreeView,-1))),(t=this.FTreeView.FColumns.Add$1()).SetText("Unit"),t.FFiltering.SetEnabled(!0),t.FFiltering.FMultiColumn=!0,t.FFiltering.FDropDownWidth=200,t.FFiltering.SetButtonSize(Math.round(20*pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(this.FTreeView,-1))),this.FTreeView.FInteraction.SetColumnSizing(!0),this.FTreeView.FInteraction.SetColumnAutoSizeOnDblClick(!0),this.FTreeView.FColumnsAppearance.SetStretch(!0),this.FTreeView.FColumnsAppearance.SetStretchColumn(2),this.FTreeView.FColumnsAppearance.FTopStroke.SetKind(1)},this.InitViewer=function(){var t=null;this.FPanel=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FPage.FContainer]),this.FPanel.SetParent(this.FPage.FContainer),this.FPanel.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(1)),this.FSwitchEnable=pas["WEBLib.TMSFNCSwitch"].TTMSFNCSwitch.$create("Create$1",[this.FPage.FContainer]),this.FSwitchEnable.SetParent(this.FPanel),this.FSwitchEnable.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(3)),this.FSwitchEnable.SetLayout(1),this.FToolBar=pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBar.$create("Create$1",[this.FPage.FContainer]),this.FToolBar.SetParent(this.FPanel),this.FToolBar.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),(t=this.FToolBar.AddButton(-1,-1,"","","",-1)).SetText("Clear"),t.FOnClick=rtl.createCallback(this,"OnClearClick"),this.FTreeView=pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$create("Create$1",[this.FPage.FContainer]),this.FTreeView.SetParent(this.FPage.FContainer),this.FTreeView.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.InitTree(),this.FTimer=pas["WEBLib.ExtCtrls"].TWebTimer.$create("Create$1",[this.FPage.FContainer]),this.FTimer.SetEnabled(!1),this.FTimer.FOnTimer=rtl.createCallback(this,"OnTimer"),this.FHistoryCounter=0,this.FSwitchEnable.FOnChange=rtl.createCallback(this,"OnSwitchEnabledChange"),this.FPanel.SetHeight(Math.round(32*pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(this.FPanel,-1)))},this.QueueToTree=function(t){var e=null,i=0,s=null,n=rtl.createIntfRefs();try{try{this.FTreeView.BeginUpdate();for(var o=0,r=t.GetCount()-1;o<=r;o++)i=o,null!=t.GetObject(i)&&pas["WebLib.SEFNC.Logger"].TSEFNCLogMsg.isPrototypeOf(t.GetObject(i))?(e=t.GetObject(i),(s=this.FTreeView.AddNode(null)).SetText(0,e.DispDTS(!1)),s.SetText(1,e.DispLogLevel()),s.SetText(2,t.Get(i)),s.SetText(3,e.FSrcClassName),s.SetText(4,e.FSrcUnitName),s.SetIndex(0)):n.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("woo",this)}finally{this.FTreeView.EndUpdate()}}finally{n.free()}},this.OnTimer=function(t){var e=null,i=rtl.createIntfRefs();try{this.FTimer.SetEnabled(!1),e=pas.Classes.TStringList.$create("Create$1");try{i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).LogQueue(this.FHistoryCounter,{get:function(){return e},set:function(t){e=t}})&&(this.QueueToTree(e),this.FHistoryCounter=this.FHistoryCounter+e.GetCount())}finally{e=rtl.freeLoc(e),this.FTimer.SetEnabled(!0)}}finally{i.free()}},this.OnSwitchEnabledChange=function(t){var e=this.FSwitchEnable.FSwitchState;0===e?this.FTimer.SetEnabled(!1):1===e&&this.FTimer.SetEnabled(!0)},this.OnClearClick=function(t){this.FTreeView.ClearNodes()},this.ActiveSet=function(t){t?this.FSwitchEnable.SetSwitchState(1):this.FSwitchEnable.SetSwitchState(0)},this.Create$1=function(t){return this.FPage=t,this.InitViewer(),this}}))}),["WebLib.SEFNC.Logger","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCUtils"]),rtl.module("WEBLib.TMSFNCTableView",["System","Classes","WEBLib.TMSFNCTreeView","WEBLib.TMSFNCPersistence","WEBLib.TMSFNCStyles","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCCustomTreeView","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCEdit","WEBLib.TMSFNCToolBar","WEBLib.Controls","WEBLib.ExtCtrls","WEBLib.TMSFNCControlPicker","contnrs","TypInfo"],(function(){"use strict";var t=this,e=t.$impl;this.CLP_FMT="#TableView#",this.SWIPEOFFSET=30,this.TTMSFNCTableViewItemAccessory={0:"tviaNone",tviaNone:0,1:"tviaDetail",tviaDetail:1,2:"tviaProgress",tviaProgress:2,3:"tviaButton",tviaButton:3,4:"tviaBadge",tviaBadge:4,5:"tviaCustom",tviaCustom:5},this.$rtti.$Enum("TTMSFNCTableViewItemAccessory",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TTMSFNCTableViewItemAccessory}),this.$rtti.$Set("TTMSFNCTableViewItemAccessories",{comptype:this.$rtti.TTMSFNCTableViewItemAccessory}),this.ClickAccessories=rtl.createSet(3,5),this.$rtti.$Class("TTMSFNCTableViewInteraction"),this.$rtti.$Class("TTMSFNCTableViewCategory"),this.TTMSFNCTableViewItemCheckType={0:"tvictNone",tvictNone:0,1:"tvictCheckBox",tvictCheckBox:1,2:"tvictRadioButton",tvictRadioButton:2},this.$rtti.$Enum("TTMSFNCTableViewItemCheckType",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTableViewItemCheckType}),rtl.createClass(this,"TTMSFNCTableViewItem",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FRow=0,this.FTag=0,this.FDataString="",this.FDataObject=null,this.FDataInteger=0,this.FTableView=null,this.FText="",this.FDBKey="",this.FChecked=!1,this.FDataBoolean=!1,this.FWordWrapping=!1,this.FTrimming=0,this.FHorizontalTextAlign=0,this.FSelectedTextColor=0,this.FTextColor=0,this.FDisabledTextColor=0,this.FEnabled=!1,this.FBitmapName="",this.FBitmap=null,this.FHeight=0,this.FDataPointer=null,this.FHTMLTemplateItems=null,this.FVisible=!1,this.FCategoryID=0,this.FDetailControl=null,this.FAccessory=0,this.FAccessoryWidth=0,this.FAccessoryProgress=0,this.FAccessoryHeight=0,this.FAccessoryText="",this.FCheckType=0,this.FAccessoryFontColor=0,this.FAccessoryBorderColor=0,this.FAccessoryColor=0,this.FVerticalTextAlign=0,this.FEnableMoreOptions=!1,this.FTitleTrimming=0,this.FTitleHorizontalTextAlign=0,this.FTitle="",this.FDisabledTitleColor=0,this.FTitleWordWrapping=!1,this.FSelectedTitleColor=0,this.FTitleColor=0,this.FTitleVerticalTextAlign=0,this.FTitleExpanded=!1},this.$final=function(){this.FDataObject=void 0,this.FTableView=void 0,this.FBitmap=void 0,this.FHTMLTemplateItems=void 0,this.FDetailControl=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.UpdateItem())},this.SetHeight=function(t){this.FHeight!==t&&(this.FHeight=t,this.UpdateItem())},this.SetTrimming=function(t){this.FTrimming!==t&&(this.FTrimming=t,this.UpdateItem())},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,this.UpdateItem())},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t,this.UpdateItem())},this.SetSelectedTextColor=function(t){this.FSelectedTextColor!==t&&(this.FSelectedTextColor=t,this.UpdateItem())},this.SetTextColor=function(t){this.FTextColor!==t&&(this.FTextColor=t,this.UpdateItem())},this.SetDisabledTextColor=function(t){this.FDisabledTextColor!==t&&(this.FDisabledTextColor=t,this.UpdateItem())},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t,this.UpdateItem())},this.SetBitmapName=function(t){this.FBitmapName!==t&&(this.FBitmapName=t,this.UpdateItem())},this.SetBitmap=function(t){this.FBitmap!==t&&(this.FBitmap.Assign(t),this.UpdateItem())},this.SetChecked=function(t){var e=null,i=null;this.FChecked!==t&&(this.FChecked=t,null!=(e=this.GetTableView())&&null!=(i=e.GetNodeForItemIndex(this.GetIndex()))&&i.FCheckStates[0]!==this.FChecked&&(this.FChecked?e.FTreeView.CheckVirtualNode(i,0,!1):e.FTreeView.UnCheckVirtualNode(i,0,!1)))},this.GetStrippedHTMLText=function(){return pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.HTMLStrip(this.GetText())},this.IsHeightStored=function(){return-1!==this.FHeight},this.SetHTMLTemplateItems=function(t){this.FHTMLTemplateItems!==t&&(this.FHTMLTemplateItems.Assign(t),this.UpdateItem())},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,this.UpdateItem())},this.SetCategoryID=function(t){this.FCategoryID!==t&&(this.FCategoryID=t,this.UpdateItem())},this.SetDetailControl=function(t){null===t&&null!=this.FDetailControl&&this.FDetailControl.SetVisible(!0),this.FDetailControl=t,null!=this.FDetailControl&&this.FDetailControl.SetVisible(!1)},this.SetAccessory=function(t){if(this.FAccessory!==t){this.FAccessory=t;var e=this.FAccessory;1===e?(this.SetAccessoryWidth(32),this.SetAccessoryHeight(24)):2===e||3===e?(this.SetAccessoryWidth(75),this.SetAccessoryHeight(20)):4===e&&(this.SetAccessoryWidth(32),this.SetAccessoryHeight(24)),this.UpdateItem()}},this.IsAccessoryWidthStored=function(){return 24!==this.FAccessoryWidth},this.SetAccessoryWidth=function(t){this.FAccessoryWidth!==t&&(this.FAccessoryWidth=t,this.UpdateItem())},this.IsAccessoryProgressStored=function(){return 0!==this.FAccessoryProgress},this.SetAccessoryProgress=function(t){this.FAccessoryProgress!==t&&(this.FAccessoryProgress=t,this.UpdateItem())},this.IsAccessoryHeightStored=function(){return 24!==this.FAccessoryHeight},this.SetAccessoryHeight=function(t){this.FAccessoryHeight!==t&&(this.FAccessoryHeight=t,this.UpdateItem())},this.SetAccessoryText=function(t){this.FAccessoryText!==t&&(this.FAccessoryText=t,this.UpdateItem())},this.SetCheckType=function(t){this.FCheckType!==t&&(this.FCheckType=t,this.UpdateItem())},this.SetAccessoryBorderColor=function(t){this.FAccessoryBorderColor!==t&&(this.FAccessoryBorderColor=t,this.UpdateItem())},this.SetAccessoryColor=function(t){this.FAccessoryColor!==t&&(this.FAccessoryColor=t,this.UpdateItem())},this.SetAccessoryFontColor=function(t){this.FAccessoryFontColor!==t&&(this.FAccessoryFontColor=t,this.UpdateItem())},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,this.UpdateItem())},this.SetSelectedTitleColor=function(t){this.FSelectedTitleColor!==t&&(this.FSelectedTitleColor=t,this.UpdateItem())},this.SetTitleColor=function(t){this.FTitleColor!==t&&(this.FTitleColor=t,this.UpdateItem())},this.UpdateItem=function(){var t=null;null!=(t=this.GetTableView())&&t.UpdateTableView(!1)},this.BitmapChanged=function(t){this.UpdateItem()},this.TemplateItemsChanged=function(t){this.UpdateItem()},this.GetTableView=function(){return this.FTableView},this.GetText=function(){var t="",e="";return e="",null!=this.FTableView&&(t=this.FTableView.FItemAppearance.FHTMLTemplate,this.FTableView.DoGetHTMLTemplate(this,{get:function(){return t},set:function(e){t=e}}),e=""===t?this.FText:this.FTableView.HTMLReplace(t,this)),e},this.GetTitle=function(){return this.FTitle},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),null!=this.FCollection&&(this.FTableView=rtl.as(this.FCollection,t.TTMSFNCTableViewItems).TableView()),this.FTextColor=0,this.FEnableMoreOptions=!0,this.FTitleExpanded=!0,this.FChecked=!1,this.FCheckType=0,this.FCategoryID=-1,this.FAccessoryFontColor=-1,this.FAccessoryColor=-1,this.FAccessoryBorderColor=-1,this.FHeight=-1,this.FEnabled=!0,this.FAccessory=0,this.FAccessoryWidth=24,this.FAccessoryHeight=24,this.FAccessoryProgress=0,null!=this.FTableView&&this.FTableView.IsDesignTime()&&(this.FAccessoryText="Button"),this.FVisible=!0,this.FHTMLTemplateItems=pas.Classes.TStringList.$create("Create$1"),this.FHTMLTemplateItems.FOnChange=rtl.createCallback(this,"TemplateItemsChanged"),this.FTitleColor=0,this.FSelectedTextColor=0,this.FDisabledTextColor=12632256,this.FWordWrapping=!0,this.FHorizontalTextAlign=1,this.FVerticalTextAlign=0,this.FTrimming=0,this.FSelectedTitleColor=0,this.FDisabledTitleColor=12632256,this.FTitleWordWrapping=!0,this.FTitleHorizontalTextAlign=1,this.FTitleVerticalTextAlign=0,this.FTitleTrimming=0,this.FBitmap=pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap.$create("Create$3"),this.FBitmap.FOnChange=rtl.createCallback(this,"BitmapChanged"),null!=this.FTableView&&this.Assign(this.FTableView.FDefaultItem),this.UpdateItem(),this},this.Destroy=function(){rtl.free(this,"FBitmap"),rtl.free(this,"FHTMLTemplateItems"),pas.Classes.TCollectionItem.Destroy.call(this),this.UpdateItem()},this.SaveToString=function(t){var e="";return null==this.FTableView||(e="",e+=this.FText,t||(e+="{0}"),t||(e=(e=(e=e+pas.SysUtils.BoolToStr(this.FChecked,!1)+";")+this.FBitmapName+";")+pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SaveBitmapToHexStr(this.FBitmap)+";",e+=""),t||(e+="{0}",e+=pas.SysUtils.BoolToStr(this.FEnabled,!1))),e},this.LoadFromString=function(t){var e=0,i=null,s=null,n=0,o="",r=0,a="";i=pas.Classes.TStringList.$create("Create$1");try{for(o=t;""!==o;){if(0===(r=pas.System.Pos("{0}",o))){i.Add(o);break}a=pas.System.Copy(o,1,r-1),i.Add(a),pas.System.Delete({get:function(){return o},set:function(t){o=t}},1,r-1+"{0}".length)}for(var l=0,h=i.GetCount()-1;l<=h;l++)if(e=l,""!==i.Get(e))if(0===e)this.SetText(i.Get(e));else if(1===e){s=pas.Classes.TStringList.$create("Create$1");try{pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.Split(";",i.Get(e),s,!1);for(var F=0,p=s.GetCount()-1;F<=p;F++)n=F,""!==s.Get(n)&&(0===n?this.SetChecked(pas.SysUtils.StrToBool(s.Get(n))):1===n?this.SetBitmapName(s.Get(n)):2===n&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.LoadBitmapFromHexStr(s.Get(n),this.FBitmap))}finally{s=rtl.freeLoc(s)}}else 2===e&&this.SetEnabled(pas.SysUtils.StrToBool(i.Get(e)))}finally{i=rtl.freeLoc(i)}},this.Assign=function(e){t.TTMSFNCTableViewItem.isPrototypeOf(e)&&(this.FTag=rtl.as(e,t.TTMSFNCTableViewItem).FTag,this.FHTMLTemplateItems.Assign(rtl.as(e,t.TTMSFNCTableViewItem).FHTMLTemplateItems),this.FText=rtl.as(e,t.TTMSFNCTableViewItem).FText,this.FTrimming=rtl.as(e,t.TTMSFNCTableViewItem).FTrimming,this.FWordWrapping=rtl.as(e,t.TTMSFNCTableViewItem).FWordWrapping,this.FHorizontalTextAlign=rtl.as(e,t.TTMSFNCTableViewItem).FHorizontalTextAlign,this.FVerticalTextAlign=rtl.as(e,t.TTMSFNCTableViewItem).FVerticalTextAlign,this.FTextColor=rtl.as(e,t.TTMSFNCTableViewItem).FTextColor,this.FSelectedTextColor=rtl.as(e,t.TTMSFNCTableViewItem).FSelectedTextColor,this.FDisabledTextColor=rtl.as(e,t.TTMSFNCTableViewItem).FDisabledTextColor,this.FTitle=rtl.as(e,t.TTMSFNCTableViewItem).FTitle,this.FTitleTrimming=rtl.as(e,t.TTMSFNCTableViewItem).FTitleTrimming,this.FTitleWordWrapping=rtl.as(e,t.TTMSFNCTableViewItem).FTitleWordWrapping,this.FTitleHorizontalTextAlign=rtl.as(e,t.TTMSFNCTableViewItem).FTitleHorizontalTextAlign,this.FTitleVerticalTextAlign=rtl.as(e,t.TTMSFNCTableViewItem).FTitleVerticalTextAlign,this.FTitleColor=rtl.as(e,t.TTMSFNCTableViewItem).FTitleColor,this.FSelectedTitleColor=rtl.as(e,t.TTMSFNCTableViewItem).FSelectedTitleColor,this.FDisabledTitleColor=rtl.as(e,t.TTMSFNCTableViewItem).FDisabledTitleColor,this.FEnabled=rtl.as(e,t.TTMSFNCTableViewItem).FEnabled,this.FAccessory=rtl.as(e,t.TTMSFNCTableViewItem).FAccessory,this.FVisible=rtl.as(e,t.TTMSFNCTableViewItem).FVisible,this.FBitmapName=rtl.as(e,t.TTMSFNCTableViewItem).FBitmapName,this.FBitmap.Assign(rtl.as(e,t.TTMSFNCTableViewItem).FBitmap),this.FHeight=rtl.as(e,t.TTMSFNCTableViewItem).FHeight,this.FCategoryID=rtl.as(e,t.TTMSFNCTableViewItem).FCategoryID,this.FAccessoryWidth=rtl.as(e,t.TTMSFNCTableViewItem).FAccessoryWidth,this.FAccessoryHeight=rtl.as(e,t.TTMSFNCTableViewItem).FAccessoryHeight,this.FAccessoryProgress=rtl.as(e,t.TTMSFNCTableViewItem).FAccessoryProgress,this.FAccessoryText=rtl.as(e,t.TTMSFNCTableViewItem).FAccessoryText,this.FChecked=rtl.as(e,t.TTMSFNCTableViewItem).FChecked,this.FCheckType=rtl.as(e,t.TTMSFNCTableViewItem).FCheckType,this.FAccessoryFontColor=rtl.as(e,t.TTMSFNCTableViewItem).FAccessoryFontColor,this.FAccessoryBorderColor=rtl.as(e,t.TTMSFNCTableViewItem).FAccessoryBorderColor,this.FAccessoryColor=rtl.as(e,t.TTMSFNCTableViewItem).FAccessoryColor,this.FEnableMoreOptions=rtl.as(e,t.TTMSFNCTableViewItem).FEnableMoreOptions,this.AssignData(e))},this.AssignData=function(e){t.TTMSFNCTableViewItem.isPrototypeOf(e)&&(this.FDataString=rtl.as(e,t.TTMSFNCTableViewItem).FDataString,this.FDataBoolean=rtl.as(e,t.TTMSFNCTableViewItem).FDataBoolean,this.FDataObject=rtl.as(e,t.TTMSFNCTableViewItem).FDataObject,this.FDataInteger=rtl.as(e,t.TTMSFNCTableViewItem).FDataInteger,this.FDataPointer=rtl.as(e,t.TTMSFNCTableViewItem).FDataPointer,this.FDBKey=rtl.as(e,t.TTMSFNCTableViewItem).FDBKey)},this.ShowDetailControl=function(){null!=this.FTableView&&this.FTableView.ShowDetailControl(this.GetIndex())};var e=this.$rtti;e.addProperty("Checked",2,rtl.boolean,"FChecked","SetChecked",{Default:!1}),e.addProperty("DetailControl",2,pas["WEBLib.Controls"].$rtti.TControl,"FDetailControl","SetDetailControl"),e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("HTMLTemplateItems",2,pas.Classes.$rtti.TStringList,"FHTMLTemplateItems","SetHTMLTemplateItems"),e.addProperty("Bitmap",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap,"FBitmap","SetBitmap"),e.addProperty("BitmapName",2,rtl.string,"FBitmapName","SetBitmapName"),e.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!0}),e.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttNone}),e.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaLeading}),e.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaLeading}),e.addProperty("TextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FTextColor","SetTextColor",{Default:0}),e.addProperty("SelectedTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FSelectedTextColor","SetSelectedTextColor",{Default:16777215}),e.addProperty("DisabledTextColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FDisabledTextColor","SetDisabledTextColor",{Default:12632256}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),e.addProperty("Height",14,rtl.double,"FHeight","SetHeight",{stored:"IsHeightStored"}),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("CategoryID",2,rtl.longint,"FCategoryID","SetCategoryID",{Default:-1}),e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag",{Default:0}),e.addProperty("AccessoryWidth",14,rtl.double,"FAccessoryWidth","SetAccessoryWidth",{stored:"IsAccessoryWidthStored"}),e.addProperty("AccessoryHeight",14,rtl.double,"FAccessoryHeight","SetAccessoryHeight",{stored:"IsAccessoryHeightStored"}),e.addProperty("Accessory",2,t.$rtti.TTMSFNCTableViewItemAccessory,"FAccessory","SetAccessory",{Default:t.TTMSFNCTableViewItemAccessory.tviaNone}),e.addProperty("AccessoryProgress",14,rtl.double,"FAccessoryProgress","SetAccessoryProgress",{stored:"IsAccessoryProgressStored"}),e.addProperty("AccessoryText",2,rtl.string,"FAccessoryText","SetAccessoryText"),e.addProperty("AccessoryColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FAccessoryColor","SetAccessoryColor",{Default:-1}),e.addProperty("AccessoryBorderColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FAccessoryBorderColor","SetAccessoryBorderColor",{Default:-1}),e.addProperty("AccessoryFontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FAccessoryFontColor","SetAccessoryFontColor",{Default:-1}),e.addProperty("CheckType",2,t.$rtti.TTMSFNCTableViewItemCheckType,"FCheckType","SetCheckType",{Default:t.TTMSFNCTableViewItemCheckType.tvictNone}),e.addProperty("EnableMoreOptions",0,rtl.boolean,"FEnableMoreOptions","FEnableMoreOptions",{Default:!0})})),this.TTMSFNCTableViewItemsSortMode={0:"tvismAscending",tvismAscending:0,1:"tvismDescending",tvismDescending:1},this.TTMSFNCTableViewItemsSortKind={0:"tviskNone",tviskNone:0,1:"tviskAscending",tviskAscending:1,2:"tviskDescending",tviskDescending:2},rtl.createClass(this,"TTMSFNCTableViewItems",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FTableView=null},this.$final=function(){this.FTableView=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.GetItemClass=function(){return t.TTMSFNCTableViewItem},this.Compare=function(t,e,i,s){var n=0,o=0,r=0,a="",l="",h=null;if(n=0,null!=(h=this.FTableView)){var F=h.FCategoryType;0===F||1===F||2===F||3===F?n=i?pas.SysUtils.AnsiCompareStr(t.GetStrippedHTMLText(),e.GetStrippedHTMLText()):pas.SysUtils.AnsiCompareStr(pas.SysUtils.UpperCase(t.GetStrippedHTMLText()),pas.SysUtils.UpperCase(e.GetStrippedHTMLText())):4===F&&((o=h.FCategories.ItemIndexById(t.FCategoryID))<(r=h.FCategories.ItemIndexById(e.FCategoryID))?n=-1:o>r?n=1:(a=t.GetStrippedHTMLText(),l=e.GetStrippedHTMLText(),i||(a=pas.SysUtils.UpperCase(a),l=pas.SysUtils.UpperCase(l)),n=a<l?-1:a>l?1:0)),1===s&&(n*=-1),h.DoItemCompare(t,e,{get:function(){return n},set:function(t){n=t}})}return n},this.QuickSort=function(t,e,i,s){var n,o,r,a=0,l=0,h=0,F=null;F=this.FItems;do{a=t,l=e,h=t+e>>>1;do{for(;this.Compare(this.GetItem$1(a),this.GetItem$1(h),i,s)<0;)a+=1;for(;this.Compare(this.GetItem$1(l),this.GetItem$1(h),i,s)>0;)l-=1;a<=l&&(n=a,o=l,r=void 0,r=F.Get(n),F.Put(n,F.Get(o)),F.Put(o,r),h===a?h=l:h===l&&(h=a),a+=1,l-=1)}while(!(a>l));t<l&&this.QuickSort(t,l,i,s),t=a}while(!(a>=e))},this.TableView=function(){return this.FTableView},this.Create$3=function(t){return pas.Classes.TOwnedCollection.Create$2.call(this,t,this.GetItemClass()),this.FTableView=t,this},this.Add$1=function(){return pas.Classes.TCollection.Add.call(this)},this.Clear$1=function(){var t=null;null!=(t=this.TableView())&&t.BeginUpdate(),pas.Classes.TCollection.Clear.call(this),null!=t&&t.EndUpdate()},this.Sort$1=function(t,e){var i=null;null!=(i=this.TableView())&&(i.BeginUpdate(),this.BeginUpdate(),this.GetCount()>1&&this.QuickSort(0,this.GetCount()-1,t,e),this.EndUpdate(),i.EndUpdate())}})),rtl.createClass(this,"TTMSFNCTableViewLookup",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null},this.$final=function(){this.FOwner=void 0,pas.Classes.TPersistent.$final.call(this)},this.GetAutoSelect=function(){var t=!1;return t=!1,null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&(t=this.FOwner.FTableView.FTreeView.FInteraction.FLookup.FAutoSelect),t},this.GetCaseSensitive=function(){var t=!1;return t=!1,null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&(t=this.FOwner.FTableView.FTreeView.FInteraction.FLookup.FCaseSensitive),t},this.GetEnabled=function(){var t=!1;return t=!1,null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&(t=this.FOwner.FTableView.FTreeView.FInteraction.FLookup.FEnabled),t},this.GetIncremental=function(){var t=!1;return t=!1,null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&(t=this.FOwner.FTableView.FTreeView.FInteraction.FLookup.FIncremental),t},this.SetAutoSelect=function(t){null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&(this.FOwner.FTableView.FTreeView.FInteraction.FLookup.FAutoSelect=t)},this.SetCaseSensitive=function(t){null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&(this.FOwner.FTableView.FTreeView.FInteraction.FLookup.FCaseSensitive=t)},this.SetEnabled=function(t){null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&(this.FOwner.FTableView.FTreeView.FInteraction.FLookup.FEnabled=t)},this.SetIncremental=function(t){null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&(this.FOwner.FTableView.FTreeView.FInteraction.FLookup.FIncremental=t)},this.Create$1=function(t){return this.FOwner=t,this},this.Assign=function(e){t.TTMSFNCTableViewLookup.isPrototypeOf(e)&&(this.SetCaseSensitive(rtl.as(e,t.TTMSFNCTableViewLookup).GetCaseSensitive()),this.SetEnabled(rtl.as(e,t.TTMSFNCTableViewLookup).GetEnabled()),this.SetIncremental(rtl.as(e,t.TTMSFNCTableViewLookup).GetIncremental()),this.SetAutoSelect(rtl.as(e,t.TTMSFNCTableViewLookup).GetAutoSelect()))};var e=this.$rtti;e.addProperty("CaseSensitive",3,rtl.boolean,"GetCaseSensitive","SetCaseSensitive",{Default:!1}),e.addProperty("Enabled",3,rtl.boolean,"GetEnabled","SetEnabled",{Default:!0}),e.addProperty("Incremental",3,rtl.boolean,"GetIncremental","SetIncremental",{Default:!0}),e.addProperty("AutoSelect",3,rtl.boolean,"GetAutoSelect","SetAutoSelect",{Default:!0})})),rtl.createClass(this,"TTMSFNCTableViewFiltering",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FOwner=null},this.$final=function(){this.FOwner=void 0,pas.Classes.TPersistent.$final.call(this)},this.GetDropDownHeight=function(){var t=0;return t=120,null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&this.FOwner.FTableView.FTreeView.FColumns.GetCount()>0&&(t=this.FOwner.FTableView.FTreeView.FColumns.GetItem$1(0).FFiltering.FDropDownHeight),t},this.GetDropDownWidth=function(){var t=0;return t=100,null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&this.FOwner.FTableView.FTreeView.FColumns.GetCount()>0&&(t=this.FOwner.FTableView.FTreeView.FColumns.GetItem$1(0).FFiltering.FDropDownWidth),t},this.GetEnabled=function(){var t=!1;return t=!1,null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&this.FOwner.FTableView.FTreeView.FColumns.GetCount()>0&&(t=this.FOwner.FTableView.FTreeView.FColumns.GetItem$1(0).FFiltering.FEnabled),t},this.SetDropDownHeight=function(t){null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&this.FOwner.FTableView.FTreeView.FColumns.GetCount()>0&&(this.FOwner.FTableView.FTreeView.FColumns.GetItem$1(0).FFiltering.FDropDownHeight=t)},this.SetDropDownWidth=function(t){null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&this.FOwner.FTableView.FTreeView.FColumns.GetCount()>0&&(this.FOwner.FTableView.FTreeView.FColumns.GetItem$1(0).FFiltering.FDropDownWidth=t)},this.SetEnabled=function(t){null!=this.FOwner&&null!=this.FOwner.FTableView&&null!=this.FOwner.FTableView.FTreeView&&this.FOwner.FTableView.FTreeView.FColumns.GetCount()>0&&this.FOwner.FTableView.FTreeView.FColumns.GetItem$1(0).FFiltering.SetEnabled(t)},this.Create$1=function(t){return this.FOwner=t,this},this.Assign=function(e){t.TTMSFNCTableViewFiltering.isPrototypeOf(e)&&(this.SetEnabled(rtl.as(e,t.TTMSFNCTableViewFiltering).GetEnabled()),this.SetDropDownWidth(rtl.as(e,t.TTMSFNCTableViewFiltering).GetDropDownWidth()),this.SetDropDownHeight(rtl.as(e,t.TTMSFNCTableViewFiltering).GetDropDownHeight()))};var e=this.$rtti;e.addProperty("Enabled",3,rtl.boolean,"GetEnabled","SetEnabled",{Default:!1}),e.addProperty("DropDownWidth",3,rtl.longint,"GetDropDownWidth","SetDropDownWidth",{Default:100}),e.addProperty("DropDownHeight",3,rtl.longint,"GetDropDownHeight","SetDropDownHeight",{Default:120})})),this.TTMSFNCTableViewClipboardMode={0:"tvcmNone",tvcmNone:0,1:"tvcmTextOnly",tvcmTextOnly:1,2:"tvcmFull",tvcmFull:2},this.TTMSFNCTableViewDragDropMode={0:"tvdmNone",tvdmNone:0,1:"tvdmMove",tvdmMove:1,2:"tvdmCopy",tvdmCopy:2},this.TTMSFNCTableViewSorting={0:"tvcsNone",tvcsNone:0,1:"tvcsNormal",tvcsNormal:1,2:"tvcsNormalCaseSensitive",tvcsNormalCaseSensitive:2},this.TTMSFNCTableViewShowDetailMode={0:"tvdtNone",tvdtNone:0,1:"tvdtAfterSelectItem",tvdtAfterSelectItem:1},this.$rtti.$Enum("TTMSFNCTableViewShowDetailMode",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTableViewShowDetailMode}),this.TTMSFNCTableViewKeyboardEscapeMode={0:"tvkeNone",tvkeNone:0,1:"tvkeClearEdit",tvkeClearEdit:1,2:"tvkeStopFilter",tvkeStopFilter:2},this.$rtti.$Enum("TTMSFNCTableViewKeyboardEscapeMode",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTableViewKeyboardEscapeMode}),rtl.createClass(this,"TTMSFNCTableViewInteraction",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTableView=null,this.FLookup=null,this.FFiltering=null,this.FShowDetailMode=0,this.FShowEditButton=!1,this.FShowFilterButton=!1,this.FAccessoryClickDetection={},this.FLongPressToEdit=!1,this.FSwipeToShowMoreOptions=!1,this.FSwipeBounceGesture=!1,this.FKeyboardEscapeMode=0},this.$final=function(){this.FTableView=void 0,this.FLookup=void 0,this.FFiltering=void 0,this.FAccessoryClickDetection=void 0,pas.Classes.TPersistent.$final.call(this)},this.GetMultiSelect=function(){var t=!1;return t=!1,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FInteraction.FMultiSelect),t},this.SetMultiSelect=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FInteraction.SetMultiSelect(t)},this.GetClipboardMode=function(){var t=0;return t=0,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FInteraction.FClipboardMode),t},this.GetDragDropMode=function(){var t=0;return t=0,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FInteraction.FDragDropMode),t},this.GetReorder=function(){var t=!1;return t=!1,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FInteraction.FReorder),t},this.GetTouchScrolling=function(){var t=!1;return t=!0,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FInteraction.FTouchScrolling),t},this.SetDragDropMode=function(t){var e=0;null!=this.FTableView&&null!=this.FTableView.FTreeView&&(e=t,this.FTableView.FTreeView.FInteraction.SetDragDropMode(e))},this.SetReorder=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FInteraction.SetReorder(t)},this.SetTouchScrolling=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FInteraction.SetTouchScrolling(t)},this.SetClipboardMode=function(t){var e=0;null!=this.FTableView&&null!=this.FTableView.FTreeView&&(e=t,this.FTableView.FTreeView.FInteraction.FClipboardMode=e)},this.GetSorting=function(){var t=0;if(t=0,null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FColumns.GetCount()>0){var e=this.FTableView.FTreeView.FColumns.GetItem$1(0).FSorting;0===e?t=0:1===e?t=1:3===e&&(t=2)}return t},this.SetSorting=function(t){if(null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FColumns.GetCount()>0){var e=t;0===e?this.FTableView.FTreeView.FColumns.GetItem$1(0).SetSorting(0):1===e?this.FTableView.FTreeView.FColumns.GetItem$1(0).SetSorting(1):2===e&&this.FTableView.FTreeView.FColumns.GetItem$1(0).SetSorting(3)}},this.SetShowDetailMode=function(t){this.FShowDetailMode!==t&&(this.FShowDetailMode=t)},this.SetShowEditButton=function(t){this.FShowEditButton!==t&&(this.FShowEditButton=t,null!=this.FTableView&&this.FTableView.UpdateTableView(!1))},this.SetShowFilterButton=function(t){this.FShowFilterButton!==t&&(this.FShowFilterButton=t,null!=this.FTableView&&this.FTableView.UpdateTableView(!1))},this.SetAccessoryClickDetection=function(t){this.FAccessoryClickDetection=rtl.refSet(t)},this.GetAutoOpenURL=function(){var t=!1;return t=!0,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FInteraction.FAutoOpenURL),t},this.SetAutoOpenURL=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&(this.FTableView.FTreeView.FInteraction.FAutoOpenURL=t)},this.GetAnimationFactor=function(){var t=0;return t=2.5,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FInteraction.FAnimationFactor),t},this.SetAnimationFactor=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&(this.FTableView.FTreeView.FInteraction.FAnimationFactor=t)},this.Create$1=function(e){return this.FTableView=e,this.FLongPressToEdit=!0,this.FSwipeToShowMoreOptions=!0,this.FAccessoryClickDetection=rtl.refSet(t.ClickAccessories),this.FLookup=t.TTMSFNCTableViewLookup.$create("Create$1",[this]),this.FFiltering=t.TTMSFNCTableViewFiltering.$create("Create$1",[this]),this.FShowDetailMode=1,this.FShowEditButton=!1,this.FShowFilterButton=!1,this.FSwipeBounceGesture=!0,this.FKeyboardEscapeMode=2,this},this.Destroy=function(){rtl.free(this,"FLookup"),rtl.free(this,"FFiltering"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCTableViewInteraction.isPrototypeOf(e)&&(this.FLookup.Assign(rtl.as(e,t.TTMSFNCTableViewInteraction).FLookup),this.FFiltering.Assign(rtl.as(e,t.TTMSFNCTableViewInteraction).FFiltering),this.SetSorting(rtl.as(e,t.TTMSFNCTableViewInteraction).GetSorting()),this.FShowDetailMode=rtl.as(e,t.TTMSFNCTableViewInteraction).FShowDetailMode,this.SetDragDropMode(rtl.as(e,t.TTMSFNCTableViewInteraction).GetDragDropMode()),this.SetMultiSelect(rtl.as(e,t.TTMSFNCTableViewInteraction).GetMultiSelect()),this.SetTouchScrolling(rtl.as(e,t.TTMSFNCTableViewInteraction).GetTouchScrolling()),this.SetClipboardMode(rtl.as(e,t.TTMSFNCTableViewInteraction).GetClipboardMode()),this.SetReorder(rtl.as(e,t.TTMSFNCTableViewInteraction).GetReorder()),this.FShowEditButton=rtl.as(e,t.TTMSFNCTableViewInteraction).FShowEditButton,this.FShowFilterButton=rtl.as(e,t.TTMSFNCTableViewInteraction).FShowFilterButton,this.FAccessoryClickDetection=rtl.refSet(rtl.as(e,t.TTMSFNCTableViewInteraction).FAccessoryClickDetection),this.FLongPressToEdit=rtl.as(e,t.TTMSFNCTableViewInteraction).FLongPressToEdit,this.FSwipeToShowMoreOptions=rtl.as(e,t.TTMSFNCTableViewInteraction).FSwipeToShowMoreOptions,this.FSwipeBounceGesture=rtl.as(e,t.TTMSFNCTableViewInteraction).FSwipeBounceGesture)};var e=this.$rtti;e.addProperty("AnimationFactor",3,rtl.double,"GetAnimationFactor","SetAnimationFactor"),e.addProperty("AutoOpenURL",3,rtl.boolean,"GetAutoOpenURL","SetAutoOpenURL",{Default:!0}),e.addProperty("MultiSelect",3,rtl.boolean,"GetMultiSelect","SetMultiSelect",{Default:!1}),e.addProperty("TouchScrolling",3,rtl.boolean,"GetTouchScrolling","SetTouchScrolling",{Default:!0}),e.addProperty("ShowDetailMode",2,t.$rtti.TTMSFNCTableViewShowDetailMode,"FShowDetailMode","SetShowDetailMode",{Default:t.TTMSFNCTableViewShowDetailMode.tvdtAfterSelectItem}),e.addProperty("ShowEditButton",2,rtl.boolean,"FShowEditButton","SetShowEditButton",{Default:!1}),e.addProperty("ShowFilterButton",2,rtl.boolean,"FShowFilterButton","SetShowFilterButton",{Default:!1}),e.addProperty("SwipeBounceGesture",0,rtl.boolean,"FSwipeBounceGesture","FSwipeBounceGesture",{Default:!0}),e.addProperty("AccessoryClickDetection",2,t.$rtti.TTMSFNCTableViewItemAccessories,"FAccessoryClickDetection","SetAccessoryClickDetection",{Default:t.ClickAccessories}),e.addProperty("SwipeToShowMoreOptions",0,rtl.boolean,"FSwipeToShowMoreOptions","FSwipeToShowMoreOptions",{Default:!0}),e.addProperty("LongPressToEdit",0,rtl.boolean,"FLongPressToEdit","FLongPressToEdit",{Default:!0}),e.addProperty("KeyboardEscapeMode",0,t.$rtti.TTMSFNCTableViewKeyboardEscapeMode,"FKeyboardEscapeMode","FKeyboardEscapeMode",{Default:t.TTMSFNCTableViewKeyboardEscapeMode.tvkeStopFilter})})),this.TTMSFNCTableViewItemHeightMode={0:"tvhmFixed",tvhmFixed:0,1:"tvhmVariable",tvhmVariable:1},this.$rtti.$Enum("TTMSFNCTableViewItemHeightMode",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTableViewItemHeightMode}),rtl.createClass(this,"TTMSFNCTableViewItemAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTableView=null,this.FHTMLTemplate="",this.FAccessoryDetailBitmaps=null,this.FAccessoryFont=null,this.FAccessoryStroke=null,this.FAccessoryFill=null,this.FHeight=0},this.$final=function(){this.FTableView=void 0,this.FAccessoryDetailBitmaps=void 0,this.FAccessoryFont=void 0,this.FAccessoryStroke=void 0,this.FAccessoryFill=void 0,pas.Classes.TPersistent.$final.call(this)},this.GetFont=function(){var t=null;return t=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FFont),t},this.GetSelectedFill=function(){var t=null;return t=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FSelectedFill),t},this.SetFont=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.FFont.Assign(t)},this.SetSelectedFill=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.FSelectedFill.Assign(t)},this.GetSelectedStroke=function(){var t=null;return t=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FSelectedStroke),t},this.SetSelectedStroke=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.FSelectedStroke.Assign(t)},this.GetDisabledFill=function(){var t=null;return t=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FDisabledFill),t},this.GetDisabledStroke=function(){var t=null;return t=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FDisabledStroke),t},this.GetFill=function(){var t=null;return t=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FFill),t},this.GetStroke=function(){var t=null;return t=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FStroke),t},this.SetDisabledFill=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.FDisabledFill.Assign(t)},this.SetDisabledStroke=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.FDisabledStroke.Assign(t)},this.SetFill=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.FFill.Assign(t)},this.SetStroke=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.FStroke.Assign(t)},this.GetHeightMode=function(){var t=0;return t=1,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FHeightMode),t},this.SetHeightMode=function(t){var e=0;null!=this.FTableView&&null!=this.FTableView.FTreeView&&(e=t,this.FTableView.FTreeView.FNodesAppearance.SetHeightMode(e))},this.GetFixedHeight=function(){var t=0;return t=0,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FFixedHeight),t},this.SetFixedHeight=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.SetFixedHeight(t)},this.SetHTMLTemplate=function(t){this.FHTMLTemplate!==t&&(this.FHTMLTemplate=t,null!=this.FTableView&&this.FTableView.UpdateTableView(!1))},this.SetAccessoryDetailBitmaps=function(t){this.FAccessoryDetailBitmaps.Assign(t)},this.SetAccessoryFont=function(t){this.FAccessoryFont.Assign(t)},this.SetAccessoryFill=function(t){this.FAccessoryFill.Assign(t)},this.SetAccessoryStroke=function(t){this.FAccessoryStroke.Assign(t)},this.IsHeightStored=function(){return-1!==this.FHeight},this.SetHeight=function(t){this.FHeight!==t&&(this.FHeight=t,null!=this.FTableView&&this.FTableView.UpdateTableView(!1))},this.GetShowFocus=function(){var t=!1;return t=!0,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FShowFocus),t},this.SetShowFocus=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.SetShowFocus(t)},this.DoAccessoryDetailBitmapsChanged=function(t){null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.FontChanged=function(t){null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.FillChanged=function(t){null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.StrokeChanged=function(t){null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.GetOwner=function(){return this.FTableView},this.Assign=function(e){t.TTMSFNCTableViewItemAppearance.isPrototypeOf(e)&&(this.GetFont().Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).GetFont()),this.GetFill().Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).GetFill()),this.GetStroke().Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).GetStroke()),this.GetSelectedFill().Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).GetSelectedFill()),this.GetSelectedStroke().Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).GetSelectedStroke()),this.GetDisabledFill().Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).GetDisabledFill()),this.GetDisabledStroke().Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).GetDisabledStroke()),this.SetHeightMode(rtl.as(e,t.TTMSFNCTableViewItemAppearance).GetHeightMode()),this.SetFixedHeight(rtl.as(e,t.TTMSFNCTableViewItemAppearance).GetFixedHeight()),this.FHTMLTemplate=rtl.as(e,t.TTMSFNCTableViewItemAppearance).FHTMLTemplate,this.FAccessoryDetailBitmaps.Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).FAccessoryDetailBitmaps),this.FAccessoryFont.Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).FAccessoryFont),this.FAccessoryStroke.Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).FAccessoryStroke),this.FAccessoryFill.Assign(rtl.as(e,t.TTMSFNCTableViewItemAppearance).FAccessoryFill))},this.Create$1=function(t){return this.FTableView=t,this.FAccessoryFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,3329434,8421504,-1,-1]),this.FAccessoryFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FAccessoryStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,0]),this.FAccessoryStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FAccessoryFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),null!=this.FTableView&&this.FTableView.IsDesignTime()&&(this.FAccessoryFont.SetColor(139),this.FAccessoryFont.SetStyle(rtl.createSet(0))),this.FAccessoryFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FAccessoryDetailBitmaps=pas["WEBLib.TMSFNCTypes"].TTMSFNCScaledBitmaps.$create("Create$3",[this]),this.FAccessoryDetailBitmaps.FOnChange=rtl.createCallback(this,"DoAccessoryDetailBitmapsChanged"),null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.IsDesignTime()&&(this.FTableView.FTreeView.FNodesAppearance.FDisabledFill.SetKind(0),this.FTableView.FTreeView.FNodesAppearance.FDisabledStroke.SetKind(0),this.FTableView.FTreeView.FNodesAppearance.FSelectedStroke.Assign(this.FTableView.FTreeView.FNodesAppearance.FSelectedFill)),this.SetHeightMode(1),this.FHeight=-1,this},this.Destroy=function(){rtl.free(this,"FAccessoryFill"),rtl.free(this,"FAccessoryStroke"),rtl.free(this,"FAccessoryFont"),rtl.free(this,"FAccessoryDetailBitmaps"),pas.System.TObject.Destroy.call(this)};var e=this.$rtti;e.addProperty("Font",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"GetFont","SetFont"),e.addProperty("Fill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetFill","SetFill"),e.addProperty("Stroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetStroke","SetStroke"),e.addProperty("SelectedFill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetSelectedFill","SetSelectedFill"),e.addProperty("SelectedStroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetSelectedStroke","SetSelectedStroke"),e.addProperty("DisabledFill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetDisabledFill","SetDisabledFill"),e.addProperty("DisabledStroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetDisabledStroke","SetDisabledStroke"),e.addProperty("HeightMode",3,t.$rtti.TTMSFNCTableViewItemHeightMode,"GetHeightMode","SetHeightMode",{Default:t.TTMSFNCTableViewItemHeightMode.tvhmVariable}),e.addProperty("FixedHeight",3,rtl.double,"GetFixedHeight","SetFixedHeight"),e.addProperty("Height",14,rtl.double,"FHeight","SetHeight",{stored:"IsHeightStored"}),e.addProperty("HTMLTemplate",2,rtl.string,"FHTMLTemplate","SetHTMLTemplate"),e.addProperty("AccessoryDetailBitmaps",2,pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCScaledBitmaps,"FAccessoryDetailBitmaps","SetAccessoryDetailBitmaps"),e.addProperty("AccessoryFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FAccessoryFont","SetAccessoryFont"),e.addProperty("AccessoryStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FAccessoryStroke","SetAccessoryStroke"),e.addProperty("AccessoryFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FAccessoryFill","SetAccessoryFill"),e.addProperty("ShowFocus",3,rtl.boolean,"GetShowFocus","SetShowFocus",{Default:!0})})),rtl.createClass(this,"TTMSFNCTableViewCategoryAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTableView=null,this.FHeight=0},this.$final=function(){this.FTableView=void 0,pas.Classes.TPersistent.$final.call(this)},this.GetFont=function(){var t=null;return t=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FExtendedFont),t},this.SetFont=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.FExtendedFont.Assign(t)},this.GetFill=function(){var t=null;return t=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FExtendedFill),t},this.GetStroke=function(){var t=null;return t=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FNodesAppearance.FExtendedStroke),t},this.SetFill=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.FExtendedFill.Assign(t)},this.SetStroke=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FNodesAppearance.FExtendedStroke.Assign(t)},this.IsHeightStored=function(){return-1!==this.FHeight},this.SetHeight=function(t){this.FHeight!==t&&(this.FHeight=t,null!=this.FTableView&&this.FTableView.UpdateTableView(!1))},this.Assign=function(e){t.TTMSFNCTableViewCategoryAppearance.isPrototypeOf(e)&&(this.GetFont().Assign(rtl.as(e,t.TTMSFNCTableViewCategoryAppearance).GetFont()),this.GetFill().Assign(rtl.as(e,t.TTMSFNCTableViewCategoryAppearance).GetFill()),this.GetStroke().Assign(rtl.as(e,t.TTMSFNCTableViewCategoryAppearance).GetStroke()),this.FHeight=rtl.as(e,t.TTMSFNCTableViewCategoryAppearance).FHeight)},this.Create$1=function(t){return this.FTableView=t,this.FHeight=-1,this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)};var e=this.$rtti;e.addProperty("Font",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"GetFont","SetFont"),e.addProperty("Fill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetFill","SetFill"),e.addProperty("Stroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetStroke","SetStroke"),e.addProperty("Height",14,rtl.double,"FHeight","SetHeight",{stored:"IsHeightStored"})})),rtl.createClass(this,"TTMSFNCTableViewMoreOptionAppearance",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTableView=null,this.FFill=null,this.FStroke=null,this.FFont=null},this.$final=function(){this.FTableView=void 0,this.FFill=void 0,this.FStroke=void 0,this.FFont=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetFont=function(t){this.FFont.Assign(t)},this.SetFill=function(t){this.FFill.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.FontChanged=function(t){null!=this.FTableView&&this.FTableView.Invalidate()},this.StrokeChanged=function(t){null!=this.FTableView&&this.FTableView.Invalidate()},this.FillChanged=function(t){null!=this.FTableView&&this.FTableView.Invalidate()},this.Assign=function(e){t.TTMSFNCTableViewMoreOptionAppearance.isPrototypeOf(e)&&(this.FFont.Assign(rtl.as(e,t.TTMSFNCTableViewMoreOptionAppearance).FFont),this.FFill.Assign(rtl.as(e,t.TTMSFNCTableViewMoreOptionAppearance).FFill),this.FStroke.Assign(rtl.as(e,t.TTMSFNCTableViewMoreOptionAppearance).FStroke))},this.Create$1=function(t){return this.FTableView=t,this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),null!=this.FTableView&&this.FTableView.IsDesignTime()&&this.FFont.SetColor(16777215),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,11829830,8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11829830]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this},this.Destroy=function(){rtl.free(this,"FFont"),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),pas.System.TObject.Destroy.call(this)};var e=this.$rtti;e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke")})),rtl.createClass(this,"TTMSFNCTableViewHeaderFooter",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTableView=null,this.FText="",this.FWordWrapping=!1,this.FVerticalTextAlign=0,this.FTrimming=0,this.FHorizontalTextAlign=0},this.$final=function(){this.FTableView=void 0,pas.Classes.TPersistent.$final.call(this)},this.GetVisible=function(){var e=!1;return e=!1,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(e=t.TTMSFNCTableViewHeader.isPrototypeOf(this)?0 in this.FTableView.FTreeView.FColumnsAppearance.FLayouts:1 in this.FTableView.FTreeView.FColumnsAppearance.FLayouts),e},this.SetVisible=function(e){null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t.TTMSFNCTableViewHeader.isPrototypeOf(this)?e?this.FTableView.FTreeView.FColumnsAppearance.SetLayouts(rtl.unionSet(this.FTableView.FTreeView.FColumnsAppearance.FLayouts,rtl.createSet(0))):this.FTableView.FTreeView.FColumnsAppearance.SetLayouts(rtl.diffSet(this.FTableView.FTreeView.FColumnsAppearance.FLayouts,rtl.createSet(0))):e?this.FTableView.FTreeView.FColumnsAppearance.SetLayouts(rtl.unionSet(this.FTableView.FTreeView.FColumnsAppearance.FLayouts,rtl.createSet(1))):this.FTableView.FTreeView.FColumnsAppearance.SetLayouts(rtl.diffSet(this.FTableView.FTreeView.FColumnsAppearance.FLayouts,rtl.createSet(1))),this.FTableView.UpdateTableView(!1))},this.SetText=function(t){this.FText!==t&&(this.FText=t,null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.Invalidate())},this.GetFill=function(){var e=null;return e=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(e=t.TTMSFNCTableViewHeader.isPrototypeOf(this)?this.FTableView.FTreeView.FColumnsAppearance.FTopFill:this.FTableView.FTreeView.FColumnsAppearance.FBottomFill),e},this.GetHeight=function(){var e=0;return e=30,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(e=t.TTMSFNCTableViewHeader.isPrototypeOf(this)?this.FTableView.FTreeView.FColumnsAppearance.FTopSize:this.FTableView.FTreeView.FColumnsAppearance.FBottomSize),e},this.GetStroke=function(){var e=null;return e=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(e=t.TTMSFNCTableViewHeader.isPrototypeOf(this)?this.FTableView.FTreeView.FColumnsAppearance.FTopStroke:this.FTableView.FTreeView.FColumnsAppearance.FBottomStroke),e},this.SetFill=function(e){null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t.TTMSFNCTableViewHeader.isPrototypeOf(this)?this.FTableView.FTreeView.FColumnsAppearance.FTopFill.Assign(e):this.FTableView.FTreeView.FColumnsAppearance.FBottomFill.Assign(e))},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t,null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.Invalidate())},this.SetHeight=function(e){null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t.TTMSFNCTableViewHeader.isPrototypeOf(this)?this.FTableView.FTreeView.FColumnsAppearance.SetTopSize(e):this.FTableView.FTreeView.FColumnsAppearance.SetBottomSize(e))},this.SetStroke=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FColumnsAppearance.FTopStroke.Assign(t)},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.Invalidate())},this.GetFont=function(){var e=null;return e=null,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(e=t.TTMSFNCTableViewHeader.isPrototypeOf(this)?this.FTableView.FTreeView.FColumnsAppearance.FTopFont:this.FTableView.FTreeView.FColumnsAppearance.FBottomFont),e},this.SetFont=function(e){null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t.TTMSFNCTableViewHeader.isPrototypeOf(this)?this.FTableView.FTreeView.FColumnsAppearance.FTopFill.Assign(e):this.FTableView.FTreeView.FColumnsAppearance.FBottomFill.Assign(e))},this.SetTrimming=function(t){this.FTrimming!==t&&(this.FTrimming=t,null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.Invalidate())},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.Invalidate())},this.GetSortIndicatorColor=function(){var t=0;return t=16297243,null!=this.FTableView&&null!=this.FTableView.FTreeView&&(t=this.FTableView.FTreeView.FColumnsAppearance.FSortIndicatorColor),t},this.SetSortIndicatorColor=function(t){null!=this.FTableView&&null!=this.FTableView.FTreeView&&this.FTableView.FTreeView.FColumnsAppearance.SetSortIndicatorColor(t)},this.Assign=function(e){t.TTMSFNCTableViewHeaderFooter.isPrototypeOf(e)&&(this.SetVisible(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).GetVisible()),this.SetText(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).FText),this.GetFill().Assign(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).GetFill()),this.GetFont().Assign(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).GetFont()),this.GetStroke().Assign(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).GetStroke()),this.SetHorizontalTextAlign(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).FHorizontalTextAlign),this.SetVerticalTextAlign(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).FVerticalTextAlign),this.SetWordWrapping(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).FWordWrapping),this.SetTrimming(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).FTrimming),this.SetHeight(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).GetHeight()),this.SetSortIndicatorColor(rtl.as(e,t.TTMSFNCTableViewHeaderFooter).GetSortIndicatorColor()))},this.Create$1=function(e){return this.FTableView=e,null!=this.FTableView&&this.FTableView.IsDesignTime()&&(t.TTMSFNCTableViewHeader.isPrototypeOf(this)?this.FText="Header":this.FText="Footer",this.GetFill().SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(249,249,249)),this.GetFill().SetKind(1),this.GetStroke().SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(178,178,178)),this.GetStroke().SetKind(1)),this}})),rtl.createClass(this,"TTMSFNCTableViewHeader",this.TTMSFNCTableViewHeaderFooter,(function(){var t=this.$rtti;t.addProperty("Visible",3,rtl.boolean,"GetVisible","SetVisible",{Default:!0}),t.addProperty("Text",2,rtl.string,"FText","SetText"),t.addProperty("Fill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetFill","SetFill"),t.addProperty("Font",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"GetFont","SetFont"),t.addProperty("Stroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetStroke","SetStroke"),t.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),t.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),t.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!1}),t.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttNone}),t.addProperty("Height",3,rtl.double,"GetHeight","SetHeight")})),rtl.createClass(this,"TTMSFNCTableViewFooter",this.TTMSFNCTableViewHeaderFooter,(function(){var t=this.$rtti;t.addProperty("Visible",3,rtl.boolean,"GetVisible","SetVisible",{Default:!0}),t.addProperty("Text",2,rtl.string,"FText","SetText"),t.addProperty("Fill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetFill","SetFill"),t.addProperty("Font",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"GetFont","SetFont"),t.addProperty("Stroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetStroke","SetStroke"),t.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),t.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),t.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!1}),t.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttNone}),t.addProperty("Height",3,rtl.double,"GetHeight","SetHeight")})),rtl.createClass(this,"TTMSFNCTableViewCopyItems",this.TTMSFNCTableViewItems,(function(){})),this.$rtti.$MethodVar("TTMSFNCTableViewItemAnchorClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem],["AAnchor",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewBeforeDrawItemTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCTableViewItem],["AText",rtl.string],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewAfterDrawItemTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCTableViewItem],["AText",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewItemSelectedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewItemUnSelectedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewItemClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewItemMouseEnterEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewItemMouseLeaveEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewItemCheckChangedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewScrollEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["APosition",rtl.double]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewBeforeDrawItemIconEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCTableViewItem],["AIcon",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewAfterDrawItemIconEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCTableViewItem],["AIcon",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewBeforeDrawItemCheckEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCTableViewItem],["ACheck",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewAfterDrawItemCheckEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCTableViewItem],["ACheck",pas["WEBLib.TMSFNCTypes"].$rtti.TTMSFNCBitmap]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewBeforeDrawItemEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCTableViewItem],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewAfterDrawItemEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCTableViewItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewItemCompareEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Item1",this.$rtti.TTMSFNCTableViewItem],["Item2",this.$rtti.TTMSFNCTableViewItem],["ACompareResult",rtl.longint,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewCategoryCompareEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Category1",this.$rtti.TTMSFNCTableViewCategory],["Category2",this.$rtti.TTMSFNCTableViewCategory],["ACompareResult",rtl.longint,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewGetHTMLTemplateValueEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem],["AName",rtl.string],["AValue",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewGetHTMLTemplateEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem],["AHTMLTemplate",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewAnchorHeaderFooterClick",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AAnchor",rtl.string]]),methodkind:0}),this.TTMSFNCTableViewFilterOperation={0:"tvfoSHORT",tvfoSHORT:0,1:"tvfoNONE",tvfoNONE:1,2:"tvfoAND",tvfoAND:2,3:"tvfoXOR",tvfoXOR:3,4:"tvfoOR",tvfoOR:4},this.$rtti.$Enum("TTMSFNCTableViewFilterOperation",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TTMSFNCTableViewFilterOperation}),rtl.createClass(this,"TTMSFNCTableViewFilterData",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FCondition="",this.FCaseSensitive=!1,this.FSuffix="",this.FPrefix="",this.FOperation=0},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FCaseSensitive=!0,this},this.Assign=function(e){var i;null!=(i=rtl.as(e,t.TTMSFNCTableViewFilterData))&&(this.FCondition=i.FCondition,this.FCaseSensitive=i.FCaseSensitive,this.FPrefix=i.FPrefix,this.FSuffix=i.FSuffix,this.FOperation=i.FOperation)};var e=this.$rtti;e.addProperty("Condition",0,rtl.string,"FCondition","FCondition"),e.addProperty("CaseSensitive",0,rtl.boolean,"FCaseSensitive","FCaseSensitive",{Default:!0}),e.addProperty("Prefix",0,rtl.string,"FPrefix","FPrefix"),e.addProperty("Suffix",0,rtl.string,"FSuffix","FSuffix"),e.addProperty("Operation",0,t.$rtti.TTMSFNCTableViewFilterOperation,"FOperation","FOperation")})),rtl.createClass(this,"TTMSFNCTableViewFilter",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FOwner$1=null},this.$final=function(){this.FOwner$1=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return pas.Classes.TCollection.GetItem.call(this,t)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TTMSFNCTableViewFilterData),this.FOwner$1=e,this},this.Add$1=function(){var t=null;return t=pas.Classes.TCollection.Add.call(this),1===this.GetCount()?t.FOperation=1:t.FOperation=2,t}})),this.$rtti.$MethodVar("TTMSFNCTableViewBeforeApplyFilterEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AFilter",this.$rtti.TTMSFNCTableViewFilterData],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewAfterApplyFilterEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AFilter",this.$rtti.TTMSFNCTableViewFilterData]]),methodkind:0}),rtl.createClass(this,"TTMSFNCTreeViewTableViewFloatingNodes",pas.contnrs.TObjectList,(function(){this.GetItem$1=function(t){return this.GetItem(t)}})),this.$rtti.$Class("TTMSFNCTableViewMoreOption"),rtl.createClass(this,"TTMSFNCTreeViewTableView",pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView,(function(){this.$init=function(){pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$init.call(this),this.FDownMoreOption=null,this.FMoreOffset=0,this.FMoreOffsetTo=0,this.FMoreOffsetItem=null,this.FDownAction=!1,this.FDownCount=0,this.FDownTimer=!1,this.FDownX$1=0,this.FDownY$1=0,this.FAnimTimer=null,this.FAnimateMoreOptions=!1,this.FAnimateMoreOptionsClose=!1,this.FMouseDownOnAccessory=!1,this.FAnimMarqueeSwitch=!1,this.FAnimMarqueeStartAngle=0,this.FAnimMarqueeSweepAngle=0,this.FAnimShiftAngle=0,this.FManualProgressSweepAngle=0,this.FManualProgressStartAngle=0,this.FReloadActive=!1,this.FMouseDownOnLookupBar=!1,this.FTableView=null,this.FFloatingNodes=null,this.FOnFooterAnchorClick=null,this.FOnHeaderAnchorClick=null},this.$final=function(){this.FDownMoreOption=void 0,this.FMoreOffsetItem=void 0,this.FAnimTimer=void 0,this.FTableView=void 0,this.FFloatingNodes=void 0,this.FOnFooterAnchorClick=void 0,this.FOnHeaderAnchorClick=void 0,pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$final.call(this)},this.AnimateTimerChanged=function(t){var i=0,s=0,n=!1;this.FAnimateMoreOptions||this.FAnimateMoreOptionsClose?(s=this.FMoreOffset,this.FInteraction.FAnimationFactor>0?(i=Math.abs(this.FMoreOffsetTo-s)/this.FInteraction.FAnimationFactor,n=e.AnimateDouble({get:function(){return s},set:function(t){s=t}},{p:this,get:function(){return this.p.FMoreOffsetTo},set:function(t){this.p.FMoreOffsetTo=t}},i,.01)):n=!1,n?this.FMoreOffset=s:(this.FMoreOffset=this.FMoreOffsetTo,this.FAnimTimer.SetEnabled(!1),this.FAnimateMoreOptionsClose&&(this.FMoreOffsetItem=null,this.FAnimateMoreOptionsClose=!1)),null!=this.FTableView&&this.FTableView.UpdateTableView(!0)):this.FDownTimer?(this.FDownCount+=1,50===this.FDownCount&&(this.FDownAction=!0,this.FAnimTimer.SetEnabled(!1),null!=this.FTableView&&this.FTableView.ToggleEditMode())):(this.FAnimShiftAngle=this.FAnimShiftAngle+5,360===this.FAnimShiftAngle&&(this.FAnimShiftAngle=0),this.FAnimMarqueeSwitch?(this.FAnimMarqueeStartAngle=this.FAnimMarqueeStartAngle+10,this.FAnimMarqueeSweepAngle=this.FAnimMarqueeSweepAngle-10):this.FAnimMarqueeSweepAngle=this.FAnimMarqueeSweepAngle+10,360===this.FAnimMarqueeSweepAngle&&0===this.FAnimMarqueeStartAngle?this.FAnimMarqueeSwitch=!0:360===this.FAnimMarqueeStartAngle&&0===this.FAnimMarqueeSweepAngle&&(this.FAnimMarqueeSwitch=!1,this.FAnimMarqueeStartAngle=0),this.Invalidate())},this.OffsetNodeRects=function(t,e,i,s){null!=this.FFloatingNodes?this.FFloatingNodes.IndexOf$1(t)>-1?pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.OffsetNodeRects.call(this,t,e,Math.max(0,i),s):this.FMoreOffsetItem===this.FTableView.GetItemForNode(t)?pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.OffsetNodeRects.call(this,t,e-this.FMoreOffset,i,s):pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.OffsetNodeRects.apply(this,arguments):pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.OffsetNodeRects.apply(this,arguments)},this.CustomizeNodeCache=function(t,e){var i=null,s=0,n=0;pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.CustomizeNodeCache.apply(this,arguments),null!=this.FTableView&&0===this.FTableView.FUpdateCount$1&&0!==this.FTableView.FCategoryType&&(n=this.FTableView.GetDisplayCategoryIndex(this.StartRow()))>-1&&(this.FFloatingNodes.Clear(),(i=pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewVirtualNode.$create("Create$1",[this])).CopyFrom(this.GetNodeForRow(n)),s=0,this.ConfigureNode(t,0,i,{get:function(){return s},set:function(t){s=t}}),this.FFloatingNodes.Add$1(i))},this.CustomizeScrollPosition=function(t,e,i){pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.CustomizeScrollPosition.apply(this,arguments),this.FFloatingNodes.GetCount()>0&&!t.FExtended&&(e.set(e.get()-this.FFloatingNodes.GetItem$1(0).FHeight),i.set(i.get()-this.FFloatingNodes.GetItem$1(0).FHeight))},this.DrawLookupBar=function(e,i){var s=0,n=t.TTMSFNCTableViewLookupBarDisplayItem.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(null!=this.FTableView&&this.FTableView.FLookupBar.FVisible&&0!==this.FTableView.FCategoryType){o.$assign(this.GetLookupBarRect()),this.FMouseDownOnLookupBar?(e.FFill.Assign(this.FTableView.FLookupBar.FDownFill),e.FStroke.Assign(this.FTableView.FLookupBar.FDownStroke)):(e.FFill.Assign(this.FTableView.FLookupBar.FFill),e.FStroke.Assign(this.FTableView.FLookupBar.FStroke)),e.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),2);for(var r=0,a=this.FTableView.FLookupBarDisplayList.GetCount()-1;r<=a;r++)s=r,n.$assign(this.FTableView.FLookupBarDisplayList.GetItem(s)),n.Active?e.FFont.Assign(this.FTableView.FLookupBar.FFont):e.FFont.Assign(this.FTableView.FLookupBar.FInActiveFont),e.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(n.Rect),n.Text,!1,0,0,0,0,-1,-1,!0,!1,-1,-1)}},this.DrawReload=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=0;if(null!=this.FTableView&&this.FTableView.FReload.FEnabled&&this.FReloadActive){i.$assign(this.GetNodesRect()),s=this.FTableView.FReload.FSize,i.$assign(pas["WEBLib.TMSFNCTypes"].RectF(i.Left+(i.Right-i.Left-s)/2,i.Top+(this.FTableView.FReload.FOffset-s)/2,i.Left+(i.Right-i.Left-s)/2+s,i.Top+(this.FTableView.FReload.FOffset-s)/2+s)),t.FStroke.Assign(this.FTableView.FReload.FStroke);var n=this.FTableView.FReload.FProgressMode;0===n?t.DrawArc(pas["WEBLib.TMSFNCTypes"].CenterPointEx(i),pas["WEBLib.TMSFNCTypes"].PointF((i.Right-i.Left)/2,(i.Bottom-i.Top)/2),this.FAnimMarqueeStartAngle,this.FAnimMarqueeSweepAngle):1===n?t.DrawArc(pas["WEBLib.TMSFNCTypes"].CenterPointEx(i),pas["WEBLib.TMSFNCTypes"].PointF((i.Right-i.Left)/2,(i.Bottom-i.Top)/2),this.FAnimShiftAngle+this.FAnimMarqueeStartAngle,this.FAnimMarqueeSweepAngle):2===n&&t.DrawArc(pas["WEBLib.TMSFNCTypes"].CenterPointEx(i),pas["WEBLib.TMSFNCTypes"].PointF((i.Right-i.Left)/2,(i.Bottom-i.Top)/2),this.FManualProgressStartAngle,this.FManualProgressSweepAngle)}},this.HandleMouseUp=function(t,e,i,s){var n=!1,o=null,r="";return null!=this.FDownMoreOption&&(o=this.FDownMoreOption,this.FDownMoreOption=null,this.Invalidate(),this.FAnimateMoreOptions)?(this.FAnimateMoreOptions=!1,this.FAnimateMoreOptionsClose=!0,this.FMoreOffsetTo=0,this.FAnimTimer.SetEnabled(!0),pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.HandleMouseUp.apply(this,arguments),this.FBlockMouseClick=!1,void(null!=this.FTableView&&null!=this.FMoreOffsetItem&&null!=o&&this.FTableView.DoItemMoreOptionClick(this.FMoreOffsetItem,o))):this.FDownTimer&&!this.FAnimateMoreOptions&&!this.FAnimateMoreOptionsClose&&(this.FDownCount=0,this.FDownTimer=!1,this.FAnimTimer.SetEnabled(!1),this.FDownAction)?(this.FDownAction=!1,this.FBlockUserInput=!0,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.HandleMouseUp.apply(this,arguments),this.FIsMouseDown=!1,void(this.FBlockUserInput=!1)):(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.HandleMouseUp.apply(this,arguments),n=!1,this.FMouseDownOnLookupBar&&(this.ReleaseCaptureEx(),this.ProcessLookup(i,s,!1),n=!0),this.FMouseDownOnAccessory&&(this.ReleaseCaptureEx(),null!=this.FTableView&&(null!=this.FTableView.FActiveAccessoryItem&&this.FTableView.DoItemAccessoryClick(this.FTableView.FActiveAccessoryItem),this.FTableView.FActiveAccessoryItem=null),n=!0),n&&(this.FMouseDownOnAccessory=!1,this.FMouseDownOnLookupBar=!1,this.FBlockUserInput=!1),""!==(r=this.XYToFooterAnchor(i,s))?this.DoFooterAnchorClick(r):""!==(r=this.XYToHeaderAnchor(i,s))&&this.DoHeaderAnchorClick(r),void this.Invalidate())},this.HandleMouseDown=function(t,e,i,s){var n=null;return null!=this.FTableView&&(this.FDownMoreOption=this.FTableView.XYToMoreOption(i,s),null!=this.FDownMoreOption)?(this.FBlockUserInput=!0,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.HandleMouseDown.apply(this,arguments),this.FBlockUserInput=!1,void this.Invalidate()):this.FAnimateMoreOptions?(this.FAnimateMoreOptions=!1,this.FAnimateMoreOptionsClose=!0,this.FMoreOffsetTo=0,this.FAnimTimer.SetEnabled(!0),pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.HandleMouseDown.apply(this,arguments),void(this.FBlockMouseClick=!1)):void(this.FBlockUserInput?pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.HandleMouseDown.apply(this,arguments):(n=null,this.FMouseDownOnLookupBar=pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetLookupBarRect(),pas["WEBLib.TMSFNCTypes"].PointF(i,s)),this.FMouseDownOnLookupBar||null==this.FTableView||this.IsAnimating()||(n=this.FTableView.XYToAccessoryItem(i,s),this.FMouseDownOnAccessory=null!=n),this.FBlockUserInput=this.FMouseDownOnLookupBar||this.FMouseDownOnAccessory,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.HandleMouseDown.apply(this,arguments),this.FMouseDownOnLookupBar&&(this.CaptureEx(),this.StopAnimationTimer(),this.ProcessLookup(i,s,!0),this.Invalidate()),this.FMouseDownOnAccessory&&(this.CaptureEx(),this.StopAnimationTimer(),null!=this.FTableView&&(this.FTableView.FActiveAccessoryItem=n),this.Invalidate()),this.FDownX$1=i,this.FDownY$1=s,this.FMouseDownOnAccessory||this.FMouseDownOnLookupBar||null==this.FTableView||!this.FTableView.FInteraction.FLongPressToEdit||(this.FDownAction=!1,this.FDownTimer=!0,this.FDownCount=0,this.FAnimTimer.SetEnabled(!0))))},this.HandleMouseMove=function(t,e,i){var s=0;pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.HandleMouseMove.apply(this,arguments),s=this.FCursor,!this.FDownTimer||this.FAnimateMoreOptions||this.FAnimateMoreOptionsClose||(Math.abs(e-this.FDownX$1)>5||Math.abs(i-this.FDownY$1)>5)&&(this.FDownAction=!1,this.FDownCount=0,this.FDownTimer=!1,this.FAnimTimer.SetEnabled(!1)),null!=this.FTableView&&this.FTableView.FMoreOptions.GetCount()>0&&this.FTableView.FInteraction.FSwipeToShowMoreOptions&&null==this.FMoreOffsetItem&&this.FIsMouseDown&&!this.FBlockUserInput&&!this.FBlockMouseClick&&Math.abs(e-this.FDownX$1)>30&&Math.abs(i-this.FDownY$1)<=5&&(this.FMoreOffsetItem=this.FTableView.XYToItem(e,i),null!=this.FMoreOffsetItem&&this.FMoreOffsetItem.FEnableMoreOptions&&(this.FMoreOffsetTo=this.FTableView.GetMoreOptionsSize(),this.FBlockMouseClick=!0,this.FAnimateMoreOptions=!0,this.FAnimTimer.SetEnabled(!0))),(""!==this.XYToHeaderAnchor(e,i)||""!==this.XYToFooterAnchor(e,i))&&(s=21),s!==this.FCursor&&this.SetControlCursor(s),this.FMouseDownOnLookupBar&&this.ProcessLookup(e,i,!0)},this.HandleKeyDown=function(t,e){if(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.HandleKeyDown.apply(this,arguments),!this.FBlockUserInput&&null!=this.FTableView&&t.get()in rtl.createSet(27)&&this.FTableView.FFilterActive){var i=this.FTableView.FInteraction.FKeyboardEscapeMode;0===i||(1===i?(this.FTableView.FFilterActive=!1,this.FTableView.StartFiltering()):2===i&&this.FTableView.StopFiltering())}},this.ProcessLookup=function(t,e,i){var s=0,n="",o=0,r=0;if(null!=this.FTableView){var a=this.FTableView.FCategoryType;if(4===a)(s=this.GetCategoryAtXY(t,e))>-1&&s<this.FTableView.FCategories.GetCount()&&(o=this.FTableView.FCategories.GetItem$1(s).FID$1,this.FTableView.FCustomChar.IsIDActive(o)&&(i?this.FTableView.LookupCustomCategory(o):null!=this.FTableView.FOnCategoryClick&&this.FTableView.FOnCategoryClick(this,"",o)));else if(1===a||2===a||3===a){s=0;for(var l=0,h=this.FTableView.FLookupBarDisplayList.GetCount()-1;l<=h;l++)if(r=l,pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.FTableView.FLookupBarDisplayList.GetItem(r).Rect,pas["WEBLib.TMSFNCTypes"].PointF(t,e))){s=r+1;break}s>=1&&s<=this.FTableView.GetCharacterCount()&&null!=this.FTableView&&""!==(n=this.FTableView.GetCharacter(s))&&(i?this.FTableView.LookupCategory(n):null!=this.FTableView.FOnCategoryClick&&this.FTableView.FOnCategoryClick(this,n,-1))}}},this.StartReload=function(){pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.StartReload.call(this),this.FReloadActive=!0,this.FBlockUserInput=!0,null!=this.FTableView&&(this.FManualProgressSweepAngle=0,this.FManualProgressStartAngle=0,this.FAnimTimer.SetEnabled(2!==this.FTableView.FReload.FProgressMode),this.FTableView.DoStartReload())},this.UpdateCheckState=function(e,i,s){var n=t.TTMSFNCTableViewDisplayItem.$new();if(pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewData.UpdateCheckState.apply(this,arguments),null!=this.FTableView&&e.FRow>=0&&e.FRow<=this.FTableView.FDisplayList.GetCount()-1){n.$assign(this.FTableView.FDisplayList.GetItem(e.FRow));var o=n.Kind;1===o&&(null!=n.Item&&(n.Item.FChecked=s),this.FTableView.SelectAllCheckedItems())}},this.ScrollLimitation=function(){return!0,!0},this.NeedsReload=function(t){var e=!1;return e=pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.NeedsReload.call(this,t),null==this.FTableView||!this.FTableView.FReload.FEnabled||null!=this.FTableView.FActiveDetailControl||this.FTableView.FEditMode||this.FTableView.FFilterActive||(e=t>=this.FTableView.FReload.FOffset),e},this.GetReloadOffset=function(){var t=0;return t=pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.GetReloadOffset.call(this),null!=this.FTableView&&this.FTableView.FReload.FEnabled&&(t+=this.FTableView.FReload.FOffset),t},this.GetNodesRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=0;if(t.$assign(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.GetNodesRect.call(this)),null!=this.FTableView){if(e=t.Right-t.Left-this.FTableView.FDetailControlOffset,this.FTableView.FLookupBar.FVisible&&0!==this.FTableView.FCategoryType){var i=this.FTableView.FLookupBar.FPosition;0===i?(t.Left=t.Left+this.FTableView.FLookupBar.FWidth-1,t.Right=t.Right-this.FTableView.FLookupBar.FWidth-1):1===i&&(t.Right=t.Right-this.FTableView.FLookupBar.FWidth)}t.Left=t.Left-e,t.Right=t.Right-e}return t},this.GetContentRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.GetContentRect.call(this)),null!=this.FTableView&&this.FTableView.FFilterActive&&(t.Top=t.Top+this.FTableView.FEdit.GetHeight()),t},this.GetCategoryAtXY=function(t,e){var i=0,s=0,n=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r="",a=0,l=null,h=pas["WEBLib.TMSFNCTypes"].TRectF.$new();if(i=-1,null==this.FTableView)return i;(l=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene();try{l.FFont.Assign(this.FTableView.FLookupBar.FFont),n=this.FTableView.FCategories.GetCount()-1,h.$assign(this.GetLookupBarRect()),a=h.Top+3;for(var F=0,p=n;F<=p;F++)if(s=F,r=this.FTableView.FCategories.GetItem$1(s).FLookupText,o.Left=h.Left,o.Right=h.Right,o.Top=a,o.Bottom=o.Top+l.CalculateTextHeight$1(r),a=a+(o.Bottom-o.Top)+3,pas["WEBLib.TMSFNCTypes"].PtInRectEx(o,pas["WEBLib.TMSFNCTypes"].PointF(t,e))){i=s;break}}finally{l.EndScene(),l=rtl.freeLoc(l)}return i},this.GetLookupBarRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),e=0,i=0;if(t.$assign(pas["WEBLib.TMSFNCTypes"].EmptyRect()),null!=this.FTableView&&this.FTableView.FLookupBar.FVisible&&0!==this.FTableView.FCategoryType){e=this.FTableView.FLookupBar.FWidth,t.$assign(this.GetContentRect()),i=t.Right-t.Left-this.FTableView.FDetailControlOffset;var s=this.FTableView.FLookupBar.FPosition;0===s?(t.Right=t.Left+e,t.Left=t.Left+1,t.Top=t.Top+1,t.Bottom=t.Bottom-1):1===s&&(t.Left=t.Right-e,t.Top=t.Top+1,t.Bottom=t.Bottom-1,t.Right=t.Right-1),t.Left=t.Left-i,t.Right=t.Right-i}return t},this.GetContentClipRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.GetContentRect.call(this)),t.Left=t.Left+1,t.Right=t.Right-1,t},this.CanApplyVerticalOffset=function(){var t=!1;return t=!1,null!=this.FTableView&&null!=this.FTableView.FInteraction&&(t=this.FTableView.FInteraction.FSwipeBounceGesture),t},this.XYToHeaderAnchor=function(t,e){var i="",s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=null;i="",s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.GetWidth(),this.FTableView.FHeader.GetHeight())),(n=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),n.FBitmapContainer=this.GetBitmapContainer(),n.FFont.Assign(this.FTableView.FHeader.GetFont());try{i=n.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FTableView.FHeader.FText,this.FTableView.FHeader.FWordWrapping,this.FTableView.FHeader.FHorizontalTextAlign,this.FTableView.FHeader.FVerticalTextAlign,this.FTableView.FHeader.FTrimming,0,-1,-1,!0,!0,t,e)}finally{n.EndScene(),n=rtl.freeLoc(n)}return i},this.XYToFooterAnchor=function(t,e){var i="",s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=null;i="",s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,this.GetHeight()-this.FTableView.FFooter.GetHeight(),this.GetWidth(),this.GetHeight())),(n=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),n.FBitmapContainer=this.GetBitmapContainer(),n.FFont.Assign(this.FTableView.FFooter.GetFont());try{i=n.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FTableView.FFooter.FText,this.FTableView.FFooter.FWordWrapping,this.FTableView.FFooter.FHorizontalTextAlign,this.FTableView.FFooter.FVerticalTextAlign,this.FTableView.FFooter.FTrimming,0,-1,-1,!0,!0,t,e)}finally{n.EndScene(),n=rtl.freeLoc(n)}return i},this.DoHeaderAnchorClick=function(t){null!=this.FOnHeaderAnchorClick?this.FOnHeaderAnchorClick(this,t):this.FInteraction.FAutoOpenURL&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(t)},this.DoFooterAnchorClick=function(t){null!=this.FOnFooterAnchorClick?this.FOnFooterAnchorClick(this,t):this.FInteraction.FAutoOpenURL&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(t)},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.Create$1.apply(this,arguments),this.FAnimMarqueeStartAngle=0,this.FManualProgressSweepAngle=0,this.FManualProgressStartAngle=0,this.FAnimMarqueeSweepAngle=0,this.FMoreOffset=0,this.FMoreOffsetTo=0,this.FAnimMarqueeSwitch=!1,this.FFloatingNodes=t.TTMSFNCTreeViewTableViewFloatingNodes.$create("Create$2"),this.FAnimTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FAnimTimer.SetEnabled(!1),this.FAnimTimer.SetInterval(1),this.FAnimTimer.FOnTimer=rtl.createCallback(this,"AnimateTimerChanged"),this},this.Destroy=function(){rtl.free(this,"FAnimTimer"),rtl.free(this,"FFloatingNodes"),pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.Destroy.call(this)},this.Draw=function(t,e){pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.Draw.apply(this,arguments),this.DrawLookupBar(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e)),this.DrawReload(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))},this.GetTotalColumnNodeWidth=function(){var t=0;return t=pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.GetTotalColumnNodeWidth.call(this),null!=this.FTableView&&this.FTableView.FLookupBar.FVisible&&0!==this.FTableView.FCategoryType&&(t-=this.FTableView.FLookupBar.FWidth),t},this.GetColumnWidth=function(t){var e=0;return e=pas["WEBLib.TMSFNCTreeViewBase"].TTMSFNCTreeViewBase.GetColumnWidth.call(this,t),null!=this.FTableView&&this.FTableView.FLookupBar.FVisible&&0!==this.FTableView.FCategoryType&&(e-=this.FTableView.FLookupBar.FWidth),e},rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),this.TTMSFNCTableViewDisplayItemKind={0:"tvikNone",tvikNone:0,1:"tvikItem",tvikItem:1,2:"tvikCategory",tvikCategory:2},rtl.recNewT(this,"TTMSFNCTableViewDisplayItem",(function(){this.Kind=0,this.Item=null,this.CategoryID=0,this.Row=0,this.Text="",this.$eq=function(t){return this.Kind===t.Kind&&this.Item===t.Item&&this.CategoryID===t.CategoryID&&this.Row===t.Row&&this.Text===t.Text},this.$assign=function(t){return this.Kind=t.Kind,this.Item=t.Item,this.CategoryID=t.CategoryID,this.Row=t.Row,this.Text=t.Text,this}})),rtl.createClass(this,"TTMSFNCTableViewDisplayList",pas.Classes.TList,(function(){this.GetItem=function(e){var i=t.TTMSFNCTableViewDisplayItem.$new();return i.$assign(rtl.getObject(this.Get(e))),i}})),rtl.recNewT(this,"TTMSFNCTableViewLookupBarDisplayItem",(function(){this.Text="",this.Active=!1,this.$new=function(){var t=Object.create(this);return t.Rect=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),t},this.$eq=function(t){return this.Rect.$eq(t.Rect)&&this.Text===t.Text&&this.Active===t.Active},this.$assign=function(t){return this.Rect.$assign(t.Rect),this.Text=t.Text,this.Active=t.Active,this}})),rtl.createClass(this,"TTMSFNCTableViewLookupBarDisplayList",pas.Classes.TList,(function(){this.GetItem=function(e){var i=t.TTMSFNCTableViewLookupBarDisplayItem.$new();return i.$assign(rtl.getObject(this.Get(e))),i}})),this.TTMSFNCTableViewLookupBarPosition={0:"tvlbpLeft",tvlbpLeft:0,1:"tvlbpRight",tvlbpRight:1},this.$rtti.$Enum("TTMSFNCTableViewLookupBarPosition",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCTableViewLookupBarPosition}),rtl.createClass(this,"TTMSFNCTableViewLookupBar",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTableView=null,this.FVisible=!1,this.FFont=null,this.FAutoLookup=!1,this.FFill=null,this.FStroke=null,this.FWidth=0,this.FPosition=0,this.FDownFill=null,this.FDownStroke=null,this.FInActiveFont=null},this.$final=function(){this.FTableView=void 0,this.FFont=void 0,this.FFill=void 0,this.FStroke=void 0,this.FDownFill=void 0,this.FDownStroke=void 0,this.FInActiveFont=void 0,pas.Classes.TPersistent.$final.call(this)},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,null!=this.FTableView&&this.FTableView.UpdateTableView(!1))},this.SetFont=function(t){this.FFont.Assign(t)},this.SetAutoLookup=function(t){this.FAutoLookup=t},this.SetFill=function(t){this.FFill.Assign(t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.IsWidthStored=function(){return 25!==this.FWidth},this.SetPosition=function(t){this.FPosition!==t&&(this.FPosition=t,null!=this.FTableView&&this.FTableView.UpdateTableView(!1))},this.SetWidth=function(t){this.FWidth!==t&&(this.FWidth=t,null!=this.FTableView&&this.FTableView.UpdateTableView(!1))},this.SetDownFill=function(t){this.FDownFill.Assign(t)},this.SetDownStroke=function(t){this.FDownStroke.Assign(t)},this.SetInActiveFont=function(t){this.FInActiveFont.Assign(t)},this.FontChanged=function(t){null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.StrokeChanged=function(t){null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.FillChanged=function(t){null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.Create$1=function(t){return this.FTableView=t,this.FWidth=25,this.FVisible=!0,this.FPosition=1,this.FAutoLookup=!0,this.FFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FInActiveFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),null!=this.FTableView&&this.FTableView.IsDesignTime()&&this.FInActiveFont.SetColor(12632256),this.FInActiveFont.FOnChanged=rtl.createCallback(this,"FontChanged"),this.FFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,16777215,8421504,-1,-1]),this.FFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,16777215]),this.FStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this.FDownFill=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFill.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(249,249,249),8421504,-1,-1]),this.FDownFill.FOnChanged=rtl.createCallback(this,"FillChanged"),this.FDownStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(249,249,249)]),this.FDownStroke.FOnChanged=rtl.createCallback(this,"StrokeChanged"),this},this.Destroy=function(){rtl.free(this,"FFont"),rtl.free(this,"FInActiveFont"),rtl.free(this,"FFill"),rtl.free(this,"FStroke"),rtl.free(this,"FDownFill"),rtl.free(this,"FDownStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCTableViewLookupBar.isPrototypeOf(e)&&(this.FVisible=rtl.as(e,t.TTMSFNCTableViewLookupBar).FVisible,this.FFont.Assign(rtl.as(e,t.TTMSFNCTableViewLookupBar).FFont),this.FInActiveFont.Assign(rtl.as(e,t.TTMSFNCTableViewLookupBar).FInActiveFont),this.FStroke.Assign(rtl.as(e,t.TTMSFNCTableViewLookupBar).FStroke),this.FFill.Assign(rtl.as(e,t.TTMSFNCTableViewLookupBar).FFill),this.FAutoLookup=rtl.as(e,t.TTMSFNCTableViewLookupBar).FAutoLookup,this.FWidth=rtl.as(e,t.TTMSFNCTableViewLookupBar).FWidth,this.FPosition=rtl.as(e,t.TTMSFNCTableViewLookupBar).FPosition,this.FDownFill.Assign(rtl.as(e,t.TTMSFNCTableViewLookupBar).FDownFill),this.FDownStroke.Assign(rtl.as(e,t.TTMSFNCTableViewLookupBar).FDownStroke))};var e=this.$rtti;e.addProperty("Width",14,rtl.double,"FWidth","SetWidth",{stored:"IsWidthStored"}),e.addProperty("Position",2,t.$rtti.TTMSFNCTableViewLookupBarPosition,"FPosition","SetPosition",{Default:t.TTMSFNCTableViewLookupBarPosition.tvlbpRight}),e.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont","SetFont"),e.addProperty("InActiveFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FInActiveFont","SetInActiveFont"),e.addProperty("AutoLookup",2,rtl.boolean,"FAutoLookup","SetAutoLookup",{Default:!0}),e.addProperty("Fill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FFill","SetFill"),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("DownFill",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"FDownFill","SetDownFill"),e.addProperty("DownStroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FDownStroke","SetDownStroke")})),this.TTMSFNCTableViewReloadProgressMode={0:"tvrpmMarquee",tvrpmMarquee:0,1:"tvrpmMarqueeAlternate",tvrpmMarqueeAlternate:1,2:"tvrpmManual",tvrpmManual:2},this.$rtti.$Enum("TTMSFNCTableViewReloadProgressMode",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TTMSFNCTableViewReloadProgressMode}),rtl.createClass(this,"TTMSFNCTableViewReload",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FTableView=null,this.FOffset=0,this.FEnabled=!1,this.FStroke=null,this.FSize=0,this.FProgressMode=0},this.$final=function(){this.FTableView=void 0,this.FStroke=void 0,pas.Classes.TPersistent.$final.call(this)},this.IsOffsetStored=function(){return 40!==this.FOffset},this.SetOffset=function(t){this.FOffset!==t&&(this.FOffset=t)},this.SetEnabled=function(t){this.FEnabled!==t&&(this.FEnabled=t)},this.SetStroke=function(t){this.FStroke.Assign(t)},this.IsSizeStored=function(){return 20!==this.FSize},this.SetSize=function(t){this.FSize!==t&&(this.FSize=t)},this.SetProgressMode=function(t){this.FProgressMode!==t&&(this.FProgressMode=t)},this.Create$1=function(t){return this.FTableView=t,this.FOffset=40,this.FSize=20,this.FEnabled=!1,this.FProgressMode=0,this.FStroke=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsStroke.$create("Create$1",[1,11119017]),null!=this.FTableView&&this.FTableView.IsDesignTime()&&this.FStroke.SetWidth(2),this},this.Destroy=function(){rtl.free(this,"FStroke"),pas.System.TObject.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCTableViewReload.isPrototypeOf(e)&&(this.FOffset=rtl.as(e,t.TTMSFNCTableViewReload).FOffset,this.FSize=rtl.as(e,t.TTMSFNCTableViewReload).FSize,this.FEnabled=rtl.as(e,t.TTMSFNCTableViewReload).FEnabled,this.FStroke.Assign(rtl.as(e,t.TTMSFNCTableViewReload).FStroke),this.FProgressMode=rtl.as(e,t.TTMSFNCTableViewReload).FProgressMode)};var e=this.$rtti;e.addProperty("Offset",14,rtl.double,"FOffset","SetOffset",{stored:"IsOffsetStored"}),e.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!1}),e.addProperty("Stroke",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"FStroke","SetStroke"),e.addProperty("Size",14,rtl.double,"FSize","SetSize",{stored:"IsSizeStored"}),e.addProperty("ProgressMode",2,t.$rtti.TTMSFNCTableViewReloadProgressMode,"FProgressMode","SetProgressMode",{Default:t.TTMSFNCTableViewReloadProgressMode.tvrpmMarquee})})),rtl.createClass(this,"TTMSFNCTableViewCategory",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FTableView=null,this.FText="",this.FID$1=0,this.FLookupText=""},this.$final=function(){this.FTableView=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.Changed$1())},this.SetId=function(t){this.FID$1!==t&&(this.FID$1=t,this.Changed$1())},this.SetLookupText=function(t){this.FLookupText!==t&&(this.FLookupText=t,this.Changed$1())},this.Changed$1=function(){null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FTableView=rtl.as(this.FCollection,t.TTMSFNCTableViewCategories).FTableView,this.FID$1=rtl.as(this.FCollection,t.TTMSFNCTableViewCategories).GetCount()-1,null!=this.FTableView&&this.FTableView.UpdateTableView(!1),this},this.Destroy=function(){pas.Classes.TCollectionItem.Destroy.call(this),null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.Assign=function(e){t.TTMSFNCTableViewCategory.isPrototypeOf(e)&&(this.FText=rtl.as(e,t.TTMSFNCTableViewCategory).FText,this.FLookupText=rtl.as(e,t.TTMSFNCTableViewCategory).FLookupText,this.FID$1=rtl.as(e,t.TTMSFNCTableViewCategory).FID$1,this.Changed$1())};var e=this.$rtti;e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("LookupText",2,rtl.string,"FLookupText","SetLookupText"),e.addProperty("ID",2,rtl.longint,"FID$1","SetId")})),rtl.createClass(this,"TTMSFNCTableViewCategories",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FTableView=null},this.$final=function(){this.FTableView=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TTMSFNCTableViewCategory),this.FTableView=e,this},this.ItemById=function(t){var e=null,i=0;e=null;for(var s=0,n=this.GetCount()-1;s<=n;s++)if(i=s,this.GetItem$1(i).FID$1===t){e=this.GetItem$1(i);break}return e},this.ItemIndexById=function(t){var e=null;return null!=(e=this.ItemById(t))?e.GetIndex():-1}})),rtl.createClass(this,"TTMSFNCTableViewMoreOption",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FTableView=null,this.FText="",this.FWidth=0,this.FColor=0,this.FFontColor=0,this.FBorderColor=0},this.$final=function(){this.FTableView=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.Changed$1())},this.IsWidthStored=function(){return 60!==this.FWidth},this.SetWidth=function(t){this.FWidth!==t&&(this.FWidth=t,this.Changed$1())},this.SetColor=function(t){this.FColor!==t&&(this.FColor=t,this.Changed$1())},this.SetFontColor=function(t){this.FFontColor!==t&&(this.FFontColor=t,this.Changed$1())},this.SetBorderColor=function(t){this.FBorderColor!==t&&(this.FBorderColor=t,this.Changed$1())},this.Changed$1=function(){null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.Create$1=function(e){return pas.Classes.TCollectionItem.Create$1.apply(this,arguments),this.FTableView=rtl.as(this.FCollection,t.TTMSFNCTableViewMoreOptions).FTableView,this.FWidth=60,this.FColor=-1,this.FBorderColor=-1,this.FFontColor=-1,null!=this.FTableView&&this.FTableView.UpdateTableView(!1),this},this.Destroy=function(){pas.Classes.TCollectionItem.Destroy.call(this),null!=this.FTableView&&this.FTableView.UpdateTableView(!1)},this.Assign=function(e){t.TTMSFNCTableViewMoreOption.isPrototypeOf(e)&&(this.FText=rtl.as(e,t.TTMSFNCTableViewMoreOption).FText,this.FWidth=rtl.as(e,t.TTMSFNCTableViewMoreOption).FWidth,this.FColor=rtl.as(e,t.TTMSFNCTableViewMoreOption).FColor,this.FBorderColor=rtl.as(e,t.TTMSFNCTableViewMoreOption).FBorderColor,this.FFontColor=rtl.as(e,t.TTMSFNCTableViewMoreOption).FFontColor)};var e=this.$rtti;e.addProperty("Text",2,rtl.string,"FText","SetText"),e.addProperty("Width",14,rtl.double,"FWidth","SetWidth",{stored:"IsWidthStored"}),e.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti.TColor,"FColor","SetColor",{Default:-1}),e.addProperty("BorderColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FBorderColor","SetBorderColor",{Default:-1}),e.addProperty("FontColor",2,pas["WEBLib.Graphics"].$rtti.TColor,"FFontColor","SetFontColor",{Default:-1})})),rtl.createClass(this,"TTMSFNCTableViewMoreOptions",pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection,(function(){this.$init=function(){pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$init.call(this),this.FTableView=null},this.$final=function(){this.FTableView=void 0,pas["WEBLib.TMSFNCTypes"].TTMSFNCOwnedCollection.$final.call(this)},this.GetItem$1=function(t){return this.GetItem(t)},this.Create$3=function(e){return pas.Classes.TOwnedCollection.Create$2.call(this,e,t.TTMSFNCTableViewMoreOption),this.FTableView=e,this}})),this.TTMSFNCTableViewCategoryType={0:"tvctNone",tvctNone:0,1:"tvctAlphaBetic",tvctAlphaBetic:1,2:"tvctAlphaNumericFirst",tvctAlphaNumericFirst:2,3:"tvctAlphaNumericLast",tvctAlphaNumericLast:3,4:"tvctCustom",tvctCustom:4},this.$rtti.$Enum("TTMSFNCTableViewCategoryType",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TTMSFNCTableViewCategoryType}),this.$rtti.$MethodVar("TTMSFNCTableViewLookupCategoryEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ACharacter",rtl.string],["ACharacterID",rtl.longint]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewDrawItemCustomAccessoryEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AItem",this.$rtti.TTMSFNCTableViewItem]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewItemMoreOptionClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem],["AMoreOption",this.$rtti.TTMSFNCTableViewMoreOption]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewBeforeItemShowDetailControl",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem],["ADetailControl",pas["WEBLib.Controls"].$rtti.TControl],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewBeforeItemHideDetailControl",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem],["ADetailControl",pas["WEBLib.Controls"].$rtti.TControl],["AAllow",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewItemShowDetailControl",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem],["ADetailControl",pas["WEBLib.Controls"].$rtti.TControl]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCTableViewItemHideDetailControl",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AItem",this.$rtti.TTMSFNCTableViewItem],["ADetailControl",pas["WEBLib.Controls"].$rtti.TControl]]),methodkind:0}),rtl.createClass(this,"TTMSFNCTableViewCustomChar",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FID=0,this.FActive=!1},this.Create$1=function(t,e){return this.FID=t,this.FActive=e,this}})),rtl.createClass(this,"TTMSFNCTableViewCustomCharList",pas.contnrs.TObjectList,(function(){this.GetItem$1=function(t){return this.GetItem(t)},this.ActivateID=function(t){for(var e=0,i=0,s=this.GetCount()-1;i<=s;i++)if(e=i,this.GetItem$1(e).FID===t){this.GetItem$1(e).FActive=!0;break}},this.IsIDActive=function(t){var e=!1,i=0;e=!1;for(var s=0,n=this.GetCount()-1;s<=n;s++)if(i=s,this.GetItem$1(i).FID===t){e=this.GetItem$1(i).FActive;break}return e}})),rtl.createClass(this,"TTMSFNCTableViewEdit",pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit,(function(){this.$init=function(){pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit.$init.call(this),this.FTableView=null},this.$final=function(){this.FTableView=void 0,pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit.$final.call(this)},this.KeyDown=function(t,e){if(pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit.KeyDown.apply(this,arguments),null!=this.FTableView&&t.get()in rtl.createSet(27)&&this.FTableView.FFilterActive){var i=this.FTableView.FInteraction.FKeyboardEscapeMode;0===i||(1===i?(this.FTableView.FFilterActive=!1,this.FTableView.StartFiltering()):2===i&&this.FTableView.StopFiltering())}},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCCustomTableView",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FFirstLoad=!1,this.FFilterActive=!1,this.FEditMode=!1,this.FDoneButton=null,this.FEditButton=null,this.FBackButton=null,this.FFilterButton=null,this.FEdit=null,this.FActiveAccessoryItem=null,this.FDetailControlTimer=null,this.FDetailControlOffset=0,this.FShowDetailControl=!1,this.FActiveDetailControl=null,this.FActiveDetailItem=null,this.FCustomChar=null,this.FLookupBarDisplayList=null,this.FFilterApplied=!1,this.FUpdateCount$1=0,this.FDisplayList=null,this.FCategoryList=null,this.FSaveSelectedItem=0,this.FSaveSelectedItems=[],this.FCopyItems=null,this.FAccepted=!1,this.FItems=null,this.FTreeView=null,this.FColumn=null,this.FDefaultItem=null,this.FItemAppearance=null,this.FOnItemSelected=null,this.FInteraction=null,this.FHeader=null,this.FFooter=null,this.FOnItemAnchorClick=null,this.FOnAfterCutToClipboard=null,this.FOnBeforePasteFromClipboard=null,this.FOnAfterReorderItem=null,this.FOnBeforeDropItem=null,this.FOnBeforeDrawItemText=null,this.FOnVScroll=null,this.FOnBeforeCopyToClipboard=null,this.FOnItemDblClick=null,this.FOnBeforeDrawItemCheck=null,this.FOnAfterDrawItemIcon=null,this.FOnBeforeDrawItem=null,this.FOnAfterPasteFromClipboard=null,this.FOnItemClick=null,this.FOnAfterDropItem=null,this.FOnAfterDrawItemText=null,this.FOnItemCompare=null,this.FOnBeforeCutToClipboard=null,this.FOnBeforeReorderItem=null,this.FOnNeedFilterDropDownData=null,this.FOnAfterCopyToClipboard=null,this.FOnFilterSelect=null,this.FOnAfterDrawItemCheck=null,this.FOnAfterDrawItem=null,this.FOnBeforeDrawItemIcon=null,this.FFilter=null,this.FOnBeforeDrawSortIndicator=null,this.FOnAfterDrawSortIndicator=null,this.FOnGetHTMLTemplateValue=null,this.FOnGetHTMLTemplate=null,this.FCategoryType=0,this.FCategories=null,this.FOnCategoryCompare=null,this.FLookupBar=null,this.FOnManualLookupCategory=null,this.FOnCategoryClick=null,this.FReload=null,this.FOnStopReload=null,this.FOnStartReload=null,this.FOnDrawItemCustomAccessory=null,this.FOnItemAccessoryClick=null,this.FCategoryAppearance=null,this.FOnItemCheckChanged=null,this.FOnAfterApplyFilter=null,this.FOnBeforeApplyFilter=null,this.FMoreOptions=null,this.FMoreOptionAppearance=null,this.FOnItemMoreOptionClick=null,this.FOnAfterDrawItemMoreOption=null,this.FOnBeforeDrawItemMoreOption=null,this.FOnItemShowDetailControl=null,this.FOnItemHideDetailControl=null,this.FOnBeforeItemShowDetailControl=null,this.FOnBeforeItemHideDetailControl=null,this.FOnItemSelectionChanged=null,this.FOnItemUnSelected=null,this.FOnAfterDrawItemTitle=null,this.FOnBeforeDrawItemTitle=null,this.FOnItemMouseLeave=null,this.FOnItemMouseEnter=null,this.FOnFooterAnchorClick=null,this.FOnHeaderAnchorClick=null,this.FOnItemTitleAnchorClick=null,this.FGlobalFont=null},this.$final=function(){this.FDoneButton=void 0,this.FEditButton=void 0,this.FBackButton=void 0,this.FFilterButton=void 0,this.FEdit=void 0,this.FActiveAccessoryItem=void 0,this.FDetailControlTimer=void 0,this.FActiveDetailControl=void 0,this.FActiveDetailItem=void 0,this.FCustomChar=void 0,this.FLookupBarDisplayList=void 0,this.FDisplayList=void 0,this.FCategoryList=void 0,this.FSaveSelectedItems=void 0,this.FCopyItems=void 0,this.FItems=void 0,this.FTreeView=void 0,this.FColumn=void 0,this.FDefaultItem=void 0,this.FItemAppearance=void 0,this.FOnItemSelected=void 0,this.FInteraction=void 0,this.FHeader=void 0,this.FFooter=void 0,this.FOnItemAnchorClick=void 0,this.FOnAfterCutToClipboard=void 0,this.FOnBeforePasteFromClipboard=void 0,this.FOnAfterReorderItem=void 0,this.FOnBeforeDropItem=void 0,this.FOnBeforeDrawItemText=void 0,this.FOnVScroll=void 0,this.FOnBeforeCopyToClipboard=void 0,this.FOnItemDblClick=void 0,this.FOnBeforeDrawItemCheck=void 0,this.FOnAfterDrawItemIcon=void 0,this.FOnBeforeDrawItem=void 0,this.FOnAfterPasteFromClipboard=void 0,this.FOnItemClick=void 0,this.FOnAfterDropItem=void 0,this.FOnAfterDrawItemText=void 0,this.FOnItemCompare=void 0,this.FOnBeforeCutToClipboard=void 0,this.FOnBeforeReorderItem=void 0,this.FOnNeedFilterDropDownData=void 0,this.FOnAfterCopyToClipboard=void 0,this.FOnFilterSelect=void 0,this.FOnAfterDrawItemCheck=void 0,this.FOnAfterDrawItem=void 0,this.FOnBeforeDrawItemIcon=void 0,this.FFilter=void 0,this.FOnBeforeDrawSortIndicator=void 0,this.FOnAfterDrawSortIndicator=void 0,this.FOnGetHTMLTemplateValue=void 0,this.FOnGetHTMLTemplate=void 0,this.FCategories=void 0,this.FOnCategoryCompare=void 0,this.FLookupBar=void 0,this.FOnManualLookupCategory=void 0,this.FOnCategoryClick=void 0,this.FReload=void 0,this.FOnStopReload=void 0,this.FOnStartReload=void 0,this.FOnDrawItemCustomAccessory=void 0,this.FOnItemAccessoryClick=void 0,this.FCategoryAppearance=void 0,this.FOnItemCheckChanged=void 0,this.FOnAfterApplyFilter=void 0,this.FOnBeforeApplyFilter=void 0,this.FMoreOptions=void 0,this.FMoreOptionAppearance=void 0,this.FOnItemMoreOptionClick=void 0,this.FOnAfterDrawItemMoreOption=void 0,this.FOnBeforeDrawItemMoreOption=void 0,this.FOnItemShowDetailControl=void 0,this.FOnItemHideDetailControl=void 0,this.FOnBeforeItemShowDetailControl=void 0,this.FOnBeforeItemHideDetailControl=void 0,this.FOnItemSelectionChanged=void 0,this.FOnItemUnSelected=void 0,this.FOnAfterDrawItemTitle=void 0,this.FOnBeforeDrawItemTitle=void 0,this.FOnItemMouseLeave=void 0,this.FOnItemMouseEnter=void 0,this.FOnFooterAnchorClick=void 0,this.FOnHeaderAnchorClick=void 0,this.FOnItemTitleAnchorClick=void 0,this.FGlobalFont=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetItems=function(t){this.FItems.Assign(t)},this.SetDefaultItem=function(t){this.FDefaultItem.Assign(t)},this.SetItemAppearance=function(t){this.FItemAppearance.Assign(t)},this.GetItemIndex=function(){var t=0,e=null;return t=-1,null!=this.FTreeView&&this.FTreeView.SelectedVirtualNodeCount()>0&&null!=this.FTreeView.GetSelVirtualNode(0)&&(null!=(e=this.GetItemForNode(this.FTreeView.GetFocusedVirtualNode()))?t=e.GetIndex():-1!==this.FSaveSelectedItem&&(t=this.FSaveSelectedItem)),t},this.SetItemIndex=function(t){this.SelectItem(t)},this.SetInteraction=function(t){this.FInteraction.Assign(t)},this.GetBitmapContainer=function(){var t=null;return t=null,null!=this.FTreeView&&(t=this.FTreeView.GetBitmapContainer()),t},this.SetBitmapContainer=function(t){this.FTreeView.SetBitmapContainer(t)},this.SetHeader=function(t){this.FHeader.Assign(t)},this.SetFooter=function(t){this.FFooter.Assign(t)},this.GetSelectedItem=function(){var t=null;return t=null,this.GetItemIndex()>=0&&this.GetItemIndex()<=this.FItems.GetCount()-1&&(t=this.FItems.GetItem$1(this.GetItemIndex())),t},this.SetSelectedItem=function(t){null!=t&&this.SetItemIndex(t.GetIndex())},this.GetSelItem=function(t){var e=null;return e=null,null!=this.FTreeView&&(e=this.GetItemForNode(this.FTreeView.GetSelVirtualNode(t))),e},this.GetVerticalScrollBarVisible=function(){var t=!1;return t=!1,null!=this.FTreeView&&(t=this.FTreeView.FVerticalScrollBarVisible),t},this.SetVerticalScrollBarVisible=function(t){null!=this.FTreeView&&this.FTreeView.SetVerticalScrollBarVisible(t)},this.GetFill=function(){var t=null;return t=null,null!=this.FTreeView&&(t=this.FTreeView.FFill),t},this.GetStroke=function(){var t=null;return t=null,null!=this.FTreeView&&(t=this.FTreeView.FStroke),t},this.SetFill$1=function(t){null!=this.FTreeView&&this.FTreeView.FFill.Assign(t)},this.SetStroke$1=function(t){null!=this.FTreeView&&this.FTreeView.FStroke.Assign(t)},this.SetCategoryType=function(t){this.FCategoryType!==t&&(this.FCategoryType=t,this.UpdateTableView(!1))},this.SetCategories=function(t){this.FCategories.Assign(t)},this.SetLookupBar=function(t){this.FLookupBar.Assign(t)},this.SetReload=function(t){this.FReload.Assign(t)},this.SetCategoryAppearance=function(t){this.FCategoryAppearance.Assign(t)},this.SetMoreOptions=function(t){this.FMoreOptions.Assign(t)},this.SetMoreOptionAppearance=function(t){this.FMoreOptionAppearance.Assign(t)},this.SetGlobalFont=function(t){this.FGlobalFont.Assign(t)},this.GetVersion=function(){return this.$class.GetVersionNumber(1,0,1,0)},this.GetItemsRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return t.$assign(pas["WEBLib.TMSFNCTypes"].EmptyRect()),null!=this.FTreeView&&t.$assign(this.FTreeView.GetNodesRect()),t},this.CreateTreeView=function(){return t.TTMSFNCTreeViewTableView.$create("Create$1",[this])},this.CreateItems=function(){return t.TTMSFNCTableViewItems.$create("Create$3",[this])},this.GetRowForItemIndex=function(e){var i=0,s=0,n=t.TTMSFNCTableViewDisplayItem.$new();i=-1;for(var o=0,r=this.FDisplayList.GetCount()-1;o<=r;o++)if(s=o,n.$assign(this.FDisplayList.GetItem(s)),null!=n.Item&&null!=n.Item.FCollection&&n.Item.GetIndex()===e&&1===n.Kind){i=n.Item.FRow;break}return i},this.GetDisplayCategoryIndex=function(t){var e=0,i=0;e=-1;for(var s=this.FDisplayList.GetCount()-1;s>=0;s--)if(i=s,2===this.FDisplayList.GetItem(i).Kind&&i<=t){e=i;break}return e},this.GetItemIndexForNode=function(t){var e=0,i=0;if(e=-1,null!=t)for(var s=0,n=this.FDisplayList.GetCount()-1;s<=n;s++)if(i=s,this.FDisplayList.GetItem(i).Row===t.FRow&&null!=this.FDisplayList.GetItem(i).Item&&null!=this.FDisplayList.GetItem(i).Item.FCollection){e=this.FDisplayList.GetItem(i).Item.GetIndex();break}return e},this.GetItemForNode=function(t){var e,i=null;return i=null,(e=this.GetItemIndexForNode(t))>=0&&e<=this.FItems.GetCount()-1&&(i=this.FItems.GetItem$1(e)),i},this.GetNodeForItemIndex=function(t){var e=null;return e=null,null!=this.FTreeView&&(e=this.FTreeView.GetNodeForRow(this.GetRowForItemIndex(t))),e},this.HTMLReplace=function(t,e){var i="",s="",n="",o="",r="",a=0,l=0;if(i="",null==e)return i;for(s="";pas.System.Pos("<#",t)>0&&pas.System.Pos(">",t)>0;)a=pas.System.Pos("<#",t),s+=pas.System.Copy(t,1,a-1),n=pas.System.Copy(t,a,t.length),l=pas.System.Pos(">",n),o=pas.System.Copy(n,1,l-1),pas.System.Delete({get:function(){return o},set:function(t){o=t}},1,2),pas.System.Delete({get:function(){return t},set:function(e){t=e}},1,a+l-1),r=e.FHTMLTemplateItems.GetValue(o),this.DoGetHTMLTemplateValue(e,o,{get:function(){return r},set:function(t){r=t}}),s+=r;return i=s+t},this.ItemFromDifferentCategory=function(t,e){var i=!1,s="",n="";if(i=!1,null===t||null===e)i=!0;else{var o=this.FCategoryType;1===o||2===o||3===o?(s=t.GetStrippedHTMLText(),n=e.GetStrippedHTMLText(),i=s.length>0&&n.length>0?s.charAt(0)!==n.charAt(0):0!==s.length||0!==n.length):4===o&&(i=t.FCategoryID>-1&&e.FCategoryID>-1?t.FCategoryID!==e.FCategoryID:!(-1===t.FCategoryID&&-1===e.FCategoryID))}return i},this.MatchFilter=function(t){var e=!1,i=0,s="",n=!1;e=!0;for(var o=1,r=this.FFilter.GetCount();o<=r;o++){i=o;var a=this.FFilter.GetItem$1(i-1);s=t.GetStrippedHTMLText(),s=pas.SysUtils.Trim(s),""!==a.FPrefix&&1===pas.System.Pos(a.FPrefix,s)&&pas.System.Delete({get:function(){return s},set:function(t){s=t}},1,this.FFilter.GetItem$1(i-1).FPrefix.length),""!==a.FSuffix&&pas.System.Pos(a.FSuffix,s)===1+s.length-a.FSuffix.length&&pas.System.Delete({get:function(){return s},set:function(t){s=t}},1+s.length-a.FSuffix.length,s.length),n=!0;try{""!==this.FFilter.GetItem$1(i-1).FCondition&&(n=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.MatchStrEx(a.FCondition,s,a.FCaseSensitive))}catch(t){n=!1}var l=this.FFilter.GetItem$1(i-1).FOperation;if(0===l){if(!(e=n))break}else 1===l?e=n:2===l?e=e&&n:4===l?e=e||n:3===l&&(e^=n)}return e},this.GetCharacterForItem=function(t){var e="",i="",s=0;e="";var n=this.FCategoryType;return 2===n||3===n||1===n?e=(i=t.GetStrippedHTMLText()).length>0?i.charAt(0):"":4===n&&(s=this.FCategories.ItemIndexById(t.FCategoryID))>=0&&s<=this.FCategories.GetCount()-1&&(e=this.FCategories.GetItem$1(s).FText),e},this.GetCharacter=function(t){return"",3===this.FCategoryType||1===this.FCategoryType?t<27?String.fromCharCode(t-1+65):String.fromCharCode(t-27+48):t<11?String.fromCharCode(t-1+48):String.fromCharCode(t-11+65)},this.GetCharacterCount=function(){var t=0;return t=26,2!==this.FCategoryType&&3!==this.FCategoryType||(t=36),t},this.FindCategoryWithCharacter=function(e){var i=t.TTMSFNCTableViewDisplayItem.$new(),s=0,n=t.TTMSFNCTableViewDisplayItem.$new();i.Kind=0,i.Item=null,i.CategoryID=-1,i.Text="";for(var o=0,r=this.FCategoryList.GetCount()-1;o<=r;o++)if(s=o,n.$assign(this.FCategoryList.GetItem(s)),n.Text===e){i.$assign(n);break}return i},this.FindCategoryWithCharacterID=function(e){var i=t.TTMSFNCTableViewDisplayItem.$new(),s=0,n=t.TTMSFNCTableViewDisplayItem.$new();i.Kind=0,i.Item=null,i.CategoryID=-1,i.Text="";for(var o=0,r=this.FCategoryList.GetCount()-1;o<=r;o++)if(s=o,n.$assign(this.FCategoryList.GetItem(s)),n.CategoryID===e){i.$assign(n);break}return i},this.FindFirstItemWithCategory=function(t){var e=null,i=0;e=null;for(var s=0,n=this.FItems.GetCount()-1;s<=n;s++)if(i=s,this.GetCharacterForItem(this.FItems.GetItem$1(i))===t){e=this.FItems.GetItem$1(i);break}return e},this.FindFirstItemWithCategoryID=function(t){var e=null,i=0;e=null;for(var s=0,n=this.FItems.GetCount()-1;s<=n;s++)if(i=s,this.FItems.GetItem$1(i).FCategoryID===t){e=this.FItems.GetItem$1(i);break}return e},this.GetMoreOptionsSize=function(){var t=0,e=0;t=0;for(var i=0,s=this.FMoreOptions.GetCount()-1;i<=s;i++)e=i,t+=this.FMoreOptions.GetItem$1(e).FWidth;return t},this.IsAppearanceProperty=function(t,e,i){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.IsAppearanceProperty.call(this,t,e,i)||"Header"===e||"Footer"===e},this.DoEnter=function(){pas["WEBLib.Controls"].TControl.DoEnter.call(this),null!=this.FTreeView&&this.FTreeView.GetAllowFocus()&&this.FTreeView.SetFocus()},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this)},this.DoItemMoreOptionClick=function(t,e){null!=this.FOnItemMoreOptionClick&&this.FOnItemMoreOptionClick(this,t,e)},this.DoFilterButtonClicked=function(t){this.StartFiltering()},this.DoEditButtonClicked=function(t){this.StartEditMode()},this.DoEditChange=function(t){var e=null;this.RemoveFilters(),(e=this.FFilter.Add$1()).FCaseSensitive=!1,e.FCondition="*"+this.FEdit.GetT()+"*",this.DoBeforeApplyFilter(e,!0),this.ApplyFilter(),this.DoAfterApplyFilter(e)},this.DoBeforeApplyFilter=function(t,e){null!=this.FOnBeforeApplyFilter&&this.FOnBeforeApplyFilter(this,t,{get:function(){return e},set:function(t){e=t}})},this.DoAfterApplyFilter=function(t){null!=this.FOnAfterApplyFilter&&this.FOnAfterApplyFilter(this,t)},this.DoDoneButtonClicked=function(t){this.StopEditMode(),this.StopFiltering()},this.DoBackButtonClicked=function(t){this.HideDetailControl()},this.DoItemAccessoryClick=function(t){null!=this.FOnItemAccessoryClick&&this.FOnItemAccessoryClick(this,t)},this.DoDetailControlTimer=function(t){var i=0,s=0,n=!1,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new();null!=this.FActiveDetailControl&&null!=this.FTreeView?(this.FShowDetailControl?(o.$assign(this.FTreeView.GetContentRect()),s=o.Right-o.Left):s=0,this.FTreeView.FInteraction.FAnimationFactor>0?(i=Math.abs(this.FDetailControlOffset-s)/this.FTreeView.FInteraction.FAnimationFactor,n=e.AnimateDouble({p:this,get:function(){return this.p.FDetailControlOffset},set:function(t){this.p.FDetailControlOffset=t}},{get:function(){return s},set:function(t){s=t}},i,.01)):n=!1,n||(this.FDetailControlOffset=s,this.FShowDetailControl=!this.FShowDetailControl,this.FShowDetailControl?this.DoItemShowDetailControl(this.FActiveDetailItem,this.FActiveDetailControl):(this.DoItemHideDetailControl(this.FActiveDetailItem,this.FActiveDetailControl),this.FActiveDetailControl.SetVisible(!1),this.FActiveDetailControl.SetParent(null),this.FActiveDetailControl=null,this.FActiveDetailItem=null),this.FDetailControlTimer.SetEnabled(!1)),this.UpdateTableView(!0),this.UpdateActiveDetailControl()):this.FDetailControlTimer.SetEnabled(!1)},this.DoItemShowDetailControl=function(t,e){null!=this.FOnItemShowDetailControl&&this.FOnItemShowDetailControl(this,t,e)},this.DoItemHideDetailControl=function(t,e){null!=this.FOnItemHideDetailControl&&this.FOnItemHideDetailControl(this,t,e)},this.DoBeforeItemShowDetailControl=function(t,e,i){null!=this.FOnBeforeItemShowDetailControl&&this.FOnBeforeItemShowDetailControl(this,t,e,i)},this.DoBeforeItemHideDetailControl=function(t,e,i){null!=this.FOnBeforeItemHideDetailControl&&this.FOnBeforeItemHideDetailControl(this,t,e,i)},this.Notification=function(t,e){var i=0;if(pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),!(3 in this.FComponentState)&&1===e){for(var s=0,n=this.FItems.GetCount()-1;s<=n;s++)i=s,t===this.FItems.GetItem$1(i).FDetailControl&&(this.FItems.GetItem$1(i).FDetailControl=null);null!=this.FDefaultItem&&t===this.FDefaultItem.FDetailControl&&(this.FDefaultItem.FDetailControl=null)}},this.DoStartReload=function(){null!=this.FOnStartReload&&this.FOnStartReload(this)},this.ScrollToCategoryId=function(e){var i=t.TTMSFNCTableViewDisplayItem.$new(),s=null;null!=this.FTreeView&&(i.$assign(this.FindCategoryWithCharacterID(e)),i.Row>=0&&i.Row<=this.FDisplayList.GetCount()-1&&(s=this.FTreeView).ScrollToVirtualNode(s.GetNodeForRow(i.Row),!0,0,!0))},this.ScrollToCategoryCharacter=function(e){var i=t.TTMSFNCTableViewDisplayItem.$new(),s=null;null!=this.FTreeView&&(i.$assign(this.FindCategoryWithCharacter(e)),i.Row>=0&&i.Row<=this.FDisplayList.GetCount()-1&&(s=this.FTreeView).ScrollToVirtualNode(s.GetNodeForRow(i.Row),!0,0,!0))},this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCCustomTableView)},this.ApplyStyle=function(){var t=0,e=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),e=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return e},set:function(t){e=t}}))for(var i=0,s=this.FItems.GetCount()-1;i<=s;i++)t=i,this.FItems.GetItem$1(t).SetTextColor(e),this.FItems.GetItem$1(t).SetTitleColor(e)},this.UpdateControlAfterResize=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.UpdateControlAfterResize.call(this),null!=this.FTreeView&&this.FTreeView.SetBounds(0,0,this.GetWidth(),this.GetHeight()),this.UpdateTableView(!1),this.UpdateActiveDetailControl()},this.ResetToDefaultStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.BeginUpdate(),this.GetStroke().SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(178,178,178)),this.FHeader.GetFill().SetKind(1),this.FFooter.GetFill().SetKind(1),this.FHeader.GetStroke().SetColor(this.GetStroke().FColor),this.FFooter.GetStroke().SetColor(this.GetStroke().FColor),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(this.FHeader.GetFont(),16,1),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(this.FFooter.GetFont(),16,1),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(this.FHeader.GetFont(),14,1),this.FHeader.GetFont().SetStyle(rtl.createSet(0)),pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.SetFontSize(this.FFooter.GetFont(),14,1),this.FItemAppearance.GetStroke().SetKind(0),this.FHeader.GetFill().SetColor(16380654),this.FHeader.GetFont().SetColor(4539717),this.FFooter.GetFill().SetColor(16380654),this.FFooter.GetFont().SetColor(4539717),this.FItemAppearance.GetSelectedFill().SetColor(16578806),this.FItemAppearance.GetSelectedStroke().SetColor(15702829),this.FItemAppearance.GetFont().SetColor(8026746),this.FItemAppearance.GetSelectedStroke().SetColor(15702829),this.FItemAppearance.SetShowFocus(!1),this.FHeader.SetHeight(this.ScalePaintValue(36));for(var e=0,i=this.FItems.GetCount()-1;e<=i;e++)t=e,this.FItems.GetItem$1(t).SetSelectedTitleColor(this.FHeader.GetFont().FColor),this.FItems.GetItem$1(t).SetTitleColor(this.FHeader.GetFont().FColor),this.FItems.GetItem$1(t).SetSelectedTextColor(this.FHeader.GetFont().FColor),this.FItems.GetItem$1(t).SetTextColor(this.FItemAppearance.GetFont().FColor);this.EndUpdate()},this.SetAdaptToStyle=function(t){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetAdaptToStyle.apply(this,arguments),null!=this.FTreeView&&this.FTreeView.SetAdaptToStyle(this.GetAdaptToStyle())},this.UpdateTableView=function(t){var e=null,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=0,o=!1,r=[],a=[],l=0;if(!(this.FUpdateCount$1>0||this.IsDestroying())&&null!=this.FTreeView){t||this.CalculateItems(),e=this.GetSelectedItem(),r=this.GetSelectedItems(),a=rtl.arraySetLength(a,0,rtl.length(r));for(var h=0,F=rtl.length(r)-1;h<=F;h++)a[l=h]=r[l].GetIndex();if(this.FDetailControlTimer.FEnabled||(this.FShowDetailControl?this.FDetailControlOffset=0:(i.$assign(this.FTreeView.GetContentRect()),this.FDetailControlOffset=i.Right-i.Left)),t?this.FTreeView.UpdateTreeViewDisplay():(this.FTreeView.BeginUpdate(),this.FTreeView.ClearNodeList(),this.FTreeView.EndUpdate()),this.CalculateLookupBar(),this.SetSelectedItem(e),this.SelectItems(rtl.arrayRef(a)),s.$assign(this.FTreeView.GetColumnsTopRect()),o=!1,null!=this.FColumn&&(o=this.FColumn.FExpanded),!this.IsDesignTime()&&this.FFilterActive&&o?this.FEdit.SetParent(this):this.FEdit.SetParent(null),this.FDoneButton.SetVisible(this.FEditMode||this.FFilterActive&&!(null!=this.FActiveDetailControl)&&o),!this.IsDesignTime()&&this.FHeader.GetHeight()>0&&this.FHeader.GetVisible()?this.FDoneButton.SetParent(this):this.FDoneButton.SetParent(null),this.FDoneButton.Invalidate(),this.FBackButton.SetVisible(null!=this.FActiveDetailControl&&(this.FShowDetailControl&&!this.FDetailControlTimer.FEnabled||!this.FShowDetailControl)&&o),!this.IsDesignTime()&&this.FHeader.GetHeight()>0&&this.FHeader.GetVisible()?this.FBackButton.SetParent(this):this.FBackButton.SetParent(null),this.FBackButton.Invalidate(),this.FEditButton.SetVisible(!this.FEditMode&&!this.FFilterActive&&this.FInteraction.FShowEditButton&&!(null!=this.FActiveDetailControl)&&o),!this.IsDesignTime()&&this.FHeader.GetHeight()>0&&this.FHeader.GetVisible()?this.FEditButton.SetParent(this):this.FEditButton.SetParent(null),this.FEditButton.Invalidate(),this.FFilterButton.SetVisible(this.FInteraction.FShowFilterButton&&!this.FFilterActive&&!(null!=this.FActiveDetailControl)&&o),!this.IsDesignTime()&&this.FHeader.GetHeight()>0&&this.FHeader.GetVisible()?this.FFilterButton.SetParent(this):this.FFilterButton.SetParent(null),this.FFilterButton.Invalidate(),this.FBackButton.SetHeight(Math.round(s.Bottom-s.Top-this.ScalePaintValue(4))),this.FDoneButton.SetHeight(Math.round(s.Bottom-s.Top-this.ScalePaintValue(4))),this.FEditButton.SetHeight(Math.round(s.Bottom-s.Top-this.ScalePaintValue(4))),this.FFilterButton.SetHeight(Math.round(s.Bottom-s.Top-this.ScalePaintValue(4))),this.CustomizeButtons(),n=0,null!=this.FColumn&&(this.FColumn.FFiltering.FEnabled&&(n=n+this.FColumn.FFiltering.FButtonSize+this.ScalePaintValue(4)),this.FColumn.FExpandable&&(n=n+this.FColumn.FExpandingButtonSize+this.ScalePaintValue(6)),0!==this.FColumn.FSortKind&&(n=n+this.ScalePaintValue(8)+this.ScalePaintValue(6))),this.FBackButton.SetBounds(Math.round(s.Left+this.ScalePaintValue(3)),Math.round(s.Top+(s.Bottom-s.Top-this.FBackButton.GetHeight())/2),this.FBackButton.GetWidth(),this.FBackButton.GetHeight()),this.FFilterButton.FVisible?(this.FFilterButton.SetBounds(Math.round(s.Right-this.ScalePaintValue(3)-this.FFilterButton.GetWidth()-n),Math.round(s.Top+(s.Bottom-s.Top-this.FFilterButton.GetHeight())/2),this.FFilterButton.GetWidth(),this.FFilterButton.GetHeight()),this.FDoneButton.SetBounds(Math.round(s.Right-this.ScalePaintValue(6)-this.FDoneButton.GetWidth()-this.FFilterButton.GetWidth()-n),Math.round(s.Top+Math.round((s.Bottom-s.Top-this.FDoneButton.GetHeight())/2)),this.FDoneButton.GetWidth(),this.FDoneButton.GetHeight()),this.FEditButton.SetBounds(Math.round(s.Right-this.ScalePaintValue(6)-this.FEditButton.GetWidth()-this.FFilterButton.GetWidth()-n),Math.round(s.Top+Math.round((s.Bottom-s.Top-this.FEditButton.GetHeight())/2)),this.FEditButton.GetWidth(),this.FEditButton.GetHeight())):(this.FDoneButton.SetBounds(Math.round(s.Right-this.ScalePaintValue(3)-this.FDoneButton.GetWidth()-n),Math.round(s.Top+(s.Bottom-s.Top-this.FDoneButton.GetHeight())/2),this.FDoneButton.GetWidth(),this.FDoneButton.GetHeight()),this.FEditButton.SetBounds(Math.round(s.Right-this.ScalePaintValue(3)-this.FEditButton.GetWidth()-n),Math.round(s.Top+(s.Bottom-s.Top-this.FEditButton.GetHeight())/2),this.FEditButton.GetWidth(),this.FEditButton.GetHeight())),this.FLookupBar.FVisible&&0!==this.FCategoryType){var p=this.FLookupBar.FPosition;0===p?this.FEdit.SetBounds(Math.round(s.Left+1+this.FLookupBar.FWidth),Math.round(s.Bottom),Math.round(s.Right-s.Left-this.FLookupBar.FWidth-2),this.FEdit.GetHeight()):1===p&&this.FEdit.SetBounds(Math.round(s.Left+1),Math.round(s.Bottom+1),Math.round(s.Right-s.Left-this.FLookupBar.FWidth-2),this.FEdit.GetHeight())}else this.FEdit.SetBounds(Math.round(s.Left+1),Math.round(s.Bottom),Math.round(s.Right-s.Left-2),this.FEdit.GetHeight());this.FTreeView.Invalidate()}},this.CustomizeButtons=function(){},this.SelectAllCheckedItems=function(){var t=0,e=[];e=rtl.arraySetLength(e,0,0);for(var i=0,s=this.FItems.GetCount()-1;i<=s;i++)t=i,this.FItems.GetItem$1(t).FChecked&&((e=rtl.arraySetLength(e,0,rtl.length(e)+1))[rtl.length(e)-1]=t);this.SelectItems(rtl.arrayRef(e))},this.UnSelectAllItems=function(){null!=this.FTreeView&&this.FTreeView.UnSelectAllNodes()},this.CalculateItems=function(){var t=0,e=0,i=!1,s=null;if(!(this.FUpdateCount$1>0||this.IsDestroying())){this.FDisplayList.Clear(),this.FCategoryList.Clear(),e=0;for(var n=0,o=this.FItems.GetCount()-1;n<=o;n++)t=n,i=(s=this.FItems.GetItem$1(t)).FVisible,this.FFilterApplied&&(i=i&&this.MatchFilter(s)),0!==this.FCategoryType?0===this.FDisplayList.GetCount()||this.ItemFromDifferentCategory(s,this.FItems.GetItem$1(e-1))?(i&&(this.AddDisplayCategory(s),this.AddDisplayItem(s)),e+=1):(i&&this.AddDisplayItem(s),e+=1):i&&this.AddDisplayItem(s)}},this.CalculateLookupBar=function(){var e=0,i=0,s="",n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=t.TTMSFNCTableViewLookupBarDisplayItem.$new(),a=0,l=null,h=0;if(!(this.FUpdateCount$1>0||this.IsDestroying()||null==this.FTreeView)&&(this.FLookupBarDisplayList.Clear(),this.FLookupBar.FVisible&&0!==this.FCategoryType)){o.$assign(this.FTreeView.GetLookupBarRect());var F=this.FCategoryType;if(1===F||2===F||3===F)for(var p=1,c=e=this.GetCharacterCount();p<=c;p++)i=p,s=this.GetCharacter(i),n.Left=o.Left,n.Right=o.Right,n.Top=o.Top+(i-1)*((o.Bottom-o.Top)/e),n.Bottom=n.Top+(o.Bottom-o.Top)/e,r.Rect.$assign(n),r.Text=s,r.Active=null!=this.FindFirstItemWithCategory(s),this.FLookupBarDisplayList.Add(t.TTMSFNCTableViewLookupBarDisplayItem.$clone(r));else if(4===F){this.FCustomChar.Clear();for(var u=0,T=this.FCategories.GetCount()-1;u<=T;u++)i=u,this.FCustomChar.Add$1(t.TTMSFNCTableViewCustomChar.$create("Create$1",[this.FCategories.GetItem$1(i).FID$1,!1]));for(var C=0,S=this.FItems.GetCount()-1;C<=S;C++)i=C,""!==(s=this.FItems.GetItem$1(i).GetStrippedHTMLText())&&(h=this.FItems.GetItem$1(i).FCategoryID,this.FCustomChar.ActivateID(h));l=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0]);try{l.FFont.Assign(this.FLookupBar.FFont),e=this.FCategories.GetCount()-1,a=o.Top+3;for(var d=0,m=e;d<=m;d++)i=d,s=this.FCategories.GetItem$1(i).FLookupText,n.Left=o.Left,n.Right=o.Right,n.Top=a,n.Bottom=n.Top+l.CalculateTextHeight$1(s),a=a+(n.Bottom-n.Top)+3,r.Rect.$assign(n),r.Text=s,r.Active=null!=this.FindFirstItemWithCategoryID(this.FCategories.GetItem$1(i).FID$1),this.FLookupBarDisplayList.Add(t.TTMSFNCTableViewLookupBarDisplayItem.$clone(r))}finally{l=rtl.freeLoc(l)}}}},this.AddDisplayCategory=function(e){var i=t.TTMSFNCTableViewDisplayItem.$new();e.FVisible&&(i.Item=null,i.Kind=2,i.Text=this.GetCharacterForItem(e),i.CategoryID=e.FCategoryID,i.Row=this.FDisplayList.GetCount(),null!=e&&(e.FRow=i.Row),this.FDisplayList.Add(t.TTMSFNCTableViewDisplayItem.$clone(i)),this.FCategoryList.Add(t.TTMSFNCTableViewDisplayItem.$clone(i)))},this.AddDisplayItem=function(e){var i=t.TTMSFNCTableViewDisplayItem.$new();i.CategoryID=-1,i.Item=e,i.Kind=1,i.Text="",i.Row=this.FDisplayList.GetCount(),null!=e&&(e.FRow=i.Row),this.FDisplayList.Add(t.TTMSFNCTableViewDisplayItem.$clone(i))},this.DoClick=function(t){null!=this.FOnClick&&this.FOnClick(this)},this.DoGetNodeHeight=function(e,i,s,n){var o=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){o.$assign(this.FDisplayList.GetItem(i.FRow));var r=o.Kind;1===r?(this.FItemAppearance.FHeight>-1&&n.set(this.FItemAppearance.FHeight),null!=o.Item&&o.Item.FHeight>-1&&n.set(o.Item.FHeight)):2===r&&this.FCategoryAppearance.FHeight>-1&&n.set(this.FCategoryAppearance.FHeight)}},this.DoGetNodeIcon=function(e,i,s,n,o){var r=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){r.$assign(this.FDisplayList.GetItem(i.FRow));var a=r.Kind;1===a&&null!=r.Item&&(null!=this.GetBitmapContainer()&&""!==r.Item.FBitmapName&&o.set(this.GetBitmapContainer().FindBitmap$1(r.Item.FBitmapName)),null==o.get()&&o.set(r.Item.FBitmap))}},this.DoGetNodeSides=function(e,i,s){var n=t.TTMSFNCTableViewDisplayItem.$new(),o=null;null!=this.FTreeView&&i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1&&(n.$assign(this.FDisplayList.GetItem(i.FRow)),this.FTreeView.IsVirtualNodeSelected(i)||2===n.Kind||(this.FTreeView.GetLastVirtualNode()===i?s.set({}):null!=(o=this.FTreeView.GetNextVirtualNode(i))&&o.FRow>=0&&o.FRow<=this.FDisplayList.GetCount()-1&&(n.$assign(this.FDisplayList.GetItem(o.FRow)),1===n.Kind?s.set(rtl.createSet(3)):s.set({}))))},this.DoGetColumnText=function(t,e,i,s){var n=i;1===n?s.set(this.FHeader.FText):2===n&&s.set(this.FFooter.FText)},this.DoGetColumnTrimming=function(t,e,i,s){var n=i;1===n?s.set(this.FHeader.FTrimming):2===n&&s.set(this.FFooter.FTrimming)},this.DoGetColumnWordWrapping=function(t,e,i,s){var n=i;1===n?s.set(this.FHeader.FWordWrapping):2===n&&s.set(this.FFooter.FWordWrapping)},this.DoGetColumnHorizontalTextAlign=function(t,e,i,s){var n=i;1===n?s.set(this.FHeader.FHorizontalTextAlign):2===n&&s.set(this.FFooter.FHorizontalTextAlign)},this.DoGetColumnVerticalTextAlign=function(t,e,i,s){var n=i;1===n?s.set(this.FHeader.FVerticalTextAlign):2===n&&s.set(this.FFooter.FVerticalTextAlign)},this.DoIsNodeChecked=function(e,i,s,n){var o=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){o.$assign(this.FDisplayList.GetItem(i.FRow));var r=o.Kind;1===r&&null!=o.Item&&n.set(o.Item.FChecked)}},this.DoGetNodeCheckType=function(e,i,s,n){var o=t.TTMSFNCTableViewDisplayItem.$new(),r=0;if(this.FEditMode&&i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){o.$assign(this.FDisplayList.GetItem(i.FRow));var a=o.Kind;1===a&&null!=o.Item&&(r=o.Item.FCheckType,n.set(r))}},this.DoAfterCheckNode=function(e,i,s){var n=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){n.$assign(this.FDisplayList.GetItem(i.FRow));var o=n.Kind;1===o&&null!=n.Item&&(n.Item.SetChecked(!0),null!=this.FTreeView&&this.FTreeView.DoAfterSelectNode(i),this.DoItemCheckChanged(n.Item))}},this.DoAfterUnCheckNode=function(e,i,s){var n=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){n.$assign(this.FDisplayList.GetItem(i.FRow));var o=n.Kind;1===o&&null!=n.Item&&(n.Item.SetChecked(!1),null!=this.FTreeView&&this.FTreeView.DoAfterUnSelectNode(i),this.DoItemCheckChanged(n.Item))}},this.DoItemCheckChanged=function(t){null!=this.FOnItemCheckChanged&&this.FOnItemCheckChanged(this,t)},this.DoGetNumberOfNodes=function(t,e,i){-1===e.FLevel&&i.set(this.FDisplayList.GetCount())},this.DoGetHTMLTemplateValue=function(t,e,i){null!=this.FOnGetHTMLTemplateValue&&this.FOnGetHTMLTemplateValue(this,t,e,i)},this.DoGetHTMLTemplate=function(t,e){null!=this.FOnGetHTMLTemplate&&this.FOnGetHTMLTemplate(this,t,e)},this.DoIsNodeExtended=function(e,i,s){var n=t.TTMSFNCTableViewDisplayItem.$new();i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1&&(n.$assign(this.FDisplayList.GetItem(i.FRow)),2===n.Kind&&s.set(!0))},this.DoGetNodeText=function(e,i,s,n,o){var r=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){r.$assign(this.FDisplayList.GetItem(i.FRow));var a=r.Kind;1===a?null!=r.Item&&o.set(r.Item.GetText()):2===a&&o.set(r.Text)}},this.DoGetNodeTitle=function(e,i,s,n,o){var r=t.TTMSFNCTableViewDisplayItem.$new();i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1&&(r.$assign(this.FDisplayList.GetItem(i.FRow)),1===r.Kind&&null!=r.Item&&o.set(r.Item.GetTitle()))},this.DoGetNodeTitleExpanded=function(e,i,s,n){var o=t.TTMSFNCTableViewDisplayItem.$new();i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1&&(o.$assign(this.FDisplayList.GetItem(i.FRow)),1===o.Kind&&null!=o.Item&&n.set(o.Item.FTitleExpanded))},this.DoGetNodeTrimming=function(e,i,s,n){var o=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){o.$assign(this.FDisplayList.GetItem(i.FRow));var r=o.Kind;1===r&&null!=o.Item&&n.set(o.Item.FTrimming)}},this.DoGetNodeTitleTrimming=function(e,i,s,n){var o=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){o.$assign(this.FDisplayList.GetItem(i.FRow));var r=o.Kind;1===r&&null!=o.Item&&n.set(o.Item.FTitleTrimming)}},this.DrawBadge=function(t,e,i){var s,n,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=pas["WEBLib.TMSFNCTypes"].TSizeF.$new(),a=null;if(""!==i.FAccessoryText){t.FFont.Assign(this.FItemAppearance.FAccessoryFont),t.FStroke.Assign(this.FItemAppearance.FAccessoryStroke),t.FFill.Assign(this.FItemAppearance.FAccessoryFill),-1!==i.FAccessoryFontColor&&t.FFont.SetColor(i.FAccessoryFontColor),-1!==i.FAccessoryBorderColor&&t.FStroke.SetColor(i.FAccessoryBorderColor),-1!==i.FAccessoryColor&&t.FFill.SetColor(i.FAccessoryColor),s=i.FAccessoryText,r.$assign(t.CalculateTextSize$1(s)),r.cy=r.cy+4,r.cx=Math.max(r.cy,r.cx+6),o.$assign(e),o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(o.Left+(o.Right-o.Left-r.cx)/2,o.Top+(o.Bottom-o.Top-r.cy)/2,o.Left+(o.Right-o.Left-r.cx)/2+r.cx,o.Top+(o.Bottom-o.Top-r.cy)/2+r.cy)),n=(o.Bottom-o.Top)/2,a=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsPath.$create("Create$1");try{a.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Left+n,o.Top+n),pas["WEBLib.TMSFNCTypes"].PointF(n,n),180,90),a.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Right-n,o.Top+n),pas["WEBLib.TMSFNCTypes"].PointF(n,n),-90,90),a.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Right-n,o.Bottom-n),pas["WEBLib.TMSFNCTypes"].PointF(n,n),0,90),a.AddArc(pas["WEBLib.TMSFNCTypes"].PointF(o.Left+n,o.Bottom-n),pas["WEBLib.TMSFNCTypes"].PointF(n,n),-270,90),a.ClosePath(),t.DrawPath(a,0)}finally{a=rtl.freeLoc(a)}t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o),s,!1,0,0,0,0,-1,-1,!0,!1,-1,-1)}},this.DoDrawNodeExtra=function(e,i,s,n,o){var r=t.TTMSFNCTableViewDisplayItem.$new(),a=null,l=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),h=0,F=0,p=null,c=0,u=!1,T=0,C=0;if(null!=this.FTreeView&&o.FRow>=0&&o.FRow<=this.FDisplayList.GetCount()-1){r.$assign(this.FDisplayList.GetItem(o.FRow));var S=r.Kind;if(1===S&&null!=r.Item){if(this.FTreeView.FMoreOffsetItem===r.Item&&this.FMoreOptions.GetCount()>0){i.FFont.Assign(this.FMoreOptionAppearance.FFont),i.FFill.Assign(this.FMoreOptionAppearance.FFill),i.FStroke.Assign(this.FMoreOptionAppearance.FStroke),c=this.FTreeView.FMoreOffset/this.FMoreOptions.GetCount();for(var d=0,m=this.FMoreOptions.GetCount()-1;d<=m;d++)F=d,-1!==(p=this.FMoreOptions.GetItem$1(F)).FColor&&i.FFill.SetColor(p.FColor),-1!==p.FBorderColor&&i.FStroke.SetColor(p.FBorderColor),-1!==p.FFontColor&&i.FFont.SetColor(p.FFontColor),l.$assign(pas["WEBLib.TMSFNCTypes"].RectF(s.Right-1+c*F,s.Top,s.Right-1+c*(F+1),s.Bottom)),u=!0,this.DoBeforeDrawItemMoreOption(i,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),r.Item,p,{get:function(){return u},set:function(t){u=t}}),u&&(this.FTreeView.FDownMoreOption===p&&(i.FFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(i.FFill.FColor,20)),i.FStroke.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].Lighter(i.FStroke.FColor,20))),i.DrawRectangle$2(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),0),pas["WEBLib.TMSFNCTypes"].InflateRectEx(l,-2,-2),i.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),p.FText,!1,0,0,0,0,-1,-1,!0,!1,-1,-1),this.DoAfterDrawItemMoreOption(i,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),r.Item,p))}if(r.Item.FAccessoryWidth>0&&r.Item.FAccessoryHeight>0){l.$assign(s),r.Item===this.FTreeView.FMoreOffsetItem&&(l.Left=l.Left+this.FTreeView.FMoreOffset),pas["WEBLib.TMSFNCTypes"].InflateRectEx(l,-4,-4),h=r.Item.FAccessoryHeight,l.$assign(pas["WEBLib.TMSFNCTypes"].RectF(l.Left,l.Top+(l.Bottom-l.Top-h)/2,l.Right,l.Top+(l.Bottom-l.Top-h)/2+h)),i.FFont.Assign(this.FItemAppearance.FAccessoryFont),-1!==r.Item.FAccessoryFontColor&&i.FFont.SetColor(r.Item.FAccessoryFontColor);var f=r.Item.FAccessory;1===f?null==(a=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.GetScaledBitmap(this.FItemAppearance.FAccessoryDetailBitmaps,0,this.GetBitmapContainer()))||pas["WEBLib.TMSFNCTypes"].IsBitmapEmpty(a)||i.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),a,!0,!1,!0,!1):2===f?(T=this.FItemAppearance.FAccessoryFill.FColor,-1!==r.Item.FAccessoryColor&&(T=r.Item.FAccessoryColor),C=this.FItemAppearance.FAccessoryFont.FColor,-1!==r.Item.FAccessoryFontColor&&(C=r.Item.FAccessoryFontColor),i.DrawProgressBar(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),r.Item.FAccessoryProgress,"%.0f%%",100,T,C,!0,!0,1)):4===f?this.DrawBadge(i,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),r.Item):3===f?(i.DrawButton(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),r.Item===this.FActiveAccessoryItem,!1,!0,!0,1),i.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),r.Item.FAccessoryText,!1,0,0,0,0,-1,-1,!0,!1,-1,-1)):5===f&&this.DoDrawItemCustomAccessory(i,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(l),r.Item)}}}},this.DoDrawItemCustomAccessory=function(t,e,i){null!=this.FOnDrawItemCustomAccessory&&this.FOnDrawItemCustomAccessory(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoBeforeDrawItemMoreOption=function(t,e,i,s,n){null!=this.FOnBeforeDrawItemMoreOption&&this.FOnBeforeDrawItemMoreOption(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoAfterDrawItemMoreOption=function(t,e,i,s){null!=this.FOnAfterDrawItemMoreOption&&this.FOnAfterDrawItemMoreOption(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s)},this.DoGetNodeWordWrapping=function(e,i,s,n){var o=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){o.$assign(this.FDisplayList.GetItem(i.FRow));var r=o.Kind;1===r&&null!=o.Item&&n.set(o.Item.FWordWrapping)}},this.DoGetNodeTitleWordWrapping=function(e,i,s,n){var o=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){o.$assign(this.FDisplayList.GetItem(i.FRow));var r=o.Kind;1===r&&null!=o.Item&&n.set(o.Item.FTitleWordWrapping)}},this.DoGetNodeExtraSize=function(e,i,s,n){var o=t.TTMSFNCTableViewDisplayItem.$new();if(null!=this.FTreeView&&i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){o.$assign(this.FDisplayList.GetItem(i.FRow));var r=o.Kind;1===r&&(null!=o.Item&&o.Item.FAccessoryWidth>0&&n.set(o.Item.FAccessoryWidth+8),o.Item===this.FTreeView.FMoreOffsetItem&&n.set(n.get()+this.FTreeView.FMoreOffset))}},this.DoGetNodeTitleHorizontalTextAlign=function(e,i,s,n){var o=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){o.$assign(this.FDisplayList.GetItem(i.FRow));var r=o.Kind;1===r&&null!=o.Item&&n.set(o.Item.FTitleHorizontalTextAlign)}},this.DoGetNodeTitleVerticalTextAlign=function(e,i,s,n){var o=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){o.$assign(this.FDisplayList.GetItem(i.FRow));var r=o.Kind;1===r&&null!=o.Item&&n.set(o.Item.FTitleVerticalTextAlign)}},this.DoGetNodeHorizontalTextAlign=function(e,i,s,n){var o=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){o.$assign(this.FDisplayList.GetItem(i.FRow));var r=o.Kind;1===r&&null!=o.Item&&n.set(o.Item.FHorizontalTextAlign)}},this.DoGetNodeVerticalTextAlign=function(e,i,s,n){var o=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){o.$assign(this.FDisplayList.GetItem(i.FRow));var r=o.Kind;1===r&&null!=o.Item&&n.set(o.Item.FVerticalTextAlign)}},this.DoGetNodeTextColor=function(e,i,s,n){var o=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){o.$assign(this.FDisplayList.GetItem(i.FRow));var r=o.Kind;1===r?null!=o.Item&&n.set(o.Item.FTextColor):2===r&&n.set(this.FCategoryAppearance.GetFont().FColor)}},this.DoGetNodeSelectedTextColor=function(e,i,s,n){var o=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){o.$assign(this.FDisplayList.GetItem(i.FRow));var r=o.Kind;1===r&&null!=o.Item&&n.set(o.Item.FSelectedTextColor)}},this.DoGetNodeDisabledTextColor=function(e,i,s,n){var o=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){o.$assign(this.FDisplayList.GetItem(i.FRow));var r=o.Kind;1===r&&null!=o.Item&&n.set(o.Item.FDisabledTextColor)}},this.DoGetNodeTitleColor=function(e,i,s,n){var o=t.TTMSFNCTableViewDisplayItem.$new();i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1&&(o.$assign(this.FDisplayList.GetItem(i.FRow)),1===o.Kind&&null!=o.Item&&n.set(o.Item.FTitleColor))},this.DoGetNodeSelectedTitleColor=function(e,i,s,n){var o=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){o.$assign(this.FDisplayList.GetItem(i.FRow));var r=o.Kind;1===r&&null!=o.Item&&n.set(o.Item.FSelectedTitleColor)}},this.DoGetNodeDisabledTitleColor=function(e,i,s,n){var o=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){o.$assign(this.FDisplayList.GetItem(i.FRow));var r=o.Kind;1===r&&null!=o.Item&&n.set(o.Item.FDisabledTitleColor)}},this.DoIsNodeEnabled=function(e,i,s){var n=t.TTMSFNCTableViewDisplayItem.$new();if(i.FRow>=0&&i.FRow<=this.FDisplayList.GetCount()-1){n.$assign(this.FDisplayList.GetItem(i.FRow));var o=n.Kind;1===o&&null!=n.Item&&s.set(n.Item.FEnabled)}},this.DoAfterSelectNode=function(t,e){null!=this.FOnItemSelected&&this.FOnItemSelected(this,this.GetItemForNode(e)),null!=this.FOnItemSelectionChanged&&this.FOnItemSelectionChanged(this)},this.DoAfterUnSelectNode=function(t,e){null!=this.FOnItemUnSelected&&this.FOnItemUnSelected(this,this.GetItemForNode(e)),null!=this.FOnItemSelectionChanged&&this.FOnItemSelectionChanged(this)},this.DoNeedFilterDropDownData=function(t,e,i){null!=this.FOnNeedFilterDropDownData&&this.FOnNeedFilterDropDownData(this,i)},this.DoFilterSelect=function(t,e,i){null!=this.FOnFilterSelect&&this.FOnFilterSelect(this,i)},this.DoBeforeDrawSortIndicator=function(t,e,i,s,n,o,r){var a=0;null!=this.FOnBeforeDrawSortIndicator&&(a=o,this.FOnBeforeDrawSortIndicator(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),n,a,r))},this.DoAfterDrawSortIndicator=function(t,e,i,s,n,o){var r=0;null!=this.FOnAfterDrawSortIndicator&&(r=o,this.FOnAfterDrawSortIndicator(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),n,r))},this.DoBeforeDrawNode=function(t,e,i,s,n,o){null!=this.FOnBeforeDrawItem&&this.FOnBeforeDrawItem(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(s),n,o)},this.DoAfterDrawNode=function(t,e,i,s){null!=this.FOnAfterDrawItem&&this.FOnAfterDrawItem(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(s))},this.DoItemCompare=function(t,e,i){null!=this.FOnItemCompare&&this.FOnItemCompare(this,t,e,i)},this.DoBeforeDrawNodeText=function(t,e,i,s,n,o,r){null!=this.FOnBeforeDrawItemText&&this.FOnBeforeDrawItemText(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(n),o,r)},this.DoAfterDrawNodeText=function(t,e,i,s,n,o){null!=this.FOnAfterDrawItemText&&this.FOnAfterDrawItemText(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(n),o)},this.DoBeforeDrawNodeTitle=function(t,e,i,s,n,o,r){null!=this.FOnBeforeDrawItemTitle&&this.FOnBeforeDrawItemTitle(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(n),o,r)},this.DoAfterDrawNodeTitle=function(t,e,i,s,n,o){null!=this.FOnAfterDrawItemTitle&&this.FOnAfterDrawItemTitle(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(n),o)},this.DoBeforeDrawNodeIcon=function(t,e,i,s,n,o,r){null!=this.FOnBeforeDrawItemIcon&&this.FOnBeforeDrawItemIcon(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(n),o,r)},this.DoAfterDrawNodeIcon=function(t,e,i,s,n,o){null!=this.FOnAfterDrawItemIcon&&this.FOnAfterDrawItemIcon(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(n),o)},this.DoBeforeDrawNodeCheck=function(t,e,i,s,n,o,r){null!=this.FOnBeforeDrawItemCheck&&this.FOnBeforeDrawItemCheck(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(n),o,r)},this.DoAfterDrawNodeCheck=function(t,e,i,s,n,o){null!=this.FOnAfterDrawItemCheck&&this.FOnAfterDrawItemCheck(this,e,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetItemForNode(n),o)},this.DoNodeAnchorClick=function(t,e,i,s){null!=this.FOnItemAnchorClick?this.FOnItemAnchorClick(this,this.GetItemForNode(e),s):this.FInteraction.GetAutoOpenURL()&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(s)},this.DoNodeTitleAnchorClick=function(t,e,i,s){null!=this.FOnItemTitleAnchorClick?this.FOnItemTitleAnchorClick(this,this.GetItemForNode(e),s):this.FInteraction.GetAutoOpenURL()&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(s)},this.DoNodeClick=function(t,e){var i=null;null==(i=this.GetItemForNode(e))||1!==this.FInteraction.FShowDetailMode||this.FEditMode||i.ShowDetailControl(),null!=i&&this.FEditMode&&(i.FChecked?(i.SetChecked(!1),this.FTreeView.DoAfterUnSelectNode(e)):(i.SetChecked(!0),this.FTreeView.DoAfterSelectNode(e)),this.SelectAllCheckedItems()),null!=this.FOnItemClick&&this.FOnItemClick(this,this.GetItemForNode(e)),null!=this.FParent&&pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.isPrototypeOf(this.FParent)&&null!=this.FParent.FOwner&&pas["WEBLib.TMSFNCControlPicker"].TTMSFNCControlPicker.isPrototypeOf(this.FParent.FOwner)&&(null!=i?rtl.as(this.FParent.FOwner,pas["WEBLib.TMSFNCControlPicker"].TTMSFNCControlPicker).CallItemClicked(i.GetIndex()):rtl.as(this.FParent.FOwner,pas["WEBLib.TMSFNCControlPicker"].TTMSFNCControlPicker).UpdateDropDown())},this.DoNodeMouseLeave=function(t,e){null!=this.FOnItemMouseLeave&&this.FOnItemMouseLeave(this,this.GetItemForNode(e))},this.DoNodeMouseEnter=function(t,e){null!=this.FOnItemMouseEnter&&this.FOnItemMouseEnter(this,this.GetItemForNode(e))},this.DoNodeDblClick=function(t,e){null!=this.FOnItemDblClick&&this.FOnItemDblClick(this,this.GetItemForNode(e))},this.DoVScroll=function(t,e){null!=this.FOnVScroll&&this.FOnVScroll(this,e)},this.DoBeforeCutToClipboard=function(t,e){null!=this.FOnBeforeCutToClipboard&&this.FOnBeforeCutToClipboard(this,e)},this.DoBeforeCopyToClipboard=function(t,e){null!=this.FOnBeforeCopyToClipboard&&this.FOnBeforeCopyToClipboard(this,e)},this.DoBeforePasteFromClipboard=function(t,e){null!=this.FOnBeforePasteFromClipboard&&this.FOnBeforePasteFromClipboard(this,e)},this.DoAfterCutToClipboard=function(t){null!=this.FOnAfterCutToClipboard&&this.FOnAfterCutToClipboard(this)},this.DoAfterCopyToClipboard=function(t){null!=this.FOnAfterCopyToClipboard&&this.FOnAfterCopyToClipboard(this)},this.DoAfterPasteFromClipboard=function(t){null!=this.FOnAfterPasteFromClipboard&&this.FOnAfterPasteFromClipboard(this)},this.DoBeforeReorderItem=function(t,e,i){null!=this.FOnBeforeReorderItem&&this.FOnBeforeReorderItem(this,t,e,i)},this.DoAfterReorderItem=function(t,e){null!=this.FOnAfterReorderItem&&this.FOnAfterReorderItem(this,t,e)},this.DoBeforeDropItem=function(t,e,i){null!=this.FOnBeforeDropItem&&this.FOnBeforeDropItem(this,t,e,i)},this.DoAfterDropItem=function(t,e){null!=this.FOnAfterDropItem&&this.FOnAfterDropItem(this,t,e)},this.CustomizeTreeView=function(t){},this.DoCustomDragOver=function(t,e,i,s){s.set(0!==this.FInteraction.GetDragDropMode()&&pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.isPrototypeOf(e)&&null!=rtl.as(e,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FDragNode),s.set(s.get()&&pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetItemsRect(),i)),this.FAccepted=s.get()},this.DoCustomDragDrop=function(e,i,s){var n=null,o=null,r=null,a=null,l=null,h=null,F=!1,p=null;if(this.FAccepted&&null!=i&&pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView.isPrototypeOf(i)&&t.TTMSFNCCustomTableView.isPrototypeOf(rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FParent)&&0!==i.FInteraction.FDragDropMode&&null!=(h=rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FDragNode)&&(o=rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FParent.GetItemForNode(h),(n=this.XYToItem(s.X,s.Y))!==o&&null!=o&&pas["WEBLib.TMSFNCTypes"].PtInRectEx(this.GetItemsRect(),s)&&(F=!0,null!=n?this.DoBeforeDropItem(o,n,{get:function(){return F},set:function(t){F=t}}):(this.FUpdateCount$1+=1,l=this.FItems.Add$1(),this.FUpdateCount$1-=1,this.DoBeforeDropItem(o,l,{get:function(){return F},set:function(t){F=t}}),l=rtl.freeLoc(l)),F))){if(a=null,this.BeginUpdate(),(p=rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FParent).BeginUpdate(),null!=n){var c=p.FInteraction.GetDragDropMode();1===c?rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FParent===this?(this.DragItemMove(o,n),o.SetIndex(n.GetIndex()),a=n):(r=this.FItems.Add$1(),this.DragItemAdd(r,o,n),p.DragItemDelete(o),r.Assign(o),r.SetIndex(n.GetIndex()),p.FItems.Delete(o.GetIndex()),p.SetItemIndex(p.GetItemIndex()),a=r,o=null):2===c&&(r=this.FItems.Add$1(),this.DragItemAdd(r,o,n),r.Assign(o),r.SetIndex(n.GetIndex()),a=r)}else{r=this.FItems.Add$1(),this.DragItemAdd(r,o,null),r.Assign(o),1===p.FInteraction.GetDragDropMode()&&(p.DragItemDelete(o),p.FTreeView.RemoveNodeFromSelection(p.GetNodeForItemIndex(o.GetIndex())),p.FItems.Delete(o.GetIndex()),p.SetItemIndex(p.GetItemIndex()),o=null),a=r}rtl.as(i,pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView).FDragNode=null,null!=a&&(this.FSaveSelectedItem=a.GetIndex(),this.FSaveSelectedItems=rtl.arraySetLength(this.FSaveSelectedItems,0,1),this.FSaveSelectedItems[0]=a.GetIndex()),p.EndUpdate(),this.EndUpdate(),this.DoAfterDropItem(o,a)}},this.DragItemMove=function(t,e){},this.DragItemAdd=function(t,e,i){},this.DragItemDelete=function(t){},this.DoCustomReorder=function(t,e,i){var s=null,n=null,o=!1;null!=e&&null!=i&&(o=!0,s=this.GetItemForNode(e),n=this.GetItemForNode(i),this.DoBeforeReorderItem(s,n,{get:function(){return o},set:function(t){o=t}}),o&&(this.BeginUpdate(),s.SetIndex(n.GetIndex()),this.EndUpdate(),this.DoAfterReorderItem(s,n)))},this.DoCopyToClipboard=function(t){this.CopyToClipboard(1===this.FInteraction.GetClipboardMode())},this.DoCutToClipboard=function(t){this.CutToClipboard(1===this.FInteraction.GetClipboardMode())},this.DoPasteFromClipboard=function(t){this.PasteFromClipboard()},this.DoColumnSort=function(t,e,i){var s;s=i,this.FItems.Sort$1(this.FInteraction.GetSorting()in rtl.createSet(2),s)},this.DoLookup=function(t,e){this.LookupItem(e,this.FInteraction.FLookup.GetCaseSensitive(),this.FInteraction.FLookup.GetAutoSelect())},this.UpdateActiveDetailControl=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();null!=this.FActiveDetailControl&&null!=this.FTreeView&&(t.$assign(this.FTreeView.GetContentRect()),pas["WEBLib.TMSFNCTypes"].InflateRectEx(t,-1,-1),t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left+this.FDetailControlOffset,t.Top,t.Right+this.FDetailControlOffset,t.Bottom)),this.FActiveDetailControl.SetBounds(Math.round(t.Left),Math.round(t.Top),Math.round(t.Right-t.Left),Math.round(t.Bottom-t.Top)))},this.DoFooterAnchorClick=function(t,e){null!=this.FOnFooterAnchorClick?this.FOnFooterAnchorClick(this,e):this.FInteraction.GetAutoOpenURL()&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(e)},this.DoHeaderAnchorClick=function(t,e){null!=this.FOnHeaderAnchorClick?this.FOnHeaderAnchorClick(this,e):this.FInteraction.GetAutoOpenURL()&&pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(e)},this.PickerGetContent=function(){var t="";return t="",this.GetItemIndex()>=0&&(t=this.FItems.GetItem$1(this.GetItemIndex()).FText),t},this.PickerSelectItem=function(t){t>=0&&t<=this.FItems.GetCount()-1&&this.SetItemIndex(t)},this.PickerGetSelectedItem=function(){return this.GetItemIndex()},this.PickerGetVisibleItemCount=function(){return null!=this.FTreeView?this.FTreeView.FVisibleNodes.GetCount():0},this.PickerGetItemCount=function(){return this.FItems.GetCount()},this.PickerGetItemHeight=function(){return this.FItemAppearance.GetFixedHeight()},this.PickerSetItemHeight=function(t){this.FItemAppearance.SetFixedHeight(t)},this.PickerGetItemWidth=function(){return this.GetWidth()},this.PickerSetItemWidth=function(t){},this.PickerGetNextSelectableItem=function(t){return t<this.FItems.GetCount()-1?t+1:t},this.PickerGetPreviousSelectableItem=function(t){return t>0?t-1:t},this.PickerGetFirstSelectableItem=function(){return this.FItems.GetCount()>0?0:-1},this.PickerGetLastSelectableItem=function(){return this.FItems.GetCount()>0?this.FItems.GetCount()-1:-1},this.PickerResetFilter=function(){this.RemoveFilters()},this.PickerApplyFilter=function(t,e){this.ApplyFilter()},this.PickerLookupItem=function(t,e){var i=pas["WEBLib.TMSFNCControlPicker"].TTMSFNCControlPickerFilterItem.$new(),s=null;return s=this.LookupItem(t,e,!1),i.ItemIndex=s.GetIndex(),i.ItemText=s.FText,i},this.SetFonts=function(t){var e=0;if(this.BeginUpdate(),this.FGlobalFont.ApplyChange(this.FFooter.GetFont(),t),this.FGlobalFont.ApplyChange(this.FHeader.GetFont(),t),this.FGlobalFont.ApplyChange(this.FItemAppearance.GetFont(),t),this.FGlobalFont.ApplyChange(this.FItemAppearance.FAccessoryFont,t),this.FGlobalFont.ApplyChange(this.FLookupBar.FFont,t),this.FGlobalFont.ApplyChange(this.FLookupBar.FInActiveFont,t),1===t)for(var i=0,s=this.FItems.GetCount()-1;i<=s;i++)e=i,this.FItems.GetItem$1(e).SetTextColor(this.FGlobalFont.FColor),this.FItems.GetItem$1(e).SetAccessoryFontColor(this.FGlobalFont.FColor),this.FItems.GetItem$1(e).SetSelectedTextColor(this.FGlobalFont.FColor),this.FItems.GetItem$1(e).FSelectedTitleColor=this.FGlobalFont.FColor;this.EndUpdate()},this.Create$1=function(e){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FFirstLoad=!1,this.FEdit=t.TTMSFNCTableViewEdit.$create("Create$1",[this]),this.FEdit.FTableView=this,this.FEdit.FOnChange=rtl.createCallback(this,"DoEditChange"),this.FEditButton=pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBarButton.$create("Create$1",[this]),this.FEditButton.FOnClick=rtl.createCallback(this,"DoEditButtonClicked"),this.FEditButton.FStored=!1,this.FEditButton.SetWidth(50),this.FEditButton.FAppearance.SetFlatStyle(!0),this.FDoneButton=pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBarButton.$create("Create$1",[this]),this.FDoneButton.FOnClick=rtl.createCallback(this,"DoDoneButtonClicked"),this.FDoneButton.FStored=!1,this.FDoneButton.SetWidth(50),this.FDoneButton.FAppearance.SetFlatStyle(!0),this.FFilterButton=pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBarButton.$create("Create$1",[this]),this.FFilterButton.FOnClick=rtl.createCallback(this,"DoFilterButtonClicked"),this.FFilterButton.FStored=!1,this.FFilterButton.SetWidth(30),this.FFilterButton.FAppearance.SetFlatStyle(!0),this.FFilterButton.FBitmaps.AddBitmapFromResource$1(t.TMSFNCTABLEVIEWSEARCH,pas["WEBLib.TMSFNCTypes"].HInstance(),1),this.FFilterButton.SetBitmapVisible(!0),this.FBackButton=pas["WEBLib.TMSFNCToolBar"].TTMSFNCToolBarButton.$create("Create$1",[this]),this.FBackButton.FOnClick=rtl.createCallback(this,"DoBackButtonClicked"),this.FBackButton.FStored=!1,this.FBackButton.SetWidth(50),this.FBackButton.FAppearance.SetFlatStyle(!0),this.FEditButton.SetText("Edit"),this.FDoneButton.SetText("Done"),this.FBackButton.SetText("Back"),this.FDetailControlTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]),this.FDetailControlTimer.FOnTimer=rtl.createCallback(this,"DoDetailControlTimer"),this.FDetailControlTimer.SetEnabled(!1),this.FDetailControlTimer.SetInterval(1),this.FDisplayList=t.TTMSFNCTableViewDisplayList.$create("Create$1"),this.FCategoryList=t.TTMSFNCTableViewDisplayList.$create("Create$1"),this.FLookupBarDisplayList=t.TTMSFNCTableViewLookupBarDisplayList.$create("Create$1"),this.FItems=this.CreateItems(),this.FLookupBar=t.TTMSFNCTableViewLookupBar.$create("Create$1",[this]),this.FReload=t.TTMSFNCTableViewReload.$create("Create$1",[this]),this.FCategories=t.TTMSFNCTableViewCategories.$create("Create$3",[this]),this.FMoreOptions=t.TTMSFNCTableViewMoreOptions.$create("Create$3",[this]),this.FCategoryType=0,this.FCustomChar=t.TTMSFNCTableViewCustomCharList.$create("Create$2"),this.FTreeView=this.CreateTreeView(),this.FTreeView.FAllowTouch=!1,this.FTreeView.FOnClick=rtl.createCallback(this,"DoClick"),this.FTreeView.SetOptimizedHTMLDrawing(!0),this.FTreeView.FTableView=this,this.FTreeView.FStored=!1,this.FTreeView.SetParent(this),this.FTreeView.FColumns.Clear(),this.FColumn=this.FTreeView.FColumns.Add$1(),this.FTreeView.ClearNodes(),this.FTreeView.FColumnsAppearance.SetLayouts(rtl.createSet(0,1)),this.FTreeView.FColumnsAppearance.SetTopSize(30),this.FTreeView.FColumnsAppearance.SetBottomSize(30),this.FTreeView.SetStretchScrollBars(!0),this.FTreeView.SetVerticalScrollBarVisible(!1),this.FTreeView.FNodesAppearance.FStroke.SetKind(1),this.FTreeView.FNodesAppearance.SetExpandColumn(-1),this.FTreeView.FNodesAppearance.SetLevelIndent(0),this.FTreeView.FNodesAppearance.SetShowLines(!1),this.FTreeView.FNodesAppearance.SetExpandWidth(0),this.FTreeView.FNodesAppearance.SetExpandHeight(0),this.FTreeView.FNodesAppearance.SetSelectionArea(0),this.FTreeView.FNodesAppearance.SetShowFocus(!0),this.FTreeView.FNodesAppearance.FSelectedFill.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(217,217,217)),this.FTreeView.FNodesAppearance.FSelectedStroke.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(217,217,217)),this.FTreeView.FNodesAppearance.FStroke.SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(200,199,204)),this.FFilter=t.TTMSFNCTableViewFilter.$create("Create$3",[this]),this.FHeader=t.TTMSFNCTableViewHeader.$create("Create$1",[this]),this.FFooter=t.TTMSFNCTableViewFooter.$create("Create$1",[this]),this.FItemAppearance=t.TTMSFNCTableViewItemAppearance.$create("Create$1",[this]),this.FCategoryAppearance=t.TTMSFNCTableViewCategoryAppearance.$create("Create$1",[this]),this.FMoreOptionAppearance=t.TTMSFNCTableViewMoreOptionAppearance.$create("Create$1",[this]),this.FDefaultItem=t.TTMSFNCTableViewItem.$create("Create$1",[null]),this.FInteraction=t.TTMSFNCTableViewInteraction.$create("Create$1",[this]),this.FCopyItems=t.TTMSFNCTableViewCopyItems.$create("Create$3",[null]),this.FGlobalFont=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCAppearanceGlobalFont.$create("Create$1",[this]),this.FTreeView.FOnGetNodeSides=rtl.createCallback(this,"DoGetNodeSides"),this.FTreeView.FOnGetColumnText=rtl.createCallback(this,"DoGetColumnText"),this.FTreeView.FOnGetColumnWordWrapping=rtl.createCallback(this,"DoGetColumnWordWrapping"),this.FTreeView.FOnGetColumnHorizontalTextAlign=rtl.createCallback(this,"DoGetColumnHorizontalTextAlign"),this.FTreeView.FOnGetColumnVerticalTextAlign=rtl.createCallback(this,"DoGetColumnVerticalTextAlign"),this.FTreeView.FOnGetColumnTrimming=rtl.createCallback(this,"DoGetColumnTrimming"),this.FTreeView.FOnGetNumberOfNodes=rtl.createCallback(this,"DoGetNumberOfNodes"),this.FTreeView.FOnIsNodeChecked=rtl.createCallback(this,"DoIsNodeChecked"),this.FTreeView.FOnGetNodeCheckType=rtl.createCallback(this,"DoGetNodeCheckType"),this.FTreeView.FOnAfterUnCheckNode=rtl.createCallback(this,"DoAfterUnCheckNode"),this.FTreeView.FOnAfterCheckNode=rtl.createCallback(this,"DoAfterCheckNode"),this.FTreeView.FOnGetNodeHeight=rtl.createCallback(this,"DoGetNodeHeight"),this.FTreeView.FOnGetNodeIcon=rtl.createCallback(this,"DoGetNodeIcon"),this.FTreeView.FOnGetNodeTrimming=rtl.createCallback(this,"DoGetNodeTrimming"),this.FTreeView.FOnGetNodeWordWrapping=rtl.createCallback(this,"DoGetNodeWordWrapping"),this.FTreeView.FOnGetNodeTitleTrimming=rtl.createCallback(this,"DoGetNodeTitleTrimming"),this.FTreeView.FOnGetNodeTitleWordWrapping=rtl.createCallback(this,"DoGetNodeTitleWordWrapping"),this.FTreeView.FOnDrawNodeExtra=rtl.createCallback(this,"DoDrawNodeExtra"),this.FTreeView.FOnGetNodeExtraSize=rtl.createCallback(this,"DoGetNodeExtraSize"),this.FTreeView.FOnGetNodeTextColor=rtl.createCallback(this,"DoGetNodeTextColor"),this.FTreeView.FOnGetNodeTitleColor=rtl.createCallback(this,"DoGetNodeTitleColor"),this.FTreeView.FOnIsNodeExtended=rtl.createCallback(this,"DoIsNodeExtended"),this.FTreeView.FOnGetNodeSelectedTextColor=rtl.createCallback(this,"DoGetNodeSelectedTextColor"),this.FTreeView.FOnGetNodeDisabledTextColor=rtl.createCallback(this,"DoGetNodeDisabledTextColor"),this.FTreeView.FOnGetNodeSelectedTitleColor=rtl.createCallback(this,"DoGetNodeSelectedTitleColor"),this.FTreeView.FOnGetNodeDisabledTitleColor=rtl.createCallback(this,"DoGetNodeDisabledTitleColor"),this.FTreeView.FOnGetNodeText=rtl.createCallback(this,"DoGetNodeText"),this.FTreeView.FOnGetNodeTitle=rtl.createCallback(this,"DoGetNodeTitle"),this.FTreeView.FOnGetNodeExpanded=rtl.createCallback(this,"DoGetNodeTitleExpanded"),this.FTreeView.FOnGetNodeHorizontalTextAlign=rtl.createCallback(this,"DoGetNodeHorizontalTextAlign"),this.FTreeView.FOnGetNodeVerticalTextAlign=rtl.createCallback(this,"DoGetNodeVerticalTextAlign"),this.FTreeView.FOnGetNodeTitleHorizontalTextAlign=rtl.createCallback(this,"DoGetNodeTitleHorizontalTextAlign"),this.FTreeView.FOnGetNodeTitleVerticalTextAlign=rtl.createCallback(this,"DoGetNodeTitleVerticalTextAlign"),this.FTreeView.FOnIsNodeEnabled=rtl.createCallback(this,"DoIsNodeEnabled"),this.FTreeView.FOnAfterSelectNode=rtl.createCallback(this,"DoAfterSelectNode"),this.FTreeView.FOnAfterUnSelectNode=rtl.createCallback(this,"DoAfterUnSelectNode"),this.FTreeView.FOnNeedFilterDropDownData=rtl.createCallback(this,"DoNeedFilterDropDownData"),this.FTreeView.FOnFilterSelect=rtl.createCallback(this,"DoFilterSelect"),this.FTreeView.FOnBeforeDrawNode=rtl.createCallback(this,"DoBeforeDrawNode"),this.FTreeView.FOnAfterDrawNode=rtl.createCallback(this,"DoAfterDrawNode"),this.FTreeView.FOnAfterDrawNodeIcon=rtl.createCallback(this,"DoAfterDrawNodeIcon"),this.FTreeView.FOnBeforeDrawNodeIcon=rtl.createCallback(this,"DoBeforeDrawNodeIcon"),this.FTreeView.FOnAfterDrawNodeCheck=rtl.createCallback(this,"DoAfterDrawNodeCheck"),this.FTreeView.FOnBeforeDrawNodeCheck=rtl.createCallback(this,"DoBeforeDrawNodeCheck"),this.FTreeView.FOnBeforeDrawNodeText=rtl.createCallback(this,"DoBeforeDrawNodeText"),this.FTreeView.FOnAfterDrawNodeText=rtl.createCallback(this,"DoAfterDrawNodeText"),this.FTreeView.FOnBeforeDrawNodeTitle=rtl.createCallback(this,"DoBeforeDrawNodeTitle"),this.FTreeView.FOnAfterDrawNodeTitle=rtl.createCallback(this,"DoAfterDrawNodeTitle"),this.FTreeView.FOnNodeAnchorClick=rtl.createCallback(this,"DoNodeAnchorClick"),this.FTreeView.FOnNodeTitleAnchorClick=rtl.createCallback(this,"DoNodeTitleAnchorClick"),this.FTreeView.FOnBeforeDrawSortIndicator=rtl.createCallback(this,"DoBeforeDrawSortIndicator"),this.FTreeView.FOnAfterDrawSortIndicator=rtl.createCallback(this,"DoAfterDrawSortIndicator"),this.FTreeView.FOnNodeClick=rtl.createCallback(this,"DoNodeClick"),this.FTreeView.FOnNodeMouseLeave=rtl.createCallback(this,"DoNodeMouseLeave"),this.FTreeView.FOnNodeMouseEnter=rtl.createCallback(this,"DoNodeMouseEnter"),this.FTreeView.FOnNodeDblClick=rtl.createCallback(this,"DoNodeDblClick"),this.FTreeView.FOnVScroll=rtl.createCallback(this,"DoVScroll"),this.FTreeView.FOnBeforeCutToClipboard=rtl.createCallback(this,"DoBeforeCutToClipboard"),this.FTreeView.FOnBeforeCopyToClipboard=rtl.createCallback(this,"DoBeforeCopyToClipboard"),this.FTreeView.FOnBeforePasteFromClipboard=rtl.createCallback(this,"DoBeforePasteFromClipboard"),this.FTreeView.FOnAfterCutToClipboard=rtl.createCallback(this,"DoAfterCutToClipboard"),this.FTreeView.FOnAfterCopyToClipboard=rtl.createCallback(this,"DoAfterCopyToClipboard"),this.FTreeView.FOnAfterPasteFromClipboard=rtl.createCallback(this,"DoAfterPasteFromClipboard"),this.FTreeView.FOnHeaderAnchorClick=rtl.createCallback(this,"DoHeaderAnchorClick"),this.FTreeView.FOnFooterAnchorClick=rtl.createCallback(this,"DoFooterAnchorClick"),this.FTreeView.FOnCustomReorder=rtl.createCallback(this,"DoCustomReorder"),this.FTreeView.FOnCustomDragOver=rtl.createCallback(this,"DoCustomDragOver"),this.FTreeView.FOnCustomDragDrop=rtl.createCallback(this,"DoCustomDragDrop"),this.FTreeView.FOnCustomCopyToClipboard=rtl.createCallback(this,"DoCopyToClipboard"),this.FTreeView.FOnCustomCutToClipboard=rtl.createCallback(this,"DoCutToClipboard"),this.FTreeView.FOnCustomPasteFromClipboard=rtl.createCallback(this,"DoPasteFromClipboard"),this.FTreeView.FOnCustomColumnSort=rtl.createCallback(this,"DoColumnSort"),this.FTreeView.FOnCustomLookup=rtl.createCallback(this,"DoLookup"),this.CustomizeTreeView(this.FTreeView),this.SetWidth(250),this.SetHeight(350),this.IsDesignTime()&&(this.GetStroke().SetColor(pas["WEBLib.TMSFNCGraphicsTypes"].MakeGraphicsColor(200,199,204)),this.InitSample()),this},this.Destroy=function(){rtl.free(this,"FGlobalFont"),rtl.free(this,"FEditButton"),rtl.free(this,"FFilterButton"),rtl.free(this,"FEdit"),rtl.free(this,"FBackButton"),rtl.free(this,"FDoneButton"),rtl.free(this,"FDetailControlTimer"),rtl.free(this,"FMoreOptions"),rtl.free(this,"FCategories"),rtl.free(this,"FReload"),rtl.free(this,"FLookupBar"),rtl.free(this,"FCustomChar"),rtl.free(this,"FDisplayList"),rtl.free(this,"FCategoryList"),rtl.free(this,"FLookupBarDisplayList"),rtl.free(this,"FFilter"),rtl.free(this,"FCopyItems"),rtl.free(this,"FHeader"),rtl.free(this,"FFooter"),rtl.free(this,"FDefaultItem"),rtl.free(this,"FInteraction"),rtl.free(this,"FItems"),rtl.free(this,"FTreeView"),rtl.free(this,"FItemAppearance"),rtl.free(this,"FCategoryAppearance"),rtl.free(this,"FMoreOptionAppearance"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Draw=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),this.FFirstLoad||(this.FFirstLoad=!0,this.UpdateControlAfterResize())},this.Assign=function(e){t.TTMSFNCCustomTableView.isPrototypeOf(e)&&(this.FTreeView.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FTreeView),this.FItems.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FItems),this.FItemAppearance.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FItemAppearance),this.FCategoryAppearance.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FCategoryAppearance),this.FCategoryType=rtl.as(e,t.TTMSFNCCustomTableView).FCategoryType,this.FFilter.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FFilter),this.FHeader.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FHeader),this.FFooter.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FFooter),this.FDefaultItem.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FDefaultItem),this.FInteraction.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FInteraction),this.FReload.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FReload),this.FLookupBar.Assign(rtl.as(e,t.TTMSFNCCustomTableView).FLookupBar))},this.AddItem=function(t){var e=null;return(e=this.FItems.Add$1()).SetText(t),e},this.XYToAccessoryItem=function(t,e){var i=null,s=null,n=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),o=null,r=0;return i=null,null!=this.FTreeView&&null!=(s=this.FTreeView.XYToNode(t,e,0))&&s.FRow>=0&&s.FRow<=this.FItems.GetCount()-1&&null!=(o=this.GetItemForNode(s))&&o.FAccessory in this.FInteraction.FAccessoryClickDetection&&(n.$assign(s.FExtraRects[0]),pas["WEBLib.TMSFNCTypes"].InflateRectEx(n,0,-4),r=o.FAccessoryHeight,n.$assign(pas["WEBLib.TMSFNCTypes"].RectF(n.Left,n.Top+(n.Bottom-n.Top-r)/2,n.Right,n.Top+(n.Bottom-n.Top-r)/2+r)),pas["WEBLib.TMSFNCTypes"].PtInRectEx(n,pas["WEBLib.TMSFNCTypes"].PointF(t,e))&&(i=o)),i},this.XYToItem=function(t,e){var i=null,s=null;return i=null,null!=this.FTreeView&&null!=(s=this.FTreeView.XYToNode(t,e,0))&&s.FRow>=0&&s.FRow<=this.FDisplayList.GetCount()-1&&(i=this.GetItemForNode(s)),i},this.XYToMoreOption=function(t,e){var i,s=null,n=0,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),a=0,l=null;if(s=null,null==this.FTreeView)return s;if(null==(i=this.FTreeView.XYToNode(t,e,this.FTreeView.FMoreOffset))||this.GetItemForNode(i)!==this.FTreeView.FMoreOffsetItem)return s;if(this.FMoreOptions.GetCount()>0){r.$assign(i.FExtraRects[0]),n=this.FTreeView.FMoreOffset/this.FMoreOptions.GetCount();for(var h=0,F=this.FMoreOptions.GetCount()-1;h<=F;h++)if(a=h,l=this.FMoreOptions.GetItem$1(a),o.$assign(pas["WEBLib.TMSFNCTypes"].RectF(r.Right+n*a,r.Top,r.Right+n*(a+1),r.Bottom)),pas["WEBLib.TMSFNCTypes"].PtInRectEx(o,pas["WEBLib.TMSFNCTypes"].PointF(t,e))){s=l;break}}return s},this.SelectedItemCount=function(){var t=0;return t=0,null!=this.FTreeView&&(t=this.FTreeView.SelectedVirtualNodeCount()),t},this.LookupItem=function(t,e,i){var s=null,n="",o=null,r=0,a="";s=null,n=t,e||(n=pas.SysUtils.UpperCase(n));for(var l=0,h=this.FItems.GetCount()-1;l<=h;l++)if(r=l,a=(o=this.FItems.GetItem$1(r)).GetStrippedHTMLText(),e||(a=pas.SysUtils.UpperCase(a)),1===pas.System.Pos(n,a)){s=o;break}return null!=s&&this.IsItemSelectable(s)&&i&&(this.SelectItem(s.GetIndex()),this.ScrollToItem(s.GetIndex())),s},this.IsItemSelectable=function(t){var e=!1;return e=!0,null!=t&&(e=t.FEnabled,this.FTreeView.FVisibleNodes.IndexOf(this.GetNodeForItemIndex(t.GetIndex()))>-1||(e=!1)),e},this.GetSelectedItems=function(){var e=[],i=0,s=null;e=[];for(var n=0,o=this.SelectedItemCount()-1;n<=o;n++)i=n,s=rtl.as(this.GetSelItem(i),t.TTMSFNCTableViewItem),(e=rtl.arraySetLength(e,null,rtl.length(e)+1))[rtl.length(e)-1]=s;return e},this.LookupCustomCategory=function(t){this.FLookupBar.FAutoLookup?this.ScrollToCategoryId(t):null!=this.FOnManualLookupCategory&&this.FOnManualLookupCategory(this,"",t)},this.LookupCategory=function(t){this.FLookupBar.FAutoLookup?this.ScrollToCategoryCharacter(t):null!=this.FOnManualLookupCategory&&this.FOnManualLookupCategory(this,t,-1)},this.RemoveItem=function(t){null!=t&&this.FItems.Delete(t.GetIndex())},this.BeginUpdate=function(){var t=[],e=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.BeginUpdate.call(this),this.FUpdateCount$1+=1,null!=this.FTreeView){null!=this.GetSelectedItem()?this.FSaveSelectedItem=this.GetSelectedItem().GetIndex():this.FSaveSelectedItem=-1,t=this.GetSelectedItems(),this.FSaveSelectedItems=rtl.arraySetLength(this.FSaveSelectedItems,0,rtl.length(t));for(var i=0,s=rtl.length(t)-1;i<=s;i++)e=i,this.FSaveSelectedItems[e]=t[e].GetIndex();this.FTreeView.BeginUpdate(),this.FTreeView.ClearNodeList()}},this.EndUpdate=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.EndUpdate.call(this),this.FUpdateCount$1-=1,0===this.FUpdateCount$1&&this.UpdateTableView(!1),null!=this.FTreeView&&this.FTreeView.EndUpdate(),this.SelectItem(this.FSaveSelectedItem),this.SelectItems(rtl.arrayRef(this.FSaveSelectedItems))},this.InitSample=function(){this.BeginUpdate(),this.FItems.Clear$1(),this.AddItem("Bugfix 376"),this.AddItem("Bugfix 378"),this.AddItem("Customer Update"),this.AddItem("Install New server"),this.AddItem("Meeting: Next Phase"),this.AddItem("Release Planning"),this.ResetToDefaultStyle(),this.FGlobalFont.SetName("Segoe UI"),this.EndUpdate()},this.ScrollToItem=function(t){var e=null;null!=this.FTreeView&&t>=0&&t<=this.FItems.GetCount()-1&&(e=this.FTreeView).ScrollToVirtualNode(e.GetNodeForRow(this.GetRowForItemIndex(t)),!0,0,!0)},this.UnCheckAllItems=function(){var t=0;this.BeginUpdate();for(var e=0,i=this.FItems.GetCount()-1;e<=i;e++)t=e,this.FItems.GetItem$1(t).SetChecked(!1);this.EndUpdate()},this.StartFiltering=function(){null!=this.FTreeView&&(this.FTreeView.FReloadActive||this.FFilterActive)||null==this.FTreeView||(this.FFilterActive=!0,this.RemoveFilters(),this.UpdateTableView(!1),this.FEdit.SetT(""),this.FEdit.SetFocus())},this.StopFiltering=function(){null!=this.FTreeView&&this.FTreeView.FReloadActive||null==this.FTreeView||(this.FFilterActive=!1,this.RemoveFilters(),this.UpdateTableView(!1))},this.StartEditMode=function(){null!=this.FTreeView&&this.FTreeView.FReloadActive||null==this.FTreeView||(this.FEditMode=!0,this.UpdateTableView(!1),this.SelectAllCheckedItems())},this.StopEditMode=function(){null!=this.FTreeView&&this.FTreeView.FReloadActive||null==this.FTreeView||(this.FEditMode=!1,this.UpdateTableView(!1),this.UnSelectAllItems(),this.UnCheckAllItems())},this.ToggleEditMode=function(){this.FEditMode?this.StopEditMode():this.StartEditMode()},this.SelectItem=function(t){var e=null,i=0;null!=this.FTreeView&&-1!==t&&(i=Math.max(0,Math.min(t,this.FItems.GetCount()-1)))>=0&&i<=this.FItems.GetCount()-1&&(e=this.FTreeView).SelectVirtualNode(e.GetNodeForRow(this.GetRowForItemIndex(i)))},this.SelectItems=function(t){var e=null,i=0,s=[];if(null!=this.FTreeView){e=this.FTreeView,s=rtl.arraySetLength(s,null,rtl.length(t));for(var n=0,o=rtl.length(t)-1;n<=o;n++)s[i=n]=e.GetNodeForRow(this.GetRowForItemIndex(t[i]));e.SelectVirtualNodes(rtl.arrayRef(s))}},this.CutToClipboard=function(t){var e=0;this.BeginUpdate(),this.CopyToClipboard(t);for(var i=this.SelectedItemCount()-1;i>=0;i--)e=i,this.RemoveItem(this.GetSelItem(e));this.EndUpdate()},this.CopyToClipboard=function(e){var i="",s=0,n=null,o=null;o=pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewIntegerList.$create("Create$1");try{i="";for(var r=0,a=this.SelectedItemCount()-1;r<=a;r++)s=r,null!=(n=this.GetSelItem(s))&&-1===o.IndexOf(n.GetIndex())&&(i=i+n.SaveToString(e)+pas["WEBLib.TMSFNCCustomTreeView"].ENDOFLINE,o.Add(n.GetIndex()));""!==i&&pas["WEBLib.TMSFNCUtils"].TTMSFNCClipBoard.SetText(t.CLP_FMT+i)}finally{o=rtl.freeLoc(o)}},this.PasteFromClipboard=function(){var e="",i=null,s=0,n="";if(pas["WEBLib.TMSFNCUtils"].TTMSFNCClipBoard.HasFormat(0)&&(e=pas["WEBLib.TMSFNCUtils"].TTMSFNCClipBoard.GetText(),pas.System.Pos(t.CLP_FMT,e)>0)){i=pas.Classes.TStringList.$create("Create$1");try{e=pas.SysUtils.StringReplace(e,t.CLP_FMT,"",rtl.createSet(0)),i.SetTextStr(e);try{for(var o=0,r=i.GetCount()-1;o<=r;o++)s=o,n=i.Get(s),this.AddItem("").LoadFromString(n)}finally{}}finally{i=rtl.freeLoc(i)}}},this.ApplyFilter=function(){this.FFilterApplied=!0,this.UpdateTableView(!1)},this.RemoveFilters=function(){this.FFilterApplied=!1,this.FFilter.Clear(),this.UpdateTableView(!1)},this.ShowDetailControl=function(t){var e=!1,i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();null!=this.FTreeView&&this.FTreeView.FReloadActive||null==this.FTreeView||(this.FTreeView.StopAnimationTimer(),this.HideDetailControl(),t>=0&&t<=this.FItems.GetCount()-1&&(this.FActiveDetailControl=this.FItems.GetItem$1(t).FDetailControl,this.FActiveDetailItem=this.FItems.GetItem$1(t)),null==this.FActiveDetailControl&&(this.FActiveDetailControl=this.FDefaultItem.FDetailControl),e=!0,this.DoBeforeItemShowDetailControl(this.FActiveDetailItem,this.FActiveDetailControl,{get:function(){return e},set:function(t){e=t}}),null!=this.FActiveDetailControl&&null!=this.FTreeView&&e?(this.FShowDetailControl=!1,this.FActiveDetailControl.SetParent(this),i.$assign(this.FTreeView.GetContentRect()),this.FDetailControlOffset=i.Right-i.Left,this.UpdateActiveDetailControl(),this.FActiveDetailControl.SetVisible(!0),this.FDetailControlTimer.SetEnabled(!0)):(this.FActiveDetailControl=null,this.FActiveDetailItem=null))},this.HideDetailControl=function(){var t=!1;null!=this.FTreeView&&this.FTreeView.FReloadActive||null==this.FTreeView||!this.FShowDetailControl||(this.FTreeView.StopAnimationTimer(),t=!0,this.DoBeforeItemHideDetailControl(this.FActiveDetailItem,this.FActiveDetailControl,{get:function(){return t},set:function(e){t=e}}),null!=this.FActiveDetailControl&&null!=this.FTreeView&&t&&(this.FShowDetailControl=!0,this.UpdateActiveDetailControl(),this.FDetailControlTimer.SetEnabled(!0)))},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCTableView",this.TTMSFNCCustomTableView,(function(){this.RegisterRuntimeClasses=function(){t.TTMSFNCCustomTableView.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClasses([t.TTMSFNCTableView,t.TTMSFNCTableViewItem])},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Fill",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFill,"GetFill","SetFill$1"),e.addProperty("Stroke",3,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsStroke,"GetStroke","SetStroke$1"),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("ItemAppearance",2,t.$rtti.TTMSFNCTableViewItemAppearance,"FItemAppearance","SetItemAppearance"),e.addProperty("DefaultItem",2,t.$rtti.TTMSFNCTableViewItem,"FDefaultItem","SetDefaultItem"),e.addProperty("Items",2,t.$rtti.TTMSFNCTableViewItems,"FItems","SetItems"),e.addProperty("Header",2,t.$rtti.TTMSFNCTableViewHeader,"FHeader","SetHeader"),e.addProperty("Footer",2,t.$rtti.TTMSFNCTableViewFooter,"FFooter","SetFooter"),e.addProperty("ItemIndex",3,rtl.longint,"GetItemIndex","SetItemIndex",{Default:-1}),e.addProperty("Interaction",2,t.$rtti.TTMSFNCTableViewInteraction,"FInteraction","SetInteraction"),e.addProperty("LookupBar",2,t.$rtti.TTMSFNCTableViewLookupBar,"FLookupBar","SetLookupBar"),e.addProperty("Reload",2,t.$rtti.TTMSFNCTableViewReload,"FReload","SetReload"),e.addProperty("Categories",2,t.$rtti.TTMSFNCTableViewCategories,"FCategories","SetCategories"),e.addProperty("MoreOptions",2,t.$rtti.TTMSFNCTableViewMoreOptions,"FMoreOptions","SetMoreOptions"),e.addProperty("MoreOptionAppearance",2,t.$rtti.TTMSFNCTableViewMoreOptionAppearance,"FMoreOptionAppearance","SetMoreOptionAppearance"),e.addProperty("CategoryAppearance",2,t.$rtti.TTMSFNCTableViewCategoryAppearance,"FCategoryAppearance","SetCategoryAppearance"),e.addProperty("CategoryType",2,t.$rtti.TTMSFNCTableViewCategoryType,"FCategoryType","SetCategoryType",{Default:t.TTMSFNCTableViewCategoryType.tvctNone}),e.addProperty("OnItemSelected",0,t.$rtti.TTMSFNCTableViewItemSelectedEvent,"FOnItemSelected","FOnItemSelected"),e.addProperty("OnItemUnSelected",0,t.$rtti.TTMSFNCTableViewItemUnSelectedEvent,"FOnItemUnSelected","FOnItemUnSelected"),e.addProperty("OnItemSelectionChanged",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnItemSelectionChanged","FOnItemSelectionChanged"),e.addProperty("Version",1,rtl.string,"GetVersion",""),e.addProperty("VerticalScrollBarVisible",3,rtl.boolean,"GetVerticalScrollBarVisible","SetVerticalScrollBarVisible",{Default:!1}),e.addProperty("GlobalFont",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCAppearanceGlobalFont,"FGlobalFont","SetGlobalFont"),e.addProperty("OnBeforeDrawItem",0,t.$rtti.TTMSFNCTableViewBeforeDrawItemEvent,"FOnBeforeDrawItem","FOnBeforeDrawItem"),e.addProperty("OnAfterDrawItem",0,t.$rtti.TTMSFNCTableViewAfterDrawItemEvent,"FOnAfterDrawItem","FOnAfterDrawItem"),e.addProperty("OnItemCompare",0,t.$rtti.TTMSFNCTableViewItemCompareEvent,"FOnItemCompare","FOnItemCompare"),e.addProperty("OnCategoryCompare",0,t.$rtti.TTMSFNCTableViewCategoryCompareEvent,"FOnCategoryCompare","FOnCategoryCompare"),e.addProperty("OnCategoryClick",0,t.$rtti.TTMSFNCTableViewLookupCategoryEvent,"FOnCategoryClick","FOnCategoryClick"),e.addProperty("OnManualLookupCategory",0,t.$rtti.TTMSFNCTableViewLookupCategoryEvent,"FOnManualLookupCategory","FOnManualLookupCategory"),e.addProperty("OnAfterDrawItemIcon",0,t.$rtti.TTMSFNCTableViewAfterDrawItemIconEvent,"FOnAfterDrawItemIcon","FOnAfterDrawItemIcon"),e.addProperty("OnBeforeDrawItemIcon",0,t.$rtti.TTMSFNCTableViewBeforeDrawItemIconEvent,"FOnBeforeDrawItemIcon","FOnBeforeDrawItemIcon"),e.addProperty("OnBeforeDrawItemText",0,t.$rtti.TTMSFNCTableViewBeforeDrawItemTextEvent,"FOnBeforeDrawItemText","FOnBeforeDrawItemText"),e.addProperty("OnAfterDrawItemText",0,t.$rtti.TTMSFNCTableViewAfterDrawItemTextEvent,"FOnAfterDrawItemText","FOnAfterDrawItemText"),e.addProperty("OnItemAnchorClick",0,t.$rtti.TTMSFNCTableViewItemAnchorClickEvent,"FOnItemAnchorClick","FOnItemAnchorClick"),e.addProperty("OnItemClick",0,t.$rtti.TTMSFNCTableViewItemClickEvent,"FOnItemClick","FOnItemClick"),e.addProperty("OnItemMouseLeave",0,t.$rtti.TTMSFNCTableViewItemMouseLeaveEvent,"FOnItemMouseLeave","FOnItemMouseLeave"),e.addProperty("OnItemMouseEnter",0,t.$rtti.TTMSFNCTableViewItemMouseEnterEvent,"FOnItemMouseEnter","FOnItemMouseEnter"),e.addProperty("OnItemDblClick",0,t.$rtti.TTMSFNCTableViewItemClickEvent,"FOnItemDblClick","FOnItemDblClick"),e.addProperty("OnVScroll",0,t.$rtti.TTMSFNCTableViewScrollEvent,"FOnVScroll","FOnVScroll"),e.addProperty("OnStartReload",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnStartReload","FOnStartReload"),e.addProperty("OnStopReload",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnStopReload","FOnStopReload"),e.addProperty("OnDrawItemCustomAccessory",0,t.$rtti.TTMSFNCTableViewDrawItemCustomAccessoryEvent,"FOnDrawItemCustomAccessory","FOnDrawItemCustomAccessory"),e.addProperty("OnItemAccessoryClick",0,t.$rtti.TTMSFNCTableViewItemClickEvent,"FOnItemAccessoryClick","FOnItemAccessoryClick"),e.addProperty("OnItemCheckChanged",0,t.$rtti.TTMSFNCTableViewItemCheckChangedEvent,"FOnItemCheckChanged","FOnItemCheckChanged"),e.addProperty("OnAfterDrawItemCheck",0,t.$rtti.TTMSFNCTableViewAfterDrawItemCheckEvent,"FOnAfterDrawItemCheck","FOnAfterDrawItemCheck"),e.addProperty("OnBeforeDrawItemCheck",0,t.$rtti.TTMSFNCTableViewBeforeDrawItemCheckEvent,"FOnBeforeDrawItemCheck","FOnBeforeDrawItemCheck"),e.addProperty("OnBeforeApplyFilter",0,t.$rtti.TTMSFNCTableViewBeforeApplyFilterEvent,"FOnBeforeApplyFilter","FOnBeforeApplyFilter"),e.addProperty("OnAfterApplyFilter",0,t.$rtti.TTMSFNCTableViewAfterApplyFilterEvent,"FOnAfterApplyFilter","FOnAfterApplyFilter"),e.addProperty("OnItemMoreOptionClick",0,t.$rtti.TTMSFNCTableViewItemMoreOptionClickEvent,"FOnItemMoreOptionClick","FOnItemMoreOptionClick"),e.addProperty("OnBeforeItemShowDetailControl",0,t.$rtti.TTMSFNCTableViewBeforeItemShowDetailControl,"FOnBeforeItemShowDetailControl","FOnBeforeItemShowDetailControl"),e.addProperty("OnBeforeItemHideDetailControl",0,t.$rtti.TTMSFNCTableViewBeforeItemHideDetailControl,"FOnBeforeItemHideDetailControl","FOnBeforeItemHideDetailControl"),e.addProperty("OnItemShowDetailControl",0,t.$rtti.TTMSFNCTableViewItemShowDetailControl,"FOnItemShowDetailControl","FOnItemShowDetailControl"),e.addProperty("OnItemHideDetailControl",0,t.$rtti.TTMSFNCTableViewItemHideDetailControl,"FOnItemHideDetailControl","FOnItemHideDetailControl"),e.addProperty("OnHeaderAnchorClick",0,t.$rtti.TTMSFNCTableViewAnchorHeaderFooterClick,"FOnHeaderAnchorClick","FOnHeaderAnchorClick"),e.addProperty("OnFooterAnchorClick",0,t.$rtti.TTMSFNCTableViewAnchorHeaderFooterClick,"FOnFooterAnchorClick","FOnFooterAnchorClick"),e.addProperty("OnGetHTMLTemplateValue",0,t.$rtti.TTMSFNCTableViewGetHTMLTemplateValueEvent,"FOnGetHTMLTemplateValue","FOnGetHTMLTemplateValue"),e.addProperty("OnGetHTMLTemplate",0,t.$rtti.TTMSFNCTableViewGetHTMLTemplateEvent,"FOnGetHTMLTemplate","FOnGetHTMLTemplate"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),this.TMSFNCTABLEVIEWSEARCH="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABXElEQVQ4jY2TP0/CUBTFf1VJGhmoEzCQIIkDG4y4gNGJ5cnoiKMTfACCpoubDk5OfAPoUpcm4sRYEkzcsEkHJNGIRgwJiwPUtKVFz3Tzzj3n3PdPYg3KDS0NlID0cqmrq6Lr7pFChArQBGoBtAVUHaMwAxPIReUIR/kUhWyS8fs3Rt9m8PzqtFV0VXRWDMoN7RxoZhIxLk/3icoRD2+YNldtE2AC7G76DfaKJ+2oHJFvzoorYoBMMoYEDKw3GRhv+NJLgFLIJgLFDg7zKacUG0ENcWU7VOznAw2+ZvO1BlMX7zFwrsYwbU+TH1pv6JQPQRNcT2dzbu8eA8XDlw86C4MJ0NoKCgBqhmkzHH0iChniO4s9955G7vS6rgrL8w7KDS0H3ANK6PyL5Lquiha4XqJPPAEOltSxS2wBHV0VE2dBChPrquivmeIXziG6x678V+w2uFgmV/3f9S/8AOOWdCNEGLMkAAAAAElFTkSuQmCC",t.$implcode=function(){rtl.createClass(e,"TTMSFNCTreeViewOpen",t.TTMSFNCTreeViewTableView,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(e,"TTMSFNCCustomTreeViewOpen",pas["WEBLib.TMSFNCCustomTreeView"].TTMSFNCCustomTreeView,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(e,"TTMSFNCCustomTableViewOpen",t.TTMSFNCCustomTableView,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(e,"TTMSFNCTreeViewColumnOpen",pas["WEBLib.TMSFNCTreeViewData"].TTMSFNCTreeViewColumn,(function(){})),e.AnimateDouble=function(t,e,i,s){var n=!1;return n=!0,t.get()>e.get()-s&&t.get()<e.get()+s?(t.set(e.get()),n=!1):(i=Math.max(s,i),t.get()<e.get()?t.set(t.get()+i):t.set(t.get()-i)),n}}}),["Math","WEBLib.TMSFNCUtils","SysUtils","WEBLib.Graphics","WEBLib.TMSFNCCustomSelector"]),rtl.module("WEBLib.TMSFNCComboBox",["System","Classes","Types","WEBLib.Controls","WEBLib.TMSFNCCustomPicker","WEBLib.TMSFNCCustomSelector","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCTreeView","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCTypes","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCCustomTreeView"],(function(){"use strict";var t=this,e=t.$impl;rtl.createClass(this,"TTMSFNCTreeViewOpen",pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCControlPicker"].ITMSFNCControlPickerFull),rtl.addIntf(this,pas["WEBLib.TMSFNCGraphicsTypes"].ITMSFNCAppearanceGlobalFont),rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),this.TTMSFNCCustomComboBoxStyle={0:"csDropDown",csDropDown:0,1:"csDropDownList",csDropDownList:1},this.$rtti.$Enum("TTMSFNCCustomComboBoxStyle",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCCustomComboBoxStyle}),this.$rtti.$MethodVar("TTMSFNCCustomComboBoxItemSelectedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AText",rtl.string],["AItemIndex",rtl.longint]]),methodkind:0}),rtl.createClass(this,"TTMSFNCCustomComboBox",pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker.$init.call(this),this.FWrapper=null,this.FTreeView=null,this.FItems=null,this.FStyle=0,this.FAutoCloseUp=!1,this.FAutoDropDown=!1,this.FAutoComplete=!1,this.FDropDownCount=0,this.FPrevString="",this.FCaseSensitive=!1,this.FAutoCompleteNumChar=0,this.FAutoCompleteDelay=0,this.FTick=0,this.FKeyDown$1=0,this.FOnItemSelected$1=null,this.FFont$2=null,this.FBitmapContainer=null,this.FAutoFilter=!1},this.$final=function(){this.FWrapper=void 0,this.FTreeView=void 0,this.FItems=void 0,this.FOnItemSelected$1=void 0,this.FFont$2=void 0,this.FBitmapContainer=void 0,pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCDefaultPicker.$final.call(this)},this.SetItemIndex=function(t){var e=null;null!=this.FTreeView&&(e=this.FTreeView,t>=0&&t<=this.FItems.GetCount()-1?(e.SelectVirtualNode(e.GetNodeForRow(t)),null!=e.GetFocusedNode()?this.SetText(e.GetFocusedNode().GetText(0)):this.SetText("")):(e.SelectVirtualNode(null),this.SetText("")))},this.SetItems$1=function(t){this.FItems.Assign(t)},this.SetStyle=function(t){if(this.FStyle!==t){this.FStyle=t;var e=this.FStyle;0===e?(this.SetEditable(!0),this.GetPopup().FFocusedControl=this.FEdit,this.GetPopup().FStaysOpen=!0):1===e&&(this.SetEditable(!1),this.GetPopup().FFocusedControl=this.FTreeView,this.GetPopup().FStaysOpen=!1)}},this.SetAutoCloseUp=function(t){this.FAutoCloseUp=t},this.SetAutoDropDown=function(t){this.FAutoDropDown=t},this.SetAutoComplete=function(t){this.FAutoComplete=t},this.SetDropDownCount=function(t){this.FDropDownCount!==t&&(this.FDropDownCount=t,this.AdjustDropDownHeight())},this.SetItemHeight=function(t){null!=this.FTreeView&&(this.FTreeView.FNodesAppearance.SetFixedHeight(t),this.AdjustDropDownHeight())},this.SetText=function(t){this.SetContent(t)},this.SetCaseSensitive=function(t){this.FCaseSensitive=t},this.SetAutoCompleteNumChar=function(t){this.FAutoCompleteNumChar=t>0?t:1},this.SetAutoCompleteDelay=function(t){this.FAutoCompleteDelay=t},this.GetItemIndex=function(){var t=0;return t=-1,null!=this.FTreeView&&this.FTreeView.SelectedVirtualNodeCount()>0&&null!=this.FTreeView.GetSelVirtualNode(0)&&(t=this.FTreeView.GetSelVirtualNode(0).FRow),t},this.GetItemHeight=function(){var t=0;return t=0,null!=this.FTreeView&&(t=this.FTreeView.FNodesAppearance.FFixedHeight),t},this.GetText=function(){return this.GetContent()},this.SetFnt$1=function(t){this.FFont$2.AssignSource(t),this.FEdit.FFont.Assign(t)},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,null!=this.FTreeView&&this.FTreeView.SetBitmapContainer(t),this.Invalidate()},this.SetAutoFilter=function(t){this.FAutoFilter=t},this.GetItemAppearance=function(){return this.FTreeView.FNodesAppearance},this.SetItemAppearance=function(t){this.FTreeView.FNodesAppearance.Assign(t)},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null,null!=this.FTreeView&&this.FTreeView.SetBitmapContainer(null))},this.FontChange=function(t){this.Invalidate(),this.FEdit.FFont.Assign(this.FFont$2)},this.Loaded=function(){pas["WEBLib.Controls"].TCustomControl.Loaded.call(this),this.AdjustDropDownHeight()},this.DoComboBoxItemSelected=function(t,e){null!=this.FOnItemSelected$1&&this.FOnItemSelected$1(this,t,e)},this.DrawContent=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new();pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.DrawContent.apply(this,arguments),this.FEditable&&!this.IsExporting()||(this.FEnabled?t.FFont.AssignSource(this.FFont$2):t.FFont.SetColor(12632256),i.$assign(e),pas["WEBLib.TMSFNCTypes"].InflateRectEx(i,-3,-3),t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i),this.GetContent(),!1,1,0,0,0,-1,-1,!0,!1,-1,-1))},this.InitializePopup=function(){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.InitializePopup.call(this),null!=this.FTreeView&&(this.FTreeView.FFill.Assign(this.GetFill()),this.FTreeView.FStroke.Assign(this.GetStroke()),this.FTreeView.SetHeight(Math.round(this.FDropDownHeight)),this.FTreeView.SetVerticalScrollBarVisible(this.FItems.GetCount()>this.FDropDownCount),null!=this.FTreeView.GetNodeForRow(this.GetItemIndex())&&this.FTreeView.ScrollToVirtualNode(this.FTreeView.GetNodeForRow(this.GetItemIndex()),!1,0,!1))},this.SelectFirstValue=function(){var t=null;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectFirstValue.call(this),null!=this.FTreeView&&null!=(t=this.FTreeView.GetFirstVisibleVirtualNode())&&null!=t.FNode&&(this.FTreeView.SelectNode(t.FNode),this.SetContent(t.FNode.GetText(0)),this.DoComboBoxItemSelected(t.FNode.GetText(0),t.FNode.GetIndex()),this.Invalidate())},this.SelectLastValue=function(){var t=null;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectLastValue.call(this),null!=this.FTreeView&&null!=(t=this.FTreeView.GetLastVisibleVirtualNode())&&null!=t.FNode&&(this.FTreeView.SelectNode(t.FNode),this.SetContent(t.FNode.GetText(0)),this.DoComboBoxItemSelected(t.FNode.GetText(0),t.FNode.GetIndex()),this.Invalidate())},this.SelectNextValue=function(){var t=null;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectNextValue.call(this),null!=this.FTreeView&&null!=(t=this.FTreeView.GetNextFocusableNode(this.FTreeView.GetFocusedVirtualNode()))&&null!=t.FNode&&(this.FTreeView.SelectNode(t.FNode),this.SetContent(t.FNode.GetText(0)),this.DoComboBoxItemSelected(t.FNode.GetText(0),t.FNode.GetIndex()),this.Invalidate())},this.SelectPreviousValue=function(){var t=null;pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SelectPreviousValue.call(this),null!=this.FTreeView&&null!=(t=this.FTreeView.GetPreviousFocusableNode(this.FTreeView.GetFocusedVirtualNode()))&&null!=t.FNode&&(this.FTreeView.SelectNode(t.FNode),this.SetContent(t.FNode.GetText(0)),this.DoComboBoxItemSelected(t.FNode.GetText(0),t.FNode.GetIndex()),this.Invalidate())},this.ItemsChanged=function(t){var e=0;if(null!=this.FTreeView){this.FTreeView.BeginUpdate(),this.FTreeView.ClearNodes();for(var i=0,s=this.FItems.GetCount()-1;i<=s;i++)e=i,this.FTreeView.FNodes.Add$1().SetText(0,this.FItems.Get(e));this.FTreeView.EndUpdate(),this.AdjustDropDownHeight()}},this.SetAdaptToStyle=function(t){pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.SetAdaptToStyle.apply(this,arguments),null!=this.FWrapper&&this.FWrapper.SetAdaptToStyle(this.GetAdaptToStyle()),null!=this.FTreeView&&this.FTreeView.SetAdaptToStyle(this.GetAdaptToStyle())},this.ComboBoxNodeTextAlign=function(t,e,i,s){s.set(1)},this.ComboBoxItemClicked=function(t,e){var i=null;null!=e&&null!=e.FNode&&(this.SetContent(e.FNode.GetText(0)),this.DoComboBoxItemSelected(e.FNode.GetText(0),e.FNode.GetIndex()),i=e.FNode,this.FTreeView.RemoveFilters(),this.FTreeView.SelectNode(i)),this.DropDown(),this.Invalidate()},this.AdjustDropDownHeight=function(){var t=0,e=0;null!=this.FTreeView&&(e=this.GetVisibleItemCount(),t=Math.min(this.FDropDownCount,e)*this.FTreeView.FNodesAppearance.FFixedHeight+1,this.SetDropDownHeight(t))},this.UpdateListBoxLookup=function(t){var e,i=null;this.FAutoFilter&&(this.FTreeView.FFilter.Clear(),(i=this.FTreeView.FFilter.Add$1()).FCondition=t+"*",i.FCaseSensitive=this.FCaseSensitive,this.FTreeView.ApplyFilter()),e=this.GetVisibleItemCount(),this.FAutoDropDown&&t.length>=this.FAutoCompleteNumChar&&!this.GetPopup().FIsOpen&&e>0&&this.DropDown()},this.DeleteFromEdit=function(){this.FPrevString=this.FEdit.GetText(),0===this.FEdit.GetSelLength()?pas.System.Delete({p:this,get:function(){return this.p.FPrevString},set:function(t){this.p.FPrevString=t}},this.FEdit.GetSelStart(),1):pas.System.Delete({p:this,get:function(){return this.p.FPrevString},set:function(t){this.p.FPrevString=t}},Math.max(1,this.FEdit.GetSelStart()+1),this.FEdit.GetSelLength()),this.UpdateListBoxLookup(this.FPrevString),this.FPrevString.length<this.FAutoCompleteNumChar&&this.GetPopup().FIsOpen&&(this.DropDown(),this.FTreeView.RemoveFilters())},this.EditKeyDown$1=function(t,e,i){if(this.FKeyDown$1=e.get(),115!==this.FKeyDown$1){if(1 in i){var s=this.FKeyDown$1;if(40===s||38===s)return void this.DropDown()}rtl.neSet(i,rtl.createSet(1))&&this.FKeyDown$1 in rtl.createSet(38,40)&&(38===this.FKeyDown$1&&this.SelectPreviousValue(),40===this.FKeyDown$1&&this.SelectNextValue(),e.set(0)),8===this.FKeyDown$1&&this.DeleteFromEdit()}else this.DropDown()},this.EditKeyPress$1=function(t,e){var i,s=null,n=0,o=0;if(null!=this.FTreeView){if(i=e.get(),27===this.FKeyDown$1)return this.FAutoCloseUp&&this.GetPopup().FIsOpen,void this.DropDown();if(13===this.FKeyDown$1)return this.GetPopup().FIsOpen&&(this.FEdit.SetSelStart(this.FEdit.GetText().length),this.FEdit.SetSelLength(0),this.FTreeView.RemoveFilters()),void this.DropDown();if(this.FAutoComplete){if("\0"===i)return;if(this.FEdit.GetSelLength()===this.FEdit.GetText().length&&(this.FPrevString=""),this.FPrevString=this.FPrevString+i,this.FPrevString.length<this.FAutoCompleteNumChar)return;this.UpdateListBoxLookup(this.FPrevString),null!=(s=this.FTreeView.LookupNode(this.FPrevString,!1,-1,this.FCaseSensitive,!1,!1))&&null!=s.FNode&&(this.FTreeView.SelectNode(s.FNode),n=this.FPrevString.length,this.SetContent(s.FNode.GetText(0)),this.FEdit.SetSelStart(n),o=this.FEdit.GetText().length-n,this.FEdit.SetSelLength(o),e.set("\0"),this.FAutoCloseUp&&0===o&&this.GetPopup().FIsOpen&&(this.DoComboBoxItemSelected(s.FNode.GetText(0),s.FNode.GetIndex()),this.DropDown()))}}},this.KeyPress=function(t){var i=null,s="",n=0;if(pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.KeyPress.apply(this,arguments),null!=this.FTreeView){if(s=t.get(),27===this.FKeyDown$1)return this.GetPopup().FIsOpen,void this.DropDown();if(this.FAutoComplete){if(8===this.FKeyDown$1)return pas.System.Delete({p:this,get:function(){return this.p.FPrevString},set:function(t){this.p.FPrevString=t}},this.FPrevString.length,1),void(1===this.FPrevString.length&&this.GetPopup().FIsOpen&&(this.DropDown(),this.FTreeView.RemoveFilters()));if("\0"===s)return;this.FAutoDropDown&&!this.GetPopup().FIsOpen&&this.DropDown(),n=this.FAutoCompleteDelay,e.GetTickCountX()-this.FTick<n?this.FPrevString=this.FPrevString+s:(this.FTick=e.GetTickCountX(),this.FPrevString=s)}else{if("\0"===s)return;this.FPrevString=s}null!=(i=this.FTreeView.LookupNode(this.FPrevString,!1,-1,this.FCaseSensitive,!1,!1))&&null!=i.FNode&&(this.FTreeView.SelectNode(i.FNode),this.SetContent(i.FNode.GetText(0)),this.DoComboBoxItemSelected(i.FNode.GetText(0),i.FNode.GetIndex()),this.Invalidate(),this.FAutoComplete&&this.GetContent()===this.FPrevString&&this.FAutoCloseUp&&this.GetPopup().FIsOpen&&this.DropDown())}},this.KeyDown=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBase.KeyDown.apply(this,arguments),this.FKeyDown$1=t.get()},this.TreeviewKeyUp=function(t,e,i){var s=null;if(this.FKeyDown$1=e.get(),13===this.FKeyDown$1)return s=this.FTreeView,this.SetContent(s.GetFocusedNode().GetText(0)),this.DropDown(),void this.Invalidate()},this.TreeViewMouseDown=function(t,e,i,s,n){this.FEditable&&(this.FPreventDropDown=!0)},this.CreateSelector=function(){var t=null;return this.FWrapper=pas["WEBLib.TMSFNCCustomSelector"].TTMSFNCCustomSelector.$create("Create$1",[this]),this.FTreeView=pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$create("Create$1",[this.FWrapper]),this.FTreeView.SetParent(this.FWrapper),this.FTreeView.SetControlAlignment(5),this.FTreeView.SetVerticalScrollBarVisible(!1),this.FTreeView.FOnMouseDown=rtl.createCallback(this,"TreeViewMouseDown"),this.FTreeView.FOnNodeClick=rtl.createCallback(this,"ComboBoxItemClicked"),this.FTreeView.FOnKeyUp=rtl.createCallback(this,"TreeviewKeyUp"),this.FTreeView.FOnGetNodeHorizontalTextAlign=rtl.createCallback(this,"ComboBoxNodeTextAlign"),this.FTreeView.FNodesAppearance.SetFixedHeight(16),this.FTreeView.FColumns.Clear(),(t=this.FTreeView.FColumns.Add$1()).SetText("Header"),t.SetHorizontalTextAlign(0),this.FTreeView.ClearNodes(),this.FTreeView.FColumnsAppearance.SetLayouts({}),this.FTreeView.SetStretchScrollBars(!0),this.FTreeView.FNodesAppearance.SetExpandColumn(-1),this.FTreeView.FNodesAppearance.SetLevelIndent(0),this.FTreeView.FNodesAppearance.SetShowLines(!1),this.FTreeView.FNodesAppearance.SetExpandWidth(0),this.FTreeView.FNodesAppearance.SetExpandHeight(0),this.FTreeView.FNodesAppearance.SetSelectionArea(1),this.FTreeView.FNodesAppearance.SetShowFocus(!1),this.FWrapper},this.GetVisibleItemCount=function(){var t=0;return t=0,null!=this.FTreeView&&(t=this.FTreeView.FVisibleNodes.GetCount()),t},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.Create$1.apply(this,arguments),this.SetWidth(150),this.SetDropDownWidth(this.GetWidth()),this.SetDropDownCount(8),this.FItems=pas.Classes.TStringList.$create("Create$1"),this.FItems.FOnChange=rtl.createCallback(this,"ItemsChanged"),this.SetEditable(!0),this.FPrevString="",this.FAutoFilter=!0,this.FAutoComplete=!0,this.FAutoCloseUp=!1,this.FAutoDropDown=!1,this.FCaseSensitive=!1,this.FAutoCompleteNumChar=2,this.FAutoCompleteDelay=500,this.FFont$2=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FFont$2.FOnChanged=rtl.createCallback(this,"FontChange"),this.FEdit.FOnKeyDown=rtl.createCallback(this,"EditKeyDown$1"),this.FEdit.FOnKeyPress=rtl.createCallback(this,"EditKeyPress$1"),this.GetPopup().FFocusedControl=this.FEdit,this.GetPopup().FStaysOpen=!0,this.IsDesignTime()&&this.SetText("TTMSFNCComboBox"),this},this.Destroy=function(){rtl.free(this,"FFont$2"),rtl.free(this,"FItems"),pas["WEBLib.TMSFNCCustomPicker"].TTMSFNCCustomPicker.Destroy.call(this)},this.AddItem=function(t){this.FItems.Add(t)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCComboBox",this.TTMSFNCCustomComboBox,(function(){this.RegisterRuntimeClasses=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.RegisterRuntimeClasses.call(this),pas.Classes.RegisterClass(t.TTMSFNCComboBox)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("AutoCloseUp",2,rtl.boolean,"FAutoCloseUp","SetAutoCloseUp",{Default:!1}),e.addProperty("AutoDropDown",2,rtl.boolean,"FAutoDropDown","SetAutoDropDown",{Default:!1}),e.addProperty("AutoComplete",2,rtl.boolean,"FAutoComplete","SetAutoComplete",{Default:!0}),e.addProperty("AutoCompleteDelay",2,rtl.longint,"FAutoCompleteDelay","SetAutoCompleteDelay",{Default:500}),e.addProperty("AutoCompleteNumChar",2,rtl.longint,"FAutoCompleteNumChar","SetAutoCompleteNumChar",{Default:2}),e.addProperty("AutoFilter",2,rtl.boolean,"FAutoFilter","SetAutoFilter",{Default:!0}),e.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),e.addProperty("CaseSensitive",2,rtl.boolean,"FCaseSensitive","SetCaseSensitive",{Default:!1}),e.addProperty("DropDownCount",2,rtl.longint,"FDropDownCount","SetDropDownCount",{Default:8}),e.addProperty("DropDownWidth",14,rtl.double,"FDropDownWidth","SetDropDownWidth",{stored:"IsDropDownWidthStored"}),e.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont$2","SetFnt$1"),e.addProperty("Items",2,pas.Classes.$rtti.TStringList,"FItems","SetItems$1"),e.addProperty("ItemIndex",3,rtl.longint,"GetItemIndex","SetItemIndex",{Default:-1}),e.addProperty("ItemHeight",3,rtl.double,"GetItemHeight","SetItemHeight"),e.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus$1","SetShowFocus$1",{Default:!0}),e.addProperty("Style",2,t.$rtti.TTMSFNCCustomComboBoxStyle,"FStyle","SetStyle",{Default:t.TTMSFNCCustomComboBoxStyle.csDropDown}),e.addProperty("Text",3,rtl.string,"GetText","SetText"),e.addProperty("ItemAppearance",3,pas["WEBLib.TMSFNCCustomTreeView"].$rtti.TTMSFNCTreeViewNodesAppearance,"GetItemAppearance","SetItemAppearance"),e.addProperty("Appearance",3,pas["WEBLib.TMSFNCCustomSelector"].$rtti.TTMSFNCCustomSelectorAppearance,"GetAppearance","SetAppearance"),e.addProperty("OnItemSelected",0,t.$rtti.TTMSFNCCustomComboBoxItemSelectedEvent,"FOnItemSelected$1","FOnItemSelected$1"),e.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]})),t.$implcode=function(){e.GetTickCountX=function(){var t=0,e=0,i=0,s=0;return pas.SysUtils.DecodeTime(pas.SysUtils.Now(),{get:function(){return t},set:function(e){t=e}},{get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),s+1e3*i+60*e*1e3+60*t*60*1e3}}}),["Math","SysUtils","WEBLib.TMSFNCUtils","WEBLib.TMSFNCCustomControl","WEBLib.StdCtrls"]),rtl.module("WEBLib.TMSFNCHTMLImageContainer",["System","Classes","Types","WEBLib.Controls","WEBLib.TMSFNCCustomControl","WEBLib.TMSFNCBitmapContainer","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCUtils","WEBLib.TMSFNCStyles"],(function(){"use strict";var t=this,e=t.$impl;this.TTMSFNCHTMLImageContainerWidgetPosition={0:"hwpLeft",hwpLeft:0,1:"hwpRight",hwpRight:1},this.$rtti.$Enum("TTMSFNCHTMLImageContainerWidgetPosition",{minvalue:0,maxvalue:1,ordtype:1,enumtype:this.TTMSFNCHTMLImageContainerWidgetPosition}),this.$rtti.$MethodVar("TTMSFNCHTMLImageContainerBeforeDrawWidgetEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AWidgetPosition",this.$rtti.TTMSFNCHTMLImageContainerWidgetPosition],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCHTMLImageContainerAfterDrawWidgetEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AWidgetPosition",this.$rtti.TTMSFNCHTMLImageContainerWidgetPosition]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCHTMLImageContainerBeforeDrawTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string],["AAllow",rtl.boolean,1],["ADefaultDraw",rtl.boolean,1]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCHTMLImageContainerAfterDrawTextEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AGraphics",pas["WEBLib.TMSFNCGraphics"].$rtti.TTMSFNCGraphics],["ARect",pas["WEBLib.TMSFNCTypes"].$rtti.TRectF],["AText",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCHTMLImageContainerAnchorClickEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AAnchor",rtl.string]]),methodkind:0}),this.$rtti.$MethodVar("TTMSFNCHTMLImageContainerCheckedStateChangedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AChecked",rtl.boolean]]),methodkind:0}),rtl.createClass(this,"TTMSFNCHTMLImageContainer",pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl,(function(){this.$init=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$init.call(this),this.FBitmapContainer=null,this.FChecked=!1,this.FText="",this.FWordWrapping=!1,this.FTrimming=0,this.FVerticalTextAlign=0,this.FHorizontalTextAlign=0,this.FOnChange=null,this.FWidgetPosition=0,this.FOnAfterDrawText=null,this.FOnAfterDrawWidget=null,this.FOnBeforeDrawText=null,this.FOnBeforeDrawWidget=null,this.FBitmapName="",this.FWidgetImage=null,this.FOnAnchorClick=null,this.FOnCheckedStateChanged=null,this.FFont$1=null,this.AnchorText=""},this.$final=function(){this.FBitmapContainer=void 0,this.FOnChange=void 0,this.FOnAfterDrawText=void 0,this.FOnAfterDrawWidget=void 0,this.FOnBeforeDrawText=void 0,this.FOnBeforeDrawWidget=void 0,this.FWidgetImage=void 0,this.FOnAnchorClick=void 0,this.FOnCheckedStateChanged=void 0,this.FFont$1=void 0,pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.$final.call(this)},this.SetBitmapContainer=function(t){this.FBitmapContainer=t,this.Invalidate()},this.SetText=function(t){this.FText!==t&&(this.FText=t,this.DoChange())},this.SetTrimming=function(t){this.FTrimming!==t&&(this.FTrimming=t,this.DoChange())},this.SetWordWrapping=function(t){this.FWordWrapping!==t&&(this.FWordWrapping=t,this.DoChange())},this.SetHorizontalTextAlign=function(t){this.FHorizontalTextAlign!==t&&(this.FHorizontalTextAlign=t,this.DoChange())},this.SetVerticalTextAlign=function(t){this.FVerticalTextAlign!==t&&(this.FVerticalTextAlign=t,this.DoChange())},this.SetWidgetPosition=function(t){this.FWidgetPosition!==t&&(this.FWidgetPosition=t,this.DoChange())},this.SetBitmapName=function(t){this.FBitmapName!==t&&(this.FBitmapName=t,this.DoChange())},this.SetFnt=function(t){this.FFont$1.AssignSource(t)},this.GetBitmapContainer=function(){return this.FBitmapContainer},this.IsTextStored=function(){return""!==this.FText},this.Notification=function(t,e){pas["WEBLib.Menus"].TWebCustomControl.Notification.apply(this,arguments),1===e&&t===this.FBitmapContainer&&(this.FBitmapContainer=null)},this.Draw=function(t,e){var i=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=!1,o=!1;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Draw.apply(this,arguments),n=!0,o=!0,t.FBitmapContainer=this.GetBitmapContainer(),i.$assign(this.GetWidgetAreaRect()),s.$assign(this.GetTextRect()),this.DoBeforeDrawWidget(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FWidgetPosition,{get:function(){return n},set:function(t){n=t}},{get:function(){return o},set:function(t){o=t}}),n&&(o&&this.DoDrawWidget(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(i)),this.DoAfterDrawWidget(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FWidgetPosition)),this.DoDrawText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s))},this.HandleMouseMove=function(t,e,i){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseMove.apply(this,arguments),this.AnchorText=this.XYToAnchor(e,i),""!==this.AnchorText?this.SetControlCursor(21):this.SetControlCursor(0)},this.HandleMouseUp=function(t,e,i,s){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseUp.apply(this,arguments),this.SetFocus(),this.AnchorText=this.XYToAnchor(i,s),""!==this.AnchorText&&this.DoAnchorClick(this.AnchorText)},this.DoDrawWidget=function(t,e){null!=this.FWidgetImage&&t.DrawBitmap$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FWidgetImage,!0,!1,!0,!1)},this.DoDrawText=function(t,e){var i=!1,s=!1;t.FFont.Assign(this.FFont$1),this.FEnabled||t.FFont.SetColor(10789024),i=!0,s=!0,this.DoBeforeDrawText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FText,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),i&&(s&&t.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FText,this.FWordWrapping,this.FHorizontalTextAlign,this.FVerticalTextAlign,this.FTrimming,0,-1,-1,!0,!1,-1,-1),this.DoAfterDrawText(t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),this.FText))},this.DoExit=function(){pas["WEBLib.Controls"].TControl.DoExit.call(this),this.Invalidate()},this.DoEnter=function(){pas["WEBLib.Controls"].TControl.DoEnter.call(this),this.Invalidate()},this.ApplyStyle=function(){var t=0;pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ApplyStyle.call(this),this.FFill.SetKind(0),t=-1,pas["WEBLib.TMSFNCStyles"].TTMSFNCStyles.GetStyleTextFontColor({get:function(){return t},set:function(e){t=e}})&&this.FFont$1.SetColor(t)},this.ResetToDefaultStyle=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.ResetToDefaultStyle.call(this),this.FFill.SetColor(-1),this.FFill.SetKind(0),this.FFont$1.SetColor(0)},this.DoChange=function(){null!=this.FOnChange&&this.FOnChange(this),this.Invalidate()},this.DoBeforeDrawWidget=function(t,e,i,s,n){null!=this.FOnBeforeDrawWidget&&this.FOnBeforeDrawWidget(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoAfterDrawWidget=function(t,e,i){null!=this.FOnAfterDrawWidget&&this.FOnAfterDrawWidget(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoBeforeDrawText=function(t,e,i,s,n){null!=this.FOnBeforeDrawText&&this.FOnBeforeDrawText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i,s,n)},this.DoAfterDrawText=function(t,e,i){null!=this.FOnAfterDrawText&&this.FOnAfterDrawText(this,t,pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e),i)},this.DoAnchorClick=function(t){null!=this.FOnAnchorClick?this.FOnAnchorClick(this,t):pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.OpenURL(t)},this.DoCheckedStateChanged=function(t){null!=this.FOnCheckedStateChanged&&this.FOnCheckedStateChanged(this,t)},this.SetChecked=function(t){this.FChecked!==t&&(this.FChecked=t,this.DoCheckedStateChanged(this.FChecked),this.DoChange())},this.SetEnabled=function(t){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.SetEnabled.apply(this,arguments),this.Invalidate()},this.XYToAnchor=function(t,e){var i="",s=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),n=null;i="",s.$assign(this.GetTextRect()),(n=pas["WEBLib.TMSFNCGraphics"].TTMSFNCGraphics.$create("CreateBitmapCanvas",[1,1,!1,!0])).BeginScene(),n.FBitmapContainer=this.GetBitmapContainer();try{n.FFont.Assign(this.FFont$1),i=n.DrawText$1(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FText,this.FWordWrapping,this.FHorizontalTextAlign,this.FVerticalTextAlign,this.FTrimming,0,-1,-1,!0,!0,t,e)}finally{n.EndScene(),n=rtl.freeLoc(n)}return i},this.GetWidgetImage=function(t){var e=null,i=0;if(e=null,null==this.GetBitmapContainer())return e;for(var s=0,n=this.GetBitmapContainer().ItemCount()-1;s<=n;s++)if(i=s,this.GetBitmapContainer().GetBitmapName(i)===this.FBitmapName){e=this.GetBitmapContainer().GetBitmap(i);break}return e},this.GetTextRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return null!=this.FWidgetImage?0===this.FWidgetPosition?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.FWidgetImage.GetWidth()+0,0,this.GetWidth(),this.GetHeight())):t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.GetWidth()-this.FWidgetImage.GetWidth()-0,this.GetHeight())):0===this.FWidgetPosition?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.ScalePaintValue(25)+this.ScalePaintValue(0),0,this.GetWidth(),this.GetHeight())):t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.GetWidth()-this.ScalePaintValue(25)-this.ScalePaintValue(0),this.GetHeight())),t},this.GetWidgetAreaRect=function(){var t=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return this.FWidgetImage=this.GetWidgetImage(this.FBitmapName),null!=this.FWidgetImage?0===this.FWidgetPosition?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.FWidgetImage.GetWidth(),this.GetHeight())):t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.GetWidth()-this.FWidgetImage.GetWidth(),0,this.GetWidth(),this.GetHeight())):0===this.FWidgetPosition?t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(0,0,this.ScalePaintValue(25),this.GetHeight())):t.$assign(pas["WEBLib.TMSFNCTypes"].RectF(this.GetWidth()-this.ScalePaintValue(25),0,this.GetWidth(),this.GetHeight())),t},this.GetWidgetRectangle=function(t){var e,i,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();return e=(t.Right-t.Left-16)/2,i=(t.Bottom-t.Top-16)/2,s.$assign(pas["WEBLib.TMSFNCTypes"].RectF(t.Left+e,t.Top+i,t.Left+e+16,t.Top+i+16)),s},this.Create$1=function(t){return pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Create$1.apply(this,arguments),this.FChecked=!1,this.FWordWrapping=!1,this.FTrimming=0,this.FHorizontalTextAlign=1,this.FVerticalTextAlign=0,this.FBitmapName="",this.FWidgetImage=null,this.FWidgetPosition=0,this.SetHeight(22),this.SetWidth(150),this.FStroke.SetKind(0),this.FStroke.SetColor(-1),this.FFill.SetColor(-1),this.FFont$1=pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsFont.$create("Create$2"),this.FTransparent=!0,this},this.Destroy=function(){rtl.free(this,"FFont$1"),pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Destroy.call(this)},this.Assign=function(e){t.TTMSFNCHTMLImageContainer.isPrototypeOf(e)?(this.FChecked=rtl.as(e,t.TTMSFNCHTMLImageContainer).FChecked,this.FText=rtl.as(e,t.TTMSFNCHTMLImageContainer).FText,this.FWordWrapping=rtl.as(e,t.TTMSFNCHTMLImageContainer).FWordWrapping,this.FTrimming=rtl.as(e,t.TTMSFNCHTMLImageContainer).FTrimming,this.FHorizontalTextAlign=rtl.as(e,t.TTMSFNCHTMLImageContainer).FHorizontalTextAlign,this.FVerticalTextAlign=rtl.as(e,t.TTMSFNCHTMLImageContainer).FVerticalTextAlign,this.FBitmapName=rtl.as(e,t.TTMSFNCHTMLImageContainer).FBitmapName,this.SetHeight(rtl.as(e,t.TTMSFNCHTMLImageContainer).GetHeight()),this.SetWidth(rtl.as(e,t.TTMSFNCHTMLImageContainer).GetWidth()),this.FFont$1.AssignSource(rtl.as(e,t.TTMSFNCHTMLImageContainer).FFont$1),this.FWidgetPosition=rtl.as(e,t.TTMSFNCHTMLImageContainer).FWidgetPosition):pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControl.Assign.apply(this,arguments)},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),t.$implcode=function(){e.WIDGETWIDTH=25,e.TXTMARGIN=0}}),[]),rtl.module("WEBLib.TMSFNCCheckBox",["System","Classes","Types","WEBLib.Controls","WEBLib.TMSFNCHTMLImageContainer","WEBLib.TMSFNCTypes","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCUtils"],(function(){"use strict";rtl.createClass(this,"TTMSFNCCustomCheckBox",pas["WEBLib.TMSFNCHTMLImageContainer"].TTMSFNCHTMLImageContainer,(function(){this.$init=function(){pas["WEBLib.TMSFNCHTMLImageContainer"].TTMSFNCHTMLImageContainer.$init.call(this),this.FStartSize=0,this.FMouseHover=!1},this.DoDrawWidget=function(t,e){var i=!1,s=pas["WEBLib.TMSFNCTypes"].TRectF.$new();pas["WEBLib.TMSFNCHTMLImageContainer"].TTMSFNCHTMLImageContainer.DoDrawWidget.apply(this,arguments),null==this.FWidgetImage&&(i=this.IsFocused()||this.FMouseHover,s.$assign(this.GetWidgetRectangle(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(e))),t.DrawCheckBox(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(s),this.FChecked,i,this.FEnabled,1))},this.HandleMouseUp=function(t,e,i,s){pas["WEBLib.TMSFNCHTMLImageContainer"].TTMSFNCHTMLImageContainer.HandleMouseUp.apply(this,arguments),this.FEnabled&&""===this.AnchorText&&this.SetChecked(!this.FChecked)},this.HandleMouseLeave=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseLeave.call(this),this.FEnabled&&(this.FMouseHover=!1,this.Invalidate())},this.HandleMouseEnter=function(){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleMouseEnter.call(this),this.FEnabled&&(this.FMouseHover=!0,this.Invalidate())},this.HandleKeyDown=function(t,e){pas["WEBLib.TMSFNCCustomControl"].TTMSFNCCustomControlBaseCommon.HandleKeyDown.apply(this,arguments),32!==t.get()&&13!==t.get()||this.SetChecked(!this.FChecked)},this.Create$1=function(t){var e=0;return pas["WEBLib.TMSFNCHTMLImageContainer"].TTMSFNCHTMLImageContainer.Create$1.apply(this,arguments),this.FMouseHover=!1,this.SetText("TMSFNCCheckBox"),e=pas["WEBLib.TMSFNCUtils"].TTMSFNCUtils.GetDPIScale(this,96),this.FStartSize=1===e?15:13,this},rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTMSFNCCheckBox",this.TTMSFNCCustomCheckBox,(function(){rtl.addIntf(this,pas["WEBLib.TMSFNCBitmapContainer"].ITMSFNCBitmapContainer),rtl.addIntf(this,pas["WEBLib.TMSFNCPersistence"].ITMSFNCPersistence),rtl.addIntf(this,pas["WEBLib.TMSFNCStyles"].ITMSFNCAdaptToStyle),rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addProperty("BitmapContainer",3,pas["WEBLib.TMSFNCBitmapContainer"].$rtti.TTMSFNCBitmapContainer,"GetBitmapContainer","SetBitmapContainer"),t.addProperty("BitmapName",2,rtl.string,"FBitmapName","SetBitmapName"),t.addProperty("Checked",2,rtl.boolean,"FChecked","SetChecked",{Default:!1}),t.addProperty("WidgetPosition",2,pas["WEBLib.TMSFNCHTMLImageContainer"].$rtti.TTMSFNCHTMLImageContainerWidgetPosition,"FWidgetPosition","SetWidgetPosition",{Default:pas["WEBLib.TMSFNCHTMLImageContainer"].TTMSFNCHTMLImageContainerWidgetPosition.hwpLeft}),t.addProperty("WordWrapping",2,rtl.boolean,"FWordWrapping","SetWordWrapping",{Default:!1}),t.addProperty("Trimming",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextTrimming,"FTrimming","SetTrimming",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextTrimming.gttNone}),t.addProperty("Text",14,rtl.string,"FText","SetText",{stored:"IsTextStored"}),t.addProperty("Font",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsFont,"FFont$1","SetFnt"),t.addProperty("HorizontalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FHorizontalTextAlign","SetHorizontalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaLeading}),t.addProperty("VerticalTextAlign",2,pas["WEBLib.TMSFNCGraphicsTypes"].$rtti.TTMSFNCGraphicsTextAlign,"FVerticalTextAlign","SetVerticalTextAlign",{Default:pas["WEBLib.TMSFNCGraphicsTypes"].TTMSFNCGraphicsTextAlign.gtaCenter}),t.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnChange","FOnChange"),t.addProperty("OnCheckedStateChanged",0,pas["WEBLib.TMSFNCHTMLImageContainer"].$rtti.TTMSFNCHTMLImageContainerCheckedStateChangedEvent,"FOnCheckedStateChanged","FOnCheckedStateChanged"),t.addProperty("OnAnchorClick",0,pas["WEBLib.TMSFNCHTMLImageContainer"].$rtti.TTMSFNCHTMLImageContainerAnchorClickEvent,"FOnAnchorClick","FOnAnchorClick"),t.addProperty("OnBeforeDrawWidget",0,pas["WEBLib.TMSFNCHTMLImageContainer"].$rtti.TTMSFNCHTMLImageContainerBeforeDrawWidgetEvent,"FOnBeforeDrawWidget","FOnBeforeDrawWidget"),t.addProperty("OnAfterDrawWidget",0,pas["WEBLib.TMSFNCHTMLImageContainer"].$rtti.TTMSFNCHTMLImageContainerAfterDrawWidgetEvent,"FOnAfterDrawWidget","FOnAfterDrawWidget"),t.addProperty("OnBeforeDrawText",0,pas["WEBLib.TMSFNCHTMLImageContainer"].$rtti.TTMSFNCHTMLImageContainerBeforeDrawTextEvent,"FOnBeforeDrawText","FOnBeforeDrawText"),t.addProperty("OnAfterDrawText",0,pas["WEBLib.TMSFNCHTMLImageContainer"].$rtti.TTMSFNCHTMLImageContainerAfterDrawTextEvent,"FOnAfterDrawText","FOnAfterDrawText"),t.attr=[pas.Classes.ComponentPlatformsAttribute,"Create$1",[0]]}))})),rtl.module("WEbLib.SEConstable.PopupMenu",["System","Classes","WEBLib.Menus","WEBLib.Menus"],(function(){"use strict";rtl.createClass(this,"TSEPopupMenu",pas["WEBLib.Menus"].TWebPopupMenu,(function(){rtl.addIntf(this,pas.System.IUnknown)}))})),rtl.module("WebLib.SERTTK.CVSessionViewer",["System","Generics.Collections","Classes","Types","WEBLib.TMSFNCTreeView","WEBLib.TMSFNCPageControl","WEBLib.TMSFNCHTMLText","WEBLib.TMSFNCTableView","WEBLib.TMSFNCImage","WEBLib.ExtCtrls","WEBLib.TMSFNCComboBox","WEBLib.TMSFNCCheckBox","WEBLib.TMSFNCSplitter","WEBLib.TMSFNCGraphicsTypes","WEBLib.TMSFNCEdit","WebLib.SEFNC.Layout","WEBLib.StdCtrls","WEbLib.SEConstable.PopupMenu","WEBLib.Controls","WebLib.SEConstable.CVTypes","WebLib.SEconstable.Session","WEBLib.TMSFNCTypes"],(function(){"use strict";var t=this;rtl.createClass(this,"TSECVInspectStepDetail",pas["WebLib.SEFNC.Layout"].TSEFNCLayout,(function(){this.$init=function(){pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$init.call(this),this.FPageContainer=null,this.FOwner$1=null,this.FDetailText=null,this.FLeftText=null,this.FRightText=null,this.FImageBefore=null,this.FImageAfter=null,this.FDetailSplit=null,this.FCBScreens=null,this.FInspectorStep=null,this.FSession=null,this.FImagePopMenu=null,this.FDiffAnalysis=null,this.FDiffAnalyzed=!1,this.FlytDetailClient=null,this.FlytLeftDetail=null,this.FlytRightDetail=null,this.FImageBeforeDrawDiffs=null,this.FImageAfterDrawDiffs=null,this.FImageBeforeNoiseLevel=null,this.FImageAfterNoiseLevel=null},this.$final=function(){this.FPageContainer=void 0,this.FOwner$1=void 0,this.FDetailText=void 0,this.FLeftText=void 0,this.FRightText=void 0,this.FImageBefore=void 0,this.FImageAfter=void 0,this.FDetailSplit=void 0,this.FCBScreens=void 0,this.FInspectorStep=void 0,this.FSession=void 0,this.FImagePopMenu=void 0,this.FDiffAnalysis=void 0,this.FlytDetailClient=void 0,this.FlytLeftDetail=void 0,this.FlytRightDetail=void 0,this.FImageBeforeDrawDiffs=void 0,this.FImageAfterDrawDiffs=void 0,this.FImageBeforeNoiseLevel=void 0,this.FImageAfterNoiseLevel=void 0,pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$final.call(this)},this.BuildDetailView=function(){var t=null;(t=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner$1])).SetParent(this),t.SetAlignment$1(1),t.SetHeight(32),this.FlytDetailClient=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner$1]),this.FlytDetailClient.SetParent(this),this.FlytDetailClient.SetAlignment$1(5),this.FDetailText=pas["WEBLib.TMSFNCHTMLText"].TTMSFNCHTMLText.$create("Create$1",[this.FOwner$1]),this.FDetailText.SetParent(t),this.FDetailText.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FCBScreens=pas["WEBLib.TMSFNCComboBox"].TTMSFNCComboBox.$create("Create$1",[this.FOwner$1]),this.FCBScreens.SetParent(t),this.FCBScreens.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(4)),this.FCBScreens.SetStyle(1),this.FCBScreens.FOnItemSelected$1=rtl.createCallback(this,"CBScreensItemSelected"),this.FlytLeftDetail=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner$1]),this.FlytLeftDetail.SetParent(this.FlytDetailClient),this.FlytLeftDetail.SetAlignment$1(3),this.FlytLeftDetail.SetWidth(300),this.FLeftText=pas["WEBLib.TMSFNCHTMLText"].TTMSFNCHTMLText.$create("Create$1",[this.FOwner$1]),this.FLeftText.SetParent(this.FlytLeftDetail),this.FLeftText.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(1)),this.FLeftText.SetText("Before Image "),this.FLeftText.SetHeight(32),this.FLeftText.SetHorizontalTextAlign(2),this.FLeftText.FMargins.SetRight(4),this.FImageBeforeDrawDiffs=pas["WEBLib.TMSFNCCheckBox"].TTMSFNCCheckBox.$create("Create$1",[this.FOwner$1]),this.FImageBeforeDrawDiffs.SetParent(this.FLeftText),this.FImageBeforeDrawDiffs.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(3)),this.FImageBeforeDrawDiffs.SetText("Diffs?"),this.FImageBeforeDrawDiffs.FOnCheckedStateChanged=rtl.createCallback(this,"ImgDiffDrawBeforeCheckedStateChanged"),this.FImageBeforeDrawDiffs.SetWidth(60),this.FImageBeforeNoiseLevel=pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit.$create("Create$1",[this.FOwner$1]),this.FImageBeforeNoiseLevel.SetParent(this.FLeftText),this.FImageBeforeNoiseLevel.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(3)),this.FImageBeforeNoiseLevel.SetT("8"),this.FImageBeforeNoiseLevel.SetEditType$1(1),this.FImageBeforeNoiseLevel.SetWidth(32),this.FImageBeforeNoiseLevel.FOnChange=rtl.createCallback(this,"ImgNoiseLevelBeforeChange"),this.FImageBefore=pas["WEBLib.TMSFNCImage"].TTMSFNCImage.$create("Create$1",[this.FOwner$1]),this.FImageBefore.SetParent(this.FlytLeftDetail),this.FImageBefore.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FImagePopMenu=this.CreateImageMenu(),this.FImageBefore.FPopupMenu=this.FImagePopMenu,this.FDetailSplit=pas["WEBLib.TMSFNCSplitter"].TTMSFNCSplitter.$create("Create$1",[this.FOwner$1]),this.FDetailSplit.SetParent(this.FlytDetailClient),this.FlytRightDetail=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner$1]),this.FlytRightDetail.SetParent(this.FlytDetailClient),this.FlytRightDetail.SetAlignment$1(5),this.FRightText=pas["WEBLib.TMSFNCHTMLText"].TTMSFNCHTMLText.$create("Create$1",[this.FOwner$1]),this.FRightText.SetParent(this.FlytRightDetail),this.FRightText.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(1)),this.FRightText.SetText("After Image "),this.FRightText.SetHeight(32),this.FRightText.SetHorizontalTextAlign(2),this.FRightText.FMargins.SetRight(4),this.FImageAfterDrawDiffs=pas["WEBLib.TMSFNCCheckBox"].TTMSFNCCheckBox.$create("Create$1",[this.FOwner$1]),this.FImageAfterDrawDiffs.SetParent(this.FRightText),this.FImageAfterDrawDiffs.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(3)),this.FImageAfterDrawDiffs.SetText("Diffs?"),this.FImageAfterDrawDiffs.SetWidth(60),this.FImageAfterDrawDiffs.FOnCheckedStateChanged=rtl.createCallback(this,"ImgDiffDrawAfterCheckedStateChanged"),this.FImageAfterNoiseLevel=pas["WEBLib.TMSFNCEdit"].TTMSFNCEdit.$create("Create$1",[this.FOwner$1]),this.FImageAfterNoiseLevel.SetParent(this.FRightText),this.FImageAfterNoiseLevel.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(3)),this.FImageAfterNoiseLevel.SetT("8"),this.FImageAfterNoiseLevel.SetEditType$1(1),this.FImageAfterNoiseLevel.SetWidth(32),this.FImageAfterNoiseLevel.FOnChange=rtl.createCallback(this,"ImgNoiseLevelAfterChange"),this.FImageAfter=pas["WEBLib.TMSFNCImage"].TTMSFNCImage.$create("Create$1",[this.FOwner$1]),this.FImageAfter.SetParent(this.FlytRightDetail),this.FImageAfter.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.DiffToolsShow(!1),this.FImageAfter.FPopupMenu=this.CreateImageMenu(),this.SetVisible(!1)},this.CreateImageMenu=function(){return pas["WEbLib.SEConstable.PopupMenu"].TSEPopupMenu.$create("Create$1",[this.FOwner$1])},this.ImagesUpdateFill=function(t){},this.CBScreensItemSelected=function(t,e,i){var s,n=null,o=pas["WEBLib.TMSFNCTypes"].TRectF.$new(),r=null,a=null;if(s=this.FInspectorStep.FScreenDiffs.GetItem(i),this.FSession.BitmapByGuid(s.FBeforeGuid,{get:function(){return r},set:function(t){r=t}})&&(this.FImageBefore.SetBitmap(r),this.FSession.BitmapByGuid(s.FAfterGuid,{get:function(){return a},set:function(t){a=t}})&&(this.FImageAfter.SetBitmap(a),this.FDiffAnalyzed&&this.FDiffAnalysis.ScreenDiffInfo(s.FScreenName,{get:function(){return n},set:function(t){n=t}}))))if(1===n.Score)this.ImagesUpdateFill(!1);else{this.ImagesUpdateFill(!0);var l=n.Diffs.GetEnumerator$1();try{for(;l.MoveNext();)o=l.DoGetCurrent(),this.AddDiffRect(pas["WEBLib.TMSFNCTypes"].TRectF.$clone(o))}finally{l=rtl.freeLoc(l)}}},this.AddDiffRect=function(t){},this.DiffToolsShow=function(t){this.FImageBeforeNoiseLevel.SetVisible(t),this.FImageAfterDrawDiffs.SetVisible(t),this.FImageBeforeDrawDiffs.SetVisible(t),this.FImageAfterNoiseLevel.SetVisible(t)},this.ImgDiffDrawBeforeCheckedStateChanged=function(t,e){var i,s=null,n=(pas["WEBLib.TMSFNCTypes"].TRectF.$new(),null);if(i=this.FInspectorStep.FScreenDiffs.GetItem(this.FCBScreens.GetItemIndex()),this.FSession.BitmapByGuid(i.FBeforeGuid,{get:function(){return n},set:function(t){n=t}})&&(this.FImageBefore.SetBitmap(n),this.FDiffAnalyzed&&e&&this.FDiffAnalysis.ScreenDiffInfo(i.FScreenName,{get:function(){return s},set:function(t){s=t}})))if(1===s.Score)this.ImagesUpdateFill(!1);else{this.ImagesUpdateFill(!0);var o=s.Diffs.GetEnumerator$1();try{for(;o.MoveNext();)o.DoGetCurrent()}finally{o=rtl.freeLoc(o)}}},this.ImgDiffDrawAfterCheckedStateChanged=function(t,e){var i,s=null,n=(pas["WEBLib.TMSFNCTypes"].TRectF.$new(),null);if(i=this.FInspectorStep.FScreenDiffs.GetItem(this.FCBScreens.GetItemIndex()),this.FSession.BitmapByGuid(i.FAfterGuid,{get:function(){return n},set:function(t){n=t}})&&(this.FImageAfter.SetBitmap(n),this.FDiffAnalyzed&&e&&this.FDiffAnalysis.ScreenDiffInfo(i.FScreenName,{get:function(){return s},set:function(t){s=t}})))if(1===s.Score)this.ImagesUpdateFill(!1);else{this.ImagesUpdateFill(!0);var o=s.Diffs.GetEnumerator$1();try{for(;o.MoveNext();)o.DoGetCurrent()}finally{o=rtl.freeLoc(o)}}},this.ImgNoiseLevelBeforeChange=function(t){},this.ImgNoiseLevelAfterChange=function(t){},this.AssignSession=function(t){this.FSession=t},this.LoadDetail=function(t){var e=0,i=0,s=null;this.FInspectorStep=t,this.FDiffAnalyzed=this.FSession.StepDiffAnalysis(this.FInspectorStep.FID,{p:this,get:function(){return this.p.FDiffAnalysis},set:function(t){this.p.FDiffAnalysis=t}}),this.FDetailText.SetText(this.FInspectorStep.DispPropertyName()+" :: "+this.FInspectorStep.DispPropertyPreviousValue()+" --\x3e "+this.FInspectorStep.DispPropertyValue()),this.FCBScreens.FItems.Clear();for(var n=0,o=this.FInspectorStep.FScreenDiffs.FLength-1;n<=o;n++)e=n,s=this.FInspectorStep.FScreenDiffs.GetItem(e),this.FCBScreens.AddItem(s.FScreenName);i=0;for(var r=0,a=this.FCBScreens.FItems.GetCount()-1;r<=a;r++)e=r,pas.SysUtils.TStringHelper.StartsWith.call({p:t.GetCompDisplayPath(),get:function(){return this.p},set:function(t){this.p=t}},this.FCBScreens.FItems.Get(e))&&(i=e);this.FCBScreens.SetItemIndex(i),this.CBScreensItemSelected(this,"",i)},this.Create$4=function(t,e){return pas["WEBLib.Controls"].TControl.Create$1.call(this,e),this.SetParent(t),this.FOwner$1=e,this.FPageContainer=t,this.BuildDetailView(),this},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TSERTTKCVSessionExplorer",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FNavTree=null,this.FSession=null,this.FPageContainer=null,this.FOwner=null,this.FToolArea=null,this.FLytPage=null,this.FLytClient=null},this.$final=function(){this.FNavTree=void 0,this.FSession=void 0,this.FPageContainer=void 0,this.FOwner=void 0,this.FToolArea=void 0,this.FLytPage=void 0,this.FLytClient=void 0,pas.System.TObject.$final.call(this)},this.CreateLayout=function(){this.FLytPage=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner]),this.FLytPage.SetParent(this.FPageContainer),this.FLytPage.SetAlignment$1(5),this.FLytClient=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner]),this.FLytClient.SetParent(this.FLytPage),this.FLytClient.SetAlignment$1(5),this.FToolArea=pas["WebLib.SEConstable.CVTypes"].TSECVToolArea.$create("Create$4",[this.FLytPage]),this.FToolArea.HelpLinkSet("Help"),this.FToolArea.NewButton$1("Export Session",rtl.createCallback(this,"DoExportSessionClick")),this.FToolArea.NewButton$1("Tree Json",rtl.createCallback(this,"LoadJsonToTree")),this.FToolArea.NewButton$1("Import Json",rtl.createCallback(this,"ImportToTree"))},this.CreateExplorer=function(){var t=null;this.FNavTree=pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$create("Create$1",[this.FOwner]),this.FNavTree.SetParent(this.FLytClient),this.FNavTree.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),(t=this.FNavTree.FColumns.Add$1()).SetText("Object"),t.SetWidth(250),(t=this.FNavTree.FColumns.Add$1()).SetText("Value"),this.FNavTree.FInteraction.SetColumnSizing(!0)},this.DoExportSessionClick=function(t){var e=rtl.createIntfRefs();try{null!=this.FSession&&(e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Exporting Session via click",this),this.FSession.SessionJsonFileName(),pas["WebLib.SEconstable.Session"].file_ext_session_json,this.FSession.SessionJSONSaveToFile(this.FSession.SessionJsonFileName()))}finally{e.free()}},this.ImportToTree=function(t){var e=null,i="",s=rtl.createIntfRefs();try{try{this.FSession.$class.RegisterJSONDependency(),pas.Classes.RegisterClass(pas["WebLib.SEconstable.Session"].TSERTTKSessionStorageMemory),pas.Classes.RegisterClass(pas["WebLib.SEconstable.Session"].TSERTTKSessionStorageBitmap),pas.Classes.RegisterClass(pas["WEBLib.TMSFNCTypes"].TTMSFNCBitmap),e=pas["WebLib.SEconstable.Session"].TSERTTKSessionStorageMemory.$create("Create$2",[!0,!0]),pas["WEBLib.TMSFNCPersistence"].TTMSFNCPersistence.FIOReference=e,pas["WEBLib.TMSFNCPersistence"].TTMSFNCPersistence.FRootObject=e,i=pas["WEBLib.TMSFNCTypes"].TTMSFNCObjectHelper.ToJSON$1.call(this.FSession.FStorageMemory),pas["WEBLib.TMSFNCPersistence"].TTMSFNCObjectPersistence.LoadObjectFromString(e,i),this.FNavTree.ViewJSONFromText(pas["WEBLib.TMSFNCTypes"].TTMSFNCObjectHelper.ToJSON$1.call(e),null)}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;var n=t;s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace("Import exception : "+n.fMessage)}}finally{s.free()}},this.LoadJsonToTree=function(t){this.FNavTree.ViewJSONFromText(pas["WEBLib.TMSFNCTypes"].TTMSFNCObjectHelper.ToJSON$1.call(this.FSession.FStorageMemory),null)},this.AssignSession=function(t){var e=rtl.createIntfRefs();try{this.FSession=t,null!=this.FSession&&e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Session Assigned for export",this)}finally{e.free()}},this.Create$1=function(t,e){return pas.System.TObject.Create.call(this),this.FPageContainer=t,this.FOwner=e,this.CreateLayout(),this.CreateExplorer(),this},this.Destroy=function(){pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TSECVInspectLog",pas["WebLib.SEConstable.CVTypes"].TSECVLogToolBase,(function(){this.$init=function(){pas["WebLib.SEConstable.CVTypes"].TSECVLogToolBase.$init.call(this),this.FDetailTree=null,this.FLastStep=0,this.FSession=null,this.FTimer=null,this.FTableView=null,this.FTextDetail=null,this.FDetailMemo=null,this.FDetailImage=null,this.FInspectDetail=null},this.$final=function(){this.FDetailTree=void 0,this.FSession=void 0,this.FTimer=void 0,this.FTableView=void 0,this.FTextDetail=void 0,this.FDetailMemo=void 0,this.FDetailImage=void 0,this.FInspectDetail=void 0,pas["WebLib.SEConstable.CVTypes"].TSECVLogToolBase.$final.call(this)},this.LoadInfoTree=function(t){var e=!1,i=rtl.createIntfRefs();try{try{(e=t.FInfoStream.DataLoaded())?i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Stream step data is loaded",this):(i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Stream not loaded, attemping Load Stream step data Before viewing",this),(e=this.FSession.InfoStreamByStep(t))?i.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("stream is loaded from session",this):i.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("stream failed to load from session",this)),e&&pas["WEBLib.TMSFNCTypes"].TTMSFNCObjectHelper.LoadFromJSONStream.call(this.FDetailTree,t.FInfoStream.FStream)}catch(s){if(!pas.SysUtils.Exception.isPrototypeOf(s))throw s;e=!1,i.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Failed to load info tree from store"+t.FInfoStream.InfoStreamFileName(),this),this.FTableView.FFooter.SetText("Failed to load tree")}}finally{i.free()}return e},this.PullEntries=function(t){if(this.FLastStep<this.FSession.EventsGet().GetCount()){for(;this.FLastStep<this.FSession.EventsGet().GetCount();)this.TableItemAdd(this.FSession.EventsGet().Get(this.FLastStep)),this.FLastStep+=1;this.FTableView.ScrollToItem(this.FTableView.FItems.GetCount()-1),this.FTableView.SelectItem(this.FTableView.FItems.GetCount()-1)}},this.TableItemAdd=function(t){var e=null,i=null,s=rtl.createIntfRefs();try{this.FSession.SessionStepsGet().TryGetValue(t,{get:function(){return i},set:function(t){i=t}})?((e=this.FTableView.AddItem(i.GetDisplayString())).FDataObject=i,e.FDBKey=t,pas["WebLib.SEconstable.Session"].TSESSessionScreenShot.isPrototypeOf(i)?e.SetDetailControl(this.FDetailImage):pas["WebLib.SEconstable.Session"].TSESSessionCompExport.isPrototypeOf(i)?e.SetDetailControl(this.FDetailMemo):pas["WebLib.SEconstable.Session"].TSESSessionStepInfoTree.isPrototypeOf(i)?e.SetDetailControl(this.FDetailTree):pas["WebLib.SEconstable.Session"].TSESSessionStepInspector.isPrototypeOf(i)?e.SetDetailControl(this.FInspectDetail):(pas["WebLib.SEconstable.Session"].TSESSessionBookmark.isPrototypeOf(i)||pas["WebLib.SEconstable.Session"].TSESSessionStepLog.isPrototypeOf(i))&&e.SetDetailControl(this.FTextDetail)):s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn("Step not found for event ID")}finally{s.free()}},this.BeforeItemShowDetailControl=function(t,e,i,s){var n=null;pas["WebLib.SEconstable.Session"].TSESSessionCompExport.isPrototypeOf(e.FDataObject)?(this.FTableView.FFooter.SetText(e.FText),this.FDetailMemo.SetText(e.FDataObject.FCompExport)):pas["WebLib.SEconstable.Session"].TSESSessionStepInfoTree.isPrototypeOf(e.FDataObject)?(this.FTableView.FFooter.SetText(e.FText),s.set(this.LoadInfoTree(e.FDataObject))):pas["WebLib.SEconstable.Session"].TSESSessionStepInspector.isPrototypeOf(e.FDataObject)?(i.LoadDetail(e.FDataObject),this.FTableView.FFooter.SetText(e.FDataObject.GetDisplayDTS()+" Path="+e.FDataObject.GetCompDisplayPath())):pas["WebLib.SEconstable.Session"].TSESSessionScreenShot.isPrototypeOf(e.FDataObject)?this.FSession.BitmapByGuid(e.FDataObject.FBitmapGuid,{get:function(){return n},set:function(t){n=t}})?(i.SetBitmap(n),this.FTableView.FFooter.SetText(e.FText)):s.set(!1):pas["WebLib.SEconstable.Session"].TSESSessionBookmark.isPrototypeOf(e.FDataObject)?s.set(!1):pas["WebLib.SEconstable.Session"].TSESSessionStepLog.isPrototypeOf(e.FDataObject)&&(this.FTextDetail.SetText(e.FText),pas.SysUtils.TStringHelper.GetLength.call({p:e,get:function(){return this.p.FText},set:function(t){this.p.FText=t}})<100&&s.set(!1))},this.BeforeItemHideDetailControl=function(t,e,i,s){this.FTableView.FFooter.SetText(""),this.FDetailImage.SetVisible(!1)},this.CreateImageMenu=function(){return pas["WEbLib.SEConstable.PopupMenu"].TSEPopupMenu.$create("Create$1",[this.FOwner])},this.Initialize=function(){this.FTableView=pas["WEBLib.TMSFNCTableView"].TTMSFNCTableView.$create("Create$1",[this.FOwner]),this.FTableView.SetParent(this.FPageContainer),this.FTableView.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FTableView.FHeader.SetText("Session"),this.FTableView.FInteraction.SetShowFilterButton(!0),this.FTableView.SetVerticalScrollBarVisible(!0),this.FTableView.FInteraction.SetAnimationFactor(1),this.FTextDetail=pas["WEBLib.TMSFNCHTMLText"].TTMSFNCHTMLText.$create("Create$1",[this.FOwner]),this.FTextDetail.SetParent(this.FTableView),this.FTextDetail.SetVisible(!1),this.FDetailMemo=pas["WEBLib.StdCtrls"].TMemo.$create("Create$1",[this.FOwner]),this.FDetailMemo.SetParent(this.FTableView),this.FDetailMemo.SetVisible(!1),this.FDetailTree=pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$create("Create$1",[this.FOwner]),this.FDetailTree.SetParent(this.FTableView),this.FDetailTree.SetVisible(!1),this.FDetailImage=pas["WEBLib.TMSFNCImage"].TTMSFNCImage.$create("Create$1",[this.FOwner]),this.FDetailImage.SetParent(this.FTableView),this.FDetailImage.SetCenter(!0),this.FDetailImage.SetAS(!0),this.FDetailImage.FPopupMenu=this.CreateImageMenu(),this.FDetailImage.SetVisible(!1),this.FInspectDetail=t.TSECVInspectStepDetail.$create("Create$4",[this.FPageContainer,this.FOwner]),this.FTimer=pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this.FPageContainer.FOwner]),this.FTimer.SetEnabled(!1),this.FTimer.FOnTimer=rtl.createCallback(this,"PullEntries"),this.FTimer.SetInterval(500),this.FTableView.FOnBeforeItemShowDetailControl=rtl.createCallback(this,"BeforeItemShowDetailControl"),this.FTableView.FOnBeforeItemHideDetailControl=rtl.createCallback(this,"BeforeItemHideDetailControl")},this.Activate=function(){null!=this.FSession&&this.FTimer.SetEnabled(!0)},this.DeActivate=function(){this.FTimer.SetEnabled(!1)},this.AssignSession=function(t){this.FSession=t,this.FInspectDetail.AssignSession(this.FSession),this.PullEntries(this.FTableView)},this.Create$2=function(t,e){return pas["WebLib.SEConstable.CVTypes"].TSECVLogToolBase.Create$1.call(this,t,e),this.FLastStep=0,this},this.Destroy=function(){rtl.free(this,"FInspectDetail"),pas.System.TObject.Destroy.call(this)}}))}),["SysUtils","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCGraphics","WEBLib.TMSFNCUtils","WebLib.SEFNC.Logger","WEBLib.TMSFNCPersistence"]),rtl.module("WebLib.SERTTK.CVLogPanel",["System","Generics.Collections","Classes","WEBLib.TMSFNCPageControl","WebLib.SEConstable.CVTypes","WebLib.SEConstable.Repository","WebLib.SEFNC.Layout","WebLib.SEFNC.CVLoggerViewer","WebLib.SERTTK.CVSessionViewer","WebLib.SEconstable.Session"],(function(){"use strict";var t=this;rtl.createClass(this,"TSECVLogToolDebug",pas["WebLib.SEConstable.CVTypes"].TSECVLogToolBase,(function(){this.$init=function(){pas["WebLib.SEConstable.CVTypes"].TSECVLogToolBase.$init.call(this),this.FLogViewer=null,this.FPage=null},this.$final=function(){this.FLogViewer=void 0,this.FPage=void 0,pas["WebLib.SEConstable.CVTypes"].TSECVLogToolBase.$final.call(this)},this.Initialize=function(){var t=rtl.createIntfRefs();try{t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Initialize Log Tool for ",this)}finally{t.free()}},this.Activate=function(){var t=rtl.createIntfRefs();try{this.FLogViewer.ActiveSet(!0),t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Activate Log Tool for ",this)}finally{t.free()}},this.DeActivate=function(){var t=rtl.createIntfRefs();try{this.FLogViewer.ActiveSet(!1),t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Deactivate Log Tool for ",this)}finally{t.free()}},this.Create$2=function(t,e){return this.FPage=t,pas["WebLib.SEConstable.CVTypes"].TSECVLogToolBase.Create$1.call(this,t.FContainer,e),this.FLogViewer=pas["WebLib.SEFNC.CVLoggerViewer"].TSEFNCLoggerViewer.$create("Create$1",[this.FPage]),this},this.Destroy=function(){rtl.free(this,"FLogViewer"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TSECVLogToolSessionExplorer",pas["WebLib.SEConstable.CVTypes"].TSECVLogToolBase,(function(){this.$init=function(){pas["WebLib.SEConstable.CVTypes"].TSECVLogToolBase.$init.call(this),this.FSessionExplorer=null,this.FPage=null,this.FSession=null},this.$final=function(){this.FSessionExplorer=void 0,this.FPage=void 0,this.FSession=void 0,pas["WebLib.SEConstable.CVTypes"].TSECVLogToolBase.$final.call(this)},this.Initialize=function(){var t=rtl.createIntfRefs();try{t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Initialize Log Tool for ",this)}finally{t.free()}},this.AssignSession=function(t){this.FSession=t,null!=this.FSessionExplorer&&this.FSessionExplorer.AssignSession(this.FSession)},this.Activate=function(){var t=rtl.createIntfRefs();try{t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Activate Log Tool for ",this)}finally{t.free()}},this.DeActivate=function(){var t=rtl.createIntfRefs();try{t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Deactivate Log Tool for ",this)}finally{t.free()}},this.Create$2=function(t,e){return this.FPage=t,pas["WebLib.SEConstable.CVTypes"].TSECVLogToolBase.Create$1.call(this,this.FPage.FContainer,e),this.FSessionExplorer=pas["WebLib.SERTTK.CVSessionViewer"].TSERTTKCVSessionExplorer.$create("Create$1",[this.FPage.FContainer,e]),this},this.Destroy=function(){rtl.free(this,"FSessionExplorer"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TSECVLogPanel",pas["WebLib.SEConstable.CVTypes"].TSECVDisplayBase,(function(){this.$init=function(){pas["WebLib.SEConstable.CVTypes"].TSECVDisplayBase.$init.call(this),this.FpnlLog=null,this.FPageControl=null,this.FTools=null,this.FLogViewer=null,this.FSessionViewer=null,this.FSessionExplorer=null,this.FPgSession=null,this.FPgLogViewer=null,this.FPgSessionExplorer=null},this.$final=function(){this.FpnlLog=void 0,this.FPageControl=void 0,this.FTools=void 0,this.FLogViewer=void 0,this.FSessionViewer=void 0,this.FSessionExplorer=void 0,this.FPgSession=void 0,this.FPgLogViewer=void 0,this.FPgSessionExplorer=void 0,pas["WebLib.SEConstable.CVTypes"].TSECVDisplayBase.$final.call(this)},this.ToolActivate=function(t){var e=rtl.createIntfRefs();try{null!=t.FDataObject&&pas["WebLib.SEConstable.CVTypes"].TSECVLogToolBase.isPrototypeOf(t.FDataObject)?t.FDataObject.Activate():e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("not valid page as object",this)}finally{e.free()}},this.ToolDeactivate=function(t){var e=rtl.createIntfRefs();try{null!=t.FDataObject&&pas["WebLib.SEConstable.CVTypes"].TSECVLogToolBase.isPrototypeOf(t.FDataObject)?t.FDataObject.DeActivate():e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("not valid page as object",this)}finally{e.free()}},this.PanelCreate=function(){this.FpnlLog=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner]),this.FpnlLog.SetParent(this.FLayout),this.FpnlLog.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FPageControl=pas["WEBLib.TMSFNCPageControl"].TTMSFNCPageControl.$create("Create$1",[this.FOwner]),this.FPageControl.SetParent(this.FpnlLog),this.FPageControl.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FPageControl.SetName("SessionToolPages"),this.CreateLogTabs(),this.FPageControl.FOnChangePage=rtl.createCallback(this,"ChangePage"),this.FpnlLog.SetVisible(!1)},this.CreateLogTabs=function(){this.FPgSession=this.FPageControl.AddPage("Session Viewer"),this.FSessionViewer=pas["WebLib.SERTTK.CVSessionViewer"].TSECVInspectLog.$create("Create$2",[this.FPgSession.FContainer,this.FOwner]),this.FPgSession.FDataObject=this.FSessionViewer,this.FTools.Add(this.FSessionViewer),this.FPgSessionExplorer=this.FPageControl.AddPage("Session Explorer"),this.FSessionExplorer=t.TSECVLogToolSessionExplorer.$create("Create$2",[this.FPgSessionExplorer,this.FOwner]),this.FPgSessionExplorer.FDataObject=this.FSessionExplorer,this.FTools.Add(this.FSessionExplorer),this.FPgLogViewer=this.FPageControl.AddPage("Marshal Debug Log"),this.FLogViewer=t.TSECVLogToolDebug.$create("Create$2",[this.FPgLogViewer,this.FOwner]),this.FPgLogViewer.FDataObject=this.FLogViewer,this.FTools.Add(this.FLogViewer),this.FPageControl.SetActivePage(this.FPgSession)},this.ChangePage=function(t,e,i){var s=rtl.createIntfRefs();try{s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("log page changed previous = "+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return e},set:function(t){e=t}})+" current is "+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return i},set:function(t){i=t}}),this),this.ToolDeactivate(this.FPageControl.GetPages().GetTab(e)),this.ToolActivate(this.FPageControl.GetPages().GetTab(i))}finally{s.free()}},this.RepositorySet=function(t){pas["WebLib.SEConstable.CVTypes"].TSECVRepositoryBase.RepositorySet.apply(this,arguments),null!=this.FSessionViewer&&this.FSessionViewer.AssignSession(this.RepositoryGet().FSession),null!=this.FSessionExplorer&&this.FSessionExplorer.AssignSession(this.RepositoryGet().FSession)},this.LogPanelShow=function(t){var e=rtl.createIntfRefs();try{this.FpnlLog.FVisible?(t.SetText("Show Session"),this.FpnlLog.SetVisible(!1),this.ToolDeactivate(this.FPageControl.GetActivePage())):(t.SetText("Hide Session"),this.FpnlLog.SetVisible(!0),this.ToolActivate(this.FPageControl.GetActivePage())),null!=this.RepositoryGet()&&e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Assinged(SR)",this),null!=this.RepositoryGet().FSession&&e.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Assinged(SR) session",this)}finally{e.free()}},this.Create$3=function(t,e){return pas["WebLib.SEConstable.CVTypes"].TSECVDisplayBase.Create$2.call(this,t,e),this.FTools=pas["Generics.Collections"].TObjectList$G9.$create("Create$4",[!0]),this.PanelCreate(),this},this.Destroy=function(){rtl.free(this,"FTools"),pas.System.TObject.Destroy.call(this)}}))}),["SysUtils","WEBLib.TMSFNCToolBar","WebLib.SEFNC.Logger"]),rtl.module("WebLib.SEConstable.PluginTypes",["System","WebLib.SEConstable.Repository","WebLib.SE.ConstableCV","WEBLib.TMSFNCPageControl"],(function(){"use strict";rtl.createClass(this,"TSERTTKPluginInspectorCVInfo",pas["WebLib.SE.ConstableCV"].TSERTTKInspectorCVInfo,(function(){})),rtl.createClass(this,"TSERTTKPluginToolInstance",pas["WebLib.SE.ConstableCV"].TSECVToolInstance,(function(){})),rtl.createClass(this,"TSERTTKPluginInspectTool",pas["WebLib.SEConstable.Repository"].TSESInspectToolBase,(function(){}))})),rtl.module("WebLib.SE.ConstableCV",["System","Classes","Generics.Collections","WEBLib.TMSFNCTreeView","WEBLib.TMSFNCTreeViewData","WEBLib.TMSFNCToolBar","WEBLib.TMSFNCHTMLText","WEBLib.TMSFNCStatusBar","WEBLib.Forms","WEBLib.Menus","WEBLib.Menus","WEBLib.TMSFNCListBox","WEBLib.TMSFNCPageControl","WEBLib.Controls","WEBLib.StdCtrls","WEBLib.TMSFNCSplitter","WEBLib.TMSFNCTaskDialog","WebLib.SEConstable.Repository","WebLib.SEconstable.Session","WebLib.SEConstable.CVTypes","WebLib.SEFNC.Layout","WebLib.SEFNC.CVLoggerViewer","WebLib.SERTTK.CVLogPanel","SysUtils"],(function(){"use strict";var t=this;rtl.createClass(this,"TSERTTKMarshalOptions",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FFormWidth=0,this.FFormHeight=0}})),rtl.createClass(this,"TSERTTKInspectorCVInfo",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FCVMarshalProxy=null,this.ToolPage=null,this.Repository=null},this.$final=function(){this.FCVMarshalProxy=void 0,this.ToolPage=void 0,this.Repository=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t){return this.FCVMarshalProxy=t,this}})),rtl.createClass(this,"TSECVToolPageLayout",pas["WebLib.SEConstable.CVTypes"].TSECVToolPage,(function(){})),rtl.createClass(this,"TSECVToolInstance",this.TSECVToolPageLayout,(function(){})),rtl.createClass(this,"TSERTTKRepoItemBinder",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FRepoItem=null,this.FTabControl=null,this.FTools=null,this.FInspectorTabs=null,this.FCVMarshalProxy=null,this.TreeNode=null,this.TabItem=null},this.$final=function(){this.FRepoItem=void 0,this.FTabControl=void 0,this.FTools=void 0,this.FInspectorTabs=void 0,this.FCVMarshalProxy=void 0,this.TreeNode=void 0,this.TabItem=void 0,pas.System.TObject.$final.call(this)},this.RepoCompGet=function(){if(null==this.FRepoItem||null===this.FRepoItem)throw pas.SysUtils.Exception.$create("Create$1",["RepoComp invalid"]);return this.FRepoItem},this.AddInspectorCVInfo=function(){var e;return e=t.TSERTTKInspectorCVInfo.$create("Create$1",[this.FCVMarshalProxy]),this.FInspectorTabs.Add(e),e},this.TabDisplayName=function(){return this.RepoCompGet().GetCompDisplayName()},this.Create$1=function(t,e){return this.FRepoItem=t,this.FCVMarshalProxy=e,this.FTools=pas["Generics.Collections"].TObjectDictionary$G10.$create("Create$5",[rtl.createSet(1)]),this.FInspectorTabs=pas["Generics.Collections"].TObjectList$G10.$create("Create$4",[!0]),this},this.Destroy=function(){rtl.free(this,"FTools"),rtl.free(this,"FInspectorTabs"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TSECVDetailPane",pas["WebLib.SEConstable.CVTypes"].TSECVDisplayBase,(function(){this.$init=function(){pas["WebLib.SEConstable.CVTypes"].TSECVDisplayBase.$init.call(this),this.FPC=null,this.FDefaultPage=0,this.FPageHistory=null,this.FDetailPageChange=null,this.FDetailPageClose=null,this.FDetailPageAdd=null,this.FAppDetailTab=null},this.$final=function(){this.FPC=void 0,this.FPageHistory=void 0,this.FDetailPageChange=void 0,this.FDetailPageClose=void 0,this.FDetailPageAdd=void 0,this.FAppDetailTab=void 0,pas["WebLib.SEConstable.CVTypes"].TSECVDisplayBase.$final.call(this)},this.HistoryPreviousPage=function(){var t=0;return 0===this.FPageHistory.GetCount()?0:(t=this.FPageHistory.Pop(),this.FPC.GetPages().GetTab(t).FVisible||(t=this.HistoryPreviousPage()),t)},this.SetPageControlOptions=function(){this.FPC.FOptions.SetCloseMode(1),this.FPC.FOptions.FCloseAction=2,this.FPC.FOptions.SetTabListButton(!0),this.FPC.FInteraction.FSelectTabOnScroll=!1,this.FPC.FInteraction.FInsertTabWithKeyboard=!1,this.FPC.FOnClosePage=rtl.createCallback(this,"PCClosePage"),this.FPC.FOnChangePage=rtl.createCallback(this,"PCChangePage"),this.FPC.FOnBeforeClosePage=rtl.createCallback(this,"PCBeforeClosePage")},this.PCClosePage=function(t,e,i){var s=rtl.createIntfRefs();try{if(s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Detail close page #"+pas.SysUtils.TIntegerHelper.ToString$1.call({get:function(){return e},set:function(t){e=t}}),this),null===this.FPC.GetPages().GetTab(e).FDataObject)return;e!==this.FDefaultPage&&null!=this.FDetailPageClose&&this.FDetailPageClose(this,this.FPC.GetPages().GetTab(e).FDataObject)}finally{s.free()}},this.PCChangePage=function(e,i,s){s>-1?this.FPageHistory.Push(s):s=this.HistoryPreviousPage(),null!==this.FPC.GetPages().GetTab(s).FDataObject&&null!=this.FDetailPageChange&&s>-1&&t.TSERTTKRepoItemBinder.isPrototypeOf(this.FPC.GetPages().GetTab(s).FDataObject)&&this.FDetailPageChange(e,this.FPC.GetPages().GetTab(s).FDataObject)},this.PCBeforeClosePage=function(t,e,i){e===this.FDefaultPage&&i.set(0)},this.ActivatePage=function(t){var e=rtl.createIntfRefs();try{if(null===t)return void e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Attempt to activate page with nil parameter",this);t.SetVisible(!0),t.SetVisible(!0),this.FPC.SetActivePage(t)}finally{e.free()}},this.AddSupPage=function(t){var e=null,i=null,s=null,n=0,o=null,r=null,a=rtl.createIntfRefs();try{if(0===(s=t.RepoCompGet().FToolInfos).FLength)return void a.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug("No tools found to create tab");t.TabItem=this.FPC.AddPage(t.TabDisplayName()),t.TabItem.FDataObject=t,t.FTabControl=pas["WEBLib.TMSFNCPageControl"].TTMSFNCPageControl.$create("Create$1",[this.FOwner]),t.FTabControl.SetParent(t.TabItem.FContainer),t.FTabControl.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5));for(var l=0,h=s.FLength-1;l<=h;l++)if(n=l,pas["WebLib.SEConstable.PluginTypes"].TSERTTKPluginInspectTool.isPrototypeOf(s.GetItem(n))){r=s.GetItem(n),e=t.FTabControl.AddPage("");try{(o=t.AddInspectorCVInfo()).ToolPage=e,o.Repository=this.RepositoryGet(),i=r.InitToolUI(o),t.FTools.Add(o.ToolPage,i),o.ToolPage.SetText(i.DisplayName())}catch(i){if(pas["WebLib.SEConstable.CVTypes"].ECVToolPageLayoutCreateException.isPrototypeOf(i)){var F=i;t.FTabControl.RemovePage(e.GetIndex()),a.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug("Error Creating Layout for tool page : "+F.fMessage)}else if(pas["WebLib.SEConstable.CVTypes"].ECVToolInstanceCreateException.isPrototypeOf(i)){F=i;t.FTabControl.RemovePage(e.GetIndex()),a.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Debug("Error Creating Tool instance : "+F.fMessage)}else{if(!pas.SysUtils.Exception.isPrototypeOf(i))throw i;F=i;t.FTabControl.RemovePage(e.GetIndex()),a.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Debug("Error adding page : "+F.fMessage)}}}else a.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Debug("Inspect Tool type check failed for "+s.GetItem(n).$classname);t.TabItem.GetIndex()!==this.FDefaultPage&&null!=this.FDetailPageAdd&&this.FDetailPageAdd(this,t),this.ActivatePage(t.TabItem)}finally{a.free()}},this.PageIsValid=function(t){var e=!1,i=rtl.createIntfRefs();try{e=!1,null!==t?(i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Tab Item Assigned, begin validate page control",this),null!==t.PageControl()?(i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Page control is assigned",this),t.PageControl()===this.FPC?(i.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Page control is valid",this),e=!0):i.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Page control is not equal to control ",this)):i.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Page control is not assigned",this)):i.ref(6,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Tab item is not assigned",this)}finally{i.free()}return e},this.RepositorySet=function(t){pas["WebLib.SEConstable.CVTypes"].TSECVRepositoryBase.RepositorySet.apply(this,arguments)},this.ActivateItem=function(t){var e=null,i=rtl.createIntfRefs();try{e=t.RepoCompGet(),this.PageIsValid(t.TabItem)?(this.ActivatePage(t.TabItem),i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Active item page change for "+e.GetCompDisplayName(),this)):0===e.FToolInfos.FLength?i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("No tools for component"+e.GetCompDisplayPath(),this):(i.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Begin page add for "+e.GetCompDisplayPath()+", Tool count"+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:e.FToolInfos,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this),this.AddSupPage(t),i.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Inspector page added for "+e.GetCompDisplayPath()+", Tool count"+pas.SysUtils.TNativeIntHelper.ToString$1.call({p:e.FToolInfos,get:function(){return this.p.FLength},set:function(t){this.p.FLength=t}}),this))}finally{i.free()}},this.DelSupPage=function(t){var e=rtl.createIntfRefs();try{if(t===this.FAppDetailTab)return;null===t.TabItem?e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Trying to Delete a page, but the binder has lost the map",this):(null!=this.FDetailPageClose&&this.FDetailPageClose(this,t),this.FPC.RemovePage(t.TabItem.GetIndex()))}finally{e.free()}},this.SetApplicationPage=function(t){var e=rtl.createIntfRefs();try{this.FDefaultPage=t.TabItem.GetIndex(),t.TabItem.SetCloseButton(!1),this.FAppDetailTab=t,e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Application page set complete",this)}finally{e.free()}},this.Create$3=function(t,e){var i=rtl.createIntfRefs();try{pas["WebLib.SEConstable.CVTypes"].TSECVDisplayBase.Create$2.call(this,t,e),this.FPC=pas["WEBLib.TMSFNCPageControl"].TTMSFNCPageControl.$create("Create$1",[this.FOwner]),this.FPC.SetParent(this.FLayout),this.FPC.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FPC.SetName("ComponentInspectorsPageCtrl"),this.FPageHistory=pas["Generics.Collections"].TStack$G2.$create("Create"),this.SetPageControlOptions(),i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Gui Component Insepctor page control created",this)}finally{i.free()}return this},this.Destroy=function(){rtl.free(this,"FPageHistory"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TSECVNavTree",pas["WebLib.SEConstable.CVTypes"].TSECVDisplayBase,(function(){this.$init=function(){pas["WebLib.SEConstable.CVTypes"].TSECVDisplayBase.$init.call(this),this.FMouseOverNode=null,this.FPM=null,this.FPopOptions=null,this.FAppNode=null,this.FAppBinder=null,this.FTV=null,this.FOnNodeSelected=null,this.FMarshalProxy=null,this.FOnNodeReloaded=null},this.$final=function(){this.FMouseOverNode=void 0,this.FPM=void 0,this.FPopOptions=void 0,this.FAppNode=void 0,this.FAppBinder=void 0,this.FTV=void 0,this.FOnNodeSelected=void 0,this.FMarshalProxy=void 0,this.FOnNodeReloaded=void 0,pas["WebLib.SEConstable.CVTypes"].TSECVDisplayBase.$final.call(this)},this.RefreshRootNode=function(t,e){this.FTV.BeginUpdate();try{this.FTV.RemoveNode(t),this.FTV.EndUpdate(),this.FTV.BeginUpdate(),this.LoadRoot(e),this.FTV.EndUpdate(),null!=this.FOnNodeReloaded&&this.FOnNodeReloaded(this.FTV)}finally{this.FTV.EndUpdate()}},this.AddNavNode=function(e,i){var s=null,n=null,o=rtl.createIntfRefs();try{n=this.FTV.AddNode(e),s=o.ref(1,t.MarshalMV()).AddNavNode(i,n,this.FMarshalProxy),n.SetText(0,i.GetCompDisplayName()),n.SetText(1,i.RefObjPath()),n.FDataObject=s}finally{o.free()}return s},this.NodeMouseEnter=function(e,i){var s=null,n=null,o=rtl.createIntfRefs();try{this.FMouseOverNode=i.FNode,this.FPopOptions.TryGetValue(pas["WebLib.SEConstable.CVTypes"].PMOptionDisplay[1],{get:function(){return s},set:function(t){s=t}})?null!==this.FMouseOverNode.FDataObject&&t.TSERTTKRepoItemBinder.isPrototypeOf(this.FMouseOverNode.FDataObject)?(n=this.FMouseOverNode.FDataObject,s.FVisible=pas["WebLib.SEConstable.Repository"].TSESRepoForm.isPrototypeOf(n.RepoCompGet())):s.FVisible=!1:o.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Error$1("Menu option GOTO Active not in list??",this)}finally{o.free()}},this.LoadRoot=function(t){var e=null,i=rtl.createIntfRefs();try{try{i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Loading root to tree "+t.GetDisplayName(),this),(e=this.AddNavNode(this.FAppNode,t)).TreeNode.SetExpanded(!1),this.LoadLabels(t,e.TreeNode),this.LoadRepoItem(t,e.TreeNode)}catch(e){if(!pas.SysUtils.Exception.isPrototypeOf(e))throw e;i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Loading Tree Root failed for :"+t.GetDisplayName(),this)}}finally{i.free()}},this.LoadAppInfo=function(){var e=rtl.createIntfRefs();try{this.FAppBinder=e.ref(1,t.MarshalMV()).AddNavNode(this.RepositoryGet().FAppRef,null,this.FMarshalProxy),this.FAppBinder.TreeNode=this.FTV.AddNode(null),this.FAppNode=this.FAppBinder.TreeNode,this.FAppNode.SetText(0,this.RepositoryGet().FAppRef.FAppName),this.FAppBinder.TreeNode.FDataObject=this.FAppBinder}finally{e.free()}},this.LoadLabels=function(t,e){var i=rtl.createIntfRefs();try{}finally{i.free()}},this.LoadRepoItem=function(t,e){var i=null,s=null,n=rtl.createIntfRefs();try{try{var o=t.FChildren.GetEnumerator$1();try{for(;o.MoveNext();)null===(i=o.DoGetCurrent())?n.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1(e.GetText(0)+" path="+e.GetText(1)+" null object on add sub comp",this):(s=this.AddNavNode(e,i),this.LoadLabels(i,s.TreeNode),i.FChildren.FLength>0&&this.LoadRepoItem(i,s.TreeNode))}finally{o=rtl.freeLoc(o)}}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;n.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Loading Tree Items failed for :"+e.GetText(0),this)}}finally{n.free()}},this.FilterSelect=function(t,e,i){this.FTV.ExpandAll()},this.PopupOnClick=function(e){var i=null,s=null,n=null,o=rtl.createIntfRefs();try{if(o.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Nav tree Pop Menu Item clicked",this),null===this.FMouseOverNode.FDataObject||!t.TSERTTKRepoItemBinder.isPrototypeOf(this.FMouseOverNode.FDataObject))return void o.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Tree item not bound to binder",this);n=this.FMouseOverNode.FDataObject.RepoCompGet();var r=e.FTag;0===r?o.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("path for object = "+n.RefObjPath(),this):1===r?(o.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Go To Active",this),pas["WebLib.SEConstable.Repository"].TSESRepoForm.isPrototypeOf(n)&&(i=n).HasActive()&&this.NodeByObject(i.ActiveControl(),{get:function(){return s},set:function(t){s=t}})&&(null!=s.TreeNode?(this.ExpandToNode(s.TreeNode,!0,!0),null!=this.FOnNodeSelected&&this.FOnNodeSelected(this.FTV,s.TreeNode)):o.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Active not not in tree, rediscover",this))):2===r&&(pas["WebLib.SEConstable.Repository"].TSESAppReference.isPrototypeOf(n)?this.RefreshAppReference(this.FMouseOverNode):pas["WebLib.SEConstable.Repository"].TSESRepoRoot.isPrototypeOf(n)?this.RefreshRepoRoot(this.FMouseOverNode):o.ref(6,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Refresh called for unknown type",this))}finally{o.free()}},this.LoadPopupOptions=function(){var t=0,e=null,i=rtl.createIntfRefs();try{for(t=0;t<=2;t++)e=pas["WEBLib.Menus"].TMenuItem.$create("Create$1",[this.FPM]),this.FPM.FItems.Add(e),e.SetCaption(pas["WebLib.SEConstable.CVTypes"].PMOptionDisplay[t]),e.FTag=t,this.FPopOptions.Add(pas["WebLib.SEConstable.CVTypes"].PMOptionDisplay[t],e),e.FOnClick=rtl.createCallback(this,"PopupOnClick");i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Pop options loaded "+pas.SysUtils.TIntegerHelper.ToString$1.call({p:this.FPM.FItems.GetCount(),get:function(){return this.p},set:function(t){this.p=t}}),this)}finally{i.free()}},this.RefreshAppReference=function(t){var e=null,i=null,s=rtl.createIntfRefs();try{e=pas["Generics.Collections"].TList$G14.$create("Create$1");try{if(s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Refreshing Root node - begin",this),this.RepositoryGet().DiscoverNewRoots({get:function(){return e},set:function(t){e=t}})>0){var n=e.GetEnumerator$1();try{for(;n.MoveNext();)i=n.DoGetCurrent(),s.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Found form "+i.RefObjName(),this),this.LoadRoot(i),s.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Root Loaded "+i.RefObjName(),this)}finally{n=rtl.freeLoc(n)}}s.ref(4,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Refreshing Root node - End",this)}finally{e=rtl.freeLoc(e)}}finally{s.free()}},this.RefreshRepoRoot=function(t){var e;if(!pas["WebLib.SEConstable.Repository"].TSESRepoRoot.isPrototypeOf(t.FDataObject.RepoCompGet()))throw pas.SysUtils.Exception.$create("Create$1",["Incorrect type for refresh"]);e=t.FDataObject.RepoCompGet(),this.RepositoryGet().ReloadRepoRoot(e)&&this.RefreshRootNode(t,e)},this.AssignMarshalProxy=function(t){this.FMarshalProxy=t},this.DetailTabChanged=function(t,e){var i=rtl.createIntfRefs();try{if(null===e)return;null===e.TreeNode?i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Tab has lost node association",this):this.ExpandToNode(e.TreeNode,!0,!0)}finally{i.free()}},this.ExpandToNode=function(t,e,i){var s=null;for(this.FTV.RemoveFilters(),s=t.GetParent();null!=s;)s.Expand(!1),s=s.GetParent();e&&this.FTV.ScrollToNode(t,!0,2,!0),i&&this.FTV.SelectNode(t)},this.LoadTreeFromModel=function(){var t=null;this.FTV.BeginUpdate();try{this.LoadAppInfo();var e=this.RepositoryGet().FAppRef.FRoots.GetEnumerator$1();try{for(;e.MoveNext();)t=e.DoGetCurrent(),this.LoadRoot(t)}finally{e=rtl.freeLoc(e)}this.FAppNode.SetExpanded(!0),this.FTV.FColumns.GetItem$1(0).Sort(!0,!1,0)}finally{this.FTV.EndUpdate()}},this.NodeByObject=function(e,i){var s=!1,n=rtl.createIntfRefs();try{s=n.ref(1,t.MarshalMV()).NavNodeByObject(e,i)}finally{n.free()}return s},this.Create$3=function(t,e){return pas["WebLib.SEConstable.CVTypes"].TSECVDisplayBase.Create$2.call(this,t,e),this.FPopOptions=pas["Generics.Collections"].TDictionary$G16.$create("Create$1",[0]),this.FTV=pas["WEBLib.TMSFNCTreeView"].TTMSFNCTreeView.$create("Create$1",[this.FOwner]),this.FTV.SetParent(this.FLayout),this.FTV.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FTV.SetName("NavTree"),this.FPM=pas["WEBLib.Menus"].TWebPopupMenu.$create("Create$1",[this.FTV]),this.FPM.SetParent(e),this.LoadPopupOptions(),this.FTV.BeginUpdate(),this.FTV.ClearNodeList(),this.FTV.FColumns.Clear(),this.FTV.FNodes.Clear(),this.FTV.FColumns.Add$1(),this.FTV.FColumns.GetItem$1(0).SetText("Components to Inspect"),this.FTV.FColumns.GetItem$1(0).FFiltering.SetEnabled(!0),this.FTV.FColumns.Add$1(),this.FTV.FColumns.GetItem$1(1).SetText("Component path"),this.FTV.FColumns.GetItem$1(1).SetVisible(!1),this.FTV.FOnNodeMouseEnter=rtl.createCallback(this,"NodeMouseEnter"),this.FTV.FPopupMenu=this.FPM,this.FTV.EndUpdate(),this.FTV.FOnFilterSelect=rtl.createCallback(this,"FilterSelect"),this.FTV.FColumns.GetItem$1(0).FFiltering.FDropDownWidth=220,this.FTV.SetShowHint(!0),this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FPopOptions},set:function(t){this.p.FPopOptions=t}}),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TSECVMarshal",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FLayout=null,this.FOwner=null,this.FlytLeft=null,this.FsplitR=null,this.FlytClient=null,this.FlytMain=null,this.FlytStatus=null,this.FSBSETools=null,this.FSBTextMessage=null,this.FTreeDisp=null,this.FPageDisp=null,this.FLogPanel=null,this.FToolBar=null,this.FBookmarkDialog=null,this.FBookmarkPanel=null,this.FMarshalOptions=null,this.FMarshalOptionsFree=!1,this.FOpenInspectors=null,this.FMarshalProxy=null,this.FAppBinder=null},this.$final=function(){this.FLayout=void 0,this.FOwner=void 0,this.FlytLeft=void 0,this.FsplitR=void 0,this.FlytClient=void 0,this.FlytMain=void 0,this.FlytStatus=void 0,this.FSBSETools=void 0,this.FSBTextMessage=void 0,this.FTreeDisp=void 0,this.FPageDisp=void 0,this.FLogPanel=void 0,this.FToolBar=void 0,this.FBookmarkDialog=void 0,this.FBookmarkPanel=void 0,this.FMarshalOptions=void 0,this.FOpenInspectors=void 0,this.FMarshalProxy=void 0,this.FAppBinder=void 0,pas.System.TObject.$final.call(this)},this.CreateLayouts=function(){this.FToolBar=pas["WebLib.SEConstable.CVTypes"].TSECVToolArea.$create("Create$4",[this.FLayout]),this.FToolBar.NewButton("Show Session"),this.FToolBar.NewButton$1("Bookmark",rtl.createCallback(this,"ShowAddBookmark")),this.FToolBar.HelpLinkSet("Constable"),this.FlytStatus=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner]),this.FlytStatus.SetParent(this.FLayout),this.FlytStatus.SetAlignment$1(2),this.FlytStatus.SetHeight(24),this.FlytStatus.SetName("LytStatus"),this.FlytMain=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner]),this.FlytMain.SetParent(this.FLayout),this.FlytMain.SetAlignment$1(5),this.FlytMain.SetName("LytMain"),this.FlytLeft=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner]),this.FlytLeft.SetParent(this.FlytMain),this.FlytLeft.SetAlignment$1(3),this.FlytLeft.SetWidth(200),this.FlytLeft.SetName("LytLeft"),this.FsplitR=pas["WEBLib.TMSFNCSplitter"].TTMSFNCSplitter.$create("Create$1",[this.FOwner]),this.FsplitR.SetParent(this.FlytMain),this.FsplitR.SetWidth(6),this.FlytClient=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this.FOwner]),this.FlytClient.SetParent(this.FlytMain),this.FlytClient.SetAlignment$1(5),this.FlytClient.SetName("LytClient")},this.CreateStatusBar=function(){this.FSBSETools=pas["WEBLib.TMSFNCStatusBar"].TTMSFNCStatusBar.$create("Create$1",[this.FOwner]),this.FSBSETools.SetParent(this.FlytStatus),this.FSBSETools.SetAlign(pas["WebLib.SEFNC.Layout"].TSEFNCAlign.GetAlign(5)),this.FSBTextMessage=this.FSBSETools.FPanels.Add$1(),this.FSBTextMessage.SetText("status bar text")},this.StatusTextSet=function(t){this.FSBTextMessage.SetText(t)},this.BindRepository=function(){var e=rtl.createIntfRefs();try{try{e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Repository created Succesfully",this),this.StatusTextSet("Repository created Succesfully"),this.FTreeDisp.RepositorySet(e.ref(2,t.MarshalMV()).Repository()),this.FPageDisp.RepositorySet(e.ref(3,t.MarshalMV()).Repository()),this.FLogPanel.RepositorySet(e.ref(4,t.MarshalMV()).Repository()),e.ref(5,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Control Views assigned to repository",this),this.StatusTextSet("Control Views assigned to repository"),this.FTreeDisp.LoadTreeFromModel(),this.FTreeDisp.FOnNodeReloaded=rtl.createCallback(this,"ValidateToolTabs"),this.StatusTextSet("Repository Loaded"),e.ref(6,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Repository loaded",this)}catch(t){e.ref(7,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Failed in Repository",this),this.StatusTextSet("Failed in Repository")}}finally{e.free()}},this.InitializeTools=function(){this.CreateLayouts(),this.CreateStatusBar(),this.FLogPanel=pas["WebLib.SERTTK.CVLogPanel"].TSECVLogPanel.$create("Create$3",[this.FLayout,this.FOwner]),this.FToolBar.ButtonByName("Show Session").FOnClick=rtl.createCallback(this.FLogPanel,"LogPanelShow"),this.FTreeDisp=t.TSECVNavTree.$create("Create$3",[this.FlytLeft,this.FOwner]),this.FPageDisp=t.TSECVDetailPane.$create("Create$3",[this.FlytClient,this.FOwner]),this.FMarshalProxy=t.TSERTTKConstableCVProxy.$create("Create$1",[this]),this.FTreeDisp.AssignMarshalProxy(this.FMarshalProxy)},this.InitializeAppTools=function(){var t=rtl.createIntfRefs();try{try{this.FAppBinder=this.FTreeDisp.FAppBinder,this.FPageDisp.ActivateItem(this.FAppBinder),this.FPageDisp.SetApplicationPage(this.FTreeDisp.FAppBinder),this.ShowAppNode()}catch(i){if(!pas.SysUtils.Exception.isPrototypeOf(i))throw i;var e=i;t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Failed app tool init : "+e.fMessage,this)}}finally{t.free()}},this.ShowAppNode=function(){this.FPageDisp.ActivateItem(this.FPageDisp.FAppDetailTab)},this.ShowAddBookmark=function(e){var i=rtl.createIntfRefs();try{null===this.FBookmarkDialog&&(this.FBookmarkDialog=pas["WEBLib.TMSFNCTaskDialog"].TTMSFNCTaskDialog.$create("Create$1",[this.FOwner])),null==this.FBookmarkPanel&&(this.FBookmarkPanel=pas["WebLib.SEConstable.CVTypes"].TSECVBookmarkPanel.$create("Create$1",[this.FOwner]),this.FBookmarkPanel.FSupportRepository=i.ref(1,t.MarshalMV()).Repository()),this.FBookmarkPanel.ResetBookmark(),this.FBookmarkPanel.SetWidth(this.FBookmarkDialog.FMinDialogWidth),this.FBookmarkPanel.SetHeight(250),this.FBookmarkDialog.SetInputType(4),this.FBookmarkDialog.SetInputControl(this.FBookmarkPanel),this.FBookmarkDialog.SetInstruction("Enter bookmark description here"),this.FBookmarkDialog.SetCommonButtons(rtl.createSet(0,3)),this.FBookmarkDialog.SetTitle("Add Session Bookmark"),this.FBookmarkDialog.FOnDialogResult=rtl.createCallback(this,"NoteAddDialogResult"),this.FBookmarkDialog.FOnDialogClosed=rtl.createCallback(this,"NoteAddDialogClosed"),this.FBookmarkDialog.Execute(null)}finally{i.free()}},this.NoteAddDialogClosed=function(t){1===this.FBookmarkDialog.FTag$1&&this.FBookmarkPanel.SaveBookmark()},this.NoteAddDialogResult=function(t,e){this.FBookmarkDialog.FTag$1=e},this.tvNodeSelected=function(t,e){var i=rtl.createIntfRefs();try{null!==e.FDataObject?this.NodeClickActions(e):i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Node Selected - Dataobject nil for "+e.GetText(0),this)}finally{i.free()}},this.tvNodeClick=function(t,e){var i=rtl.createIntfRefs();try{null!==e.FNode.FDataObject?this.NodeClickActions(e.FNode):i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Warn$1("Node Clicked - Dataobject nil for "+e.FNode.GetText(0),this)}finally{i.free()}},this.NodeClickActions=function(e){var i=null,s=null,n=rtl.createIntfRefs();try{null!=e?null!==e.FDataObject&&t.TSERTTKRepoItemBinder.isPrototypeOf(e.FDataObject)?(s=(i=e.FDataObject).RepoCompGet(),pas["WebLib.SEConstable.Repository"].TSESAppReference.isPrototypeOf(s)?this.StatusTextSet(s.FAppName):this.StatusTextSet(s.GetCompDisplayPath()),this.FPageDisp.ActivateItem(i)):n.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Data object not Item Binder "+e.GetText(0),this):n.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Tree node not assigned for click actions",this)}finally{n.free()}},this.DetailTabChanged=function(t,e){var i=rtl.createIntfRefs();try{if(null===e)return;this.FTreeDisp.DetailTabChanged(t,e),null!==this.FTreeDisp.FTV.GetFocusedNode()?null!==e.TreeNode&&this.FTreeDisp.FTV.GetFocusedNode()===e.TreeNode?this.NodeClickActions(this.FTreeDisp.FTV.GetFocusedNode()):i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Selected node does not match tab, aborting actions",this):i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Tab changed, but no node selected",this)}finally{i.free()}},this.ValidateToolTabs=function(e){var i=null,s=null,n=rtl.createIntfRefs();try{s=pas["Generics.Collections"].TList$G20.$create("Create$1");try{if(n.ref(1,t.MarshalMV()).InvalidPages({get:function(){return s},set:function(t){s=t}})){var o=s.GetEnumerator$1();try{for(;o.MoveNext();)i=o.DoGetCurrent(),this.FPageDisp.DelSupPage(i)}finally{o=rtl.freeLoc(o)}}}finally{s=rtl.freeLoc(s)}}finally{n.free()}},this.ShowEvalMessage=function(t,e){},this.TryReOpenInspectors=function(){},this.Create$1=function(t,e){var i=rtl.createIntfRefs();try{this.FLayout=t,this.FOwner=e,this.ShowEvalMessage(this.FLayout,this.FOwner),this.FOpenInspectors=pas.Classes.TStringList.$create("Create$1"),this.FOpenInspectors.FDuplicates=0,this.FOpenInspectors.SetSorted(!0),this.FOpenInspectors.SetCaseSensitive(!1),this.InitializeTools(),i.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Initialize Tools Complete",this),this.BindRepository(),i.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Info$1("Repo Bind Complete",this),this.InitializeAppTools(),this.StatusTextSet("Support Tools Ready"),this.TryReOpenInspectors(),this.FTreeDisp.FTV.FOnNodeClick=rtl.createCallback(this,"tvNodeClick"),this.FTreeDisp.FOnNodeSelected=rtl.createCallback(this,"tvNodeSelected"),this.FPageDisp.FDetailPageChange=rtl.createCallback(this,"DetailTabChanged")}finally{i.free()}return this},this.Create$2=function(t,e,i){var s=rtl.createIntfRefs();try{null!=i?this.FMarshalOptions=i:s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug("Support CV created with nil options, wrong constructor"),this.Create$1(t,e)}finally{s.free()}return this},this.Destroy=function(){rtl.free(this,"FToolBar"),rtl.free(this,"FLogPanel"),rtl.free(this,"FTreeDisp"),rtl.free(this,"FPageDisp"),rtl.free(this,"FOpenInspectors"),rtl.free(this,"FMarshalProxy"),this.FMarshalOptionsFree&&rtl.free(this,"FMarshalOptions"),pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TSERTTKConstableCVProxy",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FMarshalCV=null},this.$final=function(){this.FMarshalCV=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t){return this.FMarshalCV=t,this}})),rtl.createInterface(this,"ISERTTKMarshalMV","{D29A96B7-71DE-45FF-8D79-32177DAF463C}",["NavNodeByObject","AddNavNode","InvalidPages","Repository"],pas.System.IUnknown),this.MarshalMV=function(){var e=null,i=!1;try{e=rtl.setIntfL(e,t.TSERTTKMarshalMVFactory.FMarshalMV),i=!0}finally{i||rtl._Release(e)}return e},rtl.createClass(this,"TSERTTKMarshalMVFactory",pas.System.TObject,(function(){this.FMarshalMV=null})),rtl.createClass(this,"TSERTTKMarshalMV",pas.System.TInterfacedObject,(function(){this.$init=function(){pas.System.TInterfacedObject.$init.call(this),this.FRepoItemDetailTabs=null,this.FObjectNavNodes=null,this.FRepository=null},this.$final=function(){this.FRepoItemDetailTabs=void 0,this.FObjectNavNodes=void 0,this.FRepository=void 0,pas.System.TInterfacedObject.$final.call(this)},this.Create$1=function(){var t=rtl.createIntfRefs();try{this.FRepoItemDetailTabs=pas["Generics.Collections"].TObjectDictionary$G11.$create("Create$5",[rtl.createSet(1)]),this.FObjectNavNodes=pas["Generics.Collections"].TDictionary$G18.$create("Create$1",[0]),t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Model view Created",this)}finally{t.free()}return this},this.Destroy=function(){rtl.free(this,"FRepoItemDetailTabs"),rtl.free(this,"FObjectNavNodes"),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FRepository},set:function(t){this.p.FRepository=t}}),pas.System.TObject.Destroy.call(this)},this.Repository=function(){return null===this.FRepository&&(this.FRepository=pas["WebLib.SEConstable.Repository"].TSESRepository.$create("Create$1")),this.FRepository},this.NavNodeByObject=function(t,e){var i=!1,s=rtl.createIntfRefs();try{(i=this.FObjectNavNodes.TryGetValue(t,e))?s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("NavNodebyObject : Found Nav Node Object",this):s.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("NavNodebyObject : Missing Nav Node Object, Object in tree without binder"+t.$classname,this)}finally{s.free()}return i},this.NavNodeByRepoItem=function(t,e){var i=!1,s=rtl.createIntfRefs();try{(i=this.FObjectNavNodes.TryGetValue(t.FRefObject,e))?s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("NavNodeByRepoItem : Found Nav Node Object",this):s.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("NavNodeByRepoItem : Missing Nav Node Object",this)}finally{s.free()}return i},this.AddNavNode=function(e,i,s){var n=null,o=rtl.createIntfRefs();try{this.FObjectNavNodes.TryGetValue(e.FRefObject,{get:function(){return n},set:function(t){n=t}})?o.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Node retreived",this):(n=t.TSERTTKRepoItemBinder.$create("Create$1",[e,s]),this.FRepoItemDetailTabs.Add(e,n),this.FObjectNavNodes.Add(e.FRefObject,n)),n.TreeNode=i}finally{o.free()}return n},this.InvalidPages=function(t){var e=!1,i=null,s=null,n=null,o=rtl.createIntfRefs();try{var r=this.FRepoItemDetailTabs.GetKeys().GetEnumerator$1();try{for(;r.MoveNext$1();)n=r.GetCurrent(),o.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Checking tool tab ",this),this.FRepoItemDetailTabs.TryGetValue(n,{get:function(){return i},set:function(t){i=t}})&&(this.NavNodeByRepoItem(i.RepoCompGet(),{get:function(){return s},set:function(t){s=t}})?null===i.TreeNode&&(i.TreeNode=s.TreeNode):(o.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Debug$1("Node not found for component",this),t.get().Add(i),this.FRepoItemDetailTabs.Remove(n)))}finally{r=rtl.freeLoc(r)}e=t.get().FLength>0}finally{o.free()}return e},rtl.addIntf(this,t.ISERTTKMarshalMV),rtl.addIntf(this,pas.System.IUnknown)})),t.$init=function(){!function(){var e=rtl.createIntfRefs();try{rtl.setIntfP(t.TSERTTKMarshalMVFactory,"FMarshalMV",rtl.queryIntfT(t.TSERTTKMarshalMV.$create("Create$1"),t.ISERTTKMarshalMV),!0),e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Debug("Model view Factory called create")}finally{e.free()}}()}}),["Types","WEBLib.TMSFNCTabSet","WEBLib.TMSFNCGraphicsTypes","WEBLib.Graphics","WebLib.SEConstable.PluginTypes","WEBLib.TMSFNCUtils","WebLib.SEFNC.Logger","Web","JS"]),rtl.module("WebLib.SE.RTTK.Constable",["System","Classes","WebLib.SEFNC.Layout","WebLib.SE.ConstableCV","Web","JS"],(function(){"use strict";var t=this.$impl;rtl.createClass(this,"TSERTTKConstableAPI",pas.System.TObject,(function(){this.TryShowConstable=async function(e){var i=null,s=rtl.createIntfRefs();try{i=t.TSERTTKConstableForm.$create("Create$8",[pas["WEBLib.Forms"].Application,e]),s.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace("Marshal Show - FormCreated");try{window.location.hash="subform",await i.Load(),s.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace("Marshal Show - Form Loaded"),await i.Execute(),s.ref(3,pas["WebLib.SEFNC.Logger"].Logger()).Trace("Marshal Api done try show")}finally{i=rtl.freeLoc(i)}}finally{s.free()}},this.ShowConstable=function(){var t=rtl.createIntfRefs();try{t.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace("Marshal Show - options nil"),this.TryShowConstable(null)}finally{t.free()}}})),this.$implcode=function(){t.def_form_height=960,t.def_form_width=960,t.txt_form_prefix="Constable by SwiftExpat - ",t.txt_form_version=" - 2023.02.15",rtl.createClass(t,"TSERTTKConstableForm",pas["WEBLib.Forms"].TForm,(function(){this.$init=function(){pas["WEBLib.Forms"].TForm.$init.call(this),this.FMarshalOptions=null,this.pnlInspect=null,this.FMarshalCV=null},this.$final=function(){this.FMarshalOptions=void 0,this.pnlInspect=void 0,this.FMarshalCV=void 0,pas["WEBLib.Forms"].TForm.$final.call(this)},this.SupFormCaption=function(){return t.txt_form_prefix+"WEB"+t.txt_form_version},this.SizeForm=function(){null!=this.FMarshalOptions?(this.SetWidth(this.FMarshalOptions.FFormWidth),this.SetHeight(this.FMarshalOptions.FFormHeight)):(this.SetWidth(960),this.SetHeight(960))},this.formDestroy=function(t){try{rtl.free(this,"FMarshalCV")}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;this.SetCaption(this.FCaption+" Error in Destruction")}},this.Create$7=function(t){var e=rtl.createIntfRefs();try{this.FOnCreate=rtl.createCallback(this,"WebFormCreate"),pas["WEBLib.Forms"].TCustomForm.CreateNew.call(this,t,0),this.SizeForm(),this.FOnDestroy=rtl.createCallback(this,"formDestroy"),this.SetCaption(this.SupFormCaption()),this.SetName(pas["WebLib.SEConstable.Repository"].SupFormName),this.FPopup=!0,this.SetBorder(4),e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Form Constructor success",this)}finally{e.free()}return this},this.Create$8=function(t,e){return this.FMarshalOptions=e,this.Create$7(t),this},this.WebFormCreate=function(t){var e=rtl.createIntfRefs();try{e.ref(1,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("WebForm create called",this),this.pnlInspect=pas["WebLib.SEFNC.Layout"].TSEFNCLayout.$create("Create$1",[this]),this.pnlInspect.SetParent(this),this.pnlInspect.SetAlignment$1(5);try{null!=this.FMarshalOptions?this.FMarshalCV=pas["WebLib.SE.ConstableCV"].TSECVMarshal.$create("Create$2",[this.pnlInspect,this,this.FMarshalOptions]):this.FMarshalCV=pas["WebLib.SE.ConstableCV"].TSECVMarshal.$create("Create$1",[this.pnlInspect,this]),e.ref(2,pas["WebLib.SEFNC.Logger"].Logger()).Trace$1("Form created all ready",this)}catch(t){if(!pas.SysUtils.Exception.isPrototypeOf(t))throw t;this.SetCaption(this.FCaption+" Error in Creation")}}finally{e.free()}},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addMethod("WebFormCreate",0,[["Sender",pas.System.$rtti.TObject]])}))}}),["WEBLib.ExtCtrls","WEBLib.Forms","WEBLib.TMSFNCUtils","WebLib.SEConstable.Repository","WebLib.SEFNC.Logger","SysUtils"]),rtl.module("DBConst",["System"],(function(){"use strict";this.$resourcestrings={SActiveDataset:{org:"Operation cannot be performed on an active dataset"},SDatasetReadOnly:{org:"Dataset is read-only."},SDuplicateFieldName:{org:'Duplicate fieldname : "%s"'},SFieldNotFound:{org:'Field not found : "%s"'},SInactiveDataset:{org:"Operation cannot be performed on an inactive dataset"},SInvalidDisplayValues:{org:'"%s" are not valid boolean displayvalues'},SInvalidFieldSize:{org:"Invalid field size : %d"},SInvalidTypeConversion:{org:"Invalid type conversion to %s in field %s"},SNeedField:{org:"Field %s is required, but not supplied."},SNeedFieldName:{org:"Field needs a name"},SNoDataset:{org:'No dataset asssigned for field : "%s"'},SNoSuchRecord:{org:"Could not find the requested record."},SNotABoolean:{org:'"%s" is not a valid boolean'},SNotAFloat:{org:'"%s" is not a valid float'},SNotAninteger:{org:'"%s" is not a valid integer'},SNotEditing:{org:'Operation not allowed, dataset "%s" is not in an edit or insert state.'},SRangeError:{org:"%f is not between %f and %f for %s"},SUniDirectional:{org:"Operation cannot be performed on an unidirectional dataset"},SUnknownFieldType:{org:"Unknown field type : %s"},SUnknownParamFieldType:{org:'Unknown fieldtype for parameter "%s".'},SIndexNotFound:{org:"Index '%s' not found"},SFieldValueError:{org:"Invalid value for field '%s'"},SDuplicateName:{org:"Duplicate name '%s' in %s"},SLookupInfoError:{org:"Lookup information for field '%s' is incomplete"},SErrInvalidDateTime:{org:'Invalid date/time value : "%s"'},SatEOFInternalOnly:{org:"loAtEOF is for internal use only."},SErrInsertingSameRecordtwice:{org:"Attempt to insert the same record twice."},SNestedDataSetClass:{org:"Nested dataset must inherit from %s"},SCircularDataLink:{org:"Circular datalinks are not allowed"}}})),rtl.module("DB",["System","Classes","SysUtils","JS","Types","DateUtils"],(function(){"use strict";var t=this,e=t.$impl;this.YesNoChars=["N","Y"],this.TDataSetState={0:"dsInactive",dsInactive:0,1:"dsBrowse",dsBrowse:1,2:"dsEdit",dsEdit:2,3:"dsInsert",dsInsert:3,4:"dsSetKey",dsSetKey:4,5:"dsCalcFields",dsCalcFields:5,6:"dsFilter",dsFilter:6,7:"dsNewValue",dsNewValue:7,8:"dsOldValue",dsOldValue:8,9:"dsCurValue",dsCurValue:9,10:"dsBlockRead",dsBlockRead:10,11:"dsInternalCalc",dsInternalCalc:11,12:"dsOpening",dsOpening:12,13:"dsRefreshFields",dsRefreshFields:13},this.TDataEvent={0:"deFieldChange",deFieldChange:0,1:"deRecordChange",deRecordChange:1,2:"deDataSetChange",deDataSetChange:2,3:"deDataSetScroll",deDataSetScroll:3,4:"deLayoutChange",deLayoutChange:4,5:"deUpdateRecord",deUpdateRecord:5,6:"deUpdateState",deUpdateState:6,7:"deCheckBrowseMode",deCheckBrowseMode:7,8:"dePropertyChange",dePropertyChange:8,9:"deFieldListChange",deFieldListChange:9,10:"deFocusControl",deFocusControl:10,11:"deParentScroll",deParentScroll:11,12:"deConnectChange",deConnectChange:12,13:"deReconcileError",deReconcileError:13,14:"deDisabledStateChange",deDisabledStateChange:14},this.TUpdateStatus={0:"usModified",usModified:0,1:"usInserted",usInserted:1,2:"usDeleted",usDeleted:2},this.TProviderFlag={0:"pfInUpdate",pfInUpdate:0,1:"pfInWhere",pfInWhere:1,2:"pfInKey",pfInKey:2,3:"pfHidden",pfHidden:3,4:"pfRefreshOnInsert",pfRefreshOnInsert:4,5:"pfRefreshOnUpdate",pfRefreshOnUpdate:5},this.$rtti.$Enum("TProviderFlag",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TProviderFlag}),this.$rtti.$Set("TProviderFlags",{comptype:this.$rtti.TProviderFlag}),this.$rtti.$Class("TFieldDefs"),this.$rtti.$Class("TField"),this.$rtti.$Class("TDataSet"),this.$rtti.$Class("TDataSource"),this.$rtti.$Class("TRecordUpdateDescriptor"),rtl.createClass(this,"EDatabaseError",pas.SysUtils.Exception,(function(){})),this.TFieldType={0:"ftUnknown",ftUnknown:0,1:"ftString",ftString:1,2:"ftInteger",ftInteger:2,3:"ftLargeInt",ftLargeInt:3,4:"ftBoolean",ftBoolean:4,5:"ftFloat",ftFloat:5,6:"ftDate",ftDate:6,7:"ftTime",ftTime:7,8:"ftDateTime",ftDateTime:8,9:"ftAutoInc",ftAutoInc:9,10:"ftBlob",ftBlob:10,11:"ftMemo",ftMemo:11,12:"ftFixedChar",ftFixedChar:12,13:"ftVariant",ftVariant:13,14:"ftDataset",ftDataset:14,15:"ftWideString",ftWideString:15},this.$rtti.$Enum("TFieldType",{minvalue:0,maxvalue:15,ordtype:1,enumtype:this.TFieldType}),this.TFieldAttribute={0:"faHiddenCol",faHiddenCol:0,1:"faReadonly",faReadonly:1,2:"faRequired",faRequired:2,3:"faLink",faLink:3,4:"faUnNamed",faUnNamed:4,5:"faFixed",faFixed:5},this.$rtti.$Enum("TFieldAttribute",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TFieldAttribute}),this.$rtti.$Set("TFieldAttributes",{comptype:this.$rtti.TFieldAttribute}),rtl.createClass(this,"TNamedItem",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FName=""},this.GetDisplayName=function(){return this.FName},this.SetDisplayName=function(e){var i=0;this.FName!==e&&(""!==e&&t.TFieldDefs.isPrototypeOf(this.FCollection)&&(i=this.FCollection.IndexOf(e))>=0&&i!==this.GetIndex()&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SDuplicateName"),pas.System.VarRecs(18,e,18,this.FCollection.$classname)),this.FName=e,pas.Classes.TCollectionItem.SetDisplayName.call(this,e))},this.$rtti.addProperty("Name",2,rtl.string,"FName","SetDisplayName")})),rtl.createClass(this,"TDefCollection",pas.Classes.TOwnedCollection,(function(){this.$init=function(){pas.Classes.TOwnedCollection.$init.call(this),this.FDataset=null},this.$final=function(){this.FDataset=void 0,pas.Classes.TOwnedCollection.$final.call(this)},this.SetItemName=function(e){var i=null,s="";""===(i=rtl.as(e,t.TNamedItem)).FName?(s=pas.System.Copy(this.$classname,2,5)+pas.SysUtils.IntToStr(i.FID+1),null!=this.FDataset&&(s=this.FDataset.FName+s),i.SetDisplayName(s)):pas.Classes.TCollection.SetItemName.call(this,e)},this.create$3=function(t,e,i){return pas.Classes.TOwnedCollection.Create$2.call(this,e,i),this.FDataset=t,this},this.Find=function(t){var e=null,i=0;e=null;for(var s=0,n=this.GetCount()-1;s<=n;s++)if(i=s,pas.SysUtils.AnsiSameText(this.GetItem(i).FName,t)){e=this.GetItem(i);break}return e},this.IndexOf=function(t){var e=0,i=0;e=-1;for(var s=0,n=this.GetCount()-1;s<=n;s++)if(i=s,pas.SysUtils.AnsiSameText(this.GetItem(i).FName,t)){e=i;break}return e}})),rtl.createClass(this,"TFieldDef",this.TNamedItem,(function(){this.$init=function(){t.TNamedItem.$init.call(this),this.FAttributes={},this.FDataType=0,this.FFieldNo=0,this.FInternalCalcField=!1,this.FPrecision=0,this.FRequired=!1,this.FSize=0},this.$final=function(){this.FAttributes=void 0,t.TNamedItem.$final.call(this)},this.GetFieldClass=function(){return null!=this.FCollection&&t.TFieldDefs.isPrototypeOf(this.FCollection)&&null!=this.FCollection.FDataset?this.FCollection.FDataset.GetFieldClass(this.FDataType):null},this.SetAttributes=function(t){this.FAttributes=rtl.refSet(t),this.Changed(!1)},this.SetDataType=function(t){this.FDataType=t,this.Changed(!1)},this.SetPrecision=function(t){this.FPrecision=t,this.Changed(!1)},this.SetSize=function(t){this.FSize=t,this.Changed(!1)},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.call(this,t),this.FFieldNo=this.GetIndex()+1,this},this.Create$3=function(t,e,i,s,n,o){return pas.Classes.TCollectionItem.Create$1.call(this,t),this.SetDisplayName(e),this.FDataType=i,this.FSize=s,this.FRequired=n,this.FPrecision=-1,this.FFieldNo=o,this},this.Destroy=function(){pas.Classes.TCollectionItem.Destroy.call(this)},this.Assign=function(e){var i=null;if(i=null,t.TFieldDef.isPrototypeOf(e)&&(i=rtl.as(e,t.TFieldDef)),null!=i){this.FCollection.BeginUpdate();try{this.SetDisplayName(i.FName),this.SetDataType(i.FDataType),this.SetSize(i.FSize),this.SetPrecision(i.FPrecision),this.FRequired=i.FRequired}finally{this.FCollection.EndUpdate()}}else pas.Classes.TPersistent.Assign.call(this,e)},this.CreateField=function(e){var i=null,s=null;null===(s=this.GetFieldClass())&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SUnknownFieldType"),pas.System.VarRecs(18,this.FName)),i=s.$create("Create$1",[e]);try{i.FFieldDef=this,i.SetSize(this.FSize),i.FRequired=this.FRequired,i.FFieldName=this.FName,i.FDisplayLabel=this.GetDisplayName(),i.FFieldNo=this.FFieldNo,i.SetFieldType(this.FDataType),i.FReadOnly=1 in this.FAttributes,i.SetDataset(this.FCollection.FDataset),t.TFloatField.isPrototypeOf(i)&&i.SetPrecision(this.FPrecision)}catch(t){throw i=rtl.freeLoc(i),t}return i};var e=this.$rtti;e.addProperty("Attributes",2,t.$rtti.TFieldAttributes,"FAttributes","SetAttributes",{Default:{}}),e.addProperty("DataType",2,t.$rtti.TFieldType,"FDataType","SetDataType"),e.addProperty("Precision",2,rtl.longint,"FPrecision","SetPrecision",{Default:0}),e.addProperty("Size",2,rtl.longint,"FSize","SetSize",{Default:0})})),rtl.createClass(this,"TFieldDefs",this.TDefCollection,(function(){this.GetItem$1=function(t){return this.GetItem(t)},this.FieldDefClass=function(){return t.TFieldDef},this.Create$4=function(e){return t.TDefCollection.create$3.call(this,e,this.Owner(),this.$class.FieldDefClass()),this},this.Add$2=function(t,e,i,s,n){return this.$class.FieldDefClass().$create("Create$3",[this,t,e,i,s,n])},this.Add$3=function(e,i,s,n){0===e.length&&t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SNeedFieldName"),this.FDataset),this.BeginUpdate();try{this.Add$2(e,i,s,n,this.GetCount()+1)}finally{this.EndUpdate()}},this.Add$4=function(t,e,i){this.Add$3(t,e,i,!1)},this.Add$5=function(t,e){this.Add$3(t,e,0,!1)}})),this.TFieldKind={0:"fkData",fkData:0,1:"fkCalculated",fkCalculated:1,2:"fkLookup",fkLookup:2,3:"fkInternalCalc",fkInternalCalc:3},this.$rtti.$Enum("TFieldKind",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TFieldKind}),this.$rtti.$MethodVar("TFieldNotifyEvent",{procsig:rtl.newTIProcSig([["Sender",this.$rtti.TField]]),methodkind:0}),this.$rtti.$MethodVar("TFieldGetTextEvent",{procsig:rtl.newTIProcSig([["Sender",this.$rtti.TField],["aText",rtl.string,1],["DisplayText",rtl.boolean]]),methodkind:0}),this.$rtti.$MethodVar("TFieldSetTextEvent",{procsig:rtl.newTIProcSig([["Sender",this.$rtti.TField],["aText",rtl.string,2]]),methodkind:0}),rtl.createClass(this,"TLookupList",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FList=null},this.$final=function(){this.FList=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(){return this.FList=pas.Classes.TFPList.$create("Create"),this},this.Destroy=function(){this.Clear(),this.FList.$destroy("Destroy"),pas.System.TObject.Destroy.call(this)},this.Clear=function(){this.FList.Clear()}})),rtl.createClass(this,"TField",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FAlignment=0,this.FConstraintErrorMessage="",this.FCustomConstraint="",this.FDataSet=null,this.FDataType=0,this.FDefaultExpression="",this.FDisplayLabel="",this.FDisplayWidth=0,this.FFieldDef=null,this.FFieldKind=0,this.FFieldName="",this.FFieldNo=0,this.FFields=null,this.FHasConstraints=!1,this.FImportedConstraint="",this.FKeyFields="",this.FLookupCache=!1,this.FLookupDataSet=null,this.FLookupKeyfields="",this.FLookupresultField="",this.FLookupList=null,this.FOnChange=null,this.FOnGetText=null,this.FOnSetText=null,this.FOnValidate=null,this.FOrigin="",this.FReadOnly=!1,this.FRequired=!1,this.FSize=0,this.FValidChars=[],this.FValueBuffer=void 0,this.FValidating=!1,this.FVisible=!1,this.FProviderFlags={}},this.$final=function(){this.FDataSet=void 0,this.FFieldDef=void 0,this.FFields=void 0,this.FLookupDataSet=void 0,this.FLookupList=void 0,this.FOnChange=void 0,this.FOnGetText=void 0,this.FOnSetText=void 0,this.FOnValidate=void 0,this.FValidChars=void 0,this.FProviderFlags=void 0,pas.Classes.TComponent.$final.call(this)},this.GetIndex=function(){return null!=this.FDataSet?this.FDataSet.FFieldList.IndexOf(this):-1},this.SetAlignment=function(t){this.FAlignment!==t&&(this.FAlignment=t,this.PropertyChanged(!1))},this.SetIndex=function(t){null!==this.FFields&&this.FFields.SetFieldIndex(this,t)},this.SetDisplayLabel=function(t){this.FDisplayLabel!==t&&(this.FDisplayLabel=t,this.PropertyChanged(!0))},this.SetDisplayWidth=function(t){this.FDisplayWidth!==t&&(this.FDisplayWidth=t,this.PropertyChanged(!0))},this.GetDisplayWidth=function(){return 0===this.FDisplayWidth?this.GetDefaultWidth():this.FDisplayWidth},this.SetReadOnly=function(t){this.FReadOnly!==t&&(this.FReadOnly=t,this.PropertyChanged(!0))},this.SetVisible=function(t){this.FVisible!==t&&(this.FVisible=t,this.PropertyChanged(!0))},this.IsDisplayLabelStored=function(){return this.GetDisplayName()!==this.FFieldName},this.IsDisplayWidthStored=function(){return 0!==this.FDisplayWidth},this.GetLookupList=function(){return null==this.FLookupList&&(this.FLookupList=t.TLookupList.$create("Create$1")),this.FLookupList},this.CalcLookupValue=function(){null!=this.FLookupDataSet&&this.FLookupDataSet.GetActive()?this.SetAsJSValue(this.FLookupDataSet.Lookup(this.FLookupKeyfields,this.FDataSet.GetFieldValues(this.FKeyFields),this.FLookupresultField)):this.SetAsJSValue(null)},this.RaiseAccessError=function(t){throw this.AccessError(t)},this.AccessError=function(e){return t.EDatabaseError.$create("CreateFmt",[rtl.getResStr(pas.DBConst,"SInvalidTypeConversion"),pas.System.VarRecs(18,e,18,this.FFieldName)])},this.CheckInactive=function(){null!=this.FDataSet&&this.FDataSet.CheckInactive()},this.CheckTypeSize=function(e){0===e||this.IsBlob()||t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SInvalidFieldSize"),pas.System.VarRecs(0,e))},this.Change=function(){null!=this.FOnChange&&this.FOnChange(this)},this.Bind=function(e){e&&2===this.FFieldKind&&(null!==this.FLookupDataSet&&""!==this.FLookupKeyfields&&""!==this.FLookupresultField&&""!==this.FKeyFields||t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SLookupInfoError"),pas.System.VarRecs(18,this.GetDisplayName())),this.FFields.CheckFieldNames(this.FKeyFields),this.FLookupDataSet.Open(),this.FLookupDataSet.FFieldList.CheckFieldNames(this.FLookupKeyfields),this.FLookupDataSet.FieldByName(this.FLookupresultField),this.FLookupCache&&this.RefreshLookupList())},this.GetAsBoolean=function(){return this.RaiseAccessError(e.SBoolean),!1,!1},this.GetAsLargeInt=function(){return this.RaiseAccessError(e.SLargeInt),0,0},this.GetAsDateTime=function(){return this.RaiseAccessError(e.SDateTime),0,0},this.GetAsFloat=function(){return this.RaiseAccessError(e.SDateTime),0,0},this.GetAsInteger=function(){return this.RaiseAccessError(e.SInteger),0,0},this.GetAsJSValue=function(){return this.GetData()},this.GetAsString=function(){return this.GetClassDesc()},this.GetClassDesc=function(){var t;return t=pas.System.Copy(this.$classname,2,pas.System.Pos("Field",this.$classname)-2),this.GetIsNull()?"("+pas.SysUtils.LowerCase(t)+")":"("+pas.SysUtils.UpperCase(t)+")"},this.GetDataSize=function(){return 0,0},this.GetDefaultWidth=function(){return 10,10},this.GetDisplayName=function(){return""!==this.FDisplayLabel?this.FDisplayLabel:this.FFieldName},this.GetIsNull=function(){return pas.JS.isNull(this.GetData())},this.Notification=function(t,e){pas.Classes.TComponent.Notification.call(this,t,e),1===e&&t===this.FLookupDataSet&&(this.FLookupDataSet=null)},this.PropertyChanged=function(t){null!==this.FDataSet&&this.FDataSet.GetActive()&&(t?this.FDataSet.DataEvent(4,0):this.FDataSet.DataEvent(2,0))},this.SetAsBoolean=function(t){this.RaiseAccessError(e.SBoolean)},this.SetAsDateTime=function(t){this.RaiseAccessError(e.SDateTime)},this.SetAsFloat=function(t){this.RaiseAccessError(e.SFloat)},this.SetAsInteger=function(t){this.RaiseAccessError(e.SInteger)},this.SetAsJSValue=function(e){if(pas.JS.isNull(e))this.Clear();else try{this.SetVarValue(e)}catch(e){if(!pas.SysUtils.EVariantError.isPrototypeOf(e))throw e;t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SFieldValueError"),pas.System.VarRecs(18,this.GetDisplayName()))}},this.SetAsString=function(t){this.RaiseAccessError(e.SString)},this.SetDataset=function(t){t!==this.FDataSet&&(null!=this.FDataSet&&(this.FDataSet.CheckInactive(),this.FDataSet.FFieldList.Remove(this)),null!=t&&(t.CheckInactive(),t.FFieldList.Add(this)),this.FDataSet=t)},this.SetDataType=function(t){this.FDataType=t},this.SetSize=function(t){this.CheckInactive(),this.$class.CheckTypeSize(t),this.FSize=t},this.SetVarValue=function(t){this.RaiseAccessError(e.SJSValue)},this.Create$1=function(t){return pas.Classes.TComponent.Create$1.call(this,t),this.FVisible=!0,this.FValidChars=rtl.arraySetLength(this.FValidChars,"",255),this.FProviderFlags=rtl.createSet(0,1),this},this.Destroy=function(){null!=this.FDataSet&&(this.FDataSet.SetActive(!1),null!=this.FFields&&this.FFields.Remove(this)),rtl.free(this,"FLookupList"),pas.Classes.TComponent.Destroy.call(this)},this.GetParentComponent=function(){return this.FDataSet},this.SetParentComponent=function(e){this.SetDataset(rtl.as(e,t.TDataSet))},this.HasParent=function(){return!0,!0},this.Assign=function(e){null===e?this.Clear():t.TField.isPrototypeOf(e)?this.SetAsJSValue(e.GetAsJSValue()):pas.Classes.TPersistent.Assign.call(this,e)},this.Clear=function(){this.SetData(null)},this.GetData=function(){var e=void 0;return null===this.FDataSet&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SNoDataset"),pas.System.VarRecs(18,this.FFieldName)),this.FValidating?e=this.FValueBuffer:(e=this.FDataSet.GetFieldData(this),pas.JS.isUndefined(e)&&(e=null)),e},this.IsBlob=function(){return!1,!1},this.RefreshLookupList=function(){var t;if(null!=this.FLookupDataSet&&0!==this.FLookupKeyfields.length&&0!==this.FLookupresultField.length&&0!==this.FKeyFields.length){t=this.FLookupDataSet.GetActive();try{this.FLookupDataSet.SetActive(!0),this.FFields.CheckFieldNames(this.FKeyFields),this.FLookupDataSet.FFieldList.CheckFieldNames(this.FLookupKeyfields),this.FLookupDataSet.FieldByName(this.FLookupresultField),this.GetLookupList().Clear(),this.FLookupDataSet.DisableControls();try{for(this.FLookupDataSet.First();!this.FLookupDataSet.FEOF;)this.FLookupDataSet.Next()}finally{this.FLookupDataSet.EnableControls()}}finally{this.FLookupDataSet.SetActive(t)}}},this.SetData=function(e){null==this.FDataSet&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SNoDataset"),pas.System.VarRecs(18,this.FFieldName)),this.FDataSet.SetFieldData(this,e)},this.SetFieldType=function(t){},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment",{Default:pas.Classes.TAlignment.taLeftJustify}),i.addProperty("CustomConstraint",0,rtl.string,"FCustomConstraint","FCustomConstraint"),i.addProperty("ConstraintErrorMessage",0,rtl.string,"FConstraintErrorMessage","FConstraintErrorMessage"),i.addProperty("DefaultExpression",0,rtl.string,"FDefaultExpression","FDefaultExpression"),i.addProperty("DisplayLabel",15,rtl.string,"GetDisplayName","SetDisplayLabel",{stored:"IsDisplayLabelStored"}),i.addProperty("DisplayWidth",15,rtl.longint,"GetDisplayWidth","SetDisplayWidth",{stored:"IsDisplayWidthStored"}),i.addProperty("FieldKind",0,t.$rtti.TFieldKind,"FFieldKind","FFieldKind"),i.addProperty("FieldName",0,rtl.string,"FFieldName","FFieldName"),i.addProperty("HasConstraints",0,rtl.boolean,"FHasConstraints",""),i.addProperty("Index",3,rtl.longint,"GetIndex","SetIndex"),i.addProperty("ImportedConstraint",0,rtl.string,"FImportedConstraint","FImportedConstraint"),i.addProperty("KeyFields",0,rtl.string,"FKeyFields","FKeyFields"),i.addProperty("LookupCache",0,rtl.boolean,"FLookupCache","FLookupCache"),i.addProperty("LookupDataSet",0,t.$rtti.TDataSet,"FLookupDataSet","FLookupDataSet"),i.addProperty("LookupKeyFields",0,rtl.string,"FLookupKeyfields","FLookupKeyfields"),i.addProperty("LookupResultField",0,rtl.string,"FLookupresultField","FLookupresultField"),i.addProperty("Origin",0,rtl.string,"FOrigin","FOrigin"),i.addProperty("ProviderFlags",0,t.$rtti.TProviderFlags,"FProviderFlags","FProviderFlags"),i.addProperty("ReadOnly",2,rtl.boolean,"FReadOnly","SetReadOnly"),i.addProperty("Required",0,rtl.boolean,"FRequired","FRequired"),i.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default:!0}),i.addProperty("OnChange",0,t.$rtti.TFieldNotifyEvent,"FOnChange","FOnChange"),i.addProperty("OnGetText",0,t.$rtti.TFieldGetTextEvent,"FOnGetText","FOnGetText"),i.addProperty("OnSetText",0,t.$rtti.TFieldSetTextEvent,"FOnSetText","FOnSetText"),i.addProperty("OnValidate",0,t.$rtti.TFieldNotifyEvent,"FOnValidate","FOnValidate")})),rtl.createClass(this,"TStringField",this.TField,(function(){this.$init=function(){t.TField.$init.call(this),this.FFixedChar=!1,this.FTransliterate=!1},this.CheckTypeSize=function(e){e<0&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SInvalidFieldSize"),pas.System.VarRecs(0,e))},this.GetAsBoolean=function(){var e="";return(e=this.GetAsString()).length>0&&pas.System.upcase(e.charAt(0)).charCodeAt()in rtl.createSet(84,t.YesNoChars[1].charCodeAt())},this.GetAsDateTime=function(){return pas.SysUtils.StrToDateTime(this.GetAsString())},this.GetAsFloat=function(){return pas.SysUtils.StrToFloat(this.GetAsString())},this.GetAsInteger=function(){return pas.SysUtils.StrToInt(this.GetAsString())},this.GetAsLargeInt=function(){return pas.SysUtils.StrToInt64(this.GetAsString())},this.GetAsString=function(){var t;return t=this.GetData(),rtl.isString(t)?""+t:""},this.GetAsJSValue=function(){return this.GetData()},this.GetDefaultWidth=function(){return this.FSize},this.SetAsBoolean=function(t){t?this.SetAsString("T"):this.SetAsString("F")},this.SetAsDateTime=function(t){this.SetAsString(pas.SysUtils.DateTimeToStr(t,!1))},this.SetAsFloat=function(t){this.SetAsString(pas.SysUtils.FloatToStr(t))},this.SetAsInteger=function(t){this.SetAsString(pas.SysUtils.IntToStr(t))},this.SetAsString=function(t){this.SetData(t)},this.SetVarValue=function(t){rtl.isString(t)?this.SetAsString(""+t):this.RaiseAccessError(rtl.getResStr(pas.DBConst,"SFieldValueError"))},this.Create$1=function(e){return t.TField.Create$1.call(this,e),this.SetDataType(1),this.FFixedChar=!1,this.FTransliterate=!1,this.FSize=20,this},this.SetFieldType=function(t){t in rtl.createSet(1,12,15)&&this.SetDataType(t)},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("Size",2,rtl.longint,"FSize","SetSize",{Default:20})})),rtl.createClass(this,"TNumericField",this.TField,(function(){this.$init=function(){t.TField.$init.call(this),this.FDisplayFormat="",this.FEditFormat=""},this.CheckTypeSize=function(e){e>16&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SInvalidFieldSize"),pas.System.VarRecs(0,e))},this.RangeError=function(e,i,s){t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SRangeError"),pas.System.VarRecs(3,e,3,i,3,s,18,this.FFieldName))},this.SetDisplayFormat=function(t){this.FDisplayFormat!==t&&(this.FDisplayFormat=t,this.PropertyChanged(!0))},this.SetEditFormat=function(t){this.FEditFormat!==t&&(this.FEditFormat=t,this.PropertyChanged(!0))},this.GetAsBoolean=function(){return 0!==this.GetAsInteger()},this.SetAsBoolean=function(t){this.SetAsInteger(t+0)},this.Create$1=function(e){return t.TField.Create$1.call(this,e),this.SetAlignment(1),this},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Alignment",2,pas.Classes.$rtti.TAlignment,"FAlignment","SetAlignment",{Default:pas.Classes.TAlignment.taRightJustify}),e.addProperty("DisplayFormat",2,rtl.string,"FDisplayFormat","SetDisplayFormat"),e.addProperty("EditFormat",2,rtl.string,"FEditFormat","SetEditFormat")})),rtl.createClass(this,"TIntegerField",this.TNumericField,(function(){this.$init=function(){t.TNumericField.$init.call(this),this.FMinValue=0,this.FMaxValue=0,this.FMinRange=0,this.FMaxRange=0},this.SetMinValue=function(t){t>=this.FMinRange&&t<=this.FMaxRange?this.FMinValue=t:this.RangeError(t,this.FMinRange,this.FMaxRange)},this.SetMaxValue=function(t){t>=this.FMinRange&&t<=this.FMaxRange?this.FMaxValue=t:this.RangeError(t,this.FMinRange,this.FMaxRange)},this.GetAsFloat=function(){return this.GetAsInteger()},this.GetAsInteger=function(){var t=0;return this.GetValue({get:function(){return t},set:function(e){t=e}})||(t=0),t},this.GetAsString=function(){var t=0;return this.GetValue({get:function(){return t},set:function(e){t=e}})?pas.SysUtils.IntToStr(t):""},this.GetAsJSValue=function(){var t=0;return this.GetValue({get:function(){return t},set:function(e){t=e}})?t:null},this.GetValue=function(t){var e,i;return i=this.GetData(),(e=pas.JS.isInteger(i))&&t.set(rtl.trunc(i)),e},this.SetAsFloat=function(t){this.SetAsInteger(Math.round(t))},this.SetAsInteger=function(t){this.CheckRange(t)?this.SetData(t):0!==this.FMinValue||0!==this.FMaxValue?this.RangeError(t,this.FMinValue,this.FMaxValue):this.RangeError(t,this.FMinRange,this.FMaxRange)},this.SetAsString=function(e){var i=0,s=0;0===e.length?this.Clear():(pas.System.val$6(e,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),0===s?this.SetAsInteger(i):t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SNotAninteger"),pas.System.VarRecs(18,e)))},this.SetVarValue=function(t){pas.JS.isInteger(t)?this.SetAsInteger(rtl.trunc(t)):this.RaiseAccessError(e.SInteger)},this.GetAsLargeInt=function(){return this.GetAsInteger()},this.Create$1=function(e){return t.TNumericField.Create$1.call(this,e),this.SetDataType(2),this.FMinRange=-2147483648,this.FMaxRange=2147483647,this},this.CheckRange=function(t){return 0!==this.FMinValue||0!==this.FMaxValue?t>=this.FMinValue&&t<=this.FMaxValue:t>=this.FMinRange&&t<=this.FMaxRange},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("MaxValue",2,rtl.longint,"FMaxValue","SetMaxValue",{Default:0}),i.addProperty("MinValue",2,rtl.longint,"FMinValue","SetMinValue",{Default:0})})),rtl.createClass(this,"TLargeintField",this.TNumericField,(function(){this.$init=function(){t.TNumericField.$init.call(this),this.FMinValue=0,this.FMaxValue=0,this.FMinRange=0,this.FMaxRange=0},this.SetMinValue=function(t){t>=this.FMinRange&&t<=this.FMaxRange?this.FMinValue=t:this.RangeError(t,this.FMinRange,this.FMaxRange)},this.SetMaxValue=function(t){t>=this.FMinRange&&t<=this.FMaxRange?this.FMaxValue=t:this.RangeError(t,this.FMinRange,this.FMaxRange)},this.GetAsFloat=function(){return this.GetAsLargeInt()},this.GetAsInteger=function(){return this.GetAsLargeInt()},this.GetAsLargeInt=function(){var t=0;return this.GetValue({get:function(){return t},set:function(e){t=e}})||(t=0),t},this.GetAsString=function(){var t=0;return this.GetValue({get:function(){return t},set:function(e){t=e}})?pas.SysUtils.IntToStr(t):""},this.GetAsJSValue=function(){var t=0;return this.GetValue({get:function(){return t},set:function(e){t=e}})?t:null},this.GetValue=function(t){var e,i;return i=this.GetData(),(e=pas.JS.isInteger(i))&&t.set(rtl.trunc(i)),e},this.SetAsFloat=function(t){this.SetAsLargeInt(Math.round(t))},this.SetAsInteger=function(t){this.SetAsLargeInt(t)},this.SetAsLargeInt=function(t){this.CheckRange(t)?this.SetData(t):this.RangeError(t,this.FMinValue,this.FMaxValue)},this.SetAsString=function(e){var i=0,s=0;0===e.length?this.Clear():(pas.System.val(e,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),0===s?this.SetAsLargeInt(i):t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SNotAninteger"),pas.System.VarRecs(18,e)))},this.SetVarValue=function(t){pas.JS.isInteger(t)?this.SetAsLargeInt(rtl.trunc(t)):this.RaiseAccessError(e.SLargeInt)},this.Create$1=function(e){return t.TNumericField.Create$1.call(this,e),this.SetDataType(3),this.FMinRange=-9007199254740991,this.FMaxRange=9007199254740991,this},this.CheckRange=function(t){return 0!==this.FMinValue||0!==this.FMaxValue?t>=this.FMinValue&&t<=this.FMaxValue:t>=this.FMinRange&&t<=this.FMaxRange},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("MaxValue",2,rtl.nativeint,"FMaxValue","SetMaxValue",{Default:0}),i.addProperty("MinValue",2,rtl.nativeint,"FMinValue","SetMinValue",{Default:0})})),rtl.createClass(this,"TAutoIncField",this.TIntegerField,(function(){this.SetAsInteger=function(e){t.TIntegerField.SetAsInteger.apply(this,arguments)},this.Create$1=function(e){return t.TIntegerField.Create$1.call(this,e),this.SetDataType(9),this},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TFloatField",this.TNumericField,(function(){this.$init=function(){t.TNumericField.$init.call(this),this.FCurrency=!1,this.FMaxValue=0,this.FMinValue=0,this.FPrecision=0},this.SetCurrency=function(t){this.FCurrency!==t&&(this.FCurrency=t)},this.SetPrecision=function(t){this.FPrecision=-1===t||t>1?t:2},this.GetAsFloat=function(){var t;return t=this.GetData(),rtl.isNumber(t)?rtl.getNumber(t):0},this.GetAsLargeInt=function(){return Math.round(this.GetAsFloat())},this.GetAsInteger=function(){return Math.round(this.GetAsFloat())},this.GetAsJSValue=function(){var t;return t=this.GetData(),rtl.isNumber(t)?t:null},this.GetAsString=function(){var t;return t=this.GetData(),rtl.isNumber(t)?pas.SysUtils.FloatToStr(rtl.getNumber(t)):""},this.SetAsFloat=function(t){this.CheckRange(t)?this.SetData(t):this.RangeError(t,this.FMinValue,this.FMaxValue)},this.SetAsInteger=function(t){this.SetAsFloat(t)},this.SetAsString=function(e){var i=0;""===e?this.Clear():(pas.SysUtils.TryStrToFloat$2(e,{get:function(){return i},set:function(t){i=t}})||t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SNotAFloat"),pas.System.VarRecs(18,e)),this.SetAsFloat(i))},this.SetVarValue=function(t){rtl.isNumber(t)?this.SetAsFloat(rtl.getNumber(t)):this.RaiseAccessError("Float")},this.Create$1=function(e){return t.TNumericField.Create$1.call(this,e),this.SetDataType(5),this.FPrecision=15,this},this.CheckRange=function(t){return 0===this.FMinValue&&0===this.FMaxValue||t>=this.FMinValue&&t<=this.FMaxValue},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Currency",2,rtl.boolean,"FCurrency","SetCurrency",{Default:!1}),e.addProperty("MaxValue",0,rtl.double,"FMaxValue","FMaxValue"),e.addProperty("MinValue",0,rtl.double,"FMinValue","FMinValue"),e.addProperty("Precision",2,rtl.longint,"FPrecision","SetPrecision",{Default:15})})),rtl.createClass(this,"TBooleanField",this.TField,(function(){this.FDisplays$a$clone=function(t){var e=[];e.length=2;for(var i=0;i<2;i++)e[i]=t[i].slice(0);return e},this.$init=function(){t.TField.$init.call(this),this.FDisplayValues="",this.FDisplays=rtl.arraySetLength(null,"",2,2)},this.$final=function(){this.FDisplays=void 0,t.TField.$final.call(this)},this.SetDisplayValues=function(e){var i=0;this.FDisplayValues!==e&&(((i=pas.System.Pos(";",e))<2||i===e.length)&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SInvalidDisplayValues"),pas.System.VarRecs(18,e)),this.FDisplayValues=e,this.FDisplays[0][1]=pas.System.Copy(e,1,i-1),this.FDisplays[1][1]=pas.SysUtils.UpperCase(this.FDisplays[0][1]),this.FDisplays[0][0]=pas.System.Copy(e,i+1,e.length-i),this.FDisplays[1][0]=pas.SysUtils.UpperCase(this.FDisplays[0][0]),this.PropertyChanged(!0))},this.GetAsBoolean=function(){var t;return t=this.GetData(),!!pas.JS.isBoolean(t)&&!(0==t)},this.GetAsString=function(){var t;return t=this.GetData(),pas.JS.isBoolean(t)?this.FDisplays[0][+!(0==t)]:""},this.GetAsJSValue=function(){var t;return t=this.GetData(),pas.JS.isBoolean(t)?!(0==t):null},this.GetAsInteger=function(){return this.GetAsBoolean()+0},this.GetDefaultWidth=function(){var t=0;return(t=this.FDisplays[0][0].length)<this.FDisplays[0][1].length&&(t=this.FDisplays[0][1].length),t},this.SetAsBoolean=function(t){this.SetData(t)},this.SetAsString=function(e){var i;""===(i=pas.SysUtils.UpperCase(e))?this.Clear():1===pas.System.Pos(i,this.FDisplays[1][1])?this.SetAsBoolean(!0):1===pas.System.Pos(i,this.FDisplays[1][0])?this.SetAsBoolean(!1):t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SNotABoolean"),pas.System.VarRecs(18,e))},this.SetAsInteger=function(t){this.SetAsBoolean(0!==t)},this.SetVarValue=function(t){pas.JS.isBoolean(t)?this.SetAsBoolean(!(0==t)):rtl.isNumber(t)&&this.SetAsBoolean(0!==rtl.getNumber(t))},this.Create$1=function(e){return t.TField.Create$1.call(this,e),this.SetDataType(4),this.SetDisplayValues("True;False"),this},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("DisplayValues",2,rtl.string,"FDisplayValues","SetDisplayValues")})),rtl.createClass(this,"TDateTimeField",this.TField,(function(){this.$init=function(){t.TField.$init.call(this),this.FDisplayFormat=""},this.SetDisplayFormat=function(t){this.FDisplayFormat!==t&&(this.FDisplayFormat=t,this.PropertyChanged(!0))},this.ConvertToDateTime=function(e,i){return pas.JS.isNull(e)?0:null!=this.FDataSet?this.FDataSet.ConvertToDateTime(this,e,i):t.TDataSet.DefaultConvertToDateTime(this,e,i)},this.DateTimeToNativeDateTime=function(e){return null!=this.FDataSet?this.FDataSet.ConvertDateTimeToNative(this,e):t.TDataSet.DefaultConvertDateTimeToNative(this,e)},this.GetAsDateTime=function(){return this.ConvertToDateTime(this.GetData(),!1)},this.GetAsFloat=function(){return this.GetAsDateTime()},this.GetAsString=function(){var t="";return this.GetText({get:function(){return t},set:function(e){t=e}},!1),t},this.GetAsJSValue=function(){var t=void 0;return t=this.GetData(),rtl.isString(t)||(t=null),t},this.GetDataSize=function(){return t.TField.GetDataSize.call(this)},this.GetText=function(t,e){var i,s="";if(0===(i=this.ConvertToDateTime(this.GetData(),!1)))t.set("");else{if(e&&0!==this.FDisplayFormat.length)s=this.FDisplayFormat;else{var n=this.FDataType;s=7===n?pas.SysUtils.FormatSettings.LongTimeFormat:6===n?pas.SysUtils.FormatSettings.ShortDateFormat:"c"}t.set(pas.SysUtils.FormatDateTime(s,i))}},this.SetAsDateTime=function(t){this.SetData(this.DateTimeToNativeDateTime(t))},this.SetAsFloat=function(t){this.SetAsDateTime(t)},this.SetAsString=function(t){var e=0;""!==t?(e=pas.SysUtils.StrToDateTime(t),this.SetData(this.DateTimeToNativeDateTime(e))):this.SetData(null)},this.SetVarValue=function(t){this.SetAsDateTime(this.ConvertToDateTime(t,!0))},this.Create$1=function(e){return t.TField.Create$1.call(this,e),this.SetDataType(8),this},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("DisplayFormat",2,rtl.string,"FDisplayFormat","SetDisplayFormat")})),rtl.createClass(this,"TDateField",this.TDateTimeField,(function(){this.Create$1=function(e){return t.TDateTimeField.Create$1.call(this,e),this.SetDataType(6),this},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TTimeField",this.TDateTimeField,(function(){this.SetAsString=function(t){var e=0;""!==t?(e=pas.SysUtils.StrToTime(t),this.SetData(this.DateTimeToNativeDateTime(e))):this.SetData(null)},this.Create$1=function(e){return t.TDateTimeField.Create$1.call(this,e),this.SetDataType(7),this},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TBinaryField",this.TField,(function(){this.CheckTypeSize=function(e){e<1&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SInvalidFieldSize"),pas.System.VarRecs(0,e))},this.BlobToBytes=function(e){return null!=this.FDataSet?this.FDataSet.BlobDataToBytes(e):t.TDataSet.DefaultBlobDataToBytes(e)},this.BytesToBlob=function(e){return null!=this.FDataSet?this.FDataSet.BytesToBlobData(rtl.arrayRef(e)):t.TDataSet.DefaultBytesToBlobData(rtl.arrayRef(e))},this.GetAsString=function(){var t,e="",i=[],s=0;if(e="",null!=(t=this.GetData()))if(11===this.FDataType)e=""+t;else{i=this.BlobToBytes(t);for(var n=0,o=rtl.length(i)-1;n<=o;n++)s=n,e=e.concat(String.fromCharCode(i[s]))}return e},this.GetAsJSValue=function(){return this.GetData()},this.SetAsString=function(t){var e=[],i=0;if(11===this.FDataType)this.SetData(t);else{e=rtl.arraySetLength(e,0,t.length);for(var s=1,n=t.length;s<=n;s++)e[(i=s)-1]=t.charCodeAt(i-1);this.SetAsBytes(e)}},this.SetVarValue=function(t){var e=[],i=0,s=0;if(rtl.isArray(t)){s=rtl.length(t),e=rtl.arraySetLength(e,0,s);for(var n=1,o=s-1;n<=o;n++)e[i=n]=t[i];this.SetAsBytes(e)}else rtl.isString(t)?this.SetAsString(""+t):this.RaiseAccessError("Blob")},this.GetAsBytes=function(){var t,e=[];return t=this.GetData(),e=pas.System.Assigned(t)?this.BlobToBytes(t):rtl.arraySetLength(e,0,0)},this.SetAsBytes=function(t){this.SetData(this.BytesToBlob(rtl.arrayRef(t)))},this.Create$1=function(e){return t.TField.Create$1.call(this,e),this},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("Size",2,rtl.longint,"FSize","SetSize",{Default:16})})),this.TBlobDisplayValue={0:"dvClass",dvClass:0,1:"dvFull",dvFull:1,2:"dvClip",dvClip:2,3:"dvFit",dvFit:3},this.$rtti.$Enum("TBlobDisplayValue",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TBlobDisplayValue}),this.$rtti.$Enum("TBlobType",{minvalue:10,maxvalue:11,ordtype:1,enumtype:this.TFieldType}),rtl.createClass(this,"TBlobField",this.TBinaryField,(function(){this.$init=function(){t.TBinaryField.$init.call(this),this.FDisplayValue=0,this.FModified=!1,this.FBlobType=t.TFieldType.ftBlob},this.GetBlobType=function(){var e=t.TFieldType.ftBlob;return e=this.FBlobType,10===this.FDataType?e=10:11===this.FDataType&&(e=11),e},this.SetBlobType=function(t){this.FBlobType=t,this.SetFieldType(t)},this.SetDisplayValue=function(t){this.FDisplayValue!==t&&(this.FDisplayValue=t,this.PropertyChanged(!1))},this.CheckTypeSize=function(e){e<0&&t.DatabaseErrorFmt(rtl.getResStr(pas.DBConst,"SInvalidFieldSize"),pas.System.VarRecs(0,e))},this.GetBlobSize=function(){var t;return t=this.GetAsBytes(),rtl.length(t)},this.GetIsNull=function(){return this.FModified?0===this.GetBlobSize():t.TField.GetIsNull.call(this)},this.Create$1=function(e){return t.TBinaryField.Create$1.call(this,e),this.SetDataType(10),this},this.Clear=function(){this.SetData(null)},this.IsBlob=function(){return!0,!0},this.SetFieldType=function(t){t in rtl.createSet(10,11)&&this.SetDataType(t)},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("DisplayValue",2,t.$rtti.TBlobDisplayValue,"FDisplayValue","SetDisplayValue",{Default:t.TBlobDisplayValue.dvClass}),e.addProperty("BlobType",3,t.$rtti.TBlobType,"GetBlobType","SetBlobType"),e.addProperty("Size",2,rtl.longint,"FSize","SetSize",{Default:0})})),rtl.createClass(this,"TMemoField",this.TBlobField,(function(){this.Create$1=function(e){return t.TBlobField.Create$1.call(this,e),this.SetDataType(11),this},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TVariantField",this.TField,(function(){this.CheckTypeSize=function(t){},this.GetAsBoolean=function(){return 1==this.GetAsJSValue()},this.SetAsBoolean=function(t){this.SetVarValue(t)},this.GetAsDateTime=function(){var e;return e=this.GetData(),null!=this.FDataSet?this.FDataSet.ConvertToDateTime(this,e,!0):t.TDataSet.DefaultConvertToDateTime(this,e,!0)},this.SetAsDateTime=function(t){this.SetVarValue(t)},this.GetAsFloat=function(){var t,e=0;return t=this.GetData(),rtl.isNumber(t)?e=rtl.getNumber(t):rtl.isString(t)?e=parseFloat(""+t):this.RaiseAccessError("Variant"),e},this.SetAsFloat=function(t){this.SetVarValue(t)},this.GetAsInteger=function(){var t,e=0;return t=this.GetData(),pas.JS.isInteger(t)?e=rtl.trunc(t):rtl.isString(t)?e=parseInt(""+t):this.RaiseAccessError("Variant"),e},this.SetAsInteger=function(t){this.SetVarValue(t)},this.GetAsString=function(){var t,e="";return t=this.GetData(),pas.JS.isInteger(t)?e=pas.SysUtils.IntToStr(rtl.trunc(t)):rtl.isNumber(t)?e=pas.SysUtils.FloatToStr(rtl.getNumber(t)):rtl.isString(t)?e=""+t:this.RaiseAccessError("Variant"),e},this.SetAsString=function(t){this.SetVarValue(t)},this.GetAsJSValue=function(){return this.GetData()},this.SetVarValue=function(t){this.SetData(t)},this.Create$1=function(e){return t.TField.Create$1.call(this,e),this.SetDataType(13),this},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TDataSetField",this.TField,(function(){this.$init=function(){t.TField.$init.call(this),this.FNestedDataSet=null},this.$final=function(){this.FNestedDataSet=void 0,t.TField.$final.call(this)},this.AssignNestedDataSet=function(t){null!=this.FNestedDataSet&&(this.FNestedDataSet.Close(),this.FNestedDataSet.FDataSetField=null,null!=this.FDataSet&&this.FDataSet.GetNestedDataSets().Remove(this.FNestedDataSet)),null!=t&&this.FDataSet.GetNestedDataSets().Add(t),this.FNestedDataSet=t},this.Bind=function(e){t.TField.Bind.apply(this,arguments),null!=this.FNestedDataSet&&(e?0===this.FNestedDataSet.FState&&this.FNestedDataSet.Open():this.FNestedDataSet.Close())},this.Create$1=function(e){return t.TField.Create$1.apply(this,arguments),this.SetDataType(14),this},this.Destroy=function(){this.AssignNestedDataSet(null),t.TField.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown)})),this.TIndexOption={0:"ixPrimary",ixPrimary:0,1:"ixUnique",ixUnique:1,2:"ixDescending",ixDescending:2,3:"ixCaseInsensitive",ixCaseInsensitive:3,4:"ixExpression",ixExpression:4,5:"ixNonMaintained",ixNonMaintained:5},this.$rtti.$Enum("TIndexOption",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TIndexOption}),this.$rtti.$Set("TIndexOptions",{comptype:this.$rtti.TIndexOption}),rtl.createClass(this,"TIndexDef",this.TNamedItem,(function(){this.$init=function(){t.TNamedItem.$init.call(this),this.FCaseinsFields="",this.FDescFields="",this.FExpression="",this.FFields="",this.FOptions={},this.FSource=""},this.$final=function(){this.FOptions=void 0,t.TNamedItem.$final.call(this)},this.GetExpression=function(){return this.FExpression},this.SetCaseInsFields=function(t){this.FCaseinsFields!==t&&(""!==t&&(this.FOptions=rtl.unionSet(this.FOptions,rtl.createSet(3))),this.FCaseinsFields=t)},this.SetDescFields=function(t){this.FDescFields!==t&&(""!==t&&(this.FOptions=rtl.unionSet(this.FOptions,rtl.createSet(2))),this.FDescFields=t)},this.SetExpression=function(t){this.FExpression=t},this.Assign=function(e){var i=null;i=null,t.TIndexDef.isPrototypeOf(e)&&(i=rtl.as(e,t.TIndexDef)),null!=i?(this.FName=i.FName,this.FFields=i.FFields,this.FOptions=rtl.refSet(i.FOptions),this.FCaseinsFields=i.FCaseinsFields,this.FDescFields=i.FDescFields,this.FSource=i.FSource,this.FExpression=i.GetExpression()):pas.Classes.TPersistent.Assign.call(this,e)};var e=this.$rtti;e.addProperty("Expression",3,rtl.string,"GetExpression","SetExpression"),e.addProperty("Fields",0,rtl.string,"FFields","FFields"),e.addProperty("CaseInsFields",2,rtl.string,"FCaseinsFields","SetCaseInsFields"),e.addProperty("DescFields",2,rtl.string,"FDescFields","SetDescFields"),e.addProperty("Options",0,t.$rtti.TIndexOptions,"FOptions","FOptions"),e.addProperty("Source",0,rtl.string,"FSource","FSource")})),rtl.createClass(this,"TIndexDefs",this.TDefCollection,(function(){this.GetItem$1=function(e){return rtl.as(pas.Classes.TCollection.GetItem.call(this,e),t.TIndexDef)},this.Find$1=function(e){var i;return null===(i=rtl.as(t.TDefCollection.Find.call(this,e),t.TIndexDef))&&t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SIndexNotFound"),pas.System.VarRecs(18,e),this.FDataset),i}})),rtl.createClass(this,"TCheckConstraint",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FCustomConstraint="",this.FErrorMessage="",this.FFromDictionary=!1,this.FImportedConstraint=""},this.Assign=function(t){};var t=this.$rtti;t.addProperty("CustomConstraint",0,rtl.string,"FCustomConstraint","FCustomConstraint"),t.addProperty("ErrorMessage",0,rtl.string,"FErrorMessage","FErrorMessage"),t.addProperty("FromDictionary",0,rtl.boolean,"FFromDictionary","FFromDictionary"),t.addProperty("ImportedConstraint",0,rtl.string,"FImportedConstraint","FImportedConstraint")})),rtl.createClass(this,"TCheckConstraints",pas.Classes.TCollection,(function(){this.GetOwner=function(){return null,null},this.Create$2=function(e){return pas.Classes.TCollection.Create$1.call(this,t.TCheckConstraint),this}})),rtl.createClass(this,"TFields",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FDataset=null,this.FFieldList=null,this.FOnChange=null,this.FValidFieldKinds={}},this.$final=function(){this.FDataset=void 0,this.FFieldList=void 0,this.FOnChange=void 0,this.FValidFieldKinds=void 0,pas.System.TObject.$final.call(this)},this.ClearFieldDefs=function(){for(var t=0,e=0,i=this.GetCount()-1;e<=i;e++)t=e,this.GetField(t).FFieldDef=null},this.Changed=function(){null===this.FDataset||3 in this.FDataset.FComponentState||this.FDataset.DataEvent(9,0),null!=this.FOnChange&&this.FOnChange(this)},this.GetCount=function(){return this.FFieldList.FCount},this.GetField=function(t){return rtl.getObject(this.FFieldList.Get(t))},this.SetFieldIndex=function(t,e){var i;-1!==(i=this.FFieldList.IndexOf(t))&&(e<0&&(e=0),e>=this.GetCount()&&(e=this.GetCount()-1),e!==i&&(this.FFieldList.Delete(i),this.FFieldList.Insert(e,t),t.PropertyChanged(!0),this.Changed()))},this.Create$1=function(t){return this.FDataset=t,this.FFieldList=pas.Classes.TFPList.$create("Create"),this.FValidFieldKinds=rtl.createSet(null,0,3),this},this.Destroy=function(){null!=this.FFieldList&&this.Clear(),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FFieldList},set:function(t){this.p.FFieldList=t}}),pas.System.TObject.Destroy.call(this)},this.Add=function(t){this.CheckFieldName(t.FFieldName),this.FFieldList.Add(t),t.FFields=this,this.Changed()},this.CheckFieldName=function(e){null!==this.FindField(e)&&t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SDuplicateFieldName"),pas.System.VarRecs(18,e),this.FDataset)},this.CheckFieldNames=function(e){var i="",s=0;if(""!==e){s=1;do{i=t.ExtractFieldName(e,{get:function(){return s},set:function(t){s=t}}),this.FieldByName(i)}while(!(s>e.length))}},this.Clear=function(){for(var t=null;this.FFieldList.FCount>0;)(t=rtl.getObject(this.FFieldList.Last())).FDataSet=null,t=rtl.freeLoc(t),this.FFieldList.Delete(this.FFieldList.FCount-1);this.Changed()},this.FindField=function(t){var e,i=null,s=0;e=pas.SysUtils.UpperCase(t);for(var n=0,o=this.FFieldList.FCount-1;n<=o;n++)if(s=n,i=rtl.getObject(this.FFieldList.Get(s)),e===pas.SysUtils.UpperCase(i.FFieldName))return i;return i=null},this.FieldByName=function(e){var i;return null===(i=this.FindField(e))&&t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SFieldNotFound"),pas.System.VarRecs(18,e),this.FDataset),i},this.IndexOf=function(t){return this.FFieldList.IndexOf(t)},this.Remove=function(t){this.FFieldList.Remove(t),t.FFields=null,this.Changed()}})),this.TParamType={0:"ptUnknown",ptUnknown:0,1:"ptInput",ptInput:1,2:"ptOutput",ptOutput:2,3:"ptInputOutput",ptInputOutput:3,4:"ptResult",ptResult:4},this.$rtti.$Enum("TParamType",{minvalue:0,maxvalue:4,ordtype:1,enumtype:this.TParamType}),rtl.createClass(this,"TParam",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FValue=void 0,this.FPrecision=0,this.FNumericScale=0,this.FName="",this.FDataType=0,this.FBound=!1,this.FParamType=0,this.FSize=0},this.GetDataSet=function(){return null!=this.FCollection&&t.TParams.isPrototypeOf(this.FCollection)?this.FCollection.GetDataSet():null},this.IsParamStored=function(){return this.FBound},this.AssignParam=function(t){null==t?(this.Clear(),this.FDataType=0,this.FParamType=0,this.FName="",this.FSize=0,this.FPrecision=0,this.FNumericScale=0):(this.FDataType=t.FDataType,t.GetIsNull()?this.Clear():this.FValue=t.FValue,this.FBound=t.FBound,this.FName=t.FName,0===this.FParamType&&(this.FParamType=t.FParamType),this.FSize=t.FSize,this.FPrecision=t.FPrecision,this.FNumericScale=t.FNumericScale)},this.AssignTo=function(e){t.TField.isPrototypeOf(e)?this.AssignToField(e):pas.Classes.TPersistent.AssignTo.call(this,e)},this.GetAsBoolean=function(){return!this.GetIsNull()&&1==this.FValue},this.GetAsDateTime=function(){return this.GetIsNull()?0:rtl.getNumber(this.FValue)},this.GetAsFloat=function(){return this.GetIsNull()?0:rtl.getNumber(this.FValue)},this.GetAsInteger=function(){return this.GetIsNull()||!pas.JS.isInteger(this.FValue)?0:rtl.trunc(this.FValue)},this.GetAsString=function(){return this.GetIsNull()||!rtl.isString(this.FValue)?"":""+this.FValue},this.GetAsJSValue=function(){return this.GetIsNull()?null:this.FValue},this.GetIsNull=function(){return pas.JS.isNull(this.FValue)},this.SetAsMemo=function(t){this.FDataType=11,this.SetAsJSValue(t)},this.SetAsJSValue=function(t){if(this.FValue=t,this.FBound=!pas.JS.isNull(t),this.FBound){var e=pas.JS.GetValueType(t);1===e?this.FDataType=4:2===e?this.FDataType=2:3===e?this.FDataType=5:5!==e&&6!==e||(this.FDataType=10)}},this.SetDataType=function(t){this.FDataType=t},this.Create$1=function(t){return pas.Classes.TCollectionItem.Create$1.call(this,t),this.FParamType=0,this.SetDataType(0),this.FValue=null,this},this.Assign=function(e){t.TParam.isPrototypeOf(e)?this.AssignParam(e):t.TField.isPrototypeOf(e)?this.AssignField(e):pas.Classes.TStrings.isPrototypeOf(e)?this.SetAsMemo(e.GetTextStr()):pas.Classes.TPersistent.Assign.call(this,e)},this.AssignField=function(t){null!=t?(this.AssignFieldValue(t,t.GetAsJSValue()),this.FName=t.FFieldName):(this.Clear(),this.FName="")},this.AssignToField=function(e){if(null!=e){var i=this.FDataType;0===i?t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SUnknownParamFieldType"),pas.System.VarRecs(18,this.FName),this.GetDataSet()):2===i||9===i?e.SetAsInteger(this.GetAsInteger()):5===i?e.SetAsFloat(this.GetAsFloat()):4===i?e.SetAsBoolean(this.GetAsBoolean()):10===i||1===i||15===i||11===i||12===i?e.SetAsString(this.GetAsString()):7!==i&&6!==i&&8!==i||e.SetAsDateTime(this.GetAsDateTime())}},this.AssignFieldValue=function(t,e){null!=t&&(1===t.FDataType&&t.FFixedChar?this.FDataType=12:11===t.FDataType&&t.FSize>255?this.FDataType=1:this.FDataType=t.FDataType,pas.JS.isNull(e)?this.Clear():this.SetAsJSValue(e),this.FSize=t.GetDataSize(),this.FBound=!0)},this.Clear=function(){this.FValue=null};var e=this.$rtti;e.addProperty("DataType",2,t.$rtti.TFieldType,"FDataType","SetDataType"),e.addProperty("Name",0,rtl.string,"FName","FName"),e.addProperty("NumericScale",0,rtl.longint,"FNumericScale","FNumericScale",{Default:0}),e.addProperty("ParamType",0,t.$rtti.TParamType,"FParamType","FParamType"),e.addProperty("Precision",0,rtl.longint,"FPrecision","FPrecision",{Default:0}),e.addProperty("Size",0,rtl.longint,"FSize","FSize",{Default:0}),e.addProperty("Value",15,rtl.jsvalue,"GetAsJSValue","SetAsJSValue",{stored:"IsParamStored"})})),rtl.createClass(this,"TParams",pas.Classes.TCollection,(function(){this.$init=function(){pas.Classes.TCollection.$init.call(this),this.FOwner=null},this.$final=function(){this.FOwner=void 0,pas.Classes.TCollection.$final.call(this)},this.AssignTo=function(e){t.TParams.isPrototypeOf(e)?e.Assign(this):pas.Classes.TPersistent.AssignTo.call(this,e)},this.GetDataSet=function(){return t.TDataSet.isPrototypeOf(this.FOwner)?this.FOwner:null},this.GetOwner=function(){return this.FOwner}})),this.TBookmarkFlag={0:"bfCurrent",bfCurrent:0,1:"bfBOF",bfBOF:1,2:"bfEOF",bfEOF:2,3:"bfInserted",bfInserted:3},rtl.recNewT(this,"TBookmark",(function(){this.Data=void 0,this.$eq=function(t){return this.Data===t.Data},this.$assign=function(t){return this.Data=t.Data,this}})),this.TGetMode={0:"gmCurrent",gmCurrent:0,1:"gmNext",gmNext:1,2:"gmPrior",gmPrior:2},this.TGetResult={0:"grOK",grOK:0,1:"grBOF",grBOF:1,2:"grEOF",grEOF:2,3:"grError",grError:3},this.TResyncMode$a={0:"rmExact",rmExact:0,1:"rmCenter",rmCenter:1},this.TDataAction={0:"daFail",daFail:0,1:"daAbort",daAbort:1,2:"daRetry",daRetry:2},this.$rtti.$Enum("TDataAction",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TDataAction}),this.TLocateOption={0:"loCaseInsensitive",loCaseInsensitive:0,1:"loPartialKey",loPartialKey:1,2:"loFromCurrent",loFromCurrent:2},this.$rtti.$MethodVar("TDataSetNotifyEvent",{procsig:rtl.newTIProcSig([["DataSet",this.$rtti.TDataSet]]),methodkind:0}),this.$rtti.$MethodVar("TDataSetErrorEvent",{procsig:rtl.newTIProcSig([["DataSet",this.$rtti.TDataSet],["E",this.$rtti.EDatabaseError],["DataAction",this.$rtti.TDataAction,1]]),methodkind:0}),this.TLoadOption={0:"loNoOpen",loNoOpen:0,1:"loNoEvents",loNoEvents:1,2:"loAtEOF",loAtEOF:2,3:"loCancelPending",loCancelPending:3},this.$rtti.$MethodVar("TFilterRecordEvent",{procsig:rtl.newTIProcSig([["DataSet",this.$rtti.TDataSet],["Accept",rtl.boolean,1]]),methodkind:0}),this.TRecordState={0:"rsNew",rsNew:0,1:"rsClean",rsClean:1,2:"rsUpdate",rsUpdate:2,3:"rsDelete",rsDelete:3},rtl.recNewT(this,"TDataRecord",(function(){this.data=void 0,this.state=0,this.bookmark=void 0,this.bookmarkFlag=0,this.$eq=function(t){return this.data===t.data&&this.state===t.state&&this.bookmark===t.bookmark&&this.bookmarkFlag===t.bookmarkFlag},this.$assign=function(t){return this.data=t.data,this.state=t.state,this.bookmark=t.bookmark,this.bookmarkFlag=t.bookmarkFlag,this}})),rtl.createClass(this,"TDataSet",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FAfterLoad=null,this.FBeforeLoad=null,this.FBlockReadSize=0,this.FCalcBuffer=t.TDataRecord.$new(),this.FCalcFieldsCount=0,this.FOnLoadFail=null,this.FOpenAfterRead=!1,this.FActiveRecord=0,this.FAfterCancel=null,this.FAfterClose=null,this.FAfterDelete=null,this.FAfterEdit=null,this.FAfterInsert=null,this.FAfterOpen=null,this.FAfterPost=null,this.FAfterScroll=null,this.FAutoCalcFields=!1,this.FBOF=!1,this.FBeforeCancel=null,this.FBeforeClose=null,this.FBeforeDelete=null,this.FBeforeEdit=null,this.FBeforeInsert=null,this.FBeforeOpen=null,this.FBeforePost=null,this.FBeforeScroll=null,this.FBlobFieldCount=0,this.FBuffers=[],this.FBufferCount=0,this.FConstraints=null,this.FDisableControlsCount=0,this.FDisableControlsState=0,this.FCurrentRecord=0,this.FDataSources=null,this.FDefaultFields=!1,this.FEOF=!1,this.FEnableControlsEvent=0,this.FFieldList=null,this.FFieldDefs=null,this.FFilterText="",this.FFiltered=!1,this.FInternalCalcFields=!1,this.FModified=!1,this.FOnCalcFields=null,this.FOnDeleteError=null,this.FOnEditError=null,this.FOnFilterRecord=null,this.FOnNewRecord=null,this.FOnPostError=null,this.FRecordCount=0,this.FIsUniDirectional=!1,this.FState=0,this.FInternalOpenComplete=!1,this.FDataProxy=null,this.FDataRequestID=0,this.FChangeList=null,this.FLoadCount=0,this.FMinLoadID=0,this.FDataSetField=null,this.FNestedDataSets=null,this.FNestedDataSetClass=null},this.$final=function(){this.FAfterLoad=void 0,this.FBeforeLoad=void 0,this.FCalcBuffer=void 0,this.FOnLoadFail=void 0,this.FAfterCancel=void 0,this.FAfterClose=void 0,this.FAfterDelete=void 0,this.FAfterEdit=void 0,this.FAfterInsert=void 0,this.FAfterOpen=void 0,this.FAfterPost=void 0,this.FAfterScroll=void 0,this.FBeforeCancel=void 0,this.FBeforeClose=void 0,this.FBeforeDelete=void 0,this.FBeforeEdit=void 0,this.FBeforeInsert=void 0,this.FBeforeOpen=void 0,this.FBeforePost=void 0,this.FBeforeScroll=void 0,this.FBuffers=void 0,this.FConstraints=void 0,this.FDataSources=void 0,this.FFieldList=void 0,this.FFieldDefs=void 0,this.FOnCalcFields=void 0,this.FOnDeleteError=void 0,this.FOnEditError=void 0,this.FOnFilterRecord=void 0,this.FOnNewRecord=void 0,this.FOnPostError=void 0,this.FDataProxy=void 0,this.FChangeList=void 0,this.FDataSetField=void 0,this.FNestedDataSets=void 0,this.FNestedDataSetClass=void 0,pas.Classes.TComponent.$final.call(this)},this.DoInsertAppend=function(e){var i=this;function s(e){var s=t.TBookmark.$new(),n=t.TDataRecord.$new(),o=0;if(i.FRecordCount>0&&s.$assign(i.GetBookmark()),e)i.FRecordCount===i.FBufferCount?i.ShiftBuffersBackward():i.FRecordCount>0&&(i.FActiveRecord+=1);else if(i.FRecordCount>0){n.$assign(i.FBuffers[i.FBufferCount]);for(var r=i.FBufferCount,a=i.FActiveRecord+1;r>=a;r--)o=r,i.FBuffers[o].$assign(i.FBuffers[o-1]);i.FBuffers[i.FActiveRecord].$assign(n)}i.InitRecord(i.FBuffers[i.FActiveRecord]),i.CursorPosChanged(),0===i.FRecordCount?i.SetBookmarkFlag(i.FBuffers[i.FActiveRecord],2):(i.FBOF=!1,i.FRecordCount>0&&(i.SetBookmarkData(i.FBuffers[i.FActiveRecord],t.TBookmark.$clone(s)),i.FreeBookmark(t.TBookmark.$clone(s)))),i.InternalInsert(),i.FRecordCount<i.FBufferCount&&(i.FRecordCount+=1)}this.CheckBrowseMode(),this.GetCanModify()||t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SDatasetReadOnly"),i),this.DoBeforeInsert(),this.DoBeforeScroll(),e?(this.ClearBuffers(),this.InternalLast(),this.GetPriorRecords(),this.FRecordCount>0&&(this.FActiveRecord=this.FRecordCount-1),s(!0),this.SetBookmarkFlag(this.FBuffers[this.FActiveRecord],2),this.FBOF=!1,this.FEOF=!0):s(!1),this.SetState(3);try{this.DoOnNewRecord()}catch(t){throw this.SetCurrentRecord(this.FActiveRecord),this.Resync({}),t}this.FModified=!1,this.DataEvent(2,0),this.DoAfterInsert(),this.DoAfterScroll()},this.DoInternalOpen=function(){this.InternalOpen(),this.FInternalOpenComplete=!0,this.FRecordCount=0,this.RecalcBufListSize(),this.FBOF=!0,this.FEOF=0===this.FRecordCount,null!=this.GetDataProxy()&&this.InitChangeList()},this.GetDataProxy=function(){return null===this.FDataProxy&&this.SetDataProxy(this.DoGetDataProxy()),this.FDataProxy},this.RegisterDataSource=function(t){this.FDataSources.Add(t),this.RecalcBufListSize()},this.SetDataProxy=function(t){t!==this.FDataProxy&&(null!=this.FDataProxy&&this.FDataProxy.RemoveFreeNotification(this),this.FDataProxy=t,null!=this.FDataProxy&&this.FDataProxy.FreeNotification(this))},this.ShiftBuffersForward=function(){var e=t.TDataRecord.$new(),i=0;e.$assign(this.FBuffers[this.FBufferCount]);for(var s=this.FBufferCount;s>=1;s--)i=s,this.FBuffers[i].$assign(this.FBuffers[i-1]);this.FBuffers[0].$assign(e)},this.ShiftBuffersBackward=function(){var e=t.TDataRecord.$new(),i=0;e.$assign(this.FBuffers[0]);for(var s=1,n=this.FBufferCount;s<=n;s++)i=s,this.FBuffers[i-1].$assign(this.FBuffers[i]);this.FBuffers[this.FBufferCount].$assign(e)},this.TryDoing=function(e,i){var s=0;for(!0,s=2;2===s;)try{return this.UpdateCursorPos(),e(),!0}catch(e){if(!t.EDatabaseError.isPrototypeOf(e))throw e;s=0,null!=i&&i(this,e,{get:function(){return s},set:function(t){s=t}});if(0===s)throw e;1===s&&pas.SysUtils.Abort()}return!0},this.GetActive=function(){return 0!==this.FState&&12!==this.FState},this.UnRegisterDataSource=function(t){this.FDataSources.Remove(t)},this.HandleRequestResponse=function(t){var e=!1;if(null!=t)if(t.FRequestID<=this.FMinLoadID)t.$destroy("Destroy");else{this.FLoadCount-=1;var i=t.FSuccess;0===i?null!=this.FOnLoadFail&&this.FOnLoadFail(this,t.FRequestID,t.FErrorMsg):1!==i&&2!==i||(e=!1,null!=t.FEvent&&t.FEvent(this,t.FData),1!==t.FSuccess&&(e=this.DataPacketReceived(t)),this.GetActive()||0 in t.FLoadOptions?(2 in t.FLoadOptions&&e&&(this.FEOF=!1),1 in t.FLoadOptions||this.DoAfterLoad()):(1 in t.FLoadOptions||this.DoAfterLoad(),this.Open())),t.$destroy("Destroy")}},this.GetNestedDataSets=function(){return null==this.FNestedDataSets&&(this.FNestedDataSets=pas.Classes.TFPList.$create("Create")),this.FNestedDataSets},this.DataPacketReceived=function(t){return!1,!1},this.DoLoad=function(t,e){var i,s=null;return 1 in t||this.DoBeforeLoad(),(i=null!==this.GetDataProxy())?((s=this.GetDataProxy().GetDataRequest(rtl.refSet(t),rtl.createCallback(this,"HandleRequestResponse"),e)).FDataset=this,this.GetActive()&&s.FBookmark.$assign(this.GetBookmark()),this.FDataRequestID+=1,s.FRequestID=this.FDataRequestID,this.GetDataProxy().DoGetData(s)?this.FLoadCount+=1:s=rtl.freeLoc(s),i):i},this.DoGetDataProxy=function(){return null,null},this.InitChangeList=function(){this.DoneChangeList(),this.FChangeList=pas.Classes.TFPList.$create("Create")},this.DoneChangeList=function(){this.ClearChangeList(),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FChangeList},set:function(t){this.p.FChangeList=t}})},this.ClearChangeList=function(){var t=0;if(null!=this.FChangeList)for(var e=0,i=this.FChangeList.FCount-1;e<=i;e++)t=e,rtl.getObject(this.FChangeList.Get(t)).$destroy("Destroy"),this.FChangeList.Put(t,null)},this.GetApplyUpdateData=function(t){return t.data},this.IndexInChangeList=function(e){var i=0;if(i=-1,null==this.FChangeList)return i;for(i=this.FChangeList.FCount-1;i>=0&&0!==this.CompareBookmarks(t.TBookmark.$clone(e),t.TBookmark.$clone(rtl.getObject(this.FChangeList.Get(i)).FBookmark));)i-=1;return i},this.AddToChangeList=function(e){var i,s=null,n=t.TBookmark.$new(),o=void 0;if(s=null,null==this.FChangeList)return s;if(n.$assign(this.GetBookmark()),-1===(i=this.IndexInChangeList(t.TBookmark.$clone(n))))o=this.GetApplyUpdateData(t.TDataRecord.$clone(this.ActiveBuffer())),s=null!=this.GetDataProxy()?this.GetDataProxy().GetUpdateDescriptor(this,t.TBookmark.$clone(n),o,e):t.TRecordUpdateDescriptor.$create("Create$1",[null,this,t.TBookmark.$clone(n),o,e]),this.FChangeList.Add(s);else{s=rtl.getObject(this.FChangeList.Get(i));var r=e;2===r?1===s.FStatus?this.FChangeList.Delete(i):s.FStatus=2:1===r?t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SErrInsertingSameRecordtwice"),this):0===r&&(s.FData=this.GetApplyUpdateData(t.TDataRecord.$clone(this.ActiveBuffer())))}return s},this.RecalcBufListSize=function(){var t=0,e=0,i=0,s=null;if(this.IsCursorOpen()){i=this.FIsUniDirectional?1:10;for(var n=0,o=this.FDataSources.FCount-1;n<=o;n++){t=n;for(var r=0,a=rtl.getObject(this.FDataSources.Get(t)).FDataLinks.GetCount()-1;r<=a;r++)e=r,i<(s=rtl.getObject(rtl.getObject(this.FDataSources.Get(t)).FDataLinks.Get(e))).GetBufferCount()&&(i=s.GetBufferCount())}this.FBufferCount!==i&&(this.SetBufListSize(i),this.GetNextRecords(),this.FRecordCount<this.FBufferCount&&!this.FIsUniDirectional&&(this.FActiveRecord=this.FActiveRecord+this.GetPriorRecords(),this.CursorPosChanged()))}},this.ActivateBuffers=function(){this.FBOF=!1,this.FEOF=!1,this.FActiveRecord=0},this.BindFields=function(e){var i=0,s=0,n=null,o=null;this.FCalcFieldsCount=0,this.FBlobFieldCount=0;for(var r=0,a=this.FFieldList.GetCount()-1;r<=a;r++)i=r,(o=this.FFieldList.GetField(i)).FFieldDef=null,e?o.FFieldKind in rtl.createSet(1,2)?(o.FFieldNo=-1,this.FCalcFieldsCount+=1):-1===(s=this.FFieldDefs.IndexOf(o.FFieldName))?t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SFieldNotFound"),pas.System.VarRecs(18,o.FFieldName),this):(n=this.FFieldDefs.GetItem$1(s),o.FFieldDef=n,o.FFieldNo=n.FFieldNo,n.FInternalCalcField&&(this.FInternalCalcFields=!0),o.$class.IsBlob()&&(o.FSize=n.FSize,this.FBlobFieldCount+=1)):o.FFieldNo=0,o.Bind(e)},this.BlockReadNext=function(){this.MoveBy(1)};var e=rtl.createSet(1,2,3);this.BookmarkAvailable=function(){return!this.IsEmpty()&&!this.FIsUniDirectional&&this.FState in e&&0===this.GetBookmarkFlag(t.TDataRecord.$clone(this.ActiveBuffer()))},this.CalculateFields=function(t){var e=0;if(this.FCalcBuffer.$assign(t),11!==this.FState&&(this.ClearCalcFields(this.FCalcBuffer),!this.FIsUniDirectional))for(var i=0,s=this.FFieldList.GetCount()-1;i<=s;i++)e=i,2===this.FFieldList.GetField(e).FFieldKind&&this.FFieldList.GetField(e).CalcLookupValue();this.DoOnCalcFields()},this.CheckActive=function(){this.GetActive()||t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SInactiveDataset"),this)},this.CheckInactive=function(){this.GetActive()&&t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SActiveDataset"),this)},this.CheckBiDirectional=function(){this.FIsUniDirectional&&t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SUniDirectional"),this)},this.Loaded=function(){pas.Classes.TComponent.Loaded.call(this);try{this.FOpenAfterRead&&this.SetActive(!0)}catch(e){if(!pas.SysUtils.Exception.isPrototypeOf(e))throw e;var t=e;4 in this.FComponentState&&this.InternalHandleException(t)}},this.ClearBuffers=function(){this.FRecordCount=0,this.FActiveRecord=0,this.FCurrentRecord=-1,this.FBOF=!0,this.FEOF=!0},this.ClearCalcFields=function(t){},this.CloseCursor=function(){this.ClearBuffers(),this.SetBufListSize(0),this.FFieldList.ClearFieldDefs(),this.InternalClose(),this.FInternalOpenComplete=!1},this.CreateFields=function(){for(var t=0,e=0,i=this.FFieldDefs.GetCount()-1;e<=i;e++){t=e;var s=this.FFieldDefs.GetItem$1(t);0!==s.FDataType&&s.CreateField(this)}},this.DataEvent=function(t,e){var i=this;var s,n=0,o=t;if(0===o?((s=rtl.getObject(e)).FFieldKind in rtl.createSet(0,3)&&i.SetModified(!0),4!==i.FState&&(0===s.FFieldKind&&(i.FInternalCalcFields?i.RefreshInternalCalcFields(i.FBuffers[i.FActiveRecord]):i.FAutoCalcFields&&0!==i.FCalcFieldsCount&&i.CalculateFields(i.FBuffers[i.FActiveRecord])),s.Change())):2===o||3===o?function(){var t=0,e=null;if(3!==i.FState&&i.UpdateCursorPos(),null!=i.FNestedDataSets)for(var s=0,n=i.GetNestedDataSets().FCount-1;s<=n;s++)t=s,(e=rtl.getObject(i.GetNestedDataSets().Get(t))).GetActive()&&e.DataEvent(11,0)}():4===o&&(this.FEnableControlsEvent=4),!this.ControlsDisabled()&&10!==this.FState)for(var r=0,a=this.FDataSources.FCount-1;r<=a;r++)n=r,rtl.getObject(this.FDataSources.Get(n)).ProcessEvent(t,e)},this.DestroyFields=function(){this.FFieldList.Clear()},this.DoAfterCancel=function(){null!=this.FAfterCancel&&this.FAfterCancel(this)},this.DoAfterClose=function(){null==this.FAfterClose||3 in this.FComponentState||this.FAfterClose(this)},this.DoAfterInsert=function(){null!=this.FAfterInsert&&this.FAfterInsert(this)},this.DoAfterOpen=function(){null!=this.FAfterOpen&&this.FAfterOpen(this)},this.DoAfterPost=function(){null!=this.FAfterPost&&this.FAfterPost(this)},this.DoAfterScroll=function(){null!=this.FAfterScroll&&this.FAfterScroll(this)},this.DoBeforeCancel=function(){null!=this.FBeforeCancel&&this.FBeforeCancel(this)},this.DoBeforeClose=function(){null==this.FBeforeClose||3 in this.FComponentState||this.FBeforeClose(this)},this.DoBeforeInsert=function(){null!=this.FBeforeInsert&&this.FBeforeInsert(this)},this.DoBeforeOpen=function(){null!=this.FBeforeOpen&&this.FBeforeOpen(this)},this.DoBeforePost=function(){null!=this.FBeforePost&&this.FBeforePost(this)},this.DoBeforeScroll=function(){null!=this.FBeforeScroll&&this.FBeforeScroll(this)},this.DoOnCalcFields=function(){null!=this.FOnCalcFields&&this.FOnCalcFields(this)},this.DoOnNewRecord=function(){null!=this.FOnNewRecord&&this.FOnNewRecord(this)},this.DoBeforeLoad=function(){null!=this.FBeforeLoad&&this.FBeforeLoad(this)},this.DoAfterLoad=function(){null!=this.FAfterLoad&&this.FAfterLoad(this)},this.GetCalcFields=function(t){var e=0;if(this.FCalcFieldsCount>0||this.FInternalCalcFields){e=this.FState,this.FState=5;try{this.CalculateFields(t)}finally{this.FState=e}}},this.GetCanModify=function(){return!this.FIsUniDirectional},this.GetFieldClass=function(e){return t.DefaultFieldClasses[e]},this.GetfieldCount=function(){return this.FFieldList.GetCount()},this.GetFieldValues=function(t){var e=void 0,i=0,s=null,n=[];s=pas.Classes.TList.$create("Create$1");try{if(this.GetFieldList(s,t),s.GetCount()>1){n=rtl.arraySetLength(n,void 0,s.GetCount());for(var o=0,r=s.GetCount()-1;o<=r;o++)n[i=o]=rtl.getObject(s.Get(i)).GetAsJSValue();e=n}else e=this.FieldByName(t).GetAsJSValue()}finally{s=rtl.freeLoc(s)}return e},this.GetNextRecords=function(){var t=0;for(t=0;this.FRecordCount<this.FBufferCount&&this.GetNextRecord();)t+=1;return t},this.GetNextRecord=function(){var e,i=t.TDataRecord.$new();return this.FRecordCount>0&&this.SetCurrentRecord(this.FRecordCount-1),(e=0===this.GetRecord(this.FBuffers[this.FBufferCount],1,!0))?(0===this.FRecordCount&&this.ActivateBuffers(),this.FRecordCount===this.FBufferCount?this.ShiftBuffersBackward():(this.FRecordCount+=1,this.FCurrentRecord=this.FRecordCount-1,i.$assign(this.FBuffers[this.FCurrentRecord]),this.FBuffers[this.FCurrentRecord].$assign(this.FBuffers[this.FBufferCount]),this.FBuffers[this.FBufferCount].$assign(i))):this.CursorPosChanged(),e},this.GetPriorRecords=function(){var t=0;for(t=0;this.FRecordCount<this.FBufferCount&&this.GetPriorRecord();)t+=1;return t},this.GetPriorRecord=function(){var t;return this.CheckBiDirectional(),this.FRecordCount>0&&this.SetCurrentRecord(0),(t=0===this.GetRecord(this.FBuffers[this.FBufferCount],2,!0))?(0===this.FRecordCount&&this.ActivateBuffers(),this.ShiftBuffersForward(),this.FRecordCount<this.FBufferCount&&(this.FRecordCount+=1)):this.CursorPosChanged(),t},this.InitRecord=function(t){this.InternalInitRecord(t),this.ClearCalcFields(t)},this.InternalCancel=function(){},this.InternalInsert=function(){},this.OpenCursor=function(t){t?this.InternalInitFieldDefs():12!==this.FState&&this.DoInternalOpen()},this.OpenCursorcomplete=function(){try{12===this.FState&&this.DoInternalOpen()}finally{this.FInternalOpenComplete?(this.SetState(1),this.DoAfterOpen(),this.IsEmpty()||this.DoAfterScroll()):(this.SetState(0),this.CloseCursor())}},this.RefreshInternalCalcFields=function(t){},this.RestoreState=function(t){this.FState=t,this.FDisableControlsCount-=1},this.SetActive=function(t){if(t&&0===this.FState){if(0 in this.FComponentState)return void(this.FOpenAfterRead=!0);this.DoBeforeOpen(),this.FEnableControlsEvent=4,this.FInternalCalcFields=!1;try{this.FDefaultFields=0===this.GetfieldCount(),this.OpenCursor(!1)}finally{12!==this.FState&&this.OpenCursorcomplete()}this.FModified=!1}else t||0===this.FState||(this.DoBeforeClose(),this.SetState(0),this.FDataRequestID=0,this.DoneChangeList(),this.CloseCursor(),this.DoAfterClose(),this.FModified=!1)},this.SetBufListSize=function(e){var i=0;if(e<0&&(e=0),e!==this.FBufferCount){if(e>this.FBufferCount){this.FBuffers=rtl.arraySetLength(this.FBuffers,t.TDataRecord,e+1);for(var s=this.FBufferCount,n=e;s<=n;s++)i=s,this.FBuffers[i].$assign(this.AllocRecordBuffer())}else if(e<this.FBufferCount&&e>=0&&this.FActiveRecord>e-1){for(var o=0,r=this.FActiveRecord-e;o<=r;o++)i=o,this.ShiftBuffersBackward();this.FActiveRecord=e-1}this.FBuffers=rtl.arraySetLength(this.FBuffers,t.TDataRecord,e+1),this.FBufferCount=e,this.FRecordCount>this.FBufferCount&&(this.FRecordCount=this.FBufferCount)}},this.SetChildOrder=function(e,i){var s=null;s=rtl.as(e,t.TField),this.FFieldList.IndexOf(s)>=0&&s.SetIndex(i)},this.SetCurrentRecord=function(e){if(this.FCurrentRecord!==e){if(!this.FIsUniDirectional){var i=this.GetBookmarkFlag(t.TDataRecord.$clone(this.FBuffers[e]));0===i?this.InternalSetToRecord(t.TDataRecord.$clone(this.FBuffers[e])):1===i?this.InternalFirst():2===i&&this.InternalLast()}this.FCurrentRecord=e}},this.SetModified=function(t){this.FModified=t},this.SetName=function(t){var e=this;function i(t){var i="",s=0,n=0;for(i=t,s=0,n=0;s<e.FFieldList.GetCount();)i===e.FFieldList.GetField(s).FFieldName?(n+=1,i=t+pas.SysUtils.IntToStr(n)):s+=1;return i}var s,n=0,o="";if(e.FName!==t&&(s=e.FName,pas.Classes.TComponent.SetName.call(this,t),4 in this.FComponentState))for(var r=0,a=this.FFieldList.GetCount()-1;r<=a;r++)n=r,o=s+this.FFieldList.GetField(n).FFieldName,pas.System.Copy(this.FFieldList.GetField(n).FName,1,o.length)===o&&this.FFieldList.GetField(n).SetName(i(t+this.FFieldList.GetField(n).FFieldName))},this.SetOnFilterRecord=function(t){this.CheckBiDirectional(),this.FOnFilterRecord=t},this.SetState=function(t){t!==this.FState&&(this.FState=t,1===t&&(this.FModified=!1),this.DataEvent(6,0))},this.SetTempState=function(t){var e;return e=this.FState,this.FState=t,this.FDisableControlsCount+=1,e},this.AllocRecordBuffer=function(){var e=t.TDataRecord.$new();return e.data=null,e.state=0,e},this.FreeRecordBuffer=function(t){},this.GetBookmarkData=function(t,e){},this.GetBookmarkFlag=function(t){return 0,0},this.GetDataSource=function(){return null,null},this.InternalFirst=function(){},this.InternalHandleException=function(t){pas.SysUtils.ShowException(t,null)},this.InternalInitRecord=function(t){},this.InternalLast=function(){},this.InternalPost=function(){var e=this;!function(){for(var i=0,s=0,n=e.FFieldList.GetCount()-1;s<=n;s++){i=s;var o=e.FFieldList.GetField(i);o.FRequired&&!o.FReadOnly&&0===o.FFieldKind&&9!==o.FDataType&&o.GetIsNull()&&t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SNeedField"),pas.System.VarRecs(18,o.GetDisplayName()),e)}}()},this.InternalSetToRecord=function(t){},this.SetBookmarkFlag=function(t,e){},this.SetBookmarkData=function(t,e){},this.Notification=function(t,e){pas.Classes.TComponent.Notification.call(this,t,e),1===e&&t===this.FDataProxy&&(this.FDataProxy=null)},this.SetDataSetField=function(e){e!==this.FDataSetField&&(null!==e&&(e.FDataSet===this||null!==e.FDataSet.GetDataSource()&&e.FDataSet.GetDataSource().FDataSet===this)&&t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SCircularDataLink"),this),null==e||this.$class.InheritsFrom(e.FDataSet.FNestedDataSetClass)||t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SNestedDataSetClass"),pas.System.VarRecs(18,e.FDataSet.FNestedDataSetClass.$classname),this),this.GetActive()&&this.Close(),null!=this.FDataSetField&&this.FDataSetField.AssignNestedDataSet(null),this.FDataSetField=e,null!=e&&(e.AssignNestedDataSet(this),e.FDataSet.GetActive()&&this.Open()))},this.GetFieldData=function(e){return this.GetFieldData$1(e,t.TDataRecord.$clone(this.ActiveBuffer()))},this.SetFieldData=function(t,e){this.SetFieldData$1(t,this.FBuffers[this.FActiveRecord],e)},this.GetFieldData$1=function(t,e){var i=void 0;return i=e.data[t.FFieldName],pas.JS.isUndefined(i)&&(i=null),i},this.SetFieldData$1=function(t,e,i){e.data[t.FFieldName]=i},this.FieldDefsClass=function(){return t.TFieldDefs},this.FieldsClass=function(){return t.TFields},this.Create$1=function(e){return pas.Classes.TComponent.Create$1.call(this,e),this.FFieldDefs=this.$class.FieldDefsClass().$create("Create$4",[this]),this.FFieldList=this.$class.FieldsClass().$create("Create$1",[this]),this.FDataSources=pas.Classes.TFPList.$create("Create"),this.FConstraints=t.TCheckConstraints.$create("Create$2",[this]),this.FBuffers=rtl.arraySetLength(this.FBuffers,t.TDataRecord,1),this.FActiveRecord=0,this.FEOF=!0,this.FBOF=!0,this.FIsUniDirectional=!1,this.FAutoCalcFields=!0,this.FDataRequestID=0,this.FNestedDataSetClass=this.$class.ClassType(),this},this.Destroy=function(){var e=0;this.SetActive(!1),this.SetDataSetField(null),rtl.free(this,"FFieldDefs"),rtl.free(this,"FFieldList"),rtl.free(this,"FNestedDataSets");for(var i=this.FDataSources;i.FCount>0;)rtl.getObject(i.Get(i.FCount-1)).SetDataSet(null);i.$destroy("Destroy");for(var s=0,n=this.FBufferCount;s<=n;s++)e=s,this.FreeRecordBuffer(this.FBuffers[e]);rtl.free(this,"FConstraints"),this.FBuffers=rtl.arraySetLength(this.FBuffers,t.TDataRecord,1),pas.Classes.TComponent.Destroy.call(this)},this.ActiveBuffer=function(){var e=t.TDataRecord.$new();return-1!==this.FActiveRecord?e.$assign(this.FBuffers[this.FActiveRecord]):e.$assign(t.TDataRecord.$new()),e},this.ConvertToDateTime=function(t,e,i){return this.$class.DefaultConvertToDateTime(t,e,i)},this.ConvertDateTimeToNative=function(t,e){return this.$class.DefaultConvertDateTimeToNative(t,e)},this.DefaultConvertToDateTime=function(t,e,i){var s=0;if(s=0,rtl.isString(e)){if(!pas.DateUtils.TryRFC3339ToDateTime(""+e,{get:function(){return s},set:function(t){s=t}}))throw pas.SysUtils.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.DBConst,"SErrInvalidDateTime"),pas.System.VarRecs(18,""+e)])}else rtl.isNumber(e)?s=rtl.getNumber(e):pas.JS.isDate(e)&&(s=pas.SysUtils.JSDateToDateTime(e));return s},this.DefaultConvertDateTimeToNative=function(t,e){return pas.DateUtils.DateTimeToRFC3339(e)},this.BlobDataToBytes=function(t){return this.$class.DefaultBlobDataToBytes(t)},this.DefaultBlobDataToBytes=function(t){var e=[],i="",s=0,n=0,o=0;if(e=rtl.arraySetLength(e,0,0),rtl.isString(t))for(o=(i=""+t).length,e=rtl.arraySetLength(e,0,rtl.trunc((o+1)/2)),s=1,n=0;s<o;)try{e[n]=pas.SysUtils.StrToInt("$"+pas.System.Copy(i,s,2)),s+=2,n+=1}catch(t){e[n]=i.charCodeAt(s-1),s+=1,n+=1}return e},this.BytesToBlobData=function(t){return this.$class.DefaultBytesToBlobData(rtl.arrayRef(t))},this.DefaultBytesToBlobData=function(t){var e=void 0,i="",s=0;if(0===rtl.length(t))e=null;else{i="";for(var n=0,o=rtl.length(t)-1;n<=o;n++)s=n,i=i.concat(pas.SysUtils.IntToHex(t[s],2));e=i}return e},this.Cancel=function(){this.FState in rtl.createSet(2,3)&&(this.DataEvent(7,0),this.DoBeforeCancel(),this.UpdateCursorPos(),this.InternalCancel(),3===this.FState&&1===this.FRecordCount?(this.FEOF=!0,this.FBOF=!0,this.FRecordCount=0,this.InitRecord(this.FBuffers[this.FActiveRecord]),this.SetState(1),this.DataEvent(2,0)):(this.SetState(1),this.SetCurrentRecord(this.FActiveRecord),this.Resync({})),this.DoAfterCancel())},this.CheckBrowseMode=function(){this.CheckActive(),this.DataEvent(7,0);var t=this.FState;2===t||3===t?(this.UpdateRecord(),this.FModified?this.Post():this.Cancel()):4===t&&this.Post()},this.Close=function(){this.SetActive(!1)},this.ControlsDisabled=function(){return this.FDisableControlsCount>0},this.CompareBookmarks=function(t,e){return 0,0},this.CursorPosChanged=function(){this.FCurrentRecord=-1},this.DisableControls=function(){0===this.FDisableControlsCount&&(this.FDisableControlsState=this.FState,this.FEnableControlsEvent=2),this.FDisableControlsCount+=1},this.EnableControls=function(){this.FDisableControlsCount>0&&(this.FDisableControlsCount-=1),0===this.FDisableControlsCount&&(this.FState!==this.FDisableControlsState&&this.DataEvent(6,0),0!==this.FState&&0!==this.FDisableControlsState&&this.DataEvent(this.FEnableControlsEvent,0))},this.FieldByName=function(e){var i;return null===(i=this.FindField(e))&&t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SFieldNotFound"),pas.System.VarRecs(18,e),this),i},this.FindField=function(t){return this.FFieldList.FindField(t)},this.First=function(){this.CheckBrowseMode(),this.DoBeforeScroll(),this.FIsUniDirectional?this.FBOF||(this.SetActive(!1),this.SetActive(!0)):this.ClearBuffers();try{this.InternalFirst(),this.FIsUniDirectional||this.GetNextRecords()}finally{this.FBOF=!0,this.DataEvent(2,0),this.DoAfterScroll()}},this.FreeBookmark=function(t){},this.GetBookmark=function(){var e=t.TBookmark.$new();return this.BookmarkAvailable()?this.GetBookmarkData(t.TDataRecord.$clone(this.ActiveBuffer()),e):e.Data=null,e},this.GetFieldList=function(e,i){var s=null,n="",o=0;if(""!==i&&null!==e){o=1;do{n=t.ExtractFieldName(i,{get:function(){return o},set:function(t){o=t}}),s=this.FieldByName(n),e.Add(s)}while(!(o>i.length))}},this.GetFieldList$1=function(e,i){var s=null,n="",o=0;if(""!==i&&null!==e){o=1;do{n=t.ExtractFieldName(i,{get:function(){return o},set:function(t){o=t}}),s=this.FieldByName(n),e.Add(s)}while(!(o>i.length))}},this.Insert$1=function(){this.DoInsertAppend(!1)},this.IsEmpty=function(){return this.FBOF&&this.FEOF&&!(3===this.FState)},this.Load=function(e,i){return 2 in e&&t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SatEOFInternalOnly"),this),3 in e&&this.CancelLoading(),this.DoLoad(rtl.refSet(e),i)},this.Lookup=function(t,e,i){return this.CheckBiDirectional(),null,null},this.MoveBy=function(t){var e=this,i=0,s=0;var n=0;if(this.CheckBrowseMode(),i=0,s=0,this.DoBeforeScroll(),0===t||t>0&&this.FEOF||t<0&&this.FBOF)return i;try{n=0,n=t>0?function(){var i=0;for(i=0,e.FBOF=!1;t>0&&!e.FEOF;)e.FActiveRecord<e.FRecordCount-1?(e.FActiveRecord+=1,t-=1,s+=1):e.GetNextRecord()?(t-=1,i-=1,s+=1):(e.FEOF=!0,e.DoLoad(rtl.createSet(0,2),null));return i}():function(){var i=0;for(e.CheckBiDirectional(),i=0,e.FEOF=!1;t<0&&!e.FBOF;)e.FActiveRecord>0?(e.FActiveRecord-=1,t+=1,s-=1):e.GetPriorRecord()?(t+=1,i+=1,s-=1):e.FBOF=!0;return i}()}finally{this.DataEvent(3,n),this.DoAfterScroll(),i=s}return i},this.Next=function(){this.FBlockReadSize>0?this.BlockReadNext():this.MoveBy(1)},this.Open=function(){this.SetActive(!0)};var i=[0,1];this.Post=function(){var e=null,s=!1;if(this.UpdateRecord(),this.FState in rtl.createSet(2,3)){if(this.DataEvent(7,0),this.DoBeforePost(),s=3===this.FState,!this.TryDoing(rtl.createCallback(this,"InternalPost"),this.FOnPostError))return;this.CursorPosChanged(),this.SetState(1),this.Resync({}),null!=(e=this.AddToChangeList(i[+s]))&&e.FBookmark.$assign(this.GetBookmark()),this.DoAfterPost()}else 4!==this.FState&&t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SNotEditing"),pas.System.VarRecs(18,this.FName),this)},this.Resync=function(e){var i=0,s=0;if(!this.FIsUniDirectional){if(0!==this.GetRecord(this.FBuffers[0],0,!1))if(0 in e)t.DatabaseError$1(rtl.getResStr(pas.DBConst,"SNoSuchRecord"),this);else if(0!==this.GetRecord(this.FBuffers[0],1,!0)&&0!==this.GetRecord(this.FBuffers[0],2,!0))return this.ClearBuffers(),this.InternalInitRecord(this.FBuffers[this.FActiveRecord]),void this.DataEvent(2,0);this.FCurrentRecord=0,this.FEOF=!1,this.FBOF=!1,s=1 in e?rtl.trunc(this.FRecordCount/2):this.FActiveRecord,i=0,this.FRecordCount=1,this.FActiveRecord=0;for(;i<s&&this.GetPriorRecord();)i+=1;this.FActiveRecord=i,this.GetNextRecords(),this.FRecordCount<this.FBufferCount&&(this.FActiveRecord=this.FActiveRecord+this.GetPriorRecords()),this.DataEvent(2,0)}},this.CancelLoading=function(){this.FMinLoadID=this.FDataRequestID,this.FLoadCount=0},this.UpdateCursorPos=function(){this.FRecordCount>0&&this.SetCurrentRecord(this.FActiveRecord)},this.UpdateRecord=function(){this.FState in t.dsEditModes||t.DatabaseErrorFmt$1(rtl.getResStr(pas.DBConst,"SNotEditing"),pas.System.VarRecs(18,this.FName),this),this.DataEvent(5,0)},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TDataLink",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FFirstRecord=0,this.FBufferCount=0,this.FActive=!1,this.FDataSourceFixed=!1,this.FEditing=!1,this.FReadOnly=!1,this.FUpdatingRecord=!1,this.FVisualControl=!1,this.FDataSource=null},this.$final=function(){this.FDataSource=void 0,pas.Classes.TPersistent.$final.call(this)},this.CalcFirstRecord=function(t){var e=0;return e=this.FDataSource.FDataSet.FActiveRecord>this.FFirstRecord+t+this.FBufferCount-1?this.FDataSource.FDataSet.FActiveRecord-(this.FFirstRecord+t+this.FBufferCount-1):this.FDataSource.FDataSet.FActiveRecord<this.FFirstRecord+t?this.FDataSource.FDataSet.FActiveRecord-(this.FFirstRecord+t):0,this.FFirstRecord+=t+e,e},this.CalcRange=function(){var t=0,e=0;(e=this.GetDataset().FActiveRecord-this.FBufferCount+1)<0&&(e=0),(t=this.GetDataset().FBufferCount-this.FBufferCount)<0&&(t=0),t>this.GetDataset().FActiveRecord&&(t=this.GetDataset().FActiveRecord),this.FFirstRecord<e&&(this.FFirstRecord=e),this.FFirstRecord>t&&(this.FFirstRecord=t),0!==this.FFirstRecord&&this.GetDataset().FActiveRecord-this.FFirstRecord<this.FBufferCount-1&&(this.FFirstRecord-=1)},this.CheckActiveAndEditing=function(){var e=!1;(e=null!=this.FDataSource&&!(this.FDataSource.FState in rtl.createSet(0,12)))!==this.FActive&&(this.FActive=e,this.ActiveChanged()),(e=null!=this.FDataSource&&this.FDataSource.FState in t.dsEditModes&&!this.FReadOnly)!==this.FEditing&&(this.FEditing=e,this.EditingChanged())},this.GetDataset=function(){return null!=this.FDataSource?this.FDataSource.FDataSet:null},this.SetActive=function(t){this.FActive!==t&&(this.FActive=t,this.ActiveChanged())},this.SetDataSource=function(t){this.FDataSource!==t&&(this.FDataSourceFixed||(null!=this.FDataSource&&(this.FDataSource.UnregisterDataLink(this),this.FDataSource=null,this.CheckActiveAndEditing()),this.FDataSource=t,null!=this.FDataSource&&(this.FDataSource.RegisterDataLink(this),this.CheckActiveAndEditing())))},this.ActiveChanged=function(){this.FFirstRecord=0},this.CheckBrowseMode=function(){},this.DataEvent=function(t,e){if(6===t)this.CheckActiveAndEditing();else if(this.FActive){var i=t;0===i||1===i?this.FUpdatingRecord||this.RecordChanged(rtl.getObject(e)):2===i?(this.SetActive(this.FDataSource.FDataSet.GetActive()),this.CalcRange(),this.CalcFirstRecord(rtl.trunc(e)),this.DataSetChanged()):3===i?this.DataSetScrolled(this.CalcFirstRecord(rtl.trunc(e))):4===i?(this.CalcFirstRecord(rtl.trunc(e)),this.LayoutChanged()):5===i?this.UpdateRecord():7===i?this.CheckBrowseMode():10===i&&this.FocusControl(e)}},this.DataSetChanged=function(){this.RecordChanged(null)},this.DataSetScrolled=function(t){this.DataSetChanged()},this.EditingChanged=function(){},this.FocusControl=function(t){},this.GetBufferCount=function(){return this.FBufferCount},this.LayoutChanged=function(){this.DataSetChanged()},this.RecordChanged=function(t){},this.UpdateData=function(){},this.Destroy=function(){this.FActive=!1,this.FEditing=!1,this.FDataSourceFixed=!1,this.SetDataSource(null),pas.System.TObject.Destroy.call(this)},this.UpdateRecord=function(){this.FUpdatingRecord=!0;try{this.UpdateData()}finally{this.FUpdatingRecord=!1}}})),this.$rtti.$MethodVar("TDataChangeEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Field",this.$rtti.TField]]),methodkind:0}),rtl.createClass(this,"TDataSource",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FDataSet=null,this.FDataLinks=null,this.FEnabled=!1,this.FAutoEdit=!1,this.FState=0,this.FOnStateChange=null,this.FOnDataChange=null,this.FOnUpdateData=null},this.$final=function(){this.FDataSet=void 0,this.FDataLinks=void 0,this.FOnStateChange=void 0,this.FOnDataChange=void 0,this.FOnUpdateData=void 0,pas.Classes.TComponent.$final.call(this)},this.DistributeEvent=function(t,e){for(var i=0,s=this.FDataLinks,n=0,o=s.GetCount()-1;n<=o;n++){i=n;var r=rtl.getObject(s.Get(i));r.FVisualControl||r.DataEvent(t,e)}for(var a=0,l=s.GetCount()-1;a<=l;a++){i=a;var h=rtl.getObject(s.Get(i));h.FVisualControl&&h.DataEvent(t,e)}},this.RegisterDataLink=function(t){this.FDataLinks.Add(t),null!=this.FDataSet&&this.FDataSet.RecalcBufListSize()};var e=rtl.createSet(1,2,3,4,6);this.ProcessEvent=function(t,i){var s=!1,n=0;if(6===t){if(s=0===this.FState,n=this.FState,null!=this.FDataSet&&this.FEnabled?this.FState=this.FDataSet.FState:this.FState=0,this.FState===n)return}else s=!0;this.DistributeEvent(t,i),3 in this.FComponentState||(6===t&&this.DoStateChange(),t in e&&s&&this.DoDataChange(null),0===t&&this.DoDataChange(i),5===t&&this.DoUpdateData())},this.SetDataSet=function(t){null!==this.FDataSet&&(this.FDataSet.UnRegisterDataSource(this),this.FDataSet=null,this.ProcessEvent(6,0)),null!==t&&(t.RegisterDataSource(this),this.FDataSet=t,this.ProcessEvent(6,0))},this.SetEnabled=function(t){this.FEnabled=t,this.ProcessEvent(6,0)},this.UnregisterDataLink=function(t){this.FDataLinks.Remove(t),null!==this.FDataSet&&this.FDataSet.RecalcBufListSize()},this.DoDataChange=function(t){null!=this.FOnDataChange&&(null!=t?this.FOnDataChange(this,t):this.FOnDataChange(this,null))},this.DoStateChange=function(){null!=this.FOnStateChange&&this.FOnStateChange(this)},this.DoUpdateData=function(){null!=this.FOnUpdateData&&this.FOnUpdateData(this)},this.Create$1=function(t){return pas.Classes.TComponent.Create$1.call(this,t),this.FDataLinks=pas.Classes.TList.$create("Create$1"),this.FEnabled=!0,this.FAutoEdit=!0,this},this.Destroy=function(){this.FOnStateChange=null,this.SetDataSet(null);for(var t=this.FDataLinks;t.GetCount()>0;)rtl.getObject(t.Get(t.GetCount()-1)).SetDataSource(null);rtl.free(this,"FDataLinks"),pas.Classes.TComponent.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("AutoEdit",0,rtl.boolean,"FAutoEdit","FAutoEdit",{Default:!0}),i.addProperty("DataSet",2,t.$rtti.TDataSet,"FDataSet","SetDataSet"),i.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default:!0}),i.addProperty("OnStateChange",0,pas.Classes.$rtti.TNotifyEvent,"FOnStateChange","FOnStateChange"),i.addProperty("OnDataChange",0,t.$rtti.TDataChangeEvent,"FOnDataChange","FOnDataChange"),i.addProperty("OnUpdateData",0,pas.Classes.$rtti.TNotifyEvent,"FOnUpdateData","FOnUpdateData")})),this.TDataRequestResult={0:"rrFail",rrFail:0,1:"rrEOF",rrEOF:1,2:"rrOK",rrOK:2},rtl.createClass(this,"TDataRequest",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FBookmark=t.TBookmark.$new(),this.FDataset=null,this.FErrorMsg="",this.FEvent=null,this.FLoadOptions={},this.FRequestID=0,this.FSuccess=0,this.FData=void 0,this.FAfterRequest=null,this.FDataProxy=null},this.$final=function(){this.FBookmark=void 0,this.FDataset=void 0,this.FEvent=void 0,this.FLoadOptions=void 0,this.FAfterRequest=void 0,this.FDataProxy=void 0,pas.System.TObject.$final.call(this)},this.DoAfterRequest=function(){null!=this.FAfterRequest&&this.FAfterRequest(this)},this.Create$1=function(t,e,i,s){return this.FDataProxy=t,this.FLoadOptions=rtl.refSet(e),this.FEvent=s,this.FAfterRequest=i,this}})),rtl.createClass(this,"TRecordUpdateDescriptor",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FBookmark=t.TBookmark.$new(),this.FData=void 0,this.FDataset=null,this.FProxy=null,this.FStatus=0},this.$final=function(){this.FBookmark=void 0,this.FDataset=void 0,this.FProxy=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t,e,i,s,n){return this.FDataset=e,this.FBookmark.$assign(i),this.FData=s,this.FStatus=n,this.FProxy=t,this}})),rtl.createClass(this,"TDataProxy",pas.Classes.TComponent,(function(){this.GetDataRequestClass=function(){return t.TDataRequest},this.GetUpdateDescriptorClass=function(){return t.TRecordUpdateDescriptor},this.GetDataRequest=function(t,e,i){return this.GetDataRequestClass().$create("Create$1",[this,rtl.refSet(t),e,i])},this.GetUpdateDescriptor=function(e,i,s,n){return this.GetUpdateDescriptorClass().$create("Create$1",[this,e,t.TBookmark.$clone(i),s,n])},rtl.addIntf(this,pas.System.IUnknown)})),this.Fieldtypenames=["Unknown","String","Integer","NativeInt","Boolean","Float","Date","Time","DateTime","AutoInc","Blob","Memo","FixedChar","Variant","Dataset","WideString"],this.DefaultFieldClasses=[this.TField,this.TStringField,this.TIntegerField,this.TLargeintField,this.TBooleanField,this.TFloatField,this.TDateField,this.TTimeField,this.TDateTimeField,this.TAutoIncField,this.TBlobField,this.TMemoField,this.TStringField,this.TVariantField,null,this.TStringField],this.dsEditModes=rtl.createSet(2,3,4),this.DatabaseError=function(e){throw t.EDatabaseError.$create("Create$1",[e])},this.DatabaseError$1=function(e,i){if(null!=i&&""!==i.FName)throw t.EDatabaseError.$create("CreateFmt",["%s : %s",pas.System.VarRecs(18,i.FName,18,e)]);t.DatabaseError(e)},this.DatabaseErrorFmt=function(e,i){throw t.EDatabaseError.$create("CreateFmt",[e,i])},this.DatabaseErrorFmt$1=function(e,i,s){if(null!=s)throw t.EDatabaseError.$create("CreateFmt",[pas.SysUtils.Format("%s : %s",pas.System.VarRecs(18,s.FName,18,e)),i]);t.DatabaseErrorFmt(e,i)},this.ExtractFieldName=function(t,e){var i,s,n=0;for(n=e.get(),s=t.length;n<=s&&";"!==t.charAt(n-1);)n+=1;return i=pas.SysUtils.Trim(pas.System.Copy(t,e.get(),n-e.get())),n<=s&&";"===t.charAt(n-1)&&(n+=1),e.set(n),i},t.$implcode=function(){e.DefaultBufferCount=10,e.SBoolean="Boolean",e.SDateTime="TDateTime",e.SFloat="Float",e.SInteger="Integer",e.SLargeInt="NativeInt",e.SJSValue="JSValue",e.SString="String"}}),["DBConst","TypInfo"]),rtl.module("fpexprpars",["System","Classes","SysUtils","contnrs"],(function(){"use strict";var t=this,e=t.$impl;this.TTokenType={0:"ttPlus",ttPlus:0,1:"ttMinus",ttMinus:1,2:"ttLessThan",ttLessThan:2,3:"ttLargerThan",ttLargerThan:3,4:"ttEqual",ttEqual:4,5:"ttDiv",ttDiv:5,6:"ttMod",ttMod:6,7:"ttMul",ttMul:7,8:"ttLeft",ttLeft:8,9:"ttRight",ttRight:9,10:"ttLessThanEqual",ttLessThanEqual:10,11:"ttLargerThanEqual",ttLargerThanEqual:11,12:"ttunequal",ttunequal:12,13:"ttNumber",ttNumber:13,14:"ttString",ttString:14,15:"ttIdentifier",ttIdentifier:15,16:"ttComma",ttComma:16,17:"ttAnd",ttAnd:17,18:"ttOr",ttOr:18,19:"ttXor",ttXor:19,20:"ttTrue",ttTrue:20,21:"ttFalse",ttFalse:21,22:"ttNot",ttNot:22,23:"ttif",ttif:23,24:"ttCase",ttCase:24,25:"ttPower",ttPower:25,26:"ttEOF",ttEOF:26},this.ttComparisons=rtl.createSet(3,2,11,10,4,12),this.$rtti.$Class("TFPExpressionParser"),this.$rtti.$ClassRef("TFPExprFunctionClass",{instancetype:this.$rtti.TFPExprFunction}),this.TNumberKind={0:"nkDecimal",nkDecimal:0,1:"nkHex",nkHex:1,2:"nkOctal",nkOctal:2,3:"nkBinary",nkBinary:3},rtl.createClass(this,"TFPExpressionScanner",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FSource="",this.LSource=0,this.FPos=0,this.FChar="",this.FToken="",this.FTokenType=0},this.GetCurrentChar=function(){return this.FChar},this.ScanError=function(e){throw t.EExprScanner.$create("Create$1",[e])},this.SetSource=function(t){this.FSource=t,this.LSource=this.FSource.length,this.FTokenType=26,0===this.LSource?(this.FPos=0,this.FChar=e.cNull):(this.FPos=1,this.FChar=this.FSource.charAt(0)),this.FToken=""},this.DoIdentifier=function(){var i,s="";for(s=this.GetCurrentChar();!this.IsWordDelim(s)&&s!==e.cNull;){if('"'!==s)this.FToken=this.FToken+s;else{for(s=this.NextPos();!(s.charCodeAt()in rtl.createSet(e.cNull.charCodeAt(),34));)this.FToken=this.FToken+s,s=this.NextPos();'"'!==s&&this.ScanError(pas.SysUtils.Format(rtl.getResStr(t,"SErrUnterminatedIdentifier"),pas.System.VarRecs(18,this.FToken)))}s=this.NextPos()}return"or"===(i=pas.SysUtils.LowerCase(this.FToken))?18:"xor"===i?19:"and"===i?17:"true"===i?20:"false"===i?21:"not"===i?22:"if"===i?23:"case"===i?24:"mod"===i?6:15},this.DoNumber=function(i){var s=this,n="",o=0,r=0,a="";function l(t,i){var n=!1;if(!(n=s.IsDigit(t,i))){var o=i;0===o?n=""!==s.FToken&&"E"===pas.System.upcase(t)||""!==s.FToken&&t.charCodeAt()in rtl.createSet(43,45)&&"E"===a:1===o?n=t===e.cHexIdentifier&&"\0"===a:2===o?n=t===e.cOctalIdentifier&&"\0"===a:3===o&&(n=t===e.cBinaryIdentifier&&"\0"===a)}return n}for(n=this.GetCurrentChar(),a="\0";n!==e.cNull;){if(this.IsWordDelim(n)){var h=i;if(0===h){if(!(a.charCodeAt()in rtl.createSet(69,45,43)))break}else{if(1===h||2===h)break;if(3===h&&"\0"!==a)break}}l(n,i)||this.ScanError(pas.SysUtils.Format(rtl.getResStr(t,"SErrInvalidNumberChar"),pas.System.VarRecs(9,n))),this.FToken=this.FToken+n,a=pas.System.upcase(n),n=this.NextPos()}return pas.System.val$8(this.FToken,{get:function(){return o},set:function(t){o=t}},{get:function(){return r},set:function(t){r=t}}),0!==r&&this.ScanError(pas.SysUtils.Format(rtl.getResStr(t,"SErrInvalidNumber"),pas.System.VarRecs(18,this.FToken))),13,13},this.DoDelimiter=function(){var e,i,s=0,n="";if(n=this.FChar,this.FToken=n,e=n.charCodeAt()in rtl.createSet(60,62),i=n,n=this.NextPos(),e&&n.charCodeAt()in rtl.createSet(61,62))this.FToken=this.FToken+n,this.NextPos(),s=">"===i?11:">"===n?12:10;else{"+"===i?s=0:"-"===i?s=1:"<"===i?s=2:">"===i?s=3:"="===i?s=4:"/"===i?s=5:"*"===i?s=7:"("===i?s=8:")"===i?s=9:","===i?s=16:"^"===i?s=25:this.ScanError(pas.SysUtils.Format(rtl.getResStr(t,"SUnknownDelimiter"),pas.System.VarRecs(9,i)))}return s},this.DoString=function(){var i=this;function s(t){return t===e.cNull||t===e.cSingleQuote&&!(i.FPos<i.LSource&&i.FSource.charAt(i.FPos+1-1)===e.cSingleQuote)}var n="";for(this.FToken="",n=this.NextPos();!s(n);)this.FToken=this.FToken+n,n===e.cSingleQuote&&this.NextPos(),n=this.NextPos();return n===e.cNull&&this.ScanError(rtl.getResStr(t,"SBadQuotes")),14,this.FTokenType=14,this.NextPos(),14},this.NextPos=function(){return this.FPos+=1,this.FPos>this.FSource.length?this.FChar=e.cNull:this.FChar=this.FSource.charAt(this.FPos-1),this.FChar},this.SkipWhiteSpace=function(){for(;this.FChar.charCodeAt()in e.WhiteSpace&&this.FPos<=this.LSource;)this.NextPos()},this.IsWordDelim=function(t){return t.charCodeAt()in e.WordDelimiters},this.IsDelim=function(t){return t.charCodeAt()in e.Delimiters},this.IsDigit=function(t,i){var s=!1,n=i;return 0===n?s=t.charCodeAt()in e.Digits:1===n?s=t.charCodeAt()in e.HexDigits:2===n?s=t.charCodeAt()in e.OctalDigits:3===n&&(s=t.charCodeAt()in e.BinaryDigits),s},this.IsAlpha=function(t){return t.charCodeAt()in rtl.createSet(null,65,90,null,97,122)},this.Create$1=function(){return this.SetSource(""),this},this.GetToken=function(){var i,s=0;return this.FToken="",this.SkipWhiteSpace(),(i=this.FChar)===e.cNull?s=26:this.IsDelim(i)?s=this.DoDelimiter():i===e.cSingleQuote?s=this.DoString():i===e.cHexIdentifier?s=this.DoNumber(1):i===e.cOctalIdentifier?s=this.DoNumber(2):i===e.cBinaryIdentifier?s=this.DoNumber(3):this.IsDigit(i,0)?s=this.DoNumber(0):this.IsAlpha(i)||'"'===i?s=this.DoIdentifier():this.ScanError(pas.SysUtils.Format(rtl.getResStr(t,"SErrUnknownCharacter"),pas.System.VarRecs(0,this.FPos,9,i))),this.FTokenType=s,s}})),rtl.createClass(this,"EExprScanner",pas.SysUtils.Exception,(function(){})),this.TResultType={0:"rtBoolean",rtBoolean:0,1:"rtInteger",rtInteger:1,2:"rtFloat",rtFloat:2,3:"rtDateTime",rtDateTime:3,4:"rtString",rtString:4,5:"rtCurrency",rtCurrency:5},this.$rtti.$Enum("TResultType",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.TResultType}),rtl.recNewT(this,"TFPExpressionResult",(function(){this.ResultType=0,this.resValue=void 0,this.$eq=function(t){return this.ResultType===t.ResultType&&this.resValue===t.resValue},this.$assign=function(t){return this.ResultType=t.ResultType,this.resValue=t.resValue,this};var e=t.$rtti.$Record("TFPExpressionResult",{});e.addField("ResultType",t.$rtti.TResultType),e.addField("resValue",rtl.jsvalue)})),this.$rtti.$DynArray("TExprParameterArray",{eltype:this.$rtti.TFPExpressionResult}),rtl.createClass(this,"TFPExprNode",pas.System.TObject,(function(){this.CheckNodeType=function(i,s){var n="",o=0;if(null===i&&e.RaiseParserError(rtl.getResStr(t,"SErrNoNodeToCheck")),!(i.NodeType()in s)){for(n="",o=0;o<=5;o++)o in s&&(""!==n&&(n+=","),n+=t.ResultTypeName(o));e.RaiseParserError$1(rtl.getResStr(t,"SInvalidNodeType"),pas.System.VarRecs(18,t.ResultTypeName(i.NodeType()),18,n,18,i.AsString()))}}})),rtl.createClass(this,"TFPBinaryOperation",this.TFPExprNode,(function(){this.$init=function(){t.TFPExprNode.$init.call(this),this.FLeft=null,this.FRight=null},this.$final=function(){this.FLeft=void 0,this.FRight=void 0,t.TFPExprNode.$final.call(this)},this.CheckSameNodeTypes=function(){var i,s;i=this.FLeft.NodeType(),(s=this.FRight.NodeType())!==i&&e.RaiseParserError$1(rtl.getResStr(t,"SErrTypesDoNotMatch"),pas.System.VarRecs(18,t.ResultTypeName(i),18,t.ResultTypeName(s),18,this.FLeft.AsString(),18,this.FRight.AsString()))},this.Create$1=function(t,e){return this.FLeft=t,this.FRight=e,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FLeft},set:function(t){this.p.FLeft=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FRight},set:function(t){this.p.FRight=t}}),pas.System.TObject.Destroy.call(this)},this.Check=function(){null==this.FLeft&&e.RaiseParserError$1(rtl.getResStr(t,"SErrNoleftOperand"),pas.System.VarRecs(18,this.$classname)),null==this.FRight&&e.RaiseParserError$1(rtl.getResStr(t,"SErrNoRightOperand"),pas.System.VarRecs(18,this.$classname))}})),rtl.createClass(this,"TFPBooleanOperation",this.TFPBinaryOperation,(function(){this.Check=function(){t.TFPBinaryOperation.Check.call(this),this.CheckNodeType(this.FLeft,rtl.createSet(1,0)),this.CheckNodeType(this.FRight,rtl.createSet(1,0)),this.CheckSameNodeTypes()},this.NodeType=function(){return this.FLeft.NodeType()}})),rtl.createClass(this,"TFPBinaryAndOperation",this.TFPBooleanOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 0===s?e.resValue=!(0==e.resValue||0==i.resValue):1===s&&(e.resValue=rtl.and(rtl.trunc(e.resValue),rtl.trunc(i.resValue))),e},this.AsString=function(){return this.FLeft.AsString()+" and "+this.FRight.AsString()}})),rtl.createClass(this,"TFPBinaryOrOperation",this.TFPBooleanOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 0===s?e.resValue=!(0==e.resValue&&0==i.resValue):1===s&&(e.resValue=rtl.or(rtl.trunc(e.resValue),rtl.trunc(i.resValue))),e},this.AsString=function(){return this.FLeft.AsString()+" or "+this.FRight.AsString()}})),rtl.createClass(this,"TFPBinaryXOrOperation",this.TFPBooleanOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 0===s?e.resValue=!(0==e.resValue)^!(0==i.resValue):1===s&&(e.resValue=rtl.xor(rtl.trunc(e.resValue),rtl.trunc(i.resValue))),e},this.AsString=function(){return this.FLeft.AsString()+" xor "+this.FRight.AsString()}})),rtl.createClass(this,"TFPBooleanResultOperation",this.TFPBinaryOperation,(function(){this.Check=function(){t.TFPBinaryOperation.Check.call(this),this.CheckSameNodeTypes()},this.NodeType=function(){return 0,0}})),rtl.createClass(this,"TFPEqualOperation",this.TFPBooleanResultOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();return e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue()),e.resValue=e.resValue==i.resValue,e.ResultType=0,e},this.AsString=function(){return this.FLeft.AsString()+" = "+this.FRight.AsString()}})),rtl.createClass(this,"TFPUnequalOperation",this.TFPEqualOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(t.TFPEqualOperation.GetNodeValue.call(this)),e.resValue=!e.resValue,e},this.AsString=function(){return this.FLeft.AsString()+" <> "+this.FRight.AsString()}})),rtl.createClass(this,"TFPOrderingOperation",this.TFPBooleanResultOperation,(function(){var e=rtl.createSet(1,2,5,3,4);this.Check=function(){this.CheckNodeType(this.FLeft,e),this.CheckNodeType(this.FRight,e),t.TFPBooleanResultOperation.Check.call(this)}})),rtl.createClass(this,"TFPLessThanOperation",this.TFPOrderingOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 1===s?e.resValue=rtl.trunc(e.resValue)<rtl.trunc(i.resValue):2===s?e.resValue=rtl.getNumber(e.resValue)<rtl.getNumber(i.resValue):5===s?e.resValue=rtl.trunc(1e4*e.resValue)<rtl.trunc(1e4*i.resValue):3===s?e.resValue=rtl.getNumber(e.resValue)<rtl.getNumber(i.resValue):4===s&&(e.resValue=""+e.resValue<""+i.resValue),e.ResultType=0,e},this.AsString=function(){return this.FLeft.AsString()+" < "+this.FRight.AsString()}})),rtl.createClass(this,"TFPGreaterThanOperation",this.TFPOrderingOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;if(1===s){var n=this.FRight.NodeType();1===n?e.resValue=rtl.trunc(e.resValue)>rtl.trunc(i.resValue):2===n?e.resValue=rtl.trunc(e.resValue)>rtl.getNumber(i.resValue):5===n&&(e.resValue=1e4*rtl.trunc(e.resValue)>rtl.trunc(1e4*i.resValue))}else if(2===s){var o=this.FRight.NodeType();1===o?e.resValue=rtl.getNumber(e.resValue)>rtl.trunc(i.resValue):2===o?e.resValue=rtl.getNumber(e.resValue)>rtl.getNumber(i.resValue):5===o&&(e.resValue=1e4*rtl.getNumber(e.resValue)>rtl.trunc(1e4*i.resValue))}else if(5===s){var r=this.FRight.NodeType();1===r?e.resValue=rtl.trunc(1e4*e.resValue)>1e4*rtl.trunc(i.resValue):2===r?e.resValue=rtl.trunc(1e4*e.resValue)>1e4*rtl.getNumber(i.resValue):5===r&&(e.resValue=rtl.trunc(1e4*e.resValue)>rtl.trunc(1e4*i.resValue))}else 3===s?e.resValue=rtl.getNumber(e.resValue)>rtl.getNumber(i.resValue):4===s&&(e.resValue=""+e.resValue>""+i.resValue);return e.ResultType=0,e},this.AsString=function(){return this.FLeft.AsString()+" > "+this.FRight.AsString()}})),rtl.createClass(this,"TFPLessThanEqualOperation",this.TFPGreaterThanOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(t.TFPGreaterThanOperation.GetNodeValue.call(this)),e.resValue=!e.resValue,e},this.AsString=function(){return this.FLeft.AsString()+" <= "+this.FRight.AsString()}})),rtl.createClass(this,"TFPGreaterThanEqualOperation",this.TFPLessThanOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(t.TFPLessThanOperation.GetNodeValue.call(this)),e.resValue=!e.resValue,e},this.AsString=function(){return this.FLeft.AsString()+" >= "+this.FRight.AsString()}})),rtl.createClass(this,"TIfOperation",this.TFPBinaryOperation,(function(){this.$init=function(){t.TFPBinaryOperation.$init.call(this),this.FCondition=null},this.$final=function(){this.FCondition=void 0,t.TFPBinaryOperation.$final.call(this)},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FCondition.GetNodeValue()),0!=e.resValue?e.$assign(this.FLeft.GetNodeValue()):e.$assign(this.FRight.GetNodeValue()),e},this.Check=function(){t.TFPBinaryOperation.Check.call(this),0!==this.FCondition.NodeType()&&e.RaiseParserError$1(rtl.getResStr(t,"SErrIFNeedsBoolean"),pas.System.VarRecs(18,this.FCondition.AsString())),this.CheckSameNodeTypes()},this.NodeType=function(){return this.FLeft.NodeType()},this.Create$2=function(e,i,s){return t.TFPBinaryOperation.Create$1.call(this,i,s),this.FCondition=e,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FCondition},set:function(t){this.p.FCondition=t}}),t.TFPBinaryOperation.Destroy.call(this)},this.AsString=function(){return pas.SysUtils.Format("if(%s , %s , %s)",pas.System.VarRecs(18,this.FCondition.AsString(),18,this.FLeft.AsString(),18,this.FRight.AsString()))}})),rtl.createClass(this,"TCaseOperation",this.TFPExprNode,(function(){this.$init=function(){t.TFPExprNode.$init.call(this),this.FArgs=[]},this.$final=function(){this.FArgs=void 0,t.TFPExprNode.$final.call(this)},this.GetNodeValue=function(){var e,i=t.TFPExpressionResult.$new(),s=0,n=!1,o=t.TFPExpressionResult.$new(),r=t.TFPExpressionResult.$new();for(o.$assign(this.FArgs[0].GetNodeValue()),e=rtl.length(this.FArgs),s=2,n=!1;!n&&s<e;){i.$assign(this.FArgs[s].GetNodeValue());var a=o.ResultType;(0===a||1===a||2===a||5===a||3===a||4===a)&&(n=o.resValue==r.resValue),n||(s+=2)}return i.ResultType=this.FArgs[1].NodeType(),n?i.$assign(this.FArgs[s+1].GetNodeValue()):e%2==0&&i.$assign(this.FArgs[1].GetNodeValue()),i},this.Check=function(){var i,s,n=0,o=null;rtl.length(this.FArgs)<3&&e.RaiseParserError(rtl.getResStr(t,"SErrCaseNeeds3")),rtl.length(this.FArgs)%2==1&&e.RaiseParserError(rtl.getResStr(t,"SErrCaseEvenCount")),i=this.FArgs[0].NodeType(),s=this.FArgs[1].NodeType();for(var r=2,a=rtl.length(this.FArgs)-1;r<=a;r++)n=r,o=this.FArgs[n],n%2==0?(t.TFPConstExpression.isPrototypeOf(o)||e.RaiseParserError$1(rtl.getResStr(t,"SErrCaseLabelNotAConst"),pas.System.VarRecs(0,rtl.trunc(n/2),18,o.AsString())),o.NodeType()!==i&&e.RaiseParserError$1(rtl.getResStr(t,"SErrCaseLabelType"),pas.System.VarRecs(0,rtl.trunc(n/2),18,o.AsString(),18,t.ResultTypeName(i),18,t.ResultTypeName(o.NodeType())))):o.NodeType()!==s&&e.RaiseParserError$1(rtl.getResStr(t,"SErrCaseValueType"),pas.System.VarRecs(0,rtl.trunc((n-1)/2),18,o.AsString(),18,t.ResultTypeName(s),18,t.ResultTypeName(o.NodeType())))},this.NodeType=function(){return this.FArgs[1].NodeType()},this.Create$1=function(t){return this.FArgs=rtl.arrayRef(t),this},this.Destroy=function(){for(var t=0,e=0,i=rtl.length(this.FArgs)-1;e<=i;e++)t=e,pas.SysUtils.FreeAndNil({a:t,p:this.FArgs,get:function(){return this.p[this.a]},set:function(t){this.p[this.a]=t}});pas.System.TObject.Destroy.call(this)},this.AsString=function(){var t="",e=0;t="";for(var i=0,s=rtl.length(this.FArgs)-1;i<=s;i++)e=i,""!==t&&(t+=", "),t+=this.FArgs[e].AsString();return t="Case("+t+")"}})),rtl.createClass(this,"TMathOperation",this.TFPBinaryOperation,(function(){var e=rtl.createSet(1,2,5,3,4);this.Check=function(){t.TFPBinaryOperation.Check.call(this),this.CheckNodeType(this.FLeft,e),this.CheckNodeType(this.FRight,e),this.CheckSameNodeTypes()},this.NodeType=function(){return this.FLeft.NodeType()}})),rtl.createClass(this,"TFPAddOperation",this.TMathOperation,(function(){this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 1===s?e.resValue=rtl.trunc(e.resValue)+rtl.trunc(i.resValue):4===s?e.resValue=e.resValue+""+i.resValue:3===s||2===s?e.resValue=rtl.getNumber(e.resValue)+rtl.getNumber(i.resValue):5===s&&(e.resValue=(rtl.trunc(1e4*e.resValue)+rtl.trunc(1e4*i.resValue))/1e4),e.ResultType=this.NodeType(),e},this.AsString=function(){return this.FLeft.AsString()+" + "+this.FRight.AsString()}})),rtl.createClass(this,"TFPSubtractOperation",this.TMathOperation,(function(){var e=rtl.createSet(1,2,5,3);this.Check=function(){this.CheckNodeType(this.FLeft,e),this.CheckNodeType(this.FRight,e),t.TMathOperation.Check.call(this)},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 1===s?e.resValue=rtl.trunc(e.resValue)-rtl.trunc(i.resValue):3===s||2===s?e.resValue=rtl.getNumber(e.resValue)-rtl.getNumber(i.resValue):5===s&&(e.resValue=(rtl.trunc(1e4*e.resValue)-rtl.trunc(1e4*i.resValue))/1e4),e},this.AsString=function(){return this.FLeft.AsString()+" - "+this.FRight.AsString()}})),rtl.createClass(this,"TFPMultiplyOperation",this.TMathOperation,(function(){var e=rtl.createSet(1,5,2);this.Check=function(){this.CheckNodeType(this.FLeft,e),this.CheckNodeType(this.FRight,e),t.TMathOperation.Check.call(this)},this.AsString=function(){return this.FLeft.AsString()+" * "+this.FRight.AsString()},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 1===s?e.resValue=rtl.trunc(e.resValue)*rtl.trunc(i.resValue):2===s?e.resValue=rtl.getNumber(e.resValue)*rtl.getNumber(i.resValue):5===s&&(e.resValue=rtl.trunc(1e4*e.resValue)*rtl.trunc(1e4*i.resValue)/1e4/1e4),e}})),rtl.createClass(this,"TFPDivideOperation",this.TMathOperation,(function(){var e=rtl.createSet(1,5,2);this.Check=function(){this.CheckNodeType(this.FLeft,e),this.CheckNodeType(this.FRight,e),t.TMathOperation.Check.call(this)},this.AsString=function(){return this.FLeft.AsString()+" / "+this.FRight.AsString()},this.NodeType=function(){return 5===this.FLeft.NodeType()&&5===this.FRight.NodeType()?5:2},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue());var s=e.ResultType;return 1===s?e.resValue=rtl.trunc(e.resValue)/rtl.trunc(i.resValue):2===s?e.resValue=rtl.getNumber(e.resValue)/rtl.getNumber(i.resValue):5===s&&(5===this.NodeType()?e.resValue=rtl.trunc(rtl.trunc(1e4*e.resValue)/rtl.trunc(1e4*i.resValue)*1e4)/1e4:e.resValue=rtl.getNumber(e.resValue)/rtl.getNumber(i.resValue)),e.ResultType=this.NodeType(),e}})),rtl.createClass(this,"TFPModuloOperation",this.TMathOperation,(function(){this.Check=function(){this.CheckNodeType(this.FLeft,rtl.createSet(1)),this.CheckNodeType(this.FRight,rtl.createSet(1)),t.TMathOperation.Check.call(this)},this.AsString=function(){return this.FLeft.AsString()+" mod "+this.FRight.AsString()},this.NodeType=function(){return 1,1},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();return e.$assign(this.FLeft.GetNodeValue()),i.$assign(this.FRight.GetNodeValue()),e.resValue=rtl.trunc(e.resValue)%rtl.trunc(i.resValue),e.ResultType=1,e}})),rtl.createClass(this,"TFPPowerOperation",this.TMathOperation,(function(){var i=rtl.createSet(1,5,2);this.Check=function(){this.CheckNodeType(this.FLeft,i),this.CheckNodeType(this.FRight,i)},this.AsString=function(){return this.FLeft.AsString()+"^"+this.FRight.AsString()},this.NodeType=function(){return 2,2},this.GetNodeValue=function(){var i=t.TFPExpressionResult.$new(),s=t.TFPExpressionResult.$new();return i.$assign(this.FLeft.GetNodeValue()),s.$assign(this.FRight.GetNodeValue()),i.resValue=e.power(t.ArgToFloat(t.TFPExpressionResult.$clone(i)),t.ArgToFloat(t.TFPExpressionResult.$clone(s))),i.ResultType=2,i}})),rtl.createClass(this,"TFPUnaryOperator",this.TFPExprNode,(function(){this.$init=function(){t.TFPExprNode.$init.call(this),this.FOperand=null},this.$final=function(){this.FOperand=void 0,t.TFPExprNode.$final.call(this)},this.Create$1=function(t){return this.FOperand=t,this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FOperand},set:function(t){this.p.FOperand=t}}),pas.System.TObject.Destroy.call(this)},this.Check=function(){null==this.FOperand&&e.RaiseParserError$1(rtl.getResStr(t,"SErrNoOperand"),pas.System.VarRecs(18,this.$classname))}})),rtl.createClass(this,"TFPConvertNode",this.TFPUnaryOperator,(function(){this.AsString=function(){return this.FOperand.AsString()}})),rtl.createClass(this,"TFPNotNode",this.TFPUnaryOperator,(function(){this.Check=function(){this.FOperand.NodeType()in rtl.createSet(1,0)||e.RaiseParserError$1(rtl.getResStr(t,"SErrNoNOTOperation"),pas.System.VarRecs(18,t.ResultTypeName(this.FOperand.NodeType()),18,this.FOperand.AsString()))},this.NodeType=function(){return this.FOperand.NodeType()},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();e.$assign(this.FOperand.GetNodeValue());var i=e.ResultType;return(1===i||0===i)&&(e.resValue=!e.resValue),e},this.AsString=function(){return"not "+this.FOperand.AsString()}})),rtl.createClass(this,"TIntConvertNode",this.TFPConvertNode,(function(){this.Check=function(){t.TFPUnaryOperator.Check.call(this),this.CheckNodeType(this.FOperand,rtl.createSet(1))}})),rtl.createClass(this,"TIntToFloatNode",this.TIntConvertNode,(function(){this.NodeType=function(){return 2,2},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FOperand.GetNodeValue()),e.resValue=e.resValue,e.ResultType=2,e}})),rtl.createClass(this,"TIntToCurrencyNode",this.TIntConvertNode,(function(){this.NodeType=function(){return 5,5},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FOperand.GetNodeValue()),e.resValue=e.resValue,e.ResultType=5,e}})),rtl.createClass(this,"TIntToDateTimeNode",this.TIntConvertNode,(function(){this.NodeType=function(){return 3,3},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FOperand.GetNodeValue()),e.ResultType=3,e}})),rtl.createClass(this,"TFloatToDateTimeNode",this.TFPConvertNode,(function(){this.Check=function(){t.TFPUnaryOperator.Check.call(this),this.CheckNodeType(this.FOperand,rtl.createSet(2))},this.NodeType=function(){return 3,3},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FOperand.GetNodeValue()),e.ResultType=3,e}})),rtl.createClass(this,"TFloatToCurrencyNode",this.TFPConvertNode,(function(){this.Check=function(){this.CheckNodeType(this.FOperand,rtl.createSet(2))},this.NodeType=function(){return 5,5},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FOperand.GetNodeValue()),e.ResultType=5,e.resValue=e.resValue,e}})),rtl.createClass(this,"TCurrencyToDateTimeNode",this.TFPConvertNode,(function(){this.Check=function(){t.TFPUnaryOperator.Check.call(this),this.CheckNodeType(this.FOperand,rtl.createSet(5))},this.NodeType=function(){return 3,3},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new(),i=t.TFPExpressionResult.$new();return i.$assign(this.FOperand.GetNodeValue()),e.resValue=rtl.trunc(1e4*i.resValue)/1e4,e.ResultType=3,e}})),rtl.createClass(this,"TCurrencyToFloatNode",this.TFPConvertNode,(function(){this.Check=function(){t.TFPUnaryOperator.Check.call(this),this.CheckNodeType(this.FOperand,rtl.createSet(5))},this.NodeType=function(){return 2,2},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FOperand.GetNodeValue()),e.resValue=rtl.trunc(1e4*e.resValue)/1e4,e.ResultType=2,e}})),rtl.createClass(this,"TFPNegateOperation",this.TFPUnaryOperator,(function(){this.Check=function(){t.TFPUnaryOperator.Check.call(this),this.FOperand.NodeType()in rtl.createSet(1,2,5)||e.RaiseParserError$1(rtl.getResStr(t,"SErrNoNegation"),pas.System.VarRecs(18,t.ResultTypeName(this.FOperand.NodeType()),18,this.FOperand.AsString()))},this.NodeType=function(){return this.FOperand.NodeType()},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();e.$assign(this.FOperand.GetNodeValue());var i=e.ResultType;return 1===i?e.resValue=-rtl.trunc(e.resValue):2===i?e.resValue=-rtl.getNumber(e.resValue):5===i&&(e.resValue=-rtl.trunc(1e4*e.resValue)/1e4),e},this.AsString=function(){return"-"+pas.SysUtils.TrimLeft(this.FOperand.AsString())}})),rtl.createClass(this,"TFPConstExpression",this.TFPExprNode,(function(){this.$init=function(){t.TFPExprNode.$init.call(this),this.FValue=t.TFPExpressionResult.$new()},this.$final=function(){this.FValue=void 0,t.TFPExprNode.$final.call(this)},this.CreateString=function(t){return this.FValue.ResultType=4,this.FValue.resValue=t,this},this.CreateInteger=function(t){return this.FValue.ResultType=1,this.FValue.resValue=t,this},this.CreateFloat=function(t){return pas.System.TObject.Create.call(this),this.FValue.ResultType=2,this.FValue.resValue=t,this},this.CreateBoolean=function(t){return this.FValue.ResultType=0,this.FValue.resValue=t,this},this.Check=function(){},this.NodeType=function(){return this.FValue.ResultType},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FValue),e},this.AsString=function(){var t="",e=this.NodeType();return 4===e?t="'"+this.FValue.resValue+"'":1===e?t=pas.SysUtils.IntToStr(rtl.trunc(this.FValue.resValue)):3===e?t="'"+pas.SysUtils.FormatDateTime("cccc",rtl.getNumber(this.FValue.resValue))+"'":0===e?t=0!=this.FValue.resValue?"True":"False":2===e?t=rtl.floatToStr(rtl.getNumber(this.FValue.resValue)):5===e&&(t=rtl.floatToStr(rtl.trunc(1e4*this.FValue.resValue)/1e4)),t}})),this.TIdentifierType={0:"itVariable",itVariable:0,1:"itFunctionHandler",itFunctionHandler:1,2:"itFunctionNode",itFunctionNode:2},this.$rtti.$Enum("TIdentifierType",{minvalue:0,maxvalue:2,ordtype:1,enumtype:this.TIdentifierType}),this.$rtti.$RefToProcVar("TFPExprFunctionEvent",{procsig:rtl.newTIProcSig([["Args",this.$rtti.TExprParameterArray,2]],this.$rtti.TFPExpressionResult)}),this.$rtti.$RefToProcVar("TFPExprVariableEvent",{procsig:rtl.newTIProcSig([["AName",rtl.string,2]],this.$rtti.TFPExpressionResult)}),rtl.createClass(this,"TFPExprIdentifierDef",pas.Classes.TCollectionItem,(function(){this.$init=function(){pas.Classes.TCollectionItem.$init.call(this),this.FNodeType=null,this.FOnGetVarValue=null,this.FStringValue="",this.FValue=t.TFPExpressionResult.$new(),this.FArgumentTypes="",this.FIDType=0,this.FName="",this.FOnGetValue=null},this.$final=function(){this.FNodeType=void 0,this.FOnGetVarValue=void 0,this.FValue=void 0,this.FOnGetValue=void 0,pas.Classes.TCollectionItem.$final.call(this)},this.GetResultType=function(){return this.FValue.ResultType},this.GetValue=function(){var t="",e=this.FValue.ResultType;return 0===e?t=this.FValue.resValue?"True":"False":1===e?t=pas.SysUtils.IntToStr(rtl.trunc(this.FValue.resValue)):2===e?t=pas.SysUtils.FloatToStr(rtl.getNumber(this.FValue.resValue)):5===e?t=pas.SysUtils.CurrToStr(rtl.trunc(1e4*this.FValue.resValue)):3===e?t=pas.SysUtils.FormatDateTime("cccc",rtl.getNumber(this.FValue.resValue)):4===e&&(t=""+this.FValue.resValue),t},this.SetArgumentTypes=function(e){var i=0;if(this.FArgumentTypes!==e){for(var s=1,n=e.length;s<=n;s++)i=s,t.CharToResultType(e.charAt(i-1));this.FArgumentTypes=e}},this.SetName=function(i){this.FName!==i&&(""!==i&&null!=this.FCollection&&-1!==this.FCollection.IndexOfIdentifier(i)&&e.RaiseParserError$1(rtl.getResStr(t,"SErrDuplicateIdentifier"),pas.System.VarRecs(18,i)),this.FName=i)},this.SetResultType=function(t){t!==this.FValue.ResultType&&(this.FValue.ResultType=t,this.SetValue(this.FStringValue))},this.SetValue=function(t){if(this.FStringValue=t,""!==t){var e=this.FValue.ResultType;0===e?this.FValue.resValue="True"===this.FStringValue:1===e?this.FValue.resValue=pas.SysUtils.StrToInt(t):2===e?this.FValue.resValue=pas.SysUtils.StrToFloat(t):5===e?this.FValue.resValue=pas.SysUtils.StrToCurr(t)/1e4:3===e?this.FValue.resValue=pas.SysUtils.StrToDateTime(t):4===e&&(this.FValue.resValue=t)}else{var i=this.FValue.ResultType;0===i?this.FValue.resValue=!1:1===i||2===i||5===i||3===i?this.FValue.resValue=0:4===i&&(this.FValue.resValue="")}},this.FetchValue=function(){var e,i,s=0;if(e=this.GetResultType(),null!=this.FOnGetVarValue&&this.FValue.$assign(this.FOnGetVarValue(this.FName)),(i=this.FValue.ResultType)!==e){if(1!==i||2!==e)throw this.FValue.ResultType=e,t.EExprParser.$create("CreateFmt",['Value handler for variable %s returned wrong type, expected "%s", got "%s"',pas.System.VarRecs(18,this.FName,18,pas.TypInfo.GetEnumName(t.$rtti.TResultType,e),18,pas.TypInfo.GetEnumName(t.$rtti.TResultType,i))]);this.FValue.ResultType=e,s=rtl.trunc(this.FValue.resValue),this.FValue.resValue=s}},this.ArgumentCount=function(){return this.FArgumentTypes.length},this.Assign=function(e){var i=null;t.TFPExprIdentifierDef.isPrototypeOf(e)?(i=rtl.as(e,t.TFPExprIdentifierDef),this.FStringValue=i.FStringValue,this.FValue.$assign(i.FValue),this.FArgumentTypes=i.FArgumentTypes,this.FIDType=i.FIDType,this.FName=i.FName,this.FOnGetValue=i.FOnGetValue,this.FOnGetVarValue=i.FOnGetVarValue):pas.Classes.TPersistent.Assign.call(this,e)},this.EventBasedVariable=function(){return null!=this.FOnGetVarValue};var i=this.$rtti;i.addProperty("IdentifierType",0,t.$rtti.TIdentifierType,"FIDType","FIDType"),i.addProperty("Name",2,rtl.string,"FName","SetName"),i.addProperty("Value",3,rtl.string,"GetValue","SetValue"),i.addProperty("ParameterTypes",2,rtl.string,"FArgumentTypes","SetArgumentTypes"),i.addProperty("ResultType",3,t.$rtti.TResultType,"GetResultType","SetResultType"),i.addProperty("OnGetFunctionValue",0,t.$rtti.TFPExprFunctionEvent,"FOnGetValue","FOnGetValue"),i.addProperty("OnGetVariableValue",0,t.$rtti.TFPExprVariableEvent,"FOnGetVarValue","FOnGetVarValue"),i.addProperty("NodeType",0,t.$rtti.TFPExprFunctionClass,"FNodeType","FNodeType")})),this.TBuiltInCategory={0:"bcStrings",bcStrings:0,1:"bcDateTime",bcDateTime:1,2:"bcMath",bcMath:2,3:"bcBoolean",bcBoolean:3,4:"bcConversion",bcConversion:4,5:"bcData",bcData:5,6:"bcVaria",bcVaria:6,7:"bcUser",bcUser:7,8:"bcAggregate",bcAggregate:8},this.$rtti.$Enum("TBuiltInCategory",{minvalue:0,maxvalue:8,ordtype:1,enumtype:this.TBuiltInCategory}),this.$rtti.$Set("TBuiltInCategories",{comptype:this.$rtti.TBuiltInCategory}),rtl.createClass(this,"TFPBuiltInExprIdentifierDef",this.TFPExprIdentifierDef,(function(){this.$init=function(){t.TFPExprIdentifierDef.$init.call(this),this.FCategory=0},this.Assign=function(e){t.TFPExprIdentifierDef.Assign.call(this,e),t.TFPBuiltInExprIdentifierDef.isPrototypeOf(e)&&(this.FCategory=rtl.as(e,t.TFPBuiltInExprIdentifierDef).FCategory)},this.$rtti.addProperty("Category",0,t.$rtti.TBuiltInCategory,"FCategory","FCategory")})),rtl.createClass(this,"TFPExprIdentifierDefs",pas.Classes.TCollection,(function(){this.$init=function(){pas.Classes.TCollection.$init.call(this),this.FParser=null},this.$final=function(){this.FParser=void 0,pas.Classes.TCollection.$final.call(this)},this.GetI=function(t){return this.GetItem(t)},this.Update=function(t){pas.Classes.TCollection.Update.call(this,t),null!=this.FParser&&(this.FParser.FDirty=!0)},this.IndexOfIdentifier=function(t){var e=0;for(e=this.GetCount()-1;e>=0&&0!==pas.SysUtils.CompareText(this.GetI(e).FName,t);)e-=1;return e},this.AddVariable=function(e,i,s){var n=null;return(n=rtl.as(this.Add(),t.TFPExprIdentifierDef)).FIDType=0,n.SetName(e),n.SetResultType(i),n.FOnGetVarValue=s,n},this.AddFloatVariable=function(e,i){var s=null;return(s=rtl.as(this.Add(),t.TFPExprIdentifierDef)).FIDType=0,s.SetName(e),s.SetResultType(2),s.FValue.resValue=i,s},this.AddFunction=function(e,i,s,n){var o=null;return(o=rtl.as(this.Add(),t.TFPExprIdentifierDef)).SetName(e),o.FIDType=1,o.SetArgumentTypes(s),o.SetResultType(t.CharToResultType(i)),o.FOnGetValue=n,o},this.AddFunction$1=function(e,i,s,n){var o=null;return(o=rtl.as(this.Add(),t.TFPExprIdentifierDef)).SetName(e),o.FIDType=2,o.SetArgumentTypes(s),o.SetResultType(t.CharToResultType(i)),o.FNodeType=n,o}})),rtl.createClass(this,"TFPExprIdentifierNode",this.TFPExprNode,(function(){this.$init=function(){t.TFPExprNode.$init.call(this),this.FID=null,this.PResult=null,this.FResultType=0},this.$final=function(){this.FID=void 0,t.TFPExprNode.$final.call(this)},this.CreateIdentifier=function(t){return pas.System.TObject.Create.call(this),this.FID=t,this.PResult=this.FID.FValue,this.FResultType=this.FID.GetResultType(),this},this.NodeType=function(){return this.FResultType},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return this.FID.EventBasedVariable()&&(this.FID.FetchValue(),this.PResult=this.FID.FValue),e.$assign(this.PResult),e.ResultType=this.FResultType,e}})),rtl.createClass(this,"TFPExprVariable",this.TFPExprIdentifierNode,(function(){this.Check=function(){},this.AsString=function(){return this.FID.FName}})),rtl.createClass(this,"TFPExprFunction",this.TFPExprIdentifierNode,(function(){this.$init=function(){t.TFPExprIdentifierNode.$init.call(this),this.FArgumentNodes=[],this.FargumentParams=[]},this.$final=function(){this.FArgumentNodes=void 0,this.FargumentParams=void 0,t.TFPExprIdentifierNode.$final.call(this)},this.CalcParams=function(){for(var t=0,e=0,i=rtl.length(this.FargumentParams)-1;e<=i;e++)t=e,this.FargumentParams[t].$assign(this.FArgumentNodes[t].GetNodeValue())},this.ConvertArgument=function(i,s,n){var o;return s===(o=t.TFPExpressionParser.ConvertNode(s,n))&&e.RaiseParserError$1(rtl.getResStr(t,"SErrInvalidArgumentType"),pas.System.VarRecs(0,i,18,t.ResultTypeName(n),18,t.ResultTypeName(s.NodeType()))),o},this.Check=function(){var i=0,s=0;rtl.length(this.FArgumentNodes)!==this.FID.ArgumentCount()&&e.RaiseParserError$1(rtl.getResStr(t,"ErrInvalidArgumentCount"),pas.System.VarRecs(18,this.FID.FName));for(var n=0,o=rtl.length(this.FArgumentNodes)-1;n<=o;n++)i=n,(s=t.CharToResultType(this.FID.FArgumentTypes.charAt(i+1-1)))!==this.FArgumentNodes[i].NodeType()&&(this.FArgumentNodes[i]=this.ConvertArgument(i+1,this.FArgumentNodes[i],s))},this.CreateFunction=function(e,i){return t.TFPExprIdentifierNode.CreateIdentifier.call(this,e),this.FArgumentNodes=rtl.arrayRef(i),this.FargumentParams=rtl.arraySetLength(this.FargumentParams,t.TFPExpressionResult,rtl.length(i)),this},this.Destroy=function(){for(var t=0,e=0,i=rtl.length(this.FArgumentNodes)-1;e<=i;e++)t=e,pas.SysUtils.FreeAndNil({a:t,p:this.FArgumentNodes,get:function(){return this.p[this.a]},set:function(t){this.p[this.a]=t}});pas.System.TObject.Destroy.call(this)},this.AsString=function(){var t="",e=0;t="";for(var i=0,s=rtl.length(this.FArgumentNodes)-1;i<=s;i++)e=i,""!==t&&(t+=","),t+=this.FArgumentNodes[e].AsString();return""!==t&&(t="("+t+")"),this.FID.FName+t}})),rtl.createClass(this,"TAggregateExpr",this.TFPExprFunction,(function(){this.$init=function(){t.TFPExprFunction.$init.call(this),this.FResult=t.TFPExpressionResult.$new()},this.$final=function(){this.FResult=void 0,t.TFPExprFunction.$final.call(this)},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return e.$assign(this.FResult),e}})),rtl.createClass(this,"TAggregateMin",this.TAggregateExpr,(function(){})),rtl.createClass(this,"TAggregateMax",this.TAggregateExpr,(function(){})),rtl.createClass(this,"TAggregateSum",this.TAggregateExpr,(function(){this.ConvertArgument=function(i,s,n){return s.NodeType()in rtl.createSet(2,1,5)||e.RaiseParserError$1(rtl.getResStr(t,"SErrInvalidArgumentType"),pas.System.VarRecs(0,i,18,t.ResultTypeName(n),18,t.ResultTypeName(s.NodeType()))),s}})),rtl.createClass(this,"TAggregateAvg",this.TAggregateSum,(function(){this.$init=function(){t.TAggregateSum.$init.call(this),this.FCount=0},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();if(e.$assign(t.TAggregateExpr.GetNodeValue.call(this)),e.ResultType=this.FResult.ResultType,0===this.FCount){var i=this.FResult.ResultType;1===i?(e.ResultType=2,e.resValue=0):(2===i||5===i)&&(e.resValue=0)}else{var s=this.FResult.ResultType;1===s?(e.ResultType=2,e.resValue=rtl.trunc(this.FResult.resValue)/this.FCount):2===s?e.resValue=rtl.getNumber(this.FResult.resValue)/this.FCount:5===s&&(e.resValue=rtl.trunc(rtl.trunc(1e4*this.FResult.resValue)/this.FCount)/1e4)}return e}})),rtl.createClass(this,"TAggregateCount",this.TAggregateExpr,(function(){})),rtl.createClass(this,"TFPFunctionEventHandler",this.TFPExprFunction,(function(){this.$init=function(){t.TFPExprFunction.$init.call(this),this.FCallBack=null},this.$final=function(){this.FCallBack=void 0,t.TFPExprFunction.$final.call(this)},this.CreateFunction=function(e,i){return t.TFPExprFunction.CreateFunction.apply(this,arguments),this.FCallBack=e.FOnGetValue,this},this.GetNodeValue=function(){var e=t.TFPExpressionResult.$new();return rtl.length(this.FargumentParams)>0&&this.CalcParams(),e.$assign(this.FCallBack(this.FargumentParams)),e.ResultType=this.NodeType(),e}})),rtl.createClass(this,"TFPExpressionParser",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FBuiltIns={},this.FExpression="",this.FScanner=null,this.FExprNode=null,this.FIdentifiers=null,this.FHashList=null,this.FDirty=!1},this.$final=function(){this.FBuiltIns=void 0,this.FScanner=void 0,this.FExprNode=void 0,this.FIdentifiers=void 0,this.FHashList=void 0,pas.Classes.TComponent.$final.call(this)},this.CheckEOF=function(){26===this.TokenType()&&this.ParserError(rtl.getResStr(t,"SErrUnexpectedEndOfExpression"))},this.GetAsBoolean=function(){var e=t.TFPExpressionResult.$new();return this.EvaluateExpression(e),this.CheckResultType(e,0),!(0==e.resValue)},this.MatchNodes=function(t,e){var i,s,n=null;if(n=t,(i=t.NodeType())!==(s=e.NodeType())){var o=i;1===o?s in rtl.createSet(2,5,3)&&(n=this.$class.ConvertNode(t,s)):2===o?s in rtl.createSet(5,3)&&(n=this.$class.ConvertNode(t,s)):5===o&&s in rtl.createSet(2,3)&&(n=this.$class.ConvertNode(t,s))}return n},this.CheckNodes=function(t,e){t.set(this.MatchNodes(t.get(),e.get())),e.set(this.MatchNodes(e.get(),t.get()))},this.SetBuiltIns=function(t){rtl.eqSet(this.FBuiltIns,t)||(this.FBuiltIns=rtl.refSet(t),this.FDirty=!0)},this.SetIdentifiers=function(t){this.FIdentifiers.Assign(t)},this.ParserError=function(e){throw t.EExprParser.$create("Create$1",[e])},this.SetExpression=function(e){this.FExpression!==e&&(this.FExpression=e,this.FScanner.SetSource(e),null!=this.FExprNode&&pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FExprNode},set:function(t){this.p.FExprNode=t}}),""!==this.FExpression?(this.GetToken(),this.FExprNode=this.Level1(),26!==this.TokenType()&&this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SErrUnterminatedExpression"),pas.System.VarRecs(0,this.FScanner.FPos,18,this.CurrentToken()))),this.FExprNode.Check()):this.FExprNode=null)},this.CheckResultType=function(i,s){i.ResultType!==s&&e.RaiseParserError$1(rtl.getResStr(t,"SErrInvalidResultType"),pas.System.VarRecs(18,t.ResultTypeName(i.ResultType)))},this.ConvertNode=function(e,i){var s=null;s=e;var n=e.NodeType();if(1===n){var o=i;2===o?s=t.TIntToFloatNode.$create("Create$1",[s]):5===o?s=t.TIntToCurrencyNode.$create("Create$1",[s]):3===o&&(s=t.TIntToDateTimeNode.$create("Create$1",[s]))}else if(2===n){var r=i;5===r?s=t.TFloatToCurrencyNode.$create("Create$1",[s]):3===r&&(s=t.TFloatToDateTimeNode.$create("Create$1",[s]))}else if(5===n){var a=i;2===a?s=t.TCurrencyToFloatNode.$create("Create$1",[s]):3===a&&(s=t.TCurrencyToDateTimeNode.$create("Create$1",[s]))}return s},this.BuiltinsManager=function(){return t.BuiltinIdentifiers()},this.Level1=function(){var e=null,i=0,s=null;22===this.TokenType()?(this.GetToken(),this.CheckEOF(),s=this.Level2(),e=t.TFPNotNode.$create("Create$1",[s])):e=this.Level2();try{for(;this.TokenType()in rtl.createSet(17,18,19);){i=this.TokenType(),this.GetToken(),this.CheckEOF(),s=this.Level2();var n=i;18===n?e=t.TFPBinaryOrOperation.$create("Create$1",[e,s]):17===n?e=t.TFPBinaryAndOperation.$create("Create$1",[e,s]):19===n?e=t.TFPBinaryXOrOperation.$create("Create$1",[e,s]):this.ParserError(rtl.getResStr(t,"SErrUnknownBooleanOp"))}}catch(t){throw e=rtl.freeLoc(e),t}return e},this.Level2=function(){var e=null,i=null,s=0,n=null;e=this.Level3();try{if(this.TokenType()in t.ttComparisons){s=this.TokenType(),this.GetToken(),this.CheckEOF(),i=this.Level3(),this.CheckNodes({get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}});var o=s;2===o?n=t.TFPLessThanOperation:10===o?n=t.TFPLessThanEqualOperation:3===o?n=t.TFPGreaterThanOperation:11===o?n=t.TFPGreaterThanEqualOperation:4===o?n=t.TFPEqualOperation:12===o?n=t.TFPUnequalOperation:this.ParserError(rtl.getResStr(t,"SErrUnknownComparison")),e=n.$create("Create$1",[e,i])}}catch(t){throw e=rtl.freeLoc(e),t}return e},this.Level3=function(){var e=null,i=0,s=null;e=this.Level4();try{for(;this.TokenType()in rtl.createSet(0,1);){i=this.TokenType(),this.GetToken(),this.CheckEOF(),s=this.Level4(),this.CheckNodes({get:function(){return e},set:function(t){e=t}},{get:function(){return s},set:function(t){s=t}});var n=i;0===n?e=t.TFPAddOperation.$create("Create$1",[e,s]):1===n&&(e=t.TFPSubtractOperation.$create("Create$1",[e,s]))}}catch(t){throw e=rtl.freeLoc(e),t}return e},this.Level4=function(){var e=null,i=0,s=null;e=this.Level5();try{for(;this.TokenType()in rtl.createSet(7,5,6);){i=this.TokenType(),this.GetToken(),s=this.Level5(),this.CheckNodes({get:function(){return e},set:function(t){e=t}},{get:function(){return s},set:function(t){s=t}});var n=i;7===n?e=t.TFPMultiplyOperation.$create("Create$1",[e,s]):5===n?e=t.TFPDivideOperation.$create("Create$1",[e,s]):6===n&&(e=t.TFPModuloOperation.$create("Create$1",[e,s]))}}catch(t){throw e=rtl.freeLoc(e),t}return e},this.Level5=function(){var e=null,i=!1;return i=!1,this.TokenType()in rtl.createSet(0,1)&&(i=1===this.TokenType(),this.GetToken()),e=this.Level6(),i&&(e=t.TFPNegateOperation.$create("Create$1",[e])),e},this.Level6=function(){var e=null,i=null;e=this.Level7();try{for(;25===this.TokenType();)this.GetToken(),i=this.Level5(),this.CheckNodes({get:function(){return e},set:function(t){e=t}},{get:function(){return i},set:function(t){i=t}}),e=t.TFPPowerOperation.$create("Create$1",[e,i])}catch(t){throw e=rtl.freeLoc(e),t}return e},this.Level7=function(){var e=null;if(8===this.TokenType()){this.GetToken(),e=this.Level1();try{9!==this.TokenType()&&this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SErrBracketExpected"),pas.System.VarRecs(0,this.FScanner.FPos,18,this.CurrentToken()))),this.GetToken()}catch(t){throw e=rtl.freeLoc(e),t}}else e=this.Primitive();return e},this.Primitive=function(){var e=null,i=0,s=0,n=0,o=0,r=!1,a=!1,l=null,h=[],F=0;if(h=rtl.arraySetLength(h,null,0),13===this.TokenType())pas.SysUtils.TryStrToInt64(this.CurrentToken(),{get:function(){return i},set:function(t){i=t}})?e=t.TFPConstExpression.$create("CreateInteger",[i]):(pas.System.val$8(this.CurrentToken(),{get:function(){return n},set:function(t){n=t}},{get:function(){return s},set:function(t){s=t}}),0===s?e=t.TFPConstExpression.$create("CreateFloat",[n]):this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SErrInvalidFloat"),pas.System.VarRecs(18,this.CurrentToken()))));else if(14===this.TokenType())e=t.TFPConstExpression.$create("CreateString",[this.CurrentToken()]);else if(this.TokenType()in rtl.createSet(20,21))e=t.TFPConstExpression.$create("CreateBoolean",[20===this.TokenType()]);else if(this.TokenType()in rtl.createSet(15,23,24)){if(r=23===this.TokenType(),a=24===this.TokenType(),r||a||null===(l=this.IdentifierByName(this.CurrentToken()))&&this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SErrUnknownIdentifier"),pas.System.VarRecs(18,this.CurrentToken()))),0!==(o=r?3:a?-4:l.FIDType in rtl.createSet(1,2)?l.ArgumentCount():0)){this.GetToken(),8!==this.TokenType()&&this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SErrLeftBracketExpected"),pas.System.VarRecs(0,this.FScanner.FPos,18,this.CurrentToken()))),h=rtl.arraySetLength(h,null,Math.abs(o)),F=0;try{do{this.GetToken(),o<0&&F===rtl.length(h)&&((h=rtl.arraySetLength(h,null,F+1))[F]=null),h[F]=this.Level1(),F+=1,16!==this.TokenType()&&F<Math.abs(o)&&this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SErrCommaExpected"),pas.System.VarRecs(0,this.FScanner.FPos,18,this.CurrentToken())))}while(!(F===o||o<0&&9===this.TokenType()));9!==this.TokenType()&&this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SErrBracketExpected"),pas.System.VarRecs(0,this.FScanner.FPos,18,this.CurrentToken())))}catch(t){if(pas.SysUtils.Exception.isPrototypeOf(t)){for(F-=1;F>=0;)pas.SysUtils.FreeAndNil({a:F,p:h,get:function(){return this.p[this.a]},set:function(t){this.p[this.a]=t}}),F-=1;throw t}throw t}}if(r)e=t.TIfOperation.$create("Create$2",[h[0],h[1],h[2]]);else if(a)e=t.TCaseOperation.$create("Create$1",[rtl.arrayRef(h)]);else{var p=l.FIDType;0===p?e=t.TFPExprVariable.$create("CreateIdentifier",[l]):1===p?e=t.TFPFunctionEventHandler.$create("CreateFunction",[l,h]):2===p&&(e=l.FNodeType.$create("CreateFunction",[l,h]))}}else this.ParserError(pas.SysUtils.Format(rtl.getResStr(t,"SerrUnknownTokenAtPos"),pas.System.VarRecs(0,this.FScanner.FPos,18,this.CurrentToken())));return this.GetToken(),e},this.GetToken=function(){return this.FScanner.GetToken()},this.TokenType=function(){return this.FScanner.FTokenType},this.CurrentToken=function(){return this.FScanner.FToken},this.CreateHashList=function(){var t=null,e=null,i=0,s=null;if(this.FHashList.Clear(),s=this.$class.BuiltinsManager(),rtl.neSet(this.FBuiltIns,{})&&null!=s)for(var n=0,o=s.GetCount()-1;n<=o;n++)i=n,(e=s.GetI(i)).FCategory in this.FBuiltIns&&this.FHashList.Add(pas.SysUtils.LowerCase(e.FName),e);for(var r=0,a=this.FIdentifiers.GetCount()-1;r<=a;r++)i=r,t=this.FIdentifiers.GetI(i),this.FHashList.Add(pas.SysUtils.LowerCase(t.FName),t);this.FDirty=!1},this.Create$1=function(e){return pas.Classes.TComponent.Create$1.call(this,e),this.FIdentifiers=t.TFPExprIdentifierDefs.$create("Create$1",[t.TFPExprIdentifierDef]),this.FIdentifiers.FParser=this,this.FScanner=t.TFPExpressionScanner.$create("Create$1"),this.FHashList=pas.contnrs.TFPObjectHashTable.$create("Create$2",[!1]),this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FHashList},set:function(t){this.p.FHashList=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FExprNode},set:function(t){this.p.FExprNode=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FIdentifiers},set:function(t){this.p.FIdentifiers=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FScanner},set:function(t){this.p.FScanner=t}}),pas.Classes.TComponent.Destroy.call(this)},this.IdentifierByName=function(t){return this.FDirty&&this.CreateHashList(),this.FHashList.GetData(pas.SysUtils.LowerCase(t))},this.EvaluateExpression=function(t){t.$assign(this.Evaluate$1())},this.Evaluate$1=function(){var e=t.TFPExpressionResult.$new();return""===this.FExpression&&this.ParserError(rtl.getResStr(t,"SErrInExpressionEmpty")),null==this.FExprNode&&this.ParserError(rtl.getResStr(t,"SErrInExpression")),e.$assign(this.FExprNode.GetNodeValue()),e},rtl.addIntf(this,pas.System.IUnknown);var i=this.$rtti;i.addProperty("Expression",2,rtl.string,"FExpression","SetExpression"),i.addProperty("Identifiers",2,t.$rtti.TFPExprIdentifierDefs,"FIdentifiers","SetIdentifiers"),i.addProperty("BuiltIns",2,t.$rtti.TBuiltInCategories,"FBuiltIns","SetBuiltIns")})),rtl.createClass(this,"TExprBuiltInManager",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FDefs=null},this.$final=function(){this.FDefs=void 0,pas.Classes.TComponent.$final.call(this)},this.GetCount=function(){return this.FDefs.GetCount()},this.GetI=function(t){return this.FDefs.GetI(t)},this.Create$1=function(e){return pas.Classes.TComponent.Create$1.call(this,e),this.FDefs=t.TFPExprIdentifierDefs.$create("Create$1",[t.TFPBuiltInExprIdentifierDef]),this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FDefs},set:function(t){this.p.FDefs=t}}),pas.Classes.TComponent.Destroy.call(this)},this.AddFloatVariable=function(t,e,i){var s=null;return(s=this.FDefs.AddFloatVariable(e,i)).FCategory=t,s},this.AddFunction=function(t,e,i,s,n){var o=null;return(o=this.FDefs.AddFunction(e,i,s,n)).FCategory=t,o},this.AddFunction$1=function(t,e,i,s,n){var o=null;return(o=this.FDefs.AddFunction$1(e,i,s,n)).FCategory=t,o},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"EExprParser",pas.SysUtils.Exception,(function(){})),this.AllBuiltIns=rtl.createSet(0,1,2,3,4,5,6,7,8),this.ResultTypeName=function(e){return pas.TypInfo.GetEnumName(t.$rtti.TResultType,e)},this.CharToResultType=function(i){var s=0,n=pas.System.upcase(i);return"S"===n?s=4:"D"===n?s=3:"B"===n?s=0:"I"===n?s=1:"F"===n?s=2:"C"===n?s=5:e.RaiseParserError$1(rtl.getResStr(t,"SErrInvalidResultCharacter"),pas.System.VarRecs(9,i)),s},this.BuiltinIdentifiers=function(){return null===e.BuiltIns&&(e.BuiltIns=t.TExprBuiltInManager.$create("Create$1",[null])),e.BuiltIns},this.RegisterStdBuiltins=function(i,s){2 in s&&(i.AddFloatVariable(2,"pi",Math.PI),i.AddFunction(2,"cos","F","F",e.BuiltInCos),i.AddFunction(2,"sin","F","F",e.BuiltInSin),i.AddFunction(2,"abs","F","F",e.BuiltInAbs),i.AddFunction(2,"sqr","F","F",e.BuiltInSqr),i.AddFunction(2,"sqrt","F","F",e.BuiltInSqrt),i.AddFunction(2,"exp","F","F",e.BuiltInExp),i.AddFunction(2,"ln","F","F",e.BuiltInLn),i.AddFunction(2,"log","F","F",e.BuiltInLog),i.AddFunction(2,"frac","F","F",e.BuiltInFrac),i.AddFunction(2,"int","F","F",e.BuiltInInt),i.AddFunction(2,"round","I","F",e.BuiltInRound),i.AddFunction(2,"trunc","I","F",e.BuiltInTrunc)),0 in s&&(i.AddFunction(0,"length","I","S",e.BuiltInLength),i.AddFunction(0,"copy","S","SII",e.BuiltInCopy),i.AddFunction(0,"delete","S","SII",e.BuiltInDelete),i.AddFunction(0,"pos","I","SS",e.BuiltInPos),i.AddFunction(0,"lowercase","S","S",e.BuiltInLowercase),i.AddFunction(0,"uppercase","S","S",e.BuiltInUppercase),i.AddFunction(0,"stringreplace","S","SSSBB",e.BuiltInStringReplace),i.AddFunction(0,"comparetext","I","SS",e.BuiltInCompareText)),1 in s&&(i.AddFunction(1,"date","D","",e.BuiltInDate),i.AddFunction(1,"time","D","",e.BuiltInTime),i.AddFunction(1,"now","D","",e.BuiltInNow),i.AddFunction(1,"dayofweek","I","D",e.BuiltInDayofWeek),i.AddFunction(1,"extractyear","I","D",e.BuiltInExtractYear),i.AddFunction(1,"extractmonth","I","D",e.BuiltInExtractMonth),i.AddFunction(1,"extractday","I","D",e.BuiltInExtractDay),i.AddFunction(1,"extracthour","I","D",e.BuiltInExtractHour),i.AddFunction(1,"extractmin","I","D",e.BuiltInExtractMin),i.AddFunction(1,"extractsec","I","D",e.BuiltInExtractSec),i.AddFunction(1,"extractmsec","I","D",e.BuiltInExtractMSec),i.AddFunction(1,"encodedate","D","III",e.BuiltInEncodedate),i.AddFunction(1,"encodetime","D","IIII",e.BuiltInEncodeTime),i.AddFunction(1,"encodedatetime","D","IIIIIII",e.BuiltInEncodeDateTime),i.AddFunction(1,"shortdayname","S","I",e.BuiltInShortDayName),i.AddFunction(1,"shortmonthname","S","I",e.BuiltInShortMonthName),i.AddFunction(1,"longdayname","S","I",e.BuiltInLongDayName),i.AddFunction(1,"longmonthname","S","I",e.BuiltInLongMonthName)),3 in s&&(i.AddFunction(3,"shl","I","II",e.BuiltInShl),i.AddFunction(3,"shr","I","II",e.BuiltInShr),i.AddFunction(3,"IFS","S","BSS",e.BuiltinIFS),i.AddFunction(3,"IFF","F","BFF",e.BuiltinIFF),i.AddFunction(3,"IFD","D","BDD",e.BuiltinIFD),i.AddFunction(3,"IFI","I","BII",e.BuiltinIFI)),4 in s&&(i.AddFunction(4,"inttostr","S","I",e.BuiltInIntToStr),i.AddFunction(4,"strtoint","I","S",e.BuiltInStrToInt),i.AddFunction(4,"strtointdef","I","SI",e.BuiltInStrToIntDef),i.AddFunction(4,"floattostr","S","F",e.BuiltInFloatToStr),i.AddFunction(4,"strtofloat","F","S",e.BuiltInStrToFloat),i.AddFunction(4,"strtofloatdef","F","SF",e.BuiltInStrToFloatDef),i.AddFunction(4,"booltostr","S","B",e.BuiltInBoolToStr),i.AddFunction(4,"strtobool","B","S",e.BuiltInStrToBool),i.AddFunction(4,"strtobooldef","B","SB",e.BuiltInStrToBoolDef),i.AddFunction(4,"datetostr","S","D",e.BuiltInDateToStr),i.AddFunction(4,"timetostr","S","D",e.BuiltInTimeToStr),i.AddFunction(4,"strtodate","D","S",e.BuiltInStrToDate),i.AddFunction(4,"strtodatedef","D","SD",e.BuiltInStrToDateDef),i.AddFunction(4,"strtotime","D","S",e.BuiltInStrToTime),i.AddFunction(4,"strtotimedef","D","SD",e.BuiltInStrToTimeDef),i.AddFunction(4,"strtodatetime","D","S",e.BuiltInStrToDateTime),i.AddFunction(4,"strtodatetimedef","D","SD",e.BuiltInStrToDateTimeDef),i.AddFunction(4,"formatfloat","S","SF",e.BuiltInFormatFloat),i.AddFunction(4,"formatdatetime","S","SD",e.BuiltInFormatDateTime)),8 in s&&(i.AddFunction$1(8,"count","I","",t.TAggregateCount),i.AddFunction$1(8,"sum","F","F",t.TAggregateSum),i.AddFunction$1(8,"avg","F","F",t.TAggregateAvg),i.AddFunction$1(8,"min","F","F",t.TAggregateMin),i.AddFunction$1(8,"max","F","F",t.TAggregateMax))},this.ArgToFloat=function(t){return 1===t.ResultType?rtl.trunc(t.resValue):5===t.ResultType?rtl.trunc(1e4*t.resValue)/1e4:rtl.getNumber(t.resValue)},t.$implcode=function(){e.cNull="\0",e.cSingleQuote="'",e.cHexIdentifier="$",e.cOctalIdentifier="&",e.cBinaryIdentifier="%",e.Digits=rtl.createSet(null,48,57,46),e.HexDigits=rtl.createSet(null,48,57,null,65,70,null,97,102),e.OctalDigits=rtl.createSet(null,48,55),e.BinaryDigits=rtl.createSet(48,49),e.WhiteSpace=rtl.createSet(32,13,10,9),e.Operators=rtl.createSet(43,45,60,62,61,47,42,94),e.Delimiters=rtl.unionSet(e.Operators,rtl.createSet(44,40,41)),e.Symbols=rtl.unionSet(rtl.createSet(37),e.Delimiters),e.WordDelimiters=rtl.unionSet(e.WhiteSpace,e.Symbols),e.FileFormatSettings=pas.SysUtils.TFormatSettings.$new(),e.RaiseParserError=function(e){throw t.EExprParser.$create("Create$1",[e])},e.RaiseParserError$1=function(e,i){throw t.EExprParser.$create("CreateFmt",[e,i])},e.BuiltIns=null,e.power=function(t,e){var i=0,s=0;return 0===e?i=1:0===t&&e>0?i=0:t<0&&0===pas.System.Frac(e)?(s=Math.round(e),i=Math.exp(e*Math.log(-t)),pas.System.Odd(s)&&(i=-i)):i=Math.exp(e*Math.log(t)),i},e.BuiltInCos=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=Math.cos(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInSin=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=Math.sin(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInAbs=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=Math.abs(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInSqr=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=pas.System.Sqr$1(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInSqrt=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=Math.sqrt(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInExp=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=Math.exp(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInLn=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=Math.log(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.L10=0,e.BuiltInLog=function(i){var s=t.TFPExpressionResult.$new();return s.ResultType=2,s.resValue=Math.log(t.ArgToFloat(t.TFPExpressionResult.$clone(i[0])))/e.L10,s},e.BuiltInRound=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=Math.round(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInTrunc=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=pas.System.Trunc(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInInt=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=pas.System.Int(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInFrac=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=pas.System.Frac(t.ArgToFloat(t.TFPExpressionResult.$clone(e[0]))),i},e.BuiltInLength=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=(""+e[0].resValue).length,i},e.BuiltInCopy=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.System.Copy(""+e[0].resValue,rtl.trunc(e[1].resValue),rtl.trunc(e[2].resValue)),i},e.BuiltInDelete=function(e){var i=t.TFPExpressionResult.$new(),s="";return i.ResultType=4,s=""+e[0].resValue,pas.System.Delete({get:function(){return s},set:function(t){s=t}},rtl.trunc(e[1].resValue),rtl.trunc(e[2].resValue)),i.resValue=s,i},e.BuiltInPos=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=pas.System.Pos(""+e[0].resValue,""+e[1].resValue),i},e.BuiltInUppercase=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.UpperCase(""+e[0].resValue),i},e.BuiltInLowercase=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.LowerCase(""+e[0].resValue),i},e.BuiltInStringReplace=function(e){var i=t.TFPExpressionResult.$new(),s={};return i.ResultType=4,s={},0!=e[3].resValue&&(s=rtl.includeSet(s,0)),0!=e[4].resValue&&(s=rtl.includeSet(s,1)),i.resValue=pas.SysUtils.StringReplace(""+e[0].resValue,""+e[1].resValue,""+e[2].resValue,rtl.refSet(s)),i},e.BuiltInCompareText=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=pas.SysUtils.CompareText(""+e[0].resValue,""+e[1].resValue),i},e.BuiltInDate=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.Date(),i},e.BuiltInTime=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.Time(),i},e.BuiltInNow=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.Now(),i},e.BuiltInDayofWeek=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=pas.SysUtils.DayOfWeek(rtl.getNumber(e[0].resValue)),i},e.BuiltInExtractYear=function(e){var i=t.TFPExpressionResult.$new(),s=0,n=0,o=0;return i.ResultType=1,pas.SysUtils.DecodeDate(rtl.getNumber(e[0].resValue),{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return o},set:function(t){o=t}}),i.resValue=s,i},e.BuiltInExtractMonth=function(e){var i=t.TFPExpressionResult.$new(),s=0,n=0,o=0;return i.ResultType=1,pas.SysUtils.DecodeDate(rtl.getNumber(e[0].resValue),{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return o},set:function(t){o=t}}),i.resValue=n,i},e.BuiltInExtractDay=function(e){var i=t.TFPExpressionResult.$new(),s=0,n=0,o=0;return i.ResultType=1,pas.SysUtils.DecodeDate(rtl.getNumber(e[0].resValue),{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return o},set:function(t){o=t}}),i.resValue=o,i},e.BuiltInExtractHour=function(e){var i=t.TFPExpressionResult.$new(),s=0,n=0,o=0,r=0;return i.ResultType=1,pas.SysUtils.DecodeTime(rtl.getNumber(e[0].resValue),{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return o},set:function(t){o=t}},{get:function(){return r},set:function(t){r=t}}),i.resValue=s,i},e.BuiltInExtractMin=function(e){var i=t.TFPExpressionResult.$new(),s=0,n=0,o=0,r=0;return i.ResultType=1,pas.SysUtils.DecodeTime(rtl.getNumber(e[0].resValue),{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return o},set:function(t){o=t}},{get:function(){return r},set:function(t){r=t}}),i.resValue=n,i},e.BuiltInExtractSec=function(e){var i=t.TFPExpressionResult.$new(),s=0,n=0,o=0,r=0;return i.ResultType=1,pas.SysUtils.DecodeTime(rtl.getNumber(e[0].resValue),{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return o},set:function(t){o=t}},{get:function(){return r},set:function(t){r=t}}),i.resValue=o,i},e.BuiltInExtractMSec=function(e){var i=t.TFPExpressionResult.$new(),s=0,n=0,o=0,r=0;return i.ResultType=1,pas.SysUtils.DecodeTime(rtl.getNumber(e[0].resValue),{get:function(){return s},set:function(t){s=t}},{get:function(){return n},set:function(t){n=t}},{get:function(){return o},set:function(t){o=t}},{get:function(){return r},set:function(t){r=t}}),i.resValue=r,i},e.BuiltInEncodedate=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.EncodeDate(rtl.trunc(e[0].resValue),rtl.trunc(e[1].resValue),rtl.trunc(e[2].resValue)),i},e.BuiltInEncodeTime=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.EncodeTime(rtl.trunc(e[0].resValue),rtl.trunc(e[1].resValue),rtl.trunc(e[2].resValue),rtl.trunc(e[3].resValue)),i},e.BuiltInEncodeDateTime=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.EncodeDate(rtl.trunc(e[0].resValue),rtl.trunc(e[1].resValue),rtl.trunc(e[2].resValue))+pas.SysUtils.EncodeTime(rtl.trunc(e[3].resValue),rtl.trunc(e[4].resValue),rtl.trunc(e[5].resValue),rtl.trunc(e[6].resValue)),i},e.BuiltInShortDayName=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.FormatSettings.ShortDayNames[rtl.trunc(e[0].resValue)-1],i},e.BuiltInShortMonthName=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.FormatSettings.ShortMonthNames[rtl.trunc(e[0].resValue)-1],i},e.BuiltInLongDayName=function(e){var i=t.TFPExpressionResult.$new();return i.resValue=pas.SysUtils.FormatSettings.LongDayNames[rtl.trunc(e[0].resValue)-1],i},e.BuiltInLongMonthName=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.FormatSettings.LongMonthNames[rtl.trunc(e[0].resValue)-1],i},e.BuiltInFormatDateTime=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.FormatDateTime(""+e[0].resValue,rtl.getNumber(e[1].resValue)),i},e.BuiltInIntToStr=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.IntToStr(rtl.trunc(e[0].resValue)),i},e.BuiltInStrToInt=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=pas.SysUtils.StrToInt(""+e[0].resValue),i},e.BuiltInStrToIntDef=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=pas.SysUtils.StrToIntDef$1(""+e[0].resValue,rtl.trunc(e[1].resValue)),i},e.BuiltInFloatToStr=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.FloatToStr(rtl.getNumber(e[0].resValue)),i},e.BuiltInStrToFloat=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=pas.SysUtils.StrToFloat(""+e[0].resValue),i},e.BuiltInStrToFloatDef=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,i.resValue=pas.SysUtils.StrToFloatDef(""+e[0].resValue,rtl.getNumber(e[1].resValue)),i},e.BuiltInDateToStr=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.DateToStr(rtl.getNumber(e[0].resValue)),i},e.BuiltInTimeToStr=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.TimeToStr(rtl.getNumber(e[0].resValue)),i},e.BuiltInStrToDate=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.StrToDate(""+e[0].resValue),i},e.BuiltInStrToDateDef=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.StrToDateDef(""+e[0].resValue,rtl.getNumber(e[1].resValue)),i},e.BuiltInStrToTime=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.StrToTime(""+e[0].resValue),i},e.BuiltInStrToTimeDef=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.StrToTimeDef(""+e[0].resValue,rtl.getNumber(e[1].resValue)),i},e.BuiltInStrToDateTime=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.StrToDateTime(""+e[0].resValue),i},e.BuiltInStrToDateTimeDef=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,i.resValue=pas.SysUtils.StrToDateTimeDef(""+e[0].resValue,rtl.getNumber(e[1].resValue)),i},e.BuiltInFormatFloat=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.FormatFloat(""+e[0].resValue,rtl.getNumber(e[1].resValue)),i},e.BuiltInBoolToStr=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,i.resValue=pas.SysUtils.BoolToStr(!(0==e[0].resValue),!1),i},e.BuiltInStrToBool=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=0,i.resValue=pas.SysUtils.StrToBool(""+e[0].resValue),i},e.BuiltInStrToBoolDef=function(e){var i=t.TFPExpressionResult.$new();return i.resValue=pas.SysUtils.StrToBoolDef(""+e[0].resValue,!(0==e[1].resValue)),i.ResultType=0,i},e.BuiltInShl=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=rtl.shl(rtl.trunc(e[0].resValue),rtl.trunc(e[1].resValue)),i},e.BuiltInShr=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,i.resValue=rtl.shr(rtl.trunc(e[0].resValue),rtl.trunc(e[1].resValue)),i},e.BuiltinIFS=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=4,0!=e[0].resValue?i.resValue=e[1].resValue:i.resValue=e[2].resValue,i},e.BuiltinIFI=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=1,0!=e[0].resValue?i.resValue=e[1].resValue:i.resValue=e[2].resValue,i},e.BuiltinIFF=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=2,0!=e[0].resValue?i.resValue=e[1].resValue:i.resValue=e[2].resValue,i},e.BuiltinIFD=function(e){var i=t.TFPExpressionResult.$new();return i.ResultType=3,0!=e[0].resValue?i.resValue=e[1].resValue:i.resValue=e[2].resValue,i},e.InitFileFormatSettings=function(){e.FileFormatSettings.$assign(pas.SysUtils.FormatSettings),e.FileFormatSettings.DecimalSeparator=".",e.FileFormatSettings.DateSeparator="-",e.FileFormatSettings.TimeSeparator=":",e.FileFormatSettings.ShortDateFormat="yyyy-mm-dd",e.FileFormatSettings.LongTimeFormat="hh:nn:ss"},t.$resourcestrings={SBadQuotes:{org:"Unterminated string"},SUnknownDelimiter:{org:'Unknown delimiter character: "%s"'},SErrUnknownCharacter:{org:'Unknown character at pos %d: "%s"'},SErrUnexpectedEndOfExpression:{org:"Unexpected end of expression"},SErrUnknownComparison:{org:"Internal error: Unknown comparison"},SErrUnknownBooleanOp:{org:"Internal error: Unknown boolean operation"},SErrBracketExpected:{org:"Expected ) bracket at position %d, but got %s"},SerrUnknownTokenAtPos:{org:"Unknown token at pos %d : %s"},SErrLeftBracketExpected:{org:"Expected ( bracket at position %d, but got %s"},SErrInvalidFloat:{org:"%s is not a valid floating-point value"},SErrUnknownIdentifier:{org:"Unknown identifier: %s"},SErrInExpression:{org:"Cannot evaluate: error in expression"},SErrInExpressionEmpty:{org:"Cannot evaluate: empty expression"},SErrCommaExpected:{org:"Expected comma (,) at position %d, but got %s"},SErrInvalidNumberChar:{org:"Unexpected character in number : %s"},SErrInvalidNumber:{org:"Invalid numerical value : %s"},SErrUnterminatedIdentifier:{org:"Unterminated quoted identifier: %s"},SErrNoOperand:{org:"No operand for unary operation %s"},SErrNoleftOperand:{org:"No left operand for binary operation %s"},SErrNoRightOperand:{org:"No right operand for binary operation %s"},SErrNoNegation:{org:"Cannot negate expression of type %s : %s"},SErrNoNOTOperation:{org:'Cannot perform "not" on expression of type %s: %s'},SErrTypesDoNotMatch:{org:'Type mismatch: %s<>%s for expressions "%s" and "%s".'},SErrNoNodeToCheck:{org:"Internal error: No node to check !"},SInvalidNodeType:{org:"Node type (%s) not in allowed types (%s) for expression: %s"},SErrUnterminatedExpression:{org:"Badly terminated expression. Found token at position %d : %s"},SErrDuplicateIdentifier:{org:'An identifier with name "%s" already exists.'},SErrInvalidResultCharacter:{org:'"%s" is not a valid return type indicator'},ErrInvalidArgumentCount:{org:"Invalid argument count for function %s"},SErrInvalidArgumentType:{org:"Invalid type for argument %d: Expected %s, got %s"},SErrInvalidResultType:{org:"Invalid result type: %s"},SErrIFNeedsBoolean:{org:"First argument to IF must be of type boolean: %s"},SErrCaseNeeds3:{org:"Case statement needs to have at least 4 arguments"},SErrCaseEvenCount:{org:"Case statement needs to have an even number of arguments"},SErrCaseLabelNotAConst:{org:'Case label %d "%s" is not a constant expression'},SErrCaseLabelType:{org:'Case label %d "%s" needs type %s, but has type %s'},SErrCaseValueType:{org:'Case value %d "%s" needs type %s, but has type %s'}}},t.$init=function(){e.L10=Math.log(10),t.RegisterStdBuiltins(t.BuiltinIdentifiers(),t.AllBuiltIns),e.InitFileFormatSettings()}}),["TypInfo"]),rtl.module("JSONDataset",["System","Types","JS","DB","Classes","SysUtils","TypInfo","fpexprpars"],(function(){"use strict";var t=this;this.TJSONRowType={0:"rtJSONObject",rtJSONObject:0,1:"rtJSONArray",rtJSONArray:1},rtl.createClass(this,"TJSONFieldMapper",pas.System.TObject,(function(){this.CopyRow=function(t){return JSON.parse(JSON.stringify(t))},this.GetJSONDataForField$1=function(t,e){return this.GetJSONDataForField(t.FFieldName,t.GetIndex(),e)},this.SetJSONDataForField$1=function(t,e,i){this.SetJSONDataForField(t.FFieldName,t.GetIndex(),e,i)}})),rtl.createClass(this,"TJSONDateField",pas.DB.TDateField,(function(){this.$init=function(){pas.DB.TDateField.$init.call(this),this.FDateFormat=""},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("DateFormat",0,rtl.string,"FDateFormat","FDateFormat")})),rtl.createClass(this,"TJSONTimeField",pas.DB.TTimeField,(function(){this.$init=function(){pas.DB.TTimeField.$init.call(this),this.FTimeFormat=""},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("TimeFormat",0,rtl.string,"FTimeFormat","FTimeFormat")})),rtl.createClass(this,"TJSONDateTimeField",pas.DB.TDateTimeField,(function(){this.$init=function(){pas.DB.TDateTimeField.$init.call(this),this.FDateTimeFormat=""},rtl.addIntf(this,pas.System.IUnknown),this.$rtti.addProperty("DateTimeFormat",0,rtl.string,"FDateTimeFormat","FDateTimeFormat")})),rtl.createClass(this,"TFieldComparer",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FDesc=!1,this.FValue=void 0,this.FField=null,this.FOptions={},this.FDataset=null},this.$final=function(){this.FField=void 0,this.FOptions=void 0,this.FDataset=void 0,pas.System.TObject.$final.call(this)},this.Create$1=function(t,e,i,s){return this.FField=e,this.FValue=i,this.FOptions=rtl.refSet(s),this.FDataset=t,this},this.GetFieldValue=function(t){return this.FDataset.FFieldMapper.GetJSONDataForField$1(this.FField,this.FDataset.FRows[t])},this.CompareRows=function(t,e){return this.Compare(t,this.GetFieldValue(e))},this.Compare$1=function(t){return this.Compare(t,this.FValue)}})),rtl.createClass(this,"TStringFieldComparer",this.TFieldComparer,(function(){this.Compare=function(t,e){var i,s="";return s=""+this.GetFieldValue(t),i=""+e,1 in this.FOptions&&(s=pas.System.Copy(s,1,i.length)),0 in this.FOptions?pas.SysUtils.CompareText(s,i):pas.SysUtils.CompareStr(s,i)}})),rtl.createClass(this,"TNativeIntFieldComparer",this.TFieldComparer,(function(){this.Compare=function(t,e){return rtl.trunc(this.GetFieldValue(t))-rtl.trunc(e)}})),rtl.createClass(this,"TBooleanFieldComparer",this.TFieldComparer,(function(){this.Compare=function(t,e){return!(0==this.GetFieldValue(t))+0-(!(0==e)+0)}})),rtl.createClass(this,"TDateTimeFieldComparer",this.TFieldComparer,(function(){this.Compare=function(t,e){var i,s,n=this;function o(t){return pas.JS.isDate(t)?pas.SysUtils.JSDateToDateTime(t):n.FDataset.ConvertDateTimeField(""+t,n.FField)}return i=o(this.GetFieldValue(t)),s=o(e),Math.round(i-s)}})),rtl.createClass(this,"TFloatFieldComparer",this.TFieldComparer,(function(){this.Compare=function(t,e){var i,s;return i=rtl.getNumber(this.GetFieldValue(t)),s=rtl.getNumber(e),Math.round(i-s)}})),rtl.createClass(this,"TRecordComparer",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FDataset=null,this.FIndexBased=!1,this.FItems=[],this.FOptions={},this.FValues=[]},this.$final=function(){this.FDataset=void 0,this.FItems=void 0,this.FOptions=void 0,this.FValues=void 0,pas.System.TObject.$final.call(this)},this.ConstructItems=function(t){var e=null,i=null,s=null,n=0;e=pas.Classes.TFPList.$create("Create");try{if(this.FDataset.GetFieldList$1(e,t),!this.FIndexBased&&e.FCount!==rtl.length(this.FValues))throw pas.DB.EDatabaseError.$create("CreateFmt",["Array of values has different length (%d) from array of fields (%d)",pas.System.VarRecs(19,rtl.length(this.FValues),0,e.FCount)]);this.FItems=rtl.arraySetLength(this.FItems,null,e.FCount);for(var o=0,r=e.FCount-1;o<=r;o++){if(n=o,s=rtl.getObject(e.Get(n)),null===(i=this.DataTypeToComparerClass(s.FDataType)))throw pas.DB.EDatabaseError.$create("CreateFmt",["Cannot locate on field %s of type %s)",pas.System.VarRecs(18,s.FFieldName,18,pas.TypInfo.GetEnumName(pas.DB.$rtti.TFieldType,s.FDataType))]);this.FIndexBased?this.FItems[n]=i.$create("Create$1",[this.FDataset,s,null,rtl.refSet(this.FOptions)]):this.FItems[n]=i.$create("Create$1",[this.FDataset,s,this.FValues[n],rtl.refSet(this.FOptions)])}}finally{e=rtl.freeLoc(e)}},this.DataTypeToComparerClass=function(e){var i=e;return 11===i||12===i||1===i?t.TStringFieldComparer:9===i||2===i||3===i?t.TNativeIntFieldComparer:4===i?t.TBooleanFieldComparer:5===i?t.TFloatFieldComparer:6===i||7===i||8===i?t.TDateTimeFieldComparer:null},this.Compare=function(t){var e,i=0,s=0;for(i=0,s=0,e=rtl.length(this.FItems);0===i&&s<e;)i=this.FItems[s].Compare$1(t),s+=1;return i},this.CompareRows=function(t,e){var i,s=0,n=0;for(s=0,n=0,i=rtl.length(this.FItems);0===s&&n<i;)0!==(s=this.FItems[n].CompareRows(t,e))&&this.FItems[n].FDesc&&(s=-s),n+=1;return s},this.updateFromIndex=function(t){var e=null,i=0;e=pas.Classes.TFPList.$create("Create");try{if(""!==t.FCaseinsFields){this.FDataset.GetFieldList$1(e,t.FCaseinsFields);for(var s=0,n=rtl.length(this.FItems)-1;s<=n;s++)i=s,-1!==e.IndexOf(this.FItems[i].FField)&&(this.FItems[i].FOptions=rtl.unionSet(this.FItems[i].FOptions,rtl.createSet(0)))}e.Clear(),this.FDataset.GetFieldList$1(e,t.FDescFields);for(var o=0,r=rtl.length(this.FItems)-1;o<=r;o++)i=o,this.FItems[i].FDesc=2 in t.FOptions||-1!==e.IndexOf(this.FItems[i].FField)}finally{e=rtl.freeLoc(e)}},this.Create$1=function(t,e,i,s){return this.FDataset=t,rtl.isArray(i)?this.FValues=i:(this.FValues=rtl.arraySetLength(this.FValues,void 0,1),this.FValues[0]=i),this.FOptions=rtl.refSet(s),this.ConstructItems(e),this},this.Create$2=function(t,e){return this.FDataset=t,this.FIndexBased=!0,3 in e.FOptions&&(this.FOptions=rtl.createSet(0)),this.ConstructItems(e.FFields),this.updateFromIndex(e),this},this.Destroy=function(){for(var t=0,e=0,i=rtl.length(this.FItems)-1;e<=i;e++)t=e,rtl.free(this.FItems,t);pas.System.TObject.Destroy.call(this)}})),rtl.createClass(this,"TJSONIndex",pas.System.TObject,(function(){this.$init=function(){pas.System.TObject.$init.call(this),this.FList=null,this.FRows=null,this.FDataset=null},this.$final=function(){this.FList=void 0,this.FRows=void 0,this.FDataset=void 0,pas.System.TObject.$final.call(this)},this.GetRecordIndex=function(t){return pas.JS.isUndefined(this.FList[t])?-1:rtl.trunc(this.FList[t])},this.GetCount=function(){return this.FList.length},this.ClearIndex=function(){this.FList.length=0},this.Create$1=function(t,e){return this.FRows=e,this.FList=new Array(this.FRows.length),this.FDataset=t,this.CreateIndex(),this},this.Insert=function(t,e){return this.Append(e)}})),rtl.createClass(this,"TDefaultJSONIndex",this.TJSONIndex,(function(){this.CreateIndex=function(){for(var t=0,e=0,i=this.FRows.length-1;e<=i;e++)t=e,this.FList[t]=t},this.AppendToIndex=function(){var t,e=0;t=this.FList.length,this.FList.length=this.FRows.length;for(var i=t,s=this.FRows.length-1;i<=s;i++)e=i,this.FList[e]=e},this.Append=function(t){return this.FList.push(t)-1},this.Insert=function(t,e){return this.FList.splice(t,0,e),t},this.FindRecord=function(t){return this.FList.indexOf(t)},this.Update=function(t){return t}})),rtl.createClass(this,"TSortedJSONIndex",this.TJSONIndex,(function(){this.$init=function(){t.TJSONIndex.$init.call(this),this.FComparer=null,this.FUnique=!1},this.$final=function(){this.FComparer=void 0,t.TJSONIndex.$final.call(this)},this.FindPos=function(t){var e=0,i=0,s=0,n=0,o=0;if(null==this.FComparer)return e;for(i=0,s=this.GetCount()-1;i<=s;)n=i+rtl.trunc((s-i)/2),(o=this.FComparer.CompareRows(t,rtl.trunc(this.FList[n])))>0?i=n+1:(s=n-1,0===o&&this.FUnique&&(i=n));return e=i},this.MergeSort=function(t){var e,i=null,s=null,n=0,o=0,r=0,a=0,l=0,h=0,F=0,p=0;if(null===t)return null;if(e=t.length,i=new Array(e),0===e)return i;for(l=1;;){for(n=0,a=0,h=0;n<e;){for(h+=1,l<(F=e-n)&&(F=l),o=n+F,p=l;F>0||p>0&&o<e;)0===F?(r=o,o+=1,p-=1):0===p||o>=e||this.FComparer.CompareRows(rtl.trunc(t[n]),rtl.trunc(t[o]))<=0?(r=n,n+=1,F-=1):(r=o,o+=1,p-=1),i[a]=t[r],a+=1;n=o}if(h<=1)return i;l*=2,s=i,i=t,t=s}return i},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FComparer},set:function(t){this.p.FComparer=t}}),pas.System.TObject.Destroy.call(this)},this.CreateComparer=function(e){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FComparer},set:function(t){this.p.FComparer=t}}),this.FComparer=t.TRecordComparer.$create("Create$2",[this.FDataset,e])},this.CreateIndex=function(){var t,e=[],i=0,s=0;if(null!==this.FComparer){t=this.FRows.length,e=rtl.arraySetLength(e,0,t),s=0;for(var n=0,o=t-1;n<=o;n++)i=n,pas.JS.isUndefined(this.FRows[i])||(e[s]=i,s+=1);e=rtl.arraySetLength(e,0,s),this.FList=this.MergeSort(e)}},this.AppendToIndex=function(){this.CreateIndex()},this.Append=function(t){var e;return e=this.FindPos(t),this.FList.splice(e,0,t),e},this.FindRecord=function(t){return this.FList.indexOf(t)},this.Update=function(t){var e,i;return i=this.FindRecord(t),(e=this.FindPos(t))!==i&&this.FList.splice(e,0,this.FList.splice(i,1)[0]),e}})),rtl.createClass(this,"TJSONIndexDef",pas.DB.TIndexDef,(function(){this.$init=function(){pas.DB.TIndexDef.$init.call(this),this.FIndex=null},this.$final=function(){this.FIndex=void 0,pas.DB.TIndexDef.$final.call(this)},this.ClearIndex=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FIndex},set:function(t){this.p.FIndex=t}})},this.BuildIndex=function(e){null===this.FIndex?this.FIndex=t.TSortedJSONIndex.$create("Create$1",[e,e.FRows]):this.FIndex.ClearIndex(),this.FIndex.CreateComparer(this),this.FIndex.CreateIndex()}})),rtl.createClass(this,"TJSONIndexDefs",pas.DB.TIndexDefs,(function(){this.GetD=function(e){return rtl.as(this.GetItem$1(e),t.TJSONIndexDef)}})),this.TBlobFormat={0:"bfHex",bfHex:0,1:"bfBase64",bfBase64:1,2:"bfBytes",bfBytes:2,3:"bfCustom",bfCustom:3},rtl.createClass(this,"TBaseJSONDataSet",pas.DB.TDataSet,(function(){this.$init=function(){pas.DB.TDataSet.$init.call(this),this.FActiveIndex="",this.FBlobFormat=0,this.FIndexes=null,this.FOnDecodeBlobValue=null,this.FOnEncodeBlobValue=null,this.FOwnsData=!1,this.FDefaultIndex=null,this.FCurrentIndex=null,this.FCurrent=0,this.FMetaData=null,this.FRows=null,this.FDeletedRows=null,this.FFieldMapper=null,this.FEditIdx=0,this.FEditRow=void 0,this.FFilterRow=void 0,this.FUseDateTimeFormatFields=!1,this.FRowType=0,this.FFilterExpression=null},this.$final=function(){this.FIndexes=void 0,this.FOnDecodeBlobValue=void 0,this.FOnEncodeBlobValue=void 0,this.FDefaultIndex=void 0,this.FCurrentIndex=void 0,this.FMetaData=void 0,this.FRows=void 0,this.FDeletedRows=void 0,this.FFieldMapper=void 0,this.FFilterExpression=void 0,pas.DB.TDataSet.$final.call(this)},this.GetFilterField=function(t){var e=pas.fpexprpars.TFPExpressionResult.$new(),i=null,s=0;i=this.FieldByName(t),e.ResultType=this.FieldTypeToExpressionType(i.FDataType);var n=e.ResultType;return 0===n?e.resValue=i.GetAsBoolean():1===n?e.resValue=i.GetAsLargeInt():2===n?e.resValue=i.GetAsFloat():3===n?e.resValue=i.GetAsDateTime():4===n?e.resValue=i.GetAsString():5===n&&(s=1e4*i.GetAsFloat(),e.resValue=s/1e4),e},this.SetMetaData=function(t){this.CheckInactive(),this.FMetaData=t},this.RemoveCalcFields=function(t){for(var e=0,i=0,s=this.FFieldList.GetCount()-1;i<=s;i++)e=i,this.FFieldList.GetField(e).FFieldKind in rtl.createSet(1,3,2)&&this.FFieldMapper.RemoveField(this.FFieldList.GetField(e).FFieldName,this.FFieldList.GetField(e).GetIndex(),t)},this.ActivateIndex=function(e){var i=null;null===(i=""!==this.FActiveIndex?rtl.as(this.FIndexes.Find$1(this.FActiveIndex),t.TJSONIndexDef):null)?this.FCurrentIndex=this.FDefaultIndex:(null===i.FIndex&&e&&i.BuildIndex(this),this.FCurrentIndex=i.FIndex),this.GetActive()&&this.Resync(rtl.createSet(1))},this.FieldTypeToExpressionType=function(t){var e=0;return 11===t||12===t||1===t?e=4:2===t||9===t||3===t?e=1:4===t?e=0:5===t?e=2:6===t||7===t||8===t?e=3:pas.DB.DatabaseErrorFmt$1("Fields of type %s are not supported in filter expressions.",pas.System.VarRecs(18,pas.DB.Fieldtypenames[t]),this),e},this.GetFilterIsNull=function(t){var e=pas.fpexprpars.TFPExpressionResult.$new();return e.ResultType=0,e.resValue=this.FieldByName(""+t[0].resValue).GetIsNull(),e},this.FilterExpressionClass=function(){return pas.fpexprpars.TFPExpressionParser},this.CreateFilterExpression=function(){var t=null,e=0;t=this.FilterExpressionClass().$create("Create$1",[this]);for(var i=0,s=this.FFieldList.GetCount()-1;i<=s;i++)e=i,t.FIdentifiers.AddVariable(this.FFieldList.GetField(e).FFieldName,this.FieldTypeToExpressionType(this.FFieldList.GetField(e).FDataType),rtl.createCallback(this,"GetFilterField"));return t.FIdentifiers.AddFunction("IsNull","B","S",rtl.createCallback(this,"GetFilterIsNull")),t.SetExpression(this.FFilterText),t},this.DoFilterRecord=function(){var t,e=!1;e=!0,t=this.SetTempState(6);try{if(null!=this.FOnFilterRecord&&(this.FOnFilterRecord(this,{get:function(){return e},set:function(t){e=t}}),!e))return e;if(!this.FFiltered||""===this.FFilterText)return e;null===this.FFilterExpression&&(this.FFilterExpression=this.CreateFilterExpression()),e=this.FFilterExpression.GetAsBoolean()}finally{this.RestoreState(t)}return e},this.CreateIndexDefs=function(){return t.TJSONIndexDefs.$create("create$3",[this,this,t.TJSONIndexDef])},this.RecordComparerClass=function(){return t.TRecordComparer},this.LocateRecordIndex=function(t,e,i){var s=0,n=null,o=0,r=0;s=-1,n=this.RecordComparerClass().$create("Create$1",[this,t,e,rtl.refSet(i)]);try{r=2 in i?this.FCurrent:0,o=this.FCurrentIndex.GetRecordIndex(r);for(;-1===s&&-1!==o;)0===n.Compare(o)&&(s=o),r+=1,o=this.FCurrentIndex.GetRecordIndex(r)}finally{n=rtl.freeLoc(n)}return s},this.AllocRecordBuffer=function(){var t=pas.DB.TDataRecord.$new();return t.data=new Object,t.bookmark=null,t.state=0,t},this.FreeRecordBuffer=function(t){t.data=null,t.bookmark=null,t.state=0},this.InternalInitRecord=function(t){t.data=this.FFieldMapper.CreateRow(),t.bookmark=null,t.state=0},this.GetRecord=function(t,e,i){var s=0,n=0,o=!1;s=0;do{o=!0;var r=e;1===r?this.FCurrent<this.FCurrentIndex.GetCount()-1?this.FCurrent+=1:s=2:2===r?this.FCurrent>0?this.FCurrent-=1:s=1:0===r&&(this.FCurrent<0||this.FCurrent>=this.FCurrentIndex.GetCount())&&(s=2),0===s&&(n=this.FCurrentIndex.GetRecordIndex(this.FCurrent),t.data=this.FRows[n],t.bookmarkFlag=0,t.bookmark=n,this.GetCalcFields(t),this.FFiltered&&(this.FFilterRow=t.data,(o=this.DoFilterRecord())||0!==e||(o=!0,s=2)))}while(!o);return s},this.AddToRows=function(t){null===this.FRows?this.FRows=t:(this.FRows=this.FRows.concat(t),this.AppendToIndexes())},this.InternalClose=function(){this.BindFields(!1),this.FDefaultFields&&this.DestroyFields(),this.FreeData()},this.InternalFirst=function(){this.FCurrent=-1},this.InternalLast=function(){this.FCurrent=this.FCurrentIndex.GetCount()},this.InternalOpen=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FFieldMapper},set:function(t){this.p.FFieldMapper=t}}),this.FFieldMapper=this.CreateFieldMapper(),null===this.FRows&&(this.FRows=new Array,this.FOwnsData=!0),this.CreateIndexes(),this.InternalInitFieldDefs(),this.FDefaultFields&&this.CreateFields(),this.BindFields(!0),this.InitDateTimeFields(),""!==this.FActiveIndex&&this.ActivateIndex(!0),this.FCurrent=-1},this.InternalPost=function(){var t=0,e=0,i=0,s=0,n=pas.DB.TBookmark.$new();if(i=-1,this.GetBookmarkData(pas.DB.TDataRecord.$clone(this.ActiveBuffer()),n),3===this.FState)if(s=this.FRows.push(this.FEditRow)-1,2===this.GetBookmarkFlag(pas.DB.TDataRecord.$clone(this.ActiveBuffer()))){this.FDefaultIndex.Append(s);for(var o=0,r=this.FIndexes.GetCount()-1;o<=r;o++)t=o,null!=this.FIndexes.GetD(t).FIndex&&(e=this.FIndexes.GetD(t).FIndex.Append(s),this.FIndexes.GetD(t).FIndex===this.FCurrentIndex&&(i=e))}else{this.FCurrent=this.FDefaultIndex.Insert(this.FCurrent,s);for(var a=0,l=this.FIndexes.GetCount()-1;a<=l;a++)t=a,null!=this.FIndexes.GetD(t).FIndex&&(e=this.FIndexes.GetD(t).FIndex.Append(s),this.FIndexes.GetD(t).FIndex===this.FCurrentIndex&&(i=e))}else{-1===this.FEditIdx&&pas.DB.DatabaseErrorFmt("Failed to retrieve record index for record %d",pas.System.VarRecs(0,this.FCurrent)),s=this.FEditIdx,this.FRows[s]=this.FEditRow,this.FDefaultIndex.Update(s);for(var h=0,F=this.FIndexes.GetCount()-1;h<=F;h++)t=h,e=this.FCurrentIndex.Update(s),null!=this.FIndexes.GetD(t).FIndex&&this.FIndexes.GetD(t).FIndex===this.FCurrentIndex&&(i=e)}-1!==i&&(this.FCurrent=i),this.FEditIdx=-1,this.FEditRow=null},this.InternalInsert=function(){var t=0,e=null;this.FEditRow=this.ActiveBuffer().data;for(var i=0,s=this.FFieldDefs.GetCount()-1;i<=s;i++)t=i,e=this.FFieldDefs.GetItem$1(t),this.FFieldMapper.SetJSONDataForField(e.FName,e.GetIndex(),this.FEditRow,null)},this.InternalCancel=function(){this.FEditIdx=-1,this.FEditRow=null},this.InternalInitFieldDefs=function(){if(null!=this.FMetaData&&this.MetaDataToFieldDefs(),0===this.FFieldDefs.GetCount())throw t.EJSONDataset.$create("Create$1",["No fields found"])},this.InternalSetToRecord=function(t){this.FCurrent=this.FCurrentIndex.FindRecord(rtl.trunc(t.bookmark))},this.GetFieldClass=function(e){var i=null;if(this.FUseDateTimeFormatFields&&e in rtl.createSet(6,8,7)){var s=e;6===s?i=t.TJSONDateField:8===s?i=t.TJSONDateTimeField:7===s&&(i=t.TJSONTimeField)}else i=pas.DB.TDataSet.GetFieldClass.call(this,e);return i},this.GetApplyUpdateData=function(t){var e;return e=this.FFieldMapper.CopyRow(t.data),this.RemoveCalcFields(e),e},this.IsCursorOpen=function(){return null!=this.FDefaultIndex},this.GetBookmarkData=function(t,e){e.Data=t.bookmark},this.GetBookmarkFlag=function(t){return t.bookmarkFlag},this.SetBookmarkFlag=function(t,e){t.bookmarkFlag=e},this.SetBookmarkData=function(t,e){t.bookmark=e.Data},this.FreeData=function(){var t=0;this.FOwnsData&&(this.FRows=null,this.FMetaData=null);for(var e=0,i=this.FIndexes.GetCount()-1;e<=i;e++)t=e,this.FIndexes.GetD(t).ClearIndex();this.FCurrentIndex=null,pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FDefaultIndex},set:function(t){this.p.FDefaultIndex=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FFieldMapper},set:function(t){this.p.FFieldMapper=t}}),this.FCurrentIndex=null,this.FDeletedRows=null},this.AppendToIndexes=function(){this.FDefaultIndex.AppendToIndex(),null!=this.FCurrentIndex&&this.FCurrentIndex!==this.FDefaultIndex&&this.FCurrentIndex.AppendToIndex()},this.CreateIndexes=function(){this.FDefaultIndex=t.TDefaultJSONIndex.$create("Create$1",[this,this.FRows]),this.AppendToIndexes(),null===this.FCurrentIndex&&(this.FCurrentIndex=this.FDefaultIndex)},this.InitDateTimeFields=function(){},this.ConvertDateTimeField=function(e,i){var s="";s="";var n=i.FDataType;return 6===n?t.TJSONDateField.isPrototypeOf(i)&&(s=rtl.as(i,t.TJSONDateField).FDateFormat):7===n?t.TJSONTimeField.isPrototypeOf(i)&&(s=rtl.as(i,t.TJSONTimeField).FTimeFormat):8===n&&t.TJSONDateTimeField.isPrototypeOf(i)&&(s=rtl.as(i,t.TJSONDateTimeField).FDateTimeFormat),""===s?this.$class.DefaultConvertToDateTime(i,e,!0):pas.DateUtils.ScanDateTime(s,e,1)},this.FormatDateTimeField=function(e,i){var s="";s="";var n=i.FDataType;return 6===n?t.TJSONDateField.isPrototypeOf(i)&&(s=i.FDateFormat):7===n?t.TJSONTimeField.isPrototypeOf(i)&&(s=i.FTimeFormat):8===n&&t.TJSONDateTimeField.isPrototypeOf(i)&&(s=i.FDateTimeFormat),""===s?pas.DateUtils.DateTimeToRFC3339(e):pas.SysUtils.FormatDateTime(s,e)},this.CreateFieldMapper=function(){return 1===this.FRowType?t.TJSONArrayFieldMapper.$create("Create"):t.TJSONObjectFieldMapper.$create("Create")},this.Create$1=function(t){return pas.DB.TDataSet.Create$1.apply(this,arguments),this.FOwnsData=!0,this.FUseDateTimeFormatFields=!1,this.FEditIdx=-1,this.FIndexes=this.CreateIndexDefs(),this},this.Destroy=function(){this.Close(),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FFilterExpression},set:function(t){this.p.FFilterExpression=t}}),pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FIndexes},set:function(t){this.p.FIndexes=t}}),this.FEditIdx=-1,pas.DB.TDataSet.Destroy.call(this)},this.BlobDataToBytes=function(t){var e=[];e=[];var i=this.FBlobFormat;return 0===i?e=this.$class.DefaultBlobDataToBytes(t):1===i?e=pas.SysUtils.BytesOf(atob(""+t)):2===i?e=t:3===i&&null!=this.FOnDecodeBlobValue&&this.FOnDecodeBlobValue(this,t,{get:function(){return e},set:function(t){e=t}}),e},this.BytesToBlobData=function(t){var e=void 0;e="";var i=this.FBlobFormat;return 0===i?e=this.$class.DefaultBytesToBlobData(rtl.arrayRef(t)):1===i?e=btoa(pas.SysUtils.StringOf(t)):2===i?e=t:3===i&&null!=this.FOnEncodeBlobValue&&this.FOnEncodeBlobValue(this,rtl.arrayRef(t),{get:function(){return e},set:function(t){e=t}}),e},this.ConvertDateTimeToNative=function(t,e){return isNaN(e)?null:this.FormatDateTimeField(e,t)},this.Lookup=function(t,e,i){var s=void 0,n=0,o=0,r=null,a=[];s=null,r=pas.Classes.TFPList.$create("Create");try{if(this.GetFieldList$1(r,i),s=pas.DB.TDataSet.Lookup.call(this,t,e,i),-1!==(n=this.LocateRecordIndex(t,e,{}))){a=rtl.arraySetLength(a,void 0,r.FCount);for(var l=0,h=r.FCount-1;l<=h;l++)a[o=l]=this.FFieldMapper.GetJSONDataForField$1(rtl.getObject(r.Get(o)),this.FRows[n]);s=1===r.FCount?a[o]:a}}finally{r=rtl.freeLoc(r)}return s},this.GetFieldData$1=function(t,e){var i=void 0,s=void 0;if(this.FState in rtl.createSet(5,11))s=this.FCalcBuffer.data;else if(6===this.FState)s=this.FFilterRow;else if(this.FEditIdx==e.bookmark)s=8===this.FState?e.data:this.FEditRow;else{if(8===this.FState)return null;s=e.data}return i=this.FFieldMapper.GetJSONDataForField$1(t,s),pas.JS.isUndefined(i)&&(i=null),i},this.SetFieldData$1=function(t,e,i){var s=void 0;s=this.FState in rtl.createSet(5,11)?this.FCalcBuffer.data:this.FEditRow,this.FFieldMapper.SetJSONDataForField$1(t,s,i),this.FState in rtl.createSet(5,11,6,7)||this.DataEvent(0,t),this.SetModified(!0)},this.CompareBookmarks=function(t,e){return rtl.isNumber(t.Data)&&rtl.isNumber(e.Data)?rtl.trunc(e.Data)-rtl.trunc(t.Data):rtl.isNumber(t.Data)?-1:rtl.isNumber(e.Data)?1:0},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TJSONObjectFieldMapper",this.TJSONFieldMapper,(function(){this.RemoveField=function(t,e,i){pas.JS.JSDelete(i,t)},this.SetJSONDataForField=function(t,e,i,s){i[t]=s},this.GetJSONDataForField=function(t,e,i){return null!=i?i[t]:void 0},this.CreateRow=function(){return new Object}})),rtl.createClass(this,"TJSONArrayFieldMapper",this.TJSONFieldMapper,(function(){this.RemoveField=function(t,e,i){i.splice(e,1)},this.SetJSONDataForField=function(t,e,i,s){i[e]=s},this.GetJSONDataForField=function(t,e,i){return i[e]},this.CreateRow=function(){return new Array}})),rtl.createClass(this,"EJSONDataset",pas.DB.EDatabaseError,(function(){}))}),["DateUtils"]),rtl.module("WEBLib.REST",["System","Classes","Web","JS","SysUtils","WEBLib.Controls","WEBLib.JSON"],(function(){"use strict";var t=this;this.THTTPCommand={0:"httpGET",httpGET:0,1:"httpPOST",httpPOST:1,2:"httpPUT",httpPUT:2,3:"httpDELETE",httpDELETE:3,4:"httpHEAD",httpHEAD:4,5:"httpPATCH",httpPATCH:5,6:"httpCUSTOM",httpCUSTOM:6},this.$rtti.$Enum("THTTPCommand",{minvalue:0,maxvalue:6,ordtype:1,enumtype:this.THTTPCommand}),this.THTTPRequestResponseType={0:"rtDefault",rtDefault:0,1:"rtText",rtText:1,2:"rtBlob",rtBlob:2,3:"rtJSON",rtJSON:3,4:"rtDocument",rtDocument:4,5:"rtArrayBuffer",rtArrayBuffer:5},this.$rtti.$Enum("THTTPRequestResponseType",{minvalue:0,maxvalue:5,ordtype:1,enumtype:this.THTTPRequestResponseType}),this.$rtti.$MethodVar("THttpResponse",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["AResponse",rtl.string]]),methodkind:0}),rtl.createClass(this,"TPersistTokens",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FKey="",this.FEnabled=!1},this.Create$1=function(){return this.FEnabled=!1,this.FKey="",this},this.Assign=function(e){t.TPersistTokens.isPrototypeOf(e)&&(this.FKey=rtl.as(e,t.TPersistTokens).FKey,this.FEnabled=rtl.as(e,t.TPersistTokens).FEnabled)};var e=this.$rtti;e.addProperty("Key",0,rtl.string,"FKey","FKey"),e.addProperty("Enabled",0,rtl.boolean,"FEnabled","FEnabled",{Default:!1})})),rtl.createClass(this,"TRESTApp",pas.Classes.TPersistent,(function(){this.$init=function(){pas.Classes.TPersistent.$init.call(this),this.FKey="",this.FCallbackURL="",this.FSecret=""},this.Assign=function(e){t.TRESTApp.isPrototypeOf(e)&&(this.FKey=rtl.as(e,t.TRESTApp).FKey,this.FCallbackURL=rtl.as(e,t.TRESTApp).FCallbackURL,this.FSecret=rtl.as(e,t.TRESTApp).FSecret)};var e=this.$rtti;e.addProperty("Key",0,rtl.string,"FKey","FKey"),e.addProperty("CallbackURL",0,rtl.string,"FCallbackURL","FCallbackURL"),e.addProperty("Secret",0,rtl.string,"FSecret","FSecret")})),this.TAuthLocale={0:"lcDefault",lcDefault:0,1:"lcEnglish",lcEnglish:1,2:"lcDutch",lcDutch:2,3:"lcGerman",lcGerman:3,4:"lcFrench",lcFrench:4,5:"lcSpanish",lcSpanish:5,6:"lcItalian",lcItalian:6,7:"lcPortuguese",lcPortuguese:7,8:"lcGreek",lcGreek:8,9:"lcDanish",lcDanish:9,10:"lcRussian",lcRussian:10,11:"lcRomanian",lcRomanian:11,12:"lcSwedish",lcSwedish:12,13:"lcFinnish",lcFinnish:13,14:"lcTurkish",lcTurkish:14,15:"lcJapanese",lcJapanese:15},rtl.createClass(this,"TRESTClient",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FOnAccessToken=null,this.FOnResponse=null,this.FPersistTokens=null,this.FApp=null,this.FScopes=null,this.FLocale=0,this.FOnRequestResponse=null,this.FOnError=null,this.FResponseType=0},this.$final=function(){this.FOnAccessToken=void 0,this.FOnResponse=void 0,this.FPersistTokens=void 0,this.FApp=void 0,this.FScopes=void 0,this.FOnRequestResponse=void 0,this.FOnError=void 0,pas.Classes.TComponent.$final.call(this)},this.SetPersistTokens=function(t){this.FPersistTokens.Assign(t)},this.SetApp=function(t){this.FApp.Assign(t)},this.SetScopes=function(t){this.FScopes.Assign(t)},this.InstallCallback=function(){var t=document.createElement("script");t.innerHTML=' function processAuthData(access_token) {var event = new CustomEvent("oauthcallback", {\r            detail: {\r                 message: access_token\r            },\r  bubbles: true,\r  cancelable: true});\r  document.dispatchEvent(event);}',document.head.appendChild(t);var e=document.createElement("script");return e.async=!0,e.defer=!0,e.type="text/javascript",document.body.appendChild(e),!0,!0},this.Create$1=function(e){return pas.Classes.TComponent.Create$1.apply(this,arguments),this.FPersistTokens=t.TPersistTokens.$create("Create$1"),this.FApp=t.TRESTApp.$create("Create"),this.FScopes=pas.Classes.TStringList.$create("Create$1"),this.FLocale=0,this.FResponseType=0,this},this.Destroy=function(){rtl.free(this,"FApp"),rtl.free(this,"FScopes"),rtl.free(this,"FPersistTokens"),pas.Classes.TComponent.Destroy.call(this)},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("App",2,t.$rtti.TRESTApp,"FApp","SetApp"),e.addProperty("PersistTokens",2,t.$rtti.TPersistTokens,"FPersistTokens","SetPersistTokens"),e.addProperty("ResponseType",0,t.$rtti.THTTPRequestResponseType,"FResponseType","FResponseType",{Default:t.THTTPRequestResponseType.rtDefault}),e.addProperty("Scopes",2,pas.Classes.$rtti.TStrings,"FScopes","SetScopes"),e.addProperty("OnAccessToken",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FOnAccessToken","FOnAccessToken"),e.addProperty("OnRequestResponse",0,pas["WEBLib.Controls"].$rtti.THTTPRequestResponseEvent,"FOnRequestResponse","FOnRequestResponse"),e.addProperty("OnResponse",0,t.$rtti.THttpResponse,"FOnResponse","FOnResponse"),e.addProperty("OnError",0,pas["WEBLib.Controls"].$rtti.THTTPErrorEvent,"FOnError","FOnError")})),this.HTTPCommand=function(t,e){var i="";return 0===t?i="GET":1===t?i="POST":2===t?i="PUT":3===t?i="DELETE":4===t?i="HEAD":5===t?i="PATCH":6===t&&(i=e),i},t.$init=function(){t.TRESTClient.InstallCallback()}}),[]),rtl.module("WEBLib.CDS",["System","Classes","DB","JSONDataset","Web","JS","WEBLib.Controls","WEBLib.REST"],(function(){"use strict";var t=this,e=t.$impl;this.$rtti.$MethodVar("TConnectErrorEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ErrorCode",rtl.longint]]),methodkind:0}),this.TURLType={0:"utGet",utGet:0,1:"utPost",utPost:1,2:"utPut",utPut:2,3:"utDelete",utDelete:3},this.$rtti.$Enum("TURLType",{minvalue:0,maxvalue:3,ordtype:1,enumtype:this.TURLType}),this.$rtti.$MethodVar("TClientConnectionGetURLEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Dataset",pas.DB.$rtti.TDataSet],["urlType",this.$rtti.TURLType],["URL",rtl.string,1]]),methodkind:0}),this.$rtti.$MethodVar("TGetUpdatePayloadEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Dataset",pas.DB.$rtti.TDataSet],["urlType",this.$rtti.TURLType],["Data",rtl.jsvalue],["aPayLoad",rtl.string,4]]),methodkind:0}),this.$rtti.$MethodVar("TGetDataPayloadEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Dataset",pas.DB.$rtti.TDataSet],["urlType",this.$rtti.TURLType],["aPayLoad",rtl.jsvalue,1]]),methodkind:0}),this.$rtti.$MethodVar("TProcessMetaDataEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["Dataset",pas.DB.$rtti.TDataSet],["FieldDefs",pas.DB.$rtti.TFieldDefs],["aMetaData",pas.JS.$rtti.TJSObject]]),methodkind:0}),this.$rtti.$MethodVar("TDataReceivedEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ARequest",pas["WEBLib.Controls"].$rtti.TJSXMLHttpRequestRecord],["AResponse",rtl.string,1]]),methodkind:0}),rtl.createClass(this,"TClientConnection",pas.Classes.TComponent,(function(){this.$init=function(){pas.Classes.TComponent.$init.call(this),this.FDataProxy=null,this.FActive=!1,this.FURI="",this.FDS=null,this.FDataNode="",this.FAutoOpen=!1,this.FUpdateCount=0,this.FOnConnectError=null,this.FBeforeConnect=null,this.FAfterConnect=null,this.FHeaders=null,this.FPassword="",this.FUser="",this.FOnGetURL=null,this.FPageParam="",this.FOnGetUpdatePayLoad=null,this.FAppendKeyToURL=!1,this.FOnGetDataPayLoad=null,this.FMetaDataNode="",this.FOnProcessMetaData=null,this.FOnDataReceived=null,this.FXHR=null,this.FCommand=0,this.FCustomCommand="",this.FPostData=""},this.$final=function(){this.FDataProxy=void 0,this.FDS=void 0,this.FOnConnectError=void 0,this.FBeforeConnect=void 0,this.FAfterConnect=void 0,this.FHeaders=void 0,this.FOnGetURL=void 0,this.FOnGetUpdatePayLoad=void 0,this.FOnGetDataPayLoad=void 0,this.FOnProcessMetaData=void 0,this.FOnDataReceived=void 0,this.FXHR=void 0,pas.Classes.TComponent.$final.call(this)},this.SetHeaders=function(t){this.FHeaders.Assign(t)},this.GetPageURL=function(t){var e="";return e=this.GetReadBaseURL(t),""!==this.FPageParam&&(0!==pas.System.Pos("?",e)?e+="&":e+="?",e=e+this.FPageParam+"="+pas.SysUtils.IntToStr(t.FRequestID-1)),e},this.GetDataProxy=function(){return null===this.FDataProxy&&(this.FDataProxy=this.DoGetDataProxy()),this.FDataProxy},this.SetDataNode=function(t){this.FDataNode!==t&&0===this.FUpdateCount&&this.SetActive(!1),this.FDataNode=t},this.SetURI=function(t){this.FURI!==t&&0===this.FUpdateCount&&this.SetActive(!1),this.FURI=t},this.onError=function(t){return null!=this.FOnConnectError&&this.FOnConnectError(this,this.FXHR.status),!0,!0},this.onAbort=function(t){return null!=this.FOnConnectError&&this.FOnConnectError(this,this.FXHR.status),!0,!0},this.onLoad=function(t){var e=pas["WEBLib.Controls"].TJSXMLHttpRequestRecord.$new(),i="";return null!=this.FOnDataReceived&&(e.req=this.FXHR,i=this.FXHR.responseText,this.FOnDataReceived(this,pas["WEBLib.Controls"].TJSXMLHttpRequestRecord.$clone(e),{get:function(){return i},set:function(t){i=t}})),!0,!0},this.SetActive=function(t){if(this.FActive!==t){if(this.FActive=t,this.FUpdateCount>0)return;if(0 in this.FComponentState)return;t?""!==this.FURI&&this.DoConnect():this.DoDisconnect()}},this.ProcessMetadata=function(t,e,i){null!=this.FOnProcessMetaData&&this.FOnProcessMetaData(this,t,e,i)},this.GetReadBaseURL=function(t){var e="";return e=this.FURI,null!=this.FOnGetURL&&this.FOnGetURL(this,t.FDataset,0,{get:function(){return e},set:function(t){e=t}}),e},this.RegisterDataSet=function(t){this.FDS=t},this.DoRequest=function(){var t;this.FXHR=new XMLHttpRequest,this.FXHR.addEventListener("load",rtl.createSafeCallback(this,"onLoad")),this.FXHR.addEventListener("abort",rtl.createSafeCallback(this,"onAbort")),this.FXHR.addEventListener("error",rtl.createSafeCallback(this,"onError")),t=pas["WEBLib.REST"].HTTPCommand(this.FCommand,this.FCustomCommand),this.FXHR.open(t,this.FURI),this.SetupRequest(this.FXHR),this.FXHR.setRequestHeader("content-type","application/json"),""!==this.FPostData?this.FXHR.send(this.FPostData):this.FXHR.send()},this.DoConnect=function(){null!=this.FDS?(this.DoBeforeConnect(),this.FAutoOpen?(this.FDS.SetActive(!1),this.FDS.Load({},null)):this.DoRequest()):this.DoRequest()},this.DoDisconnect=function(){null!=this.FDS&&this.FAutoOpen&&(this.FDS.SetActive(!1),this.FDS.FFieldDefs.Clear())},this.DoBeforeConnect=function(){null!=this.FBeforeConnect&&this.FBeforeConnect(this)},this.DoAfterConnect=function(){null!=this.FAfterConnect&&this.FAfterConnect(this)},this.DoError=function(t){throw null!=this.FOnConnectError&&this.FOnConnectError(this,t),pas.SysUtils.Exception.$create("Create$1",["Error connecting to URI "+this.FURI])},this.DoDataReceived=function(t,e){var i=pas["WEBLib.Controls"].TJSXMLHttpRequestRecord.$new();null!=this.FOnDataReceived&&(i.req=t,this.FOnDataReceived(this,pas["WEBLib.Controls"].TJSXMLHttpRequestRecord.$clone(i),e))},this.SetupRequest=function(t){var e=0,i="",s="";""!==this.FUser&&t.setRequestHeader("X-Requested-With","XMLHttpRequest");for(var n=0,o=this.FHeaders.GetCount()-1;n<=o;n++)e=n,this.FHeaders.GetNameValue(e,{get:function(){return i},set:function(t){i=t}},{get:function(){return s},set:function(t){s=t}}),t.setRequestHeader(i,s);""!==this.FUser&&t.setRequestHeader("Authorization","Basic "+window.btoa(this.FUser+":"+this.FPassword))},this.GetDataNode=function(){var t="";return""===(t=this.FDataNode)&&(t="data"),t},this.GetMetaDataNode=function(){var t="";return""===(t=this.FMetaDataNode)&&(t="metaData"),t},this.DoGetDataProxy=function(){return t.TWebClientDataProxy.$create("Create$1",[this])},this.Create$1=function(t){return pas.Classes.TComponent.Create$1.apply(this,arguments),this.FActive=!1,this.FDS=null,this.FAutoOpen=!0,this.FCommand=0,this.FHeaders=pas.Classes.TStringList.$create("Create$1"),this.FAppendKeyToURL=!0,this},this.Destroy=function(){rtl.free(this,"FHeaders"),pas.Classes.TComponent.Destroy.call(this)},this.BeginUpdate=function(){pas.Classes.TComponent.BeginUpdate.call(this),this.FUpdateCount+=1},this.EndUpdate=function(){pas.Classes.TComponent.EndUpdate.call(this),this.FUpdateCount>0&&(this.FUpdateCount-=1)},this.AfterLoadDFMValues=function(){pas.Classes.TComponent.AfterLoadDFMValues.call(this),this.FActive&&""!==this.FURI&&this.DoConnect()},rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Active",2,rtl.boolean,"FActive","SetActive"),e.addProperty("AppendKeyToURL",0,rtl.boolean,"FAppendKeyToURL","FAppendKeyToURL",{Default:!0}),e.addProperty("AutoOpenDataSet",0,rtl.boolean,"FAutoOpen","FAutoOpen",{Default:!0}),e.addProperty("Command",0,pas["WEBLib.REST"].$rtti.THTTPCommand,"FCommand","FCommand",{Default:pas["WEBLib.REST"].THTTPCommand.httpGET}),e.addProperty("CustomCommand",0,rtl.string,"FCustomCommand","FCustomCommand"),e.addProperty("DataNode",2,rtl.string,"FDataNode","SetDataNode"),e.addProperty("MetaDataNode",0,rtl.string,"FMetaDataNode","FMetaDataNode"),e.addProperty("PageParam",0,rtl.string,"FPageParam","FPageParam"),e.addProperty("PostData",0,rtl.string,"FPostData","FPostData"),e.addProperty("Headers",2,pas.Classes.$rtti.TStringList,"FHeaders","SetHeaders"),e.addProperty("Password",0,rtl.string,"FPassword","FPassword"),e.addProperty("User",0,rtl.string,"FUser","FUser"),e.addProperty("URI",2,rtl.string,"FURI","SetURI"),e.addProperty("AfterConnect",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FAfterConnect","FAfterConnect"),e.addProperty("BeforeConnect",0,pas["WEBLib.Controls"].$rtti.TNotifyEvent,"FBeforeConnect","FBeforeConnect"),e.addProperty("OnConnectError",0,t.$rtti.TConnectErrorEvent,"FOnConnectError","FOnConnectError"),e.addProperty("OnDataReceived",0,t.$rtti.TDataReceivedEvent,"FOnDataReceived","FOnDataReceived"),e.addProperty("OnGetURL",0,t.$rtti.TClientConnectionGetURLEvent,"FOnGetURL","FOnGetURL"),e.addProperty("OnGetUpdatePayLoad",0,t.$rtti.TGetUpdatePayloadEvent,"FOnGetUpdatePayLoad","FOnGetUpdatePayLoad"),e.addProperty("OnGetDataPayload",0,t.$rtti.TGetDataPayloadEvent,"FOnGetDataPayLoad","FOnGetDataPayLoad"),e.addProperty("OnProcessMetaData",0,t.$rtti.TProcessMetaDataEvent,"FOnProcessMetaData","FOnProcessMetaData")})),rtl.createClass(this,"TWebClientDataProxy",pas.DB.TDataProxy,(function(){this.$init=function(){pas.DB.TDataProxy.$init.call(this),this.FConnection=null},this.$final=function(){this.FConnection=void 0,pas.DB.TDataProxy.$final.call(this)},this.GetUpdateDescriptorClass=function(){return e.TWebClientUpdateRequest},this.DoGetData=function(t){var i,s=!1,n=null,o="";return s=!1,(n=rtl.as(t,e.TWebClientDataRequest)).FXHR=new XMLHttpRequest,""===(i=this.FConnection.GetPageURL(t))?2 in n.FLoadOptions?n.FSuccess=1:(n.FSuccess=0,n.FErrorMsg="No URL to get data",n.DoAfterRequest()):(2 in n.FLoadOptions&&""===this.FConnection.FPageParam?n.FSuccess=1:(o=pas["WEBLib.REST"].HTTPCommand(this.FConnection.FCommand,this.FConnection.FCustomCommand),n.FXHR.open(o,i,!0),this.FConnection.SetupRequest(n.FXHR),n.FXHR.addEventListener("load",rtl.createSafeCallback(n,"onLoad")),n.FXHR.addEventListener("abort",rtl.createSafeCallback(n,"onAbort")),n.FXHR.addEventListener("error",rtl.createSafeCallback(n,"onError")),""!==this.FConnection.FPostData?n.FXHR.send(this.FConnection.FPostData):n.FXHR.send()),s=!0),s},this.GetDataRequest=function(t,i,s){var n=null;return(n=e.TWebClientDataRequest.$create("Create$1",[this,rtl.refSet(t),i,s])).FConnection=this.FConnection,n},this.Create$1=function(e){return pas.Classes.TComponent.Create$1.apply(this,arguments),t.TClientConnection.isPrototypeOf(e)&&(this.FConnection=e),this},rtl.addIntf(this,pas.System.IUnknown)})),this.$rtti.$MethodVar("TUpdateRecordEvent",{procsig:rtl.newTIProcSig([["Sender",pas.System.$rtti.TObject],["ADescriptor",pas.DB.$rtti.TRecordUpdateDescriptor]]),methodkind:0}),rtl.createClass(this,"TCustomClientDataSet",pas.JSONDataset.TBaseJSONDataSet,(function(){this.$init=function(){pas.JSONDataset.TBaseJSONDataSet.$init.call(this),this.FConnection=null,this.FOnUpdateRecord=null,this.FUpdateCount=0,this.FIDField="",this.FuseServerMetadata=!1,this.FParams=null},this.$final=function(){this.FConnection=void 0,this.FOnUpdateRecord=void 0,this.FParams=void 0,pas.JSONDataset.TBaseJSONDataSet.$final.call(this)},this.SetParams=function(t){this.FParams.Assign(t)},this.GetStringFieldLength=function(t,e,i){var s=0,n=0,o=0,r=void 0;if(s=0,r=t.maxLen,isNaN(pas.JS.toNumber(r)))for(var a=0,l=this.FRows.length-1;a<=l;a++)n=a,r=this.FFieldMapper.GetJSONDataForField(e,i,this.FRows[n]),rtl.isString(r)&&(o=(""+r).length)>s&&(s=o);else(s=pas.System.Trunc(pas.JS.toNumber(r)))<=0&&pas.DB.DatabaseErrorFmt$1("Invalid maximum length specifier for field %s",pas.System.VarRecs(18,e),this);return 0===s&&(s=20),s},this.StringToFieldType=function(t){return"int"===t?2:"bigint"===t?3:"float"===t?5:"bool"===t?4:"date"===t?6:"datetime"===t?8:"time"===t?7:"blob"===t?10:1},this.DataPacketReceived=function(t){var e=!1,i=null,s=null,n=void 0,o=null,r="",a="",l="";if(e=!1,pas.JS.isNull(t.FData))return e;if(i=null,o=null,rtl.isString(t.FData)?(n=JSON.parse(""+t.FData),rtl.isArray(n)?o=n:rtl.isObject(n)&&(i=n)):rtl.isArray(t.FData)?o=t.FData:rtl.isObject(t.FData)?i=t.FData:pas.DB.DatabaseError("Cannot handle data packet"),null!=i){for(a=this.FConnection.GetDataNode(),r=this.FConnection.GetMetaDataNode();pas.System.Pos("\\",a)>0;)l=pas.System.Copy(a,1,pas.System.Pos("\\",a)-1),a=pas.System.Copy(a,pas.System.Pos("\\",a)+1,a.length),i=i[l];""===this.FIDField&&(this.FIDField="id"),this.FuseServerMetadata&&i.hasOwnProperty(r)&&rtl.isObject(i[r])&&(s=i[r],this.GetActive()||this.SetMetaData(s),s.hasOwnProperty("root")&&rtl.isString(s.root)&&(a=""+this.FMetaData.root),s.hasOwnProperty("idField")&&rtl.isString(s.idField)&&(this.FIDField=""+s.idField)),""!==a&&i.hasOwnProperty(a)&&rtl.isArray(i[a])&&(o=i[a])}return null!=o&&o.length>0&&null!=this.FFieldDefs&&0===this.FFieldDefs.GetCount()&&this.FieldDefsFromRows(o),(e=null!==o&&o.length>0)&&this.AddToRows(o),e},this.MetaDataToFieldDefs=function(){var t,e=null,i=0,s=0,n="",o=0,r=void 0;if(this.FFieldDefs.Clear(),this.FConnection.ProcessMetadata(this,this.FFieldDefs,this.FMetaData),!(this.FFieldDefs.GetCount()>0)){if(r=this.FMetaData.fields,!rtl.isArray(r))throw pas.JSONDataset.EJSONDataset.$create("Create$1",["Invalid metadata object"]);for(var a=0,l=(t=r).length-1;a<=l;a++){if(i=a,!rtl.isObject(t[i]))throw pas.JSONDataset.EJSONDataset.$create("CreateFmt",["Field definition %d in metadata is not an object",pas.System.VarRecs(0,i)]);if(r=(e=t[i]).name,!rtl.isString(r))throw pas.JSONDataset.EJSONDataset.$create("CreateFmt",["Field definition %d in has no or invalid name property",pas.System.VarRecs(0,i)]);if(n=""+r,r=e.type,pas.JS.isNull(r)||pas.JS.isUndefined(r))o=1;else{if(!rtl.isString(r))throw pas.JSONDataset.EJSONDataset.$create("CreateFmt",["Field definition %d in has invalid type property",pas.System.VarRecs(0,i)]);o=this.StringToFieldType(""+r)}s=1===o?this.GetStringFieldLength(e,n,i):0,this.FFieldDefs.Add$4(n,o,s)}}},this.SetConnection=function(t){this.FConnection=t,null!=t&&t.RegisterDataSet(this)},this.CreateFieldMapper=function(){return pas.JSONDataset.TJSONObjectFieldMapper.$create("Create")},this.InitFieldDefs=function(){var t=this;this.FFieldDefs.Clear(),this.GetChildren((function(e){pas.DB.TStringField.isPrototypeOf(e)&&t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TStringField).FFieldName,1,rtl.as(e,pas.DB.TStringField).FSize),pas.DB.TBooleanField.isPrototypeOf(e)&&t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TBooleanField).FFieldName,4,0),pas.DB.TAutoIncField.isPrototypeOf(e)?t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TAutoIncField).FFieldName,9,0):pas.DB.TIntegerField.isPrototypeOf(e)?t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TIntegerField).FFieldName,2,0):pas.DB.TLargeintField.isPrototypeOf(e)?t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TLargeintField).FFieldName,3,0):pas.DB.TFloatField.isPrototypeOf(e)?t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TFloatField).FFieldName,5,0):pas.DB.TNumericField.isPrototypeOf(e)&&t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TNumericField).FFieldName,2,0),pas.DB.TDateField.isPrototypeOf(e)?t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TDateField).FFieldName,6,0):pas.DB.TTimeField.isPrototypeOf(e)?t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TTimeField).FFieldName,6,0):pas.DB.TDateTimeField.isPrototypeOf(e)&&t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TDateTimeField).FFieldName,8,0),pas.DB.TMemoField.isPrototypeOf(e)?t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TMemoField).FFieldName,11,0):pas.DB.TBlobField.isPrototypeOf(e)&&t.FFieldDefs.Add$4(rtl.as(e,pas.DB.TBlobField).FFieldName,10,0)}),t)},this.InternalInitFieldDefs=function(){0===this.FFieldDefs.GetCount()&&null!=this.FRows&&this.FRows.length>0&&this.FieldDefsFromRows(this.FRows),pas.JSONDataset.TBaseJSONDataSet.InternalInitFieldDefs.call(this)},this.FieldDefsFromRows=function(t){var e=null,i=void 0,s=[],n=0;if(0===this.FFieldDefs.GetCount()&&null!=t&&t.length>0){e=t[0],s=Object.getOwnPropertyNames(e);for(var o=0,r=rtl.length(s)-1;o<=r;o++)i=e[s[n=o]],rtl.isString(i)&&this.FFieldDefs.Add$4(s[n],1,255),rtl.isNumber(i)&&this.FFieldDefs.Add$5(s[n],5),pas.JS.isBoolean(i)&&this.FFieldDefs.Add$5(s[n],4),pas.JS.isDate(i)&&this.FFieldDefs.Add$5(s[n],6),pas.JS.isNull(i)&&this.FFieldDefs.Add$4(s[n],1,255)}},this.DoAfterOpen=function(){pas.DB.TDataSet.DoAfterOpen.call(this),null!=this.FConnection&&this.FConnection.FAutoOpen&&this.FConnection.DoAfterConnect()},this.DoGetDataProxy=function(){return null!=this.FConnection?this.FConnection.GetDataProxy():null},this.SetActive=function(t){0 in this.FComponentState||0===this.FFieldList.GetCount()&&null!=this.FFieldDefs&&0===this.FFieldDefs.GetCount()||pas.DB.TDataSet.SetActive.apply(this,arguments)},this.Create$1=function(t){return pas.JSONDataset.TBaseJSONDataSet.Create$1.apply(this,arguments),this.FParams=pas.DB.TParams.$create("Create$1",[pas.DB.TParam]),this},this.Destroy=function(){pas.SysUtils.FreeAndNil({p:this,get:function(){return this.p.FParams},set:function(t){this.p.FParams=t}}),pas.JSONDataset.TBaseJSONDataSet.Destroy.call(this)},this.BeginUpdate=function(){pas.Classes.TComponent.BeginUpdate.call(this),this.FUpdateCount+=1},this.EndUpdate=function(){pas.Classes.TComponent.EndUpdate.call(this),this.FUpdateCount>0&&(this.FUpdateCount-=1)},this.AfterLoadDFMValues=function(){pas.Classes.TComponent.AfterLoadDFMValues.call(this),this.InitFieldDefs()},this.GetChildren=function(t,e){for(var i=0,s=0,n=this.FFieldList.GetCount()-1;s<=n;s++)i=s,this.FFieldList.GetField(i).FOwner!==e&&this.FFieldList.GetField(i).FDataSet!==e&&null!==e||(""===this.FFieldList.GetField(i).FName&&this.FFieldList.GetField(i).SetName(this.FName+this.FFieldList.GetField(i).FFieldName),t(this.FFieldList.GetField(i)))},rtl.addIntf(this,pas.System.IUnknown)})),rtl.createClass(this,"TClientDataSet",this.TCustomClientDataSet,(function(){rtl.addIntf(this,pas.System.IUnknown);var e=this.$rtti;e.addProperty("Active",3,rtl.boolean,"GetActive","SetActive",{Default:!1}),e.addProperty("Connection",2,t.$rtti.TClientConnection,"FConnection","SetConnection"),e.addProperty("Params",2,pas.DB.$rtti.TParams,"FParams","SetParams"),e.addProperty("BeforeOpen",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforeOpen","FBeforeOpen"),e.addProperty("AfterOpen",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterOpen","FAfterOpen"),e.addProperty("BeforeClose",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforeClose","FBeforeClose"),e.addProperty("AfterClose",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterClose","FAfterClose"),e.addProperty("BeforeInsert",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforeInsert","FBeforeInsert"),e.addProperty("AfterInsert",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterInsert","FAfterInsert"),e.addProperty("BeforeEdit",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforeEdit","FBeforeEdit"),e.addProperty("AfterEdit",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterEdit","FAfterEdit"),e.addProperty("BeforePost",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforePost","FBeforePost"),e.addProperty("AfterPost",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterPost","FAfterPost"),e.addProperty("BeforeCancel",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforeCancel","FBeforeCancel"),e.addProperty("AfterCancel",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterCancel","FAfterCancel"),e.addProperty("BeforeDelete",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforeDelete","FBeforeDelete"),e.addProperty("AfterDelete",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterDelete","FAfterDelete"),e.addProperty("BeforeScroll",0,pas.DB.$rtti.TDataSetNotifyEvent,"FBeforeScroll","FBeforeScroll"),e.addProperty("AfterScroll",0,pas.DB.$rtti.TDataSetNotifyEvent,"FAfterScroll","FAfterScroll"),e.addProperty("OnCalcFields",0,pas.DB.$rtti.TDataSetNotifyEvent,"FOnCalcFields","FOnCalcFields"),e.addProperty("OnDeleteError",0,pas.DB.$rtti.TDataSetErrorEvent,"FOnDeleteError","FOnDeleteError"),e.addProperty("OnEditError",0,pas.DB.$rtti.TDataSetErrorEvent,"FOnEditError","FOnEditError"),e.addProperty("OnFilterRecord",2,pas.DB.$rtti.TFilterRecordEvent,"FOnFilterRecord","SetOnFilterRecord"),e.addProperty("OnNewRecord",0,pas.DB.$rtti.TDataSetNotifyEvent,"FOnNewRecord","FOnNewRecord"),e.addProperty("OnPostError",0,pas.DB.$rtti.TDataSetErrorEvent,"FOnPostError","FOnPostError"),e.addProperty("OnUpdateRecord",0,t.$rtti.TUpdateRecordEvent,"FOnUpdateRecord","FOnUpdateRecord")})),t.$implcode=function(){rtl.createClass(e,"TWebClientDataRequest",pas.DB.TDataRequest,(function(){this.$init=function(){pas.DB.TDataRequest.$init.call(this),this.FXHR=null,this.FConnection=null},this.$final=function(){this.FXHR=void 0,this.FConnection=void 0,pas.DB.TDataRequest.$final.call(this)},this.onError=function(t){return this.FSuccess=0,null!=this.FConnection&&this.FConnection.DoError(this.FXHR.status),this.DoAfterRequest(),!0,!0},this.onAbort=function(t){return this.FSuccess=0,null!=this.FConnection&&this.FConnection.DoError(this.FXHR.status),this.DoAfterRequest(),!0,!0},this.onLoad=function(t){return 200===this.FXHR.status?(this.FData=this.TransformResult(),this.FSuccess=2):(this.FData=null,2 in this.FLoadOptions&&404===this.FXHR.status?this.FSuccess=1:(this.FSuccess=0,this.FErrorMsg=this.FXHR.statusText),null!=this.FConnection&&this.FConnection.DoError(this.FXHR.status)),this.DoAfterRequest(),!0,!0},this.TransformResult=function(){var t=void 0,e="";return t=this.FXHR.response,null!=this.FConnection&&null!=this.FConnection.FOnDataReceived&&(e=this.FXHR.responseText,this.FConnection.DoDataReceived(this.FXHR,{get:function(){return e},set:function(t){e=t}})),null!=this.FConnection&&null!=this.FConnection.FOnGetDataPayLoad&&this.FConnection.FOnGetDataPayLoad(this.FConnection,this.FDataset,0,{get:function(){return t},set:function(e){t=e}}),t}})),rtl.createClass(e,"TWebClientUpdateRequest",pas.DB.TRecordUpdateDescriptor,(function(){}))}}),["SysUtils","Types","WEBLib.Dialogs"]),rtl.module("dmMarshalDemoU",["System","SysUtils","Classes","JS","Web","WEBLib.Modules","DB","WEBLib.CDS"],(function(){"use strict";rtl.createClass(this,"TdmMarshalDemo",pas["WEBLib.Modules"].TDataModule,(function(){this.$init=function(){pas["WEBLib.Modules"].TDataModule.$init.call(this),this.cdsFeatures=null,this.cdsFeaturesFeatureName=null},this.$final=function(){this.cdsFeatures=void 0,this.cdsFeaturesFeatureName=void 0,pas["WEBLib.Modules"].TDataModule.$final.call(this)},this.WebDataModuleCreate=function(t){this.cdsFeatures.Open()},this.cdsFeaturesAfterOpen=function(t){this.cdsFeaturesInsert("Object Plus"),this.cdsFeaturesInsert("App Info")},this.cdsFeaturesInsert=function(t){this.cdsFeatures.Insert$1(),this.cdsFeatures.FieldByName("FeatureName").SetAsString(t),this.cdsFeatures.Post()},this.LoadDFMValues=function(){pas["WEBLib.Modules"].TDataModule.LoadDFMValues.call(this),this.cdsFeatures=pas["WEBLib.CDS"].TClientDataSet.$create("Create$1",[this]),this.cdsFeaturesFeatureName=pas.DB.TStringField.$create("Create$1",[this]),this.cdsFeatures.BeforeLoadDFMValues(),this.cdsFeaturesFeatureName.BeforeLoadDFMValues();try{this.SetName("dmMarshalDemo"),this.SetEvent(this,"OnCreate","WebDataModuleCreate"),this.FHeight=285,this.FWidth=417,this.cdsFeatures.SetParentComponent(this),this.cdsFeatures.SetName("cdsFeatures"),this.cdsFeatures.FAfterOpen=rtl.createCallback(this,"cdsFeaturesAfterOpen"),this.cdsFeatures.SetLeft(96),this.cdsFeatures.SetTop(48),this.cdsFeaturesFeatureName.SetParentComponent(this.cdsFeatures),this.cdsFeaturesFeatureName.SetName("cdsFeaturesFeatureName"),this.cdsFeaturesFeatureName.FFieldName="FeatureName"}finally{this.cdsFeatures.AfterLoadDFMValues(),this.cdsFeaturesFeatureName.AfterLoadDFMValues()}},rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addField("cdsFeatures",pas["WEBLib.CDS"].$rtti.TClientDataSet),t.addField("cdsFeaturesFeatureName",pas.DB.$rtti.TStringField),t.addMethod("WebDataModuleCreate",0,[["Sender",pas.System.$rtti.TObject]]),t.addMethod("cdsFeaturesAfterOpen",0,[["DataSet",pas.DB.$rtti.TDataSet]])})),this.dmMarshalDemo=null})),rtl.module("frmMarshalDemoU",["System","SysUtils","Classes","JS","Web","WEBLib.Graphics","WEBLib.Controls","WEBLib.Forms","WEBLib.Dialogs","WEBLib.ComCtrls","WEBLib.Controls","WEBLib.ExtCtrls","WEBLib.Actions","WEBLib.ComCtrls","WEBLib.StdCtrls","WEBLib.StdCtrls"],(function(){"use strict";rtl.createClass(this,"TfrmMarshalDemo",pas["WEBLib.Forms"].TForm,(function(){this.$init=function(){pas["WEBLib.Forms"].TForm.$init.call(this),this.pnlTop=null,this.pcFeatures=null,this.tiFeatures=null,this.tiRunTimeMemo=null,this.tiFrames=null,this.WebElementActionList1=null,this.lbFeatures=null,this.btnMarshal=null,this.pnlFramesTools=null,this.pnlRTMemoTools=null,this.btnMemoAdd=null,this.btnMemoDelete=null,this.memoRTCompFooter=null,this.FRuntimeMemo=null},this.$final=function(){this.pnlTop=void 0,this.pcFeatures=void 0,this.tiFeatures=void 0,this.tiRunTimeMemo=void 0,this.tiFrames=void 0,this.WebElementActionList1=void 0,this.lbFeatures=void 0,this.btnMarshal=void 0,this.pnlFramesTools=void 0,this.pnlRTMemoTools=void 0,this.btnMemoAdd=void 0,this.btnMemoDelete=void 0,this.memoRTCompFooter=void 0,this.FRuntimeMemo=void 0,pas["WEBLib.Forms"].TForm.$final.call(this)},this.WebFormCreate=function(t){this.LoadFeatureTree()},this.btnMarshalClick=function(t){pas["WebLib.SE.RTTK.Constable"].TSERTTKConstableAPI.ShowConstable(),window.console.log("defined")},this.btnMemoAddClick=function(t){var e="";this.FRuntimeMemo=pas["WEBLib.StdCtrls"].TMemo.$create("Create$1",[this]),this.FRuntimeMemo.SetParent(this.tiRunTimeMemo),this.FRuntimeMemo.SetAlign(5);var i=this.memoRTCompFooter.FLines.GetEnumerator();try{for(;i.MoveNext();)e=i.GetCurrent(),this.FRuntimeMemo.FLines.Add("Copy of : "+e)}finally{i=rtl.freeLoc(i)}this.btnMemoDelete.SetEnabled(!0)},this.btnMemoDeleteClick=function(t){null!=this.FRuntimeMemo&&rtl.free(this,"FRuntimeMemo"),this.btnMemoDelete.SetEnabled(!1)},this.LoadFeatureTree=function(){for(this.lbFeatures.FItems.Add("Features"),pas.dmMarshalDemoU.dmMarshalDemo.cdsFeatures.First();!pas.dmMarshalDemoU.dmMarshalDemo.cdsFeatures.FEOF;)this.lbFeatures.FItems.Add(pas.dmMarshalDemoU.dmMarshalDemo.cdsFeatures.FieldByName("FeatureName").GetAsString()),pas.dmMarshalDemoU.dmMarshalDemo.cdsFeatures.Next()},this.LoadDFMValues=function(){pas["WEBLib.Forms"].TCustomForm.LoadDFMValues.call(this),this.pnlTop=pas["WEBLib.ExtCtrls"].TPanel.$create("Create$1",[this]),this.btnMarshal=pas["WEBLib.StdCtrls"].TButton.$create("Create$1",[this]),this.pcFeatures=pas["WEBLib.ComCtrls"].TPageControl.$create("Create$1",[this]),this.tiFeatures=pas["WEBLib.ComCtrls"].TTabSheet.$create("Create$1",[this]),this.lbFeatures=pas["WEBLib.StdCtrls"].TListBox.$create("Create$1",[this]),this.tiRunTimeMemo=pas["WEBLib.ComCtrls"].TTabSheet.$create("Create$1",[this]),this.pnlRTMemoTools=pas["WEBLib.ExtCtrls"].TPanel.$create("Create$1",[this]),this.btnMemoAdd=pas["WEBLib.StdCtrls"].TButton.$create("Create$1",[this]),this.btnMemoDelete=pas["WEBLib.StdCtrls"].TButton.$create("Create$1",[this]),this.memoRTCompFooter=pas["WEBLib.StdCtrls"].TMemo.$create("Create$1",[this]),this.tiFrames=pas["WEBLib.ComCtrls"].TTabSheet.$create("Create$1",[this]),this.pnlFramesTools=pas["WEBLib.ExtCtrls"].TPanel.$create("Create$1",[this]),this.WebElementActionList1=pas["WEBLib.Actions"].TElementActionList.$create("Create$1",[this]),this.pnlTop.BeforeLoadDFMValues(),this.btnMarshal.BeforeLoadDFMValues(),this.pcFeatures.BeforeLoadDFMValues(),this.tiFeatures.BeforeLoadDFMValues(),this.lbFeatures.BeforeLoadDFMValues(),this.tiRunTimeMemo.BeforeLoadDFMValues(),this.pnlRTMemoTools.BeforeLoadDFMValues(),this.btnMemoAdd.BeforeLoadDFMValues(),this.btnMemoDelete.BeforeLoadDFMValues(),this.memoRTCompFooter.BeforeLoadDFMValues(),this.tiFrames.BeforeLoadDFMValues(),this.pnlFramesTools.BeforeLoadDFMValues(),this.WebElementActionList1.BeforeLoadDFMValues();try{this.SetName("frmMarshalDemo"),this.SetWidth(730),this.SetHeight(479),this.SetCaption("Marshal Demo Web 2023"),this.SetEvent(this,"OnCreate","WebFormCreate"),this.pnlTop.SetParentComponent(this),this.pnlTop.SetName("pnlTop"),this.pnlTop.SetLeft(0),this.pnlTop.SetTop(0),this.pnlTop.SetWidth(730),this.pnlTop.SetHeight(40),this.pnlTop.SetAlign(1),this.pnlTop.SetCaption("pnlTop"),this.btnMarshal.SetParentComponent(this.pnlTop),this.btnMarshal.SetName("btnMarshal"),this.btnMarshal.SetLeft(0),this.btnMarshal.SetTop(0),this.btnMarshal.SetWidth(64),this.btnMarshal.SetHeight(40),this.btnMarshal.SetAlign(3),this.btnMarshal.SetCaption("Marshal"),this.btnMarshal.SetHeightPercent(100),this.btnMarshal.SetWidthPercent(100),this.SetEvent$1(this.btnMarshal,this,"OnClick","btnMarshalClick"),this.pcFeatures.SetParentComponent(this),this.pcFeatures.SetName("pcFeatures"),this.pcFeatures.SetLeft(0),this.pcFeatures.SetTop(40),this.pcFeatures.SetWidth(730),this.pcFeatures.SetHeight(439),this.pcFeatures.SetAlign(5),this.pcFeatures.SetChildOrderEx(1),this.pcFeatures.SetTabIndex(1),this.pcFeatures.SetTabOrder(1),this.tiFeatures.SetParentComponent(this.pcFeatures),this.tiFeatures.SetName("tiFeatures"),this.tiFeatures.SetLeft(0),this.tiFeatures.SetTop(13),this.tiFeatures.SetWidth(730),this.tiFeatures.SetHeight(426),this.tiFeatures.SetCaption("Features"),this.lbFeatures.SetParentComponent(this.tiFeatures),this.lbFeatures.SetName("lbFeatures"),this.lbFeatures.SetLeft(0),this.lbFeatures.SetTop(0),this.lbFeatures.SetWidth(145),this.lbFeatures.SetHeight(426),this.lbFeatures.SetAlign(3),this.lbFeatures.SetHeightPercent(100),this.lbFeatures.SetItemHeight(25),this.lbFeatures.SetWidthPercent(100),this.lbFeatures.SetItemIndex(-1),this.tiRunTimeMemo.SetParentComponent(this.pcFeatures),this.tiRunTimeMemo.SetName("tiRunTimeMemo"),this.tiRunTimeMemo.SetLeft(0),this.tiRunTimeMemo.SetTop(13),this.tiRunTimeMemo.SetWidth(730),this.tiRunTimeMemo.SetHeight(426),this.tiRunTimeMemo.SetCaption("RunTime Memo"),this.tiRunTimeMemo.SetChildOrderEx(1),this.pnlRTMemoTools.SetParentComponent(this.tiRunTimeMemo),this.pnlRTMemoTools.SetName("pnlRTMemoTools"),this.pnlRTMemoTools.SetLeft(0),this.pnlRTMemoTools.SetTop(0),this.pnlRTMemoTools.SetWidth(730),this.pnlRTMemoTools.SetHeight(40),this.pnlRTMemoTools.SetAlign(1),this.pnlRTMemoTools.SetCaption("RT Memo Tools"),this.btnMemoAdd.SetParentComponent(this.pnlRTMemoTools),this.btnMemoAdd.SetName("btnMemoAdd"),this.btnMemoAdd.SetLeft(0),this.btnMemoAdd.SetTop(0),this.btnMemoAdd.SetWidth(113),this.btnMemoAdd.SetHeight(40),this.btnMemoAdd.SetAlign(3),this.btnMemoAdd.SetCaption("Add Memo"),this.btnMemoAdd.SetHeightPercent(100),this.btnMemoAdd.SetWidthPercent(100),this.SetEvent$1(this.btnMemoAdd,this,"OnClick","btnMemoAddClick"),this.btnMemoDelete.SetParentComponent(this.pnlRTMemoTools),this.btnMemoDelete.SetName("btnMemoDelete"),this.btnMemoDelete.SetLeft(624),this.btnMemoDelete.SetTop(0),this.btnMemoDelete.SetWidth(106),this.btnMemoDelete.SetHeight(40),this.btnMemoDelete.SetAlign(4),this.btnMemoDelete.SetCaption("Delete Memo"),this.btnMemoDelete.SetChildOrderEx(1),this.btnMemoDelete.SetHeightPercent(100),this.btnMemoDelete.SetWidthPercent(100),this.SetEvent$1(this.btnMemoDelete,this,"OnClick","btnMemoDeleteClick"),this.memoRTCompFooter.SetParentComponent(this.tiRunTimeMemo),this.memoRTCompFooter.SetName("memoRTCompFooter"),this.memoRTCompFooter.SetLeft(0),this.memoRTCompFooter.SetTop(347),this.memoRTCompFooter.SetWidth(730),this.memoRTCompFooter.SetHeight(79),this.memoRTCompFooter.SetAlign(2),this.memoRTCompFooter.SetAutoSize(!1),this.memoRTCompFooter.SetHeightPercent(100),this.memoRTCompFooter.FLines.BeginUpdate();try{this.memoRTCompFooter.FLines.Clear(),this.memoRTCompFooter.FLines.Add("Click on Add Memo to create a memo in the client area at runtime"),this.memoRTCompFooter.FLines.Add("Refresh the tree in Marshal"),this.memoRTCompFooter.FLines.Add("Click on Delete memo to remove the runtime object"),this.memoRTCompFooter.FLines.Add("Refresh the form in Marshal")}finally{this.memoRTCompFooter.FLines.EndUpdate()}this.memoRTCompFooter.SetSelLength(0),this.memoRTCompFooter.SetSelStart(175),this.memoRTCompFooter.SetWidthPercent(100),this.tiFrames.SetParentComponent(this.pcFeatures),this.tiFrames.SetName("tiFrames"),this.tiFrames.SetLeft(0),this.tiFrames.SetTop(13),this.tiFrames.SetWidth(730),this.tiFrames.SetHeight(426),this.tiFrames.SetCaption("Frames"),this.tiFrames.SetChildOrderEx(2),this.pnlFramesTools.SetParentComponent(this.tiFrames),this.pnlFramesTools.SetName("pnlFramesTools"),this.pnlFramesTools.SetLeft(0),this.pnlFramesTools.SetTop(0),this.pnlFramesTools.SetWidth(730),this.pnlFramesTools.SetHeight(40),this.pnlFramesTools.SetAlign(1),this.pnlFramesTools.SetCaption("pnlFramesTools"),this.WebElementActionList1.SetParentComponent(this),this.WebElementActionList1.SetName("WebElementActionList1"),this.WebElementActionList1.SetLeft(688),this.WebElementActionList1.SetTop(427)}finally{this.pnlTop.AfterLoadDFMValues(),this.btnMarshal.AfterLoadDFMValues(),this.pcFeatures.AfterLoadDFMValues(),this.tiFeatures.AfterLoadDFMValues(),this.lbFeatures.AfterLoadDFMValues(),this.tiRunTimeMemo.AfterLoadDFMValues(),this.pnlRTMemoTools.AfterLoadDFMValues(),this.btnMemoAdd.AfterLoadDFMValues(),this.btnMemoDelete.AfterLoadDFMValues(),this.memoRTCompFooter.AfterLoadDFMValues(),this.tiFrames.AfterLoadDFMValues(),this.pnlFramesTools.AfterLoadDFMValues(),this.WebElementActionList1.AfterLoadDFMValues()}},rtl.addIntf(this,pas.System.IUnknown);var t=this.$rtti;t.addField("pnlTop",pas["WEBLib.ExtCtrls"].$rtti.TPanel),t.addField("pcFeatures",pas["WEBLib.ComCtrls"].$rtti.TPageControl),t.addField("tiFeatures",pas["WEBLib.ComCtrls"].$rtti.TTabSheet),t.addField("tiRunTimeMemo",pas["WEBLib.ComCtrls"].$rtti.TTabSheet),t.addField("tiFrames",pas["WEBLib.ComCtrls"].$rtti.TTabSheet),t.addField("WebElementActionList1",pas["WEBLib.Actions"].$rtti.TElementActionList),t.addField("lbFeatures",pas["WEBLib.StdCtrls"].$rtti.TListBox),t.addField("btnMarshal",pas["WEBLib.StdCtrls"].$rtti.TButton),t.addField("pnlFramesTools",pas["WEBLib.ExtCtrls"].$rtti.TPanel),t.addField("pnlRTMemoTools",pas["WEBLib.ExtCtrls"].$rtti.TPanel),t.addField("btnMemoAdd",pas["WEBLib.StdCtrls"].$rtti.TButton),t.addField("btnMemoDelete",pas["WEBLib.StdCtrls"].$rtti.TButton),t.addField("memoRTCompFooter",pas["WEBLib.StdCtrls"].$rtti.TMemo),t.addMethod("WebFormCreate",0,[["Sender",pas.System.$rtti.TObject]]),t.addMethod("btnMarshalClick",0,[["Sender",pas.System.$rtti.TObject]]),t.addMethod("btnMemoAddClick",0,[["Sender",pas.System.$rtti.TObject]]),t.addMethod("btnMemoDeleteClick",0,[["Sender",pas.System.$rtti.TObject]])})),this.frmMarshalDemo=null}),["WebLib.SE.RTTK.Constable","dmMarshalDemoU"]),rtl.module("program",["System","WEBLib.Forms","WEBLib.Forms","frmMarshalDemoU","dmMarshalDemoU"],(function(){"use strict";this.$main=function(){pas["WEBLib.Forms"].Application.Initialize(),pas["WEBLib.Forms"].Application.FMainFormOnTaskBar=!0,pas["WEBLib.Forms"].Application.CreateFormDirect$1(pas.dmMarshalDemoU.TdmMarshalDemo,{p:pas.dmMarshalDemoU,get:function(){return this.p.dmMarshalDemo},set:function(t){this.p.dmMarshalDemo=t}}),pas["WEBLib.Forms"].Application.CreateForm(pas.frmMarshalDemoU.TfrmMarshalDemo,{p:pas.frmMarshalDemoU,get:function(){return this.p.frmMarshalDemo},set:function(t){this.p.frmMarshalDemo=t}}),pas["WEBLib.Forms"].Application.Run()}}));